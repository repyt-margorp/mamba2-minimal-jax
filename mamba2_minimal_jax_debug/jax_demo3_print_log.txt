[Mamba2LMHeadModel] Loading pre-trained model from HuggingFace ID: state-spaces/mamba2-370m
[Config] Initialized Mamba2Config with d_model=1024, n_layer=48, d_state=128, d_conv=4, expand=2, headdim=64, chunk_size=64, vocab_size=50288, pad_vocab_size_multiple=16
[Config] Computed d_inner=2048, nheads=32
[FlaxMamba2LMHeadModel] State Dict:

==== PyTorch State Dict ====

backbone.embedding.weight: torch.Size([50288, 1024])
backbone.layers.0.norm.weight: torch.Size([1024])
backbone.layers.0.mixer.dt_bias: torch.Size([32])
backbone.layers.0.mixer.A_log: torch.Size([32])
backbone.layers.0.mixer.D: torch.Size([32])
backbone.layers.0.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.0.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.0.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.0.mixer.norm.weight: torch.Size([2048])
backbone.layers.0.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.1.norm.weight: torch.Size([1024])
backbone.layers.1.mixer.dt_bias: torch.Size([32])
backbone.layers.1.mixer.A_log: torch.Size([32])
backbone.layers.1.mixer.D: torch.Size([32])
backbone.layers.1.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.1.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.1.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.1.mixer.norm.weight: torch.Size([2048])
backbone.layers.1.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.2.norm.weight: torch.Size([1024])
backbone.layers.2.mixer.dt_bias: torch.Size([32])
backbone.layers.2.mixer.A_log: torch.Size([32])
backbone.layers.2.mixer.D: torch.Size([32])
backbone.layers.2.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.2.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.2.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.2.mixer.norm.weight: torch.Size([2048])
backbone.layers.2.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.3.norm.weight: torch.Size([1024])
backbone.layers.3.mixer.dt_bias: torch.Size([32])
backbone.layers.3.mixer.A_log: torch.Size([32])
backbone.layers.3.mixer.D: torch.Size([32])
backbone.layers.3.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.3.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.3.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.3.mixer.norm.weight: torch.Size([2048])
backbone.layers.3.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.4.norm.weight: torch.Size([1024])
backbone.layers.4.mixer.dt_bias: torch.Size([32])
backbone.layers.4.mixer.A_log: torch.Size([32])
backbone.layers.4.mixer.D: torch.Size([32])
backbone.layers.4.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.4.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.4.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.4.mixer.norm.weight: torch.Size([2048])
backbone.layers.4.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.5.norm.weight: torch.Size([1024])
backbone.layers.5.mixer.dt_bias: torch.Size([32])
backbone.layers.5.mixer.A_log: torch.Size([32])
backbone.layers.5.mixer.D: torch.Size([32])
backbone.layers.5.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.5.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.5.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.5.mixer.norm.weight: torch.Size([2048])
backbone.layers.5.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.6.norm.weight: torch.Size([1024])
backbone.layers.6.mixer.dt_bias: torch.Size([32])
backbone.layers.6.mixer.A_log: torch.Size([32])
backbone.layers.6.mixer.D: torch.Size([32])
backbone.layers.6.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.6.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.6.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.6.mixer.norm.weight: torch.Size([2048])
backbone.layers.6.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.7.norm.weight: torch.Size([1024])
backbone.layers.7.mixer.dt_bias: torch.Size([32])
backbone.layers.7.mixer.A_log: torch.Size([32])
backbone.layers.7.mixer.D: torch.Size([32])
backbone.layers.7.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.7.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.7.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.7.mixer.norm.weight: torch.Size([2048])
backbone.layers.7.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.8.norm.weight: torch.Size([1024])
backbone.layers.8.mixer.dt_bias: torch.Size([32])
backbone.layers.8.mixer.A_log: torch.Size([32])
backbone.layers.8.mixer.D: torch.Size([32])
backbone.layers.8.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.8.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.8.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.8.mixer.norm.weight: torch.Size([2048])
backbone.layers.8.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.9.norm.weight: torch.Size([1024])
backbone.layers.9.mixer.dt_bias: torch.Size([32])
backbone.layers.9.mixer.A_log: torch.Size([32])
backbone.layers.9.mixer.D: torch.Size([32])
backbone.layers.9.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.9.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.9.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.9.mixer.norm.weight: torch.Size([2048])
backbone.layers.9.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.10.norm.weight: torch.Size([1024])
backbone.layers.10.mixer.dt_bias: torch.Size([32])
backbone.layers.10.mixer.A_log: torch.Size([32])
backbone.layers.10.mixer.D: torch.Size([32])
backbone.layers.10.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.10.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.10.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.10.mixer.norm.weight: torch.Size([2048])
backbone.layers.10.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.11.norm.weight: torch.Size([1024])
backbone.layers.11.mixer.dt_bias: torch.Size([32])
backbone.layers.11.mixer.A_log: torch.Size([32])
backbone.layers.11.mixer.D: torch.Size([32])
backbone.layers.11.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.11.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.11.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.11.mixer.norm.weight: torch.Size([2048])
backbone.layers.11.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.12.norm.weight: torch.Size([1024])
backbone.layers.12.mixer.dt_bias: torch.Size([32])
backbone.layers.12.mixer.A_log: torch.Size([32])
backbone.layers.12.mixer.D: torch.Size([32])
backbone.layers.12.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.12.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.12.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.12.mixer.norm.weight: torch.Size([2048])
backbone.layers.12.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.13.norm.weight: torch.Size([1024])
backbone.layers.13.mixer.dt_bias: torch.Size([32])
backbone.layers.13.mixer.A_log: torch.Size([32])
backbone.layers.13.mixer.D: torch.Size([32])
backbone.layers.13.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.13.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.13.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.13.mixer.norm.weight: torch.Size([2048])
backbone.layers.13.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.14.norm.weight: torch.Size([1024])
backbone.layers.14.mixer.dt_bias: torch.Size([32])
backbone.layers.14.mixer.A_log: torch.Size([32])
backbone.layers.14.mixer.D: torch.Size([32])
backbone.layers.14.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.14.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.14.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.14.mixer.norm.weight: torch.Size([2048])
backbone.layers.14.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.15.norm.weight: torch.Size([1024])
backbone.layers.15.mixer.dt_bias: torch.Size([32])
backbone.layers.15.mixer.A_log: torch.Size([32])
backbone.layers.15.mixer.D: torch.Size([32])
backbone.layers.15.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.15.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.15.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.15.mixer.norm.weight: torch.Size([2048])
backbone.layers.15.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.16.norm.weight: torch.Size([1024])
backbone.layers.16.mixer.dt_bias: torch.Size([32])
backbone.layers.16.mixer.A_log: torch.Size([32])
backbone.layers.16.mixer.D: torch.Size([32])
backbone.layers.16.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.16.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.16.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.16.mixer.norm.weight: torch.Size([2048])
backbone.layers.16.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.17.norm.weight: torch.Size([1024])
backbone.layers.17.mixer.dt_bias: torch.Size([32])
backbone.layers.17.mixer.A_log: torch.Size([32])
backbone.layers.17.mixer.D: torch.Size([32])
backbone.layers.17.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.17.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.17.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.17.mixer.norm.weight: torch.Size([2048])
backbone.layers.17.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.18.norm.weight: torch.Size([1024])
backbone.layers.18.mixer.dt_bias: torch.Size([32])
backbone.layers.18.mixer.A_log: torch.Size([32])
backbone.layers.18.mixer.D: torch.Size([32])
backbone.layers.18.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.18.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.18.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.18.mixer.norm.weight: torch.Size([2048])
backbone.layers.18.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.19.norm.weight: torch.Size([1024])
backbone.layers.19.mixer.dt_bias: torch.Size([32])
backbone.layers.19.mixer.A_log: torch.Size([32])
backbone.layers.19.mixer.D: torch.Size([32])
backbone.layers.19.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.19.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.19.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.19.mixer.norm.weight: torch.Size([2048])
backbone.layers.19.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.20.norm.weight: torch.Size([1024])
backbone.layers.20.mixer.dt_bias: torch.Size([32])
backbone.layers.20.mixer.A_log: torch.Size([32])
backbone.layers.20.mixer.D: torch.Size([32])
backbone.layers.20.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.20.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.20.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.20.mixer.norm.weight: torch.Size([2048])
backbone.layers.20.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.21.norm.weight: torch.Size([1024])
backbone.layers.21.mixer.dt_bias: torch.Size([32])
backbone.layers.21.mixer.A_log: torch.Size([32])
backbone.layers.21.mixer.D: torch.Size([32])
backbone.layers.21.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.21.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.21.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.21.mixer.norm.weight: torch.Size([2048])
backbone.layers.21.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.22.norm.weight: torch.Size([1024])
backbone.layers.22.mixer.dt_bias: torch.Size([32])
backbone.layers.22.mixer.A_log: torch.Size([32])
backbone.layers.22.mixer.D: torch.Size([32])
backbone.layers.22.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.22.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.22.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.22.mixer.norm.weight: torch.Size([2048])
backbone.layers.22.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.23.norm.weight: torch.Size([1024])
backbone.layers.23.mixer.dt_bias: torch.Size([32])
backbone.layers.23.mixer.A_log: torch.Size([32])
backbone.layers.23.mixer.D: torch.Size([32])
backbone.layers.23.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.23.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.23.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.23.mixer.norm.weight: torch.Size([2048])
backbone.layers.23.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.24.norm.weight: torch.Size([1024])
backbone.layers.24.mixer.dt_bias: torch.Size([32])
backbone.layers.24.mixer.A_log: torch.Size([32])
backbone.layers.24.mixer.D: torch.Size([32])
backbone.layers.24.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.24.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.24.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.24.mixer.norm.weight: torch.Size([2048])
backbone.layers.24.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.25.norm.weight: torch.Size([1024])
backbone.layers.25.mixer.dt_bias: torch.Size([32])
backbone.layers.25.mixer.A_log: torch.Size([32])
backbone.layers.25.mixer.D: torch.Size([32])
backbone.layers.25.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.25.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.25.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.25.mixer.norm.weight: torch.Size([2048])
backbone.layers.25.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.26.norm.weight: torch.Size([1024])
backbone.layers.26.mixer.dt_bias: torch.Size([32])
backbone.layers.26.mixer.A_log: torch.Size([32])
backbone.layers.26.mixer.D: torch.Size([32])
backbone.layers.26.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.26.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.26.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.26.mixer.norm.weight: torch.Size([2048])
backbone.layers.26.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.27.norm.weight: torch.Size([1024])
backbone.layers.27.mixer.dt_bias: torch.Size([32])
backbone.layers.27.mixer.A_log: torch.Size([32])
backbone.layers.27.mixer.D: torch.Size([32])
backbone.layers.27.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.27.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.27.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.27.mixer.norm.weight: torch.Size([2048])
backbone.layers.27.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.28.norm.weight: torch.Size([1024])
backbone.layers.28.mixer.dt_bias: torch.Size([32])
backbone.layers.28.mixer.A_log: torch.Size([32])
backbone.layers.28.mixer.D: torch.Size([32])
backbone.layers.28.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.28.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.28.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.28.mixer.norm.weight: torch.Size([2048])
backbone.layers.28.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.29.norm.weight: torch.Size([1024])
backbone.layers.29.mixer.dt_bias: torch.Size([32])
backbone.layers.29.mixer.A_log: torch.Size([32])
backbone.layers.29.mixer.D: torch.Size([32])
backbone.layers.29.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.29.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.29.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.29.mixer.norm.weight: torch.Size([2048])
backbone.layers.29.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.30.norm.weight: torch.Size([1024])
backbone.layers.30.mixer.dt_bias: torch.Size([32])
backbone.layers.30.mixer.A_log: torch.Size([32])
backbone.layers.30.mixer.D: torch.Size([32])
backbone.layers.30.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.30.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.30.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.30.mixer.norm.weight: torch.Size([2048])
backbone.layers.30.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.31.norm.weight: torch.Size([1024])
backbone.layers.31.mixer.dt_bias: torch.Size([32])
backbone.layers.31.mixer.A_log: torch.Size([32])
backbone.layers.31.mixer.D: torch.Size([32])
backbone.layers.31.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.31.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.31.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.31.mixer.norm.weight: torch.Size([2048])
backbone.layers.31.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.32.norm.weight: torch.Size([1024])
backbone.layers.32.mixer.dt_bias: torch.Size([32])
backbone.layers.32.mixer.A_log: torch.Size([32])
backbone.layers.32.mixer.D: torch.Size([32])
backbone.layers.32.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.32.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.32.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.32.mixer.norm.weight: torch.Size([2048])
backbone.layers.32.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.33.norm.weight: torch.Size([1024])
backbone.layers.33.mixer.dt_bias: torch.Size([32])
backbone.layers.33.mixer.A_log: torch.Size([32])
backbone.layers.33.mixer.D: torch.Size([32])
backbone.layers.33.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.33.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.33.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.33.mixer.norm.weight: torch.Size([2048])
backbone.layers.33.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.34.norm.weight: torch.Size([1024])
backbone.layers.34.mixer.dt_bias: torch.Size([32])
backbone.layers.34.mixer.A_log: torch.Size([32])
backbone.layers.34.mixer.D: torch.Size([32])
backbone.layers.34.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.34.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.34.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.34.mixer.norm.weight: torch.Size([2048])
backbone.layers.34.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.35.norm.weight: torch.Size([1024])
backbone.layers.35.mixer.dt_bias: torch.Size([32])
backbone.layers.35.mixer.A_log: torch.Size([32])
backbone.layers.35.mixer.D: torch.Size([32])
backbone.layers.35.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.35.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.35.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.35.mixer.norm.weight: torch.Size([2048])
backbone.layers.35.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.36.norm.weight: torch.Size([1024])
backbone.layers.36.mixer.dt_bias: torch.Size([32])
backbone.layers.36.mixer.A_log: torch.Size([32])
backbone.layers.36.mixer.D: torch.Size([32])
backbone.layers.36.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.36.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.36.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.36.mixer.norm.weight: torch.Size([2048])
backbone.layers.36.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.37.norm.weight: torch.Size([1024])
backbone.layers.37.mixer.dt_bias: torch.Size([32])
backbone.layers.37.mixer.A_log: torch.Size([32])
backbone.layers.37.mixer.D: torch.Size([32])
backbone.layers.37.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.37.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.37.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.37.mixer.norm.weight: torch.Size([2048])
backbone.layers.37.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.38.norm.weight: torch.Size([1024])
backbone.layers.38.mixer.dt_bias: torch.Size([32])
backbone.layers.38.mixer.A_log: torch.Size([32])
backbone.layers.38.mixer.D: torch.Size([32])
backbone.layers.38.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.38.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.38.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.38.mixer.norm.weight: torch.Size([2048])
backbone.layers.38.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.39.norm.weight: torch.Size([1024])
backbone.layers.39.mixer.dt_bias: torch.Size([32])
backbone.layers.39.mixer.A_log: torch.Size([32])
backbone.layers.39.mixer.D: torch.Size([32])
backbone.layers.39.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.39.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.39.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.39.mixer.norm.weight: torch.Size([2048])
backbone.layers.39.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.40.norm.weight: torch.Size([1024])
backbone.layers.40.mixer.dt_bias: torch.Size([32])
backbone.layers.40.mixer.A_log: torch.Size([32])
backbone.layers.40.mixer.D: torch.Size([32])
backbone.layers.40.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.40.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.40.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.40.mixer.norm.weight: torch.Size([2048])
backbone.layers.40.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.41.norm.weight: torch.Size([1024])
backbone.layers.41.mixer.dt_bias: torch.Size([32])
backbone.layers.41.mixer.A_log: torch.Size([32])
backbone.layers.41.mixer.D: torch.Size([32])
backbone.layers.41.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.41.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.41.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.41.mixer.norm.weight: torch.Size([2048])
backbone.layers.41.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.42.norm.weight: torch.Size([1024])
backbone.layers.42.mixer.dt_bias: torch.Size([32])
backbone.layers.42.mixer.A_log: torch.Size([32])
backbone.layers.42.mixer.D: torch.Size([32])
backbone.layers.42.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.42.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.42.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.42.mixer.norm.weight: torch.Size([2048])
backbone.layers.42.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.43.norm.weight: torch.Size([1024])
backbone.layers.43.mixer.dt_bias: torch.Size([32])
backbone.layers.43.mixer.A_log: torch.Size([32])
backbone.layers.43.mixer.D: torch.Size([32])
backbone.layers.43.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.43.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.43.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.43.mixer.norm.weight: torch.Size([2048])
backbone.layers.43.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.44.norm.weight: torch.Size([1024])
backbone.layers.44.mixer.dt_bias: torch.Size([32])
backbone.layers.44.mixer.A_log: torch.Size([32])
backbone.layers.44.mixer.D: torch.Size([32])
backbone.layers.44.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.44.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.44.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.44.mixer.norm.weight: torch.Size([2048])
backbone.layers.44.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.45.norm.weight: torch.Size([1024])
backbone.layers.45.mixer.dt_bias: torch.Size([32])
backbone.layers.45.mixer.A_log: torch.Size([32])
backbone.layers.45.mixer.D: torch.Size([32])
backbone.layers.45.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.45.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.45.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.45.mixer.norm.weight: torch.Size([2048])
backbone.layers.45.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.46.norm.weight: torch.Size([1024])
backbone.layers.46.mixer.dt_bias: torch.Size([32])
backbone.layers.46.mixer.A_log: torch.Size([32])
backbone.layers.46.mixer.D: torch.Size([32])
backbone.layers.46.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.46.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.46.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.46.mixer.norm.weight: torch.Size([2048])
backbone.layers.46.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.layers.47.norm.weight: torch.Size([1024])
backbone.layers.47.mixer.dt_bias: torch.Size([32])
backbone.layers.47.mixer.A_log: torch.Size([32])
backbone.layers.47.mixer.D: torch.Size([32])
backbone.layers.47.mixer.in_proj.weight: torch.Size([4384, 1024])
backbone.layers.47.mixer.conv1d.weight: torch.Size([2304, 1, 4])
backbone.layers.47.mixer.conv1d.bias: torch.Size([2304])
backbone.layers.47.mixer.norm.weight: torch.Size([2048])
backbone.layers.47.mixer.out_proj.weight: torch.Size([1024, 2048])
backbone.norm_f.weight: torch.Size([1024])
lm_head.weight: torch.Size([50288, 1024])
[FlaxMamba2LMHeadModel] Loaded state dict.
[Config] Initialized Mamba2Config with d_model=1024, n_layer=48, d_state=128, d_conv=4, expand=2, headdim=64, chunk_size=64, vocab_size=50288, pad_vocab_size_multiple=16
[Config] Computed d_inner=2048, nheads=32
On a dark September night, a fierce storm jolted Florida with winds and torrential rainfall. Less than two weeks later, Hurricane Milton has roared through the state, mercilessly hampering recovery efforts already underway.

After Helene’s strong winds, heavy rains and a wall of water took 20 lives in the state along its path from south to north, Milton has claimed at least 17 more, bringing the ocean’s fury ashore with several feet of storm surge, three months worth of rain in three hours to some areas and a deadly tornado outbreak as it churned from west to east.

The trail of destruction all the way from the [Mamba2LMHeadModel] Forward pass input_ids shape: (1, 128)
[Mamba2LMHeadModel] input_ids sample values: [2374  247 3644 4397 2360]
[Mamba2LMHeadModel] Embedding output shape: (1, 128, 1024)
[Mamba2LMHeadModel] Embedding sample values: [-0.11975098  0.16784668 -0.08422852 -0.1381836  -0.02110291]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.1699562   0.3031618  -0.13109386 -0.16758695 -0.02804597]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.1699562   0.3031618  -0.13109386 -0.16758695 -0.02804597]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.73431194 -0.3888542  -0.38057354  1.1946869  -0.05832741]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.73431194 -0.3888542  -0.38057354  1.1946869  -0.05832741]
  [FlaxMamba2] xBC (step) sample values: [ 0.05643919  0.26302984 -0.01529555 -0.3015223   0.12823424]
  [FlaxMamba2] dt (step) sample values: [0.39130813 0.10414988 0.21102211 0.2442246  0.10808858]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.08134818 0.03755776 0.02998279 0.03319907 0.02498237]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 0.33703423  0.5484117  -0.27020603  0.53985476  0.03411916]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 7.5697899e-05  2.0742416e-04 -6.3896179e-04  1.0147095e-03
 -2.5386810e-03]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.04206736 -0.01591528  0.11297233 -0.20400223 -0.18704699]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.02147603 -0.00789432  0.05967346 -0.09163282 -0.08480226]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.02147603 -0.00789432  0.05967346 -0.09163282 -0.08480226]
  [FlaxMamba2] B sample values: [-2.7834696e-01 -8.9746632e-02 -1.5881544e-02  6.4479291e-01
 -1.6733717e-04]
  [FlaxMamba2] C sample values: [-0.27798596  0.00718768 -0.05789709 -0.2132803   0.00370566]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.02147603 -0.00789432  0.05967346 -0.09163282 -0.08480226]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.4383634 -1.0010935 -1.2128745 -1.1529616 -1.4844131]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 0.00174704 -0.00064219  0.00485433 -0.00745416 -0.00689851]
  [ssd_jax] A after chunking sample values: [-0.03566007 -0.03759883 -0.03636536 -0.03827725 -0.03708415]
  [ssd_jax] B after chunking sample values: [-2.7834696e-01 -8.9746632e-02 -1.5881544e-02  6.4479291e-01
 -1.6733717e-04]
  [ssd_jax] C after chunking sample values: [-0.27798596  0.00718768 -0.05789709 -0.2132803   0.00370566]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.03566007 -0.03833179 -0.03074357 -0.03319288 -0.03801164]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.03566007 -0.07399186 -0.10473543 -0.1379283  -0.17593996]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 0.00061204 -0.00022498  0.00170061 -0.00261141 -0.00241675]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.14169848 0.14723548 0.15183231 0.15695664 0.16303767]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-1.3265228e-02 -6.4437854e-04  5.3973106e-04  3.1683948e-02
 -5.4222568e-05]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.         0.         0.         0.13673455 1.        ]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-0.01833273 -0.00391454 -0.0006591   0.04415916 -0.00085793]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.96496826 0.9286792  0.90056276 0.87116116 0.83866835]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 0.00061204 -0.00022498  0.00170061 -0.00261141 -0.00241675]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 0.00061204 -0.00022498  0.00170061 -0.00261141 -0.00241675]
  [FlaxMamba2] ssm_state sample values: [-0.01833273 -0.00391454 -0.0006591   0.04415916 -0.00085793]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.03744477 -0.01376422  0.10404431 -0.15976739 -0.1478579 ]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.03744477 -0.01376422  0.10404431 -0.15976739 -0.1478579 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0089156   0.00216228 -0.01607573 -0.1465092   0.00418636]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02979888  0.00596469 -0.04431584 -0.33117685  0.04845336]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.02979888  0.00596469 -0.04431584 -0.33117685  0.04845336]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-0.02953714 -0.38894817  0.5595935   0.05365241 -0.2493203 ]
  [Layer 1] Output shape after mixer: (1, 128, 1024)
  [Layer 1] Output sample values after mixer: [-0.02953714 -0.38894817  0.5595935   0.05365241 -0.2493203 ]
  [Layer 1] Residual connection shape: (1, 128, 1024)
  [Layer 1] Residual connection sample values: [-0.14928812 -0.2211015   0.47536498 -0.08453118 -0.2704232 ]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.15313683 -0.19047116  0.3779777  -0.09118155 -0.25253952]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.15313683 -0.19047116  0.3779777  -0.09118155 -0.25253952]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [ 3.7990654  -0.20069045 -2.5526876   1.1519494   0.45159262]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [ 3.7990654  -0.20069045 -2.5526876   1.1519494   0.45159262]
  [FlaxMamba2] xBC (step) sample values: [ 1.0059477   0.26616707 -0.81308824 -1.0744601  -0.08691804]
  [FlaxMamba2] dt (step) sample values: [ 0.0049839   0.64003253  1.6249346   0.5160538  -0.44915962]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.0506242  0.06530194 0.11923248 0.10288816 0.03654235]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 1.2845199   0.5080013   1.0932317  -0.63347316 -0.6966512 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.00085783  0.000525   -0.00012803 -0.01293945 -0.00102234]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.0495194  -0.0311145   0.00381443 -0.19837587  0.00340096]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.02537262 -0.01531524  0.00191085 -0.08938182  0.00170337]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.02537262 -0.01531524  0.00191085 -0.08938182  0.00170337]
  [FlaxMamba2] B sample values: [-0.00128761 -0.05087537  0.04647503 -0.01277109 -0.03899512]
  [FlaxMamba2] C sample values: [-0.07952655  0.47148874 -0.24561784  0.09014813  0.39521122]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.02537262 -0.01531524  0.00191085 -0.08938182  0.00170337]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-12.692555   -19.429585    -0.22886811  -2.10566     -5.0388985 ]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 1.2844685e-03 -7.7532185e-04  9.6735348e-05 -4.5248829e-03
  8.6231783e-05]
  [ssd_jax] A after chunking sample values: [-0.6425504  -1.2687895  -0.02728851 -0.21664748 -0.1841332 ]
  [ssd_jax] B after chunking sample values: [-0.00128761 -0.05087537  0.04647503 -0.01277109 -0.03899512]
  [ssd_jax] C after chunking sample values: [-0.07952655  0.47148874 -0.24561784  0.09014813  0.39521122]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.6425504  -0.34434247 -3.0066137  -2.092874   -2.0832758 ]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.6425504 -0.9868929 -3.9935067 -6.086381  -8.169657 ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 9.5210780e-05 -5.7470465e-05  7.1704744e-06 -3.3540538e-04
  6.3919015e-06]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.0000000e+00 0.0000000e+00 2.2817525e-37 1.8500845e-36 1.4857520e-35]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.00041543  0.00062291  0.0007709  -0.00090062 -0.00108258]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1. 0. 0. 0. 1.]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-6.4442298e-05  8.6591503e-04 -9.2184974e-04 -6.9879787e-04
  4.8482692e-04]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [5.2594930e-01 3.7273303e-01 1.8434955e-02 2.2736224e-03 2.8311517e-04]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 9.5210780e-05 -5.7470465e-05  7.1704744e-06 -3.3540538e-04
  6.3919015e-06]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 9.5210780e-05 -5.7470465e-05  7.1704744e-06 -3.3540538e-04
  6.3919015e-06]
  [FlaxMamba2] ssm_state sample values: [-6.4442298e-05  8.6591503e-04 -9.2184974e-04 -6.9879787e-04
  4.8482692e-04]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.01700928 -0.01026702  0.001281   -0.05991972  0.0011419 ]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.01700928 -0.01026702  0.001281   -0.05991972  0.0011419 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.06320411  0.00092721 -0.00023624 -0.05244941  0.00031509]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04968381  0.00102468 -0.0002363  -0.03454495  0.00036219]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.04968381  0.00102468 -0.0002363  -0.03454495  0.00036219]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [0.22814955 0.16455165 0.07459018 0.30839244 0.07355886]
  [Layer 2] Output shape after mixer: (1, 128, 1024)
  [Layer 2] Output sample values after mixer: [0.22814955 0.16455165 0.07459018 0.30839244 0.07355886]
  [Layer 2] Residual connection shape: (1, 128, 1024)
  [Layer 2] Residual connection sample values: [ 0.07886143 -0.05654985  0.5499551   0.22386125 -0.19686434]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.07563289 -0.04551081  0.39424533  0.22979046 -0.18020348]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.07563289 -0.04551081  0.39424533  0.22979046 -0.18020348]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.0729663  -0.55537796  0.06469801  0.69702494  1.4761729 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-1.0729663  -0.55537796  0.06469801  0.69702494  1.4761729 ]
  [FlaxMamba2] xBC (step) sample values: [-0.105804   -1.1216394  -1.815068    1.438968    0.84992254]
  [FlaxMamba2] dt (step) sample values: [-0.24864867  1.464309    0.8281385   1.4507749   2.2240407 ]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.00980709 0.02077055 0.00010311 0.02214118 0.0914166 ]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 1.1285411  -0.3213415   0.15875363 -2.017992    0.34926343]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.0019474   0.00145245  0.00068903 -0.00224495  0.00110626]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.06158645 -0.06672826 -0.0091302  -0.07394525 -0.07834329]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.0298453  -0.03225138 -0.00454426 -0.03560627 -0.03763802]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.0298453  -0.03225138 -0.00454426 -0.03560627 -0.03763802]
  [FlaxMamba2] B sample values: [-0.27396148 -0.02275926  0.0076806   0.05686322  0.33533713]
  [FlaxMamba2] C sample values: [-0.2632561   0.7559915   0.24248604  0.7769866   0.16878036]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.0298453  -0.03225138 -0.00454426 -0.03560627 -0.03763802]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-20.926485    -0.880345    -0.67350245  -0.6461216   -0.27258503]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-2.9269548e-04 -3.1629211e-04 -4.4565968e-05 -3.4919384e-04
 -3.6911931e-04]
  [ssd_jax] A after chunking sample values: [-2.0522787e-01 -1.8285248e-02 -6.9444039e-05 -1.4305894e-02
 -2.4918796e-02]
  [ssd_jax] B after chunking sample values: [-0.27396148 -0.02275926  0.0076806   0.05686322  0.33533713]
  [ssd_jax] C after chunking sample values: [-0.2632561   0.7559915   0.24248604  0.7769866   0.16878036]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.20522787 -0.50492895 -0.20658368 -0.58862305 -0.15199701]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.20522787 -0.7101568  -0.9167405  -1.5053635  -1.6573606 ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.00090035 -0.00097293 -0.00013709 -0.00107414 -0.00113543]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [1.4319989e-12 2.3726320e-12 2.9170796e-12 5.2551366e-12 6.1178003e-12]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.00132559 -0.00022838  0.00014183 -0.00017319  0.00041583]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 1.1663073e-12 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.00103072 -0.00066147 -0.00140207 -0.00028169  0.00092741]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.8144617  0.4915671  0.39982015 0.22193661 0.19064151]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.00090035 -0.00097293 -0.00013709 -0.00107414 -0.00113543]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.00090035 -0.00097293 -0.00013709 -0.00107414 -0.00113543]
  [FlaxMamba2] ssm_state sample values: [ 0.00103072 -0.00066147 -0.00140207 -0.00028169  0.00092741]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.02208771 -0.02386838 -0.00336309 -0.02635125 -0.02785489]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.02208771 -0.02386838 -0.00336309 -0.02635125 -0.02785489]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00603953  0.00483336 -0.00011231 -0.0122608  -0.03347031]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 4.5808498e-03  3.2706435e-03 -6.0037833e-05 -7.2937598e-03
 -2.9589908e-02]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 4.5808498e-03  3.2706435e-03 -6.0037833e-05 -7.2937598e-03
 -2.9589908e-02]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 0.30716532  0.21834554 -0.11873402  0.02658789  0.18903543]
  [Layer 3] Output shape after mixer: (1, 128, 1024)
  [Layer 3] Output sample values after mixer: [ 0.30716532  0.21834554 -0.11873402  0.02658789  0.18903543]
  [Layer 3] Residual connection shape: (1, 128, 1024)
  [Layer 3] Residual connection sample values: [ 0.38602674  0.16179569  0.43122113  0.25044915 -0.00782891]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.23845555  0.08655721  0.21717592  0.16448867 -0.0045504 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.23845555  0.08655721  0.21717592  0.16448867 -0.0045504 ]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.788879   -1.507844   -1.0587697  -0.96252334  0.46538222]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.788879   -1.507844   -1.0587697  -0.96252334  0.46538222]
  [FlaxMamba2] xBC (step) sample values: [ 1.0282412  -0.37694913 -1.582556   -0.02650795  0.503827  ]
  [FlaxMamba2] dt (step) sample values: [2.8055882 2.158136  1.1813552 2.3262866 1.2433836]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.5652909  0.41060647 0.24969944 0.3456148  0.856615  ]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-0.11750512 -0.5863846  -2.334062   -0.80816627 -0.7743687 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.00901794 -0.00475693 -0.00036621  0.03378296  0.0171051 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.03719541  0.04265133  0.12380037 -0.06878736  0.2589299 ]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.01825187  0.02178038  0.06572694 -0.03321122  0.14613311]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.01825187  0.02178038  0.06572694 -0.03321122  0.14613311]
  [FlaxMamba2] B sample values: [-0.27788636  0.4112095  -0.02805032 -0.02428086 -0.03579209]
  [FlaxMamba2] C sample values: [-0.27226308 -0.03524829 -0.19116412 -0.07495003  0.5311671 ]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.01825187  0.02178038  0.06572694 -0.03321122  0.14613311]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.49070406 -0.5047996  -0.6491257  -0.5552266  -0.46572492]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.01031762  0.01231225  0.03715484 -0.018774    0.08260772]
  [ssd_jax] A after chunking sample values: [-0.27739054 -0.20727399 -0.16208632 -0.19189453 -0.39894694]
  [ssd_jax] B after chunking sample values: [-0.27788636  0.4112095  -0.02805032 -0.02428086 -0.03579209]
  [ssd_jax] C after chunking sample values: [-0.27226308 -0.03524829 -0.19116412 -0.07495003  0.5311671 ]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.27739054 -0.06929943 -0.10431873 -0.16035295 -0.12925093]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.27739054 -0.34668997 -0.4510087  -0.6113616  -0.7406126 ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.00409256  0.00488375  0.01473776 -0.00744685  0.032767  ]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.01258708 0.0134903  0.01497361 0.01757789 0.02000321]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.02525627 -0.00142854  0.00062397  0.00280809 -0.00158483]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.         0.         0.         0.00953797 1.        ]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-0.02865    -0.00326405 -0.00040672  0.00126906  0.00060749]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.7577585  0.7070245  0.6369853  0.54261154 0.47682172]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.00409256  0.00488375  0.01473776 -0.00744685  0.032767  ]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.00409256  0.00488375  0.01473776 -0.00744685  0.032767  ]
  [FlaxMamba2] ssm_state sample values: [-0.02865    -0.00326405 -0.00040672  0.00126906  0.00060749]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.01619995  0.01933178  0.05833775 -0.02947753  0.12970446]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.01619995  0.01933178  0.05833775 -0.02947753  0.12970446]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00399253 -0.00528356 -0.01590756  0.00784149  0.03707988]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00455823 -0.00647814 -0.0162888   0.00884222  0.0304462 ]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.00455823 -0.00647814 -0.0162888   0.00884222  0.0304462 ]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 0.2636641  -0.1758008  -0.04865581  0.17099874  0.45162913]
  [Layer 4] Output shape after mixer: (1, 128, 1024)
  [Layer 4] Output sample values after mixer: [ 0.2636641  -0.1758008  -0.04865581  0.17099874  0.45162913]
  [Layer 4] Residual connection shape: (1, 128, 1024)
  [Layer 4] Residual connection sample values: [ 0.64969087 -0.01400511  0.38256532  0.42144787  0.4438002 ]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.5328157  -0.00968321  0.23118976  0.34461257  0.3452821 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.5328157  -0.00968321  0.23118976  0.34461257  0.3452821 ]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.9197177 -2.505177   1.3588152  0.5768597 -1.4251988]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.9197177 -2.505177   1.3588152  0.5768597 -1.4251988]
  [FlaxMamba2] xBC (step) sample values: [-1.6494     -1.4314852  -0.67159975 -1.4166725  -0.31593055]
  [FlaxMamba2] dt (step) sample values: [ 3.9663672   2.7325811   4.0852313   0.5751596  -0.11992076]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [2.3031144  0.19616076 1.1725005  0.02484494 0.01440166]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-1.0936339e+00  2.0134449e-03 -6.2854677e-01 -2.4791298e+00
  2.1692161e-01]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 0.03634644  0.05859375 -0.01337433 -0.00224495 -0.00379372]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.48093942 -0.6121352  -0.10777935  0.1908983   0.0421788 ]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.18373343 -0.21520977 -0.05098839  0.10453212  0.0215341 ]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.18373343 -0.21520977 -0.05098839  0.10453212  0.0215341 ]
  [FlaxMamba2] B sample values: [-0.03069041 -0.10296221 -0.2764719  -0.00318284 -0.06633564]
  [FlaxMamba2] C sample values: [ 0.00157262 -0.23406175 -0.27502638 -0.2350334  -0.13329074]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.18373343 -0.21520977 -0.05098839  0.10453212  0.0215341 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.07591622 -0.53187454 -0.04695368 -1.4938657  -3.6258397 ]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.42315912 -0.4956527  -0.11743209  0.24074943  0.0495955 ]
  [ssd_jax] A after chunking sample values: [-0.17484373 -0.10433292 -0.05505321 -0.037115   -0.05221813]
  [ssd_jax] B after chunking sample values: [-0.03069041 -0.10296221 -0.2764719  -0.00318284 -0.06633564]
  [ssd_jax] C after chunking sample values: [ 0.00157262 -0.23406175 -0.27502638 -0.2350334  -0.13329074]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.17484373 -0.0924689  -0.07118427 -0.09804813 -0.10268672]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.17484373 -0.26731262 -0.3384969  -0.436545   -0.5392317 ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.57255405 -0.67064124 -0.1588911   0.32574522  0.06710503]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.03963713 0.04347713 0.04668484 0.05149412 0.05706291]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.00648105 -0.06348262  0.4513519   0.04168509  0.15977013]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.         0.         0.         0.03327887 1.        ]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-0.03668202 -0.00666272  0.55450875  0.0618659  -0.01450898]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.8395882  0.7654337  0.71284103 0.6462654  0.58319616]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.57255405 -0.67064124 -0.1588911   0.32574522  0.06710503]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.57255405 -0.67064124 -0.1588911   0.32574522  0.06710503]
  [FlaxMamba2] ssm_state sample values: [-0.03668202 -0.00666272  0.55450875  0.0618659  -0.01450898]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.8311207  -0.9735043  -0.23064667  0.47285247  0.0974098 ]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.8311207  -0.9735043  -0.23064667  0.47285247  0.0974098 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.21786477  0.1841198  -0.24933568  0.17466646 -0.02691158]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0111728   0.00997922 -0.02766996  0.02130208 -0.0035675 ]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.0111728   0.00997922 -0.02766996  0.02130208 -0.0035675 ]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-0.14166358  0.09205786  0.1259076   0.34319425  0.0533233 ]
  [Layer 5] Output shape after mixer: (1, 128, 1024)
  [Layer 5] Output sample values after mixer: [-0.14166358  0.09205786  0.1259076   0.34319425  0.0533233 ]
  [Layer 5] Residual connection shape: (1, 128, 1024)
  [Layer 5] Residual connection sample values: [0.5080273  0.07805275 0.5084729  0.7646421  0.4971235 ]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [0.33890808 0.04301541 0.2644039  0.48902738 0.29628333]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [0.33890808 0.04301541 0.2644039  0.48902738 0.29628333]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.1898758   0.11143327  1.0466619  -0.16265345 -1.9528165 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-2.1898758   0.11143327  1.0466619  -0.16265345 -1.9528165 ]
  [FlaxMamba2] xBC (step) sample values: [ 4.877984  -0.4891344  0.7434631 -2.9950736  1.1079654]
  [FlaxMamba2] dt (step) sample values: [1.7433422 2.4544349 1.695738  1.5721337 1.4285283]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.653995   0.88966393 0.3776989  0.5403864  0.34810367]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 0.79507214  1.2019434  -2.3851976   0.18457492  0.6421571 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 0.00385284 -0.00226402  0.00827026  0.00201416 -0.00151348]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.0276003   0.00779006  0.19495353 -0.14521949  0.22974762]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.01399058  0.0039102   0.1069485  -0.06734682  0.12801206]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.01399058  0.0039102   0.1069485  -0.06734682  0.12801206]
  [FlaxMamba2] B sample values: [ 0.09283277  0.09512431 -0.27832392  0.03106    -0.15669572]
  [FlaxMamba2] C sample values: [ 0.12819605 -0.01867489 -0.27067116 -0.14620356 -0.08371489]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.01399058  0.0039102   0.1069485  -0.06734682  0.12801206]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.5109995  -0.28622514 -0.5421001  -0.39544863 -0.5985869 ]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 0.00914977  0.00255725  0.06994379 -0.04404448  0.08371925]
  [ssd_jax] A after chunking sample values: [-0.3341911  -0.2546442  -0.2047506  -0.21369505 -0.2083703 ]
  [ssd_jax] B after chunking sample values: [ 0.09283277  0.09512431 -0.27832392  0.03106    -0.15669572]
  [ssd_jax] C after chunking sample values: [ 0.12819605 -0.01867489 -0.27067116 -0.14620356 -0.08371489]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.3341911  -0.34239942 -0.24140763 -0.26674533 -0.12583178]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.3341911  -0.67659056 -0.91799814 -1.1847434  -1.3105752 ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 0.01325917  0.00370578  0.10135735 -0.06382599  0.12131973]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [6.7829933e-07 9.5526445e-07 1.2160895e-06 1.5878580e-06 1.8007757e-06]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.004813    0.01358318 -0.05333489  0.00042577  0.01841731]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.000000e+00 0.000000e+00 0.000000e+00 4.856059e-07 1.000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-0.00624979 -0.00660945 -0.0185479   0.01210808  0.01564306]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.715917   0.5083472  0.39931762 0.30582464 0.26966488]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 0.01325917  0.00370578  0.10135735 -0.06382599  0.12131973]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 0.01325917  0.00370578  0.10135735 -0.06382599  0.12131973]
  [FlaxMamba2] ssm_state sample values: [-0.00624979 -0.00660945 -0.0185479   0.01210808  0.01564306]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.02930706  0.00819098  0.22403264 -0.14107616  0.26815596]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.02930706  0.00819098  0.22403264 -0.14107616  0.26815596]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00646046  0.00048177  0.17355122  0.01054223 -0.06506289]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00184894  0.00013195  0.04519337  0.00337625 -0.01516446]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.00184894  0.00013195  0.04519337  0.00337625 -0.01516446]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 0.33420578 -0.1786783  -0.30727482 -0.21762441  0.2047181 ]
  [Layer 6] Output shape after mixer: (1, 128, 1024)
  [Layer 6] Output sample values after mixer: [ 0.33420578 -0.1786783  -0.30727482 -0.21762441  0.2047181 ]
  [Layer 6] Residual connection shape: (1, 128, 1024)
  [Layer 6] Residual connection sample values: [ 0.84223306 -0.10062555  0.2011981   0.5470177   0.7018416 ]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.5331378  -0.0517347   0.1004525   0.3495163   0.38527173]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.5331378  -0.0517347   0.1004525   0.3495163   0.38527173]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.0558074  -0.16731942 -1.3199841  -0.70755243 -1.1298008 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-1.0558074  -0.16731942 -1.3199841  -0.70755243 -1.1298008 ]
  [FlaxMamba2] xBC (step) sample values: [-1.230219    0.97888243 -1.7089727   1.2474669   0.40217337]
  [FlaxMamba2] dt (step) sample values: [7.086752  3.2144575 1.8580505 2.181108  4.319546 ]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [6.6500583  0.60893786 0.21285596 0.84332395 2.8351293 ]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-0.352737   -2.2186885  -1.9644709  -2.875366   -0.84670556]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 0.00468063 -0.00222778  0.01657104  0.013237   -0.00286484]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.26865146  0.11559719 -0.45183104  0.17978214  0.00755881]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.11639006  0.06113556 -0.1757286   0.09794977  0.00379369]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.11639006  0.06113556 -0.1757286   0.09794977  0.00379369]
  [FlaxMamba2] B sample values: [ 0.00854135 -0.00055254 -0.01657563 -0.00925546 -0.00995679]
  [FlaxMamba2] C sample values: [ 0.06168219 -0.0431889  -0.02544602 -0.01190445  0.02271001]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.11639006  0.06113556 -0.1757286   0.09794977  0.00379369]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-6.5957151e-02 -4.5478220e+00 -5.8281250e+00 -4.2033669e-01
 -1.9005252e-03]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.7740007   0.40655503 -1.1686054   0.6513717   0.02522825]
  [ssd_jax] A after chunking sample values: [-0.4386189  -2.769341   -1.2405511  -0.35448    -0.00538823]
  [ssd_jax] B after chunking sample values: [ 0.00854135 -0.00055254 -0.01657563 -0.00925546 -0.00995679]
  [ssd_jax] C after chunking sample values: [ 0.06168219 -0.0431889  -0.02544602 -0.01190445  0.02271001]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.4386189  -0.09801383 -0.08429009 -0.03904787 -0.0486655 ]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.4386189  -0.5366327  -0.6209228  -0.65997064 -0.70863616]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.08804754  0.04624824 -0.13293636  0.07409771  0.00286987]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.04169719 0.04599108 0.05003574 0.05202818 0.05462278]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.00930038  0.00265051 -0.01483406  0.02055426  0.06780016]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.         0.         0.         0.02689162 1.        ]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.08655278  0.03238861 -0.02861067  0.03753403  0.10917652]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.64492655 0.5847138  0.5374482  0.5168665  0.49231517]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.08804754  0.04624824 -0.13293636  0.07409771  0.00286987]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.08804754  0.04624824 -0.13293636  0.07409771  0.00286987]
  [FlaxMamba2] ssm_state sample values: [ 0.08655278  0.03238861 -0.02861067  0.03753403  0.10917652]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.35790414  0.18799432 -0.54037255  0.3011995   0.01166574]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.35790414  0.18799432 -0.54037255  0.3011995   0.01166574]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0975346  -0.01441485  0.15037504 -0.07035758 -0.00321852]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03093075 -0.00551698  0.03450835 -0.01955739 -0.0019579 ]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.03093075 -0.00551698  0.03450835 -0.01955739 -0.0019579 ]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-0.09237458 -0.1412441  -0.12550871 -0.29906097  0.21596435]
  [Layer 7] Output shape after mixer: (1, 128, 1024)
  [Layer 7] Output sample values after mixer: [-0.09237458 -0.1412441  -0.12550871 -0.29906097  0.21596435]
  [Layer 7] Residual connection shape: (1, 128, 1024)
  [Layer 7] Residual connection sample values: [ 0.7498585  -0.24186966  0.07568939  0.24795672  0.9178059 ]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.5663267  -0.13674639  0.03998852  0.18238775  0.5808869 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.5663267  -0.13674639  0.03998852  0.18238775  0.5808869 ]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.5205877   0.3024813   0.8428359   0.2330181  -0.37474588]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-2.5205877   0.3024813   0.8428359   0.2330181  -0.37474588]
  [FlaxMamba2] xBC (step) sample values: [ 1.7424893 -1.8359026  2.7380786 -2.0785897 -1.2885939]
  [FlaxMamba2] dt (step) sample values: [3.181558  3.714486  3.4074664 3.8241498 3.844214 ]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.37692535 5.0383744  2.5340712  3.1464279  4.949956  ]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-1.065525   -2.1382127  -1.6701803   0.11993328  1.4567474 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 0.01262665 -0.01623535  0.00114059 -0.00148869  0.00107384]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.24187946  0.5292731   0.22042899 -0.32122475 -0.27790344]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.13549526  0.3330787   0.12231278 -0.1350356  -0.11976744]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.13549526  0.3330787   0.12231278 -0.1350356  -0.11976744]
  [FlaxMamba2] B sample values: [ 0.03699468  0.10291249 -0.03648622 -0.00997422 -0.00469097]
  [FlaxMamba2] C sample values: [-0.21818665  0.01131452 -0.0370319  -0.04298864 -0.04697398]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.13549526  0.3330787   0.12231278 -0.1350356  -0.11976744]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6851114  -0.13800453 -0.41180432 -0.26783535 -0.12443344]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 0.0510716   0.12554581  0.04610279 -0.05089834 -0.04514338]
  [ssd_jax] A after chunking sample values: [-0.25823584 -0.69531846 -1.0435414  -0.8427246  -0.61594003]
  [ssd_jax] B after chunking sample values: [ 0.03699468  0.10291249 -0.03648622 -0.00997422 -0.00469097]
  [ssd_jax] C after chunking sample values: [-0.21818665  0.01131452 -0.0370319  -0.04298864 -0.04697398]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.25823584 -1.0192213  -0.2820163  -0.05678856 -0.0346038 ]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.25823584 -1.2774571  -1.5594735  -1.616262   -1.6508658 ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 0.01165219  0.02864377  0.01051853 -0.01161266 -0.01029964]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [2.1695603e-06 6.0119301e-06 7.9706224e-06 8.4363528e-06 8.7333947e-06]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.00261768 -0.0283121  -0.00375538  0.02051913  0.00696173]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 1.6757965e-06 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-0.01261832  0.02075284  0.00751896  0.016035   -0.0016901 ]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.772413   0.2787452  0.21024674 0.19863984 0.19188371]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 0.01165219  0.02864377  0.01051853 -0.01161266 -0.01029964]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 0.01165219  0.02864377  0.01051853 -0.01161266 -0.01029964]
  [FlaxMamba2] ssm_state sample values: [-0.01261832  0.02075284  0.00751896  0.016035   -0.0016901 ]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.5219833   1.2831559   0.47119904 -0.5202126  -0.46139336]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.5219833   1.2831559   0.47119904 -0.5202126  -0.46139336]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.09792455  0.22319415  0.27762797 -0.06763925  0.07044069]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02134531  0.02567931  0.09837765 -0.02041259  0.01457767]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.02134531  0.02567931  0.09837765 -0.02041259  0.01457767]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-0.15511398 -0.17824179 -0.05700092 -0.1369769   0.27857772]
  [Layer 8] Output shape after mixer: (1, 128, 1024)
  [Layer 8] Output sample values after mixer: [-0.15511398 -0.17824179 -0.05700092 -0.1369769   0.27857772]
  [Layer 8] Residual connection shape: (1, 128, 1024)
  [Layer 8] Residual connection sample values: [ 0.5947445  -0.42011145  0.01868847  0.11097983  1.1963836 ]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.4037475  -0.2204065   0.00938718  0.07553957  0.70742035]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.4037475  -0.2204065   0.00938718  0.07553957  0.70742035]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.9915438  1.7963102  0.8148641 -3.8458328 -3.2366328]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-2.9915438  1.7963102  0.8148641 -3.8458328 -3.2366328]
  [FlaxMamba2] xBC (step) sample values: [ 0.5633751   3.757058   -0.21621549  1.1133845  -0.09621525]
  [FlaxMamba2] dt (step) sample values: [3.7637124 4.6013184 4.94207   3.3624983 3.407825 ]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [4.1958766 5.4114575 6.7313495 2.017843  3.6278722]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 1.556402   2.5571475 -0.6422956  0.8244302  1.8411772]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.05023193 -0.00361252  0.00088263 -0.0005641   0.00134754]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.33559978  0.4482428  -0.01988298  0.08609745 -0.03367164]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.13990441  0.27352732 -0.00984266  0.04490077 -0.0165524 ]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.13990441  0.27352732 -0.00984266  0.04490077 -0.0165524 ]
  [FlaxMamba2] B sample values: [ 0.18520519  0.03945937  0.07776622 -0.27705967 -0.23486355]
  [FlaxMamba2] C sample values: [ 0.00313686 -0.27474892  0.1724074  -0.09087885 -0.03554154]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.13990441  0.27352732 -0.00984266  0.04490077 -0.0165524 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17008033 -0.11351943 -0.10539922 -0.5864362  -0.14965628]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.58702165  1.1476868  -0.04129858  0.18839811 -0.06945183]
  [ssd_jax] A after chunking sample values: [-0.7136361  -0.61430556 -0.709479   -1.1833363  -0.5429339 ]
  [ssd_jax] B after chunking sample values: [ 0.18520519  0.03945937  0.07776622 -0.27705967 -0.23486355]
  [ssd_jax] C after chunking sample values: [ 0.00313686 -0.27474892  0.1724074  -0.09087885 -0.03554154]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.7136361  -0.7474141  -0.5562462  -0.6660715  -0.23750682]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.7136361 -1.4610503 -2.0172963 -2.6833677 -2.9208746]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 0.06404272 -0.12521003  0.00450558 -0.0205538   0.00757704]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [1.9090221e-15 4.0309764e-15 7.0304628e-15 1.3685343e-14 1.7354160e-14]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.07072289  0.01855207 -0.11848296  0.11578279  0.00874747]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.000000e+00 0.000000e+00 0.000000e+00 9.351547e-16 1.000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.08266243 -0.28808093 -0.09854738  0.50540113  0.4393937 ]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.4898598  0.23199248 0.1330146  0.06833264 0.05388654]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 0.06404272 -0.12521003  0.00450558 -0.0205538   0.00757704]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 0.06404272 -0.12521003  0.00450558 -0.0205538   0.00757704]
  [FlaxMamba2] ssm_state sample values: [ 0.08266243 -0.28808093 -0.09854738  0.50540113  0.4393937 ]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.31082675  0.60769784 -0.02186751  0.09975641 -0.03677461]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.31082675  0.60769784 -0.02186751  0.09975641 -0.03677461]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.04445563  0.93627626 -0.01235119 -0.00802647  0.00450039]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00629366  0.24705948 -0.00217933 -0.0016246   0.00091448]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.00629366  0.24705948 -0.00217933 -0.0016246   0.00091448]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 0.6412162  -0.41035783  0.02334592 -0.4570633   0.31460345]
  [Layer 9] Output shape after mixer: (1, 128, 1024)
  [Layer 9] Output sample values after mixer: [ 0.6412162  -0.41035783  0.02334592 -0.4570633   0.31460345]
  [Layer 9] Residual connection shape: (1, 128, 1024)
  [Layer 9] Residual connection sample values: [ 1.2359607  -0.83046925  0.04203439 -0.34608346  1.510987  ]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.8021224  -0.41175658  0.02034172 -0.22093621  0.83019555]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.8021224  -0.41175658  0.02034172 -0.22093621  0.83019555]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.9962883 -1.2882655  1.2612288 -2.3473945 -0.8939947]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-1.9962883 -1.2882655  1.2612288 -2.3473945 -0.8939947]
  [FlaxMamba2] xBC (step) sample values: [ 3.211055    0.27782112 -0.08881044  5.4533415   1.7910672 ]
  [FlaxMamba2] dt (step) sample values: [ 3.7969797  4.7383075  4.2964034  5.184056  10.382531 ]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [ 4.8836794  2.4890091  2.0750895  6.28553   10.107914 ]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 0.657721  -1.7998545 -1.7703952 -3.1214604 -1.5575364]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.00505829  0.01660156  0.01157379  0.00741959  0.00371552]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.525025   -0.04644279 -0.02176724  1.4567542  -0.29436958]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.19514023 -0.02268226 -0.01076517  1.1814797  -0.12567651]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.19514023 -0.02268226 -0.01076517  1.1814797  -0.12567651]
  [FlaxMamba2] B sample values: [-0.01676097  0.03585239  0.04470183 -0.17875718 -0.03537675]
  [FlaxMamba2] C sample values: [-0.2159922  -0.2636946  -0.12606075 -0.24952373 -0.26935855]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.19514023 -0.02268226 -0.01076517  1.1814797  -0.12567651]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.08535489 -0.07711172 -0.08452541 -0.0546804  -0.06966463]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.95300233 -0.11077287 -0.05257363  5.769968   -0.6137638 ]
  [ssd_jax] A after chunking sample values: [-0.41684595 -0.19193178 -0.17539778 -0.34369528 -0.70416415]
  [ssd_jax] B after chunking sample values: [-0.01676097  0.03585239  0.04470183 -0.17875718 -0.03537675]
  [ssd_jax] C after chunking sample values: [-0.2159922  -0.2636946  -0.12606075 -0.24952373 -0.26935855]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.41684595 -0.36882132 -0.32884473 -0.3836591  -0.20121948]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.41684595 -0.7856673  -1.114512   -1.4981711  -1.6993905 ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.89335155 -0.10383932 -0.04928292  5.408811   -0.57534677]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [2.3040332e-08 3.3317022e-08 4.6289376e-08 6.7936391e-08 8.3078952e-08]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.2328702  -0.1855034   0.01116356  0.19071004 -0.07347542]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.000000e+00 0.000000e+00 0.000000e+00 1.518641e-08 1.000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.02408395 -0.86179245  0.05021931  0.46458784  0.10694852]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.65912247 0.45581543 0.32807535 0.22353862 0.1827949 ]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.89335155 -0.10383932 -0.04928292  5.408811   -0.57534677]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.89335155 -0.10383932 -0.04928292  5.408811   -0.57534677]
  [FlaxMamba2] ssm_state sample values: [ 0.02408395 -0.86179245  0.05021931  0.46458784  0.10694852]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-1.8435173  -0.21428247 -0.10170007 11.161605   -1.1872838 ]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-1.8435173  -0.21428247 -0.10170007 11.161605   -1.1872838 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.44012588  0.05966784 -0.09995051 -2.2866154   0.3081171 ]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01527043  0.00442551 -0.00812958 -0.14304528  0.02336633]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.01527043  0.00442551 -0.00812958 -0.14304528  0.02336633]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 0.26893914 -0.58121204  0.27769667 -0.7229739   0.28763703]
  [Layer 10] Output shape after mixer: (1, 128, 1024)
  [Layer 10] Output sample values after mixer: [ 0.26893914 -0.58121204  0.27769667 -0.7229739   0.28763703]
  [Layer 10] Residual connection shape: (1, 128, 1024)
  [Layer 10] Residual connection sample values: [ 1.5048999  -1.4116813   0.31973106 -1.0690573   1.798624  ]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.64863604 -0.49367738  0.10845838 -0.5031516   0.6861283 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.64863604 -0.49367738  0.10845838 -0.5031516   0.6861283 ]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [ 2.5167873 -1.2346585 -0.5301548  1.4703918 -2.443235 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [ 2.5167873 -1.2346585 -0.5301548  1.4703918 -2.443235 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.852079   -1.0096596  -2.328738   -1.4686327   0.54676276]
  [FlaxMamba2] dt (step) sample values: [2.420803  8.816542  6.6714783 3.4671135 2.6430135]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [1.2763243 6.2013826 4.8686447 3.273661  2.7626035]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-0.7889544   0.37036133  2.1558917   0.68330896 -0.66946566]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [0.00239944 0.00061464 0.00197792 0.00163937 0.0229187 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.12707126  0.34916794  0.6680811   0.33205527  0.21617338]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.05950427  0.20475759  0.4416506   0.19334228  0.11972413]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.05950427  0.20475759  0.4416506   0.19334228  0.11972413]
  [FlaxMamba2] B sample values: [-0.27753967  0.00720317 -0.0465591  -0.246048    0.02108384]
  [FlaxMamba2] C sample values: [-0.27670598 -0.2712621   0.12777999  0.05716736 -0.25458255]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.05950427  0.20475759  0.4416506   0.19334228  0.11972413]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.25934154 -0.12614636 -0.10356269 -0.23775288 -0.43051487]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.07594675  0.26133707  0.56368935  0.24676745  0.15280682]
  [ssd_jax] A after chunking sample values: [-0.3310039  -0.7822819  -0.50420994 -0.77832234 -1.1893419 ]
  [ssd_jax] B after chunking sample values: [-0.27753967  0.00720317 -0.0465591  -0.246048    0.02108384]
  [ssd_jax] C after chunking sample values: [-0.27670598 -0.2712621   0.12777999  0.05716736 -0.25458255]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.3310039  -0.06428992 -0.00353829 -0.02761135 -0.16684626]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.3310039  -0.39529383 -0.3988321  -0.42644346 -0.59328973]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.06158695  0.21192421  0.4571086   0.20010936  0.12391454]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.0112123  0.01195682 0.0119992  0.01233513 0.01457486]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.12254819  0.0167308   0.02262824 -0.0802801   0.03232314]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.        0.        0.        0.0080527 1.       ]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-0.18591872  0.01060289  0.01845163 -0.08705708  0.11651221]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.71820235 0.6734821  0.67110336 0.6528268  0.5525067 ]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.06158695  0.21192421  0.4571086   0.20010936  0.12391454]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.06158695  0.21192421  0.4571086   0.20010936  0.12391454]
  [FlaxMamba2] ssm_state sample values: [-0.18591872  0.01060289  0.01845163 -0.08705708  0.11651221]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.1260981  -0.43391073 -0.93592095 -0.40972006 -0.25371262]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.1260981  -0.43391073 -0.93592095 -0.40972006 -0.25371262]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.2936584   0.12073629  0.18382627 -0.48986152  0.04954987]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01552713  0.04726846  0.12911005 -0.06467223  0.00763557]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.01552713  0.04726846  0.12911005 -0.06467223  0.00763557]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-0.66301006  0.42182475 -0.23081776 -0.06572463 -0.18118611]
  [Layer 11] Output shape after mixer: (1, 128, 1024)
  [Layer 11] Output sample values after mixer: [-0.66301006  0.42182475 -0.23081776 -0.06572463 -0.18118611]
  [Layer 11] Residual connection shape: (1, 128, 1024)
  [Layer 11] Residual connection sample values: [ 0.8418898  -0.98985654  0.08891329 -1.134782    1.617438  ]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.29650816 -0.27772862  0.02281226 -0.4532354   0.4820126 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.29650816 -0.27772862  0.02281226 -0.4532354   0.4820126 ]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.030947   -2.813062    1.5869702  -0.96692646 -0.5956974 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-2.030947   -2.813062    1.5869702  -0.96692646 -0.5956974 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.7557726   0.99959123  0.12954283 -0.19173995 -0.6383456 ]
  [FlaxMamba2] dt (step) sample values: [1.8004727 3.9657826 1.7827339 0.8059613 8.790609 ]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [2.4168558 3.7360144 2.6060116 2.2538056 6.1657586]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 0.18163478 -0.5676143   0.6178971  -2.6213522   0.57617104]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.03918457 -0.22583008  0.01174164 -0.01644897  0.00481033]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.0945079  -0.7036668  -0.08220041 -0.09039953 -0.05168948]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.04502268 -0.23291352 -0.03941193 -0.04315813 -0.02517694]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.04502268 -0.23291352 -0.03941193 -0.04315813 -0.02517694]
  [FlaxMamba2] B sample values: [ 0.00973094 -0.2643779   0.19328205  0.3734932   0.02318188]
  [FlaxMamba2] C sample values: [ 0.18011752 -0.23439348 -0.19814983 -0.26334414  0.7611952 ]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.04502268 -0.23291352 -0.03941193 -0.04315813 -0.02517694]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.16087165 -0.14748003 -0.27125728 -0.11553253 -0.09015273]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.10881332 -0.5629184  -0.09525295 -0.10430698 -0.06084903]
  [ssd_jax] A after chunking sample values: [-0.3888036  -0.5509875  -0.70689964 -0.26038787 -0.55586   ]
  [ssd_jax] B after chunking sample values: [ 0.00973094 -0.2643779   0.19328205  0.3734932   0.02318188]
  [ssd_jax] C after chunking sample values: [ 0.18011752 -0.23439348 -0.19814983 -0.26334414  0.7611952 ]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.3888036  -0.387428   -0.3996927  -0.37461546 -0.2194294 ]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.3888036 -0.7762316 -1.1759243 -1.5505397 -1.7699692]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.11854015 -0.61323774 -0.10376761 -0.11363099 -0.06628833]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [7.7159701e-09 1.1367069e-08 1.6952463e-08 2.4656185e-08 3.0706019e-08]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.05589173 -0.01388093  0.04097104 -0.10715251 -0.01896783]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 5.2304054e-09 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-0.01914767  0.2446764   0.06951936  0.06525891 -0.0095718 ]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.6778674  0.46013674 0.30853367 0.21213345 0.17033823]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.11854015 -0.61323774 -0.10376761 -0.11363099 -0.06628833]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.11854015 -0.61323774 -0.10376761 -0.11363099 -0.06628833]
  [FlaxMamba2] ssm_state sample values: [-0.01914767  0.2446764   0.06951936  0.06525891 -0.0095718 ]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.19160572 -0.99122405 -0.16772771 -0.18367064 -0.10714701]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.19160572 -0.99122405 -0.16772771 -0.18367064 -0.10714701]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.04513717  0.15788448 -0.22097887  0.04892655  0.02267963]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0081182   0.01659203 -0.04547333  0.01900382  0.00350947]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.0081182   0.01659203 -0.04547333  0.01900382  0.00350947]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-0.19738312 -0.69231254  0.3133986  -0.25868362 -0.00976717]
  [Layer 12] Output shape after mixer: (1, 128, 1024)
  [Layer 12] Output sample values after mixer: [-0.19738312 -0.69231254  0.3133986  -0.25868362 -0.00976717]
  [Layer 12] Residual connection shape: (1, 128, 1024)
  [Layer 12] Residual connection sample values: [ 0.6445067 -1.6821691  0.4023119 -1.3934655  1.6076708]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.17257686 -0.3678287   0.08373775 -0.40143526  0.3861481 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.17257686 -0.3678287   0.08373775 -0.40143526  0.3861481 ]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.5338807  -0.2757572  -2.7527704  -1.5597367  -0.26728848]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.5338807  -0.2757572  -2.7527704  -1.5597367  -0.26728848]
  [FlaxMamba2] xBC (step) sample values: [-0.605035   -1.5175478  -0.26868442 -0.30322367 -0.79601574]
  [FlaxMamba2] dt (step) sample values: [ 2.421321    0.30418026  0.7622893  -0.16113599  0.70213974]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.47460538 0.01356495 0.01816019 0.00447402 0.28694317]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 1.2613349   0.11038116  0.27914023 -0.41646534  0.00633761]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 0.01940918 -0.01044464  0.01003265 -0.00370979 -0.02119446]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.08594697 -0.1016524   0.00467717 -0.02610055 -0.2004886 ]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.0411279  -0.04824512  0.00234406 -0.01287998 -0.09022891]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.0411279  -0.04824512  0.00234406 -0.01287998 -0.09022891]
  [FlaxMamba2] B sample values: [-0.01174774 -0.13788778  0.23913537 -0.13146949 -0.02247031]
  [FlaxMamba2] C sample values: [ 0.02080468 -0.00709071  0.7880737   0.28253657 -0.10844219]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.0411279  -0.04824512  0.00234406 -0.01287998 -0.09022891]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.02338035 -1.090337   -0.5085105  -0.67845345 -0.02513249]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.01951952 -0.0228974   0.0011125  -0.00611291 -0.04282312]
  [ssd_jax] A after chunking sample values: [-0.01109644 -0.01479036 -0.00923465 -0.00303541 -0.0072116 ]
  [ssd_jax] B after chunking sample values: [-0.01174774 -0.13788778  0.23913537 -0.13146949 -0.02247031]
  [ssd_jax] C after chunking sample values: [ 0.02080468 -0.00709071  0.7880737   0.28253657 -0.10844219]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.01109644 -0.00645922 -0.00204265 -0.00483287 -0.00472237]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.01109644 -0.01755566 -0.01959831 -0.02443118 -0.02915355]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.011806   -0.01384904  0.00067287 -0.00369727 -0.02590073]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.7068887 0.7114694 0.7129241 0.716378  0.719769 ]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.00243056  0.10263596 -0.21626307 -0.02891924 -0.01602942]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.        0.        0.        0.6990881 1.       ]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-0.09328245  0.10149198 -0.2838169   0.02385908 -0.06015252]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.9889649  0.98259753 0.9805925  0.9758648  0.97126734]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.011806   -0.01384904  0.00067287 -0.00369727 -0.02590073]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.011806   -0.01384904  0.00067287 -0.00369727 -0.02590073]
  [FlaxMamba2] ssm_state sample values: [-0.09328245  0.10149198 -0.2838169   0.02385908 -0.06015252]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.00705559 -0.00827657  0.00040213 -0.00220959 -0.01547899]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.00705559 -0.00827657  0.00040213 -0.00220959 -0.01547899]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 1.3922722e-03  9.8480994e-04 -6.6340981e-05  5.9858290e-04
  1.7938457e-03]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 5.5612437e-04  2.6026709e-04 -5.9397007e-05  1.2655553e-03
  8.2327402e-04]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 5.5612437e-04  2.6026709e-04 -5.9397007e-05  1.2655553e-03
  8.2327402e-04]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-0.34837997  0.21062157  0.22825176  0.2822042  -0.9076186 ]
  [Layer 13] Output shape after mixer: (1, 128, 1024)
  [Layer 13] Output sample values after mixer: [-0.34837997  0.21062157  0.22825176  0.2822042  -0.9076186 ]
  [Layer 13] Residual connection shape: (1, 128, 1024)
  [Layer 13] Residual connection sample values: [ 0.29612672 -1.4715475   0.6305636  -1.1112614   0.7000522 ]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.06387141 -0.27401206  0.11482926 -0.27121872  0.14145009]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.06387141 -0.27401206  0.11482926 -0.27121872  0.14145009]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.2738362   0.03469944 -1.6256015  -0.24656156 -0.6287273 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.2738362   0.03469944 -1.6256015  -0.24656156 -0.6287273 ]
  [FlaxMamba2] xBC (step) sample values: [-0.7421062  -1.2104092   0.9866853  -0.18255794  0.5618278 ]
  [FlaxMamba2] dt (step) sample values: [1.5138706 1.1357372 1.4540373 2.0232782 0.902327 ]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.09012737 0.17513944 0.04937785 0.3271299  0.03967823]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 1.7219435   1.034317   -0.9048691   1.7296733  -0.37038562]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [0.00179863 0.01252747 0.05297852 0.00199318 0.00091457]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.22932792 -0.33058578  0.07248384  0.00115195 -0.16836363]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.12775445 -0.13821729  0.03755482  0.00057631 -0.07711194]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.12775445 -0.13821729  0.03755482  0.00057631 -0.07711194]
  [FlaxMamba2] B sample values: [ 0.16695252 -0.09218128  0.02105568 -0.02088296 -0.03898051]
  [FlaxMamba2] C sample values: [ 0.1774778  -0.20086141  0.02984899 -0.19195515 -0.02173971]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.12775445 -0.13821729  0.03755482  0.00057631 -0.07711194]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-7.2744994  -0.03854768 -2.202407   -0.01377147 -5.3377523 ]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 1.1514173e-02 -1.2457160e-02  3.3847170e-03  5.1940977e-05
 -6.9498960e-03]
  [ssd_jax] A after chunking sample values: [-0.6556315  -0.00675122 -0.10875012 -0.00450506 -0.21179254]
  [ssd_jax] B after chunking sample values: [ 0.16695252 -0.09218128  0.02105568 -0.02088296 -0.03898051]
  [ssd_jax] C after chunking sample values: [ 0.1774778  -0.20086141  0.02984899 -0.19195515 -0.02173971]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.6556315 -2.9824128 -0.7692263 -0.7736645 -0.2602531]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.6556315 -3.6380444 -4.4072704 -5.180935  -5.4411883]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 1.66903250e-02 -1.80572290e-02  4.90630325e-03  7.52908381e-05
 -1.00741945e-02]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [7.5803261e-12 1.4960051e-10 3.2285219e-10 6.9984513e-10 9.0788072e-10]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.00152732  0.00122787 -0.00082142  0.00108047 -0.00144029]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 3.9350524e-12 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-5.5003550e-04 -1.1121989e-03  5.5212324e-04  2.9094123e-05
  7.2751864e-04]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.51911414 0.02630373 0.0121884  0.00562275 0.00433433]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 1.66903250e-02 -1.80572290e-02  4.90630325e-03  7.52908381e-05
 -1.00741945e-02]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 1.66903250e-02 -1.80572290e-02  4.90630325e-03  7.52908381e-05
 -1.00741945e-02]
  [FlaxMamba2] ssm_state sample values: [-5.5003550e-04 -1.1121989e-03  5.5212324e-04  2.9094123e-05
  7.2751864e-04]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.11723289 -0.12683403  0.03446189  0.00052884 -0.07076117]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.11723289 -0.12683403  0.03446189  0.00052884 -0.07076117]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-1.3867221e-02 -2.2387099e-03 -9.2117954e-03 -5.7199228e-05
  1.5473406e-02]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03689479 -0.00415013 -0.01171625 -0.00010534  0.03622254]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.03689479 -0.00415013 -0.01171625 -0.00010534  0.03622254]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-0.7112565   0.29703575  0.9586737   0.09753107 -0.8467662 ]
  [Layer 14] Output shape after mixer: (1, 128, 1024)
  [Layer 14] Output sample values after mixer: [-0.7112565   0.29703575  0.9586737   0.09753107 -0.8467662 ]
  [Layer 14] Residual connection shape: (1, 128, 1024)
  [Layer 14] Residual connection sample values: [-0.41512978 -1.1745117   1.5892373  -1.0137303  -0.14671397]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.09611613 -0.2237049   0.3038774  -0.2782257  -0.0317063 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.09611613 -0.2237049   0.3038774  -0.2782257  -0.0317063 ]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.17259395 -2.367427    1.6571565  -1.5533621  -5.2249575 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.17259395 -2.367427    1.6571565  -1.5533621  -5.2249575 ]
  [FlaxMamba2] xBC (step) sample values: [-0.31904966  0.54856336 -1.5145426  -1.7221758   0.11319728]
  [FlaxMamba2] dt (step) sample values: [1.0656765 9.700738  1.9992132 0.9395061 1.9326184]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.17052956 9.145669   0.15137772 0.11946552 0.70988715]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 1.2414298  1.7405844 -0.4330966 -1.1422975 -1.4087206]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [0.00017869 0.02565002 0.01338196 0.00164604 0.13781738]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.30313554 -0.09091411  1.1814506   0.09680429 -0.01363634]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.12876931 -0.04339214  0.9040561   0.05074309 -0.00677168]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.12876931 -0.04339214  0.9040561   0.05074309 -0.00677168]
  [FlaxMamba2] B sample values: [-0.01194922  0.00928945 -0.00332065 -0.00280872 -0.00119603]
  [FlaxMamba2] C sample values: [ 0.02504262 -0.11240205 -0.02001046 -0.04916112 -0.03327319]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.12876931 -0.04339214  0.9040561   0.05074309 -0.00677168]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.4414158  -0.05923919 -0.7389757  -0.00508607 -0.00871955]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.02195897 -0.00739964  0.15416828  0.0086532  -0.00115477]
  [ssd_jax] A after chunking sample values: [-0.41633356 -0.5417821  -0.11186446 -0.00060761 -0.0061899 ]
  [ssd_jax] B after chunking sample values: [-0.01194922  0.00928945 -0.00332065 -0.00280872 -0.00119603]
  [ssd_jax] C after chunking sample values: [ 0.02504262 -0.11240205 -0.02001046 -0.04916112 -0.03327319]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.41633356 -1.2381078  -0.3426861  -0.89292306 -0.38043708]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.41633356 -1.6544414  -1.9971274  -2.8900504  -3.2704875 ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.00588532 -0.00198321  0.04131929  0.00231918 -0.0003095 ]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [1.1001472e-22 3.7945035e-22 5.3454154e-22 1.3054863e-21 1.9098322e-21]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.00082846 -0.00060052 -0.00086721  0.00052877  0.00073913]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 7.2550427e-23 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [0.00180624 0.0062455  0.0039142  0.00097745 0.00363371]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.65946025 0.19119884 0.1357246  0.05557341 0.0379879 ]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.00588532 -0.00198321  0.04131929  0.00231918 -0.0003095 ]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.00588532 -0.00198321  0.04131929  0.00231918 -0.0003095 ]
  [FlaxMamba2] ssm_state sample values: [0.00180624 0.0062455  0.0039142  0.00097745 0.00363371]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.23584175 -0.07947295  1.655784    0.09293626 -0.01240238]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.23584175 -0.07947295  1.655784    0.09293626 -0.01240238]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 1.8600425e-02  1.6122362e-02  2.3044751e+00 -2.5206070e-02
  3.4680640e-04]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 2.1784998e-02  1.3782175e-02  5.7900143e-01 -1.6640157e-02
  4.1444314e-04]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 2.1784998e-02  1.3782175e-02  5.7900143e-01 -1.6640157e-02
  4.1444314e-04]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-0.49647114 -0.17700061  0.53997594  0.01213068  0.66067135]
  [Layer 15] Output shape after mixer: (1, 128, 1024)
  [Layer 15] Output sample values after mixer: [-0.49647114 -0.17700061  0.53997594  0.01213068  0.66067135]
  [Layer 15] Residual connection shape: (1, 128, 1024)
  [Layer 15] Residual connection sample values: [-0.91160095 -1.3515123   2.1292133  -1.0015996   0.5139574 ]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.14851709 -0.18196093  0.2671554  -0.20704126  0.07915955]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.14851709 -0.18196093  0.2671554  -0.20704126  0.07915955]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.32274348  1.2846107  -5.1682925   1.877373   -0.586457  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [ 0.32274348  1.2846107  -5.1682925   1.877373   -0.586457  ]
  [FlaxMamba2] xBC (step) sample values: [-1.0392799   0.7194343  -0.19386956 -3.539097   -0.57160425]
  [FlaxMamba2] dt (step) sample values: [ 1.9858356   0.25909087 -0.71954167  2.005506   -0.36336493]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.47462863 0.0849799  0.01156578 0.18522368 0.00078265]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-0.6860485   0.3611327   0.24830371  1.2533983  -0.31683642]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 0.00067806  0.00153923  0.00272369  0.00257301 -0.0073204 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.00343699 -0.1130042   0.11836599 -0.05209659  0.01190865]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.00171554 -0.05331301  0.06268153 -0.02536993  0.00598978]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.00171554 -0.05331301  0.06268153 -0.02536993  0.00598978]
  [FlaxMamba2] B sample values: [-0.01103712  0.00707166 -0.00460781 -0.00247393 -0.00131521]
  [FlaxMamba2] C sample values: [-0.02940725 -0.0669131  -0.07673327 -0.07869865 -0.07363816]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.00171554 -0.05331301  0.06268153 -0.02536993  0.00598978]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.1348554e-03 -3.0370306e-03 -2.7156286e+00 -4.1511287e-03
 -4.2925543e-01]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.00081425 -0.02530388  0.02975045 -0.0120413   0.00284292]
  [ssd_jax] A after chunking sample values: [-0.00053863 -0.00025809 -0.03140835 -0.00076889 -0.00033596]
  [ssd_jax] B after chunking sample values: [-0.01103712  0.00707166 -0.00460781 -0.00247393 -0.00131521]
  [ssd_jax] C after chunking sample values: [-0.02940725 -0.0669131  -0.07673327 -0.07869865 -0.07363816]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.00053863 -0.0021334  -0.00013877 -0.00025401 -0.00095076]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.00053863 -0.00267204 -0.0028108  -0.00306481 -0.00401558]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-2.5204594e-05 -7.8326958e-04  9.2091109e-04 -3.7273267e-04
  8.8001259e-05]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.9496654  0.9516936  0.9518257  0.95206743 0.95297307]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.00871556  0.03926219  0.02126957  0.00862048  0.00679204]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.       0.       0.       0.949154 1.      ]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-0.00281799  0.11089414  0.03398333  0.00244675  0.00546654]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.99946153 0.99733156 0.99719316 0.9969399  0.9959925 ]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-2.5204594e-05 -7.8326958e-04  9.2091109e-04 -3.7273267e-04
  8.8001259e-05]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-2.5204594e-05 -7.8326958e-04  9.2091109e-04 -3.7273267e-04
  8.8001259e-05]
  [FlaxMamba2] ssm_state sample values: [-0.00281799  0.11089414  0.03398333  0.00244675  0.00546654]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.00037406  0.01162458 -0.01366734  0.00553176 -0.00130604]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.00037406  0.01162458 -0.01366734  0.00553176 -0.00130604]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [7.0020615e-05 1.1696078e-02 3.9994848e-04 9.0071633e-03 2.7378162e-04]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [6.0432361e-05 5.7469960e-03 7.9107337e-04 3.1012842e-03 2.7970801e-04]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [6.0432361e-05 5.7469960e-03 7.9107337e-04 3.1012842e-03 2.7970801e-04]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 0.13739663  0.7500515  -0.5650318   0.10314836  0.1388122 ]
  [Layer 16] Output shape after mixer: (1, 128, 1024)
  [Layer 16] Output sample values after mixer: [ 0.13739663  0.7500515  -0.5650318   0.10314836  0.1388122 ]
  [Layer 16] Residual connection shape: (1, 128, 1024)
  [Layer 16] Residual connection sample values: [-0.7742043  -0.6014608   1.5641816  -0.8984512   0.65276957]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.17746656 -0.11862959  0.3082533  -0.23602743  0.13783771]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.17746656 -0.11862959  0.3082533  -0.23602743  0.13783771]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.9998026  -0.72578543  0.01112777 -2.5418715  -1.7175623 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-2.9998026  -0.72578543  0.01112777 -2.5418715  -1.7175623 ]
  [FlaxMamba2] xBC (step) sample values: [-0.25446573  0.4273737  -1.1495234   0.07415801 -0.93566185]
  [FlaxMamba2] dt (step) sample values: [1.4183364 3.1296754 1.6427733 2.563058  3.155445 ]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.4808902 1.0914668 0.541339  1.5474384 2.2838995]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 0.6258435   1.0798792  -0.44997388  0.2817422  -2.2508318 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.19042969  0.00359726  0.03016663 -0.00022721 -0.0015955 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.12892115  0.0221755  -0.3914379   0.05096273 -0.1385864 ]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.06031115  0.01121069 -0.15789478  0.02613053 -0.06449933]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.06031115  0.01121069 -0.15789478  0.02613053 -0.06449933]
  [FlaxMamba2] B sample values: [-0.00684856  0.04958344 -0.2779701  -0.04514737  0.12599778]
  [FlaxMamba2] C sample values: [ 0.08406591  0.2549306  -0.27367496 -0.20844467 -0.0320104 ]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.06031115  0.01121069 -0.15789478  0.02613053 -0.06449933]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.3863302  -0.87734115 -1.4026718  -0.6827737  -0.39046   ]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.02900304  0.00539111 -0.07593005  0.01256591 -0.03101709]
  [ssd_jax] A after chunking sample values: [-0.66667265 -0.95758873 -0.7593209  -1.0565503  -0.89177144]
  [ssd_jax] B after chunking sample values: [-0.00684856  0.04958344 -0.2779701  -0.04514737  0.12599778]
  [ssd_jax] C after chunking sample values: [ 0.08406591  0.2549306  -0.27367496 -0.20844467 -0.0320104 ]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.66667265 -1.7749804  -0.5748508  -0.5271953  -0.79067385]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.66667265 -2.441653   -3.0165038  -3.5436993  -4.334373  ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.01353652  0.00251618 -0.03543864  0.00586486 -0.01447653]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [2.0436510e-28 1.2057905e-27 2.1425216e-27 3.6298171e-27 8.0033051e-27]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.00109195  0.00108222  0.01348418  0.00487661 -0.00384006]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 1.0492401e-28 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.01391369 -0.01071384  0.03308358  0.01040757  0.02131641]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.513414   0.0870169  0.04897213 0.0289062  0.01311009]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.01353652  0.00251618 -0.03543864  0.00586486 -0.01447653]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.01353652  0.00251618 -0.03543864  0.00586486 -0.01447653]
  [FlaxMamba2] ssm_state sample values: [ 0.01391369 -0.01071384  0.03308358  0.01040757  0.02131641]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.17238756  0.03204354 -0.4513111   0.07468896 -0.18435863]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.17238756  0.03204354 -0.4513111   0.07468896 -0.18435863]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02452989 -0.00758449 -0.00252501 -0.01385418  0.04818912]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01201646 -0.00379162 -0.00132789 -0.00896978  0.02876699]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.01201646 -0.00379162 -0.00132789 -0.00896978  0.02876699]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 1.0521204  -0.10360453 -0.18469582 -0.5897891  -0.08946404]
  [Layer 17] Output shape after mixer: (1, 128, 1024)
  [Layer 17] Output sample values after mixer: [ 1.0521204  -0.10360453 -0.18469582 -0.5897891  -0.08946404]
  [Layer 17] Residual connection shape: (1, 128, 1024)
  [Layer 17] Residual connection sample values: [ 0.27791613 -0.70506537  1.3794857  -1.4882402   0.5633055 ]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.04234606 -0.09288796  0.17906444 -0.27557766  0.07595918]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.04234606 -0.09288796  0.17906444 -0.27557766  0.07595918]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.29980975  0.8725306  -0.62275577  1.0622464  -2.254659  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [ 0.29980975  0.8725306  -0.62275577  1.0622464  -2.254659  ]
  [FlaxMamba2] xBC (step) sample values: [ 0.6608621   1.3203874   2.1790106  -0.10104543  0.9613266 ]
  [FlaxMamba2] dt (step) sample values: [ 3.1535678   1.9866912   1.473253    4.246808   -0.63875175]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [1.4576235 3.1421688 2.972095  2.2088504 0.074698 ]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-0.3417943   0.37941277  0.02733767  0.25384715  0.35178047]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.0122757  -0.17248535  0.01785278  0.0211792   0.01266479]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.11060509 -1.2289939  -0.49201208  0.01858349 -0.02736801]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.05224729 -0.27819207 -0.18667907  0.00937808 -0.01349677]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.05224729 -0.27819207 -0.18667907  0.00937808 -0.01349677]
  [FlaxMamba2] B sample values: [ 0.00664906  0.00184674 -0.01782792  0.00488932 -0.0011334 ]
  [FlaxMamba2] C sample values: [-0.12189893 -0.09431181 -0.09506693 -0.05699023 -0.02486409]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.05224729 -0.27819207 -0.18667907  0.00937808 -0.01349677]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.3194940e-03 -6.5335674e+00 -1.4897179e+01 -1.3796333e-03
 -2.0873186e-03]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.07615687 -0.4054993  -0.27210778  0.01366971 -0.0196732 ]
  [ssd_jax] A after chunking sample values: [-3.3809489e-03 -2.0529572e+01 -4.4275829e+01 -3.0474036e-03
 -1.5591852e-04]
  [ssd_jax] B after chunking sample values: [ 0.00664906  0.00184674 -0.01782792  0.00488932 -0.0011334 ]
  [ssd_jax] C after chunking sample values: [-0.12189893 -0.09431181 -0.09506693 -0.05699023 -0.02486409]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.00338095 -0.00061827 -0.00126463 -0.00058699 -0.00070012]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.00338095 -0.00399922 -0.00526384 -0.00585083 -0.00655095]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.02080532 -0.1107785  -0.07433722  0.00373443 -0.00537453]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.92680293 0.92737615 0.92854965 0.9290949  0.92974555]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.01492222 -0.03015622  0.07474682  0.05430641 -0.02406662]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.         0.         0.         0.92367476 1.        ]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.00196805 -0.00866566  0.0934574  -0.03816417  0.01232081]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.99662477 0.99600875 0.99474996 0.99416625 0.99347043]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.02080532 -0.1107785  -0.07433722  0.00373443 -0.00537453]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.02080532 -0.1107785  -0.07433722  0.00373443 -0.00537453]
  [FlaxMamba2] ssm_state sample values: [ 0.00196805 -0.00866566  0.0934574  -0.03816417  0.01232081]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.01666896 -0.08875431 -0.05955803  0.00299198 -0.004306  ]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.01666896 -0.08875431 -0.05955803  0.00299198 -0.004306  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00287055 -0.05461686  0.01295019  0.0023618   0.00092181]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00584564 -0.02723324  0.00581519  0.00246954  0.00045295]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.00584564 -0.02723324  0.00581519  0.00246954  0.00045295]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 0.0895251  -0.20155464  0.15673648 -0.14801362  0.4901839 ]
  [Layer 18] Output shape after mixer: (1, 128, 1024)
  [Layer 18] Output sample values after mixer: [ 0.0895251  -0.20155464  0.15673648 -0.14801362  0.4901839 ]
  [Layer 18] Residual connection shape: (1, 128, 1024)
  [Layer 18] Residual connection sample values: [ 0.36744124 -0.90662     1.5362222  -1.6362538   1.0534894 ]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.06531608 -0.13383812  0.22924215 -0.3597031   0.16625549]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.06531608 -0.13383812  0.22924215 -0.3597031   0.16625549]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.02454197 -0.8327035  -0.4350375  -1.617104   -1.5429993 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.02454197 -0.8327035  -0.4350375  -1.617104   -1.5429993 ]
  [FlaxMamba2] xBC (step) sample values: [-0.45493743 -0.11673468 -0.46207488 -1.3342166  -0.4863495 ]
  [FlaxMamba2] dt (step) sample values: [4.305853  3.4402518 4.1321797 3.3593855 4.987683 ]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [5.268051  2.4156406 3.1879818 4.5216827 4.1837063]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-0.18226862 -0.51194596 -1.361026   -1.4363782  -1.3585666 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.03347778  0.00429916 -0.00640106  0.00237465 -0.01046753]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.02769507 -0.00858312 -0.12045698  0.38259292 -0.08638637]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.01365579 -0.00427314 -0.0566054   0.22745085 -0.04132869]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.01365579 -0.00427314 -0.0566054   0.22745085 -0.04132869]
  [FlaxMamba2] B sample values: [-0.0113759  -0.11975523 -0.27657804 -0.09610023 -0.07630623]
  [FlaxMamba2] C sample values: [-0.15391694 -0.03328885 -0.12241239 -0.02465878  0.11171344]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.01365579 -0.00427314 -0.0566054   0.22745085 -0.04132869]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17394373 -1.5063176  -1.5724528  -0.19826236 -0.07681109]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.07193941 -0.02251112 -0.29820013  1.1982228  -0.21772166]
  [ssd_jax] A after chunking sample values: [-0.91634446 -3.638722   -5.012951   -0.8964795  -0.32135504]
  [ssd_jax] B after chunking sample values: [-0.0113759  -0.11975523 -0.27657804 -0.09610023 -0.07630623]
  [ssd_jax] C after chunking sample values: [-0.15391694 -0.03328885 -0.12241239 -0.02465878  0.11171344]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.91634446 -0.665557   -0.4538979  -0.45931286 -0.33067453]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.91634446 -1.5819016  -2.0357995  -2.4951122  -2.8257868 ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.04839231 -0.01514282 -0.20059371  0.8060223  -0.14645733]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [4.1999675e-13 8.1713542e-13 1.2865280e-12 2.0365545e-12 2.8346956e-12]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.01517932  0.15022981 -0.06312792  0.00547204  0.0272007 ]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 1.6798981e-13 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.00743794  0.0345909  -0.0783086   0.0636583  -0.06365319]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.39997852 0.2055838  0.13057604 0.0824872  0.05926201]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.04839231 -0.01514282 -0.20059371  0.8060223  -0.14645733]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.04839231 -0.01514282 -0.20059371  0.8060223  -0.14645733]
  [FlaxMamba2] ssm_state sample values: [ 0.00743794  0.0345909  -0.0783086   0.0636583  -0.06365319]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.06918572 -0.02164944 -0.28678563  1.1523572  -0.20938772]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.06918572 -0.02164944 -0.28678563  1.1523572  -0.20938772]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00083856  0.00546368  0.04902219 -0.3086012   0.05689519]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00018896  0.00212858  0.02274056 -0.05894953  0.04021132]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.00018896  0.00212858  0.02274056 -0.05894953  0.04021132]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 0.72052824  0.02494051 -0.2862165  -0.65181327 -0.03439355]
  [Layer 19] Output shape after mixer: (1, 128, 1024)
  [Layer 19] Output sample values after mixer: [ 0.72052824  0.02494051 -0.2862165  -0.65181327 -0.03439355]
  [Layer 19] Residual connection shape: (1, 128, 1024)
  [Layer 19] Residual connection sample values: [ 1.0879695  -0.88167953  1.2500057  -2.288067    1.0190959 ]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.11154368 -0.08273641  0.11738478 -0.28705782  0.10206225]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.11154368 -0.08273641  0.11738478 -0.28705782  0.10206225]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.56586385 -1.049137    0.18201716 -0.5317145  -0.10580721]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.56586385 -1.049137    0.18201716 -0.5317145  -0.10580721]
  [FlaxMamba2] xBC (step) sample values: [ 0.56452775 -0.76525927  0.11270176  1.008548    0.7339804 ]
  [FlaxMamba2] dt (step) sample values: [ 1.925234   1.7575904 -0.5412216  1.300822   0.9575375]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.04764416 0.14342646 0.03502291 0.25543916 0.10638832]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 1.1221731   1.2874904  -0.8696122   0.8533652   0.01663162]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 0.00559998 -0.00791931  0.00337601  0.01123047  0.01628113]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.10264706  0.13865793 -0.14049402  0.17372411  0.03569666]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.05395532  0.07412778 -0.06532047  0.09438816  0.01816686]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.05395532  0.07412778 -0.06532047  0.09438816  0.01816686]
  [FlaxMamba2] B sample values: [-1.7065065e-03  1.8857807e-05 -3.4977633e-03 -9.0871491e-03
 -7.9459809e-03]
  [FlaxMamba2] C sample values: [-0.13744798 -0.09617002 -0.1689817  -0.15682037  0.22557136]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.05395532  0.07412778 -0.06532047  0.09438816  0.01816686]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-3.08577806e-01 -2.93056536e+00 -5.29621363e+00 -1.23260975e+01
 -8.15932546e-03]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 0.00257066  0.00353176 -0.00311214  0.00449704  0.00086554]
  [ssd_jax] A after chunking sample values: [-1.4701930e-02 -4.2032063e-01 -1.8548879e-01 -3.1485679e+00
 -8.6805690e-04]
  [ssd_jax] B after chunking sample values: [-1.7065065e-03  1.8857807e-05 -3.4977633e-03 -9.0871491e-03
 -7.9459809e-03]
  [ssd_jax] C after chunking sample values: [-0.13744798 -0.09617002 -0.1689817  -0.15682037  0.22557136]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.01470193 -0.0015179  -0.00283884 -0.00058853 -0.00168006]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.01470193 -0.01621983 -0.01905868 -0.01964721 -0.02132726]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-3.9049246e-06 -5.3648723e-06  4.7274584e-06 -6.8311833e-06
 -1.3147958e-06]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.77695125 0.7781315  0.7803436  0.78080297 0.7821159 ]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.00022678 -0.00020865  0.0003516   0.00015002 -0.00031383]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.        0.        0.        0.7656121 1.       ]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-1.6984937e-04 -2.9668235e-04 -2.1618739e-04  6.3829284e-06
 -6.2587918e-05]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.9854056  0.983911   0.9811218  0.98054457 0.9788985 ]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-3.9049246e-06 -5.3648723e-06  4.7274584e-06 -6.8311833e-06
 -1.3147958e-06]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-3.9049246e-06 -5.3648723e-06  4.7274584e-06 -6.8311833e-06
 -1.3147958e-06]
  [FlaxMamba2] ssm_state sample values: [-1.6984937e-04 -2.9668235e-04 -2.1618739e-04  6.3829284e-06
 -6.2587918e-05]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.04437313  0.06096306 -0.05371988  0.0776253   0.01494052]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.04437313  0.06096306 -0.05371988  0.0776253   0.01494052]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00909433 -0.01659027 -0.00533268 -0.0152764  -0.00074863]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.06538379 -0.10271506 -0.02272851 -0.10691705 -0.00342376]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.06538379 -0.10271506 -0.02272851 -0.10691705 -0.00342376]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 0.42006308 -1.0348793   0.28510064 -0.43839943 -0.32116205]
  [Layer 20] Output shape after mixer: (1, 128, 1024)
  [Layer 20] Output sample values after mixer: [ 0.42006308 -1.0348793   0.28510064 -0.43839943 -0.32116205]
  [Layer 20] Residual connection shape: (1, 128, 1024)
  [Layer 20] Residual connection sample values: [ 1.5080326  -1.9165589   1.5351064  -2.7264667   0.69793385]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.20220476 -0.23252535  0.19081996 -0.43233654  0.08996585]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.20220476 -0.23252535  0.19081996 -0.43233654  0.08996585]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.09902272 -0.8384197  -1.8348222  -0.0379516  -0.7905173 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.09902272 -0.8384197  -1.8348222  -0.0379516  -0.7905173 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.61262256  0.02267729  0.59335953 -1.7850285   0.19838737]
  [FlaxMamba2] dt (step) sample values: [1.8947561 2.4237947 3.8694696 7.672134  2.9605749]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [2.1033485 2.286676  4.103169  7.0836177 2.7303839]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 2.2800562   0.26899368 -1.6583263  -0.26750508  1.4410965 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 0.00846863 -0.00547409  0.00304413 -0.00028586 -0.00402451]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.1792887  -0.09123357 -0.02405481  0.4009662  -0.00080461]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.08162969 -0.04353733 -0.01188275  0.24014658 -0.00040214]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.08162969 -0.04353733 -0.01188275  0.24014658 -0.00040214]
  [FlaxMamba2] B sample values: [-0.27485555 -0.09841176 -0.04291203 -0.09824126  0.00823323]
  [FlaxMamba2] C sample values: [ 0.06681381 -0.06612688 -0.07376523 -0.08464443 -0.26587152]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.08162969 -0.04353733 -0.01188275  0.24014658 -0.00040214]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.32275575 -0.3764196  -0.15946394 -0.10539922 -0.37568513]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.1716957  -0.09157418 -0.02499357  0.50511193 -0.00084584]
  [ssd_jax] A after chunking sample values: [-0.6788678  -0.86074966 -0.6543075  -0.7466078  -1.0257646 ]
  [ssd_jax] B after chunking sample values: [-0.27485555 -0.09841176 -0.04291203 -0.09824126  0.00823323]
  [ssd_jax] C after chunking sample values: [ 0.06681381 -0.06612688 -0.07376523 -0.08464443 -0.26587152]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.6788678  -0.9370458  -0.33486038 -0.18640392 -0.33355337]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.6788678 -1.6159136 -1.950774  -2.137178  -2.4707313]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.02837245 -0.01513249 -0.00413015  0.08346897 -0.00013977]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [1.3993986e-11 3.5718675e-11 4.9925581e-11 6.0155853e-11 8.3972725e-11]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [0.04678    0.10616232 0.02917667 0.04501392 0.00942978]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 7.0976254e-12 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [0.12807527 0.1283624  0.02313186 0.11161037 0.00961358]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.5071909  0.19870904 0.142164   0.11798734 0.08452303]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.02837245 -0.01513249 -0.00413015  0.08346897 -0.00013977]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.02837245 -0.01513249 -0.00413015  0.08346897 -0.00013977]
  [FlaxMamba2] ssm_state sample values: [0.12807527 0.1283624  0.02313186 0.11161037 0.00961358]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.20089653 -0.1071485  -0.02924431  0.59101796 -0.0009897 ]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.20089653 -0.1071485  -0.02924431  0.59101796 -0.0009897 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00945459  0.02711841  0.00738683 -0.01100225  0.00024415]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00897287  0.03252095  0.01001589 -0.01046127  0.00020019]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.00897287  0.03252095  0.01001589 -0.01046127  0.00020019]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-0.14681976 -0.9651359  -0.8512104  -0.70541584 -0.04714648]
  [Layer 21] Output shape after mixer: (1, 128, 1024)
  [Layer 21] Output sample values after mixer: [-0.14681976 -0.9651359  -0.8512104  -0.70541584 -0.04714648]
  [Layer 21] Residual connection shape: (1, 128, 1024)
  [Layer 21] Residual connection sample values: [ 1.3612128  -2.8816948   0.683896   -3.4318824   0.65078735]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.17755587 -0.3476686   0.08259442 -0.5288138   0.08224311]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.17755587 -0.3476686   0.08259442 -0.5288138   0.08224311]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.21063483  0.16401297  0.04064685 -3.6609178  -0.20062265]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [ 0.21063483  0.16401297  0.04064685 -3.6609178  -0.20062265]
  [FlaxMamba2] xBC (step) sample values: [ 1.1111645  -0.9185223  -0.8812369   0.4521641  -0.45140666]
  [FlaxMamba2] dt (step) sample values: [3.9998899 3.5418577 4.6450806 6.7441587 2.5250452]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [3.6008132 3.7069745 2.6209831 5.804307  2.645957 ]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-0.76313984 -0.2586436  -0.6772157  -1.7266351   0.5109836 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.00086689  0.00281715 -0.001441   -0.00460052 -0.00131416]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.01884257  0.09994544  0.01937439  0.07669087 -0.00246683]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.00951004  0.05246792  0.00978103  0.03981508 -0.00123189]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.00951004  0.05246792  0.00978103  0.03981508 -0.00123189]
  [FlaxMamba2] B sample values: [ 0.06338339 -0.02014036 -0.01503748  0.02681033  0.00894781]
  [FlaxMamba2] C sample values: [-0.2287713  -0.15630268 -0.01959261  0.18431696  0.13593239]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.00951004  0.05246792  0.00978103  0.03981508 -0.00123189]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.07090003 -0.07021102 -0.0699373  -0.08945116 -0.38969815]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 0.0342439   0.18892716  0.03521967  0.14336668 -0.00443581]
  [ssd_jax] A after chunking sample values: [-0.25529775 -0.26027048 -0.18330447 -0.519202   -1.0311246 ]
  [ssd_jax] B after chunking sample values: [ 0.06338339 -0.02014036 -0.01503748  0.02681033  0.00894781]
  [ssd_jax] C after chunking sample values: [-0.2287713  -0.15630268 -0.01959261  0.18431696  0.13593239]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.25529775 -0.05403554 -0.02824451 -0.02578857 -0.09779399]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.25529775 -0.3093333  -0.3375778  -0.36336637 -0.46116036]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 0.01818275  0.10031611  0.01870086  0.07612451 -0.00235532]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.01986071 0.02096342 0.02156396 0.02212729 0.02440056]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.06532857  0.08550278  0.05021469 -0.04991727  0.07696493]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.         0.         0.         0.01538581 1.        ]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-0.0118167   0.04423381  0.02078333  0.00443722  0.05353311]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.7746858  0.7339361  0.71349645 0.69533163 0.6305516 ]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 0.01818275  0.10031611  0.01870086  0.07612451 -0.00235532]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 0.01818275  0.10031611  0.01870086  0.07612451 -0.00235532]
  [FlaxMamba2] ssm_state sample values: [-0.0118167   0.04423381  0.02078333  0.00443722  0.05353311]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.00178741  0.0098613   0.00183834  0.00748321 -0.00023153]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.00178741  0.0098613   0.00183834  0.00748321 -0.00023153]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 2.0799742e-04  8.7485992e-04  3.8120488e-05 -6.8665278e-04
  2.0903382e-05]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 1.4356010e-04  2.6152557e-04  2.6310814e-05 -7.0406258e-04
  1.3766414e-05]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 1.4356010e-04  2.6152557e-04  2.6310814e-05 -7.0406258e-04
  1.3766414e-05]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 0.41232198 -0.9452257   0.40395954  0.31724218  0.35585743]
  [Layer 22] Output shape after mixer: (1, 128, 1024)
  [Layer 22] Output sample values after mixer: [ 0.41232198 -0.9452257   0.40395954  0.31724218  0.35585743]
  [Layer 22] Residual connection shape: (1, 128, 1024)
  [Layer 22] Residual connection sample values: [ 1.7735348 -3.8269205  1.0878556 -3.1146402  1.0066447]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.18844491 -0.36733982  0.1098768  -0.40683332  0.09953625]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.18844491 -0.36733982  0.1098768  -0.40683332  0.09953625]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.14295661  0.802246   -0.8056311  -0.67802817 -0.22187632]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [ 0.14295661  0.802246   -0.8056311  -0.67802817 -0.22187632]
  [FlaxMamba2] xBC (step) sample values: [-0.28747195 -0.44436967  0.9694642   0.6605407  -0.12144729]
  [FlaxMamba2] dt (step) sample values: [2.2795737 2.2382855 2.0201206 2.5253487 1.9156547]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.547523   1.1777167  1.0107043  0.6757029  0.83234036]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-0.3715824 -0.2201182 -2.9222784 -0.936926  -0.347293 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 0.00620651  0.01099396 -0.02043152  0.0010643   0.01486206]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.01188186 -0.02398702 -0.09852953  0.01855955 -0.00243412]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.00590563 -0.01184967 -0.04683971  0.00936589 -0.00121558]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.00590563 -0.01184967 -0.04683971  0.00936589 -0.00121558]
  [FlaxMamba2] B sample values: [ 0.36516362  0.04737916 -0.01218194  0.21247236  0.01984421]
  [FlaxMamba2] C sample values: [ 0.19757831  0.37954253 -0.02896017  0.09509114 -0.04037055]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.00590563 -0.01184967 -0.04683971  0.00936589 -0.00121558]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.12322418 -0.22553998 -0.24196908 -0.09559295 -0.2396176 ]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.00323347 -0.00648797 -0.02564582  0.00512804 -0.00066556]
  [ssd_jax] A after chunking sample values: [-0.06746808 -0.2656222  -0.24455918 -0.06459244 -0.1994434 ]
  [ssd_jax] B after chunking sample values: [ 0.36516362  0.04737916 -0.01218194  0.21247236  0.01984421]
  [ssd_jax] C after chunking sample values: [ 0.19757831  0.37954253 -0.02896017  0.09509114 -0.04037055]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.06746808 -0.02199774 -0.0167722  -0.02430287 -0.03131128]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.06746808 -0.08946582 -0.10623802 -0.13054089 -0.16185217]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.00244041 -0.0048967  -0.01935579  0.00387031 -0.00050232]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.18067467 0.18469316 0.18781698 0.19243738 0.19855815]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.02341442 -0.00122949 -0.00874822  0.02766343  0.00295831]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.         0.         0.         0.16888702 1.        ]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.02698459 -0.00237027  0.00029466  0.06163354 -0.01405746]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.9347576  0.91441953 0.8992106  0.8776206  0.8505669 ]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.00244041 -0.0048967  -0.01935579  0.00387031 -0.00050232]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.00244041 -0.0048967  -0.01935579  0.00387031 -0.00050232]
  [FlaxMamba2] ssm_state sample values: [ 0.02698459 -0.00237027  0.00029466  0.06163354 -0.01405746]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.00216474 -0.00434355 -0.0171693   0.00343311 -0.00044558]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.00216474 -0.00434355 -0.0171693   0.00343311 -0.00044558]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-1.6577287e-04 -2.4059559e-03  4.2716679e-03 -7.8375515e-04
  4.3969882e-05]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.0002476  -0.01089322  0.03179075 -0.00585148  0.00018278]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.0002476  -0.01089322  0.03179075 -0.00585148  0.00018278]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 0.28191945 -0.11937145  0.37906986  0.02701285 -0.29853937]
  [Layer 23] Output shape after mixer: (1, 128, 1024)
  [Layer 23] Output sample values after mixer: [ 0.28191945 -0.11937145  0.37906986  0.02701285 -0.29853937]
  [Layer 23] Residual connection shape: (1, 128, 1024)
  [Layer 23] Residual connection sample values: [ 2.0554543 -3.946292   1.4669254 -3.0876274  0.7081053]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.2694738  -0.45927098  0.18551493 -0.4645641   0.08552866]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.2694738  -0.45927098  0.18551493 -0.4645641   0.08552866]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.1595964  -0.52385104  1.7183936  -0.64013827  0.55001366]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-1.1595964  -0.52385104  1.7183936  -0.64013827  0.55001366]
  [FlaxMamba2] xBC (step) sample values: [-1.3616303   0.21209228  0.40274423 -0.16990885 -0.04313219]
  [FlaxMamba2] dt (step) sample values: [2.8095384 3.116828  3.7477498 1.8947787 2.3566546]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [3.016025  3.2790008 3.5460548 2.734835  1.9807076]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-1.0317395   0.5313219  -0.18481547 -0.16016293 -0.4936337 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.01748657 -0.00049877  0.00276756  0.00382996 -0.0160675 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.70504767  0.12223153  0.03816777 -0.11973284  0.01825553]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.47189257  0.06484625  0.01944804 -0.0562867   0.00921108]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.47189257  0.06484625  0.01944804 -0.0562867   0.00921108]
  [FlaxMamba2] B sample values: [ 0.07263936 -0.09411746 -0.03248723 -0.03205744  0.12069526]
  [FlaxMamba2] C sample values: [ 0.01387402  0.02107509 -0.24439646 -0.06107442 -0.27221656]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.47189257  0.06484625  0.01944804 -0.0562867   0.00921108]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6296152  -0.19671947 -0.14336194 -0.14017779 -0.22378482]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 1.4232398   0.19557793  0.05865576 -0.1697621   0.02778085]
  [ssd_jax] A after chunking sample values: [-1.8989352 -0.6450433 -0.5083693 -0.3833631 -0.4432523]
  [ssd_jax] B after chunking sample values: [ 0.07263936 -0.09411746 -0.03248723 -0.03205744  0.12069526]
  [ssd_jax] C after chunking sample values: [ 0.01387402  0.02107509 -0.24439646 -0.06107442 -0.27221656]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-1.8989352 -1.4156961 -0.7571267 -0.6599093 -0.5863828]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-1.8989352 -3.3146315 -4.0717583 -4.7316675 -5.31805  ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 0.41854286  0.05751508  0.01724934 -0.04992322  0.00816972]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [3.4075301e-20 1.4036861e-19 2.9928542e-19 5.7900203e-19 1.0407426e-18]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.00852134 -0.00296737 -0.00894886  0.00256264 -0.00146382]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 5.1020347e-21 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 1.06226325e-01 -1.96378101e-02  6.87242299e-03  3.23776193e-02
 -9.81595440e-06]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.14972797 0.03634744 0.01704739 0.00881177 0.0049023 ]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 0.41854286  0.05751508  0.01724934 -0.04992322  0.00816972]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 0.41854286  0.05751508  0.01724934 -0.04992322  0.00816972]
  [FlaxMamba2] ssm_state sample values: [ 1.06226325e-01 -1.96378101e-02  6.87242299e-03  3.23776193e-02
 -9.81595440e-06]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 2.729797    0.37512162  0.11250271 -0.32560647  0.05328411]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 2.729797    0.37512162  0.11250271 -0.32560647  0.05328411]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.75572455 -0.07309152  0.16392358  0.07195431  0.0185847 ]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.21422954 -0.06468938  0.12756178  0.04158882  0.0099585 ]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.21422954 -0.06468938  0.12756178  0.04158882  0.0099585 ]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 0.87342405 -1.5445821   0.75621265 -0.242369    0.26371273]
  [Layer 24] Output shape after mixer: (1, 128, 1024)
  [Layer 24] Output sample values after mixer: [ 0.87342405 -1.5445821   0.75621265 -0.242369    0.26371273]
  [Layer 24] Residual connection shape: (1, 128, 1024)
  [Layer 24] Residual connection sample values: [ 2.9288783 -5.4908743  2.223138  -3.3299963  0.9718181]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.25188255 -0.43829083  0.17818388 -0.32788798  0.078316  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.25188255 -0.43829083  0.17818388 -0.32788798  0.078316  ]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.7390616  -0.51788425 -0.6866017  -0.39547035 -0.7710349 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.7390616  -0.51788425 -0.6866017  -0.39547035 -0.7710349 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.33330205  0.7416332  -0.50906324 -0.01196715 -0.44686309]
  [FlaxMamba2] dt (step) sample values: [2.0857205  1.1207758  0.61121136 2.0218544  2.4695563 ]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [1.9965652 0.8331926 0.5619073 1.6386945 2.2191532]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 0.06215638 -0.00748498 -0.16954596  0.01340183  0.27903733]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 0.0131073  -0.00017858  0.00563431  0.02598572 -0.00156784]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.1098853  -0.02308777  0.20792885 -0.10732301 -0.09149296]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.05192699 -0.01141063  0.11473425 -0.05078471 -0.0436552 ]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.05192699 -0.01141063  0.11473425 -0.05078471 -0.0436552 ]
  [FlaxMamba2] B sample values: [-0.01456414 -0.01323255 -0.00995639 -0.02220103 -0.03148108]
  [FlaxMamba2] C sample values: [-0.1803503  -0.05673093 -0.2322278  -0.2606153  -0.01876767]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.05192699 -0.01141063  0.11473425 -0.05078471 -0.0436552 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.16260907 -0.3326761  -0.32944313 -0.2015813  -0.1541056 ]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.10367563 -0.02278206  0.2290744  -0.10139499 -0.08716045]
  [ssd_jax] A after chunking sample values: [-0.32465962 -0.27718326 -0.1851165  -0.33033016 -0.34198394]
  [ssd_jax] B after chunking sample values: [-0.01456414 -0.01323255 -0.00995639 -0.02220103 -0.03148108]
  [ssd_jax] C after chunking sample values: [-0.1803503  -0.05673093 -0.2322278  -0.2606153  -0.01876767]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.32465962 -0.24332218 -0.16084552 -0.18696637 -0.1575682 ]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.32465962 -0.5679818  -0.7288273  -0.91579366 -1.0733619 ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.00539137 -0.00118472  0.01191239 -0.00527277 -0.00453254]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [4.0498740e-05 5.1655323e-05 6.0669372e-05 7.3142161e-05 8.5624626e-05]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.00573356  0.00012197  0.01285049  0.00678233 -0.0030475 ]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 2.9271418e-05 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.00280203  0.00075215 -0.00329882  0.00161953 -0.00993016]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.7227733  0.5666679  0.48247445 0.40019888 0.3418573 ]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.00539137 -0.00118472  0.01191239 -0.00527277 -0.00453254]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.00539137 -0.00118472  0.01191239 -0.00527277 -0.00453254]
  [FlaxMamba2] ssm_state sample values: [ 0.00280203  0.00075215 -0.00329882  0.00161953 -0.00993016]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.05310403 -0.01166928  0.11733493 -0.05193585 -0.04464473]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.05310403 -0.01166928  0.11733493 -0.05193585 -0.04464473]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01268505  0.00225626 -0.02697143  0.00826495  0.01088634]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.06625479  0.00923568 -0.09220089  0.01584861  0.03215148]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.06625479  0.00923568 -0.09220089  0.01584861  0.03215148]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-0.62403417 -0.6897006   0.41038942 -0.17611817  0.8997205 ]
  [Layer 25] Output shape after mixer: (1, 128, 1024)
  [Layer 25] Output sample values after mixer: [-0.62403417 -0.6897006   0.41038942 -0.17611817  0.8997205 ]
  [Layer 25] Residual connection shape: (1, 128, 1024)
  [Layer 25] Residual connection sample values: [ 2.3048441 -6.180575   2.6335275 -3.5061145  1.8715386]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.23462275 -0.58609706  0.2626046  -0.42872545  0.18224366]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.23462275 -0.58609706  0.2626046  -0.42872545  0.18224366]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.2819964   1.7341516  -1.4831094   1.2545114   0.04602974]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-1.2819964   1.7341516  -1.4831094   1.2545114   0.04602974]
  [FlaxMamba2] xBC (step) sample values: [ 0.59879696  1.2540995   0.86940366 -1.069837   -1.0107298 ]
  [FlaxMamba2] dt (step) sample values: [2.9486127 7.345663  4.650423  3.7171504 7.18172  ]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [2.7255929 5.7862372 6.0054307 4.8025417 6.832213 ]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-0.22235385 -0.8596227   0.49196064 -1.0917618   1.5440507 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 0.00531387 -0.00336456  0.00174046 -0.00830078  0.00353241]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.05248272  0.34441122 -0.20515615 -0.35425985 -0.5854026 ]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.02692981  0.20157067 -0.09209256 -0.14607897 -0.20939289]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.02692981  0.20157067 -0.09209256 -0.14607897 -0.20939289]
  [FlaxMamba2] B sample values: [ 0.02742957  0.03146254 -0.04483016 -0.05991724 -0.04002952]
  [FlaxMamba2] C sample values: [ 0.3766373  -0.17741172 -0.15153983 -0.16169809  0.06946751]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.02692981  0.20157067 -0.09209256 -0.14607897 -0.20939289]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.329765   -0.06343037 -0.22886811 -0.12639298 -0.0584348 ]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 0.07339971  0.5493996  -0.2510068  -0.39815181 -0.5707198 ]
  [ssd_jax] A after chunking sample values: [-0.8988051  -0.36702317 -1.3744516  -0.60700756 -0.39923897]
  [ssd_jax] B after chunking sample values: [ 0.02742957  0.03146254 -0.04483016 -0.05991724 -0.04002952]
  [ssd_jax] C after chunking sample values: [ 0.3766373  -0.17741172 -0.15153983 -0.16169809  0.06946751]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.8988051  -0.8060933  -0.5692509  -0.423844   -0.46324232]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.8988051 -1.7048984 -2.2741492 -2.6979933 -3.1612356]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 0.06428537  0.48117843 -0.21983828 -0.3487117  -0.4998512 ]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [5.4951508e-13 1.2304428e-12 2.1741207e-12 3.3216700e-12 5.2788650e-12]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.21370311 -0.00347424 -0.07781319 -0.01294352 -0.00993312]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 2.2368317e-13 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.01412271  0.03293481 -0.01916903 -0.02306747 -0.02670062]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.40705577 0.18179086 0.10288441 0.06734051 0.04237335]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 0.06428537  0.48117843 -0.21983828 -0.3487117  -0.4998512 ]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 0.06428537  0.48117843 -0.21983828 -0.3487117  -0.4998512 ]
  [FlaxMamba2] ssm_state sample values: [ 0.01412271  0.03293481 -0.01916903 -0.02306747 -0.02670062]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.17289615  1.2941343  -0.59125733 -0.9378637  -1.3443549 ]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.17289615  1.2941343  -0.59125733 -0.9378637  -1.3443549 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.04814521  1.9074627   0.16218974 -0.9154582  -0.03165211]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03137865  0.8672576   0.09742154 -0.6040342  -0.01537833]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.03137865  0.8672576   0.09742154 -0.6040342  -0.01537833]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-0.9408889   0.10535997 -0.41802433  0.7947132   0.57192594]
  [Layer 26] Output shape after mixer: (1, 128, 1024)
  [Layer 26] Output sample values after mixer: [-0.9408889   0.10535997 -0.41802433  0.7947132   0.57192594]
  [Layer 26] Residual connection shape: (1, 128, 1024)
  [Layer 26] Residual connection sample values: [ 1.3639553 -6.075215   2.2155032 -2.7114012  2.4434645]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.11679079 -0.49521065  0.18303786 -0.26834643  0.21069627]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.11679079 -0.49521065  0.18303786 -0.26834643  0.21069627]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.82280856 -0.4447723   1.4389503   0.42614973  0.26431447]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.82280856 -0.4447723   1.4389503   0.42614973  0.26431447]
  [FlaxMamba2] xBC (step) sample values: [-1.4377635   0.16076088  0.02623458  3.125589    0.211745  ]
  [FlaxMamba2] dt (step) sample values: [0.19437456 1.4778714  2.1230578  2.0555272  0.9033951 ]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.09258582 0.18222469 0.07526894 0.48556173 0.07648667]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-0.5601093   0.06655759 -0.4002475   0.96141565  0.70373523]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.0075531   0.01110077  0.00663376  0.00948334  0.00317383]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.35855874 -0.00296349 -0.04937574 -2.2467844   0.02318122]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.21108049 -0.00147955 -0.0240785  -0.2148537   0.01172495]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.21108049 -0.00147955 -0.0240785  -0.2148537   0.01172495]
  [FlaxMamba2] B sample values: [-0.02489548 -0.0906186  -0.01596002  0.00194825 -0.03625105]
  [FlaxMamba2] C sample values: [-0.22774144  0.07604966 -0.1364574  -0.18119028 -0.16112612]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.21108049 -0.00147955 -0.0240785  -0.2148537   0.01172495]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.562595   -0.03025642 -0.75594616 -1.1612954  -0.04055573]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 0.01954306 -0.00013699 -0.00222933 -0.01989241  0.00108556]
  [ssd_jax] A after chunking sample values: [-0.05208832 -0.00551347 -0.05689926 -0.5638806  -0.00310197]
  [ssd_jax] B after chunking sample values: [-0.02489548 -0.0906186  -0.01596002  0.00194825 -0.03625105]
  [ssd_jax] C after chunking sample values: [-0.22774144  0.07604966 -0.1364574  -0.18119028 -0.16112612]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.05208832 -0.09919477 -0.08889052 -0.07324269 -0.10017382]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.05208832 -0.1512831  -0.24017361 -0.3134163  -0.41359013]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 0.01783921 -0.00012504 -0.00203497 -0.0181581   0.00099092]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.00082189 0.0009076  0.00099197 0.00106735 0.00117981]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.00187226 -0.03229222 -0.01865949  0.00513795  0.0093119 ]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 7.8017265e-04 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.00069178 -0.01057161 -0.00562624 -0.0090113  -0.00423226]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.94924504 0.8596043  0.7864913  0.7309456  0.6612719 ]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 0.01783921 -0.00012504 -0.00203497 -0.0181581   0.00099092]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 0.01783921 -0.00012504 -0.00203497 -0.0181581   0.00099092]
  [FlaxMamba2] ssm_state sample values: [ 0.00069178 -0.01057161 -0.00562624 -0.0090113  -0.00423226]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.43760693 -0.00306737 -0.04991896 -0.44542944  0.02430787]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.43760693 -0.00306737 -0.04991896 -0.44542944  0.02430787]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.10988078  0.00053289 -0.05806035 -0.11483213  0.00363456]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.18824151  0.00071846 -0.11291385 -0.05746144  0.00902739]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.18824151  0.00071846 -0.11291385 -0.05746144  0.00902739]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-0.18243241  0.7463393   0.22063151 -0.38260752 -0.10104829]
  [Layer 27] Output shape after mixer: (1, 128, 1024)
  [Layer 27] Output sample values after mixer: [-0.18243241  0.7463393   0.22063151 -0.38260752 -0.10104829]
  [Layer 27] Residual connection shape: (1, 128, 1024)
  [Layer 27] Residual connection sample values: [ 1.1815228 -5.3288755  2.4361348 -3.0940087  2.3424163]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.08389454 -0.36413488  0.17013727 -0.256833    0.16108753]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.08389454 -0.36413488  0.17013727 -0.256833    0.16108753]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.35798094 -1.3064573   0.20391837 -0.06557259  0.14213827]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [ 0.35798094 -1.3064573   0.20391837 -0.06557259  0.14213827]
  [FlaxMamba2] xBC (step) sample values: [-1.9010557  -0.44413418 -0.17895722  0.58471674 -1.5695405 ]
  [FlaxMamba2] dt (step) sample values: [1.1364794 1.8450739 2.1715684 2.1829402 1.3402567]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.4784264 1.6469467 2.6448874 2.548542  1.2108461]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 0.37390864  0.14847007 -0.853424    0.5593082  -0.13740148]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.01514435  0.00806427  0.01290131 -0.00111198  0.00430679]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.40256512 -0.21443768 -0.17360571 -0.22905804 -0.38365933]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.2412588  -0.09576681 -0.07928699 -0.10146917 -0.15547588]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.2412588  -0.09576681 -0.07928699 -0.10146917 -0.15547588]
  [FlaxMamba2] B sample values: [-0.2775141   0.00159782  0.0522778   0.0474012  -0.1065357 ]
  [FlaxMamba2] C sample values: [-0.01716648 -0.08012873 -0.11535668 -0.21191023 -0.02268926]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.2412588  -0.09576681 -0.07928699 -0.10146917 -0.15547588]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.54422176 -0.18426022 -0.10643356 -0.11241624 -0.25234625]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 0.11542458 -0.04581737 -0.03793299 -0.04854553 -0.07438377]
  [ssd_jax] A after chunking sample values: [-0.26037005 -0.30346677 -0.28150478 -0.2864975  -0.30555245]
  [ssd_jax] B after chunking sample values: [-0.2775141   0.00159782  0.0522778   0.0474012  -0.1065357 ]
  [ssd_jax] C after chunking sample values: [-0.01716648 -0.08012873 -0.11535668 -0.21191023 -0.02268926]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.26037005 -0.45334142 -0.17017385 -0.13232268 -0.09073772]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.26037005 -0.7137115  -0.8838853  -1.0162079  -1.1069458 ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 0.0080344  -0.00318922 -0.00264041 -0.00337912 -0.00517765]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [3.6678852e-05 5.7716425e-05 6.8423440e-05 7.8103723e-05 8.5522202e-05]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.01290768 -0.00701753 -0.00312689  0.00094422 -0.00218113]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 2.8270817e-05 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.013388   -0.00547906  0.00403496 -0.00085546  0.01650319]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.7707663  0.48982283 0.41317448 0.36196494 0.33056706]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 0.0080344  -0.00318922 -0.00264041 -0.00337912 -0.00517765]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 0.0080344  -0.00318922 -0.00264041 -0.00337912 -0.00517765]
  [FlaxMamba2] ssm_state sample values: [ 0.013388   -0.00547906  0.00403496 -0.00085546  0.01650319]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.45814463 -0.18185885 -0.15056407 -0.1926875  -0.29524493]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.45814463 -0.18185885 -0.15056407 -0.1926875  -0.29524493]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.09652661  0.05062592 -0.0169112   0.00611046 -0.02247153]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.3271527   0.16122966 -0.05141447  0.02146366 -0.09184623]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.3271527   0.16122966 -0.05141447  0.02146366 -0.09184623]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-0.47833097 -1.3292161   0.72445947  0.4274803   0.4976791 ]
  [Layer 28] Output shape after mixer: (1, 128, 1024)
  [Layer 28] Output sample values after mixer: [-0.47833097 -1.3292161   0.72445947  0.4274803   0.4976791 ]
  [Layer 28] Residual connection shape: (1, 128, 1024)
  [Layer 28] Residual connection sample values: [ 0.7031919 -6.6580915  3.1605942 -2.6665285  2.8400955]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.05762736 -0.53867763  0.26102546 -0.27003536  0.23378174]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.05762736 -0.53867763  0.26102546 -0.27003536  0.23378174]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.64937794 -0.7484208  -0.8180419  -1.6960005  -0.49098936]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.64937794 -0.7484208  -0.8180419  -1.6960005  -0.49098936]
  [FlaxMamba2] xBC (step) sample values: [ 0.7917805  -0.60947585  0.6781416   0.0798973   1.8617617 ]
  [FlaxMamba2] dt (step) sample values: [1.7715228 2.0127125 2.213634  1.5658615 2.1732326]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.41195932 0.35394463 0.6458643  0.41906554 1.3792795 ]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-0.7402572   0.27950776 -0.40678465  0.7908142  -0.84440327]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 0.00656891 -0.01163483 -0.01435089  0.00156021  0.05960083]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.1457302   0.06134583 -0.30784106  0.351816    1.5075992 ]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.07816504  0.03161345 -0.13041435  0.20653635  1.2342792 ]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.07816504  0.03161345 -0.13041435  0.20653635  1.2342792 ]
  [FlaxMamba2] B sample values: [-0.00764437 -0.02376468 -0.01345784 -0.03212025 -0.01012419]
  [FlaxMamba2] C sample values: [ 0.01017533  0.11010625 -0.08182809 -0.06688419 -0.04474203]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.07816504  0.03161345 -0.13041435  0.20653635  1.2342792 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6542169  -0.13693057 -1.458904   -0.36823887 -0.12178858]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 0.03220082  0.01302346 -0.05372541  0.08508457  0.5084728 ]
  [ssd_jax] A after chunking sample values: [-0.26951075 -0.04846584 -0.94225407 -0.15431622 -0.16798049]
  [ssd_jax] B after chunking sample values: [-0.00764437 -0.02376468 -0.01345784 -0.03212025 -0.01012419]
  [ssd_jax] C after chunking sample values: [ 0.01017533  0.11010625 -0.08182809 -0.06688419 -0.04474203]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.26951075 -0.39936575 -0.13102365 -0.12950481 -0.3066187 ]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.26951075 -0.6688765  -0.7999002  -0.929405   -1.2360237 ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 0.00343917  0.00139096 -0.00573808  0.00908736  0.05430685]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [1.00243415e-05 1.49450880e-05 1.70373187e-05 1.93929827e-05
 2.63516249e-05]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.00543547  0.00224109  0.00705185  0.00318174  0.00142041]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 7.6561255e-06 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 8.9398790e-03  5.5752302e-05  4.5479421e-04 -2.4119376e-03
  2.3020054e-03]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.76375306 0.5122838  0.4493738  0.39478856 0.2905372 ]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 0.00343917  0.00139096 -0.00573808  0.00908736  0.05430685]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 0.00343917  0.00139096 -0.00573808  0.00908736  0.05430685]
  [FlaxMamba2] ssm_state sample values: [ 8.9398790e-03  5.5752302e-05  4.5479421e-04 -2.4119376e-03
  2.3020054e-03]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.13483074  0.05453161 -0.22495817  0.35626477  2.129069  ]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.13483074  0.05453161 -0.22495817  0.35626477  2.129069  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0300431  -0.0131076   0.05634474 -0.09364786 -0.39687824]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.1232395  -0.04198057  0.13482651 -0.27514824 -0.1806491 ]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.1232395  -0.04198057  0.13482651 -0.27514824 -0.1806491 ]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-0.607332    0.24025455 -0.44239318  0.04820173 -0.64525986]
  [Layer 29] Output shape after mixer: (1, 128, 1024)
  [Layer 29] Output sample values after mixer: [-0.607332    0.24025455 -0.44239318  0.04820173 -0.64525986]
  [Layer 29] Residual connection shape: (1, 128, 1024)
  [Layer 29] Residual connection sample values: [ 0.09585989 -6.417837    2.7182012  -2.6183267   2.1948357 ]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.00694886 -0.444068    0.19173536 -0.21672164  0.154628  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [ 0.00694886 -0.444068    0.19173536 -0.21672164  0.154628  ]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.14320047  0.6517552   0.37212372  0.0552687  -0.46119648]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.14320047  0.6517552   0.37212372  0.0552687  -0.46119648]
  [FlaxMamba2] xBC (step) sample values: [ 1.3086506  -0.51683545 -1.0296085  -0.04333098 -0.4981858 ]
  [FlaxMamba2] dt (step) sample values: [3.0070355 2.7913866 2.895681  4.2347975 2.7073774]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [2.705826  1.6810048 2.4057376 2.104969  1.6793954]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-0.44928458  0.04912078  0.45068502 -1.0556526   1.0379541 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.03013611  0.01979065  0.02597046  0.0191803   0.02102661]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.03130662  0.05257396  0.72274905  0.05910755 -0.0885612 ]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.01589832  0.02697783  0.4865634   0.03042695 -0.04232111]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.01589832  0.02697783  0.4865634   0.03042695 -0.04232111]
  [FlaxMamba2] B sample values: [-0.03451698 -0.01131867 -0.00193422  0.02841761 -0.21365745]
  [FlaxMamba2] C sample values: [-0.22627597 -0.21299925 -0.2472683  -0.26315147 -0.26863262]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.01589832  0.02697783  0.4865634   0.03042695 -0.04232111]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2037584  -0.36680323 -0.20777717 -0.09522027 -0.4265393 ]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 0.04301808  0.0729973   1.316556    0.08233003 -0.11451355]
  [ssd_jax] A after chunking sample values: [-0.5513348  -0.61659795 -0.49985737 -0.20043571 -0.71632814]
  [ssd_jax] B after chunking sample values: [-0.03451698 -0.01131867 -0.00193422  0.02841761 -0.21365745]
  [ssd_jax] C after chunking sample values: [-0.22627597 -0.21299925 -0.2472683  -0.26315147 -0.26863262]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.5513348  -0.48294014 -0.23270181 -0.23710252 -0.19756322]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.5513348 -1.0342749 -1.2669768 -1.5040793 -1.7016425]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 0.01432364  0.02430576  0.438371    0.02741326 -0.03812935]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [4.0180339e-06 6.5125646e-06 8.2188853e-06 1.0418022e-05 1.2693630e-05]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.01348564 -0.02317177  0.02379413 -0.00437138  0.0434126 ]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 2.3151124e-06 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.01261516 -0.00990635  0.00261468 -0.01695769  0.05073137]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.5761802  0.35548404 0.2816819  0.22222179 0.18238372]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 0.01432364  0.02430576  0.438371    0.02741326 -0.03812935]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 0.01432364  0.02430576  0.438371    0.02741326 -0.03812935]
  [FlaxMamba2] ssm_state sample values: [ 0.01261516 -0.00990635  0.00261468 -0.01695769  0.05073137]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.01694942  0.02876144  0.5187321   0.03243859 -0.04511913]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.01694942  0.02876144  0.5187321   0.03243859 -0.04511913]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00112684  0.01232335  0.11426985  0.00092119  0.0080468 ]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00278214  0.03360633  0.18837993  0.00252098  0.00807402]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.00278214  0.03360633  0.18837993  0.00252098  0.00807402]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-1.234515    1.6443764   2.4468956   0.13167837 -3.108715  ]
  [Layer 30] Output shape after mixer: (1, 128, 1024)
  [Layer 30] Output sample values after mixer: [-1.234515    1.6443764   2.4468956   0.13167837 -3.108715  ]
  [Layer 30] Residual connection shape: (1, 128, 1024)
  [Layer 30] Residual connection sample values: [-1.1386551 -4.773461   5.1650968 -2.4866483 -0.9138794]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.04931228 -0.2096511   0.22467622 -0.12197304 -0.0396478 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.04931228 -0.2096511   0.22467622 -0.12197304 -0.0396478 ]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.5821465   1.867846    0.06556909 -0.13374949 -0.55795753]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [ 0.5821465   1.867846    0.06556909 -0.13374949 -0.55795753]
  [FlaxMamba2] xBC (step) sample values: [ 0.5958692   0.6662852   0.28632754  0.4053231  -0.7353952 ]
  [FlaxMamba2] dt (step) sample values: [1.2797923  0.8178183  2.3257499  1.7934862  0.76242787]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.15629451 0.12756346 2.9308693  2.8851333  0.13007517]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-9.1697961e-02 -1.1497445e-01  7.8173983e-01 -2.0685734e-01
 -2.9630214e-04]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.0024662  -0.00519562  0.00214577  0.01652527 -0.00143337]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.11652346 -0.10511391 -0.07146089 -0.19063798 -0.6951556 ]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.05487114 -0.04979727 -0.03445432 -0.0862607  -0.23140839]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.05487114 -0.04979727 -0.03445432 -0.0862607  -0.23140839]
  [FlaxMamba2] B sample values: [-0.00448171  0.00295688 -0.00087643 -0.00804312 -0.00050069]
  [FlaxMamba2] C sample values: [-0.10299767 -0.02272907 -0.01603901 -0.11806933 -0.10091775]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.05487114 -0.04979727 -0.03445432 -0.0862607  -0.23140839]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-9.5765535e-03 -1.0641767e-02 -2.6350424e+01 -6.4467737e+02
 -1.6546801e-02]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.00857606 -0.00778304 -0.00538502 -0.01348207 -0.03616786]
  [ssd_jax] A after chunking sample values: [-1.4967627e-03 -1.3575006e-03 -7.7229652e+01 -1.8599801e+03
 -2.1523279e-03]
  [ssd_jax] B after chunking sample values: [-0.00448171  0.00295688 -0.00087643 -0.00804312 -0.00050069]
  [ssd_jax] C after chunking sample values: [-0.10299767 -0.02272907 -0.01603901 -0.11806933 -0.10091775]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.00149676 -0.00061749 -0.0035747  -0.00420971 -0.00429258]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.00149676 -0.00211425 -0.00568895 -0.00989866 -0.01419124]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.00190454 -0.00172843 -0.00119588 -0.00299404 -0.00803201]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.8921693  0.89272034 0.8959173  0.89969677 0.9035671 ]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.01980001 -0.01435973  0.01426348  0.01236247  0.00488665]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.        0.        0.        0.8908349 1.       ]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.01655192 -0.01089356  0.00827961  0.01533628  0.00550112]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.99850434 0.99788797 0.9943272  0.99015015 0.985909  ]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.00190454 -0.00172843 -0.00119588 -0.00299404 -0.00803201]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.00190454 -0.00172843 -0.00119588 -0.00299404 -0.00803201]
  [FlaxMamba2] ssm_state sample values: [ 0.01655192 -0.01089356  0.00827961  0.01533628  0.00550112]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [0.00498116 0.00452056 0.00312774 0.00783068 0.02100708]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [0.00498116 0.00452056 0.00312774 0.00783068 0.02100708]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00186038  0.00731401  0.0001059  -0.00048871 -0.0042667 ]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0270576   0.09620284  0.00141033 -0.02880776 -0.01640409]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.0270576   0.09620284  0.00141033 -0.02880776 -0.01640409]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-0.6963373  -0.4460091   1.3751341   0.19563715  1.7107587 ]
  [Layer 31] Output shape after mixer: (1, 128, 1024)
  [Layer 31] Output sample values after mixer: [-0.6963373  -0.4460091   1.3751341   0.19563715  1.7107587 ]
  [Layer 31] Residual connection shape: (1, 128, 1024)
  [Layer 31] Residual connection sample values: [-1.8349924 -5.21947    6.5402308 -2.291011   0.7968793]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.12362595 -0.34411418  0.42819938 -0.17989866  0.05447182]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.12362595 -0.34411418  0.42819938 -0.17989866  0.05447182]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.91682035 -0.34385642  1.2470207   0.5350604   0.3717144 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.91682035 -0.34385642  1.2470207   0.5350604   0.3717144 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.1497121  -1.2051479  -0.54811805 -0.6548592  -0.57926345]
  [FlaxMamba2] dt (step) sample values: [2.4853625 1.5226603 2.1919158 1.4928133 2.0910265]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [3.0704706 2.2633376 1.737502  1.9762278 2.0335371]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-0.11080576 -0.41832352 -0.19000448 -1.0760485  -1.2735208 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 0.01386261 -0.02233887 -0.01231384  0.01681519  0.02496338]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.03266204 -0.42819938  0.01440759 -0.04333809 -0.02888912]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.0165977  -0.1689488   0.00725569 -0.02119957 -0.01423593]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.0165977  -0.1689488   0.00725569 -0.02119957 -0.01423593]
  [FlaxMamba2] B sample values: [ 0.15519422 -0.08201709  0.06229784  0.17825973  0.03055831]
  [FlaxMamba2] C sample values: [-0.22010653 -0.06758574 -0.27062196 -0.2723284  -0.02346258]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.0165977  -0.1689488   0.00725569 -0.02119957 -0.01423593]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.0662153  -0.08112868 -0.58786964 -0.09559295 -0.5447535 ]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 0.05096274 -0.51875234  0.02227838 -0.06509266 -0.043711  ]
  [ssd_jax] A after chunking sample values: [-0.20331213 -0.18362159 -1.0214247  -0.18891343 -1.1077764 ]
  [ssd_jax] B after chunking sample values: [ 0.15519422 -0.08201709  0.06229784  0.17825973  0.03055831]
  [ssd_jax] C after chunking sample values: [-0.22010653 -0.06758574 -0.27062196 -0.2723284  -0.02346258]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.20331213 -0.09999354 -0.07895056 -0.19972472 -0.18174867]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.20331213 -0.3033057  -0.3822562  -0.58198094 -0.7637296 ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 0.03528344 -0.35915196  0.01542417 -0.04506612 -0.03026279]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.00091678 0.00101319 0.00109642 0.0013388  0.00160564]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.02175861 -0.09044505  0.03497681 -0.01182104  0.04714559]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 7.4811047e-04 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.11042291 -0.05621232  0.05802378  0.46582732  0.23229262]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.81602347 0.73837334 0.68232024 0.5587903  0.46592548]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 0.03528344 -0.35915196  0.01542417 -0.04506612 -0.03026279]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 0.03528344 -0.35915196  0.01542417 -0.04506612 -0.03026279]
  [FlaxMamba2] ssm_state sample values: [ 0.11042291 -0.05621232  0.05802378  0.46582732  0.23229262]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.03490767 -0.35532698  0.0152599  -0.04458617 -0.02994049]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.03490767 -0.35532698  0.0152599  -0.04458617 -0.02994049]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00914056  0.05068979  0.01478173 -0.01504527 -0.00658714]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00405413  0.04882589  0.01419271 -0.00905174 -0.00446476]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.00405413  0.04882589  0.01419271 -0.00905174 -0.00446476]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-0.22136712 -0.05086356  0.19967611 -0.77448565  0.291219  ]
  [Layer 32] Output shape after mixer: (1, 128, 1024)
  [Layer 32] Output sample values after mixer: [-0.22136712 -0.05086356  0.19967611 -0.77448565  0.291219  ]
  [Layer 32] Residual connection shape: (1, 128, 1024)
  [Layer 32] Residual connection sample values: [-2.0563595 -5.270334   6.739907  -3.0654967  1.0880983]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.13548815 -0.33913606  0.44159397 -0.21213286  0.07249298]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.13548815 -0.33913606  0.44159397 -0.21213286  0.07249298]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.89466655 -1.0002792   0.8939235  -1.3315523  -2.9363005 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.89466655 -1.0002792   0.8939235  -1.3315523  -2.9363005 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.857687   0.2748304 -0.8902698 -2.5121908 -1.2574729]
  [FlaxMamba2] dt (step) sample values: [1.3495448 2.6759064 1.5307219 1.263078  1.4388528]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.05333578 0.06786405 0.23371665 0.17426237 0.03460845]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 0.84585553  1.0037569  -0.18888599  0.28016454  0.4498601 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-4.99486923e-05  1.07421875e-02 -5.64098358e-04  1.59606934e-02
 -3.05175781e-03]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.19121009  0.03020475 -0.1487764  -0.8380651  -0.28380048]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.10471763  0.01533044 -0.06886478 -0.2530474  -0.12189863]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.10471763  0.01533044 -0.06886478 -0.2530474  -0.12189863]
  [FlaxMamba2] B sample values: [-0.06256262 -0.00861255  0.02890575  0.02345131 -0.01206451]
  [FlaxMamba2] C sample values: [-0.05309049  0.56005025  0.07420068 -0.24678266  0.03025555]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.10471763  0.01533044 -0.06886478 -0.2530474  -0.12189863]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-13.044406    -1.3849771   -0.1667907   -0.23590268  -5.254998  ]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 0.0055852   0.00081766 -0.00367296 -0.01349648 -0.00650156]
  [ssd_jax] A after chunking sample values: [-0.69573355 -0.09399016 -0.03898176 -0.04110896 -0.18186732]
  [ssd_jax] B after chunking sample values: [-0.06256262 -0.00861255  0.02890575  0.02345131 -0.01206451]
  [ssd_jax] C after chunking sample values: [-0.05309049  0.56005025  0.07420068 -0.24678266  0.03025555]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.69573355 -2.232203   -0.55501676 -0.14040513 -0.31632283]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.69573355 -2.9279366  -3.4829533  -3.6233585  -3.9396813 ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 0.00158246  0.00023167 -0.00104066 -0.00382398 -0.0018421 ]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [2.6722116e-11 2.4906005e-10 4.3385551e-10 4.9925414e-10 6.8501416e-10]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 6.8905210e-05  3.6817952e-04 -1.2977485e-03  1.7304116e-04
  8.1445184e-04]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.000000e+00 0.000000e+00 0.000000e+00 1.332654e-11 1.000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.00107043 -0.00147177  0.00075879  0.00021268  0.00115278]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.4987085  0.05350734 0.03071656 0.02669288 0.01945441]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 0.00158246  0.00023167 -0.00104066 -0.00382398 -0.0018421 ]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 0.00158246  0.00023167 -0.00104066 -0.00382398 -0.0018421 ]
  [FlaxMamba2] ssm_state sample values: [ 0.00107043 -0.00147177  0.00075879  0.00021268  0.00115278]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.11374571  0.01665213 -0.07480186 -0.2748635  -0.13240795]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.11374571  0.01665213 -0.07480186 -0.2748635  -0.13240795]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02952674 -0.00447878 -0.04745556  0.07645738  0.01959033]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.18325582 -0.02695018 -0.38971463  0.52766424  0.1528659 ]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.18325582 -0.02695018 -0.38971463  0.52766424  0.1528659 ]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-4.0813484  0.4227966  1.642901   2.9963496  1.0145171]
  [Layer 33] Output shape after mixer: (1, 128, 1024)
  [Layer 33] Output sample values after mixer: [-4.0813484  0.4227966  1.642901   2.9963496  1.0145171]
  [Layer 33] Residual connection shape: (1, 128, 1024)
  [Layer 33] Residual connection sample values: [-6.1377077  -4.847537    8.382808   -0.06914711  2.1026154 ]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.30800384 -0.23962317  0.4373592  -0.00351984  0.10775889]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.30800384 -0.23962317  0.4373592  -0.00351984  0.10775889]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.23765157 -0.73730546  0.05951136 -1.5823966  -1.6020888 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [ 0.23765157 -0.73730546  0.05951136 -1.5823966  -1.6020888 ]
  [FlaxMamba2] xBC (step) sample values: [-0.01716952 -0.19428888  0.62649643  0.12828413  1.5317891 ]
  [FlaxMamba2] dt (step) sample values: [2.1881473 3.1849732 1.6153085 2.8059068 1.1316978]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.11123495 0.15985048 0.72693974 1.0055225  0.46706066]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-0.4162588  -0.45721817 -0.35401002  0.21654475 -1.3236644 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 0.00783539 -0.03308105 -0.00356293  0.00198746  0.00909424]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.04679226 -0.02124004 -0.17869034 -0.10535692  0.317513  ]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.02284885 -0.01050724 -0.08138378 -0.049906    0.18375048]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.02284885 -0.01050724 -0.08138378 -0.049906    0.18375048]
  [FlaxMamba2] B sample values: [-0.01246659 -0.00688343 -0.05468119  0.04295704  0.01906659]
  [FlaxMamba2] C sample values: [-0.22273003 -0.08723763  0.08200006  0.05542883 -0.18430793]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.02284885 -0.01050724 -0.08138378 -0.049906    0.18375048]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2224774  -0.15365478 -0.8168739  -0.85911244 -2.0730147 ]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.00254159 -0.00116877 -0.00905272 -0.00555129  0.02043948]
  [ssd_jax] A after chunking sample values: [-0.02474726 -0.02456179 -0.5938181  -0.86385685 -0.96822363]
  [ssd_jax] B after chunking sample values: [-0.01246659 -0.00688343 -0.05468119  0.04295704  0.01906659]
  [ssd_jax] C after chunking sample values: [-0.22273003 -0.08723763  0.08200006  0.05542883 -0.18430793]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.02474726 -0.01656215 -0.01287096 -0.01261233 -0.06590231]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.02474726 -0.04130941 -0.05418037 -0.0667927  -0.13269502]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.00052283 -0.00024043 -0.00186223 -0.00114195  0.00420458]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.32063565 0.32599026 0.33021322 0.33440435 0.35718474]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.00018209  0.0058922   0.00265054 -0.00384423  0.0092342 ]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.         0.         0.         0.31279817 1.        ]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.00283178  0.0075375   0.00321586 -0.00635163  0.01004556]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.97555643 0.9595322  0.9472612  0.9353891  0.8757321 ]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.00052283 -0.00024043 -0.00186223 -0.00114195  0.00420458]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.00052283 -0.00024043 -0.00186223 -0.00114195  0.00420458]
  [FlaxMamba2] ssm_state sample values: [ 0.00283178  0.0075375   0.00321586 -0.00635163  0.01004556]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.04547823 -0.02091355 -0.16198583 -0.09933264  0.36573595]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.04547823 -0.02091355 -0.16198583 -0.09933264  0.36573595]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00604311  0.00498971 -0.00496338  0.02679295 -0.09825645]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02847417  0.01314743 -0.01955724  0.12476748 -0.48767367]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.02847417  0.01314743 -0.01955724  0.12476748 -0.48767367]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-2.0075574   2.412288   -0.49932235  0.41825712  1.9618943 ]
  [Layer 34] Output shape after mixer: (1, 128, 1024)
  [Layer 34] Output sample values after mixer: [-2.0075574   2.412288   -0.49932235  0.41825712  1.9618943 ]
  [Layer 34] Residual connection shape: (1, 128, 1024)
  [Layer 34] Residual connection sample values: [-8.145266  -2.435249   7.8834853  0.34911    4.0645094]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.49620098 -0.14719178  0.4731542   0.02267291  0.24609846]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.49620098 -0.14719178  0.4731542   0.02267291  0.24609846]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.93720794 -0.41528943  0.27741295 -1.926472   -0.50590944]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.93720794 -0.41528943  0.27741295 -1.926472   -0.50590944]
  [FlaxMamba2] xBC (step) sample values: [ 0.99900496 -0.5466852   1.0077746   0.17219758 -1.827464  ]
  [FlaxMamba2] dt (step) sample values: [3.7651892 3.4731255 6.341406  3.628104  2.6399155]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [5.32573   5.6485295 6.6707993 5.966608  3.0369844]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-0.33902353 -0.07868662  1.6061976  -0.9954213  -1.5988226 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 0.00648499 -0.00760269 -0.01189423 -0.0009408  -0.00400162]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.24169284 -0.14858992  0.03244437  0.00706737 -0.5309631 ]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.10631324 -0.06878535  0.01648532  0.00354617 -0.19661154]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.10631324 -0.06878535  0.01648532  0.00354617 -0.19661154]
  [FlaxMamba2] B sample values: [-0.22773434 -0.06126337  0.1099409   0.01442703 -0.16348162]
  [FlaxMamba2] C sample values: [-0.11402807 -0.19838654 -0.27676943 -0.23793876 -0.17057951]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.10631324 -0.06878535  0.01648532  0.00354617 -0.19661154]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2053565  -0.14169171 -0.10705902 -0.1460468  -0.2580783 ]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.5661956  -0.3663322   0.08779638  0.01888597 -1.0471    ]
  [ssd_jax] A after chunking sample values: [-1.0936732  -0.80034983 -0.7141692  -0.87140405 -0.7837798 ]
  [ssd_jax] B after chunking sample values: [-0.22773434 -0.06126337  0.1099409   0.01442703 -0.16348162]
  [ssd_jax] C after chunking sample values: [-0.11402807 -0.19838654 -0.27676943 -0.23793876 -0.17057951]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-1.0936732  -1.1344777  -0.94428813 -0.5903043  -0.5474682 ]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-1.0936732 -2.2281508 -3.172439  -3.7627435 -4.3102117]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.40784234 -0.26387662  0.06324153  0.01360395 -0.75424767]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [2.3936327e-19 7.4431030e-19 1.9136127e-18 3.4531893e-18 5.9701049e-18]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.04076277 -0.01363422  0.03992826  0.01769377 -0.03997236]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 8.0182766e-20 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.02451163  0.00782045 -0.03133375 -0.07733791 -0.07660024]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.33498377 0.10772745 0.04190127 0.02321995 0.01343071]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.40784234 -0.26387662  0.06324153  0.01360395 -0.75424767]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.40784234 -0.26387662  0.06324153  0.01360395 -0.75424767]
  [FlaxMamba2] ssm_state sample values: [ 0.02451163  0.00782045 -0.03133375 -0.07733791 -0.07660024]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.6862384  -0.4440007   0.10641065  0.0228901  -1.2691026 ]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.6862384  -0.4440007   0.10641065  0.0228901  -1.2691026 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.18102345  0.07332119  0.01679411 -0.00560658  0.24150938]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.20155482  0.07916331  0.00627137 -0.00902225  0.22525808]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.20155482  0.07916331  0.00627137 -0.00902225  0.22525808]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 0.3029933  -4.801219    2.4270053   1.9511611  -0.15203285]
  [Layer 35] Output shape after mixer: (1, 128, 1024)
  [Layer 35] Output sample values after mixer: [ 0.3029933  -4.801219    2.4270053   1.9511611  -0.15203285]
  [Layer 35] Residual connection shape: (1, 128, 1024)
  [Layer 35] Residual connection sample values: [-7.8422723 -7.2364683 10.310491   2.300271   3.9124765]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.3809789  -0.35944498  0.50382024  0.11927742  0.19470914]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.3809789  -0.35944498  0.50382024  0.11927742  0.19470914]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.13749647  0.4695759  -1.5242938  -0.7976519  -1.1167424 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.13749647  0.4695759  -1.5242938  -0.7976519  -1.1167424 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.21641248 -0.3783667  -0.3787057  -1.9545892  -0.8332973 ]
  [FlaxMamba2] dt (step) sample values: [0.21289343 0.44349438 1.6391956  1.1331486  1.7146736 ]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.08583479 0.02655843 0.09015536 0.11818434 0.13068393]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 0.26931435 -2.1990757   0.72343063  1.8071251   0.40046525]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.00292206 -0.006073    0.00027609  0.00341415  0.00068951]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.01030638 -0.20706478 -0.17166534 -0.58844435 -0.14558089]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.00512664 -0.09285157 -0.07848346 -0.21006986 -0.06750133]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.00512664 -0.09285157 -0.07848346 -0.21006986 -0.06750133]
  [FlaxMamba2] B sample values: [ 0.00473655  0.38701797 -0.13181128  0.36877832 -0.02492691]
  [FlaxMamba2] C sample values: [-0.15895197  0.17701949 -0.19314195  0.05390136  0.07608641]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.00512664 -0.09285157 -0.07848346 -0.21006986 -0.06750133]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.8654757 -5.63779   -3.8975632 -2.4259677 -3.6937442]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.00044004 -0.0079699  -0.00673661 -0.0180313  -0.00579396]
  [ssd_jax] A after chunking sample values: [-0.24595751 -0.14973086 -0.35138622 -0.28671136 -0.482713  ]
  [ssd_jax] B after chunking sample values: [ 0.00473655  0.38701797 -0.13181128  0.36877832 -0.02492691]
  [ssd_jax] C after chunking sample values: [-0.15895197  0.17701949 -0.19314195  0.05390136  0.07608641]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.24595751 -0.5234863  -0.19353943 -0.3238117  -0.29539123]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.24595751 -0.7694438  -0.96298325 -1.2867949  -1.5821862 ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.0004151  -0.00751814 -0.00635477 -0.01700925 -0.00546555]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [2.9959105e-11 5.0567977e-11 6.1366190e-11 8.4831725e-11 1.1398430e-10]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.00554125 -0.00164909  0.00139337  0.00088231  0.00676268]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 2.3426667e-11 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-0.00928994  0.00338554 -0.00474632  0.01230391 -0.00780628]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.7819555  0.46327066 0.3817523  0.27615446 0.20552528]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.0004151  -0.00751814 -0.00635477 -0.01700925 -0.00546555]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.0004151  -0.00751814 -0.00635477 -0.01700925 -0.00546555]
  [FlaxMamba2] ssm_state sample values: [-0.00928994  0.00338554 -0.00474632  0.01230391 -0.00780628]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.01613766 -0.29227868 -0.24705066 -0.66125906 -0.21248105]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.01613766 -0.29227868 -0.24705066 -0.66125906 -0.21248105]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00103328 -0.08444581  0.06734344  0.16378942  0.05851868]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00180891 -0.31570163  0.17392872  0.4510665   0.18338917]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.00180891 -0.31570163  0.17392872  0.4510665   0.18338917]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 0.12658429  2.6884665  -1.5394597   0.49568078  1.1785014 ]
  [Layer 36] Output shape after mixer: (1, 128, 1024)
  [Layer 36] Output sample values after mixer: [ 0.12658429  2.6884665  -1.5394597   0.49568078  1.1785014 ]
  [Layer 36] Residual connection shape: (1, 128, 1024)
  [Layer 36] Residual connection sample values: [-7.7156878 -4.548002   8.77103    2.7959518  5.0909777]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.33710977 -0.20404135  0.40204066  0.1251282   0.22817615]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.33710977 -0.20404135  0.40204066  0.1251282   0.22817615]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.22037429 -0.469997    0.77820325 -1.7263287  -4.041061  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [ 0.22037429 -0.469997    0.77820325 -1.7263287  -4.041061  ]
  [FlaxMamba2] xBC (step) sample values: [ 0.13208637  0.38580072  0.96549237 -0.6413636   1.6738492 ]
  [FlaxMamba2] dt (step) sample values: [ 1.450952    2.442596   -0.19581261 -2.3553767   0.54862344]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [2.6917018e-03 8.0175221e-02 2.7493068e-03 7.0320748e-05 2.8650968e-03]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 0.60216296 -0.13252309 -0.6261729  -0.61719257  1.6055206 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.00347519 -0.01195526 -0.01242065 -0.01150513 -0.00496674]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.11087713 -0.16797808 -0.3495394   0.17885958  0.20325735]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.05236827 -0.07695142 -0.14453249  0.09740622  0.11192165]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.05236827 -0.07695142 -0.14453249  0.09740622  0.11192165]
  [FlaxMamba2] B sample values: [-0.04618098 -0.13810234  0.03235584 -0.00419894 -0.02017231]
  [FlaxMamba2] C sample values: [-0.25284243 -0.19984661 -0.04901711 -0.18011294 -0.24938773]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.05236827 -0.07695142 -0.14453249  0.09740622  0.11192165]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.8178532  -31.169907   -39.01954     -0.46187502  -0.64770097]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.00014096 -0.00020713 -0.00038904  0.00026219  0.00030126]
  [ssd_jax] A after chunking sample values: [-4.89311852e-03 -2.49905419e+00 -1.07276686e-01 -3.24793982e-05
 -1.85572600e-03]
  [ssd_jax] B after chunking sample values: [-0.04618098 -0.13810234  0.03235584 -0.00419894 -0.02017231]
  [ssd_jax] C after chunking sample values: [-0.25284243 -0.19984661 -0.04901711 -0.18011294 -0.24938773]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.00489312 -0.00397129 -0.01272504 -0.00081523 -0.00155741]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.00489312 -0.00886441 -0.02158944 -0.02240467 -0.02396209]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.00074564 -0.00109567 -0.00205792  0.00138692  0.00159359]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.8298837  0.833186   0.84385604 0.84454423 0.8458606 ]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.00018369  0.00033099 -0.00056024  0.00129036 -0.00065834]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.        0.        0.        0.8258329 1.       ]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-0.0003918   0.00033866 -0.00061558  0.00091514 -0.00058026]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.99511886 0.99117476 0.9786419  0.9778445  0.9763227 ]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.00074564 -0.00109567 -0.00205792  0.00138692  0.00159359]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.00074564 -0.00109567 -0.00205792  0.00138692  0.00159359]
  [FlaxMamba2] ssm_state sample values: [-0.0003918   0.00033866 -0.00061558  0.00091514 -0.00058026]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.09666403 -0.14204086 -0.26678544  0.17979738  0.2065907 ]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.09666403 -0.14204086 -0.26678544  0.17979738  0.2065907 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01182002  0.02567656 -0.14227587 -0.04688673 -0.01442207]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.06744888  0.1059514  -0.5521752  -0.28789425 -0.04725496]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.06744888  0.1059514  -0.5521752  -0.28789425 -0.04725496]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-0.01093109  3.322622    0.16424325 -0.37437767  3.403156  ]
  [Layer 37] Output shape after mixer: (1, 128, 1024)
  [Layer 37] Output sample values after mixer: [-0.01093109  3.322622    0.16424325 -0.37437767  3.403156  ]
  [Layer 37] Residual connection shape: (1, 128, 1024)
  [Layer 37] Residual connection sample values: [-7.726619  -1.2253797  8.935274   2.421574   8.494134 ]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.32213178 -0.05108752  0.37074813  0.09783337  0.3564913 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.32213178 -0.05108752  0.37074813  0.09783337  0.3564913 ]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.654436   -2.5973988   2.464471    1.362492    0.11161484]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.654436   -2.5973988   2.464471    1.362492    0.11161484]
  [FlaxMamba2] xBC (step) sample values: [ 0.04415208 -0.8274634  -0.9598782   0.65963566 -0.66053224]
  [FlaxMamba2] dt (step) sample values: [2.4269507 1.5870651 3.8412638 1.8265723 1.993228 ]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [2.6975067  0.47969016 3.8152335  1.1491168  0.56450826]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 1.2566627   0.20195916  1.5038368   1.7691193  -0.7121307 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 0.01089478  0.02030945 -0.02822876  0.00245857 -0.01774597]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.01157389  0.11371812 -0.17117135 -0.17129277  0.05516059]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.00575345  0.06008853 -0.0782786  -0.07832896  0.02834077]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.00575345  0.06008853 -0.0782786  -0.07832896  0.02834077]
  [FlaxMamba2] B sample values: [ 0.01783923 -0.04005842  0.06208497  0.00750117 -0.04563048]
  [FlaxMamba2] C sample values: [-0.26046252 -0.03313153 -0.25674373 -0.27810594 -0.1892452 ]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.00575345  0.06008853 -0.0782786  -0.07832896  0.02834077]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17041285 -2.0831616  -0.13507122 -0.41240796 -3.531486  ]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.01551998  0.16208921 -0.21115705 -0.2112929   0.07644942]
  [ssd_jax] A after chunking sample values: [-0.4596898 -0.9992721 -0.5153282 -0.4739049 -1.993553 ]
  [ssd_jax] B after chunking sample values: [ 0.01783923 -0.04005842  0.06208497  0.00750117 -0.04563048]
  [ssd_jax] C after chunking sample values: [-0.26046252 -0.03313153 -0.25674373 -0.27810594 -0.1892452 ]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.4596898  -0.3218377  -0.20573051 -0.17690584 -0.1444328 ]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.4596898  -0.7815275  -0.98725796 -1.1641638  -1.3085966 ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.00477311  0.04984995 -0.06494059 -0.06498236  0.02351174]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [4.0258217e-07 5.5542671e-07 6.8229838e-07 8.1433575e-07 9.4087073e-07]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.0591461   0.0533856  -0.01040845  0.00493424 -0.02054762]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 2.5422233e-07 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-0.01540344  0.16344465  0.00829012  0.00872463 -0.07693292]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.6314795  0.45770633 0.37259698 0.3121836  0.27019897]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.00477311  0.04984995 -0.06494059 -0.06498236  0.02351174]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.00477311  0.04984995 -0.06494059 -0.06498236  0.02351174]
  [FlaxMamba2] ssm_state sample values: [-0.01540344  0.16344465  0.00829012  0.00872463 -0.07693292]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.00561692  0.05866258 -0.07642099 -0.07647015  0.02766822]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.00561692  0.05866258 -0.07642099 -0.07647015  0.02766822]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00125713 -0.01056017 -0.17357418 -0.08295234  0.00163017]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00381731 -0.02158955 -0.39243808 -0.3744733   0.00508817]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.00381731 -0.02158955 -0.39243808 -0.3744733   0.00508817]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-6.876827   2.1168177 -0.6957764  1.0776802  5.97792  ]
  [Layer 38] Output shape after mixer: (1, 128, 1024)
  [Layer 38] Output sample values after mixer: [-6.876827   2.1168177 -0.6957764  1.0776802  5.97792  ]
  [Layer 38] Residual connection shape: (1, 128, 1024)
  [Layer 38] Residual connection sample values: [-14.603445    0.891438    8.239498    3.4992542  14.472054 ]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.3810602   0.02529677  0.22676027  0.10100401  0.39634317]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.3810602   0.02529677  0.22676027  0.10100401  0.39634317]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.16521755 -0.2080836  -1.1273382   0.31398028 -0.7205882 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [ 0.16521755 -0.2080836  -1.1273382   0.31398028 -0.7205882 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.62873876  0.6752656  -0.42960587  0.01583642 -0.0903616 ]
  [FlaxMamba2] dt (step) sample values: [0.893675  2.0913813 0.7723817 1.9137754 1.2254622]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.5628494  1.2543628  0.5027174  0.64816475 0.03006328]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-0.8728538   1.1085325   0.16301915  2.4909613  -0.08025581]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 0.00061417 -0.00782013  0.00500107  0.00160217 -0.00399399]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.18165089 -0.17629668 -0.07064141  0.54144466 -0.02912576]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.0990521  -0.08039827 -0.03407367  0.34227335 -0.01435082]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.0990521  -0.08039827 -0.03407367  0.34227335 -0.01435082]
  [FlaxMamba2] B sample values: [-0.01386519 -0.01250881 -0.211254    0.37656474 -0.00400351]
  [FlaxMamba2] C sample values: [-0.2592379  -0.27529696 -0.00051571 -0.09058744 -0.27562892]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.0990521  -0.08039827 -0.03407367  0.34227335 -0.01435082]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.7351256e+02 -2.3790452e+00 -2.6078771e-03 -1.4978828e+00
 -6.3306607e-02]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 0.05575142 -0.04525212 -0.01917834  0.19264835 -0.00807735]
  [ssd_jax] A after chunking sample values: [-9.7661438e+01 -2.9841859e+00 -1.3110251e-03 -9.7087485e-01
 -1.9032041e-03]
  [ssd_jax] B after chunking sample values: [-0.01386519 -0.01250881 -0.211254    0.37656474 -0.00400351]
  [ssd_jax] C after chunking sample values: [-0.2592379  -0.27529696 -0.00051571 -0.09058744 -0.27562892]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [ -97.66144 -184.95963 -172.23615 -234.72612  -83.66658]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [ -97.66144 -282.62106 -454.8572  -689.5833  -773.2499 ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 0.01350356 -0.01096052 -0.00464519  0.04666137 -0.00195642]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.00035976 -0.0003291   0.00537678  0.00060323 -0.000676  ]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1. 0. 0. 0. 1.]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.00077916  0.00668363 -0.0620057  -0.00630024 -0.020491  ]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 0.01350356 -0.01096052 -0.00464519  0.04666137 -0.00195642]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 0.01350356 -0.01096052 -0.00464519  0.04666137 -0.00195642]
  [FlaxMamba2] ssm_state sample values: [ 0.00077916  0.00668363 -0.0620057  -0.00630024 -0.020491  ]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.46170062 -0.37475157 -0.15882382  1.595401   -0.06689189]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.46170062 -0.37475157 -0.15882382  1.595401   -0.06689189]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [0.04128411 0.03494783 0.04380461 0.28946248 0.01577459]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.17911845 0.14364696 0.17036594 1.0985054  0.07221456]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [0.17911845 0.14364696 0.17036594 1.0985054  0.07221456]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-1.9852533 -2.6190631 -2.5718975 -2.901557   0.9449264]
  [Layer 39] Output shape after mixer: (1, 128, 1024)
  [Layer 39] Output sample values after mixer: [-1.9852533 -2.6190631 -2.5718975 -2.901557   0.9449264]
  [Layer 39] Residual connection shape: (1, 128, 1024)
  [Layer 39] Residual connection sample values: [-16.5887      -1.7276251    5.6676006    0.59769726  15.41698   ]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.50519687 -0.05614206  0.18040541  0.01742479  0.4860731 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.50519687 -0.05614206  0.18040541  0.01742479  0.4860731 ]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.7110465 -0.6987801  0.4122392  1.4751656 -1.5577356]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.7110465 -0.6987801  0.4122392  1.4751656 -1.5577356]
  [FlaxMamba2] xBC (step) sample values: [-0.5858388  0.2900586 -0.194951  -0.4722545  1.8231878]
  [FlaxMamba2] dt (step) sample values: [ 1.4015917  1.1214396  2.0714993 -4.394573   2.5289626]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [7.0680767e-02 3.9238852e-02 2.0127353e-01 7.5138814e-05 1.8522690e-01]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-1.2147112 -1.4281828 -1.8997272 -0.4070388  0.1403009]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.00011915  0.00191212 -0.00192738  0.00039959  0.0010891 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.2428366  -0.10181619 -0.10958885  0.07503678  0.31400272]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.13608867 -0.0483187  -0.051795    0.03892536  0.18145023]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.13608867 -0.0483187  -0.051795    0.03892536  0.18145023]
  [FlaxMamba2] B sample values: [ 0.02615682 -0.19895841 -0.03239921 -0.00074237 -0.00041664]
  [FlaxMamba2] C sample values: [-0.24777862 -0.27843893 -0.25426644 -0.19881544  0.22769576]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.13608867 -0.0483187  -0.051795    0.03892536  0.18145023]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.52670574 -0.63007647 -0.38779998 -2.7909086  -0.42841786]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 0.00961885 -0.0034152  -0.00366091  0.00275127  0.01282504]
  [ssd_jax] A after chunking sample values: [-0.03722797 -0.02472348 -0.07805387 -0.00020971 -0.07935451]
  [ssd_jax] B after chunking sample values: [ 0.02615682 -0.19895841 -0.03239921 -0.00074237 -0.00041664]
  [ssd_jax] C after chunking sample values: [-0.24777862 -0.27843893 -0.25426644 -0.19881544  0.22769576]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.03722797 -0.03825407 -0.01491196 -0.05589829 -0.04972144]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.03722797 -0.07548204 -0.09039401 -0.14629228 -0.19601372]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 0.00388907 -0.00138083 -0.00148017  0.00111239  0.00518539]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.00152029 0.00157958 0.00160331 0.00169548 0.00178192]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.01363726 -0.06522822 -0.01256852 -0.00344893 -0.00127298]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.         0.         0.         0.00146474 1.        ]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.00627809 -0.03606674 -0.00736499 -0.00053607 -0.00283985]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.96345645 0.9272964  0.9135712  0.8639052  0.822001  ]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 0.00388907 -0.00138083 -0.00148017  0.00111239  0.00518539]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 0.00388907 -0.00138083 -0.00148017  0.00111239  0.00518539]
  [FlaxMamba2] ssm_state sample values: [ 0.00627809 -0.03606674 -0.00736499 -0.00053607 -0.00283985]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.34079343 -0.12099975 -0.1297051   0.09747694  0.45438796]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.34079343 -0.12099975 -0.1297051   0.09747694  0.45438796]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.07981236  0.02807833 -0.03216859  0.11702601 -0.12314008]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.42812112  0.17831624 -0.2079702   0.5979192  -1.0362598 ]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.42812112  0.17831624 -0.2079702   0.5979192  -1.0362598 ]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-0.57321143  0.24219227  1.4520198  -0.5161872  -1.2350603 ]
  [Layer 40] Output shape after mixer: (1, 128, 1024)
  [Layer 40] Output sample values after mixer: [-0.57321143  0.24219227  1.4520198  -0.5161872  -1.2350603 ]
  [Layer 40] Residual connection shape: (1, 128, 1024)
  [Layer 40] Residual connection sample values: [-17.161911    -1.4854329    7.1196203    0.08151007  14.181919  ]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.33245012 -0.03076562  0.14225397  0.00156021  0.27529946]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.33245012 -0.03076562  0.14225397  0.00156021  0.27529946]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.9711331 -2.1776967 -0.5535368 -0.5511751  0.3656066]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.9711331 -2.1776967 -0.5535368 -0.5511751  0.3656066]
  [FlaxMamba2] xBC (step) sample values: [-0.00795804  0.6753732  -0.08637703 -0.847093    0.47742352]
  [FlaxMamba2] dt (step) sample values: [ 1.2976592  -1.0374837  -0.61530983  1.2040477   0.46344027]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.23851085 0.07938137 0.05667933 0.37053934 0.12722668]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-7.3550087e-01 -7.8716666e-01 -2.1741539e-01 -6.7050642e-01
 -6.6275895e-04]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 0.00233078 -0.00773621 -0.00321007 -0.00061703  0.00109959]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.03352395  0.12983657 -0.01913823  0.04336846 -0.11487021]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.01648104  0.06912675 -0.00947755  0.02215436 -0.05413993]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.01648104  0.06912675 -0.00947755  0.02215436 -0.05413993]
  [FlaxMamba2] B sample values: [ 0.03197892  0.08591522  0.05313772 -0.03241532  0.02832934]
  [FlaxMamba2] C sample values: [-0.14880115  0.09202811 -0.01654132 -0.11091246 -0.21077855]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.01648104  0.06912675 -0.00947755  0.02215436 -0.05413993]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.0530885  -1.135641   -0.87189615 -1.5713016  -1.7430981 ]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.00393091  0.01648748 -0.0022605   0.00528406 -0.01291296]
  [ssd_jax] A after chunking sample values: [-0.25117305 -0.09014873 -0.04941849 -0.582229   -0.22176859]
  [ssd_jax] B after chunking sample values: [ 0.03197892  0.08591522  0.05313772 -0.03241532  0.02832934]
  [ssd_jax] C after chunking sample values: [-0.14880115  0.09202811 -0.01654132 -0.11091246 -0.21077855]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.25117305 -0.32658744 -0.18177854 -0.0902862  -0.23350304]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.25117305 -0.57776046 -0.759539   -0.8498252  -1.0833282 ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.00087824  0.00368363 -0.00050504  0.00118056 -0.00288501]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [6.2523386e-09 8.6671781e-09 1.0394961e-08 1.1377155e-08 1.4369541e-08]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 5.4051357e-05  1.8474078e-03 -6.1762665e-04 -2.4020993e-04
  2.0611030e-03]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 4.8636175e-09 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.00222565  0.00124184 -0.00261365 -0.00076962 -0.00044042]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.77788776 0.5611537  0.46788207 0.42748964 0.33846715]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.00087824  0.00368363 -0.00050504  0.00118056 -0.00288501]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.00087824  0.00368363 -0.00050504  0.00118056 -0.00288501]
  [FlaxMamba2] ssm_state sample values: [ 0.00222565  0.00124184 -0.00261365 -0.00076962 -0.00044042]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.02195922  0.09210398 -0.01262782  0.02951831 -0.07213565]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.02195922  0.09210398 -0.01262782  0.02951831 -0.07213565]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0058571  -0.02041273  0.00255165 -0.00594809 -0.0155707 ]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.10306041 -0.47948897  0.05174668 -0.14661542 -0.35639003]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.10306041 -0.47948897  0.05174668 -0.14661542 -0.35639003]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 1.1131619 -1.2453717 -0.1997419  1.7897326 -2.2428083]
  [Layer 41] Output shape after mixer: (1, 128, 1024)
  [Layer 41] Output sample values after mixer: [ 1.1131619 -1.2453717 -0.1997419  1.7897326 -2.2428083]
  [Layer 41] Residual connection shape: (1, 128, 1024)
  [Layer 41] Residual connection sample values: [-16.04875    -2.7308044   6.9198785   1.8712426  11.939111 ]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.2899075  -0.05300857  0.13364612  0.03375663  0.22692895]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.2899075  -0.05300857  0.13364612  0.03375663  0.22692895]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.07651882 -0.41775072 -0.20909643 -0.4562015  -0.8935384 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [ 0.07651882 -0.41775072 -0.20909643 -0.4562015  -0.8935384 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.13828063  0.0186016  -0.12391782  0.16219792 -0.44563475]
  [FlaxMamba2] dt (step) sample values: [ 1.4703159  -0.03390402  0.55930805  0.9345604   0.54717135]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.38862988 0.12626405 0.21721834 0.05208509 0.13026318]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 0.32565174  0.8731997  -0.1301969   0.85377     1.6888742 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.00055695  0.00141239  0.00099659 -0.00162983  0.00351524]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.04962059 -0.03209942  0.03107617 -0.03559779 -0.15943134]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.02419487 -0.01579214  0.0157795  -0.01748212 -0.07337451]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.02419487 -0.01579214  0.0157795  -0.01748212 -0.07337451]
  [FlaxMamba2] B sample values: [-0.06687212 -0.01883209  0.02629586 -0.05616256 -0.03047923]
  [FlaxMamba2] C sample values: [-0.08363053 -0.16572505 -0.18196368 -0.2665299  -0.26766732]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.02419487 -0.01579214  0.0157795  -0.01748212 -0.07337451]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.2458453 -1.7473589 -3.3796544 -1.2264227 -1.3705136]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.00940285 -0.0061373   0.00613238 -0.00679408 -0.02851553]
  [ssd_jax] A after chunking sample values: [-0.8728026  -0.22062862 -0.73412293 -0.06387834 -0.17852746]
  [ssd_jax] B after chunking sample values: [-0.06687212 -0.01883209  0.02629586 -0.05616256 -0.03047923]
  [ssd_jax] C after chunking sample values: [-0.08363053 -0.16572505 -0.18196368 -0.2665299  -0.26766732]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.8728026 -1.2190248 -0.5353386 -0.4223794 -0.8126724]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.8728026 -2.0918274 -2.6271658 -3.0495453 -3.8622177]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.00320563 -0.00209233  0.00209066 -0.00231624 -0.00972154]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [6.5155131e-18 2.2047751e-17 3.7658172e-17 5.7450777e-17 1.2948955e-16]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.00259115  0.00571783  0.0022375   0.00086556  0.0011486 ]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.0000000e+00 0.0000000e+00 0.0000000e+00 2.7220444e-18 1.0000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 1.4412666e-03 -2.4239405e-04  5.4824892e-03  1.2288165e-05
  5.6737807e-04]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.41777903 0.12346132 0.07228304 0.04738046 0.02102133]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.00320563 -0.00209233  0.00209066 -0.00231624 -0.00972154]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.00320563 -0.00209233  0.00209066 -0.00231624 -0.00972154]
  [FlaxMamba2] ssm_state sample values: [ 1.4412666e-03 -2.4239405e-04  5.4824892e-03  1.2288165e-05
  5.6737807e-04]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.03628528 -0.02368362  0.02366466 -0.02621811 -0.11004045]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.03628528 -0.02368362  0.02366466 -0.02621811 -0.11004045]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00144134  0.0039284  -0.00221637  0.00463942  0.02855174]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02626636  0.06884287 -0.03998771  0.08479945  0.35543132]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.02626636  0.06884287 -0.03998771  0.08479945  0.35543132]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 1.1653675   0.25659603  0.47558504  0.43166858 -0.01398522]
  [Layer 42] Output shape after mixer: (1, 128, 1024)
  [Layer 42] Output sample values after mixer: [ 1.1653675   0.25659603  0.47558504  0.43166858 -0.01398522]
  [Layer 42] Residual connection shape: (1, 128, 1024)
  [Layer 42] Residual connection sample values: [-14.883383   -2.4742084   7.3954635   2.3029113  11.925125 ]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.24395733 -0.04439511  0.12700133  0.03772152  0.19870979]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.24395733 -0.04439511  0.12700133  0.03772152  0.19870979]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.10037783 -0.86871904 -0.2661731  -1.083476    0.65003884]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [ 0.10037783 -0.86871904 -0.2661731  -1.083476    0.65003884]
  [FlaxMamba2] xBC (step) sample values: [-0.79414964 -0.16763319  0.25180793 -0.7859155  -0.57916355]
  [FlaxMamba2] dt (step) sample values: [-0.355267   -1.2465019  -0.17142278  1.1802998   1.9810929 ]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.04358688 0.02346146 0.05295816 0.868978   0.00924484]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-1.0569133   0.20666319  0.2407873  -0.4484206  -0.04855532]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 0.00114918  0.0004015   0.00156307 -0.00040483 -0.00014019]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.16844213 -0.0303903  -0.07983986 -0.1904793  -0.11061703]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.0771446  -0.01496428 -0.03832718 -0.08619639 -0.05225259]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.0771446  -0.01496428 -0.03832718 -0.08619639 -0.05225259]
  [FlaxMamba2] B sample values: [ 0.02080208  0.09442487 -0.01040994 -0.14861014  0.0741018 ]
  [FlaxMamba2] C sample values: [-0.23936844 -0.22354054 -0.2018229  -0.2639055  -0.1532457 ]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.0771446  -0.01496428 -0.03832718 -0.08619639 -0.05225259]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-3.7045815 -2.655313  -8.210951  -2.2381823 -4.092597 ]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.00336249 -0.00065225 -0.00167056 -0.00375703 -0.00227753]
  [ssd_jax] A after chunking sample values: [-0.16147116 -0.06229752 -0.4348369  -1.9449313  -0.03783542]
  [ssd_jax] B after chunking sample values: [ 0.02080208  0.09442487 -0.01040994 -0.14861014  0.0741018 ]
  [ssd_jax] C after chunking sample values: [-0.23936844 -0.22354054 -0.2018229  -0.2639055  -0.1532457 ]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.16147116 -0.7255648  -0.37232244 -0.24809934 -0.325824  ]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.16147116 -0.88703597 -1.2593584  -1.5074577  -1.8332818 ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [4.6613286e-04 9.0419031e-05 2.3158531e-04 5.2082672e-04 3.1572723e-04]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [1.0625229e-11 2.1950639e-11 3.1852576e-11 4.0821894e-11 5.6545369e-11]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.00261154 -0.00054153 -0.00790741  0.00702649 -0.00437477]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.000000e+00 0.000000e+00 0.000000e+00 9.040919e-12 1.000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-0.00013737 -0.00039444  0.00012267  0.00098679 -0.00088813]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.85089105 0.41187477 0.28383607 0.22147231 0.159888  ]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [4.6613286e-04 9.0419031e-05 2.3158531e-04 5.2082672e-04 3.1572723e-04]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [4.6613286e-04 9.0419031e-05 2.3158531e-04 5.2082672e-04 3.1572723e-04]
  [FlaxMamba2] ssm_state sample values: [-0.00013737 -0.00039444  0.00012267  0.00098679 -0.00088813]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.1267747  -0.02459137 -0.06298453 -0.14164984 -0.08586871]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.1267747  -0.02459137 -0.06298453 -0.14164984 -0.08586871]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00668175  0.00631321  0.00727335  0.03880576 -0.03667349]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.11819977  0.14963807  0.13799426  0.7414305  -0.72421074]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.11819977  0.14963807  0.13799426  0.7414305  -0.72421074]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 0.26695073  5.339446   -2.3416567   1.0379274  -2.0268016 ]
  [Layer 43] Output shape after mixer: (1, 128, 1024)
  [Layer 43] Output sample values after mixer: [ 0.26695073  5.339446   -2.3416567   1.0379274  -2.0268016 ]
  [Layer 43] Residual connection shape: (1, 128, 1024)
  [Layer 43] Residual connection sample values: [-14.616432    2.8652377   5.053807    3.3408387   9.898323 ]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.23075332  0.04677701  0.08272463  0.05155541  0.15818603]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.23075332  0.04677701  0.08272463  0.05155541  0.15818603]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.78997993 -0.38065022 -0.7463232  -0.27954206 -0.7691893 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.78997993 -0.38065022 -0.7463232  -0.27954206 -0.7691893 ]
  [FlaxMamba2] xBC (step) sample values: [-0.44243068  0.48010695 -0.7744171  -0.17050615 -0.14703923]
  [FlaxMamba2] dt (step) sample values: [-0.5679669  -0.40006214  0.02602112  1.0171696   2.6850317 ]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.05746369 0.02999    0.02517496 0.12073947 0.10807178]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-0.87320983  0.08247381 -0.47152138  0.2909551   0.7827966 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.00085831 -0.00102806 -0.00318909  0.00102806  0.00041318]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.06930248 -0.15875068 -0.17497538  0.01658976 -0.02074247]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.03345102 -0.07308809 -0.07985306  0.00836368 -0.01026368]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.03345102 -0.07308809 -0.07985306  0.00836368 -0.01026368]
  [FlaxMamba2] B sample values: [ 0.06906127 -0.25161985 -0.2764411   0.12622368  0.03917122]
  [FlaxMamba2] C sample values: [ 0.0322796  -0.27842715 -0.18690982 -0.03664786 -0.10608622]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.03345102 -0.07308809 -0.07985306  0.00836368 -0.01026368]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-4.6876054  -0.9752563  -0.82549465 -1.2937802  -0.49527767]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.00192222 -0.00419991 -0.00458865  0.00048061 -0.00058979]
  [ssd_jax] A after chunking sample values: [-0.2693671  -0.02924793 -0.0207818  -0.15621035 -0.05352554]
  [ssd_jax] B after chunking sample values: [ 0.06906127 -0.25161985 -0.2764411   0.12622368  0.03917122]
  [ssd_jax] C after chunking sample values: [ 0.0322796  -0.27842715 -0.18690982 -0.03664786 -0.10608622]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.2693671  -2.6922998  -1.1187288  -0.82276183 -1.2154546 ]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.2693671 -2.961667  -4.0803957 -4.903157  -6.1186123]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-3.5619951e-04 -7.7827059e-04 -8.5030653e-04  8.9059751e-05
 -1.0929164e-04]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [4.8195249e-27 7.1163087e-26 2.1782737e-25 4.9594467e-25 1.6722386e-24]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.00113277  0.001983    0.00246916 -0.00062124  0.00037787]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.000000e+00 0.000000e+00 0.000000e+00 3.681455e-27 1.000000e+00]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-0.0006627  -0.00022659 -0.00025913  0.00050553  0.00034775]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.7638628  0.0517326  0.01690078 0.00742311 0.00220151]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-3.5619951e-04 -7.7827059e-04 -8.5030653e-04  8.9059751e-05
 -1.0929164e-04]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-3.5619951e-04 -7.7827059e-04 -8.5030653e-04  8.9059751e-05
 -1.0929164e-04]
  [FlaxMamba2] ssm_state sample values: [-0.0006627  -0.00022659 -0.00025913  0.00050553  0.00034775]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.05848877 -0.1277938  -0.13962227  0.01462381 -0.01794594]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.05848877 -0.1277938  -0.13962227  0.01462381 -0.01794594]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01442394  0.01974831  0.03351419 -0.00176014  0.00437104]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.28821874  0.36136726  0.7772342  -0.03508583  0.08543641]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.28821874  0.36136726  0.7772342  -0.03508583  0.08543641]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-2.0571952   1.4711871  -0.01959261  2.1689627  -4.507842  ]
  [Layer 44] Output shape after mixer: (1, 128, 1024)
  [Layer 44] Output sample values after mixer: [-2.0571952   1.4711871  -0.01959261  2.1689627  -4.507842  ]
  [Layer 44] Residual connection shape: (1, 128, 1024)
  [Layer 44] Residual connection sample values: [-16.673628    4.336425    5.034214    5.5098014   5.390481 ]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.29919973  0.08401179  0.09490975  0.09920801  0.09799495]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.29919973  0.08401179  0.09490975  0.09920801  0.09799495]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.0543437  -2.251103    0.34905058 -0.5142825  -1.2085538 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.0543437  -2.251103    0.34905058 -0.5142825  -1.2085538 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.23352803 -0.57605994  1.6010658   0.28822678  0.23008788]
  [FlaxMamba2] dt (step) sample values: [0.8364274  1.8153799  0.72677606 2.6489832  2.8121681 ]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.00511536 0.10882217 0.01591384 0.00885704 0.2786848 ]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-0.05148625 -0.21397868  1.3553896  -0.18906733  1.5986322 ]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.00176334  0.00250053  0.00076771 -0.00180912  0.00244904]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.03410603  0.19519073  0.25484452 -0.1154606   0.02683045]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.01734379  0.10709009  0.14357138 -0.05440121  0.01359519]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.01734379  0.10709009  0.14357138 -0.05440121  0.01359519]
  [FlaxMamba2] B sample values: [-0.01414258 -0.06604791  0.02176389 -0.2567441   0.07042186]
  [FlaxMamba2] C sample values: [-0.2113432  -0.13582356 -0.09724914  0.11251535 -0.19601974]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.01734379  0.10709009  0.14357138 -0.05440121  0.01359519]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.3039274e+00 -3.9384812e-02 -6.8873577e+00 -8.0558503e-01
 -1.9935181e+03]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 8.8719826e-05  5.4780487e-04  7.3441997e-04 -2.7828204e-04
  6.9544330e-05]
  [ssd_jax] A after chunking sample values: [-6.67006429e-03 -4.28594043e-03 -1.09604284e-01 -7.13509927e-03
 -5.55563171e+02]
  [ssd_jax] B after chunking sample values: [-0.01414258 -0.06604791  0.02176389 -0.2567441   0.07042186]
  [ssd_jax] C after chunking sample values: [-0.2113432  -0.13582356 -0.09724914  0.11251535 -0.19601974]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.00667006 -0.02329243 -0.06860361 -0.05299023 -0.00371505]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.00667006 -0.02996249 -0.09856611 -0.15155634 -0.15527138]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 1.45386775e-05  8.97697682e-05  1.20350720e-04 -4.56025773e-05
  1.13963542e-05]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.5712317  0.58469325 0.62621325 0.6602914  0.66274893]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [ 0.00158291  0.00110273  0.00141103 -0.00097327  0.00201104]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.         0.         0.         0.56743425 1.        ]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [0.00167792 0.00096957 0.00123633 0.00019522 0.00164206]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.9933521  0.97048193 0.9061358  0.85936946 0.8561828 ]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 1.45386775e-05  8.97697682e-05  1.20350720e-04 -4.56025773e-05
  1.13963542e-05]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 1.45386775e-05  8.97697682e-05  1.20350720e-04 -4.56025773e-05
  1.13963542e-05]
  [FlaxMamba2] ssm_state sample values: [0.00167792 0.00096957 0.00123633 0.00019522 0.00164206]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.04502711  0.27802208  0.37273303 -0.14123377  0.03529516]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.04502711  0.27802208  0.37273303 -0.14123377  0.03529516]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00119023 -0.05961554  0.07629056  0.02717895 -0.00980907]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01264234 -0.47507447  0.72587633  0.24493363 -0.10602544]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.01264234 -0.47507447  0.72587633  0.24493363 -0.10602544]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 0.02200204 -1.772805    0.89865124 -2.114387    3.385812  ]
  [Layer 45] Output shape after mixer: (1, 128, 1024)
  [Layer 45] Output sample values after mixer: [ 0.02200204 -1.772805    0.89865124 -2.114387    3.385812  ]
  [Layer 45] Residual connection shape: (1, 128, 1024)
  [Layer 45] Residual connection sample values: [-16.651627    2.5636199   5.932865    3.3954144   8.776293 ]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.2625247   0.04346856  0.09857969  0.05449332  0.13695513]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.2625247   0.04346856  0.09857969  0.05449332  0.13695513]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.3493433   0.30540377  0.43327817  0.9004945   1.4524109 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-2.3493433   0.30540377  0.43327817  0.9004945   1.4524109 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.2644459   0.88823235 -0.02498321 -0.7398352  -0.80769455]
  [FlaxMamba2] dt (step) sample values: [2.6567554  1.7103696  1.5530915  0.68410623 2.3594584 ]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.11842113 0.07480352 0.00514467 0.02571172 0.10954301]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 0.6570333   0.992865    0.32960883  1.3960607  -0.53818834]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-2.7675629e-03  4.3749809e-04  7.9810619e-05  3.5262108e-04
 -1.8167496e-04]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.06942811 -0.20072219  0.19796778  0.13021553  0.12666798]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.03591864 -0.09032242  0.10874983  0.0693408   0.06733983]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.03591864 -0.09032242  0.10874983  0.0693408   0.06733983]
  [FlaxMamba2] B sample values: [-0.03324326  0.05096111 -0.02372601  0.10135365 -0.08836974]
  [FlaxMamba2] C sample values: [-0.02167838 -0.09862761 -0.15436256 -0.06091134  0.20225455]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.03591864 -0.09032242  0.10874983  0.0693408   0.06733983]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.4426116  -0.9829804 -10.158994   -1.363838   -1.7559118]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 0.00425353 -0.01069608  0.01287828  0.00821142  0.00797446]
  [ssd_jax] A after chunking sample values: [-0.17083569 -0.0735304  -0.05226465 -0.03506662 -0.19234787]
  [ssd_jax] B after chunking sample values: [-0.03324326  0.05096111 -0.02372601  0.10135365 -0.08836974]
  [ssd_jax] C after chunking sample values: [-0.02167838 -0.09862761 -0.15436256 -0.06091134  0.20225455]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.17083569 -0.03357482 -0.0079616  -0.00932304 -0.05372541]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.17083569 -0.20441051 -0.21237211 -0.22169515 -0.27542055]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 0.00049316 -0.00124011  0.00149312  0.00095204  0.00092457]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.14356446 0.14846644 0.14965318 0.15105493 0.15939239]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-9.2096382e-04 -6.6477667e-05 -2.5275757e-04  3.7155134e-04
 -5.7043065e-04]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.        0.        0.        0.1210191 1.       ]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-2.5793260e-03  3.1650008e-04 -4.3920896e-05  4.1268277e-04
 -8.4070128e-04]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.84296006 0.8151277  0.8086637  0.80115956 0.7592528 ]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 0.00049316 -0.00124011  0.00149312  0.00095204  0.00092457]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 0.00049316 -0.00124011  0.00149312  0.00095204  0.00092457]
  [FlaxMamba2] ssm_state sample values: [-2.5793260e-03  3.1650008e-04 -4.3920896e-05  4.1268277e-04
 -8.4070128e-04]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.04449775 -0.1118958   0.13472459  0.08590275  0.08342385]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.04449775 -0.1118958   0.13472459  0.08590275  0.08342385]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00910736 -0.01967578  0.03541248  0.05500333  0.09818897]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.26516667 -0.5326009   0.8176883   1.2573837   2.2433572 ]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.26516667 -0.5326009   0.8176883   1.2573837   2.2433572 ]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 3.2579699  2.3640542 -1.9810938 -2.1300213 -8.895381 ]
  [Layer 46] Output shape after mixer: (1, 128, 1024)
  [Layer 46] Output sample values after mixer: [ 3.2579699  2.3640542 -1.9810938 -2.1300213 -8.895381 ]
  [Layer 46] Residual connection shape: (1, 128, 1024)
  [Layer 46] Residual connection sample values: [-13.393657     4.9276743    3.9517713    1.265393    -0.11908817]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.17495693  0.06711315  0.05272119  0.01560438 -0.00155665]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.17495693  0.06711315  0.05272119  0.01560438 -0.00155665]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.46146607 -0.02168866 -1.0009323  -1.406481   -0.78492194]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.46146607 -0.02168866 -1.0009323  -1.406481   -0.78492194]
  [FlaxMamba2] xBC (step) sample values: [ 0.28897712  0.30182076 -0.8768735   0.57625175 -0.4619076 ]
  [FlaxMamba2] dt (step) sample values: [0.96935207 1.3739314  1.1799991  5.368717   2.3307166 ]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [0.1177792  0.01744216 0.04155676 1.5767618  0.04117429]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [ 0.14557755 -1.1729769   0.17930436 -0.7105696  -0.11408119]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [-0.00245667  0.00082588  0.00027394  0.00136757  0.0010376 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [-0.07479747  0.06426919 -0.16948816 -0.09534058 -0.07701912]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [-0.03600072  0.03316687 -0.07757966 -0.04539956 -0.0370273 ]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [-0.03600072  0.03316687 -0.07757966 -0.04539956 -0.0370273 ]
  [FlaxMamba2] B sample values: [ 0.20731321  0.04124796  0.01350918  0.02145235 -0.27541876]
  [FlaxMamba2] C sample values: [-0.22942993 -0.25408792  0.22865665 -0.2751395  -0.277957  ]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [-0.03600072  0.03316687 -0.07757966 -0.04539956 -0.0370273 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-5.7667141e+01 -2.2024069e+00 -3.8371372e+00 -4.6045512e-02
 -2.0699801e+00]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [-0.00424014  0.00390637 -0.00913727 -0.00534712 -0.00436105]
  [ssd_jax] A after chunking sample values: [-6.7919893  -0.03841474 -0.15945901 -0.07260281 -0.08522997]
  [ssd_jax] B after chunking sample values: [ 0.20731321  0.04124796  0.01350918  0.02145235 -0.27541876]
  [ssd_jax] C after chunking sample values: [-0.22942993 -0.25408792  0.22865665 -0.2751395  -0.277957  ]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-6.7919893 -8.850057  -5.548046  -4.3516717 -1.9894046]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [ -6.7919893 -15.642046  -21.190092  -25.541763  -27.53117  ]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [-0.00093325  0.00085979 -0.0020111  -0.0011769  -0.00095986]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [-0.00023318  0.00014695  0.00012248 -0.00015218 -0.0010675 ]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1. 0. 0. 0. 1.]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [ 0.00305393  0.00024256 -0.00020775 -0.00099059 -0.00414635]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [1.1227331e-03 1.6097030e-07 6.2698902e-10 8.0789169e-12 1.1050065e-12]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [-0.00093325  0.00085979 -0.0020111  -0.0011769  -0.00095986]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [-0.00093325  0.00085979 -0.0020111  -0.0011769  -0.00095986]
  [FlaxMamba2] ssm_state sample values: [ 0.00305393  0.00024256 -0.00020775 -0.00099059 -0.00414635]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [-0.0576631   0.05312406 -0.12426095 -0.07271741 -0.0593074 ]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [-0.0576631   0.05312406 -0.12426095 -0.07271741 -0.0593074 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01028827 -0.00056985  0.03342728  0.02012679  0.01458278]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.27723476 -0.01699037  0.91364425  0.7879136   0.4606624 ]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [ 0.27723476 -0.01699037  0.91364425  0.7879136   0.4606624 ]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [ 5.490295  15.979891  10.841768   4.977658   2.0865808]
  [Layer 47] Output shape after mixer: (1, 128, 1024)
  [Layer 47] Output sample values after mixer: [ 5.490295  15.979891  10.841768   4.977658   2.0865808]
  [Layer 47] Residual connection shape: (1, 128, 1024)
  [Layer 47] Residual connection sample values: [-7.903362  20.907566  14.793539   6.2430506  1.9674926]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.08598014  0.24540472  0.17159534  0.06623682  0.02214871]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 128, 1024)
  [FlaxMamba2] u sample values: [-0.08598014  0.24540472  0.17159534  0.06623682  0.02214871]
  [FlaxMamba2] Boolean Branch: False
  [FlaxMamba2] Step Mode: False
  [FlaxMamba2] in_proj output shape: (1, 128, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.06238325  0.18846133 -0.01057504 -0.5324853  -1.58926   ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 128, 2048), xBC: (1, 128, 2304), dt: (1, 128, 32)
  [FlaxMamba2] z (step) sample values: [-0.06238325  0.18846133 -0.01057504 -0.5324853  -1.58926   ]
  [FlaxMamba2] xBC (step) sample values: [-0.12091292  0.43651578  0.81236017 -1.2286222   0.4127841 ]
  [FlaxMamba2] dt (step) sample values: [ 2.0409112 -1.8137791  1.5885595  1.9794033  0.9636586]
  [FlaxMamba2] dt after softplus shape: (1, 128, 32)
  [FlaxMamba2] dt after softplus sample values: [8.5185722e-02 3.5036894e-05 3.0997332e-02 1.3201617e-01 2.3195739e-01]
  [FlaxMamba2] conv_state shape after padding/slicing: (1, 2304, 4)
  [FlaxMamba2] conv_state sample values: [-0.03527111  0.6851481   1.5800574   0.2602709  -0.04030941]
  [FlaxMamba2] conv_weight shape: (4, 1, 2304)
  [FlaxMamba2] conv_weight sample values: [ 1.3089180e-04  1.7805099e-03  5.6266785e-05 -2.1910667e-04
 -8.2015991e-04]
  [FlaxMamba2] Added conv1d bias shape: (1, 128, 2304)
  [FlaxMamba2] xBC_conv after adding bias sample values: [ 0.0226309   0.03582302  0.07477982 -0.22450723 -0.01737477]
  [FlaxMamba2] xBC after convolution shape: (1, 128, 2304)
  [FlaxMamba2] xBC after convolution sample values: [ 0.01144349  0.0182323   0.03878726 -0.09970541 -0.00861192]
  [FlaxMamba2] Split conv1d output -> x: (1, 128, 2048), B: (1, 128, 128), C: (1, 128, 128)
  [FlaxMamba2] x sample values: [ 0.01144349  0.0182323   0.03878726 -0.09970541 -0.00861192]
  [FlaxMamba2] B sample values: [ 0.16962731 -0.06237913 -0.27832434  0.00906653 -0.0358042 ]
  [FlaxMamba2] C sample values: [-0.02512561 -0.01567782 -0.2481787   0.00039127 -0.04222472]
  [FlaxMamba2] x after rearrange shape: (1, 128, 32, 64)
  [FlaxMamba2] x after rearrange sample values: [ 0.01144349  0.0182323   0.03878726 -0.09970541 -0.00861192]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.7303779  -7.389056   -3.3796544  -1.802826  -17.760078 ]
[ssd_jax] Starting SSD computation with JAX...
  [ssd_jax] After chunking shapes -> x: (1, 2, 64, 32, 64), A: (1, 2, 64, 32), B: (1, 2, 64, 1, 128), C: (1, 2, 64, 1, 128)
  [ssd_jax] x after chunking sample values: [ 0.00097482  0.00155313  0.00330412 -0.00849348 -0.00073361]
  [ssd_jax] A after chunking sample values: [-1.4740349e-01 -2.5888957e-04 -1.0476027e-01 -2.3800218e-01
 -4.1195812e+00]
  [ssd_jax] B after chunking sample values: [ 0.16962731 -0.06237913 -0.27832434  0.00906653 -0.0358042 ]
  [ssd_jax] C after chunking sample values: [-0.02512561 -0.01567782 -0.2481787   0.00039127 -0.04222472]
  [ssd_jax] A rearranged shape: (1, 32, 2, 64)
  [ssd_jax] A rearranged sample values: [-0.1474035  -0.04384604 -0.02390346 -0.01508001 -0.07501194]
  [ssd_jax] A_cumsum shape: (1, 32, 2, 64)
  [ssd_jax] A_cumsum sample values: [-0.1474035  -0.19124953 -0.215153   -0.230233   -0.30524495]
  [ssd_jax] L shape: (1, 32, 2, 64, 64)
  [ssd_jax] L sample values: [1. 0. 0. 0. 0.]
  [ssd_jax] Y_diag shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_diag sample values: [ 0.00013819  0.00022017  0.00046839 -0.00120402 -0.000104  ]
  [ssd_jax] decay_states shape: (1, 32, 2, 64)
  [ssd_jax] decay_states sample values: [0.16022885 0.16741054 0.17146045 0.17406565 0.18762486]
  [ssd_jax] states shape: (1, 2, 32, 64, 128)
  [ssd_jax] states sample values: [3.7369307e-05 1.7952156e-04 1.6981359e-03 2.6056965e-04 3.8870741e-05]
  [ssd_jax] Initialized initial_states with zeros.
  [ssd_jax] initial_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states after concatenation shape: (1, 3, 32, 64, 128)
  [ssd_jax] states after concatenation sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] decay_chunk shape: (1, 32, 3, 3)
  [ssd_jax] decay_chunk sample values: [1.        0.        0.        0.1382688 1.       ]
  [ssd_jax] new_states shape: (1, 3, 32, 64, 128)
  [ssd_jax] new_states sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] states shape after splitting: (1, 2, 32, 64, 128), final_state shape: (1, 32, 64, 128)
  [ssd_jax] states after splitting sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] final_state sample values: [-1.8675534e-04  6.9624861e-04  7.0893858e-04 -2.5269378e-04
 -8.4910556e-05]
  [ssd_jax] state_decay_out shape: (1, 32, 2, 64)
  [ssd_jax] state_decay_out sample values: [0.86294574 0.8259265  0.80641806 0.7943485  0.7369428 ]
  [ssd_jax] Y_off shape: (1, 2, 64, 32, 64)
  [ssd_jax] Y_off sample values: [0. 0. 0. 0. 0.]
  [ssd_jax] Y after adding Y_diag and Y_off shape: (1, 128, 32, 64)
  [ssd_jax] Y after adding Y_diag and Y_off sample values: [ 0.00013819  0.00022017  0.00046839 -0.00120402 -0.000104  ]
  [FlaxMamba2] ssd output y shape: (1, 128, 32, 64), ssm_state shape: (1, 32, 64, 128)
  [FlaxMamba2] y sample values: [ 0.00013819  0.00022017  0.00046839 -0.00120402 -0.000104  ]
  [FlaxMamba2] ssm_state sample values: [-1.8675534e-04  6.9624861e-04  7.0893858e-04 -2.5269378e-04
 -8.4910556e-05]
  [FlaxMamba2] y after adding D scaling shape: (1, 128, 32, 64)
  [FlaxMamba2] y after adding D scaling sample values: [ 0.01641478  0.0261528   0.05563729 -0.14301959 -0.01235312]
  [FlaxMamba2] y after rearrange to (b, l, d_inner): (1, 128, 2048)
  [FlaxMamba2] y after rearrange sample values: [ 0.01641478  0.0261528   0.05563729 -0.14301959 -0.01235312]
[FlaxRMSNorm] x after gated scaling shape: (1, 128, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00049604  0.00269593 -0.00029263  0.02817289  0.00332744]
[FlaxRMSNorm] x_normalized shape: (1, 128, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02240203  0.13636912 -0.01401613  1.1875645   0.19098642]
  [FlaxMamba2] y after RMSNorm shape: (1, 128, 2048)
  [FlaxMamba2] y after RMSNorm sample values: [-0.02240203  0.13636912 -0.01401613  1.1875645   0.19098642]
  [FlaxMamba2] y after out_proj shape: (1, 128, 1024)
  [FlaxMamba2] y after out_proj sample values: [-12.784886   17.126894   12.249842   17.917177    1.8878579]
  [Layer 48] Output shape after mixer: (1, 128, 1024)
  [Layer 48] Output sample values after mixer: [-12.784886   17.126894   12.249842   17.917177    1.8878579]
  [Layer 48] Residual connection shape: (1, 128, 1024)
  [Layer 48] Residual connection sample values: [-20.688248   38.034462   27.04338    24.160229    3.8553505]
[FlaxRMSNorm] x_normalized shape: (1, 128, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.4241334   1.1264726   0.6343043   0.44734144  0.08130179]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 128, 1024)
[Mamba2LMHeadModel] Final backbone norm output sample values: [-0.4241334   1.1264726   0.6343043   0.44734144  0.08130179]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 128, 50288)
[Mamba2LMHeadModel] Logits sample values: [-62.002937 -73.29878  -61.862312 -59.256783 -62.846264]
[Mamba2LMHeadModel] Forward pass input_ids shape: (1, 1)
[Mamba2LMHeadModel] input_ids sample values: [12536]
[Mamba2LMHeadModel] Embedding output shape: (1, 1, 1024)
[Mamba2LMHeadModel] Embedding sample values: [-0.2208252  -0.10571289  0.02835083 -0.09124756  0.05453491]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.25973988 -0.15824199  0.03656967 -0.09171429  0.06006685]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.25973988 -0.15824199  0.03656967 -0.09171429  0.06006685]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.25973988 -0.15824199  0.03656967 -0.09171429  0.06006685]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.42544216 -0.8080133  -0.18026307 -0.5068924  -0.36389253]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.42544216 -0.8080133  -0.18026307 -0.5068924  -0.36389253]
  [FlaxMamba2] xBC (step) sample values: [ 0.01573907  0.14707138 -0.17253894  0.54385495  0.24229926]
  [FlaxMamba2] dt (step) sample values: [ 0.01587706  0.18821253  0.05733844  0.20266888 -0.21264349]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5484117  -0.27020603  0.53985476  0.01573907  3.3068485 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06460922 -0.06859199  0.0617792  -0.12433011 -0.07721067]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.10718124 -0.07618324  0.17451113 -0.33380276 -0.27435422]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.05645983 -0.03664135  0.09484984 -0.13930112 -0.1184767 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05645983 -0.03664135  0.09484984 -0.13930112 -0.1184767 ]
  [FlaxMamba2] B (step) sample values: [-0.26874128 -0.03381333  0.00313038  0.6462601   0.05692035]
  [FlaxMamba2] C (step) sample values: [-0.24831903 -0.03148544  0.14852116 -0.27087578 -0.04236817]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.4383634 -1.0010935 -1.2128745 -1.1529616 -1.4844131]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05658981 0.04078517 0.02576606 0.03186904 0.01818955]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.97549826 0.9599925  0.96923226 0.9639231  0.9733605 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05645983 -0.03664135  0.09484984 -0.13930112 -0.1184767 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-8.58642103e-04 -1.08035325e-04  1.00017132e-05  2.06483388e-03
  1.81863419e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-8.58642103e-04 -1.08035325e-04  1.00017132e-05  2.06483388e-03
  1.81863419e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01874219 -0.00392666 -0.00063295  0.04514202 -0.00065504]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.11507751 -0.0043632   0.2609395  -0.3975629  -0.3358842 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.21190962 -0.06720538  0.4236129  -0.63647294 -0.5390791 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.21190962 -0.06720538  0.4236129  -0.63647294 -0.5390791 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.05452454  0.01674233 -0.03474887  0.1212813   0.08043188]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.10833368  0.02745451 -0.05694441  0.1629713   0.5533977 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.10833368  0.02745451 -0.05694441  0.1629713   0.5533977 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.57755095  0.56890446 -0.28704458 -0.8428485   0.451891  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.57755095  0.56890446 -0.28704458 -0.8428485   0.451891  ]
  [Layer 1] Output shape after mixer: (1, 1, 1024)
  [Layer 1] Output sample values after mixer: [ 0.57755095  0.56890446 -0.28704458 -0.8428485   0.451891  ]
  [Layer 1] Residual connection shape: (1, 1, 1024)
  [Layer 1] Residual connection sample values: [ 0.35672575  0.46319157 -0.25869375 -0.93409604  0.5064259 ]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.17473191  0.19053796 -0.09822189 -0.48113275  0.22583157]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.17473191  0.19053796 -0.09822189 -0.48113275  0.22583157]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.17473191  0.19053796 -0.09822189 -0.48113275  0.22583157]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.5387739 -1.3208036 -1.4053371  2.8064067 -1.820009 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.5387739 -1.3208036 -1.4053371  2.8064067 -1.820009 ]
  [FlaxMamba2] xBC (step) sample values: [0.662316  0.4700334 1.7583648 0.5092795 1.0393231]
  [FlaxMamba2] dt (step) sample values: [-0.00738856  0.6332192   0.7257584   0.27425647  0.19848083]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5080013   1.0932317  -0.63347316  0.662316   -0.24062857]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.14587791  0.11547215 -0.13653046  0.2021153  -0.11980484]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.13654716  0.08554967 -0.24834687  0.05807233 -0.11642692]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.07292763  0.0446034  -0.10883316  0.02987903 -0.05482847]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.07292763  0.0446034  -0.10883316  0.02987903 -0.05482847]
  [FlaxMamba2] B (step) sample values: [ 0.00566731 -0.0245558   0.04883652  0.0019794  -0.02642025]
  [FlaxMamba2] C (step) sample values: [ 0.0294379   0.15501727 -0.22922182 -0.00576002  0.30763257]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-12.692555   -19.429585    -0.22886811  -2.10566     -5.0388985 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05001702 0.0648726  0.05024346 0.08166458 0.06870952]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.53001827 0.28352708 0.98856676 0.8420147  0.70735663]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.07292763  0.0446034  -0.10883316  0.02987903 -0.05482847]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.0672212e-05 -8.9570291e-05  1.7813720e-04  7.2201042e-06
 -9.6371121e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.0672212e-05 -8.9570291e-05  1.7813720e-04  7.2201042e-06
 -9.6371121e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.34833845e-05  3.69380490e-04 -3.10459989e-04 -3.63155530e-04
  1.60595999e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00341907  0.00142049  0.00200306 -0.00312483  0.00144726]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.04519644  0.03115432 -0.07054804  0.01679333 -0.03510287]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.04519644  0.03115432 -0.07054804  0.01679333 -0.03510287]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01228992 -0.00866941  0.0195284   0.04444355  0.00890802]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00572703 -0.00567948  0.01157943  0.01735256  0.00607008]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00572703 -0.00567948  0.01157943  0.01735256  0.00607008]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.02535477  0.02351783  0.10160273  0.04126648 -0.18221833]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.02535477  0.02351783  0.10160273  0.04126648 -0.18221833]
  [Layer 2] Output shape after mixer: (1, 1, 1024)
  [Layer 2] Output sample values after mixer: [ 0.02535477  0.02351783  0.10160273  0.04126648 -0.18221833]
  [Layer 2] Residual connection shape: (1, 1, 1024)
  [Layer 2] Residual connection sample values: [ 0.38208053  0.4867094  -0.15709102 -0.89282954  0.3242076 ]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.27367723  0.29254356 -0.08410627 -0.68447775  0.22164455]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.27367723  0.29254356 -0.08410627 -0.68447775  0.22164455]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.27367723  0.29254356 -0.08410627 -0.68447775  0.22164455]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.85861856 -1.9788606  -0.79651934 -3.5739162   0.22911973]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.85861856 -1.9788606  -0.79651934 -3.5739162   0.22911973]
  [FlaxMamba2] xBC (step) sample values: [ 2.5471575  -0.53134364 -0.64344484 -1.3401415  -3.4470117 ]
  [FlaxMamba2] dt (step) sample values: [0.1676157  0.23615006 0.8645863  0.57411754 0.6496379 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.3213415   0.15875363 -2.017992    2.5471575  -0.20226216]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.13492471 -0.1597219   0.10151738 -0.24195942  0.06106006]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.09006387 -0.23748069  0.05040044 -0.28859028 -0.00577343]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.04705844 -0.10470697  0.02583513 -0.12361737 -0.00287838]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04705844 -0.10470697  0.02583513 -0.12361737 -0.00287838]
  [FlaxMamba2] B (step) sample values: [-0.23442616 -0.1334141  -0.0248492   0.17561929 -0.10619868]
  [FlaxMamba2] C (step) sample values: [-0.26116806  0.83675945  0.9792518   0.40300742  0.17799044]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-20.926485    -0.880345    -0.67350245  -0.6461216   -0.27258503]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01483296 0.00612706 0.00010694 0.00927416 0.01963371]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7331524  0.9946206  0.999928   0.9940257  0.99466246]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04705844 -0.10470697  0.02583513 -0.12361737 -0.00287838]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.6363320e-04 -9.3125178e-05 -1.7345135e-05  1.2258507e-04
 -7.4128373e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.6363320e-04 -9.3125178e-05 -1.7345135e-05  1.2258507e-04
 -7.4128373e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 5.9204339e-04 -5.7807990e-04 -1.0452762e-03 -8.3935098e-05
  6.0580182e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01196776  0.02109729  0.00981232 -0.00504819 -0.02464898]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02143931 -0.05323482  0.02815284 -0.0928049  -0.02669236]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02143931 -0.05323482  0.02815284 -0.0928049  -0.02669236]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00547879  0.01279305 -0.00696881  0.00904838 -0.00340666]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00308061  0.00641753 -0.00276168  0.00399037 -0.00223266]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00308061  0.00641753 -0.00276168  0.00399037 -0.00223266]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.10866277  0.22569183 -0.42344773  0.32697463 -0.01417477]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.10866277  0.22569183 -0.42344773  0.32697463 -0.01417477]
  [Layer 3] Output shape after mixer: (1, 1, 1024)
  [Layer 3] Output sample values after mixer: [-0.10866277  0.22569183 -0.42344773  0.32697463 -0.01417477]
  [Layer 3] Residual connection shape: (1, 1, 1024)
  [Layer 3] Residual connection sample values: [ 0.27341777  0.7124012  -0.58053875 -0.5658549   0.31003284]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.12637989  0.28518203 -0.21877821 -0.2780883   0.13483949]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.12637989  0.28518203 -0.21877821 -0.2780883   0.13483949]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.12637989  0.28518203 -0.21877821 -0.2780883   0.13483949]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 3.0040448  -0.11105386 -2.2692132   0.05495223  0.96439946]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 3.0040448  -0.11105386 -2.2692132   0.05495223  0.96439946]
  [FlaxMamba2] xBC (step) sample values: [-0.73858327  0.5750487   0.39312956 -0.52439743  2.2559798 ]
  [FlaxMamba2] dt (step) sample values: [1.0589966  0.9565649  0.93394756 0.8438866  0.40310448]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.5863846  -2.334062   -0.80816627 -0.73858327 -0.5216246 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.18293142 -0.02753784 -0.06102364 -0.25601247 -0.08896209]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.20498037 -0.01497985 -0.10142891 -0.32070974  0.17007113]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.1129578  -0.00743383 -0.04814471 -0.13485932  0.09224924]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.1129578  -0.00743383 -0.04814471 -0.13485932  0.09224924]
  [FlaxMamba2] B (step) sample values: [-0.27738556 -0.01388538 -0.08980412  0.0364699  -0.01333312]
  [FlaxMamba2] C (step) sample values: [-0.26695156  0.0267951   0.26444173 -0.22778039  0.18138433]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.49070406 -0.5047996  -0.6491257  -0.5552266  -0.46572492]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.12443824 0.14209476 0.20005676 0.08961839 0.4605087 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9407646  0.93078274 0.8782166  0.95145917 0.8069687 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.1129578  -0.00743383 -0.04814471 -0.13485932  0.09224924]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00389901 -0.00019518 -0.00126231  0.00051263 -0.00018741]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00389901 -0.00019518 -0.00126231  0.00051263 -0.00018741]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.03085191 -0.00326588 -0.00164494  0.00170651  0.00038409]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.08755286  0.02456995  0.01985444 -0.25263926  0.3783742 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.16248345  0.01963871 -0.01208237 -0.34209824  0.43956774]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.16248345  0.01963871 -0.01208237 -0.34209824  0.43956774]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.46504772 -0.00102999  0.00256915 -0.00965773  0.30691805]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.4075805  -0.00096945  0.0020195  -0.00836     0.19345745]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.4075805  -0.00096945  0.0020195  -0.00836     0.19345745]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.19825312 -0.00113412 -0.22598897 -0.0629359  -0.1777326 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.19825312 -0.00113412 -0.22598897 -0.0629359  -0.1777326 ]
  [Layer 4] Output shape after mixer: (1, 1, 1024)
  [Layer 4] Output sample values after mixer: [-0.19825312 -0.00113412 -0.22598897 -0.0629359  -0.1777326 ]
  [Layer 4] Residual connection shape: (1, 1, 1024)
  [Layer 4] Residual connection sample values: [ 0.07516465  0.7112671  -0.80652773 -0.6287908   0.13230024]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.04755486  0.37938184 -0.37600476 -0.39664727  0.07940691]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.04755486  0.37938184 -0.37600476 -0.39664727  0.07940691]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.04755486  0.37938184 -0.37600476 -0.39664727  0.07940691]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.51204234 -2.9377787  -2.9719002  -0.8843742  -1.3978816 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.51204234 -2.9377787  -2.9719002  -0.8843742  -1.3978816 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.2688788  -3.925372   -3.6293411   2.0861676  -0.03593352]
  [FlaxMamba2] dt (step) sample values: [1.6891032 0.7501497 1.4433391 0.7667522 1.4497278]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 2.0134449e-03 -6.2854677e-01 -2.4791298e+00  2.6887879e-01
 -1.6327515e+00]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.84561497 -1.3172901  -0.67025113 -0.17686278 -0.15129144]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.90896946 -1.5586231  -0.67760205 -0.14999205 -0.1403509 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.2610658  -0.27095777 -0.22821416 -0.06938215 -0.06525893]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.2610658  -0.27095777 -0.22821416 -0.06938215 -0.06525893]
  [FlaxMamba2] B (step) sample values: [-0.09461441  0.00770014 -0.22703825 -0.0310993  -0.08873853]
  [FlaxMamba2] C (step) sample values: [ 0.0067721   0.682023   -0.27393645 -0.2515924  -0.13209613]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.07591622 -0.53187454 -0.04695368 -1.4938657  -3.6258397 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.6542103  0.0294132  0.14741866 0.0300136  0.06737833]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.951548  0.9844776 0.9931021 0.956154  0.7832502]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.2610658  -0.27095777 -0.22821416 -0.06938215 -0.06525893]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01615938 -0.00131512  0.0387763   0.00531151  0.01515583]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01615938 -0.00131512  0.0387763   0.00531151  0.01515583]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01874532 -0.00765502  0.56641793  0.06417987  0.00134983]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-1.8992894 -1.8062948 -1.377113  -0.4272487 -0.7436633]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-2.2666852  -2.1876116  -1.698277   -0.52488965 -0.8355017 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-2.2666852  -2.1876116  -1.698277   -0.52488965 -0.8355017 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [0.43490863 0.32337523 0.24585277 0.1356724  0.23142871]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.02312066 0.01816895 0.02828305 0.01715264 0.03180305]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.02312066 0.01816895 0.02828305 0.01715264 0.03180305]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.16451107 -0.47988892  0.06073894  0.660975    1.1744474 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.16451107 -0.47988892  0.06073894  0.660975    1.1744474 ]
  [Layer 5] Output shape after mixer: (1, 1, 1024)
  [Layer 5] Output sample values after mixer: [-0.16451107 -0.47988892  0.06073894  0.660975    1.1744474 ]
  [Layer 5] Residual connection shape: (1, 1, 1024)
  [Layer 5] Residual connection sample values: [-0.08934642  0.2313782  -0.7457888   0.03218418  1.3067477 ]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.04065276  0.08697137 -0.26450503  0.01403898  0.53119344]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.04065276  0.08697137 -0.26450503  0.01403898  0.53119344]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.04065276  0.08697137 -0.26450503  0.01403898  0.53119344]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.5206038  -1.2159266  -0.00805084 -4.877489   -2.1923532 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.5206038  -1.2159266  -0.00805084 -4.877489   -2.1923532 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.3887714  -0.5115603  -0.9520176   1.0168494   0.14827617]
  [FlaxMamba2] dt (step) sample values: [1.1141615  0.14985475 0.89009976 1.3828621  1.6736767 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.2019434  -2.3851976   0.18457492  0.3887714  -1.0448939 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01514557  0.00493652 -0.29411787 -0.00707432  0.00111786]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.03209564  0.01892883 -0.21288007 -0.01875492  0.13930145]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.01579031  0.00955399 -0.09515315 -0.00928953  0.07449412]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01579031  0.00955399 -0.09515315 -0.00928953  0.07449412]
  [FlaxMamba2] B (step) sample values: [ 0.07635315 -0.07402217 -0.25790438  0.04254229 -0.01419221]
  [FlaxMamba2] C (step) sample values: [-0.00639623  0.11695851 -0.2759397  -0.1677733  -0.06099367]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.5109995  -0.28622514 -0.5421001  -0.39544863 -0.5985869 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.40018213 0.13378347 0.18651967 0.46567467 0.42660913]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.81506056 0.96243167 0.9038315  0.8318107  0.77463555]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01579031  0.00955399 -0.09515315 -0.00928953  0.07449412]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.8247556e-04  4.6774611e-04  1.6296979e-03 -2.6882472e-04
  8.9680601e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.8247556e-04  4.6774611e-04  1.6296979e-03 -2.6882472e-04
  8.9680601e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00557644 -0.00491936 -0.01348796  0.00959999  0.01283972]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02037152  0.01041307 -0.02955814 -0.00624942  0.09378084]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03848379  0.02137197 -0.13870355 -0.01690498  0.17922932]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03848379  0.02137197 -0.13870355 -0.01690498  0.17922932]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00746719 -0.00594198  0.00055609  0.00062323 -0.039466  ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00344501 -0.00262336  0.00023344  0.00032175 -0.01482822]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00344501 -0.00262336  0.00023344  0.00032175 -0.01482822]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.10626871  0.22689334 -0.06451661  0.08323916 -0.20350283]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.10626871  0.22689334 -0.06451661  0.08323916 -0.20350283]
  [Layer 6] Output shape after mixer: (1, 1, 1024)
  [Layer 6] Output sample values after mixer: [-0.10626871  0.22689334 -0.06451661  0.08323916 -0.20350283]
  [Layer 6] Residual connection shape: (1, 1, 1024)
  [Layer 6] Residual connection sample values: [-0.19561514  0.45827153 -0.8103054   0.11542334  1.1032448 ]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.08331759  0.15853442 -0.27221537  0.04962342  0.4074994 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08331759  0.15853442 -0.27221537  0.04962342  0.4074994 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08331759  0.15853442 -0.27221537  0.04962342  0.4074994 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.45953912 -0.53410125 -0.11296564 -0.28485712 -0.50272095]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.45953912 -0.53410125 -0.11296564 -0.28485712 -0.50272095]
  [FlaxMamba2] xBC (step) sample values: [-3.0653458  -2.156381    1.2447586   0.17644975  0.11119372]
  [FlaxMamba2] dt (step) sample values: [0.27359337 0.06233744 1.1140643  0.53565425 0.8247655 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.2186885  -1.9644709  -2.875366   -3.0653458  -0.14051603]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.7298371  -0.4242757   0.19011168 -0.12453532  0.0756615 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.7634675  -0.49556476  0.05913024 -0.11606669  0.07291682]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.24270168 -0.18761265  0.03043896 -0.05466925  0.03778704]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.24270168 -0.18761265  0.03043896 -0.05466925  0.03778704]
  [FlaxMamba2] B (step) sample values: [-0.10128835 -0.05579299 -0.06010466  0.13007571  0.03924324]
  [FlaxMamba2] C (step) sample values: [-0.07367055  0.19598234  0.05416628  0.0841898   0.01640283]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-6.5957151e-02 -4.5478220e+00 -5.8281250e+00 -4.2033669e-01
 -1.9005252e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.61432415 0.03522664 0.10681129 0.2274925  0.39654288]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.96029085 0.85196954 0.5365961  0.90880615 0.99924666]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.24270168 -0.18761265  0.03043896 -0.05466925  0.03778704]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01510184  0.0083186   0.00896145 -0.01939396 -0.00585107]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01510184  0.0083186   0.00896145 -0.01939396 -0.00585107]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.09821769  0.03942108 -0.01851311  0.01664962  0.09899015]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.18416892 -0.09093172 -0.18430533  0.10226812  0.01174438]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.74688584 -0.52592176 -0.11373096 -0.02448548  0.09935567]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.74688584 -0.52592176 -0.11373096 -0.02448548  0.09935567]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.21036321  0.10380796  0.00606139  0.00299405 -0.01882554]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.07939699  0.04728515  0.00165548  0.00099052 -0.0136296 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.07939699  0.04728515  0.00165548  0.00099052 -0.0136296 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.06069347  0.00763163  0.27973032  0.11642134 -0.47515404]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.06069347  0.00763163  0.27973032  0.11642134 -0.47515404]
  [Layer 7] Output shape after mixer: (1, 1, 1024)
  [Layer 7] Output sample values after mixer: [-0.06069347  0.00763163  0.27973032  0.11642134 -0.47515404]
  [Layer 7] Residual connection shape: (1, 1, 1024)
  [Layer 7] Residual connection sample values: [-0.25630862  0.46590316 -0.5305751   0.2318447   0.62809074]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.13096166  0.17820646 -0.18964458  0.1153746   0.2689406 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.13096166  0.17820646 -0.18964458  0.1153746   0.2689406 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.13096166  0.17820646 -0.18964458  0.1153746   0.2689406 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.02741758 -2.2335963  -1.6583958  -1.3404629  -2.3679795 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.02741758 -2.2335963  -1.6583958  -1.3404629  -2.3679795 ]
  [FlaxMamba2] xBC (step) sample values: [-3.2332613  0.5373835 -3.5371516 -3.7460217  2.0593393]
  [FlaxMamba2] dt (step) sample values: [2.9630826 3.801447  3.1208854 1.5491523 2.7613795]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.1382127  -1.6701803   0.11993328 -3.2332613   1.4290712 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.6501005  -0.2469431  -0.27077213 -0.38592732  0.79636365]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.7274931  -0.16588841 -0.20442691 -0.48285115  0.7338026 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.23697732 -0.0760802  -0.09180209 -0.18424591  0.49578583]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.23697732 -0.0760802  -0.09180209 -0.18424591  0.49578583]
  [FlaxMamba2] B (step) sample values: [ 0.02332784 -0.01217147  0.03862815 -0.16248058 -0.16531572]
  [FlaxMamba2] C (step) sample values: [ 0.00572404 -0.06540465 -0.04123201  0.57493436 -0.26289493]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6851114  -0.13800453 -0.41180432 -0.26783535 -0.12443344]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.3133133 5.124795  2.2734783 1.1901364 3.8808613]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.80682015 0.4930006  0.392104   0.7270496  0.61698604]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.23697732 -0.0760802  -0.09180209 -0.18424591  0.49578583]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00173205  0.00090371 -0.00286807  0.01206388  0.01227439]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00173205  0.00090371 -0.00286807  0.01206388  0.01227439]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01191277  0.01764752  0.00319838  0.02500124  0.01091078]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0968151  -0.0508929   0.00873812 -0.06550449  0.08386695]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.9893697 -0.3374424 -0.3370265 -0.7594508  1.9512014]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.9893697 -0.3374424 -0.3370265 -0.7594508  1.9512014]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01337714  0.07293942  0.08941514  0.211171   -0.39572492]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00270655  0.00778941  0.02940941  0.05915284 -0.07601511]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00270655  0.00778941  0.02940941  0.05915284 -0.07601511]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.24965471  0.14792658  0.5804517   0.4019646  -0.78490764]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.24965471  0.14792658  0.5804517   0.4019646  -0.78490764]
  [Layer 8] Output shape after mixer: (1, 1, 1024)
  [Layer 8] Output sample values after mixer: [-0.24965471  0.14792658  0.5804517   0.4019646  -0.78490764]
  [Layer 8] Residual connection shape: (1, 1, 1024)
  [Layer 8] Residual connection sample values: [-0.5059633   0.61382973  0.04987663  0.6338093  -0.1568169 ]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.21384516  0.20049743  0.01559766  0.26859015 -0.05772992]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.21384516  0.20049743  0.01559766  0.26859015 -0.05772992]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.21384516  0.20049743  0.01559766  0.26859015 -0.05772992]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.1604924  -1.1744524  -3.2589977  -1.8538888   0.64806736]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-2.1604924  -1.1744524  -3.2589977  -1.8538888   0.64806736]
  [FlaxMamba2] xBC (step) sample values: [ 2.8222654  -3.0781999   2.8080769   0.4619281   0.23075746]
  [FlaxMamba2] dt (step) sample values: [1.9096599 3.918604  2.7403097 3.2557108 1.543085 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 2.5571475 -0.6422956  0.8244302  2.8222654  4.6809063]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.66876334 -0.9296125  -0.58472383  0.2875768   0.3789744 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.9221813 -0.8390974 -0.5888895  0.2943021  0.3603129]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.26237315 -0.25317657 -0.21016859  0.16864952  0.21226618]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.26237315 -0.25317657 -0.21016859  0.16864952  0.21226618]
  [FlaxMamba2] B (step) sample values: [-0.05719389 -0.00196704  0.04346211 -0.17783074 -0.15607929]
  [FlaxMamba2] C (step) sample values: [-0.05971771 -0.27717495 -0.07091771 -0.11991424 -0.07979677]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17008033 -0.11351943 -0.10539922 -0.5864362  -0.14965628]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [2.4197981 4.733106  4.539136  1.9259266 1.8984795]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.6626157  0.58432406 0.619761   0.32321647 0.7526768 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.26237315 -0.25317657 -0.21016859  0.16864952  0.21226618]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.03631183  0.00124885 -0.02759366  0.11290298  0.09909319]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.03631183  0.00124885 -0.02759366  0.11290298  0.09909319]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.09108526 -0.18963811 -0.09289271  0.4477897   0.39024237]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.349753   -0.0686174  -0.17262296  0.05010911  0.25354847]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-1.0527736  -0.7469961  -0.73576313  0.5020002   0.822309  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-1.0527736  -0.7469961  -0.73576313  0.5020002   0.822309  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.23508148  0.20709035  0.08873224 -0.12602615  0.34989637]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02535985  0.04163982  0.0119302  -0.01943716  0.05417721]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02535985  0.04163982  0.0119302  -0.01943716  0.05417721]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.4766899  -0.02366688 -0.6389712   0.10661013 -0.46667677]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.4766899  -0.02366688 -0.6389712   0.10661013 -0.46667677]
  [Layer 9] Output shape after mixer: (1, 1, 1024)
  [Layer 9] Output sample values after mixer: [-0.4766899  -0.02366688 -0.6389712   0.10661013 -0.46667677]
  [Layer 9] Residual connection shape: (1, 1, 1024)
  [Layer 9] Residual connection sample values: [-0.98265326  0.5901629  -0.5890946   0.74041945 -0.6234937 ]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.42347324  0.19430257 -0.18930306  0.3138727  -0.22747906]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.42347324  0.19430257 -0.18930306  0.3138727  -0.22747906]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.42347324  0.19430257 -0.18930306  0.3138727  -0.22747906]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.967835   -1.6663773  -1.8268769  -2.528242   -0.68114024]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.967835   -1.6663773  -1.8268769  -2.528242   -0.68114024]
  [FlaxMamba2] xBC (step) sample values: [-0.8984489 -0.8320072 -0.6838253  3.9183035  0.9302864]
  [FlaxMamba2] dt (step) sample values: [2.346162  1.8888528 1.9794252 3.1511698 1.2852114]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.7998545  -1.7703952  -3.1214604  -0.8984489  -0.33312058]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.88328743  0.56650066  0.00536101  0.98737943 -0.19433464]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-1.0535755   0.5425596  -0.03260286  1.5913833  -0.14544548]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.27239046  0.34311888 -0.01603572  1.3221383  -0.06744345]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.27239046  0.34311888 -0.01603572  1.3221383  -0.06744345]
  [FlaxMamba2] B (step) sample values: [-0.15083209  0.6320945   0.13271211 -0.18151145  0.30676666]
  [FlaxMamba2] C (step) sample values: [-0.09847044 -0.19442353 -0.24978222 -0.22732952 -0.01171163]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.08535489 -0.07711172 -0.08452541 -0.0546804  -0.06966463]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [3.4572861  0.49438506 0.52269834 4.2649317  1.3209877 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.74445987 0.9625946  0.9567805  0.79198873 0.9120813 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.27239046  0.34311888 -0.01603572  1.3221383  -0.06744345]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.14204337 -0.5952635  -0.12497921  0.1709351  -0.2888919 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.14204337 -0.5952635  -0.12497921  0.1709351  -0.2888919 ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.1599729  -1.2368333  -0.08759294  0.5168021  -0.20927303]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-2.4649086  0.958711  -1.1598645 15.826342   1.2822428]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-3.7912169  2.629406  -1.2379447 22.264023   0.953851 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-3.7912169  2.629406  -1.2379447 22.264023   0.953851 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 1.0101956  -0.69626755  0.31347826 -4.1598506  -0.21830577]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03242671 -0.04777738  0.02358921 -0.2407582  -0.01531662]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03242671 -0.04777738  0.02358921 -0.2407582  -0.01531662]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.2309715  -0.42666468 -0.08950812  0.0988328  -0.26944846]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.2309715  -0.42666468 -0.08950812  0.0988328  -0.26944846]
  [Layer 10] Output shape after mixer: (1, 1, 1024)
  [Layer 10] Output sample values after mixer: [ 0.2309715  -0.42666468 -0.08950812  0.0988328  -0.26944846]
  [Layer 10] Residual connection shape: (1, 1, 1024)
  [Layer 10] Residual connection sample values: [-0.75168175  0.1634982  -0.6786027   0.83925223 -0.89294213]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.22336297  0.03941878 -0.15870023  0.27231652 -0.23483993]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.22336297  0.03941878 -0.15870023  0.27231652 -0.23483993]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.22336297  0.03941878 -0.15870023  0.27231652 -0.23483993]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.01084204 -2.1150427  -2.2389684   1.7729955  -4.666368  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.01084204 -2.1150427  -2.2389684   1.7729955  -4.666368  ]
  [FlaxMamba2] xBC (step) sample values: [-0.13014178 -0.9643714   0.18094051  0.76412845 -0.4326438 ]
  [FlaxMamba2] dt (step) sample values: [-2.9817703  -1.3564023   0.23265676  2.8564973   2.018538  ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.37036133  2.1558917   0.68330896 -0.13014178 -0.83895814]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.09949054  0.15330394 -0.10260536 -0.12048821  0.13067876]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.24597491  0.34446603 -0.07867958 -0.01306634  0.24566899]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.13803756  0.20160736 -0.03779297 -0.00649049  0.13784738]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.13803756  0.20160736 -0.03779297 -0.00649049  0.13784738]
  [FlaxMamba2] B (step) sample values: [-0.26754257  0.02756569 -0.13603932  0.15686499 -0.02120863]
  [FlaxMamba2] C (step) sample values: [-0.16950911 -0.25220525 -0.01362804 -0.01735963 -0.2406891 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.25934154 -0.12614636 -0.10356269 -0.23775288 -0.43051487]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01157114 0.01863116 0.18764913 2.6944156  2.19143   ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9970036  0.99765253 0.98075414 0.5269735  0.38928512]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.13803756  0.20160736 -0.03779297 -0.00649049  0.13784738]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.2733288e-04  4.4029348e-05 -2.1728905e-04  2.5055290e-04
 -3.3875516e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.2733288e-04  4.4029348e-05 -2.1728905e-04  2.5055290e-04
 -3.3875516e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.18578897  0.01061515  0.01817906 -0.08654566  0.11612922]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [0.28319266 0.30641803 0.28516358 0.14625773 0.4096911 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.15219769 -0.32948062  0.40436804  0.16672966 -0.0250994 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.15219769 -0.32948062  0.40436804  0.16672966 -0.0250994 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00082954  0.07501292 -0.08719166  0.25269702  0.00109144]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-5.4613240e-05  3.6566380e-02 -7.6249965e-02  4.1539077e-02
  2.0941571e-04]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-5.4613240e-05  3.6566380e-02 -7.6249965e-02  4.1539077e-02
  2.0941571e-04]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.34023252 -0.05663038 -0.28918773 -0.75463283 -0.18843156]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.34023252 -0.05663038 -0.28918773 -0.75463283 -0.18843156]
  [Layer 11] Output shape after mixer: (1, 1, 1024)
  [Layer 11] Output sample values after mixer: [-0.34023252 -0.05663038 -0.28918773 -0.75463283 -0.18843156]
  [Layer 11] Residual connection shape: (1, 1, 1024)
  [Layer 11] Residual connection sample values: [-1.0919143   0.10686781 -0.9677904   0.0846194  -1.0813737 ]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.2698997   0.02104397 -0.1742671   0.02371995 -0.22617206]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.2698997   0.02104397 -0.1742671   0.02371995 -0.22617206]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.2698997   0.02104397 -0.1742671   0.02371995 -0.22617206]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.04451001 -1.1141688   1.0958263  -0.4318288  -0.86725444]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.04451001 -1.1141688   1.0958263  -0.4318288  -0.86725444]
  [FlaxMamba2] xBC (step) sample values: [-0.627188   0.5299009  1.2895293  0.4931803 -1.6306199]
  [FlaxMamba2] dt (step) sample values: [1.6638335 1.6102908 1.2802016 2.0572298 0.3739762]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.5676143   0.6178971  -2.6213522  -0.627188    0.07664585]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.65578055 -0.6695913  -0.23767994  0.07179774  1.3603673 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.72298026 -1.504064   -0.30243826  0.02757777  1.1937413 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.23622443 -0.27346918 -0.12852463  0.01397901  0.91608846]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.23622443 -0.27346918 -0.12852463  0.01397901  0.91608846]
  [FlaxMamba2] B (step) sample values: [ 0.0331815   0.24367717 -0.14283961  0.50459045  0.03758603]
  [FlaxMamba2] C (step) sample values: [ 0.03949244 -0.26260304 -0.27370548 -0.27695754  0.08836883]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.16087165 -0.14748003 -0.27125728 -0.11553253 -0.09015273]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [2.2931924 1.585582  2.1505563 3.427162  0.0999231]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.6914879 0.7914871 0.5580236 0.6730412 0.9910321]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.23622443 -0.27346918 -0.12852463  0.01397901  0.91608846]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01797468 -0.13200189  0.07737736 -0.2733407  -0.02036066]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01797468 -0.13200189  0.07737736 -0.2733407  -0.02036066]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.03121506  0.03718887  0.12544917 -0.22821495 -0.02697944]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.50192493 -1.0303938  -0.5413046  -0.03624982  4.723936  ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.88528436 -1.4741963  -0.7498822  -0.01356383  6.2106204 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.88528436 -1.4741963  -0.7498822  -0.01356383  6.2106204 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02014041  0.40585363 -0.6158759   0.00230594 -1.5933741 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00415281  0.04889656 -0.1452941   0.00102682 -0.2826651 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00415281  0.04889656 -0.1452941   0.00102682 -0.2826651 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.22916438 -0.12414704  0.09183978 -0.13142435  0.5143915 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.22916438 -0.12414704  0.09183978 -0.13142435  0.5143915 ]
  [Layer 12] Output shape after mixer: (1, 1, 1024)
  [Layer 12] Output sample values after mixer: [-0.22916438 -0.12414704  0.09183978 -0.13142435  0.5143915 ]
  [Layer 12] Residual connection shape: (1, 1, 1024)
  [Layer 12] Residual connection sample values: [-1.3210787  -0.01727922 -0.87595063 -0.04680495 -0.5669822 ]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.26303947 -0.00280955 -0.13557361 -0.01002647 -0.10126592]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.26303947 -0.00280955 -0.13557361 -0.01002647 -0.10126592]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.26303947 -0.00280955 -0.13557361 -0.01002647 -0.10126592]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.67749566 -0.40353775 -0.66474724 -2.7623258  -2.065083  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.67749566 -0.40353775 -0.66474724 -2.7623258  -2.065083  ]
  [FlaxMamba2] xBC (step) sample values: [ 0.25376448 -0.03297378  1.9359795   0.48142588  0.2581247 ]
  [FlaxMamba2] dt (step) sample values: [0.77731085 0.8168439  1.3896946  1.834753   0.28780556]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.11038116  0.27914023 -0.41646534  0.25376448 -0.270418  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.16504769 -0.41022032 -0.1293566   0.04740739 -0.05917976]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.10297494 -0.42888182 -0.12147543  0.03569627 -0.08962104]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.05413609 -0.16914815 -0.05705317  0.01816666 -0.04280388]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05413609 -0.16914815 -0.05705317  0.01816666 -0.04280388]
  [FlaxMamba2] B (step) sample values: [ 0.10241445 -0.22227545  0.2007845  -0.11618719  0.04901844]
  [FlaxMamba2] C (step) sample values: [ 0.04429673 -0.17825004  0.31540492  0.09087948 -0.22460543]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.02338035 -1.090337   -0.5085105  -0.67845345 -0.02513249]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11095806 0.02254803 0.03374431 0.03246422 0.19853052]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9974091  0.9757148  0.98298705 0.97821534 0.99502283]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05413609 -0.16914815 -0.05705317  0.01816666 -0.04280388]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00061519 -0.00133517  0.00120608 -0.00069792  0.00029445]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00061519 -0.00133517  0.00120608 -0.00069792  0.00029445]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.09242558  0.09989385 -0.2818755   0.02309935 -0.05970222]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.24977607 -0.15484636 -0.05724957  0.00366905  0.40761933]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.25602895 -0.13530919 -0.05065974  0.00157074  0.41256332]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.25602895 -0.13530919 -0.05065974  0.00157074  0.41256332]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.05842437  0.02186621  0.01143884 -0.00025771 -0.09587915]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02622863  0.00649492  0.01151061 -0.00061237 -0.0494558 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02622863  0.00649492  0.01151061 -0.00061237 -0.0494558 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.06380721  0.91041434 -1.441971    0.44274572  0.3134356 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.06380721  0.91041434 -1.441971    0.44274572  0.3134356 ]
  [Layer 13] Output shape after mixer: (1, 1, 1024)
  [Layer 13] Output sample values after mixer: [-0.06380721  0.91041434 -1.441971    0.44274572  0.3134356 ]
  [Layer 13] Residual connection shape: (1, 1, 1024)
  [Layer 13] Residual connection sample values: [-1.3848859   0.89313513 -2.3179216   0.39594078 -0.2535466 ]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.20579179  0.11457705 -0.29080877  0.06657616 -0.0352952 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.20579179  0.11457705 -0.29080877  0.06657616 -0.0352952 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.20579179  0.11457705 -0.29080877  0.06657616 -0.0352952 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.2015438   0.6559652  -0.40862533 -0.10082061  0.44900125]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.2015438   0.6559652  -0.40862533 -0.10082061  0.44900125]
  [FlaxMamba2] xBC (step) sample values: [-0.38637185  0.43252176 -0.310873    0.62676305  0.2827178 ]
  [FlaxMamba2] dt (step) sample values: [0.7530634  0.25875673 1.9547653  0.92222    0.96266395]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.034317   -0.9048691   1.7296733  -0.38637185  0.40988016]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.08289206 -0.10918209 -0.4660636  -0.11981565 -0.07822233]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.15332663 -0.15859005 -0.6578361  -0.16742307 -0.09200102]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.0825291  -0.07302047 -0.22447069 -0.07672024 -0.04388595]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0825291  -0.07302047 -0.22447069 -0.07672024 -0.04388595]
  [FlaxMamba2] B (step) sample values: [-0.03035056  0.00030284  0.22299133 -0.04179337 -0.11515289]
  [FlaxMamba2] C (step) sample values: [-0.18676594 -0.03918537  0.24397439 -0.21028748 -0.18997389]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-7.2744994  -0.03854768 -2.202407   -0.01377147 -5.3377523 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0431282  0.0766227  0.08020995 0.12104771 0.04209475]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7307119  0.9970507  0.8380689  0.9983344  0.79876274]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0825291  -0.07302047 -0.22447069 -0.07672024 -0.04388595]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0802770e-04  1.0779029e-06  7.9370005e-04 -1.4875644e-04
 -4.0986729e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0802770e-04  1.0779029e-06  7.9370005e-04 -1.4875644e-04
 -4.0986729e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00050995 -0.00081162  0.00119714 -0.0001275   0.00012174]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00099712 -0.00769459 -0.01689739 -0.0008819  -0.00097365]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.06594741 -0.06516159 -0.1935555  -0.06126061 -0.03551183]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.06594741 -0.06516159 -0.1935555  -0.06126061 -0.03551183]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.06091866 -0.02814049  0.0315767   0.00293262 -0.00973277]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.30051017 -0.09672286  0.07446362  0.01001392 -0.04224374]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.30051017 -0.09672286  0.07446362  0.01001392 -0.04224374]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.28332388 -0.3510922  -0.64793694 -0.16840062 -0.29280713]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.28332388 -0.3510922  -0.64793694 -0.16840062 -0.29280713]
  [Layer 14] Output shape after mixer: (1, 1, 1024)
  [Layer 14] Output sample values after mixer: [-0.28332388 -0.3510922  -0.64793694 -0.16840062 -0.29280713]
  [Layer 14] Residual connection shape: (1, 1, 1024)
  [Layer 14] Residual connection sample values: [-1.6682098   0.542043   -2.9658585   0.22754017 -0.5463537 ]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.28954953  0.07739479 -0.42512825  0.04681583 -0.08851314]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.28954953  0.07739479 -0.42512825  0.04681583 -0.08851314]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.28954953  0.07739479 -0.42512825  0.04681583 -0.08851314]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.65309995  1.3139288   1.0847127  -0.14819305 -3.7885725 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.65309995  1.3139288   1.0847127  -0.14819305 -3.7885725 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.19749758  0.04048364 -0.43109608  0.09159654 -0.6582945 ]
  [FlaxMamba2] dt (step) sample values: [2.0209665  1.6034783  0.03004227 1.2816195  1.08747   ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.7405844  -0.4330966  -1.1422975   0.19749758 -1.4869261 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.0202046   0.051425   -0.04492316  0.01974438  0.04332591]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.35638624  0.02723981  1.2802721   0.46237132  0.02983714]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.1467722   0.0138054   1.0018079   0.28370023  0.01514112]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.1467722   0.0138054   1.0018079   0.28370023  0.01514112]
  [FlaxMamba2] B (step) sample values: [ 0.03499173 -0.09003758 -0.05833478 -0.01815029 -0.13154781]
  [FlaxMamba2] C (step) sample values: [-0.04626693 -0.11685383  0.1815217  -0.06334836 -0.05342207]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.4414158  -0.05923919 -0.7389757  -0.00508607 -0.00871955]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.39428154 1.3488014  0.02255489 0.16437578 0.36741292]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.38189667 0.9232069  0.9834706  0.99916434 0.99680144]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.1467722   0.0138054   1.0018079   0.28370023  0.01514112]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00202496  0.00521044  0.00337581  0.00105035  0.00761262]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00202496  0.00521044  0.00337581  0.00105035  0.00761262]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00133516  0.00759557  0.00487063  0.00142363  0.00900032]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00596627  0.00107688  0.02948826  0.00875667  0.00113157]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.2680723   0.02573058  1.8185183   0.515389    0.0281706 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.2680723   0.02573058  1.8185183   0.515389    0.0281706 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.05992768  0.02664656  1.4742688  -0.03536407 -0.00236155]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07445385  0.02416325  0.3929247  -0.02476507 -0.00299365]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.07445385  0.02416325  0.3929247  -0.02476507 -0.00299365]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.47410664  0.84658146 -0.27585036  1.1607366  -0.05197906]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.47410664  0.84658146 -0.27585036  1.1607366  -0.05197906]
  [Layer 15] Output shape after mixer: (1, 1, 1024)
  [Layer 15] Output sample values after mixer: [-0.47410664  0.84658146 -0.27585036  1.1607366  -0.05197906]
  [Layer 15] Residual connection shape: (1, 1, 1024)
  [Layer 15] Residual connection sample values: [-2.1423163   1.3886244  -3.2417088   1.3882767  -0.59833276]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.24327469  0.13031204 -0.28350475  0.20002323 -0.06423336]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.24327469  0.13031204 -0.28350475  0.20002323 -0.06423336]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.24327469  0.13031204 -0.28350475  0.20002323 -0.06423336]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.47151822 -0.3325575  -3.079015   -0.46751034  0.00524858]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.47151822 -0.3325575  -3.079015   -0.46751034  0.00524858]
  [FlaxMamba2] xBC (step) sample values: [-0.13573612  0.22628108  0.52868086  0.18103886 -0.6117581 ]
  [FlaxMamba2] dt (step) sample values: [2.3478394  1.685339   0.83894044 4.1314774  0.69559884]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.3611327   0.24830371  1.2533983  -0.13573612 -0.0904566 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12414658 -0.02722803 -0.0999494   0.21797767  0.11889546]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.12232316 -0.01842371  0.03676935  0.17980018  0.12642567]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.06489766 -0.009127    0.01872264  0.09796042  0.06720339]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06489766 -0.009127    0.01872264  0.09796042  0.06720339]
  [FlaxMamba2] B (step) sample values: [ 0.17719181 -0.02627113  0.11106479 -0.01254866 -0.03823025]
  [FlaxMamba2] C (step) sample values: [-0.00714733 -0.0404751  -0.10553584 -0.23977523 -0.19940804]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.1348554e-03 -3.0370306e-03 -2.7156286e+00 -4.1511287e-03
 -4.2925543e-01]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.6272078  0.31425765 0.05380139 0.99526334 0.00225503]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99928844 0.999046   0.8640673  0.995877   0.9990325 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06489766 -0.009127    0.01872264  0.09796042  0.06720339]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00721247 -0.00106935  0.00452082 -0.00051078 -0.00155614]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00721247 -0.00106935  0.00452082 -0.00051078 -0.00155614]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00439648 0.10974588 0.03847997 0.00193422 0.00390651]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01466837  0.00913842 -0.02920744  0.05774967  0.03075422]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02977238  0.0112626  -0.03356487  0.03495076  0.01511358]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02977238  0.0112626  -0.03356487  0.03495076  0.01511358]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-8.6439373e-03 -1.5641744e-03  4.5453147e-03 -6.2941993e-03
  3.9766532e-05]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-1.2544124e-02 -1.2923225e-03  1.5116866e-02 -3.6440061e-03
  6.8313013e-05]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-1.2544124e-02 -1.2923225e-03  1.5116866e-02 -3.6440061e-03
  6.8313013e-05]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.7957856   0.1269057   0.6846386   0.25376463 -0.08910563]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.7957856   0.1269057   0.6846386   0.25376463 -0.08910563]
  [Layer 16] Output shape after mixer: (1, 1, 1024)
  [Layer 16] Output sample values after mixer: [-0.7957856   0.1269057   0.6846386   0.25376463 -0.08910563]
  [Layer 16] Residual connection shape: (1, 1, 1024)
  [Layer 16] Residual connection sample values: [-2.938102    1.5155301  -2.5570703   1.6420413  -0.68743837]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.48475963  0.21515375 -0.362712    0.31049225 -0.10448178]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.48475963  0.21515375 -0.362712    0.31049225 -0.10448178]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.48475963  0.21515375 -0.362712    0.31049225 -0.10448178]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.8484719 -3.3835967 -1.3463553 -2.3437586 -2.0509307]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.8484719 -3.3835967 -1.3463553 -2.3437586 -2.0509307]
  [FlaxMamba2] xBC (step) sample values: [-1.7254306  -1.4416928  -1.2442912   0.30823264 -0.18665732]
  [FlaxMamba2] dt (step) sample values: [1.7874254 1.9768738 1.4480225 1.7232906 1.402929 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.0798792  -0.44997388  0.2817422  -1.7254306  -1.0134099 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.34482393 -0.03146389 -0.30691555  0.07800034 -0.05839565]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.43985566 -0.00933864 -0.42135647  0.11242417  0.03681919]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.17232461 -0.00464752 -0.16693816  0.05936856  0.01874847]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.17232461 -0.00464752 -0.16693816  0.05936856  0.01874847]
  [FlaxMamba2] B (step) sample values: [-0.10281733  0.0090281  -0.24444637  0.01818838 -0.14913416]
  [FlaxMamba2] C (step) sample values: [-0.12388974 -0.00496341 -0.27356732 -0.11774199  0.02745825]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.3863302  -0.87734115 -1.4026718  -0.6827737  -0.39046   ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.63825893 0.48535854 0.46448493 0.9545297  0.9274075 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.41278118 0.6532306  0.52125293 0.52114457 0.6962019 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.17232461 -0.00464752 -0.16693816  0.05936856  0.01874847]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01130864 -0.00099298  0.0268861  -0.0020005   0.01640293]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01130864 -0.00099298  0.0268861  -0.0020005   0.01640293]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01705195 -0.00541545  0.04054238  0.00229555  0.02520194]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.12068286 -0.00085877 -0.09876824  0.04111947  0.02456976]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.5745615  -0.01309968 -0.5384597   0.19748786  0.07395057]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.5745615  -0.01309968 -0.5384597   0.19748786  0.07395057]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.14449593  0.00145436  0.14967981 -0.04052982 -0.01728378]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.11021063  0.00113203  0.1225598  -0.04085663 -0.01606464]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.11021063  0.00113203  0.1225598  -0.04085663 -0.01606464]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.94096154  1.0643157  -0.11464139  0.9128433  -1.1622039 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.94096154  1.0643157  -0.11464139  0.9128433  -1.1622039 ]
  [Layer 17] Output shape after mixer: (1, 1, 1024)
  [Layer 17] Output sample values after mixer: [-0.94096154  1.0643157  -0.11464139  0.9128433  -1.1622039 ]
  [Layer 17] Residual connection shape: (1, 1, 1024)
  [Layer 17] Residual connection sample values: [-3.8790636  2.579846  -2.6717117  2.5548847 -1.8496423]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.41876173  0.24080452 -0.24570985  0.3351839  -0.17671151]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.41876173  0.24080452 -0.24570985  0.3351839  -0.17671151]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.41876173  0.24080452 -0.24570985  0.3351839  -0.17671151]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.4125706  -0.7325344  -0.08957408 -0.557751    0.00678318]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.4125706  -0.7325344  -0.08957408 -0.557751    0.00678318]
  [FlaxMamba2] xBC (step) sample values: [-0.15398827 -1.262538   -0.3226665  -0.5528413  -0.5991325 ]
  [FlaxMamba2] dt (step) sample values: [1.6984248  4.24832    2.7286375  2.5518315  0.88604903]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.37941277  0.02733767  0.25384715 -0.15398827 -0.07201511]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01630864  0.931886    0.07312267 -0.2154268  -0.10088885]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.02566228  0.5339368   0.0843684  -0.1848787  -0.15313494]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.01299577  0.3365942   0.04396265 -0.08391857 -0.07071632]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01299577  0.3365942   0.04396265 -0.08391857 -0.07071632]
  [FlaxMamba2] B (step) sample values: [ 0.1585037   0.00079748 -0.13616574 -0.06949489 -0.01139887]
  [FlaxMamba2] C (step) sample values: [ 0.07074915 -0.05190511  0.09390805 -0.02328621  0.01189493]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.3194940e-03 -6.5335674e+00 -1.4897179e+01 -1.3796333e-03
 -2.0873186e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.57048035 5.36434    4.190186   0.91154    0.30477682]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.9867767e-01 6.0079676e-16 7.7712520e-28 9.9874318e-01 9.9936402e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01299577  0.3365942   0.04396265 -0.08391857 -0.07071632]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.1751193e-03  5.9123536e-06 -1.0095095e-03 -5.1522325e-04
 -8.4509287e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.1751193e-03  5.9123536e-06 -1.0095095e-03 -5.1522325e-04
 -8.4509287e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00314057 -0.00864829  0.09232431 -0.03862892  0.01222   ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.15183462 -0.86910295  0.09057217 -0.1456864  -0.16781689]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.15286349 -0.89575076  0.08709169 -0.13904266 -0.16221835]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.15286349 -0.89575076  0.08709169 -0.13904266 -0.16221835]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02511932  0.21301769 -0.003726    0.0282339  -0.00055204]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05341147  0.11090438 -0.00174699  0.03082508 -0.00028323]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.05341147  0.11090438 -0.00174699  0.03082508 -0.00028323]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.44060677  0.17438287  0.2846796   0.1915724  -1.1522211 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.44060677  0.17438287  0.2846796   0.1915724  -1.1522211 ]
  [Layer 18] Output shape after mixer: (1, 1, 1024)
  [Layer 18] Output sample values after mixer: [-0.44060677  0.17438287  0.2846796   0.1915724  -1.1522211 ]
  [Layer 18] Residual connection shape: (1, 1, 1024)
  [Layer 18] Residual connection sample values: [-4.31967    2.7542288 -2.387032   2.746457  -3.0018635]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.539987    0.2859269  -0.25049508  0.42458716 -0.33314806]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.539987    0.2859269  -0.25049508  0.42458716 -0.33314806]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.539987    0.2859269  -0.25049508  0.42458716 -0.33314806]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 3.0061264  -0.7707955  -0.74884313  0.26384857  0.23692137]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 3.0061264  -0.7707955  -0.74884313  0.26384857  0.23692137]
  [FlaxMamba2] xBC (step) sample values: [-1.2168745  -0.12161038  0.42809004  1.524161   -0.8841214 ]
  [FlaxMamba2] dt (step) sample values: [1.1586417  0.67761225 1.8029898  1.9393513  1.0994903 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.51194596 -1.361026   -1.4363782  -1.2168745  -0.31555632]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.2538349   0.09788916  0.12053678 -1.0073521  -0.218751  ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.30525702  0.09839031  0.10674284 -1.2149937  -0.21994309]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.12951228  0.05161337  0.05621722 -0.27801326 -0.09792633]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.12951228  0.05161337  0.05621722 -0.27801326 -0.09792633]
  [FlaxMamba2] B (step) sample values: [ 0.05131344  0.05606082  0.09540892 -0.07152575  0.15642042]
  [FlaxMamba2] C (step) sample values: [-0.20743169 -0.0434209  -0.20988041 -0.12892468  0.01587302]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17394373 -1.5063176  -1.5724528  -0.19826236 -0.07681109]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [2.2294946 0.4969383 1.1826265 3.1351843 0.8430033]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.67854357 0.47305346 0.15573114 0.5370903  0.9372999 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.12951228  0.05161337  0.05621722 -0.27801326 -0.09792633]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0148166  -0.01618739 -0.02754903  0.02065284 -0.04516592]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0148166  -0.01618739 -0.02754903  0.02065284 -0.04516592]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00976963  0.00728404 -0.08068483  0.06384778 -0.08835737]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.582404   -0.28194526 -0.01065102 -0.9995933   0.04247038]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.7796098  -0.2033546   0.07494984 -1.4229186  -0.1066401 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.7796098  -0.2033546   0.07494984 -1.4229186  -0.1066401 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-2.233105    0.04957949 -0.01802046 -0.21233936 -0.01412217]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.7062998   0.02711093 -0.01173311 -0.05693141 -0.01400919]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.7062998   0.02711093 -0.01173311 -0.05693141 -0.01400919]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.5155612 -0.9716931  1.252586   1.193167  -0.7303333]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.5155612 -0.9716931  1.252586   1.193167  -0.7303333]
  [Layer 19] Output shape after mixer: (1, 1, 1024)
  [Layer 19] Output sample values after mixer: [ 1.5155612 -0.9716931  1.252586   1.193167  -0.7303333]
  [Layer 19] Residual connection shape: (1, 1, 1024)
  [Layer 19] Residual connection sample values: [-2.804109   1.7825358 -1.134446   3.939624  -3.7321968]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.180177    0.10483357 -0.06676669  0.3097645  -0.23425609]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.180177    0.10483357 -0.06676669  0.3097645  -0.23425609]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.180177    0.10483357 -0.06676669  0.3097645  -0.23425609]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.98158985 -0.2742506   0.88800347 -0.10036346  0.46957773]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.98158985 -0.2742506   0.88800347 -0.10036346  0.46957773]
  [FlaxMamba2] xBC (step) sample values: [ 1.2463926  -0.38905513 -1.3833318  -0.45369232 -0.09081653]
  [FlaxMamba2] dt (step) sample values: [ 0.22719137  1.2623533  -1.5314336  -0.02350939  2.7741606 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.2874904  -0.8696122   0.8533652   1.2463926  -0.54503465]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.2816752   0.08829913 -0.50976497 -0.04945581 -0.04415913]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.2671717   0.05012164 -0.6893304  -0.07049768 -0.09066792]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.15132564  0.02568873 -0.23036183 -0.03400688 -0.0432802 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.15132564  0.02568873 -0.23036183 -0.03400688 -0.0432802 ]
  [FlaxMamba2] B (step) sample values: [-0.03630378  0.0378283   0.01938712  0.04895872  0.01234088]
  [FlaxMamba2] C (step) sample values: [-0.08862264 -0.08222345 -0.09129289  0.01440111 -0.08539174]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-3.08577806e-01 -2.93056536e+00 -5.29621363e+00 -1.23260975e+01
 -8.15932546e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00889229 0.08982874 0.01315456 0.07455812 0.52501154]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9972598 0.7685505 0.9327022 0.3989135 0.9957254]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.15132564  0.02568873 -0.23036183 -0.03400688 -0.0432802 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.8851518e-05  5.0902952e-05  2.6087922e-05  6.5880398e-05
  1.6606275e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.8851518e-05  5.0902952e-05  2.6087922e-05  6.5880398e-05
  1.6606275e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.1823547e-04 -2.4496645e-04 -1.8950707e-04  7.2245835e-05
 -4.5810142e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00057381 -0.00122253  0.00263361 -0.00276751  0.00195402]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.12388811  0.01990587 -0.18683378 -0.0307374  -0.03364297]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.12388811  0.01990587 -0.18683378 -0.0307374  -0.03364297]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.03314729 -0.00235763 -0.11754291  0.00146512 -0.00972025]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.4914915  -0.03010404 -1.0332134   0.02114789 -0.09168139]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.4914915  -0.03010404 -1.0332134   0.02114789 -0.09168139]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.5253721 -1.2776432 -1.09737   -2.6843648  1.1696373]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.5253721 -1.2776432 -1.09737   -2.6843648  1.1696373]
  [Layer 20] Output shape after mixer: (1, 1, 1024)
  [Layer 20] Output sample values after mixer: [ 0.5253721 -1.2776432 -1.09737   -2.6843648  1.1696373]
  [Layer 20] Residual connection shape: (1, 1, 1024)
  [Layer 20] Residual connection sample values: [-2.278737   0.5048926 -2.231816   1.2552593 -2.5625596]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.18754564  0.03759925 -0.17028476  0.12217638 -0.20275402]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18754564  0.03759925 -0.17028476  0.12217638 -0.20275402]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18754564  0.03759925 -0.17028476  0.12217638 -0.20275402]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.60440046 -1.0447097   0.02542772 -0.45826095 -0.9944204 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.60440046 -1.0447097   0.02542772 -0.45826095 -0.9944204 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.5754699   0.19803557  0.5620195  -0.43164024 -0.35057285]
  [FlaxMamba2] dt (step) sample values: [8.0029521e-04 2.1216272e-01 1.3052549e+00 3.1033549e+00 8.3922297e-01]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.26899368 -1.6583263  -0.26750508  0.5754699  -0.41306424]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.14367022  0.06805188 -0.09513815  0.15810053  0.03515783]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.21375166 -0.02942126 -0.12080343  0.06007807 -0.01882777]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.09549668 -0.01449424 -0.05675777  0.03094111 -0.00932526]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09549668 -0.01449424 -0.05675777  0.03094111 -0.00932526]
  [FlaxMamba2] B (step) sample values: [-0.09163161 -0.21713589 -0.05322244 -0.11521707 -0.02392939]
  [FlaxMamba2] C (step) sample values: [ 0.10463246 -0.11146309  0.0014371  -0.0278428   0.02740954]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.32275575 -0.3764196  -0.15946394 -0.10539922 -0.37568513]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.7335469 0.677226  1.7196788 2.591834  1.0001838]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.78918344 0.7749776  0.7601597  0.76095784 0.68677115]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09549668 -0.01449424 -0.05675777  0.03094111 -0.00932526]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00641891 0.01521065 0.0037283  0.0080711  0.00167628]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00641891 0.01521065 0.0037283  0.0080711  0.00167628]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.1074938  0.11651213 0.02198358 0.09615216 0.00926316]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.2537316  -0.14055938 -0.09903797  0.04189102  0.32520777]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.4555635  -0.17119291 -0.21899533  0.10728495  0.30549887]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.4555635  -0.17119291 -0.21899533  0.10728495  0.30549887]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.17805383  0.04654353 -0.00281967 -0.01904625 -0.08203657]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.21823049  0.07208316 -0.00493748 -0.02338771 -0.08687084]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.21823049  0.07208316 -0.00493748 -0.02338771 -0.08687084]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.674569   -3.4404578  -0.10753018  0.18496965  1.3151493 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.674569   -3.4404578  -0.10753018  0.18496965  1.3151493 ]
  [Layer 21] Output shape after mixer: (1, 1, 1024)
  [Layer 21] Output sample values after mixer: [ 1.674569   -3.4404578  -0.10753018  0.18496965  1.3151493 ]
  [Layer 21] Residual connection shape: (1, 1, 1024)
  [Layer 21] Residual connection sample values: [-0.60416806 -2.9355652  -2.3393462   1.4402289  -1.2474103 ]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.04719882 -0.21211608 -0.16920745  0.13291262 -0.0944135 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.04719882 -0.21211608 -0.16920745  0.13291262 -0.0944135 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.04719882 -0.21211608 -0.16920745  0.13291262 -0.0944135 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.5434794  1.663962   1.2238473 -1.3905181  1.4304496]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.5434794  1.663962   1.2238473 -1.3905181  1.4304496]
  [FlaxMamba2] xBC (step) sample values: [-0.32190228  1.2202941  -0.14046396  1.3553468   0.96869844]
  [FlaxMamba2] dt (step) sample values: [ 0.19446866 -0.7670771  -0.38221842  2.6645153   0.21145782]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.2586436  -0.6772157  -1.7266351  -0.32190228 -0.51293653]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.18240304  0.10048863 -0.25019562  0.28412846 -0.16203529]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.1742167   0.1650028  -0.23756135  0.26577213 -0.16142493]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.07953963  0.08929247 -0.10473781  0.15044157 -0.07421207]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07953963  0.08929247 -0.10473781  0.15044157 -0.07421207]
  [FlaxMamba2] B (step) sample values: [-0.18485567  0.01238586  0.03197741 -0.09345346 -0.11395746]
  [FlaxMamba2] C (step) sample values: [-0.21065477  0.01517342 -0.15342289 -0.16026051 -0.07542466]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.07090003 -0.07021102 -0.0699373  -0.08945116 -0.38969815]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.58373225 0.42806718 0.08027989 1.8861173  0.8308908 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9594581  0.9703921  0.99440116 0.84474933 0.7233974 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07953963  0.08929247 -0.10473781  0.15044157 -0.07421207]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00858282 -0.00057507 -0.00148471  0.00433903  0.00529103]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00858282 -0.00057507 -0.00148471  0.00433903  0.00529103]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00275481  0.04186541  0.01845603  0.00859636  0.05665381]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01103329  0.51392525 -0.30076724  0.01332834 -0.13930081]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.14815982  0.35998482 -0.12019899 -0.24603331 -0.01135901]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.14815982  0.35998482 -0.12019899 -0.24603331 -0.01135901]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.1884268   0.5036216  -0.11367407  0.06819184 -0.01311206]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.25658447  0.29702422 -0.15479222  0.13794895 -0.01703677]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.25658447  0.29702422 -0.15479222  0.13794895 -0.01703677]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.4133744  3.0897841  2.8321424 -1.5231686 -3.6178455]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.4133744  3.0897841  2.8321424 -1.5231686 -3.6178455]
  [Layer 22] Output shape after mixer: (1, 1, 1024)
  [Layer 22] Output sample values after mixer: [ 1.4133744  3.0897841  2.8321424 -1.5231686 -3.6178455]
  [Layer 22] Residual connection shape: (1, 1, 1024)
  [Layer 22] Residual connection sample values: [ 0.80920637  0.15421891  0.49279618 -0.08293962 -4.865256  ]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.04891741  0.00842201  0.02831793 -0.00616354 -0.27369708]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.04891741  0.00842201  0.02831793 -0.00616354 -0.27369708]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.04891741  0.00842201  0.02831793 -0.00616354 -0.27369708]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.8555109   0.02268542 -1.2409086  -0.49832577 -1.4283481 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.8555109   0.02268542 -1.2409086  -0.49832577 -1.4283481 ]
  [FlaxMamba2] xBC (step) sample values: [0.79555124 0.31863585 2.1227965  0.875529   0.24698195]
  [FlaxMamba2] dt (step) sample values: [0.90192884 1.9066758  1.7020566  0.77005064 1.6517994 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.2201182  -2.9222784  -0.936926    0.79555124  0.23337334]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.7423623  -0.05005632  0.62124395 -0.14462456  0.04361056]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.7760537  -0.05762087  0.5792823  -0.1282824   0.03914355]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.24458963 -0.02798062  0.3712633  -0.06003274  0.01995478]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.24458963 -0.02798062  0.3712633  -0.06003274  0.01995478]
  [FlaxMamba2] B (step) sample values: [0.16493948 0.02122076 0.01257789 0.1154243  0.11592404]
  [FlaxMamba2] C (step) sample values: [0.00694483 0.18702342 0.08746321 0.02509863 0.28786638]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.12322418 -0.22553998 -0.24196908 -0.09559295 -0.2396176 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.16875023 0.9604182  0.8204098  0.15433124 0.69189924]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9794206  0.80524176 0.81994843 0.9853553  0.84722304]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.24458963 -0.02798062  0.3712633  -0.06003274  0.01995478]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0068078  -0.00087588 -0.00051915 -0.00476409 -0.00478471]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0068078  -0.00087588 -0.00051915 -0.00476409 -0.00478471]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01962146 -0.00319737 -0.00023055  0.05560107 -0.01855288]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.10217302  0.03236461  0.3567017  -0.04364206  0.04596602]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.1135905   0.03367075  0.33937106 -0.04083972  0.04503452]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.1135905   0.03367075  0.33937106 -0.04083972  0.04503452]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02898604  0.00038625 -0.0944498   0.00769152 -0.01243763]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.04611034  0.00186252 -0.7486334   0.06115929 -0.05506557]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.04611034  0.00186252 -0.7486334   0.06115929 -0.05506557]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-3.016728   -2.5742786   3.21301     1.8692951   0.03874649]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-3.016728   -2.5742786   3.21301     1.8692951   0.03874649]
  [Layer 23] Output shape after mixer: (1, 1, 1024)
  [Layer 23] Output sample values after mixer: [-3.016728   -2.5742786   3.21301     1.8692951   0.03874649]
  [Layer 23] Residual connection shape: (1, 1, 1024)
  [Layer 23] Residual connection sample values: [-2.2075214 -2.4200597  3.7058063  1.7863555 -4.8265095]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.15189618 -0.14782201  0.24597262  0.14106585 -0.30597097]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.15189618 -0.14782201  0.24597262  0.14106585 -0.30597097]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.15189618 -0.14782201  0.24597262  0.14106585 -0.30597097]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.58562124  1.3768702   1.0990072  -1.1759877  -0.3495657 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.58562124  1.3768702   1.0990072  -1.1759877  -0.3495657 ]
  [FlaxMamba2] xBC (step) sample values: [-0.25741082 -2.265154   -1.555198   -0.28304553  1.2690146 ]
  [FlaxMamba2] dt (step) sample values: [0.529377   0.96495366 1.3410622  0.79662734 1.7686859 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5313219  -0.18481547 -0.16016293 -0.25741082 -1.1126546 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.11898254 -0.2641569  -0.18351865 -0.06937531 -0.46668485]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.24593566 -0.16680583 -0.18568921 -0.14847687 -0.45983365]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.13801317 -0.07646295 -0.08424916 -0.06873719 -0.17796724]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.13801317 -0.07646295 -0.08424916 -0.06873719 -0.17796724]
  [FlaxMamba2] B (step) sample values: [-0.05448434  0.1278883  -0.00484195  0.06784642 -0.00670689]
  [FlaxMamba2] C (step) sample values: [-0.05783371 -0.16931118 -0.26944146 -0.1151778  -0.26189286]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6296152  -0.19671947 -0.14336194 -0.14017779 -0.22378482]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.0936052 1.3788941 1.3949263 1.7586529 1.4974794]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.50230366 0.76242185 0.81874764 0.78151256 0.71525717]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.13801317 -0.07646295 -0.08424916 -0.06873719 -0.17796724]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00822343  0.01930243 -0.0007308   0.01024019 -0.00101228]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00822343  0.01930243 -0.0007308   0.01024019 -0.00101228]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.04513445  0.00943828  0.00272124  0.02650359 -0.00101721]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.15508988 -0.05758904 -0.08721197 -0.08302818 -0.24256137]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.83105624 -0.4320923  -0.49985084 -0.41969192 -1.1142163 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.83105624 -0.4320923  -0.49985084 -0.41969192 -1.1142163 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.3126264  -0.4750484  -0.41204548  0.11636703  0.1610501 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15537144 -0.7371121  -0.5621524   0.11791785  0.15129668]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.15537144 -0.7371121  -0.5621524   0.11791785  0.15129668]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.11819439  0.09910288  0.3624617   0.87726253  2.0770288 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.11819439  0.09910288  0.3624617   0.87726253  2.0770288 ]
  [Layer 24] Output shape after mixer: (1, 1, 1024)
  [Layer 24] Output sample values after mixer: [-0.11819439  0.09910288  0.3624617   0.87726253  2.0770288 ]
  [Layer 24] Residual connection shape: (1, 1, 1024)
  [Layer 24] Residual connection sample values: [-2.3257158 -2.3209567  4.068268   2.663618  -2.7494807]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.10131174 -0.09384135  0.16516495  0.13284954 -0.11223351]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.10131174 -0.09384135  0.16516495  0.13284954 -0.11223351]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.10131174 -0.09384135  0.16516495  0.13284954 -0.11223351]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.7044461  -0.41804487 -0.99579775  0.8757474  -0.2592083 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.7044461  -0.41804487 -0.99579775  0.8757474  -0.2592083 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.03133045  0.25178578  0.68940574 -1.2346742  -1.42911   ]
  [FlaxMamba2] dt (step) sample values: [0.94539523 0.94259715 0.20949319 1.5027541  1.6156424 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.00748498 -0.16954596  0.01340183  0.03133045 -0.08447351]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01214128 -0.04420403 -0.15868777 -0.6662993  -0.21004881]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.03145891 -0.04085664 -0.05602664 -0.7714018  -0.24868406]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.01548206 -0.02001106 -0.02722878 -0.24389869 -0.10896029]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01548206 -0.02001106 -0.02722878 -0.24389869 -0.10896029]
  [FlaxMamba2] B (step) sample values: [-0.06531916 -0.04555773 -0.12498335 -0.04047136 -0.01810392]
  [FlaxMamba2] C (step) sample values: [-0.21996687 -0.26784563 -0.2783395   0.91926587 -0.12213642]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.16260907 -0.3326761  -0.32944313 -0.2015813  -0.1541056 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.110072   0.7363869  0.40850288 1.2437382  1.5020565 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8348462  0.7827215  0.8740843  0.7782446  0.79336226]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01548206 -0.02001106 -0.02722878 -0.24389869 -0.10896029]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00112259 0.00078296 0.00214799 0.00069555 0.00031114]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00112259 0.00078296 0.00214799 0.00069555 0.00031114]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00346185  0.00141089 -0.00060602  0.00204761 -0.00797902]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0104814  -0.00752517 -0.01810599 -0.28512973 -0.09270816]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02470695 -0.02591215 -0.04312491 -0.5092339  -0.19282535]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02470695 -0.02591215 -0.04312491 -0.5092339  -0.19282535]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00575795  0.00430031  0.01158485 -0.31482127  0.02177005]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04322724  0.02530135  0.05692273 -0.8677188   0.092415  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04322724  0.02530135  0.05692273 -0.8677188   0.092415  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.8004426   0.89862365  2.2528517   1.5810722  -2.6591277 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.8004426   0.89862365  2.2528517   1.5810722  -2.6591277 ]
  [Layer 25] Output shape after mixer: (1, 1, 1024)
  [Layer 25] Output sample values after mixer: [-1.8004426   0.89862365  2.2528517   1.5810722  -2.6591277 ]
  [Layer 25] Residual connection shape: (1, 1, 1024)
  [Layer 25] Residual connection sample values: [-4.126158  -1.422333   6.3211193  4.2446904 -5.4086084]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.20293733 -0.06516726  0.30454114  0.25077644 -0.2544642 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.20293733 -0.06516726  0.30454114  0.25077644 -0.2544642 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.20293733 -0.06516726  0.30454114  0.25077644 -0.2544642 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.17566647  0.20046932 -0.9871598  -0.20646381 -0.03142228]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.17566647  0.20046932 -0.9871598  -0.20646381 -0.03142228]
  [FlaxMamba2] xBC (step) sample values: [ 0.05861462 -1.1958063   0.46114627 -0.60164696 -1.8147935 ]
  [FlaxMamba2] dt (step) sample values: [1.4736792  0.21790242 0.9371799  0.8845785  0.785635  ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.8596227   0.49196064 -1.0917618   0.05861462  0.5256403 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03681631 -0.4079029  -0.10849951 -0.16443574 -0.6572051 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.12781973 -0.46182746 -0.13376807 -0.2277292  -0.9250274 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.05983094 -0.17852052 -0.06241722 -0.1009552  -0.2626473 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05983094 -0.17852052 -0.06241722 -0.1009552  -0.2626473 ]
  [FlaxMamba2] B (step) sample values: [ 0.22584093  0.03517991 -0.03956765  0.14865899  0.06195396]
  [FlaxMamba2] C (step) sample values: [-0.08254308 -0.2780855   0.1074452   0.04581865  0.01723237]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.329765   -0.06343037 -0.22886811 -0.12639298 -0.0584348 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.4501727  0.23162317 2.3862057  2.0932949  0.9341459 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.6198882  0.98541546 0.57918906 0.76752996 0.94687647]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05983094 -0.17852052 -0.06241722 -0.1009552  -0.2626473 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01959513 -0.00305239  0.0034331  -0.01289843 -0.00537545]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01959513 -0.00305239  0.0034331  -0.01289843 -0.00537545]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01084063  0.01736351 -0.00844956 -0.02719768 -0.02192685]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.16874962 -0.2929626  -0.12466792 -0.18529075 -0.70068675]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.41005415 -1.0129547  -0.37640315 -0.5924538  -1.7599711 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.41005415 -1.0129547  -0.37640315 -0.5924538  -1.7599711 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03286106 -0.11167636  0.10087141  0.05486878  0.02721675]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0343198  -0.08136459  0.09709164  0.05801369  0.02118971]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0343198  -0.08136459  0.09709164  0.05801369  0.02118971]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.1079838  -0.9626189   1.492398    0.26904494 -0.53614974]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.1079838  -0.9626189   1.492398    0.26904494 -0.53614974]
  [Layer 26] Output shape after mixer: (1, 1, 1024)
  [Layer 26] Output sample values after mixer: [-1.1079838  -0.9626189   1.492398    0.26904494 -0.53614974]
  [Layer 26] Residual connection shape: (1, 1, 1024)
  [Layer 26] Residual connection sample values: [-5.2341423 -2.3849518  7.8135176  4.5137353 -5.9447584]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.2102023  -0.09117828  0.3027601   0.20951812 -0.24041884]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.2102023  -0.09117828  0.3027601   0.20951812 -0.24041884]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.2102023  -0.09117828  0.3027601   0.20951812 -0.24041884]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.1420128   0.5741325  -0.36295137  0.18174309  0.6575328 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.1420128   0.5741325  -0.36295137  0.18174309  0.6575328 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.7113648  -0.76518303  0.72201633  0.06145338  0.59058136]
  [FlaxMamba2] dt (step) sample values: [ 0.8890038  -1.4031276   0.6516098   0.64388376 -0.26343742]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.06655759 -0.4002475   0.96141565  0.7113648   0.24812002]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.21895608 -0.21826005  0.14989877 -0.02861102  0.06954943]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.23563394 -0.27004838  0.09484506 -0.22880633  0.07140623]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.104      -0.11690265  0.04966974 -0.10137188  0.03697728]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.104      -0.11690265  0.04966974 -0.10137188  0.03697728]
  [FlaxMamba2] B (step) sample values: [-0.13346913  0.13227603 -0.00164432 -0.01897637  0.07058068]
  [FlaxMamba2] C (step) sample values: [-0.22841422 -0.14908862  0.18987349 -0.02121273 -0.0817141 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.562595   -0.03025642 -0.75594616 -1.1612954  -0.04055573]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.17756218 0.01114687 0.01778904 0.14181231 0.02444736]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9049319 0.9996628 0.9866425 0.84816   0.999009 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.104      -0.11690265  0.04966974 -0.10137188  0.03697728]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.4647033e-03 -2.4426710e-03  3.0364748e-05  3.5042659e-04
 -1.3033757e-03]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.4647033e-03 -2.4426710e-03  3.0364748e-05  3.5042659e-04
 -1.3033757e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00309072 -0.01200925 -0.005061   -0.00780419 -0.00513328]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.07702419 -0.00433309  0.02526948 -0.11511762  0.04834794]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.283845   -0.23681292  0.12404579 -0.31671202  0.12188325]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.283845   -0.23681292  0.12404579 -0.31671202  0.12188325]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.2457251  -0.08697709 -0.01847031 -0.03138823  0.05279016]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.8675941  -0.24168019 -0.07403126 -0.03237079  0.27023223]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.8675941  -0.24168019 -0.07403126 -0.03237079  0.27023223]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.050665   -1.0113698   1.3786265   0.10838766 -1.0138484 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.050665   -1.0113698   1.3786265   0.10838766 -1.0138484 ]
  [Layer 27] Output shape after mixer: (1, 1, 1024)
  [Layer 27] Output sample values after mixer: [-0.050665   -1.0113698   1.3786265   0.10838766 -1.0138484 ]
  [Layer 27] Residual connection shape: (1, 1, 1024)
  [Layer 27] Residual connection sample values: [-5.284807  -3.3963218  9.192144   4.622123  -6.9586067]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.18325976 -0.11333966  0.31351715  0.18737733 -0.23370416]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18325976 -0.11333966  0.31351715  0.18737733 -0.23370416]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18325976 -0.11333966  0.31351715  0.18737733 -0.23370416]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.4287276   0.47927704  0.14504334  0.11471177  0.62932116]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.4287276   0.47927704  0.14504334  0.11471177  0.62932116]
  [FlaxMamba2] xBC (step) sample values: [ 0.00289398  0.00508321 -0.40206042 -0.31031433 -1.1367141 ]
  [FlaxMamba2] dt (step) sample values: [-0.638768    0.39347258  0.71903396  0.3624154   0.6057362 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.14847007 -0.853424    0.5593082   0.00289398 -0.23974031]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01775156 -0.13347161 -0.15930335  0.08352613 -0.27633908]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.14568125 -0.22288811 -0.28845376 -0.00656176 -0.34195188]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.06754423 -0.09907544 -0.12356853 -0.00327011 -0.14202474]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06754423 -0.09907544 -0.12356853 -0.00327011 -0.14202474]
  [FlaxMamba2] B (step) sample values: [-0.24360675 -0.11490188 -0.05702851  0.10066159 -0.12404466]
  [FlaxMamba2] C (step) sample values: [-0.0274355   0.05322117 -0.08166401 -0.10137647 -0.03878955]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.54422176 -0.18426022 -0.10643356 -0.11241624 -0.25234625]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.09890194 0.6838722  1.401392   1.0678196  0.75631523]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.94759834 0.8816056  0.8614355  0.88688475 0.8262538 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06754423 -0.09907544 -0.12356853 -0.00327011 -0.14202474]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00162736  0.00076757  0.00038097 -0.00067245  0.00082865]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00162736  0.00076757  0.00038097 -0.00067245  0.00082865]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0143138  -0.00442438  0.00420448 -0.00148307  0.01646704]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01587529 -0.04567592 -0.02803132  0.00919179 -0.0174556 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.1418908  -0.23051836 -0.2585699   0.00309082 -0.28242743]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.1418908  -0.23051836 -0.2585699   0.00309082 -0.28242743]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03918581 -0.06823125 -0.02010946  0.00018743 -0.11594452]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.20245774 -0.33125117 -0.09319944  0.00100364 -0.72240543]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.20245774 -0.33125117 -0.09319944  0.00100364 -0.72240543]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.362644   -4.1384087   0.72610945 -0.11269577 -1.3534029 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.362644   -4.1384087   0.72610945 -0.11269577 -1.3534029 ]
  [Layer 28] Output shape after mixer: (1, 1, 1024)
  [Layer 28] Output sample values after mixer: [ 2.362644   -4.1384087   0.72610945 -0.11269577 -1.3534029 ]
  [Layer 28] Residual connection shape: (1, 1, 1024)
  [Layer 28] Residual connection sample values: [-2.9221632 -7.5347304  9.918254   4.509427  -8.31201  ]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.1201736  -0.30591205  0.41105413  0.2291635  -0.34334707]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1201736  -0.30591205  0.41105413  0.2291635  -0.34334707]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1201736  -0.30591205  0.41105413  0.2291635  -0.34334707]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.55844265 -1.141556   -0.5691432   0.8099593  -0.70995754]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.55844265 -1.141556   -0.5691432   0.8099593  -0.70995754]
  [FlaxMamba2] xBC (step) sample values: [ 0.2164995   0.68811774  1.5605286   0.92739403 -0.2653497 ]
  [FlaxMamba2] dt (step) sample values: [1.1669158  0.47569704 1.8983781  1.05888    1.1139216 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.27950776 -0.40678465  0.7908142   0.2164995  -0.3982787 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04948467 -0.1817965  -0.43649945 -0.15769884  0.33877444]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.06347698 -0.25741905 -0.57480514  0.20900038  1.8387744 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.03274548 -0.11223426 -0.20700388  0.1153809   1.5865014 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03274548 -0.11223426 -0.20700388  0.1153809   1.5865014 ]
  [FlaxMamba2] B (step) sample values: [ 0.22107626 -0.07317811  0.02298764 -0.09492215  0.08819608]
  [FlaxMamba2] C (step) sample values: [-0.10395709 -0.10367997 -0.15405916  0.0769937   0.06830688]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6542169  -0.13693057 -1.458904   -0.36823887 -0.12178858]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.24567455 0.08738311 0.5081495  0.27271584 0.7082279 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8515267  0.9881059  0.47647437 0.90445334 0.91736114]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03274548 -0.11223426 -0.20700388  0.1153809   1.5865014 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0017785  -0.0005887   0.00018493 -0.00076362  0.00070951]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0017785  -0.0005887   0.00018493 -0.00076362  0.00070951]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00939104 -0.00054122  0.0005722  -0.00281745  0.00266973]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00128935 -0.03585102 -0.04234998  0.06567822  0.43477032]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.05375419 -0.22451127 -0.39031327  0.25962782  3.101601  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.05375419 -0.22451127 -0.39031327  0.25962782  3.101601  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01909461  0.06203162  0.08029056  0.14554048 -0.72579896]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.11866964  0.30099687  0.29107842  0.64785266 -0.50051653]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.11866964  0.30099687  0.29107842  0.64785266 -0.50051653]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.0578117 -1.4090021  2.6874585  1.5798911 -1.021166 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.0578117 -1.4090021  2.6874585  1.5798911 -1.021166 ]
  [Layer 29] Output shape after mixer: (1, 1, 1024)
  [Layer 29] Output sample values after mixer: [ 1.0578117 -1.4090021  2.6874585  1.5798911 -1.021166 ]
  [Layer 29] Residual connection shape: (1, 1, 1024)
  [Layer 29] Residual connection sample values: [-1.8643515 -8.943732  12.605713   6.0893183 -9.333176 ]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.06912015 -0.3165045   0.45476642  0.25777894 -0.33629152]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.06912015 -0.3165045   0.45476642  0.25777894 -0.33629152]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.06912015 -0.3165045   0.45476642  0.25777894 -0.33629152]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.29817054  0.03756122 -0.69676346 -0.2938678   1.456427  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.29817054  0.03756122 -0.69676346 -0.2938678   1.456427  ]
  [FlaxMamba2] xBC (step) sample values: [-0.97053677 -0.935274   -1.4334646  -0.7021527  -0.67190063]
  [FlaxMamba2] dt (step) sample values: [ 0.5933768  -0.10592243  0.6125371   0.1495469   1.1795636 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.04912078  0.45068502 -1.0556526  -0.97053677  0.7463226 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.35577542  0.21275333  0.3894536   0.43714306 -0.30269286]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.39859158  0.17094424  0.9646489   0.48658153 -0.39522216]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.1600946   0.09275986  0.69845563  0.30134034 -0.15906143]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.1600946   0.09275986  0.69845563  0.30134034 -0.15906143]
  [FlaxMamba2] B (step) sample values: [ 0.03135847  0.11299193  0.03063663  0.06496763 -0.22674364]
  [FlaxMamba2] C (step) sample values: [-0.01636421 -0.10850158 -0.24800791 -0.19290765 -0.2523626 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2037584  -0.36680323 -0.20777717 -0.09522027 -0.4265393 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.8108591  0.21603982 0.7072779  0.11440975 0.666117  ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.84770775 0.9238144  0.8633318  0.989165   0.7526725 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.1600946   0.09275986  0.69845563  0.30134034 -0.15906143]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00407077 -0.01466795 -0.00397707 -0.00843372  0.02943454]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00407077 -0.01466795 -0.00397707 -0.00843372  0.02943454]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0066232  -0.02306564 -0.00176058 -0.02280888  0.07243991]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.14700359 -0.08330614  1.4392773   0.25174198 -0.33631164]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.1734449  -0.06798587  1.5546346   0.3015115  -0.3625823 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.1734449  -0.06798587  1.5546346   0.3015115  -0.3625823 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02968483 -0.00130079 -0.36020088 -0.0378392  -0.42826095]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.10109191 -0.00489289 -0.81905365 -0.1428334  -0.5927069 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.10109191 -0.00489289 -0.81905365 -0.1428334  -0.5927069 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.4416802   0.02284315 -0.45845816 -2.111597   -1.9287261 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.4416802   0.02284315 -0.45845816 -2.111597   -1.9287261 ]
  [Layer 30] Output shape after mixer: (1, 1, 1024)
  [Layer 30] Output sample values after mixer: [-0.4416802   0.02284315 -0.45845816 -2.111597   -1.9287261 ]
  [Layer 30] Residual connection shape: (1, 1, 1024)
  [Layer 30] Residual connection sample values: [ -2.3060317  -8.920889   12.147255    3.9777212 -11.261902 ]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.05385216 -0.21127434  0.28492576  0.1052104  -0.2634613 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05385216 -0.21127434  0.28492576  0.1052104  -0.2634613 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05385216 -0.21127434  0.28492576  0.1052104  -0.2634613 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.34291828  0.04028367 -0.07956986 -0.07314099 -0.8363016 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.34291828  0.04028367 -0.07956986 -0.07314099 -0.8363016 ]
  [FlaxMamba2] xBC (step) sample values: [-0.2252947   0.02871544 -0.07666827 -0.28309867 -1.20753   ]
  [FlaxMamba2] dt (step) sample values: [2.0745366  2.1891983  1.3226006  0.62177503 0.7335551 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.11497445  0.78173983 -0.20685734 -0.2252947  -0.05955464]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04599661 -0.01302861  0.02585988  0.11675463 -0.97461593]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04308981  0.02191402  0.01528553  0.09859667 -1.0349187 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.02200902  0.01107706  0.00770118  0.0517267  -0.2712849 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02200902  0.01107706  0.00770118  0.0517267  -0.2712849 ]
  [FlaxMamba2] B (step) sample values: [-0.060867    0.0446357  -0.05628513  0.02549656  0.04568037]
  [FlaxMamba2] C (step) sample values: [-0.1286664  -0.03849586 -0.17426573 -0.15851532  0.0296797 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-9.5765535e-03 -1.0641767e-02 -2.6350424e+01 -6.4467737e+02
 -1.6546801e-02]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.31810623 0.42929307 2.0158489  1.8306721  0.12659787]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.9695826e-01 9.9544197e-01 8.5298275e-24 0.0000000e+00 9.9790740e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02200902  0.01107706  0.00770118  0.0517267  -0.2712849 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00042614  0.0003125  -0.00039406  0.00017851  0.00031982]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00042614  0.0003125  -0.00039406  0.00017851  0.00031982]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01607544 -0.01054792  0.00786036  0.01546814  0.0058042 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0053442  -0.03153187 -0.01397834 -0.05047668 -0.13965972]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00810608 -0.03292191 -0.01494475 -0.05696778 -0.10561658]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00810608 -0.03292191 -0.01494475 -0.05696778 -0.10561658]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00115386 -0.00067646  0.00057093  0.00200719  0.02670261]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02276363 -0.01206907  0.01031333  0.16048968  0.13925533]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02276363 -0.01206907  0.01031333  0.16048968  0.13925533]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-4.105768   1.9447286  1.4522238  2.0966551 -1.5551889]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-4.105768   1.9447286  1.4522238  2.0966551 -1.5551889]
  [Layer 31] Output shape after mixer: (1, 1, 1024)
  [Layer 31] Output sample values after mixer: [-4.105768   1.9447286  1.4522238  2.0966551 -1.5551889]
  [Layer 31] Residual connection shape: (1, 1, 1024)
  [Layer 31] Residual connection sample values: [ -6.4118    -6.97616   13.599479   6.074376 -12.817091]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.24753244 -0.2635539   0.5102136   0.27332494 -0.5020485 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.24753244 -0.2635539   0.5102136   0.27332494 -0.5020485 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.24753244 -0.2635539   0.5102136   0.27332494 -0.5020485 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.43220592 -1.3849139   1.878751    3.4903677   0.7898458 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.43220592 -1.3849139   1.878751    3.4903677   0.7898458 ]
  [FlaxMamba2] xBC (step) sample values: [-0.37891003  0.21737818  1.5094261  -2.1811776   0.45523307]
  [FlaxMamba2] dt (step) sample values: [ 2.1089075   1.9346488  -0.17790344  1.7628497   0.53080016]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.41832352 -0.19000448 -1.0760485  -0.37891003 -1.5950568 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.413042   -0.11398213  0.02821081  0.3130742  -0.14683439]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.39935488 -0.48190206  0.0261337   0.28959092 -0.15913297]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.23902692 -0.1839917   0.01323759  0.16561589 -0.07324898]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.23902692 -0.1839917   0.01323759  0.16561589 -0.07324898]
  [FlaxMamba2] B (step) sample values: [-0.14379205  0.22458975  0.19522634 -0.02696805  0.04148547]
  [FlaxMamba2] C (step) sample values: [-0.27335936 -0.23561135 -0.23661907 -0.25896126  0.55958635]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.0662153  -0.08112868 -0.58786964 -0.09559295 -0.5447535 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [2.7150033 2.6395762 0.3631569 2.212917  0.8734717]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8354584  0.80723107 0.8077611  0.8093375  0.62137115]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.23902692 -0.1839917   0.01323759  0.16561589 -0.07324898]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.09331512  0.14574951  0.12669386 -0.01750115  0.02692237]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.09331512  0.14574951  0.12669386 -0.01750115  0.02692237]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00106138  0.09878645  0.17517032  0.3716782   0.22099318]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 1.6051214  -2.2994673   0.18476324  0.86000097 -0.8015197 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 1.5997099  -2.2953017   0.18446355  0.8562515  -0.7998614 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 1.5997099  -2.2953017   0.18446355  0.8562515  -0.7998614 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.41926762  0.63646144  0.3006305   2.900206   -0.43452832]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.12599732  0.41538146  0.19557723  1.1822417  -0.19955595]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.12599732  0.41538146  0.19557723  1.1822417  -0.19955595]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.6467073   5.199761    0.11454035  3.1066492  -1.6595718 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.6467073   5.199761    0.11454035  3.1066492  -1.6595718 ]
  [Layer 32] Output shape after mixer: (1, 1, 1024)
  [Layer 32] Output sample values after mixer: [ 3.6467073   5.199761    0.11454035  3.1066492  -1.6595718 ]
  [Layer 32] Residual connection shape: (1, 1, 1024)
  [Layer 32] Residual connection sample values: [ -2.7650926  -1.7763991  13.714019    9.1810255 -14.476663 ]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.09774586 -0.06132857  0.48208144  0.3408668  -0.517467  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.09774586 -0.06132857  0.48208144  0.3408668  -0.517467  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.09774586 -0.06132857  0.48208144  0.3408668  -0.517467  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [0.55677706 1.9462715  2.5580935  0.57468206 0.0903601 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [0.55677706 1.9462715  2.5580935  0.57468206 0.0903601 ]
  [FlaxMamba2] xBC (step) sample values: [-0.709317   -0.10803429  1.9501668   0.8178047   1.1337947 ]
  [FlaxMamba2] dt (step) sample values: [-1.2243558   2.183327    0.5855685  -0.09445227 -0.77746   ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.0037569  -0.18888599  0.28016454 -0.709317    0.33689463]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.17473784 -0.04374443  0.29660907  0.27697477  0.21543069]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.4450015  -0.08033501  0.28324237  0.15404996  0.1810679 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.17379528 -0.03855494  0.16154474  0.08294612  0.09870803]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.17379528 -0.03855494  0.16154474  0.08294612  0.09870803]
  [FlaxMamba2] B (step) sample values: [-0.23798904  0.2723607   0.09242403 -0.03528604 -0.14400564]
  [FlaxMamba2] C (step) sample values: [-0.06320141  0.22795287  0.07401136 -0.22551633  0.13703513]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-13.044406    -1.3849771   -0.1667907   -0.23590268  -5.254998  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00416789 0.04201266 0.09741558 0.047819   0.00383137]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9470839  0.9434739  0.98388326 0.98878276 0.9800675 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.17379528 -0.03855494  0.16154474  0.08294612  0.09870803]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.7238945e-04 -1.9728688e-04 -6.6948152e-05  2.5559755e-05
  1.0431175e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.7238945e-04 -1.9728688e-04 -6.6948152e-05  2.5559755e-05
  1.0431175e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00118618 -0.00159117  0.00065169  0.00022698  0.00119609]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00032574 -0.00042974  0.0003903  -0.00034795  0.00193028]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.1864782  -0.04172602  0.17342117  0.0884958   0.10765663]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.1864782  -0.04172602  0.17342117  0.0884958   0.10765663]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.06600336 -0.0710621   0.41173756  0.03254045  0.00508353]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.49523655 -0.5169443   4.0877514   0.27149773  0.04795557]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.49523655 -0.5169443   4.0877514   0.27149773  0.04795557]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.28155696  2.840207   -0.23057318  1.1500993  -2.059672  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.28155696  2.840207   -0.23057318  1.1500993  -2.059672  ]
  [Layer 33] Output shape after mixer: (1, 1, 1024)
  [Layer 33] Output sample values after mixer: [-0.28155696  2.840207   -0.23057318  1.1500993  -2.059672  ]
  [Layer 33] Residual connection shape: (1, 1, 1024)
  [Layer 33] Residual connection sample values: [ -3.0466495   1.063808   13.483446   10.331125  -16.536335 ]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.08432465  0.02900368  0.38800007  0.29005387 -0.46742794]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08432465  0.02900368  0.38800007  0.29005387 -0.46742794]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08432465  0.02900368  0.38800007  0.29005387 -0.46742794]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.889582  -1.4448682 -1.3331306  1.1233481 -2.6362913]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.889582  -1.4448682 -1.3331306  1.1233481 -2.6362913]
  [FlaxMamba2] xBC (step) sample values: [-0.631929   -1.059739   -1.1369078  -0.07276501 -1.8039685 ]
  [FlaxMamba2] dt (step) sample values: [1.7329171  1.4516704  0.6563837  0.78701335 0.09357964]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.45721817 -0.35401002  0.21654475 -0.631929   -2.6236355 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.12950264  0.700891    0.27028236  0.01542037 -0.5970135 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.17286812  0.603662    0.23628578 -0.06569535 -0.6710491 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.07898176  0.39026365  0.13203605 -0.03176909 -0.22699039]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07898176  0.39026365  0.13203605 -0.03176909 -0.22699039]
  [FlaxMamba2] B (step) sample values: [-0.03834752 -0.00870002 -0.04093537  0.08210456 -0.14055252]
  [FlaxMamba2] C (step) sample values: [-0.2212413  -0.04924098 -0.11505098 -0.10488477 -0.17627767]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2224774  -0.15365478 -0.8168739  -0.85911244 -2.0730147 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.07197675 0.03016865 0.34334368 0.2071694  0.1912873 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.98411435 0.99537516 0.75542974 0.83695763 0.67264247]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07898176  0.39026365  0.13203605 -0.03176909 -0.22699039]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.1799994e-04  4.9458340e-05  2.3271145e-04 -4.6675216e-04
  7.9902011e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.1799994e-04  4.9458340e-05  2.3271145e-04 -4.6675216e-04
  7.9902011e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0030048   0.00746722  0.00339749 -0.00671748  0.010685  ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.04792857  0.15360422  0.08035035 -0.03968777 -0.06714965]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.20332618  0.9214528   0.34013292 -0.10219386 -0.5137561 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.20332618  0.9214528   0.34013292 -0.10219386 -0.5137561 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.05044264 -0.25401708 -0.09460696 -0.0866286   0.09052744]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.31923324 -0.89897704 -0.5006951  -0.541829    0.60348773]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.31923324 -0.89897704 -0.5006951  -0.541829    0.60348773]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.48807108 -1.77635     0.71978813 -4.404276    1.7311417 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.48807108 -1.77635     0.71978813 -4.404276    1.7311417 ]
  [Layer 34] Output shape after mixer: (1, 1, 1024)
  [Layer 34] Output sample values after mixer: [ 0.48807108 -1.77635     0.71978813 -4.404276    1.7311417 ]
  [Layer 34] Residual connection shape: (1, 1, 1024)
  [Layer 34] Residual connection sample values: [ -2.5585785   -0.71254206  14.203235     5.9268494  -14.805193  ]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.08893949 -0.02457504  0.48642424  0.2196405  -0.51151496]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08893949 -0.02457504  0.48642424  0.2196405  -0.51151496]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08893949 -0.02457504  0.48642424  0.2196405  -0.51151496]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.0286096 -1.1193881 -1.3018198 -1.2127942 -0.6982897]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.0286096 -1.1193881 -1.3018198 -1.2127942 -0.6982897]
  [FlaxMamba2] xBC (step) sample values: [ 0.36135927  1.2329392  -1.7463373  -1.0015557   0.13356745]
  [FlaxMamba2] dt (step) sample values: [ 1.0973066   1.1444205  -0.20261107  1.3705844   1.59234   ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.07868662  1.6061976  -0.9954213   0.36135927  0.37813342]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.05499755  0.27372548 -0.5016614  -0.16898353  0.04002598]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.10645019  0.25199696 -0.5290967  -0.19382484 -0.07221767]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.05039485  0.14179061 -0.19615074 -0.0875497  -0.03480555]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05039485  0.14179061 -0.19615074 -0.0875497  -0.03480555]
  [FlaxMamba2] B (step) sample values: [-0.18692061  0.02968455  0.16020575  0.04470206  0.15407196]
  [FlaxMamba2] C (step) sample values: [-0.20458919 -0.00718822 -0.24664684 -0.13061945  0.01371041]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2053565  -0.14169171 -0.10705902 -0.1460468  -0.2580783 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [2.7210422  3.3519397  0.75787205 3.730788   2.0744822 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.5719043  0.62192106 0.92206734 0.5799174  0.58544743]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05039485  0.14179061 -0.19615074 -0.0875497  -0.03480555]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.02563177 -0.00407054 -0.02196846 -0.00612984 -0.02112735]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.02563177 -0.00407054 -0.02196846 -0.00612984 -0.02112735]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.03965008  0.00040201 -0.03988836 -0.05035972 -0.06493536]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.1511385   0.44060686 -0.21350947 -0.664425   -0.6057036 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.28310448  0.8119054  -0.7271576  -0.8936862  -0.6968468 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.28310448  0.8119054  -0.7271576  -0.8936862  -0.6968468 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.21451434 -0.22368737  0.20244487  0.2484277   0.1616447 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.26431808 -0.26726866  0.08366128  0.44241384  0.16684762]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.26431808 -0.26726866  0.08366128  0.44241384  0.16684762]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.3924283   1.4879472  -0.39380378 -4.341552    1.2902328 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.3924283   1.4879472  -0.39380378 -4.341552    1.2902328 ]
  [Layer 35] Output shape after mixer: (1, 1, 1024)
  [Layer 35] Output sample values after mixer: [-0.3924283   1.4879472  -0.39380378 -4.341552    1.2902328 ]
  [Layer 35] Residual connection shape: (1, 1, 1024)
  [Layer 35] Residual connection sample values: [ -2.951007     0.77540517  13.809431     1.5852976  -13.51496   ]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.08054971  0.02164059  0.37914628  0.04618753 -0.37790623]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08054971  0.02164059  0.37914628  0.04618753 -0.37790623]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08054971  0.02164059  0.37914628  0.04618753 -0.37790623]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.01252418 -2.42055    -1.2638007   1.2845877   0.8677507 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.01252418 -2.42055    -1.2638007   1.2845877   0.8677507 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.94556344  1.5891014  -0.5582079  -0.579748   -2.8590882 ]
  [FlaxMamba2] dt (step) sample values: [0.21366192 2.5303216  2.013507   1.2343841  1.5847722 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.1990757   0.72343063  1.8071251   0.94556344  0.36292765]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.3645446   0.37043458 -0.16137505 -0.15301587 -0.4549196 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.3242614   0.25288087 -0.22347832 -0.29766917 -0.4670427 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.13607226  0.14234297 -0.09930521 -0.12684499 -0.17995922]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.13607226  0.14234297 -0.09930521 -0.12684499 -0.17995922]
  [FlaxMamba2] B (step) sample values: [ 0.04603551  0.00066316  0.14159966 -0.16415928  0.03155704]
  [FlaxMamba2] C (step) sample values: [ 0.12022523  0.26639476 -0.18321125 -0.07789803 -0.18404917]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.8654757 -5.63779   -3.8975632 -2.4259677 -3.6937442]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08589802 0.19631496 0.12854768 0.12998982 0.11564814]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7818138  0.330621   0.60591066 0.7295327  0.6523496 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.13607226  0.14234297 -0.09930521 -0.12684499 -0.17995922]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.3807860e-04 -7.7512486e-06 -1.6550646e-03  1.9187492e-03
 -3.6884932e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.3807860e-04 -7.7512486e-06 -1.6550646e-03  1.9187492e-03
 -3.6884932e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00780108  0.00263911 -0.0053658   0.01153812 -0.00647191]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.03421638  0.01595603 -0.04915266 -0.05661574 -0.04190438]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.38309494  0.45249856 -0.35370547 -0.4456285  -0.5938098 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.38309494  0.45249856 -0.35370547 -0.4456285  -0.5938098 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00238395 -0.08939693  0.0984861  -0.44835895 -0.3628993 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00547055 -0.43808338  0.33341593 -1.6185124  -1.4907361 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00547055 -0.43808338  0.33341593 -1.6185124  -1.4907361 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 6.7530236  2.4847243  1.6864996 -2.8052478 -2.9051342]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 6.7530236  2.4847243  1.6864996 -2.8052478 -2.9051342]
  [Layer 36] Output shape after mixer: (1, 1, 1024)
  [Layer 36] Output sample values after mixer: [ 6.7530236  2.4847243  1.6864996 -2.8052478 -2.9051342]
  [Layer 36] Residual connection shape: (1, 1, 1024)
  [Layer 36] Residual connection sample values: [  3.8020167   3.2601295  15.495931   -1.2199502 -16.420094 ]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.09738223  0.08574354  0.4163955  -0.03200638 -0.4314333 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.09738223  0.08574354  0.4163955  -0.03200638 -0.4314333 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.09738223  0.08574354  0.4163955  -0.03200638 -0.4314333 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.99284434 -0.0512508   0.22480178  1.5984453  -1.0996238 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.99284434 -0.0512508   0.22480178  1.5984453  -1.0996238 ]
  [FlaxMamba2] xBC (step) sample values: [-0.649439   2.078097   2.0335374 -2.5341341  0.570131 ]
  [FlaxMamba2] dt (step) sample values: [ 0.91498154 -0.9557891   2.8339176  -0.555786    0.181655  ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.13252309 -0.6261729  -0.61719257 -0.649439    1.6175689 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.1910995  -0.7095225  -0.66407865  0.6313541  -0.25411695]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.11334071 -0.7736094  -0.7486734   0.6662357  -0.33773512]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.05987845 -0.24422759 -0.24040683  0.4401551  -0.14061931]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05987845 -0.24422759 -0.24040683  0.4401551  -0.14061931]
  [FlaxMamba2] B (step) sample values: [-0.2058161   0.14130913 -0.0761167  -0.09828205 -0.00984961]
  [FlaxMamba2] C (step) sample values: [-0.2733476  -0.27393398 -0.23277114 -0.27804345 -0.26237458]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.8178532  -31.169907   -39.01954     -0.46187502  -0.64770097]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0015758  0.00278651 0.05540251 0.00042517 0.0019859 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9971395  0.9168097  0.11511996 0.99980366 0.99871457]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05987845 -0.24422759 -0.24040683  0.4401551  -0.14061931]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.9420040e-05  1.3333402e-05 -7.1820882e-06 -9.2735281e-06
 -9.2937199e-07]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.9420040e-05  1.3333402e-05 -7.1820882e-06 -9.2735281e-06
 -9.2937199e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0004101   0.00035102 -0.000621    0.00090325 -0.00057953]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0004902   0.00128046  0.00171713 -0.00160567  0.00063125]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.10918391 -0.44604987 -0.43861505  0.8045879  -0.25692886]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.10918391 -0.44604987 -0.43861505  0.8045879  -0.25692886]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02930672  0.01113737 -0.05481895  1.0697707   0.0705777 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.22425932  0.06162819 -0.28530097  8.808474    0.31010887]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.22425932  0.06162819 -0.28530097  8.808474    0.31010887]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.4909925   6.815188   -3.6282532  -0.50211257  1.0234454 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.4909925   6.815188   -3.6282532  -0.50211257  1.0234454 ]
  [Layer 37] Output shape after mixer: (1, 1, 1024)
  [Layer 37] Output sample values after mixer: [ 3.4909925   6.815188   -3.6282532  -0.50211257  1.0234454 ]
  [Layer 37] Residual connection shape: (1, 1, 1024)
  [Layer 37] Residual connection sample values: [  7.2930093  10.075317   11.867678   -1.7220628 -15.396648 ]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.17963849  0.2481712   0.29092792 -0.04110425 -0.3817724 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.17963849  0.2481712   0.29092792 -0.04110425 -0.3817724 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.17963849  0.2481712   0.29092792 -0.04110425 -0.3817724 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.217132   -2.0440943   0.25469574 -2.122121   -1.2972453 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-2.217132   -2.0440943   0.25469574 -2.122121   -1.2972453 ]
  [FlaxMamba2] xBC (step) sample values: [ 2.66538   -0.7356998 -1.3730588  1.1011562  3.0579493]
  [FlaxMamba2] dt (step) sample values: [ 0.5689934   1.2961203   0.48461926 -0.14662647  1.2423213 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.20195916  1.5038368   1.7691193   2.66538    -1.2253625 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.9229502   0.44051203  0.03141899 -0.46141845  0.2656107 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.9253401   0.15120539 -0.0586689  -0.5046008   0.35856724]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.26267728  0.0813076  -0.02847419 -0.18996206  0.21108623]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.26267728  0.0813076  -0.02847419 -0.18996206  0.21108623]
  [FlaxMamba2] B (step) sample values: [ 0.07720108 -0.18773828  0.02730151 -0.0181854  -0.08551904]
  [FlaxMamba2] C (step) sample values: [-0.27783963 -0.03448686 -0.09317678 -0.27634466  0.04883813]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17041285 -2.0831616  -0.13507122 -0.41240796 -3.531486  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.1503607  0.3785573  0.9349116  0.26207653 0.30601627]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.82198244 0.45448244 0.88136834 0.89755356 0.33936054]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.26267728  0.0813076  -0.02847419 -0.18996206  0.21108623]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.02332813  0.05672956 -0.00824979  0.00549515  0.0258416 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.02332813  0.05672956 -0.00824979  0.00549515  0.0258416 ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.03598949  0.19107819 -0.00143546  0.01266664 -0.03739591]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.3558086  -0.5655592  -0.25423715 -0.23201478  1.0363151 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.39433306 -0.5536346  -0.2584132  -0.25987476  1.0672731 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.39433306 -0.5536346  -0.2584132  -0.25987476  1.0672731 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.08587484  0.12974781 -0.03707667  0.05898983 -0.29715708]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.28320166  0.2880881  -0.09104148  0.28921565 -1.0073168 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.28320166  0.2880881  -0.09104148  0.28921565 -1.0073168 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [10.107239  -3.2991288  9.521494  -3.7130044  1.7609168]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [10.107239  -3.2991288  9.521494  -3.7130044  1.7609168]
  [Layer 38] Output shape after mixer: (1, 1, 1024)
  [Layer 38] Output sample values after mixer: [10.107239  -3.2991288  9.521494  -3.7130044  1.7609168]
  [Layer 38] Residual connection shape: (1, 1, 1024)
  [Layer 38] Residual connection sample values: [ 17.400248   6.776189  21.389172  -5.435067 -13.635732]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.29626635  0.12547237  0.38410395 -0.10236622 -0.24367349]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.29626635  0.12547237  0.38410395 -0.10236622 -0.24367349]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.29626635  0.12547237  0.38410395 -0.10236622 -0.24367349]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.4922827   0.24749103 -0.30534658 -2.1080751  -0.3657573 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.4922827   0.24749103 -0.30534658 -2.1080751  -0.3657573 ]
  [FlaxMamba2] xBC (step) sample values: [-0.6531149  -0.00172774  1.4203467  -0.24280757  0.6514706 ]
  [FlaxMamba2] dt (step) sample values: [ 0.35898677 -0.64961433  1.34931     0.3784046   0.48910028]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.1085325   0.16301915  2.4909613  -0.6531149   0.72197044]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.11569536 -0.01563486  0.27648437 -0.04879921  0.19147967]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.05124224 -0.07636484  0.29174316  0.48879844  0.18807696]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.02496482 -0.03672523  0.16700044  0.30296865  0.10285574]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02496482 -0.03672523  0.16700044  0.30296865  0.10285574]
  [FlaxMamba2] B (step) sample values: [-0.02846726  0.0386606  -0.15353    -0.06984531 -0.01790162]
  [FlaxMamba2] C (step) sample values: [ 0.89231277 -0.2784589  -0.01389572  0.12679279 -0.22802907]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.7351256e+02 -2.3790452e+00 -2.6078771e-03 -1.4978828e+00
 -6.3306607e-02]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.366523   0.14982134 0.7715311  0.1793412  0.01450871]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [2.4013681e-28 7.0017028e-01 9.9798995e-01 7.6442444e-01 9.9908191e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02496482 -0.03672523  0.16700044  0.30296865  0.10285574]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00026048 -0.00035375  0.00140483  0.0006391   0.0001638 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00026048 -0.00035375  0.00140483  0.0006391   0.0001638 ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00026048 -0.00035375  0.00140483  0.0006391   0.0001638 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00047724 -0.00070205  0.00319244  0.00579165  0.00196623]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.1134396  -0.16687864  0.75884634  1.376683    0.46737427]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.1134396  -0.16687864  0.75884634  1.376683    0.46737427]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.03465946 -0.02319293 -0.09830368 -0.31434485 -0.07001358]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.16281371 -0.10321517 -0.41394672 -1.2915999  -0.34702492]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.16281371 -0.10321517 -0.41394672 -1.2915999  -0.34702492]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ -0.27710274   2.3016884   11.872329     1.3843068  -10.804915  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ -0.27710274   2.3016884   11.872329     1.3843068  -10.804915  ]
  [Layer 39] Output shape after mixer: (1, 1, 1024)
  [Layer 39] Output sample values after mixer: [ -0.27710274   2.3016884   11.872329     1.3843068  -10.804915  ]
  [Layer 39] Residual connection shape: (1, 1, 1024)
  [Layer 39] Residual connection sample values: [ 17.123144    9.077877   33.2615     -4.0507603 -24.440647 ]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.31565428  0.17856772  0.640873   -0.07148299 -0.46643895]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.31565428  0.17856772  0.640873   -0.07148299 -0.46643895]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.31565428  0.17856772  0.640873   -0.07148299 -0.46643895]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.5984598   1.2315705   0.691453   -0.28302792  2.7258213 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.5984598   1.2315705   0.691453   -0.28302792  2.7258213 ]
  [FlaxMamba2] xBC (step) sample values: [-0.30949703  1.3096424  -1.1752131   0.78819114  1.4017454 ]
  [FlaxMamba2] dt (step) sample values: [3.190609  0.5784802 0.7399035 1.4457618 1.4503536]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.4281828  -1.8997272  -0.4070388  -0.30949703  0.5469233 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.04765026 -0.24050769 -0.22701709 -0.14038399  0.23961194]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.28364855 -0.28900012 -0.29867238 -0.15193489  0.2411445 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.16180462 -0.12376392 -0.12719922 -0.07020747  0.13503987]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.16180462 -0.12376392 -0.12719922 -0.07020747  0.13503987]
  [FlaxMamba2] B (step) sample values: [-0.0405888  -0.26394814 -0.01428011  0.01386282  0.02733789]
  [FlaxMamba2] C (step) sample values: [-0.24967717 -0.25149307 -0.24406058 -0.27836862 -0.04086982]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.52670574 -0.63007647 -0.38779998 -2.7909086  -0.42841786]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.3634118  0.0229858  0.05720572 0.02551256 0.06691163]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.825793   0.9856216  0.9780599  0.9312726  0.97174084]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.16180462 -0.12376392 -0.12719922 -0.07020747  0.13503987]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00238669 -0.0155206  -0.00083969  0.00081516  0.00160751]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00238669 -0.0155206  -0.00083969  0.00081516  0.00160751]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00279771 -0.04530427 -0.00692165  0.00037247 -0.00073761]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.10396843 -0.05857091 -0.06545192 -0.02043995  0.05567235]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.50453585 -0.36496386 -0.38034937 -0.19424726  0.3899803 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.50453585 -0.36496386 -0.38034937 -0.19424726  0.3899803 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.13564757 -0.34793848 -0.17523009  0.02362442  0.9976764 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.6585334  -1.999822   -1.0252908   0.10924224  7.598505  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.6585334  -1.999822   -1.0252908   0.10924224  7.598505  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ -2.0150971  -8.437074  -11.63788   -11.28385    -9.6774435]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ -2.0150971  -8.437074  -11.63788   -11.28385    -9.6774435]
  [Layer 40] Output shape after mixer: (1, 1, 1024)
  [Layer 40] Output sample values after mixer: [ -2.0150971  -8.437074  -11.63788   -11.28385    -9.6774435]
  [Layer 40] Residual connection shape: (1, 1, 1024)
  [Layer 40] Residual connection sample values: [ 15.1080475    0.64080334  21.623621   -15.33461    -34.11809   ]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.15996972  0.00725448  0.23615906 -0.16043974 -0.3620126 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.15996972  0.00725448  0.23615906 -0.16043974 -0.3620126 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.15996972  0.00725448  0.23615906 -0.16043974 -0.3620126 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.1181667e+00 -1.9746592e+00 -2.4793486e-01  1.6574482e+00
 -5.0069095e-04]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.1181667e+00 -1.9746592e+00 -2.4793486e-01  1.6574482e+00
 -5.0069095e-04]
  [FlaxMamba2] xBC (step) sample values: [-1.1127415   0.07123789  0.41477785  1.5419849  -0.07064618]
  [FlaxMamba2] dt (step) sample values: [2.0923436  0.57559144 0.47155526 1.5770774  0.98414856]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.78716666 -0.21741539 -0.6705064  -1.1127415  -0.09735349]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.27422974  0.10651592  0.09432908 -0.26349017  0.0148723 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.30590698  0.2288914   0.09439161 -0.35620257  0.00531267]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.12973946  0.12748663  0.04942159 -0.14671241  0.00266339]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.12973946  0.12748663  0.04942159 -0.14671241  0.00266339]
  [FlaxMamba2] B (step) sample values: [-0.09322879  0.00084336  0.03746284  0.03523345 -0.0077202 ]
  [FlaxMamba2] C (step) sample values: [-0.272596   -0.02190196  0.0026489  -0.23699568 -0.27115813]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.0530885  -1.135641   -0.87189615 -1.5713016  -1.7430981 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.46768093 0.34684032 0.15948442 0.50156397 0.20568793]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.61109096 0.67443085 0.8701812  0.45470417 0.6986997 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.12973946  0.12748663  0.04942159 -0.14671241  0.00266339]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.6568128e-03 -5.1172083e-05 -2.2731202e-03 -2.1378486e-03
  4.6843605e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.6568128e-03 -5.1172083e-05 -2.2731202e-03 -2.1378486e-03
  4.6843605e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00701689  0.0007077  -0.0038703  -0.00260816  0.0001993 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0237845   0.02657296  0.01297157 -0.03290422  0.00148662]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.18973485  0.1896417   0.07618695 -0.22056474  0.00489338]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.18973485  0.1896417   0.07618695 -0.22056474  0.00489338]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-1.5989043e-01 -4.5644835e-02 -8.2798274e-03 -3.0704436e-01
 -1.2247286e-06]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-3.4821124e+00 -1.3270286e+00 -2.0782347e-01 -9.3672981e+00
 -3.4695120e-05]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-3.4821124e+00 -1.3270286e+00 -2.0782347e-01 -9.3672981e+00
 -3.4695120e-05]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-12.922589    1.7397615   5.3808146  -1.9122355  -7.0006876]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-12.922589    1.7397615   5.3808146  -1.9122355  -7.0006876]
  [Layer 41] Output shape after mixer: (1, 1, 1024)
  [Layer 41] Output sample values after mixer: [-12.922589    1.7397615   5.3808146  -1.9122355  -7.0006876]
  [Layer 41] Residual connection shape: (1, 1, 1024)
  [Layer 41] Residual connection sample values: [  2.1854582   2.3805647  27.004436  -17.246845  -41.11878  ]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.02167697  0.02537309  0.2863722  -0.17083484 -0.429137  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.02167697  0.02537309  0.2863722  -0.17083484 -0.429137  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.02167697  0.02537309  0.2863722  -0.17083484 -0.429137  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.29332754  1.1889805  -0.68344283 -1.0725698   1.2572603 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.29332754  1.1889805  -0.68344283 -1.0725698   1.2572603 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.7886849   0.02392032 -0.96581507 -0.47155255  0.39117637]
  [FlaxMamba2] dt (step) sample values: [ 0.58139044 -1.3208537   0.8737607   0.68691194  1.3908434 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.8731997 -0.1301969  0.85377    0.7886849  1.9111482]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.17257425  0.01861495  0.20566979  0.09640096  0.09169133]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.19344828 -0.01715165  0.21028939  0.09266065  0.04551823]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.08739764 -0.00850228  0.11615954  0.04847529  0.023277  ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08739764 -0.00850228  0.11615954  0.04847529  0.023277  ]
  [FlaxMamba2] B (step) sample values: [-0.11051466 -0.07520389  0.01997109 -0.03439604 -0.0146795 ]
  [FlaxMamba2] C (step) sample values: [ 0.26418072 -0.01545361 -0.15890643 -0.1824855   0.02691159]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.2458453 -1.7473589 -3.3796544 -1.2264227 -1.3705136]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.17835881 0.03648581 0.2868798  0.04088943 0.28024754]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.6699406  0.93823594 0.37925193 0.9510889  0.68107486]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08739764 -0.00850228  0.11615954  0.04847529  0.023277  ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00172272  0.00117229 -0.00031131  0.00053617  0.00022883]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00172272  0.00117229 -0.00031131  0.00053617  0.00022883]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00268828 0.0010099  0.00336163 0.0005444  0.00060894]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01249189  0.00760292  0.01725926  0.00676682  0.0012151 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.13198346 -0.00402155  0.17607462  0.07304308  0.03303982]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.13198346 -0.00402155  0.17607462  0.07304308  0.03303982]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02217601 -0.00366533 -0.04037224 -0.01997098  0.03234087]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.52268744 -0.08307724 -0.9420892  -0.4721223   0.5207155 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.52268744 -0.08307724 -0.9420892  -0.4721223   0.5207155 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ -3.0775697 -10.641989   -3.273099    1.374614   -1.4243399]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ -3.0775697 -10.641989   -3.273099    1.374614   -1.4243399]
  [Layer 42] Output shape after mixer: (1, 1, 1024)
  [Layer 42] Output sample values after mixer: [ -3.0775697 -10.641989   -3.273099    1.374614   -1.4243399]
  [Layer 42] Residual connection shape: (1, 1, 1024)
  [Layer 42] Residual connection sample values: [ -0.89211154  -8.261424    23.731339   -15.8722315  -42.543118  ]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.00801515 -0.08125205  0.2233807  -0.14250514 -0.38856727]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.00801515 -0.08125205  0.2233807  -0.14250514 -0.38856727]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.00801515 -0.08125205  0.2233807  -0.14250514 -0.38856727]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.4921091   0.97513306 -0.30525064 -0.3498367   0.42222098]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.4921091   0.97513306 -0.30525064 -0.3498367   0.42222098]
  [FlaxMamba2] xBC (step) sample values: [-0.01252129  1.0406868   0.39754358  0.20827603 -0.1506775 ]
  [FlaxMamba2] dt (step) sample values: [ 0.71710676  0.446258   -0.6316002   0.34125093 -0.20958585]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.20666319  0.2407873  -0.4484206  -0.01252129  0.27577215]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01138048 -0.14783148 -0.08129673  0.02503638 -0.03079245]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02597551 -0.20206122 -0.10931187 -0.02278466 -0.03910849]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.01281908 -0.09085801 -0.05167164 -0.01126255 -0.01917193]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01281908 -0.09085801 -0.05167164 -0.01126255 -0.01917193]
  [FlaxMamba2] B (step) sample values: [ 0.01142577  0.02513248  0.19354358 -0.25661823  0.32401258]
  [FlaxMamba2] C (step) sample values: [-0.1165916  -0.01211998  0.51030487 -0.2531885  -0.07074133]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-3.7045815 -2.655313  -8.210951  -2.2381823 -4.092597 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.12238666 0.12133918 0.03375059 0.46891564 0.00103821]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.6354694  0.724558   0.75796014 0.3501062  0.9957601 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01281908 -0.09085801 -0.05167164 -0.01126255 -0.01917193]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.7925724e-05 -3.9429960e-05 -3.0364760e-04  4.0260446e-04
 -5.0833839e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.7925724e-05 -3.9429960e-05 -3.0364760e-04  4.0260446e-04
 -5.0833839e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00010522 -0.00029009 -0.0002257   0.00102968 -0.00107272]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00058603 -0.00442155 -0.00238553  0.00031304 -0.00018515]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02172958 -0.15428102 -0.08761174 -0.0182632  -0.03180696]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02172958 -0.15428102 -0.08761174 -0.0182632  -0.03180696]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00595302 -0.109244    0.0113466   0.00264141 -0.00811165]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.14296946 -3.5153553   0.29226184  0.06851565 -0.21747127]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.14296946 -3.5153553   0.29226184  0.06851565 -0.21747127]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-5.5169225  8.861252  -3.8245378  4.3657994  3.187526 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-5.5169225  8.861252  -3.8245378  4.3657994  3.187526 ]
  [Layer 43] Output shape after mixer: (1, 1, 1024)
  [Layer 43] Output sample values after mixer: [-5.5169225  8.861252  -3.8245378  4.3657994  3.187526 ]
  [Layer 43] Residual connection shape: (1, 1, 1024)
  [Layer 43] Residual connection sample values: [ -6.409034     0.59982777  19.906801   -11.506432   -39.35559   ]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.05463548  0.00528779  0.17595163 -0.09588156 -0.33961633]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05463548  0.00528779  0.17595163 -0.09588156 -0.33961633]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05463548  0.00528779  0.17595163 -0.09588156 -0.33961633]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.8975474   0.15807816 -0.69490963 -0.11595195  0.8214069 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.8975474   0.15807816 -0.69490963 -0.11595195  0.8214069 ]
  [FlaxMamba2] xBC (step) sample values: [-0.7955969  -0.84187806 -0.44527322 -0.49046186  0.43337515]
  [FlaxMamba2] dt (step) sample values: [-0.01670207  0.8325904   1.6327628   0.63649815  1.0509852 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.08247381 -0.47152138  0.2909551  -0.7955969  -0.70617676]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.16382432  0.18183663 -0.06420746  0.08686744  0.07635635]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.14233994  0.12476876 -0.09293976  0.07371437  0.0829863 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.06611335  0.06627116 -0.04431198  0.03821502  0.04321384]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06611335  0.06627116 -0.04431198  0.03821502  0.04321384]
  [FlaxMamba2] B (step) sample values: [ 0.14829436 -0.21357499 -0.23374127 -0.02740462  0.23247063]
  [FlaxMamba2] C (step) sample values: [ 0.11229949 -0.27756557 -0.18291748 -0.04403448 -0.0556606 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-4.6876054  -0.9752563  -0.82549465 -1.2937802  -0.49527767]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.09771287 0.09933236 0.11967408 0.08406692 0.02202633]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.6325226  0.9076699  0.90593266 0.89694196 0.98915017]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06611335  0.06627116 -0.04431198  0.03821502  0.04321384]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.000958    0.00137972  0.00151     0.00017704 -0.00150179]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.000958    0.00137972  0.00151     0.00017704 -0.00150179]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00137717  0.0012364   0.00134609  0.0004968  -0.00128183]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00288672  0.00184894 -0.00148686  0.00123753  0.00136939]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.11778124  0.11701771 -0.07849407  0.06764919  0.07646821]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.11778124  0.11701771 -0.07849407  0.06764919  0.07646821]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.07510419  0.00997848  0.01816074 -0.0036949   0.04362479]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-1.92728     0.23449075  0.5408775  -0.09458648  1.095049  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-1.92728     0.23449075  0.5408775  -0.09458648  1.095049  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.4433868 11.20484    1.6672279  0.5653986 -8.802985 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.4433868 11.20484    1.6672279  0.5653986 -8.802985 ]
  [Layer 44] Output shape after mixer: (1, 1, 1024)
  [Layer 44] Output sample values after mixer: [-2.4433868 11.20484    1.6672279  0.5653986 -8.802985 ]
  [Layer 44] Residual connection shape: (1, 1, 1024)
  [Layer 44] Residual connection sample values: [ -8.852421  11.804667  21.57403  -10.941033 -48.158577]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.0862779   0.12421344  0.22091074 -0.10699798 -0.47550625]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0862779   0.12421344  0.22091074 -0.10699798 -0.47550625]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0862779   0.12421344  0.22091074 -0.10699798 -0.47550625]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.0326293  -2.486428   -0.8764312  -0.63618535 -1.1555418 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.0326293  -2.486428   -0.8764312  -0.63618535 -1.1555418 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.30722773  1.3222003  -0.7466955   0.31846806 -0.2304428 ]
  [FlaxMamba2] dt (step) sample values: [ 0.19342035 -1.1156126   0.0916229  -0.32940117  0.14129543]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.21397868  1.3553896  -0.18906733  0.30722773  1.0251502 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04946431  0.14849979 -0.1423737  -0.06765482 -0.03338797]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0438033   0.40655643 -0.16466679 -0.12365457 -0.04413779]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.02238125  0.24404033 -0.07556988 -0.05800954 -0.02158194]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02238125  0.24404033 -0.07556988 -0.05800954 -0.02158194]
  [FlaxMamba2] B (step) sample values: [-0.0982442   0.07229504 -0.02857397 -0.16921657 -0.04588265]
  [FlaxMamba2] C (step) sample values: [-0.19965665 -0.08205161 -0.16349016 -0.08528388 -0.16677383]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.3039274e+00 -3.9384812e-02 -6.8873577e+00 -8.0558503e-01
 -1.9935181e+03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00269246 0.00611392 0.00846355 0.0004525  0.02199396]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.9649537e-01 9.9975926e-01 9.4337493e-01 9.9963552e-01 9.0824328e-20]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02238125  0.24404033 -0.07556988 -0.05800954 -0.02158194]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.9202503e-06  4.3565396e-06 -1.7218833e-06 -1.0197085e-05
 -2.7649141e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.9202503e-06  4.3565396e-06 -1.7218833e-06 -1.0197085e-05
 -2.7649141e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00166612 0.00097053 0.00123028 0.00018433 0.00163354]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00182299  0.03146844 -0.00682197 -0.00922548  0.00475526]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.05626337  0.6648295  -0.20294946 -0.15977839 -0.05125663]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.05626337  0.6648295  -0.20294946 -0.15977839 -0.05125663]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.04284382 -0.12697929  0.05227954  0.03518156  0.0141841 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.59140337 -1.3150296   0.6464338   0.41203234  0.19924368]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.59140337 -1.3150296   0.6464338   0.41203234  0.19924368]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.3398042 -0.6091944  1.0892452 -7.2208524 -7.0199037]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.3398042 -0.6091944  1.0892452 -7.2208524 -7.0199037]
  [Layer 45] Output shape after mixer: (1, 1, 1024)
  [Layer 45] Output sample values after mixer: [ 3.3398042 -0.6091944  1.0892452 -7.2208524 -7.0199037]
  [Layer 45] Residual connection shape: (1, 1, 1024)
  [Layer 45] Residual connection sample values: [ -5.5126166  11.195473   22.663275  -18.161886  -55.178482 ]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.04798498  0.10480888  0.20791207 -0.16093315 -0.47541294]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.04798498  0.10480888  0.20791207 -0.16093315 -0.47541294]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.04798498  0.10480888  0.20791207 -0.16093315 -0.47541294]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.47105163 -1.115187   -0.21400353  0.3301419  -0.3995454 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.47105163 -1.115187   -0.21400353  0.3301419  -0.3995454 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.3864614  -0.01227555  1.6047864   0.03042758  0.5349973 ]
  [FlaxMamba2] dt (step) sample values: [ 0.64888126  0.02654996  1.4141355  -0.4562723   0.9682958 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [0.992865   0.32960883 1.3960607  0.3864614  0.5156348 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.07061648  0.00134503  0.3167412  -0.00523882 -0.08719999]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01516604 -0.03597797  0.5196221  -0.00073748 -0.09245282]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.00752552 -0.01766541  0.32583392 -0.0003686  -0.04409105]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00752552 -0.01766541  0.32583392 -0.0003686  -0.04409105]
  [FlaxMamba2] B (step) sample values: [-0.22423746 -0.04497547  0.00398631 -0.02139898 -0.11107221]
  [FlaxMamba2] C (step) sample values: [-0.02229876  0.21399283 -0.12229948 -0.04100779 -0.07930576]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.4426116  -0.9829804 -10.158994   -1.363838   -1.7559118]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01673976 0.01431793 0.00447872 0.0082921  0.02839449]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.97614026 0.9860243  0.9555203  0.98875463 0.9513643 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00752552 -0.01766541  0.32583392 -0.0003686  -0.04409105]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.8248385e-05  5.6657996e-06 -5.0217687e-07  2.6957437e-06
  1.3992357e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.8248385e-05  5.6657996e-06 -5.0217687e-07  2.6957437e-06
  1.3992357e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.4895356e-03  3.1461427e-04 -4.3375130e-05  4.0553202e-04
 -8.0664997e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-6.0264172e-04 -4.1414573e-06  2.5806471e-03  3.8439644e-04
  4.5420721e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-9.8222941e-03 -2.1646371e-02  4.0176588e-01 -6.7187211e-05
 -5.3562570e-02]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-9.8222941e-03 -2.1646371e-02  4.0176588e-01 -6.7187211e-05
 -5.3562570e-02]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 1.7783940e-03  5.9602289e-03 -3.8407166e-02 -1.2904953e-05
  8.5906945e-03]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 7.4160360e-02  2.3107351e-01 -1.2701676e+00 -4.2252513e-04
  2.8111324e-01]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 7.4160360e-02  2.3107351e-01 -1.2701676e+00 -4.2252513e-04
  2.8111324e-01]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 12.507229   13.560635   -3.6131432  -3.145245  -10.144252 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 12.507229   13.560635   -3.6131432  -3.145245  -10.144252 ]
  [Layer 46] Output shape after mixer: (1, 1, 1024)
  [Layer 46] Output sample values after mixer: [ 12.507229   13.560635   -3.6131432  -3.145245  -10.144252 ]
  [Layer 46] Residual connection shape: (1, 1, 1024)
  [Layer 46] Residual connection sample values: [  6.994612  24.756107  19.05013  -21.30713  -65.32273 ]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.05103985  0.18834832  0.14197281 -0.14677763 -0.47697908]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.05103985  0.18834832  0.14197281 -0.14677763 -0.47697908]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.05103985  0.18834832  0.14197281 -0.14677763 -0.47697908]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.15131971  0.6000058  -0.87098837 -1.4273659  -0.0997947 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.15131971  0.6000058  -0.87098837 -1.4273659  -0.0997947 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.26967475  0.4964663   0.9431233  -0.58756644 -0.63634044]
  [FlaxMamba2] dt (step) sample values: [-0.2082769   1.1651994   0.91740626  1.9097376  -0.18859063]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.1729769   0.17930436 -0.7105696   0.26967475  0.01186873]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.04137499  0.08643045  0.18261911  0.10599781 -0.10274589]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.05429918  0.10151376  0.18150522  0.1127956  -0.10465991]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.02641267  0.05333093  0.09896611  0.05957514 -0.04959403]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02641267  0.05333093  0.09896611  0.05957514 -0.04959403]
  [FlaxMamba2] B (step) sample values: [-0.03104581  0.03865707  0.00368    -0.06453054 -0.11557034]
  [FlaxMamba2] C (step) sample values: [-0.27793586 -0.2200296   0.47418883 -0.2012872  -0.26393116]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-5.7667141e+01 -2.2024069e+00 -3.8371372e+00 -4.6045512e-02
 -2.0699801e+00]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03777707 0.01417945 0.03211166 0.114034   0.00337865]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.11321174 0.96925366 0.88407195 0.994763   0.99303067]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02641267  0.05333093  0.09896611  0.05957514 -0.04959403]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.09773059e-05 -3.85717685e-05 -3.67187818e-06  6.43881358e-05
  1.15315306e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.09773059e-05 -3.85717685e-05 -3.67187818e-06  6.43881358e-05
  1.15315306e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 3.7671780e-04 -1.1111053e-05 -2.7191145e-05 -4.7758549e-05
 -3.5410008e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00011551  0.00104239  0.00174257  0.00130642 -0.0004529 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04150551  0.08508114  0.15769312  0.09518479 -0.07860305]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04150551  0.08508114  0.15769312  0.09518479 -0.07860305]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00290316  0.03296029 -0.0405246  -0.02629087  0.00372655]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.10211469  1.2827663  -1.4457964  -1.3434495   0.15366004]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.10211469  1.2827663  -1.4457964  -1.3434495   0.15366004]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-15.561388   46.204445   -3.3850257  -6.2630095 -20.870953 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-15.561388   46.204445   -3.3850257  -6.2630095 -20.870953 ]
  [Layer 47] Output shape after mixer: (1, 1, 1024)
  [Layer 47] Output sample values after mixer: [-15.561388   46.204445   -3.3850257  -6.2630095 -20.870953 ]
  [Layer 47] Residual connection shape: (1, 1, 1024)
  [Layer 47] Residual connection sample values: [ -8.566776  70.960556  15.665105 -27.57014  -86.19368 ]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.05146592  0.45995206  0.10034201 -0.16153167 -0.53582984]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05146592  0.45995206  0.10034201 -0.16153167 -0.53582984]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05146592  0.45995206  0.10034201 -0.16153167 -0.53582984]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.70439166 -1.5074915  -0.64279455 -1.1394227   0.17285211]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.70439166 -1.5074915  -0.64279455 -1.1394227   0.17285211]
  [FlaxMamba2] xBC (step) sample values: [ 0.5809656   0.8314233  -0.60227317 -0.6722852  -0.5260717 ]
  [FlaxMamba2] dt (step) sample values: [ 0.33707616 -3.5215516   0.27702582  1.8518953   0.373741  ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [0.6851481 1.5800574 0.2602709 0.5809656 0.5532855]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.09329355  0.13069014 -0.06974398 -0.07879761 -0.08283705]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.08933389  0.10017256 -0.08178316 -0.15887573 -0.16511244]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.04267313  0.05259283 -0.03922039 -0.07314073 -0.07575613]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04267313  0.05259283 -0.03922039 -0.07314073 -0.07575613]
  [FlaxMamba2] B (step) sample values: [-0.00854536  0.25988215 -0.25165826 -0.0350705  -0.08863298]
  [FlaxMamba2] C (step) sample values: [-0.08672266 -0.04363468 -0.27295506 -0.04604188  0.03737554]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.7303779  -7.389056   -3.3796544  -1.802826  -17.760078 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.6052378e-02 6.3511998e-06 8.4458906e-03 1.1710012e-01 1.3516700e-01]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9726055  0.9999531  0.97185934 0.80968404 0.09066566]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04267313  0.05259283 -0.03922039 -0.07314073 -0.07575613]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.8536170e-06 -1.7802065e-04  1.7238724e-04  2.4023479e-05
  6.0714057e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.8536170e-06 -1.7802065e-04  1.7238724e-04  2.4023479e-05
  6.0714057e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.7578565e-04  4.9915456e-04  8.6190482e-04 -2.2174789e-04
 -2.1870419e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00041164  0.0011277  -0.00137364 -0.00653945 -0.00448683]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0611076   0.07593288 -0.0571586  -0.11057088 -0.11223824]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0611076   0.07593288 -0.0571586  -0.11057088 -0.11223824]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01424054 -0.02075432  0.01266158  0.03054256 -0.01053659]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.8824541  -1.4404869   0.8321357   1.766546   -0.82982326]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.8824541  -1.4404869   0.8321357   1.766546   -0.82982326]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 4.1555247 79.427605  -4.747313   9.214938  -4.1024494]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 4.1555247 79.427605  -4.747313   9.214938  -4.1024494]
  [Layer 48] Output shape after mixer: (1, 1, 1024)
  [Layer 48] Output sample values after mixer: [ 4.1555247 79.427605  -4.747313   9.214938  -4.1024494]
  [Layer 48] Residual connection shape: (1, 1, 1024)
  [Layer 48] Residual connection sample values: [ -4.4112515 150.38815    10.917791  -18.355202  -90.29613  ]
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.05486802  2.7023132   0.15536392 -0.20619397 -1.1552715 ]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 1, 1024)
[Mamba2LMHeadModel] Final backbone norm output sample values: [-0.05486802  2.7023132   0.15536392 -0.20619397 -1.1552715 ]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 1, 50288)
[Mamba2LMHeadModel] Logits sample values: [-37.721157 -47.055042 -37.993614 -39.945953 -40.22112 ]
[Mamba2LMHeadModel] Forward pass input_ids shape: (1, 1)
[Mamba2LMHeadModel] input_ids sample values: [512]
[Mamba2LMHeadModel] Embedding output shape: (1, 1, 1024)
[Mamba2LMHeadModel] Embedding sample values: [ 0.17480469 -0.04608154 -0.00367355 -0.3881836  -0.02224731]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.2345787  -0.07869848 -0.00540614 -0.44514188 -0.02795654]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.2345787  -0.07869848 -0.00540614 -0.44514188 -0.02795654]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.2345787  -0.07869848 -0.00540614 -0.44514188 -0.02795654]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.3896881   0.33785543  0.19633667  0.01530148 -0.1338203 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.3896881   0.33785543  0.19633667  0.01530148 -0.1338203 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.7266964   0.6819766  -0.8611564  -0.21285188  0.5517476 ]
  [FlaxMamba2] dt (step) sample values: [ 0.14677338  0.1782708   0.14879192  0.22366793 -0.15257332]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.27020603  0.53985476  0.01573907  0.7266964  -0.5520917 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-3.7521403e-03 -2.2940338e-05 -5.3315125e-03  7.5721294e-02
  1.5553890e-02]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03881988 -0.00761419  0.10740042 -0.13375136 -0.18158966]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.01978664 -0.0037926   0.05658115 -0.06240998 -0.08257371]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01978664 -0.0037926   0.05658115 -0.06240998 -0.08257371]
  [FlaxMamba2] B (step) sample values: [-0.2657411   0.0699373  -0.00874783  0.6454165   0.11668478]
  [FlaxMamba2] C (step) sample values: [-0.26000825 -0.03358771 -0.12188548 -0.25146386 -0.16028665]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.4383634 -1.0010935 -1.2128745 -1.1529616 -1.4844131]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06425466 0.04038974 0.02819909 0.03253444 0.01930488]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9722261 0.9603726 0.9663763 0.9631839 0.9717503]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01978664 -0.0037926   0.05658115 -0.06240998 -0.08257371]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.3785892e-04  8.8917150e-05 -1.1121845e-05  8.2057202e-04
  1.4835113e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.3785892e-04  8.8917150e-05 -1.1121845e-05  8.2057202e-04
  1.4835113e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0185595  -0.00372868 -0.00062649  0.04470882 -0.0004885 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.48416874  0.0364498   1.1182209  -1.6993364  -1.4402364 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.5181041   0.02994525  1.2152611  -1.8063734  -1.5818555 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.5181041   0.02994525  1.2152611  -1.8063734  -1.5818555 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.08152528  0.00590508  0.13097419 -0.01392582  0.09877081]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01193393  0.00071342  0.01581306 -0.00137866  0.05006769]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01193393  0.00071342  0.01581306 -0.00137866  0.05006769]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.01799368  0.52030975 -0.05663987  0.321029   -0.03478375]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.01799368  0.52030975 -0.05663987  0.321029   -0.03478375]
  [Layer 1] Output shape after mixer: (1, 1, 1024)
  [Layer 1] Output sample values after mixer: [ 0.01799368  0.52030975 -0.05663987  0.321029   -0.03478375]
  [Layer 1] Residual connection shape: (1, 1, 1024)
  [Layer 1] Residual connection sample values: [ 0.19279838  0.4742282  -0.06031342 -0.06715459 -0.05703106]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.2380767   0.4917949  -0.0577314  -0.08720168 -0.06411445]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.2380767   0.4917949  -0.0577314  -0.08720168 -0.06411445]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.2380767   0.4917949  -0.0577314  -0.08720168 -0.06411445]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.73024    -1.8446745  -0.08660392  3.100701   -1.6571285 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.73024    -1.8446745  -0.08660392  3.100701   -1.6571285 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.432084   -0.35968962  0.49213648 -3.481321    0.19772367]
  [FlaxMamba2] dt (step) sample values: [0.4897503  3.3649719  0.5058167  0.9106641  0.53862363]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.0932317  -0.63347316  0.662316    1.432084   -1.2537892 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03578375 -0.07707292 -0.40015155 -0.24405283  0.16893908]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04511449 -0.1069954  -0.51196796 -0.3880958   0.172317  ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.02204851 -0.05063843 -0.19185092 -0.15685892  0.09356347]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02204851 -0.05063843 -0.19185092 -0.15685892  0.09356347]
  [FlaxMamba2] B (step) sample values: [ 0.05239911  0.03842501  0.04041432 -0.07629869  0.07779305]
  [FlaxMamba2] C (step) sample values: [-0.13189001  0.07523271  0.7442467  -0.05565526 -0.0616779 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-12.692555   -19.429585    -0.22886811  -2.10566     -5.0388985 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08095275 0.70776975 0.04052166 0.14910619 0.09525672]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [3.5790157e-01 1.0659205e-06 9.9076873e-01 7.3054320e-01 6.1879027e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02204851 -0.05063843 -0.19185092 -0.15685892  0.09356347]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.3526491e-05 -6.8584304e-05 -7.2135001e-05  1.3618455e-04
 -1.3885181e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.3526491e-05 -6.8584304e-05 -7.2135001e-05  1.3618455e-04
 -1.3885181e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-9.8352219e-05  6.3617561e-05 -1.8324913e-04  6.2106119e-06
 -8.1374252e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00014706  0.00158197  0.0014119   0.00287401 -0.00161831]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01455106 -0.03217496 -0.12648106 -0.10169233  0.0607536 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01455106 -0.03217496 -0.12648106 -0.10169233  0.0607536 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00345488  0.00810156  0.00523987 -0.30173418 -0.01612313]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00113281  0.00373448  0.00218616 -0.08289368 -0.00773045]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00113281  0.00373448  0.00218616 -0.08289368 -0.00773045]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.04622214  0.12019932 -0.00389952  0.13344628 -0.10355673]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.04622214  0.12019932 -0.00389952  0.13344628 -0.10355673]
  [Layer 2] Output shape after mixer: (1, 1, 1024)
  [Layer 2] Output sample values after mixer: [-0.04622214  0.12019932 -0.00389952  0.13344628 -0.10355673]
  [Layer 2] Residual connection shape: (1, 1, 1024)
  [Layer 2] Residual connection sample values: [ 0.14657624  0.5944275  -0.06421295  0.06629169 -0.16058779]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.2492675   0.84827775 -0.08162402  0.12066136 -0.2606542 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.2492675   0.84827775 -0.08162402  0.12066136 -0.2606542 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.2492675   0.84827775 -0.08162402  0.12066136 -0.2606542 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.1771413  -0.8005201  -1.8620656  -0.81958044 -1.8524045 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.1771413  -0.8005201  -1.8620656  -0.81958044 -1.8524045 ]
  [FlaxMamba2] xBC (step) sample values: [-0.11297893  1.192221   -0.831558   -0.41328493  0.42804876]
  [FlaxMamba2] dt (step) sample values: [1.3088951 1.484517  0.7842914 1.2651677 1.1513604]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.15875363 -2.017992    2.5471575  -0.11297893  2.0471895 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.3103947  -0.14220367 -0.09694745 -0.2761102  -0.6124473 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.26553386 -0.21996246 -0.14806439 -0.32274106 -0.6792808 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.15029114 -0.0979339  -0.06856142 -0.13555378 -0.2285249 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.15029114 -0.0979339  -0.06856142 -0.13555378 -0.2285249 ]
  [FlaxMamba2] B (step) sample values: [-0.17157395 -0.05450196 -0.06915703 -0.01574339 -0.25197718]
  [FlaxMamba2] C (step) sample values: [-0.26861557  0.32641608  0.38998166  0.36483613  0.21127261]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-20.926485    -0.880345    -0.67350245  -0.6461216   -0.27258503]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [4.5723297e-02 2.1190090e-02 9.8685698e-05 1.8424779e-02 3.2221988e-02]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.38410938 0.9815183  0.99993354 0.9881659  0.9912552 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.15029114 -0.0979339  -0.06856142 -0.13555378 -0.2285249 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00117902 -0.00037453 -0.00047523 -0.00010819 -0.00173154]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00117902 -0.00037453 -0.00047523 -0.00010819 -0.00173154]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00095161 -0.00059657 -0.00087673 -0.00014043 -0.00149884]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 6.7111105e-03  9.2635737e-06  7.1173074e-04 -1.3227108e-02
 -2.5817161e-02]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.1134037  -0.06951461 -0.04796043 -0.10945755 -0.18804836]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.1134037  -0.06951461 -0.04796043 -0.10945755 -0.18804836]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0314463   0.01724606  0.01200823  0.02743782  0.04723193]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00566721  0.00277288  0.00152525  0.00387828  0.00992149]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00566721  0.00277288  0.00152525  0.00387828  0.00992149]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.08220825  0.07493899  0.04184848 -0.07545129  0.05278666]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.08220825  0.07493899  0.04184848 -0.07545129  0.05278666]
  [Layer 3] Output shape after mixer: (1, 1, 1024)
  [Layer 3] Output sample values after mixer: [-0.08220825  0.07493899  0.04184848 -0.07545129  0.05278666]
  [Layer 3] Residual connection shape: (1, 1, 1024)
  [Layer 3] Residual connection sample values: [ 0.06436799  0.66936654 -0.02236447 -0.0091596  -0.10780113]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.07229855  0.65113324 -0.02048047 -0.01093862 -0.11393078]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.07229855  0.65113324 -0.02048047 -0.01093862 -0.11393078]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.07229855  0.65113324 -0.02048047 -0.01093862 -0.11393078]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.97710156  0.17644492  0.5922148  -1.4735034   0.11526787]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.97710156  0.17644492  0.5922148  -1.4735034   0.11526787]
  [FlaxMamba2] xBC (step) sample values: [-0.72604185  0.89185596  0.46674916  0.33004475 -0.749648  ]
  [FlaxMamba2] dt (step) sample values: [1.3771379 1.0063416 1.160478  1.2221584 0.8768066]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.334062   -0.80816627 -0.73858327 -0.72604185  0.64326775]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.15663959 -0.10737281 -0.10998257 -0.09762791  0.28059816]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.17868854 -0.09481482 -0.15038784 -0.16232517  0.53963137]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.09730549 -0.04516163 -0.06955042 -0.07458964  0.34089953]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.09730549 -0.04516163 -0.06955042 -0.07458964  0.34089953]
  [FlaxMamba2] B (step) sample values: [-0.27798975 -0.12225317  0.08626214  0.05042171 -0.10447844]
  [FlaxMamba2] C (step) sample values: [-0.27419344  0.42514917  0.51277417 -0.07000029  0.20831537]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.49070406 -0.5047996  -0.6491257  -0.5552266  -0.46572492]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.16733243 0.14883234 0.24512368 0.1282722  0.6623145 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.92117    0.92762244 0.85289735 0.9312569  0.73458004]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.09730549 -0.04516163 -0.06955042 -0.07458964  0.34089953]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00452633 -0.00199057  0.00140455  0.00082098 -0.00170116]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00452633 -0.00199057  0.00140455  0.00082098 -0.00170116]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.03294618 -0.004999   -0.00011072  0.00239297 -0.00134734]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.11338867  0.04741301  0.01292627 -0.33562154  0.50342155]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.17793632  0.01745502 -0.03321003 -0.3851006   0.7295574 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.17793632  0.01745502 -0.03321003 -0.3851006   0.7295574 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.12631632  0.00167543 -0.01266336  0.1057782   0.04446793]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04910146  0.00069942 -0.00441491  0.04061128  0.01243166]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04910146  0.00069942 -0.00441491  0.04061128  0.01243166]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.2634248   0.43078062  0.18987375 -0.17500101  0.29117578]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.2634248   0.43078062  0.18987375 -0.17500101  0.29117578]
  [Layer 4] Output shape after mixer: (1, 1, 1024)
  [Layer 4] Output sample values after mixer: [-0.2634248   0.43078062  0.18987375 -0.17500101  0.29117578]
  [Layer 4] Residual connection shape: (1, 1, 1024)
  [Layer 4] Residual connection sample values: [-0.19905683  1.1001471   0.16750929 -0.18416062  0.18337464]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.22970691  1.0703117   0.14243889 -0.21189013  0.20074862]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.22970691  1.0703117   0.14243889 -0.21189013  0.20074862]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.22970691  1.0703117   0.14243889 -0.21189013  0.20074862]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.770845   -0.22419256 -0.10938484  1.2828072   1.3822193 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.770845   -0.22419256 -0.10938484  1.2828072   1.3822193 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.0947375  -0.65005153 -1.7781086   1.3355196  -0.16244102]
  [FlaxMamba2] dt (step) sample values: [2.4521613 2.3530195 1.1471378 1.7592962 1.7386804]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6285468 -2.4791298  0.2688788  1.0947375 -6.2605433]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.11865015 -2.456067   -0.95229745 -0.27074718  0.00815016]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.05529565 -2.6974     -0.9596484  -0.24387646  0.01909071]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.02841203 -0.17027862 -0.26577327 -0.10714255  0.00963647]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02841203 -0.17027862 -0.26577327 -0.10714255  0.00963647]
  [FlaxMamba2] B (step) sample values: [-0.12147602  0.25055116 -0.23424536 -0.15739892 -0.04518276]
  [FlaxMamba2] C (step) sample values: [-0.03976364  0.12517907 -0.21916556 -0.17213793 -0.19764404]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.07591622 -0.53187454 -0.04695368 -1.4938657  -3.6258397 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.092262   0.13825919 0.11164752 0.07900236 0.08897343]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9204244  0.9291022  0.9947715  0.88867927 0.72426105]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02841203 -0.17027862 -0.26577327 -0.10714255  0.00963647]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00376981  0.00777545 -0.00726943 -0.00488462 -0.00140217]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00376981  0.00777545 -0.00726943 -0.00488462 -0.00140217]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.1023463e-02  7.2957994e-04  5.1407546e-01  5.4188099e-02
 -1.5975314e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-1.746506   -1.8052223  -1.4123558  -0.48985088 -0.6979951 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-1.706522  -2.0448542 -1.7863765 -0.6406318 -0.6844338]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-1.706522  -2.0448542 -1.7863765 -0.6406318 -0.6844338]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.41607642  0.20363285  0.09236307 -0.64341515 -0.7562125 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01209108  0.00625404  0.00580817 -0.04446524 -0.05680484]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01209108  0.00625404  0.00580817 -0.04446524 -0.05680484]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.08006442 -0.23239565 -0.11778014 -0.13234486  0.2619627 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.08006442 -0.23239565 -0.11778014 -0.13234486  0.2619627 ]
  [Layer 5] Output shape after mixer: (1, 1, 1024)
  [Layer 5] Output sample values after mixer: [ 0.08006442 -0.23239565 -0.11778014 -0.13234486  0.2619627 ]
  [Layer 5] Residual connection shape: (1, 1, 1024)
  [Layer 5] Residual connection sample values: [-0.11899242  0.8677515   0.04972915 -0.3165055   0.44533736]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.11583997  0.6978716   0.03773595 -0.2953932   0.38732573]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.11583997  0.6978716   0.03773595 -0.2953932   0.38732573]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.11583997  0.6978716   0.03773595 -0.2953932   0.38732573]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.918311  -1.0086894 -0.510167  -3.4160628 -3.9732876]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-2.918311  -1.0086894 -0.510167  -3.4160628 -3.9732876]
  [FlaxMamba2] xBC (step) sample values: [ 0.9053893 -1.4638896 -1.2688688 -1.256561   1.2456809]
  [FlaxMamba2] dt (step) sample values: [1.8771603 2.5916464 1.8316525 2.0924501 1.9142754]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.3851976   0.18457492  0.3887714   0.9053893  -0.87124074]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.08076845 -0.10609469 -0.35864532 -0.23655325  0.12186475]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.12800966 -0.09210238 -0.27740753 -0.24823385  0.26004833]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.0599138  -0.04393198 -0.11958746 -0.10879053  0.1468358 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0599138  -0.04393198 -0.11958746 -0.10879053  0.1468358 ]
  [FlaxMamba2] B (step) sample values: [ 0.00205917  0.14826375 -0.2311971   0.02245421  0.08995906]
  [FlaxMamba2] C (step) sample values: [ 0.05255527  0.12738517 -0.25041816 -0.13550162  0.07536362]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.5109995  -0.28622514 -0.5421001  -0.39544863 -0.5985869 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.72046965 0.9727681  0.42247668 0.79110855 0.5168741 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.6920067  0.7569707  0.79530895 0.73136485 0.7338915 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0599138  -0.04393198 -0.11958746 -0.10879053  0.1468358 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-8.8886169e-05 -6.3999635e-03  9.9798711e-03 -9.6926012e-04
 -3.8831793e-03]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-8.8886169e-05 -6.3999635e-03  9.9798711e-03 -9.6926012e-04
 -3.8831793e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00394782 -0.00980419  0.00064611  0.005674    0.00500199]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.06387532 -0.02742758 -0.07246882  0.02527042  0.22715124]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0048488  -0.07781976 -0.20964164 -0.09951776  0.39557928]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0048488  -0.07781976 -0.20964164 -0.09951776  0.39557928]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00072528  0.02097698  0.0401236   0.01080975 -0.02902103]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00014198  0.00392977  0.00714688  0.00236803 -0.00462675]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00014198  0.00392977  0.00714688  0.00236803 -0.00462675]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.061591   -0.0109749   0.06275815  0.03898293  0.08585967]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.061591   -0.0109749   0.06275815  0.03898293  0.08585967]
  [Layer 6] Output shape after mixer: (1, 1, 1024)
  [Layer 6] Output sample values after mixer: [ 0.061591   -0.0109749   0.06275815  0.03898293  0.08585967]
  [Layer 6] Residual connection shape: (1, 1, 1024)
  [Layer 6] Residual connection sample values: [-0.05740141  0.8567766   0.11248729 -0.27752256  0.531197  ]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.05387165  0.6530881   0.0832666  -0.26290256  0.43232882]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05387165  0.6530881   0.0832666  -0.26290256  0.43232882]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05387165  0.6530881   0.0832666  -0.26290256  0.43232882]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.1480882   0.4472349   0.33472574 -2.8472428  -3.960729  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.1480882   0.4472349   0.33472574 -2.8472428  -3.960729  ]
  [FlaxMamba2] xBC (step) sample values: [-2.6795866  -1.152298   -1.3613515  -1.0838367  -0.95641273]
  [FlaxMamba2] dt (step) sample values: [0.39991695 2.381409   0.71107405 1.3188813  1.4965346 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.9644709 -2.875366  -3.0653458 -2.6795866 -1.9667164]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.6751121  -0.2435579  -0.14826146 -0.16400671 -0.0240928 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.7087425  -0.31484696 -0.2792429  -0.15553808 -0.02683748]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.2337977  -0.13284405 -0.120253   -0.07173318 -0.01323869]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.2337977  -0.13284405 -0.120253   -0.07173318 -0.01323869]
  [FlaxMamba2] B (step) sample values: [-0.09525991  0.17471018  0.03065917  0.08901451  0.01816263]
  [FlaxMamba2] C (step) sample values: [ 0.06553796 -0.01813096  0.11315329 -0.02651558 -0.00801808]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-6.5957151e-02 -4.5478220e+00 -5.8281250e+00 -4.2033669e-01
 -1.9005252e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.67429274 0.31079146 0.07263291 0.44407916 0.6692462 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.95650005 0.24330871 0.6548732  0.8297235  0.9987289 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.2337977  -0.13284405 -0.120253   -0.07173318 -0.01323869]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01501754 -0.02754273 -0.00483336 -0.01403297 -0.0028633 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01501754 -0.02754273 -0.00483336 -0.01403297 -0.0028633 ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.10896277  0.01016354 -0.02254115  0.0018924   0.09182078]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.2878065  -0.15997142 -0.31545398  0.2188548   0.01564882]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.82987905 -0.46797746 -0.594267    0.05253756 -0.01504579]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.82987905 -0.46797746 -0.594267    0.05253756 -0.01504579]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.22946471 -0.12766662 -0.11595015 -0.00820097  0.00111397]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0508168  -0.03412154 -0.01858145 -0.00159193  0.00047322]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0508168  -0.03412154 -0.01858145 -0.00159193  0.00047322]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.17552762  0.17760028  0.44320428 -0.05036163  0.1793316 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.17552762  0.17760028  0.44320428 -0.05036163  0.1793316 ]
  [Layer 7] Output shape after mixer: (1, 1, 1024)
  [Layer 7] Output sample values after mixer: [ 0.17552762  0.17760028  0.44320428 -0.05036163  0.1793316 ]
  [Layer 7] Residual connection shape: (1, 1, 1024)
  [Layer 7] Residual connection sample values: [ 0.1181262  1.0343769  0.5556916 -0.3278842  0.7105286]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.12888755  0.8448708   0.4241419  -0.34843138  0.6496797 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.12888755  0.8448708   0.4241419  -0.34843138  0.6496797 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.12888755  0.8448708   0.4241419  -0.34843138  0.6496797 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.25790226 -1.3634518   0.9806625  -2.1745234  -1.1545959 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.25790226 -1.3634518   0.9806625  -2.1745234  -1.1545959 ]
  [FlaxMamba2] xBC (step) sample values: [-0.8657562 -2.1259277 -2.3590283  2.424108  -3.260128 ]
  [FlaxMamba2] dt (step) sample values: [2.8010888 4.1135902 2.9792216 2.430224  3.191254 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.6701803   0.11993328 -3.2332613  -0.8657562   4.418756  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.40306836  0.41009784  0.3102358   0.23962568 -0.21728423]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.48046094  0.49115252  0.376581    0.14270185 -0.27984527]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.18360493  0.30470017  0.22333069  0.07643326 -0.12047107]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.18360493  0.30470017  0.22333069  0.07643326 -0.12047107]
  [FlaxMamba2] B (step) sample values: [-0.02172575  0.16280568 -0.07137528  1.2090225  -0.10083099]
  [FlaxMamba2] C (step) sample values: [-0.03291106 -0.06080773 -0.13112524 -0.03027795 -0.15756354]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6851114  -0.13800453 -0.41180432 -0.26783535 -0.12443344]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.27225506 5.4353423  2.1473613  1.8750153  4.3034997 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8298378  0.47231844 0.4130062  0.6052006  0.585377  ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.18360493  0.30470017  0.22333069  0.07643326 -0.12047107]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00108601 -0.00813823  0.00356786 -0.06043586  0.00504028]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00108601 -0.00813823  0.00356786 -0.06043586  0.00504028]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00879965  0.00650635  0.006222   -0.03968888  0.01409445]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.222833   -0.14800875  0.0800212  -0.14160292  0.08046117]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.91436505  0.999618    0.9211769   0.14627634 -0.37328267]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.91436505  0.999618    0.9211769   0.14627634 -0.37328267]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.1027877  -0.27760157  0.65696186 -0.03246393  0.10328718]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00935326 -0.01333317  0.09718168 -0.00408989  0.00892323]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00935326 -0.01333317  0.09718168 -0.00408989  0.00892323]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.05160845 -0.03339602  0.07067087 -0.20089051  0.00134964]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.05160845 -0.03339602  0.07067087 -0.20089051  0.00134964]
  [Layer 8] Output shape after mixer: (1, 1, 1024)
  [Layer 8] Output sample values after mixer: [ 0.05160845 -0.03339602  0.07067087 -0.20089051  0.00134964]
  [Layer 8] Residual connection shape: (1, 1, 1024)
  [Layer 8] Residual connection sample values: [ 0.16973464  1.0009809   0.62636244 -0.52877474  0.71187824]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.16295455  0.7426809   0.44494218 -0.509       0.59529114]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.16295455  0.7426809   0.44494218 -0.509       0.59529114]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.16295455  0.7426809   0.44494218 -0.509       0.59529114]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.5333234  -1.4178121   1.124544   -1.1664464  -0.61554956]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.5333234  -1.4178121   1.124544   -1.1664464  -0.61554956]
  [FlaxMamba2] xBC (step) sample values: [ 1.138623    2.1194863  -2.5958135   0.47385746  0.26318702]
  [FlaxMamba2] dt (step) sample values: [3.8820348 5.325117  3.1418226 3.4910018 4.742431 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6422956  0.8244302  2.8222654  1.138623  -1.4181931]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.8531236   0.5383094   0.48095936  0.01861337  0.08090901]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-1.1065416   0.62882453  0.4767937   0.02533868  0.06224751]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.2749935   0.41013378  0.29417717  0.01282984  0.03209213]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.2749935   0.41013378  0.29417717  0.01282984  0.03209213]
  [FlaxMamba2] B (step) sample values: [ 0.02533636 -0.0281052   0.09902886 -0.14685246  0.00987904]
  [FlaxMamba2] C (step) sample values: [-0.13674355 -0.18185678  0.13675076 -0.14184704 -0.15530232]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17008033 -0.11351943 -0.10539922 -0.5864362  -0.14965628]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [4.312517  6.1329536 4.93711   2.1301851 4.942707 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.48023757 0.49847123 0.59430206 0.286729   0.47725365]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.2749935   0.41013378  0.29417717  0.01282984  0.03209213]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.03004676  0.03333036 -0.11743974  0.17415443 -0.01171569]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.03004676  0.03333036 -0.11743974  0.17415443 -0.01171569]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01369581 -0.05774099 -0.1620503   0.38919985  0.17569335]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.8206614   0.18370579 -0.12363679 -0.10484792  0.44529742]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-1.557498    1.2826464   0.66460174 -0.07047075  0.5312873 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-1.557498    1.2826464   0.66460174 -0.07047075  0.5312873 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.5235238  -0.3546263   0.56414074  0.01952241 -0.11472155]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02405718 -0.03037385  0.03230976  0.00128258 -0.00756662]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02405718 -0.03037385  0.03230976  0.00128258 -0.00756662]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.6871212e-02  4.5748230e-02 -1.6824514e-01 -1.6311951e-01
  8.8757952e-05]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.6871212e-02  4.5748230e-02 -1.6824514e-01 -1.6311951e-01
  8.8757952e-05]
  [Layer 9] Output shape after mixer: (1, 1, 1024)
  [Layer 9] Output sample values after mixer: [ 2.6871212e-02  4.5748230e-02 -1.6824514e-01 -1.6311951e-01
  8.8757952e-05]
  [Layer 9] Residual connection shape: (1, 1, 1024)
  [Layer 9] Residual connection sample values: [ 0.19660586  1.0467291   0.4581173  -0.69189423  0.711967  ]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.18916999  0.7694334   0.32868463 -0.65485555  0.5799617 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.18916999  0.7694334   0.32868463 -0.65485555  0.5799617 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.18916999  0.7694334   0.32868463 -0.65485555  0.5799617 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.0385823  -2.686706   -3.763988   -4.3332624  -0.24007349]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-2.0385823  -2.686706   -3.763988   -4.3332624  -0.24007349]
  [FlaxMamba2] xBC (step) sample values: [-2.820525   1.5775404  1.4092764  1.060389   2.0356312]
  [FlaxMamba2] dt (step) sample values: [4.4260964 2.5414724 2.0188143 5.6261873 2.4007049]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.7703952 -3.1214604 -0.8984489 -2.820525   3.4393964]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01911812  0.06216589 -0.12225611  0.5461867  -0.46380466]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.1894062   0.03822485 -0.16021997  1.1501906  -0.4149155 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.08576114  0.01947766 -0.07370607  0.8736223  -0.16502604]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08576114  0.01947766 -0.07370607  0.8736223  -0.16502604]
  [FlaxMamba2] B (step) sample values: [-0.03841873  0.37617898  0.02809052 -0.20485532 -0.13847166]
  [FlaxMamba2] C (step) sample values: [ 1.4835092  -0.19442247  0.03560607  0.19866948  0.49709544]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.08535489 -0.07711172 -0.08452541 -0.0546804  -0.06966463]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [5.5092554 0.8011859 0.5389206 6.7269955 2.2387574]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.6248511  0.9400889  0.9554694  0.69223154 0.85559154]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08576114  0.01947766 -0.07370607  0.8736223  -0.16502604]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01815208 -0.17773704 -0.01327221  0.09679005  0.06542509]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01815208 -0.17773704 -0.01327221  0.09679005  0.06542509]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.11811133 -0.95057374 -0.06800476  0.4197144  -0.06533939]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-3.881367    0.36782932 -2.6212645  28.507624    1.6051835 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-4.29895     0.46266884 -2.9801497  32.761414    0.8016481 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-4.29895     0.46266884 -2.9801497  32.761414    0.8016481 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 1.0096835  -0.07926015  0.2542438  -1.839089   -0.08473158]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01200893 -0.00201522  0.00708889 -0.03943916 -0.00220275]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01200893 -0.00201522  0.00708889 -0.03943916 -0.00220275]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.12495739  0.35939133  0.15652616  0.35565385 -0.41352993]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.12495739  0.35939133  0.15652616  0.35565385 -0.41352993]
  [Layer 10] Output shape after mixer: (1, 1, 1024)
  [Layer 10] Output sample values after mixer: [ 0.12495739  0.35939133  0.15652616  0.35565385 -0.41352993]
  [Layer 10] Residual connection shape: (1, 1, 1024)
  [Layer 10] Residual connection sample values: [ 0.32156324  1.4061204   0.61464345 -0.33624038  0.29843706]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.19525209  0.6927314   0.2937226  -0.22293769  0.16038123]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.19525209  0.6927314   0.2937226  -0.22293769  0.16038123]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.19525209  0.6927314   0.2937226  -0.22293769  0.16038123]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.5948493   0.24926184 -1.6224899   2.0984454  -2.539981  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.5948493   0.24926184 -1.6224899   2.0984454  -2.539981  ]
  [FlaxMamba2] xBC (step) sample values: [-0.44022954 -0.5750426  -0.95850366  0.21433727  0.5952006 ]
  [FlaxMamba2] dt (step) sample values: [-1.3701926  -0.07679351  0.25003296  2.0294788   3.4756138 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 2.1558917   0.68330896 -0.13014178 -0.44022954  0.01642179]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.1558816   0.09379387  0.241025   -0.03840386  0.05538789]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [0.30236596 0.28495598 0.26495078 0.06901801 0.17037812]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [0.17386672 0.16264172 0.14992316 0.0356994  0.09242873]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [0.17386672 0.16264172 0.14992316 0.0356994  0.09242873]
  [FlaxMamba2] B (step) sample values: [-0.23689148  0.03829375  0.19096008 -0.14829478  0.00264423]
  [FlaxMamba2] C (step) sample values: [-0.18637694  0.36338148  0.04452508  0.0654588  -0.1653147 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.25934154 -0.12614636 -0.10356269 -0.23775288 -0.43051487]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05667933 0.06542367 0.19064358 1.9507667  3.55888   ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9854082  0.991781   0.9804501  0.6288891  0.21607043]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [0.17386672 0.16264172 0.14992316 0.0356994  0.09242873]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.3344823e-03  3.7737138e-04  1.8818444e-03 -1.4613929e-03
  2.6057991e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.3344823e-03  3.7737138e-04  1.8818444e-03 -1.4613929e-03
  2.6057991e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.18541245  0.01083763  0.01979563 -0.0867442   0.11446074]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [0.563106   0.5670591  0.49620268 0.29316318 0.8300988 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [0.0147053  0.05406368 0.02332345 0.18056211 0.5385653 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [0.0147053  0.05406368 0.02332345 0.18056211 0.5385653 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0194962   0.00757345 -0.00623871  0.3375057  -0.1000002 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00070808  0.00203661 -0.00300974  0.03060604 -0.01058476]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00070808  0.00203661 -0.00300974  0.03060604 -0.01058476]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.06732253 -0.08236338 -0.13974601  0.13094358  0.38999227]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.06732253 -0.08236338 -0.13974601  0.13094358  0.38999227]
  [Layer 11] Output shape after mixer: (1, 1, 1024)
  [Layer 11] Output sample values after mixer: [ 0.06732253 -0.08236338 -0.13974601  0.13094358  0.38999227]
  [Layer 11] Residual connection shape: (1, 1, 1024)
  [Layer 11] Residual connection sample values: [ 0.38888577  1.323757    0.47489744 -0.2052968   0.68842936]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.1886445   0.5115609   0.16781941 -0.11293648  0.2825731 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.1886445   0.5115609   0.16781941 -0.11293648  0.2825731 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.1886445   0.5115609   0.16781941 -0.11293648  0.2825731 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 3.0246403  -0.7573148   0.9501588  -0.60289204 -0.5342552 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 3.0246403  -0.7573148   0.9501588  -0.60289204 -0.5342552 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.5587608   0.31702283 -1.321306   -0.3114726  -0.5837226 ]
  [FlaxMamba2] dt (step) sample values: [1.7791233 2.6528504 1.4244493 2.3183107 1.7769357]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.6178971 -2.6213522 -0.627188   0.5587608  2.6589339]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.18377998 -0.95830727  0.08891102 -0.12792787  0.65592074]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.2509797  -1.7927799   0.02415272 -0.17214784  0.48929477]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.10982429 -0.25588748  0.01222219 -0.07868345  0.30333352]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.10982429 -0.25588748  0.01222219 -0.07868345  0.30333352]
  [FlaxMamba2] B (step) sample values: [ 0.16190119 -0.00059048 -0.00782479  0.50111985  0.03811394]
  [FlaxMamba2] C (step) sample values: [ 0.10511692 -0.2546742  -0.25866708 -0.27327105  0.6719383 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.16087165 -0.14748003 -0.27125728 -0.11553253 -0.09015273]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [2.3974292  2.4858682  2.2790425  3.6807518  0.35585985]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.67998916 0.6930758  0.5389099  0.6536086  0.9684274 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.10982429 -0.25588748  0.01222219 -0.07868345  0.30333352]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.04262793  0.00015547  0.00206024 -0.13194284 -0.01003525]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.04262793  0.00015547  0.00206024 -0.13194284 -0.01003525]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.06385384  0.0254435   0.08736431 -0.28712654 -0.02838098]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.62510765 -1.4149106  -0.47520006 -0.10305408  5.5128493 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.8033372  -1.8301804  -0.45536515 -0.23074639  6.0051174 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.8033372  -1.8301804  -0.45536515 -0.23074639  6.0051174 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-2.3172455   0.4424594  -0.31201816  0.04920258 -1.1855341 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.27294406  0.03045158 -0.04204963  0.01251585 -0.12014233]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.27294406  0.03045158 -0.04204963  0.01251585 -0.12014233]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.20147043  0.10737479 -0.53408086  0.51291305  0.14785236]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.20147043  0.10737479 -0.53408086  0.51291305  0.14785236]
  [Layer 12] Output shape after mixer: (1, 1, 1024)
  [Layer 12] Output sample values after mixer: [-0.20147043  0.10737479 -0.53408086  0.51291305  0.14785236]
  [Layer 12] Residual connection shape: (1, 1, 1024)
  [Layer 12] Residual connection sample values: [ 0.18741533  1.4311318  -0.05918342  0.30761623  0.8362817 ]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.06961817  0.4341282  -0.01708917  0.12293936  0.27865818]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.06961817  0.4341282  -0.01708917  0.12293936  0.27865818]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.06961817  0.4341282  -0.01708917  0.12293936  0.27865818]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.66561586 -1.0004562  -0.4062587   0.27336678 -0.41052595]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.66561586 -1.0004562  -0.4062587   0.27336678 -0.41052595]
  [FlaxMamba2] xBC (step) sample values: [ 0.12189782  0.40596503 -0.34365866  0.646559   -0.603514  ]
  [FlaxMamba2] dt (step) sample values: [ 1.0962617  -0.15651633  0.94715744 -0.60315764  0.70213085]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.27914023 -0.41646534  0.25376448  0.12189782 -0.53979677]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.08793366 -0.0191549  -0.3813574   0.04001404 -0.02561825]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.15000641 -0.03781639 -0.37347624  0.02830292 -0.05605953]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.06938826 -0.01855072 -0.15226676  0.01435171 -0.02724431]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06938826 -0.01855072 -0.15226676  0.01435171 -0.02724431]
  [FlaxMamba2] B (step) sample values: [ 0.07669323 -0.21747176  0.2000373  -0.04566337 -0.08456215]
  [FlaxMamba2] C (step) sample values: [-0.00341122 -0.00890107  0.5377361   0.1293344  -0.06998074]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.02338035 -1.090337   -0.5085105  -0.67845345 -0.02513249]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.14965528 0.00857877 0.02180785 0.00287791 0.28694093]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9965071 0.9906899 0.9889717 0.9980494 0.9928144]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06938826 -0.01855072 -0.15226676  0.01435171 -0.02724431]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00079641  0.0022583  -0.00207725  0.00047418  0.00087812]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00079641  0.0022583  -0.00207725  0.00047418  0.00087812]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.09289916  0.10180323 -0.2829682   0.02349284 -0.05861557]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.20376758 -0.191938    0.00198608  0.00425539  0.17695053]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.19575301 -0.18979533  0.01957339  0.00259772  0.18009734]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.19575301 -0.18979533  0.01957339  0.00259772  0.18009734]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.04423289  0.05105009 -0.00317923  0.0004033  -0.0294841 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01311085  0.01001155 -0.00211224  0.00063273 -0.01004119]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01311085  0.01001155 -0.00211224  0.00063273 -0.01004119]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.14372605 -0.2202546  -0.17914869  0.6193938   0.1685936 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.14372605 -0.2202546  -0.17914869  0.6193938   0.1685936 ]
  [Layer 13] Output shape after mixer: (1, 1, 1024)
  [Layer 13] Output sample values after mixer: [-0.14372605 -0.2202546  -0.17914869  0.6193938   0.1685936 ]
  [Layer 13] Residual connection shape: (1, 1, 1024)
  [Layer 13] Residual connection sample values: [ 0.04368928  1.2108772  -0.23833211  0.92701006  1.0048753 ]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.0126702   0.3031623  -0.05835606  0.30420586  0.27300125]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.0126702   0.3031623  -0.05835606  0.30420586  0.27300125]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.0126702   0.3031623  -0.05835606  0.30420586  0.27300125]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.1924496  -0.94137716 -0.38387206  1.1747841  -0.79670006]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.1924496  -0.94137716 -0.38387206  1.1747841  -0.79670006]
  [FlaxMamba2] xBC (step) sample values: [ 0.00432411  0.2673232  -0.81974304  0.46008223 -0.50055057]
  [FlaxMamba2] dt (step) sample values: [ 1.2094654 -0.4494094  1.9887258  0.863049   1.7749313]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.9048691   1.7296733  -0.38637185  0.00432411 -1.2732725 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00270254  0.04098871 -0.46201217 -0.14477642  0.13509816]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0731371  -0.00841925 -0.65378463 -0.19238384  0.12131947]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.03790522 -0.00419191 -0.22368401 -0.08696747  0.06433483]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03790522 -0.00419191 -0.22368401 -0.08696747  0.06433483]
  [FlaxMamba2] B (step) sample values: [-0.030712    0.128443   -0.0597038   0.23225969 -0.11938153]
  [FlaxMamba2] C (step) sample values: [-0.12487522  0.2339548  -0.08749896  0.3401555  -0.21538661]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-7.2744994  -0.03854768 -2.202407   -0.01377147 -5.3377523 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06724937 0.03847407 0.08286895 0.11447588 0.09245553]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.61311334 0.998518   0.83317536 0.99842477 0.61048305]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03790522 -0.00419191 -0.22368401 -0.08696747  0.06433483]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.8288016e-05  3.2741428e-04 -1.5219107e-04  5.9205358e-04
 -3.0431568e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.8288016e-05  3.2741428e-04 -1.5219107e-04  5.9205358e-04
 -3.0431568e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00039094 -0.0001702   0.00058179  0.00051388 -0.00022968]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00223373 -0.00363852 -0.0280342  -0.00710352  0.00725171]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03206508 -0.00693754 -0.20407319 -0.0755468   0.05788313]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03206508 -0.00693754 -0.20407319 -0.0755468   0.05788313]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00278947  0.0018327   0.03174204 -0.06780667 -0.01432955]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00596554  0.00273091  0.03245123 -0.10037819 -0.02696359]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00596554  0.00273091  0.03245123 -0.10037819 -0.02696359]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.5709293   0.3852286  -0.2966552  -0.7621496   0.30852118]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.5709293   0.3852286  -0.2966552  -0.7621496   0.30852118]
  [Layer 14] Output shape after mixer: (1, 1, 1024)
  [Layer 14] Output sample values after mixer: [-0.5709293   0.3852286  -0.2966552  -0.7621496   0.30852118]
  [Layer 14] Residual connection shape: (1, 1, 1024)
  [Layer 14] Residual connection sample values: [-0.52724004  1.5961058  -0.53498733  0.16486049  1.3133965 ]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.17547277  0.4369873  -0.14704226  0.06503998  0.40799877]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.17547277  0.4369873  -0.14704226  0.06503998  0.40799877]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.17547277  0.4369873  -0.14704226  0.06503998  0.40799877]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 2.141203    0.01287455  0.51887673 -2.1870263  -6.0243473 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 2.141203    0.01287455  0.51887673 -2.1870263  -6.0243473 ]
  [FlaxMamba2] xBC (step) sample values: [-3.226898  -0.2153511  1.43737    1.7837129 -1.3098011]
  [FlaxMamba2] dt (step) sample values: [ 1.8480126  1.4327258 -0.2558894  7.058295   1.6968501]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.4330966  -1.1422975   0.19749758 -3.226898    1.3801389 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [0.3330655  0.09168541 0.05763981 0.3611023  0.24030845]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00311613  0.06750023  1.3828351   0.8037293   0.22681968]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.00155564  0.03488875  1.1055019   0.5551934   0.12621677]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00155564  0.03488875  1.1055019   0.5551934   0.12621677]
  [FlaxMamba2] B (step) sample values: [-0.04197022 -0.1628764   0.1479902  -0.06908997 -0.10005787]
  [FlaxMamba2] C (step) sample values: [-0.03880642 -0.04965341  0.02274029 -0.04991442 -0.12682983]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.4414158  -0.05923919 -0.7389757  -0.00508607 -0.00871955]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.34114397 1.225245   0.01699315 4.0715857  0.59698546]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.43479776 0.929989   0.987521   0.9795046  0.9948081 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00155564  0.03488875  1.1055019   0.5551934   0.12621677]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.2273445e-05  8.6437933e-05 -7.8537872e-05  3.6665806e-05
  5.3100361e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.2273445e-05  8.6437933e-05 -7.8537872e-05  3.6665806e-05
  5.3100361e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00055825  0.00338898  0.0020392   0.00065566  0.00396642]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00599075  0.00141854  0.07077455  0.02678566  0.00378548]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00876881  0.06372292  2.0449815   1.018251    0.22918357]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00876881  0.06372292  2.0449815   1.018251    0.22918357]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-1.6801406e-02  4.1284243e-04  6.6518354e-01 -2.2474650e-01
 -3.3319874e-03]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01443871  0.00025895  0.12263016 -0.10886628 -0.00292166]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01443871  0.00025895  0.12263016 -0.10886628 -0.00292166]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.5160369   0.06402467 -0.16213769 -0.17674157 -0.03493041]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.5160369   0.06402467 -0.16213769 -0.17674157 -0.03493041]
  [Layer 15] Output shape after mixer: (1, 1, 1024)
  [Layer 15] Output sample values after mixer: [-0.5160369   0.06402467 -0.16213769 -0.17674157 -0.03493041]
  [Layer 15] Residual connection shape: (1, 1, 1024)
  [Layer 15] Residual connection sample values: [-1.043277    1.6601305  -0.697125   -0.01188108  1.278466  ]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.22844079  0.30040193 -0.11755951 -0.00330081  0.26464745]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.22844079  0.30040193 -0.11755951 -0.00330081  0.26464745]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.22844079  0.30040193 -0.11755951 -0.00330081  0.26464745]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.6406585e-02 -1.8398350e-04 -6.3899345e+00 -6.7819774e-01
 -1.0860384e+00]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.6406585e-02 -1.8398350e-04 -6.3899345e+00 -6.7819774e-01
 -1.0860384e+00]
  [FlaxMamba2] xBC (step) sample values: [ 0.8545147   0.34328327 -2.5231416   0.85724235 -1.1348058 ]
  [FlaxMamba2] dt (step) sample values: [3.4973686 0.8158555 1.9320711 0.5898244 0.8829236]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.24830371  1.2533983  -0.13573612  0.8545147  -0.9998615 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01219959 -0.06299002 -0.13010773 -0.04913564  0.07533374]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01402301 -0.0541857   0.00661102 -0.08731313  0.08286396]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.00696235 -0.02635901  0.00331644 -0.04175188  0.0431476 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00696235 -0.02635901  0.00331644 -0.04175188  0.0431476 ]
  [FlaxMamba2] B (step) sample values: [ 0.02103208 -0.03535931 -0.10524625 -0.03003648 -0.00230579]
  [FlaxMamba2] C (step) sample values: [ 0.13018098 -0.06270441 -0.0182093  -0.18996918 -0.24264494]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.1348554e-03 -3.0370306e-03 -2.7156286e+00 -4.1511287e-03
 -4.2925543e-01]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.3227773  0.14390522 0.15265113 0.0482173  0.00271898]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9985     0.99956304 0.6606416  0.99979985 0.99883354]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00696235 -0.02635901  0.00331644 -0.04175188  0.0431476 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.9369774e-04  3.2564628e-04  9.6927944e-04  2.7662501e-04
  2.1235483e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.9369774e-04  3.2564628e-04  9.6927944e-04  2.7662501e-04
  2.1235483e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00419619 0.1099069  0.03939153 0.00220794 0.00392189]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01271926  0.04031342  0.01653771  0.11303597  0.0151781 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01109887  0.0464481   0.01576586  0.12275313  0.0051361 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01109887  0.0464481   0.01576586  0.12275313  0.0051361 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 9.0300433e-05 -4.2724491e-06 -1.6880000e-04 -2.8027551e-02
 -1.4076937e-03]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 7.4417927e-05 -2.0045718e-06 -3.1880799e-04 -9.2147328e-03
 -1.3732602e-03]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 7.4417927e-05 -2.0045718e-06 -3.1880799e-04 -9.2147328e-03
 -1.3732602e-03]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.31118575  0.20686518 -0.424844   -0.3584747   0.06944076]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.31118575  0.20686518 -0.424844   -0.3584747   0.06944076]
  [Layer 16] Output shape after mixer: (1, 1, 1024)
  [Layer 16] Output sample values after mixer: [ 0.31118575  0.20686518 -0.424844   -0.3584747   0.06944076]
  [Layer 16] Residual connection shape: (1, 1, 1024)
  [Layer 16] Residual connection sample values: [-0.7320913   1.8669957  -1.121969   -0.37035578  1.3479067 ]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.23390733  0.513271   -0.3081904  -0.13561408  0.39672142]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.23390733  0.513271   -0.3081904  -0.13561408  0.39672142]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.23390733  0.513271   -0.3081904  -0.13561408  0.39672142]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-7.3771024 -5.300831   0.5402185 -1.4830091 -2.5806155]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-7.3771024 -5.300831   0.5402185 -1.4830091 -2.5806155]
  [FlaxMamba2] xBC (step) sample values: [ 2.4675014 -1.3282504 -0.5923383 -0.5277257  0.3527431]
  [FlaxMamba2] dt (step) sample values: [2.7109995 2.1182263 1.3380027 1.9321653 2.716584 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.44997388  0.2817422  -1.7254306   2.4675014   0.4414193 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.4208253   0.1822125  -0.24380346 -0.10716018  0.08420234]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.32579356  0.20433775 -0.35824436 -0.07273635  0.1794172 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.1891999   0.11257118 -0.14737621 -0.03504611  0.09773471]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.1891999   0.11257118 -0.14737621 -0.03504611  0.09773471]
  [FlaxMamba2] B (step) sample values: [-0.02979243  0.0716595  -0.26495403  0.04131255 -0.23558842]
  [FlaxMamba2] C (step) sample values: [-0.13296492 -0.0983336  -0.27592567 -0.14100844 -0.03696662]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.3863302  -0.87734115 -1.4026718  -0.6827737  -0.39046   ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.1784325  0.5421003  0.42500737 1.0880638  1.8996527 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.19520664 0.62150776 0.5509309  0.47573164 0.4762852 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.1891999   0.11257118 -0.14737621 -0.03504611  0.09773471]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0066425   0.01597715 -0.05907396  0.00921102 -0.05252663]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0066425   0.01597715 -0.05907396  0.00921102 -0.05252663]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00331384  0.01492002 -0.05115982  0.00965912 -0.04760704]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.13295321  0.09006491 -0.13061    -0.02187769  0.08326107]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.63127893  0.38656145 -0.5187781  -0.11418419  0.34068048]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.63127893  0.38656145 -0.5187781  -0.11418419  0.34068048]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00291072 -0.01016905 -0.17708188  0.03132268 -0.06189011]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00112286 -0.00400332 -0.07333547  0.01596989 -0.02909436]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00112286 -0.00400332 -0.07333547  0.01596989 -0.02909436]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.59552217  0.33879215 -0.396698    0.39843464 -0.09554601]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.59552217  0.33879215 -0.396698    0.39843464 -0.09554601]
  [Layer 17] Output shape after mixer: (1, 1, 1024)
  [Layer 17] Output sample values after mixer: [ 0.59552217  0.33879215 -0.396698    0.39843464 -0.09554601]
  [Layer 17] Residual connection shape: (1, 1, 1024)
  [Layer 17] Residual connection sample values: [-0.13656914  2.205788   -1.518667    0.02807885  1.2523607 ]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.02903553  0.40548208 -0.27506325  0.00725485  0.23563705]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.02903553  0.40548208 -0.27506325  0.00725485  0.23563705]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.02903553  0.40548208 -0.27506325  0.00725485  0.23563705]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.3554625  -0.4255077  -0.64507776 -0.7420943   1.1245067 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.3554625  -0.4255077  -0.64507776 -0.7420943   1.1245067 ]
  [FlaxMamba2] xBC (step) sample values: [-0.6895262  -0.87735415  0.0259642  -0.88250333 -2.3567402 ]
  [FlaxMamba2] dt (step) sample values: [5.7895881e-01 5.9092026e+00 4.9431820e+00 6.3997898e+00 4.3022935e-03]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.02733767  0.25384715 -0.15398827 -0.6895262  -1.0215554 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12506111  1.1441708   0.00485236 -0.21108915  0.1303151 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.13441475  0.74622154  0.01609808 -0.18054105  0.078069  ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.07171742  0.506203    0.00811383 -0.08214383  0.04055742]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.07171742  0.506203    0.00811383 -0.08214383  0.04055742]
  [FlaxMamba2] B (step) sample values: [ 0.15390804  0.01445211  0.05188685 -0.03165558 -0.00382994]
  [FlaxMamba2] C (step) sample values: [-0.05457459 -0.00922452 -0.0038414  -0.05579809  0.04269085]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.3194940e-03 -6.5335674e+00 -1.4897179e+01 -1.3796333e-03
 -2.0873186e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.22400816 7.021424   6.3911486  4.25972    0.13761917]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.99480546e-01 1.19333906e-20 0.00000000e+00 9.94140387e-01
 9.99712765e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.07171742  0.506203    0.00811383 -0.08214383  0.04055742]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.4725769e-03  2.3217725e-04  8.3357713e-04 -5.0855603e-04
 -6.1529019e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.4725769e-03  2.3217725e-04  8.3357713e-04 -5.0855603e-04
 -6.1529019e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00561151 -0.00841162  0.09310993 -0.03911741  0.01215213]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.2815123  -1.7789103   0.06812055 -0.20311105 -0.3007261 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.28719008 -1.8189858   0.06747819 -0.19660781 -0.303937  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.28719008 -1.8189858   0.06747819 -0.19660781 -0.303937  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.04206511  0.30588147 -0.0149782   0.04706    -0.25798303]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0497626   0.08860141 -0.00390717  0.0285851  -0.0736398 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0497626   0.08860141 -0.00390717  0.0285851  -0.0736398 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.1432302   0.35586902 -0.08339819  0.16643581 -0.39393198]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.1432302   0.35586902 -0.08339819  0.16643581 -0.39393198]
  [Layer 18] Output shape after mixer: (1, 1, 1024)
  [Layer 18] Output sample values after mixer: [-0.1432302   0.35586902 -0.08339819  0.16643581 -0.39393198]
  [Layer 18] Residual connection shape: (1, 1, 1024)
  [Layer 18] Residual connection sample values: [-0.27979934  2.561657   -1.6020652   0.19451466  0.8584287 ]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.06828169  0.5191595  -0.32820556  0.05870447  0.18598393]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.06828169  0.5191595  -0.32820556  0.05870447  0.18598393]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.06828169  0.5191595  -0.32820556  0.05870447  0.18598393]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.72302127 -0.86714333 -0.5935845   0.31078058  0.22832838]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.72302127 -0.86714333 -0.5935845   0.31078058  0.22832838]
  [FlaxMamba2] xBC (step) sample values: [ 1.531876   1.2369012  0.7248923 -1.2865897  1.4173533]
  [FlaxMamba2] dt (step) sample values: [2.061934  2.224752  2.9095857 2.942695  3.6310205]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.361026  -1.4363782 -1.2168745  1.531876  -1.111866 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.31303948  0.07570221  0.168       0.2746522   0.24712254]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.3644616   0.07620336  0.15420605  0.06701061  0.24593045]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.1493855   0.03955271  0.08303615  0.03462749  0.13800994]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.1493855   0.03955271  0.08303615  0.03462749  0.13800994]
  [FlaxMamba2] B (step) sample values: [-0.02308633 -0.147772   -0.27641642 -0.05331213  0.11326271]
  [FlaxMamba2] C (step) sample values: [-0.20613304  0.04399122 -0.1005556  -0.0736376   0.100779  ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17394373 -1.5063176  -1.5724528  -0.19826236 -0.07681109]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [3.0666611 1.392282  2.0596488 4.1105957 2.8700514]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.5865916  0.12279745 0.03921483 0.44264978 0.8021563 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.1493855   0.03955271  0.08303615  0.03462749  0.13800994]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01057619  0.06769652  0.12663043  0.02442307 -0.05188731]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01057619  0.06769652  0.12663043  0.02442307 -0.05188731]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0048454   0.07196928  0.07930139  0.06187564 -0.103717  ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.52748775 -0.22337002  0.02632723 -0.31139192  0.38735417]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.7549541  -0.16314387  0.15276474 -0.25866532  0.5974992 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.7549541  -0.16314387  0.15276474 -0.25866532  0.5974992 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.36750406  0.04185351 -0.03226468 -0.04639006  0.07596683]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.08598222  0.01692937 -0.01553964 -0.00920053  0.05574452]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.08598222  0.01692937 -0.01553964 -0.00920053  0.05574452]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.3815632   3.161934   -0.4068054   0.05894735  0.62619305]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.3815632   3.161934   -0.4068054   0.05894735  0.62619305]
  [Layer 19] Output shape after mixer: (1, 1, 1024)
  [Layer 19] Output sample values after mixer: [-1.3815632   3.161934   -0.4068054   0.05894735  0.62619305]
  [Layer 19] Residual connection shape: (1, 1, 1024)
  [Layer 19] Residual connection sample values: [-1.6613625   5.723591   -2.0088706   0.25346202  1.4846218 ]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.1760212   0.5550433  -0.19495042  0.03286139  0.15365203]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1760212   0.5550433  -0.19495042  0.03286139  0.15365203]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1760212   0.5550433  -0.19495042  0.03286139  0.15365203]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.31227717 -0.42415708  0.8577739  -0.6724947   0.55059695]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.31227717 -0.42415708  0.8577739  -0.6724947   0.55059695]
  [FlaxMamba2] xBC (step) sample values: [ 0.02312712 -1.0546438  -0.8556458   0.6825218  -0.36481792]
  [FlaxMamba2] dt (step) sample values: [1.1816448  2.2852752  0.20623976 1.9235514  1.3580105 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.8696122   0.8533652   1.2463926   0.02312712 -0.6241955 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.0451418   0.261073   -0.34437066  0.12250992 -0.06575   ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03063832  0.2228955  -0.5239361   0.10146805 -0.11225879]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.01555382  0.12381718 -0.19486876  0.05330576 -0.05298219]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01555382  0.12381718 -0.19486876  0.05330576 -0.05298219]
  [FlaxMamba2] B (step) sample values: [-0.02738719  0.00240076 -0.04005938  0.04924623 -0.00858003]
  [FlaxMamba2] C (step) sample values: [-0.22662525 -0.17555423 -0.22527267 -0.24735598 -0.21060735]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-3.08577806e-01 -2.93056536e+00 -5.29621363e+00 -1.23260975e+01
 -8.15932546e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02293351 0.23222752 0.07256791 0.43339118 0.15490076]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99294823 0.5063344  0.6809032  0.00478618 0.9987369 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01555382  0.12381718 -0.19486876  0.05330576 -0.05298219]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.7691091e-06  8.5635821e-07 -1.4289327e-05  1.7566310e-05
 -3.0605263e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.7691091e-06  8.5635821e-07 -1.4289327e-05  1.7566310e-05
 -3.0605263e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.2646562e-04 -2.4238265e-04 -2.0246004e-04  8.9302681e-05
 -4.8547627e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 2.0367627e-04  1.8993995e-04 -1.6356524e-05 -1.7763862e-03
  8.3066220e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01299634  0.10202678 -0.16029151  0.0420664  -0.042746  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01299634  0.10202678 -0.16029151  0.0420664  -0.042746  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00171494 -0.01711638 -0.09654756 -0.00956009 -0.01492816]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01781593 -0.15312736 -0.5946024  -0.09668256 -0.0986511 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01781593 -0.15312736 -0.5946024  -0.09668256 -0.0986511 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.13428059  0.13004011  0.31966028 -0.03138717  0.3047569 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.13428059  0.13004011  0.31966028 -0.03138717  0.3047569 ]
  [Layer 20] Output shape after mixer: (1, 1, 1024)
  [Layer 20] Output sample values after mixer: [-0.13428059  0.13004011  0.31966028 -0.03138717  0.3047569 ]
  [Layer 20] Residual connection shape: (1, 1, 1024)
  [Layer 20] Residual connection sample values: [-1.7956431   5.853631   -1.6892103   0.22207484  1.7893786 ]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.24026321  0.70869607 -0.20953453  0.03514048  0.23017186]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.24026321  0.70869607 -0.20953453  0.03514048  0.23017186]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.24026321  0.70869607 -0.20953453  0.03514048  0.23017186]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.21049345 -1.0033611   0.70768815 -0.81469196 -0.45009443]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.21049345 -1.0033611   0.70768815 -0.81469196 -0.45009443]
  [FlaxMamba2] xBC (step) sample values: [-0.08208276 -0.45895997  0.6218343   1.1555861   1.522637  ]
  [FlaxMamba2] dt (step) sample values: [ 1.3690685   1.0039698   0.9247462  -0.03883035  1.1967593 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.6583263  -0.26750508  0.5754699  -0.08208276 -2.123491  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.02084685 -0.10838483 -0.06561718 -0.2971231   0.37985945]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.33657503 -0.20585798 -0.09128246 -0.39514557  0.32587385]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.14023119 -0.09237187 -0.04355955 -0.15903789  0.18925291]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.14023119 -0.09237187 -0.04355955 -0.15903789  0.18925291]
  [FlaxMamba2] B (step) sample values: [ 0.00503981 -0.26907462 -0.07063862 -0.12604359 -0.02902171]
  [FlaxMamba2] C (step) sample values: [ 0.13404451 -0.13244554  0.12866537 -0.03761961  0.10729227]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.32275575 -0.3764196  -0.15946394 -0.10539922 -0.37568513]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.6586974  1.1434741  1.4188491  0.42759106 1.240551  ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.5854619 0.650232  0.7975145 0.9559327 0.6274718]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.14023119 -0.09237187 -0.04355955 -0.15903789  0.18925291]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00117227  0.06258705  0.01643062  0.02931788  0.00675048]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00117227  0.06258705  0.01643062  0.02931788  0.00675048]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.06176126 0.13080047 0.02930117 0.0856113  0.01217371]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.26964593 -0.17221926 -0.08703231 -0.0551224   0.3767112 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.56602407 -0.3674469  -0.17909528 -0.39124843  0.77669656]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.56602407 -0.3674469  -0.17909528 -0.39124843  0.77669656]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.06581891  0.0989104  -0.08490429  0.09782075 -0.13610753]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.06726418  0.12772782 -0.12396683  0.10015628 -0.120176  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.06726418  0.12772782 -0.12396683  0.10015628 -0.120176  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.79850215 -0.17223006 -0.8395529   0.3378992   0.5035555 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.79850215 -0.17223006 -0.8395529   0.3378992   0.5035555 ]
  [Layer 21] Output shape after mixer: (1, 1, 1024)
  [Layer 21] Output sample values after mixer: [ 0.79850215 -0.17223006 -0.8395529   0.3378992   0.5035555 ]
  [Layer 21] Residual connection shape: (1, 1, 1024)
  [Layer 21] Residual connection sample values: [-0.99714094  5.681401   -2.5287633   0.5599741   2.2929342 ]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.12679368  0.66819763 -0.2977151   0.08411439  0.28247762]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.12679368  0.66819763 -0.2977151   0.08411439  0.28247762]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.12679368  0.66819763 -0.2977151   0.08411439  0.28247762]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.59398425  1.6218314   0.94498557 -3.0870364   0.754748  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.59398425  1.6218314   0.94498557 -3.0870364   0.754748  ]
  [FlaxMamba2] xBC (step) sample values: [-0.01145529  0.80547583 -0.3534596   0.30717936  0.82683796]
  [FlaxMamba2] dt (step) sample values: [4.003425   1.1961852  2.267437   1.7297369  0.99708796]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6772157  -1.7266351  -0.32190228 -0.01145529  0.2001842 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02967089 -0.25045666 -0.00908262  0.02516205  0.09466542]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02148455 -0.1859425   0.00355166  0.00680573  0.09527577]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.01062688 -0.08435242  0.00177898  0.00341444  0.04990554]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01062688 -0.08435242  0.00177898  0.00341444  0.04990554]
  [FlaxMamba2] B (step) sample values: [-0.19109896  0.21011658  0.23620404 -0.17409861 -0.0384018 ]
  [FlaxMamba2] C (step) sample values: [-0.25734317 -0.1155588  -0.12656187 -0.21720223 -0.23214921]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.07090003 -0.07021102 -0.0699373  -0.08945116 -0.38969815]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [3.604252  1.5697584 0.7805776 1.1620569 1.3459284]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7744969  0.89564216 0.9468719  0.9012728  0.5918478 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01062688 -0.08435242  0.00177898  0.00341444  0.04990554]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00731947 -0.00804788 -0.00904708  0.00666832  0.00147086]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00731947 -0.00804788 -0.00904708  0.00666832  0.00147086]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00518588 0.02437675 0.00524706 0.01332617 0.04534906]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.05071833  0.15391397 -0.12769128 -0.04114185  0.01090065]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03239756  0.29933774 -0.13075826 -0.04702836 -0.07513662]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03239756  0.29933774 -0.13075826 -0.04702836 -0.07513662]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01239827  0.405395   -0.0889796   0.00633633 -0.03857431]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01272635  0.18022747 -0.09133416  0.00966226 -0.03778065]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01272635  0.18022747 -0.09133416  0.00966226 -0.03778065]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.41107616  2.228788   -0.69580656 -1.5259777   1.0108812 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.41107616  2.228788   -0.69580656 -1.5259777   1.0108812 ]
  [Layer 22] Output shape after mixer: (1, 1, 1024)
  [Layer 22] Output sample values after mixer: [ 0.41107616  2.228788   -0.69580656 -1.5259777   1.0108812 ]
  [Layer 22] Residual connection shape: (1, 1, 1024)
  [Layer 22] Residual connection sample values: [-0.5860648   7.9101887  -3.2245698  -0.96600366  3.3038154 ]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.05788002  0.70573837 -0.30272263 -0.11728047  0.30364007]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05788002  0.70573837 -0.30272263 -0.11728047  0.30364007]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05788002  0.70573837 -0.30272263 -0.11728047  0.30364007]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.52843386  0.96799195 -1.4259537  -0.6147061  -0.59239894]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.52843386  0.96799195 -1.4259537  -0.6147061  -0.59239894]
  [FlaxMamba2] xBC (step) sample values: [-1.548761   -0.21289878  0.12734187  0.62033916  0.45756644]
  [FlaxMamba2] dt (step) sample values: [1.8764333 1.7275748 1.6021639 2.0439463 1.5196991]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.9222784  -0.936926    0.79555124 -1.548761   -0.09923142]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.46282378 -0.07441138  0.48829606 -0.11462177 -0.04345402]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.42913237 -0.08197592  0.4463344  -0.0982796  -0.04792104]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.2599111  -0.03930889  0.27216014 -0.04672702 -0.02338652]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.2599111  -0.03930889  0.27216014 -0.04672702 -0.02338652]
  [FlaxMamba2] B (step) sample values: [ 0.08139851  0.15762714 -0.00945283  0.303016    0.061132  ]
  [FlaxMamba2] C (step) sample values: [-0.0883892  -0.15588135 -0.0083889   0.27008006  0.07043704]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.12322418 -0.22553998 -0.24196908 -0.09559295 -0.2396176 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.39683312 0.8537028  0.7657289  0.46784192 0.6281112 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9522769  0.82485795 0.8308694  0.9562629  0.86027217]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.2599111  -0.03930889  0.27216014 -0.04672702 -0.02338652]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00839555  0.01625787 -0.00097498  0.03125348  0.00630524]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00839555  0.01625787 -0.00097498  0.03125348  0.00630524]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.02708061  0.01321309 -0.00119453  0.08420109 -0.01136224]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.04212779  0.01493414  0.15832774 -0.02361331  0.0231654 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02999509  0.01676909  0.14562327 -0.02143208  0.02425709]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02999509  0.01676909  0.14562327 -0.02143208  0.02425709]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00997178  0.01176389 -0.04022842  0.00462405 -0.00511689]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01648854  0.05896363 -0.33143693  0.03821836 -0.02354769]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01648854  0.05896363 -0.33143693  0.03821836 -0.02354769]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.59122396 -2.2910793   0.8136136   0.59685403 -0.9125635 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.59122396 -2.2910793   0.8136136   0.59685403 -0.9125635 ]
  [Layer 23] Output shape after mixer: (1, 1, 1024)
  [Layer 23] Output sample values after mixer: [-0.59122396 -2.2910793   0.8136136   0.59685403 -0.9125635 ]
  [Layer 23] Residual connection shape: (1, 1, 1024)
  [Layer 23] Residual connection sample values: [-1.1772888   5.619109   -2.4109561  -0.36914963  2.3912518 ]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.13882993  0.58821845 -0.2742531  -0.0499591   0.25979483]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.13882993  0.58821845 -0.2742531  -0.0499591   0.25979483]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.13882993  0.58821845 -0.2742531  -0.0499591   0.25979483]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.5186311  -0.06589508  0.36575833 -1.6650568  -1.2363659 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.5186311  -0.06589508  0.36575833 -1.6650568  -1.2363659 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.23978034 -1.811397   -1.3451724  -3.5035298  -0.96107703]
  [FlaxMamba2] dt (step) sample values: [0.77616394 1.5771093  1.8685426  0.6712135  1.7994682 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.18481547 -0.16016293 -0.25741082  0.23978034 -2.1052516 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.0710821  -0.2078633  -0.16731304 -0.8420271   0.12666057]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.05587102 -0.11051223 -0.1694836  -0.9211287   0.13351177]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.0287157  -0.05220598 -0.07757777 -0.2622711   0.07120562]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0287157  -0.05220598 -0.07757777 -0.2622711   0.07120562]
  [FlaxMamba2] B (step) sample values: [-0.02079781  0.03863507 -0.12291106  0.11874575 -0.06801496]
  [FlaxMamba2] C (step) sample values: [ 0.01102068 -0.15186468 -0.23717241  0.00896145 -0.22728017]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6296152  -0.19671947 -0.14336194 -0.14017779 -0.22378482]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.2643061 1.8685374 1.8152705 1.6559974 1.5214577]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.45111802 0.6924095  0.77086604 0.7928398  0.71142936]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0287157  -0.05220598 -0.07757777 -0.2622711   0.07120562]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00075507  0.00140266 -0.00446234  0.00431112 -0.00246931]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00075507  0.00140266 -0.00446234  0.00431112 -0.00246931]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01960589  0.00566044 -0.00323474  0.01626736 -0.0029282 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.07078245 -0.0404234  -0.06359003 -0.13153483 -0.06767927]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.21142735 -0.2961199  -0.4435535  -1.4160966   0.28107446]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.21142735 -0.2961199  -0.4435535  -1.4160966   0.28107446]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0687334   0.00943509 -0.09578805  0.37510198 -0.078214  ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03263913  0.01398836 -0.12486634  0.3631818  -0.0702066 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03263913  0.01398836 -0.12486634  0.3631818  -0.0702066 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.143056   -0.00918934  0.0294965   0.4031294   0.49311927]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.143056   -0.00918934  0.0294965   0.4031294   0.49311927]
  [Layer 24] Output shape after mixer: (1, 1, 1024)
  [Layer 24] Output sample values after mixer: [-1.143056   -0.00918934  0.0294965   0.4031294   0.49311927]
  [Layer 24] Residual connection shape: (1, 1, 1024)
  [Layer 24] Residual connection sample values: [-2.320345    5.60992    -2.3814597   0.03397977  2.884371  ]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.18045716  0.40495092 -0.17261164  0.00302571  0.21020423]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18045716  0.40495092 -0.17261164  0.00302571  0.21020423]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18045716  0.40495092 -0.17261164  0.00302571  0.21020423]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.168586   -0.04834602 -1.7436352   0.16777068 -0.01559834]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.168586   -0.04834602 -1.7436352   0.16777068 -0.01559834]
  [FlaxMamba2] xBC (step) sample values: [-0.13636056 -0.4162161   1.5744303  -1.3104074  -0.39569557]
  [FlaxMamba2] dt (step) sample values: [2.0505614 1.2739254 1.1333499 2.037416  1.8999352]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.16954596  0.01340183  0.03133045 -0.13636056  0.5003123 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.03865241  0.04232472 -0.3427033  -0.63941634 -0.26281166]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01933479  0.04567212 -0.24004218 -0.7445189  -0.3014469 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.00976085  0.02335745 -0.1056848  -0.23974757 -0.12817638]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00976085  0.02335745 -0.1056848  -0.23974757 -0.12817638]
  [FlaxMamba2] B (step) sample values: [-0.04449378 -0.01738866 -0.03948899 -0.01009373 -0.01441113]
  [FlaxMamba2] C (step) sample values: [-0.1988911  -0.23704557 -0.09386428 -0.06683258 -0.23866087]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.16260907 -0.3326761  -0.32944313 -0.2015813  -0.1541056 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.966254   0.9226342  0.82021534 1.6512524  1.7296721 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7263446  0.73569596 0.7632159  0.71686935 0.76601607]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00976085  0.02335745 -0.1056848  -0.23974757 -0.12817638]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00085394 -0.00033373 -0.00075788 -0.00019372 -0.00027658]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00085394 -0.00033373 -0.00075788 -0.00019372 -0.00027658]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00166056  0.00069106 -0.00119806  0.00129355 -0.0060721 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00852956  0.01160789 -0.04039678 -0.21276173 -0.07532661]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00043911  0.03306968 -0.13750432 -0.43305165 -0.19310033]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00043911  0.03306968 -0.13750432 -0.43305165 -0.19310033]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00012167 -0.00078007  0.03568831 -0.03936683  0.00149428]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00086699 -0.0043563   0.16644101 -0.10298748  0.00602079]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00086699 -0.0043563   0.16644101 -0.10298748  0.00602079]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.1493988   0.20566146 -1.094352    0.9438982  -0.15615794]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.1493988   0.20566146 -1.094352    0.9438982  -0.15615794]
  [Layer 25] Output shape after mixer: (1, 1, 1024)
  [Layer 25] Output sample values after mixer: [ 1.1493988   0.20566146 -1.094352    0.9438982  -0.15615794]
  [Layer 25] Residual connection shape: (1, 1, 1024)
  [Layer 25] Residual connection sample values: [-1.1709461  5.8155813 -3.4758117  0.977878   2.728213 ]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.10565045  0.48880956 -0.30720377  0.10598483  0.2354712 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.10565045  0.48880956 -0.30720377  0.10598483  0.2354712 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.10565045  0.48880956 -0.30720377  0.10598483  0.2354712 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.8392775   0.5850883  -0.04646469 -0.32533923  0.35737535]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.8392775   0.5850883  -0.04646469 -0.32533923  0.35737535]
  [FlaxMamba2] xBC (step) sample values: [-1.1091459  -0.24700804  0.996689    1.6719991  -0.3708139 ]
  [FlaxMamba2] dt (step) sample values: [1.3800923 1.8348866 1.2553618 3.299513  1.9308145]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.49196064 -1.0917618   0.05861462 -1.1091459  -1.8933204 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.26822114 -0.09197167 -0.24040243  0.4595774  -0.2665732 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.35922456 -0.14589623 -0.26567098  0.39628395 -0.53439546]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.1476942  -0.0676361  -0.11529329  0.23689638 -0.197455  ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.1476942  -0.0676361  -0.11529329  0.23689638 -0.197455  ]
  [FlaxMamba2] B (step) sample values: [ 0.16646926 -0.13120171 -0.0316711   0.08620863 -0.09079077]
  [FlaxMamba2] C (step) sample values: [ 0.13162637 -0.27841833 -0.1591471   0.18229671 -0.11201151]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.329765   -0.06343037 -0.22886811 -0.12639298 -0.0584348 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.3793339 0.8385863 2.6790013 4.38915   1.767478 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.63453937 0.9481981  0.5416485  0.57421136 0.9018724 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.1476942  -0.0676361  -0.11529329  0.23689638 -0.197455  ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.03391305  0.02672836  0.00645202 -0.01756239  0.01849586]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.03391305  0.02672836  0.00645202 -0.01756239  0.01849586]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.04079186  0.03774619  0.00109045 -0.03482039  0.00458241]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.28704146 -0.2872974  -0.1679911   0.21104163 -0.550811  ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.88270783 -0.56008095 -0.6329811   1.1664698  -1.347168  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.88270783 -0.56008095 -0.6329811   1.1664698  -1.347168  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.22350083 -0.21045913  0.01436405 -0.15915218 -0.2832844 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.2549526  -0.16747852  0.01510107 -0.1837955  -0.24089539]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.2549526  -0.16747852  0.01510107 -0.1837955  -0.24089539]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.353444   -1.3135363   1.2026534  -0.11117668  1.300144  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.353444   -1.3135363   1.2026534  -0.11117668  1.300144  ]
  [Layer 26] Output shape after mixer: (1, 1, 1024)
  [Layer 26] Output sample values after mixer: [-0.353444   -1.3135363   1.2026534  -0.11117668  1.300144  ]
  [Layer 26] Residual connection shape: (1, 1, 1024)
  [Layer 26] Residual connection sample values: [-1.5243901  4.502045  -2.2731583  0.8667013  4.028357 ]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.109267    0.30720097 -0.1572109   0.0718052   0.2907791 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.109267    0.30720097 -0.1572109   0.0718052   0.2907791 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.109267    0.30720097 -0.1572109   0.0718052   0.2907791 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.03042219 -0.65316725  0.528911    0.22995512  0.80833435]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.03042219 -0.65316725  0.528911    0.22995512  0.80833435]
  [FlaxMamba2] xBC (step) sample values: [-0.38122988 -0.51706624  0.97325826  0.3115061  -0.22041681]
  [FlaxMamba2] dt (step) sample values: [0.82272184 0.5789505  1.1096079  1.5588753  0.38686025]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.4002475   0.96141565  0.7113648  -0.38122988  1.3907242 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.05970596 -0.18566361  0.22969694 -0.19853632 -0.00802393]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04302811 -0.23745194  0.17464323 -0.39873165 -0.00616713]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.02197684 -0.10469598  0.09492736 -0.16013746 -0.00307405]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02197684 -0.10469598  0.09492736 -0.16013746 -0.00307405]
  [FlaxMamba2] B (step) sample values: [-0.14756985 -0.04317819  0.26616076  0.0725397   0.05215665]
  [FlaxMamba2] C (step) sample values: [-0.2599948  -0.0791361  -0.11300912 -0.15730192 -0.1569842 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.562595   -0.03025642 -0.75594616 -1.1612954  -0.04055573]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1670735  0.07821434 0.02797933 0.3223779  0.04633112]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.91028756 0.9976363  0.97907126 0.6877183  0.99812275]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02197684 -0.10469598  0.09492736 -0.16013746 -0.00307405]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00054184 -0.00015854  0.00097727  0.00026635  0.00019151]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00054184 -0.00015854  0.00097727  0.00026635  0.00019151]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0022716  -0.01109041 -0.00362969 -0.00683771 -0.00448125]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.04629362 -0.01804397  0.02559892 -0.0710815   0.03049038]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00258913 -0.22624885  0.21437733 -0.38954073  0.02437713]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00258913 -0.22624885  0.21437733 -0.38954073  0.02437713]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 3.8784416e-05  5.0581001e-02  7.1346104e-02 -4.9915537e-02
  1.3630930e-02]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 1.05475003e-04  1.08255215e-01  2.20260441e-01 -3.96503918e-02
  5.37446029e-02]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 1.05475003e-04  1.08255215e-01  2.20260441e-01 -3.96503918e-02
  5.37446029e-02]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.43401283  2.1021628   0.65458816  0.4776328  -1.8028022 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.43401283  2.1021628   0.65458816  0.4776328  -1.8028022 ]
  [Layer 27] Output shape after mixer: (1, 1, 1024)
  [Layer 27] Output sample values after mixer: [-0.43401283  2.1021628   0.65458816  0.4776328  -1.8028022 ]
  [Layer 27] Residual connection shape: (1, 1, 1024)
  [Layer 27] Residual connection sample values: [-1.9584029  6.604208  -1.6185701  1.3443341  2.225555 ]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.1144603   0.37145713 -0.09304454  0.09185393  0.12597878]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1144603   0.37145713 -0.09304454  0.09185393  0.12597878]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1144603   0.37145713 -0.09304454  0.09185393  0.12597878]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.30391508 -0.73045546 -0.10971253 -0.18965587  0.3644165 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.30391508 -0.73045546 -0.10971253 -0.18965587  0.3644165 ]
  [FlaxMamba2] xBC (step) sample values: [-1.2640718   0.919124    0.02294527  0.1795559   0.09595887]
  [FlaxMamba2] dt (step) sample values: [0.40865576 0.6786906  0.8584133  0.99001247 0.48355636]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.853424    0.5593082   0.00289398 -1.2640718  -1.7144372 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.3532563   0.2191757  -0.040164   -0.03351329 -0.03065563]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.2253266   0.12975919 -0.16931438 -0.12360118 -0.09626842]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.12530288  0.06908306 -0.07750741 -0.05798613 -0.04581909]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.12530288  0.06908306 -0.07750741 -0.05798613 -0.04581909]
  [FlaxMamba2] B (step) sample values: [ 0.06469485 -0.02718389  0.04482355  0.05223931 -0.25866887]
  [FlaxMamba2] C (step) sample values: [-0.07434828  0.11095807  0.04350045 -0.25933203 -0.01024101]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.54422176 -0.18426022 -0.10643356 -0.11241624 -0.25234625]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.25952289 0.83529484 1.5082086  1.520784   0.6933483 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8682826 0.8573478 0.8516974 0.8428546 0.8394874]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.12530288  0.06908306 -0.07750741 -0.05798613 -0.04581909]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00210381 -0.00088399  0.00145762  0.00169877 -0.00841164]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00210381 -0.00088399  0.00145762  0.00169877 -0.00841164]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01453223 -0.0047256   0.0051083   0.00041104  0.0058864 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01135003 -0.03061143 -0.01781228  0.00710129 -0.01130482]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.22242427  0.09827502 -0.16241583 -0.10108191 -0.09678829]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.22242427  0.09827502 -0.16241583 -0.10108191 -0.09678829]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0287022  -0.0233371   0.00842127  0.00867914 -0.02081389]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.14852262 -0.11347309  0.03908971  0.04654585 -0.1298841 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.14852262 -0.11347309  0.03908971  0.04654585 -0.1298841 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.9800775  2.8171391 -1.7683572  4.9894075 -0.1423572]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.9800775  2.8171391 -1.7683572  4.9894075 -0.1423572]
  [Layer 28] Output shape after mixer: (1, 1, 1024)
  [Layer 28] Output sample values after mixer: [-1.9800775  2.8171391 -1.7683572  4.9894075 -0.1423572]
  [Layer 28] Residual connection shape: (1, 1, 1024)
  [Layer 28] Residual connection sample values: [-3.9384804  9.421347  -3.3869271  6.3337417  2.0831978]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.24044049  0.56782717 -0.2083742   0.47781384  0.12774155]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.24044049  0.56782717 -0.2083742   0.47781384  0.12774155]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.24044049  0.56782717 -0.2083742   0.47781384  0.12774155]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.1562383  -0.92533976  0.25958535 -1.303229   -0.3874729 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.1562383  -0.92533976  0.25958535 -1.303229   -0.3874729 ]
  [FlaxMamba2] xBC (step) sample values: [0.17975312 0.21746472 0.19833252 0.21597196 0.2771041 ]
  [FlaxMamba2] dt (step) sample values: [1.0245222 1.4389031 2.159119  0.9992633 1.8800151]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.40678465  0.7908142   0.2164995   0.17975312  0.3649877 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04113558 -0.09008054 -0.15069509 -0.02838781  0.04906004]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.05512789 -0.1657031  -0.28900075  0.3383114   1.54906   ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.02832352 -0.07600284 -0.12376413  0.19749953  1.2776304 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02832352 -0.07600284 -0.12376413  0.19749953  1.2776304 ]
  [FlaxMamba2] B (step) sample values: [-0.0328085  -0.03062727 -0.1104513  -0.06399819  0.0122043 ]
  [FlaxMamba2] C (step) sample values: [-0.15070732 -0.04807509 -0.03775763 -0.02295974 -0.14061917]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6542169  -0.13693057 -1.458904   -0.36823887 -0.12178858]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.2163389  0.21450804 0.6202968  0.25880545 1.1683637 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8680269  0.9710545  0.40456071 0.90909815 0.8673668 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02832352 -0.07600284 -0.12376413  0.19749953  1.2776304 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.0103343e-04 -1.8766797e-04 -6.7678816e-04 -3.9214763e-04
  7.4781630e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.0103343e-04 -1.8766797e-04 -6.7678816e-04 -3.9214763e-04
  7.4781630e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00795065 -0.00065746 -0.0001801  -0.00283777  0.00239218]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00311712 -0.02594887 -0.03389509  0.04769321  0.3500176 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.05072757 -0.1537059  -0.24193649  0.37968016  2.4976513 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.05072757 -0.1537059  -0.24193649  0.37968016  2.4976513 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00427174  0.04037504 -0.03545455 -0.10570239 -0.39129528]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03073425  0.22680436 -0.1488014  -0.5447118  -0.31238934]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03073425  0.22680436 -0.1488014  -0.5447118  -0.31238934]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.2573386  -0.8975953   0.17144895 -1.5316821  -0.03708934]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.2573386  -0.8975953   0.17144895 -1.5316821  -0.03708934]
  [Layer 29] Output shape after mixer: (1, 1, 1024)
  [Layer 29] Output sample values after mixer: [ 1.2573386  -0.8975953   0.17144895 -1.5316821  -0.03708934]
  [Layer 29] Residual connection shape: (1, 1, 1024)
  [Layer 29] Residual connection sample values: [-2.6811419  8.523751  -3.2154782  4.8020597  2.0461085]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.14104356  0.42800462 -0.16459745  0.28844494  0.10460962]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.14104356  0.42800462 -0.16459745  0.28844494  0.10460962]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.14104356  0.42800462 -0.16459745  0.28844494  0.10460962]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.6256562   0.13751982  0.19701397 -1.0592926   1.384442  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.6256562   0.13751982  0.19701397 -1.0592926   1.384442  ]
  [FlaxMamba2] xBC (step) sample values: [ 1.0343224   1.0553019  -1.559564   -0.7383428   0.35998884]
  [FlaxMamba2] dt (step) sample values: [1.5214419 1.7802589 1.3019905 1.7603755 2.0097296]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.45068502 -1.0556526  -0.97053677  1.0343224  -0.7599255 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.18362096 -0.03078853  0.46612173  0.2668634   0.34984052]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.22643712 -0.07259761  1.041317    0.31630188  0.25731122]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.10045461 -0.03498178  0.76964164  0.1829562   0.14511715]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.10045461 -0.03498178  0.76964164  0.1829562   0.14511715]
  [FlaxMamba2] B (step) sample values: [ 0.05294269  0.13917495  0.01664608  0.05104616 -0.21337032]
  [FlaxMamba2] C (step) sample values: [-0.1476344  -0.15432031 -0.234148   -0.16223902 -0.25627857]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2037584  -0.36680323 -0.20777717 -0.09522027 -0.4265393 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.4259014  0.95173067 1.1149253  0.4743073  1.1541612 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7478601  0.7053241  0.7932189  0.955841   0.61122197]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.10045461 -0.03498178  0.76964164  0.1829562   0.14511715]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00758342 -0.01993519 -0.00238436 -0.00731177  0.03056282]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00758342 -0.01993519 -0.00238436 -0.00731177  0.03056282]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0026302  -0.03718507 -0.00370103 -0.02436962  0.08473773]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.11493916 -0.04095457  1.1132897   0.23141766 -0.1228991 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.1315303  -0.04673218  1.2404041   0.2616348  -0.09893148]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.1315303  -0.04673218  1.2404041   0.2616348  -0.09893148]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.17866492 -0.0034339   0.1341861  -0.07135022 -0.1095313 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.7252468  -0.01539605  0.36369708 -0.32103172 -0.18069015]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.7252468  -0.01539605  0.36369708 -0.32103172 -0.18069015]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.8188524 -1.7357318 -0.5283837 -3.2770443 -2.582753 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.8188524 -1.7357318 -0.5283837 -3.2770443 -2.582753 ]
  [Layer 30] Output shape after mixer: (1, 1, 1024)
  [Layer 30] Output sample values after mixer: [-1.8188524 -1.7357318 -0.5283837 -3.2770443 -2.582753 ]
  [Layer 30] Residual connection shape: (1, 1, 1024)
  [Layer 30] Residual connection sample values: [-4.4999943   6.788019   -3.743862    1.5250154  -0.53664446]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.148475    0.22713561 -0.1240729   0.05699046 -0.01773762]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.148475    0.22713561 -0.1240729   0.05699046 -0.01773762]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.148475    0.22713561 -0.1240729   0.05699046 -0.01773762]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.21361168  0.01460961  0.1331549  -0.09509556 -0.11784437]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.21361168  0.01460961  0.1331549  -0.09509556 -0.11784437]
  [FlaxMamba2] xBC (step) sample values: [-1.1196474   0.2735545   0.0641849   0.06418984 -1.1740971 ]
  [FlaxMamba2] dt (step) sample values: [-2.2138991 -0.6939002  2.0481195  1.748511  -0.6310107]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.78173983 -0.20685734 -0.2252947  -1.1196474   0.8216022 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.20975633 -0.06302506 -0.0114705  -0.04295303 -0.9504823 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.20684953 -0.02808244 -0.02204484 -0.06111099 -1.0107851 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.11408346 -0.01384408 -0.01090093 -0.02962215 -0.26970398]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.11408346 -0.01384408 -0.01090093 -0.02962215 -0.26970398]
  [FlaxMamba2] B (step) sample values: [-0.08305806  0.02680174 -0.09289275 -0.04484659  0.08071433]
  [FlaxMamba2] C (step) sample values: [-0.1144883  -0.02836998 -0.0449215  -0.14681631 -0.03700926]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-9.5765535e-03 -1.0641767e-02 -2.6350424e+01 -6.4467737e+02
 -1.6546801e-02]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00512767 0.0295634  2.670167   2.8427238  0.03390012]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.9995089e-01 9.9968547e-01 2.7734908e-31 0.0000000e+00 9.9943924e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.11408346 -0.01384408 -0.01090093 -0.02962215 -0.26970398]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.8587459e-05  1.5678532e-05 -5.4340577e-05 -2.6234442e-05
  4.7216421e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.8587459e-05  1.5678532e-05 -5.4340577e-05 -2.6234442e-05
  4.7216421e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01602606 -0.01053172  0.00780563  0.01544115  0.00585113]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00684379 -0.01671532 -0.00394782 -0.02925536 -0.04758192]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02115995 -0.01497805 -0.00257988 -0.02553812 -0.01373717]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02115995 -0.01497805 -0.00257988 -0.02553812 -0.01373717]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00250047 -0.00011021 -0.00018318  0.00115659  0.00076179]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.05654461 -0.00225391 -0.00379293  0.10600357  0.00455379]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.05654461 -0.00225391 -0.00379293  0.10600357  0.00455379]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.12072189  2.1123438  -0.10953851 -1.7686589  -0.8228986 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.12072189  2.1123438  -0.10953851 -1.7686589  -0.8228986 ]
  [Layer 31] Output shape after mixer: (1, 1, 1024)
  [Layer 31] Output sample values after mixer: [ 0.12072189  2.1123438  -0.10953851 -1.7686589  -0.8228986 ]
  [Layer 31] Residual connection shape: (1, 1, 1024)
  [Layer 31] Residual connection sample values: [-4.3792725   8.900363   -3.8534005  -0.24364352 -1.3595431 ]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.216842    0.4312707  -0.18542281 -0.01406118 -0.06830279]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.216842    0.4312707  -0.18542281 -0.01406118 -0.06830279]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.216842    0.4312707  -0.18542281 -0.01406118 -0.06830279]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.5968029 -2.2293613  1.6842847  0.7113175  1.0423241]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.5968029 -2.2293613  1.6842847  0.7113175  1.0423241]
  [FlaxMamba2] xBC (step) sample values: [-0.05959322  0.34624848  0.05484938 -0.93564904  0.60096794]
  [FlaxMamba2] dt (step) sample values: [2.726413  2.3983078 2.152867  2.6912832 0.8950577]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.19000448 -1.0760485  -0.37891003 -0.05959322  0.5137043 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.16941784  0.06566335  0.20075674  0.43757388 -0.06449767]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.15573071 -0.30225658  0.19867964  0.4140906  -0.07679626]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.08391614 -0.12846084  0.10917588  0.24931082 -0.03692444]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.08391614 -0.12846084  0.10917588  0.24931082 -0.03692444]
  [FlaxMamba2] B (step) sample values: [ 0.08683904  0.12667556  0.00622326 -0.02325102 -0.04427488]
  [FlaxMamba2] C (step) sample values: [-0.2715729  -0.2225304  -0.2774422  -0.26442868 -0.03834953]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.0662153  -0.08112868 -0.58786964 -0.09559295 -0.5447535 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [3.3015325 3.0763903 1.7054358 3.0729039 1.1013852]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8036335  0.7791252  0.36693376 0.7454644  0.54882073]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.08391614 -0.12846084  0.10917588  0.24931082 -0.03692444]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.02405892  0.0350957   0.00172417 -0.00644174 -0.01226644]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.02405892  0.0350957   0.00172417 -0.00644174 -0.01226644]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.02320596 0.1144838  0.1424969  0.29225132 0.16533108]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.7983217  -1.5324558   0.33947718  1.2180319  -0.5301314 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.7964219  -1.5295475   0.33700547  1.2123876  -0.52929544]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.7964219  -1.5295475   0.33700547  1.2123876  -0.52929544]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.30653706  0.3312549   0.47876525  0.5783999  -0.40786886]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.18453823  0.43308255  0.6239377   0.4723229  -0.37523255]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.18453823  0.43308255  0.6239377   0.4723229  -0.37523255]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.6643442  2.1368256 -1.3016167 -0.9259467  2.949739 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.6643442  2.1368256 -1.3016167 -0.9259467  2.949739 ]
  [Layer 32] Output shape after mixer: (1, 1, 1024)
  [Layer 32] Output sample values after mixer: [ 0.6643442  2.1368256 -1.3016167 -0.9259467  2.949739 ]
  [Layer 32] Residual connection shape: (1, 1, 1024)
  [Layer 32] Residual connection sample values: [-3.7149282 11.037189  -5.155017  -1.1695902  1.5901959]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.17480855  0.50722927 -0.24121778 -0.05780306  0.07566385]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.17480855  0.50722927 -0.24121778 -0.05780306  0.07566385]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.17480855  0.50722927 -0.24121778 -0.05780306  0.07566385]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.54988533  0.4906086   0.8380983  -0.9453741   0.77870876]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.54988533  0.4906086   0.8380983  -0.9453741   0.77870876]
  [FlaxMamba2] xBC (step) sample values: [ 1.9686584   1.3172693   0.5579031  -0.60394996 -0.6919117 ]
  [FlaxMamba2] dt (step) sample values: [1.2037915 1.3758558 1.1007867 0.5922061 1.1710353]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.18888599  0.28016454 -0.709317    1.9686584  -0.081631  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.48391697  0.30259246  0.0880949  -0.110334   -0.14712577]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.2136533   0.26600188  0.0747282  -0.23325881 -0.18148856]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.11819536  0.15058663  0.03875953 -0.10308833 -0.08253229]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.11819536  0.15058663  0.03875953 -0.10308833 -0.08253229]
  [FlaxMamba2] B (step) sample values: [ 0.29877365 -0.12019587 -0.12541498 -0.02472829 -0.09291411]
  [FlaxMamba2] C (step) sample values: [-0.03146248  0.30685472  0.16223915 -0.20307246 -0.02081713]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-13.044406    -1.3849771   -0.1667907   -0.23590268  -5.254998  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0462665  0.01895537 0.15809834 0.0928781  0.02658409]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.54688376 0.97408885 0.9739753  0.9783281  0.86961967]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.11819536  0.15058663  0.03875953 -0.10308833 -0.08253229]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00163384 -0.00065729 -0.00068583 -0.00013523 -0.0005081 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00163384 -0.00065729 -0.00068583 -0.00013523 -0.0005081 ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.2825394e-03 -1.5274757e-03 -3.2943237e-04 -1.1092678e-05
  1.4602434e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00058482  0.00103124  0.00050416 -0.00113269 -0.00016306]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.1271841   0.16232488  0.04201956 -0.11155081 -0.08856355]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.1271841   0.16232488  0.04201956 -0.11155081 -0.08856355]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0255892   0.04939544  0.0245834   0.02950863 -0.04726887]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.2316696   0.43356907  0.29449072  0.297069   -0.53803957]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.2316696   0.43356907  0.29449072  0.297069   -0.53803957]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.5575734   0.90502316 -1.5127361  -0.9322616  -2.1756978 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.5575734   0.90502316 -1.5127361  -0.9322616  -2.1756978 ]
  [Layer 33] Output shape after mixer: (1, 1, 1024)
  [Layer 33] Output sample values after mixer: [ 0.5575734   0.90502316 -1.5127361  -0.9322616  -2.1756978 ]
  [Layer 33] Residual connection shape: (1, 1, 1024)
  [Layer 33] Residual connection sample values: [-3.1573548 11.942212  -6.667753  -2.101852  -0.5855019]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.12445381  0.4636896  -0.27325186 -0.08403997 -0.02356983]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.12445381  0.4636896  -0.27325186 -0.08403997 -0.02356983]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.12445381  0.4636896  -0.27325186 -0.08403997 -0.02356983]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.01278   -1.5695076 -0.2750242  0.7563338 -0.4963516]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.01278   -1.5695076 -0.2750242  0.7563338 -0.4963516]
  [FlaxMamba2] xBC (step) sample values: [ 0.37849823 -0.68964386 -0.67307276  0.43410695 -0.8282537 ]
  [FlaxMamba2] dt (step) sample values: [-0.03513467 -1.6178054   0.69504994 -0.67370987  1.1425006 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.35401002  0.21654475 -0.631929    0.37849823 -1.399173  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06120475  0.4765641   0.1716215  -0.08267144 -0.3194527 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01783928  0.3793351   0.13762492 -0.16378716 -0.39348835]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.00899919  0.22521609  0.07354015 -0.07520197 -0.15852773]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00899919  0.22521609  0.07354015 -0.07520197 -0.15852773]
  [FlaxMamba2] B (step) sample values: [-0.01371449 -0.03248606 -0.03725436 -0.00220304 -0.07757375]
  [FlaxMamba2] C (step) sample values: [-0.27805838 -0.15260635  0.06299052 -0.11534052 -0.1747432 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2224774  -0.15365478 -0.8168739  -0.85911244 -2.0730147 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01265637 0.00142154 0.3547353  0.05204206 0.4711055 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9971882  0.9997816  0.74843264 0.9562748  0.37658608]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00899919  0.22521609  0.07354015 -0.07520197 -0.15852773]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.5620409e-06 -3.7000693e-06 -4.2431648e-06 -2.5092012e-07
 -8.8354291e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.5620409e-06 -3.7000693e-06 -4.2431648e-06 -2.5092012e-07
 -8.8354291e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00299479  0.00744252  0.00338369 -0.00669885  0.01064612]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02203019  0.07739052  0.04298549 -0.02064546 -0.03145766]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00432416  0.520506    0.18767667 -0.16860628 -0.34336296]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00432416  0.520506    0.18767667 -0.16860628 -0.34336296]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00116684 -0.14074749 -0.02228113 -0.08678645  0.06448998]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00693945 -0.46809196 -0.1108134  -0.5101028   0.40400365]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00693945 -0.46809196 -0.1108134  -0.5101028   0.40400365]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.09423442 -3.1902905   4.633343   -1.4540055   3.3417406 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.09423442 -3.1902905   4.633343   -1.4540055   3.3417406 ]
  [Layer 34] Output shape after mixer: (1, 1, 1024)
  [Layer 34] Output sample values after mixer: [ 0.09423442 -3.1902905   4.633343   -1.4540055   3.3417406 ]
  [Layer 34] Residual connection shape: (1, 1, 1024)
  [Layer 34] Residual connection sample values: [-3.0631204  8.751922  -2.03441   -3.5558574  2.7562387]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.14223     0.40319803 -0.09306744 -0.17602086  0.12720156]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.14223     0.40319803 -0.09306744 -0.17602086  0.12720156]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.14223     0.40319803 -0.09306744 -0.17602086  0.12720156]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.25063908 -0.7282118   0.03723928  0.38872233  4.020131  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.25063908 -0.7282118   0.03723928  0.38872233  4.020131  ]
  [FlaxMamba2] xBC (step) sample values: [-0.48985565  0.03885267 -1.6558402  -1.737758    1.6300253 ]
  [FlaxMamba2] dt (step) sample values: [3.1912057  2.7961957  0.45112458 2.5533347  2.0500371 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.6061976  -0.9954213   0.36135927 -0.48985565  1.106209  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.09289252  0.02955966 -0.5173824  -0.33402672  0.38209403]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04143988  0.00783115 -0.5448177  -0.35886803  0.26985037]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.02114919  0.0039309  -0.19998491 -0.1475786   0.15302032]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02114919  0.0039309  -0.19998491 -0.1475786   0.15302032]
  [FlaxMamba2] B (step) sample values: [-0.26520956 -0.05509899  0.06068321  0.19443142  0.03805574]
  [FlaxMamba2] C (step) sample values: [-0.22122122  0.14386727 -0.27311647 -0.06477951  0.24892007]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2053565  -0.14169171 -0.10705902 -0.1460468  -0.2580783 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [4.7555113 4.9750032 1.1568296 4.896771  2.4849453]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.3765987  0.4941497  0.8835132  0.48911494 0.5266019 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02114919  0.0039309  -0.19998491 -0.1475786   0.15302032]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.02667351 -0.00554159  0.00610323  0.01955499  0.00382746]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.02667351 -0.00554159  0.00610323  0.01955499  0.00382746]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01174134 -0.0053902  -0.00891868  0.00058958 -0.0206271 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.05916027  0.09717931 -0.84398687 -0.7206451   0.49137914]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.11454239  0.10747293 -1.3676753  -1.1071004   0.89208424]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.11454239  0.10747293 -1.3676753  -1.1071004   0.89208424]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01256487 -0.02548146 -0.02593973 -0.25648063  3.5230546 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01787669 -0.03515518 -0.01237775 -0.52740204  4.1989093 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01787669 -0.03515518 -0.01237775 -0.52740204  4.1989093 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.270955   -1.1208383  -0.14892876 -2.1982598   1.7681037 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.270955   -1.1208383  -0.14892876 -2.1982598   1.7681037 ]
  [Layer 35] Output shape after mixer: (1, 1, 1024)
  [Layer 35] Output sample values after mixer: [-1.270955   -1.1208383  -0.14892876 -2.1982598   1.7681037 ]
  [Layer 35] Residual connection shape: (1, 1, 1024)
  [Layer 35] Residual connection sample values: [-4.3340755  7.6310835 -2.1833386 -5.754117   4.5243425]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.16062698  0.28917113 -0.08139174 -0.22762549  0.17177226]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.16062698  0.28917113 -0.08139174 -0.22762549  0.17177226]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.16062698  0.28917113 -0.08139174 -0.22762549  0.17177226]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-3.2683506   0.03347956 -1.6800178  -0.45660508 -0.47610673]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-3.2683506   0.03347956 -1.6800178  -0.45660508 -0.47610673]
  [FlaxMamba2] xBC (step) sample values: [ 2.9650278   2.6882513   0.09157414 -0.6075065  -0.9226568 ]
  [FlaxMamba2] dt (step) sample values: [0.97626865 2.1148224  1.543703   1.0192128  2.1596174 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [0.72343063 1.8071251  0.94556344 2.9650278  1.1233456 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.7942281   0.6273645   0.02504853 -0.16021842 -0.14048208]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.7539449   0.5098108  -0.03705474 -0.30487174 -0.15260519]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.24123396  0.31851047 -0.01818415 -0.1293775  -0.07049178]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.24123396  0.31851047 -0.01818415 -0.1293775  -0.07049178]
  [FlaxMamba2] B (step) sample values: [ 0.19355041 -0.00805687  0.01199125  0.06784347 -0.20253314]
  [FlaxMamba2] C (step) sample values: [-0.10490698  0.00913036 -0.24680492 -0.08705984 -0.09981668]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.8654757 -5.63779   -3.8975632 -2.4259677 -3.6937442]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.17587893 0.13379899 0.08227275 0.10610831 0.19708204]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.6041234  0.47032532 0.7256676  0.7730471  0.48288792]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.24123396  0.31851047 -0.01818415 -0.1293775  -0.07049178]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00821195  0.00034184 -0.00050876 -0.00287846  0.00859307]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00821195  0.00034184 -0.00050876 -0.00287846  0.00859307]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01292477  0.00193618 -0.00375037  0.00409199  0.00468324]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02171018  0.05350764 -0.02007019 -0.03952778 -0.02419269]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.7615351   1.030327   -0.07583798 -0.43630734 -0.24037942]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.7615351   1.030327   -0.07583798 -0.43630734 -0.24037942]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [0.0912779  0.01753614 0.0200151  0.07725588 0.04385259]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.21772122 0.0893244  0.07043218 0.2898836  0.1872457 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.21772122 0.0893244  0.07043218 0.2898836  0.1872457 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [5.6547246 2.3568785 6.913373  2.6995997 2.2120278]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [5.6547246 2.3568785 6.913373  2.6995997 2.2120278]
  [Layer 36] Output shape after mixer: (1, 1, 1024)
  [Layer 36] Output sample values after mixer: [5.6547246 2.3568785 6.913373  2.6995997 2.2120278]
  [Layer 36] Residual connection shape: (1, 1, 1024)
  [Layer 36] Residual connection sample values: [ 1.3206491  9.987962   4.7300344 -3.0545173  6.73637  ]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.0414249   0.32170048  0.15565424 -0.09813984  0.21675657]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.0414249   0.32170048  0.15565424 -0.09813984  0.21675657]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.0414249   0.32170048  0.15565424 -0.09813984  0.21675657]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.62959576 -0.7033862   0.35786492 -0.640298   -0.38632092]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.62959576 -0.7033862   0.35786492 -0.640298   -0.38632092]
  [FlaxMamba2] xBC (step) sample values: [-0.63286954  0.6878755   0.6382046  -0.81140417  1.6344478 ]
  [FlaxMamba2] dt (step) sample values: [-0.870161   -0.21626486  4.1248207   0.3330221  -0.2187859 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6261729  -0.61719257 -0.649439   -0.63286954  2.0892944 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.18982704 -0.33744276 -0.2846348   0.29191723  0.10425459]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.11206825 -0.40152967 -0.36922953  0.32679883  0.02063642]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.05917067 -0.16099127 -0.15091416  0.18986368  0.01042467]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05917067 -0.16099127 -0.15091416  0.18986368  0.01042467]
  [FlaxMamba2] B (step) sample values: [-0.19461283 -0.09691373 -0.18370426 -0.02446181 -0.09071319]
  [FlaxMamba2] C (step) sample values: [-0.26961553 -0.24919118 -0.1287133  -0.19726565 -0.27547413]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.8178532  -31.169907   -39.01954     -0.46187502  -0.64770097]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00026455 0.0058287  0.18824747 0.00103379 0.00133104]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.9951923e-01 8.3386815e-01 6.4560043e-04 9.9952263e-01 9.9913824e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05917067 -0.16099127 -0.15091416  0.18986368  0.01042467]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.0463898e-06 -1.5170480e-06 -2.8756315e-06 -3.8291512e-07
 -1.4199873e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.0463898e-06 -1.5170480e-06 -2.8756315e-06 -3.8291512e-07
 -1.4199873e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00041295  0.00034934 -0.00062358  0.00090243 -0.00058068]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00034083  0.00290276 -0.00931743  0.00622263 -0.00427521]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.10871857 -0.29197088 -0.2857337   0.35397935  0.01481875]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.10871857 -0.29197088 -0.2857337   0.35397935  0.01481875]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.04465581  0.06798961 -0.06017892 -0.07823564 -0.00231627]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.37375334  0.41149372 -0.3425632  -0.70459306 -0.01113166]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.37375334  0.41149372 -0.3425632  -0.70459306 -0.01113166]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-7.02334    -1.1834502  -4.6072865  -0.34301594 -1.3384348 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-7.02334    -1.1834502  -4.6072865  -0.34301594 -1.3384348 ]
  [Layer 37] Output shape after mixer: (1, 1, 1024)
  [Layer 37] Output sample values after mixer: [-7.02334    -1.1834502  -4.6072865  -0.34301594 -1.3384348 ]
  [Layer 37] Residual connection shape: (1, 1, 1024)
  [Layer 37] Residual connection sample values: [-5.702691   8.804512   0.1227479 -3.3975332  5.3979354]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.17000702  0.26247764  0.0036419  -0.09815125  0.16199455]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.17000702  0.26247764  0.0036419  -0.09815125  0.16199455]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.17000702  0.26247764  0.0036419  -0.09815125  0.16199455]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.5466706 -1.7287607 -0.2970225 -1.5266495 -0.9585092]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.5466706 -1.7287607 -0.2970225 -1.5266495 -0.9585092]
  [FlaxMamba2] xBC (step) sample values: [ 0.83034813 -0.96329474  0.943899    0.29750106  0.46955627]
  [FlaxMamba2] dt (step) sample values: [1.4627268  2.2750137  0.95817435 1.7891691  2.0377746 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.5038368   1.7691193   2.66538     0.83034813 -0.56046414]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.6987889   0.03520286 -0.394732   -0.2596004   0.8545174 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.7011788  -0.25410378 -0.4848199  -0.30278277  0.94747394]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.23247647 -0.110996   -0.18477196 -0.12864554  0.6827563 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.23247647 -0.110996   -0.18477196 -0.12864554  0.6827563 ]
  [FlaxMamba2] B (step) sample values: [-0.0300079  -0.05538326 -0.00625634  0.02444158 -0.02255668]
  [FlaxMamba2] C (step) sample values: [ 0.09388291 -0.06824926 -0.18391329 -0.2583883  -0.04674573]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17041285 -2.0831616  -0.13507122 -0.41240796 -3.531486  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.8370391 0.7996508 1.2481774 1.1237193 0.5839678]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.73120964 0.18903904 0.8448528  0.62912154 0.12716444]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.23247647 -0.110996   -0.18477196 -0.12864554  0.6827563 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01281543  0.02365244  0.00267188 -0.01043823  0.00963324]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01281543  0.02365244  0.00267188 -0.01043823  0.00963324]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01350043  0.16337064  0.00162226 -0.00117626 -0.01771101]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.39623806 -0.35553733 -0.24888103 -0.23609662  1.059481  ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.43033326 -0.3718161  -0.27597985 -0.25496387  1.1596146 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.43033326 -0.3718161  -0.27597985 -0.25496387  1.1596146 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.11685498  0.09689678  0.03494357  0.06947336 -0.30808234]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.45303988  0.25292632  0.10087074  0.4004261  -1.2277395 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.45303988  0.25292632  0.10087074  0.4004261  -1.2277395 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.0314377e+01  1.7695362e+01  5.2425885e+00 -6.5735698e+00
 -1.2803787e-02]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.0314377e+01  1.7695362e+01  5.2425885e+00 -6.5735698e+00
 -1.2803787e-02]
  [Layer 38] Output shape after mixer: (1, 1, 1024)
  [Layer 38] Output sample values after mixer: [-1.0314377e+01  1.7695362e+01  5.2425885e+00 -6.5735698e+00
 -1.2803787e-02]
  [Layer 38] Residual connection shape: (1, 1, 1024)
  [Layer 38] Residual connection sample values: [-16.017067   26.499874    5.3653364  -9.971103    5.385132 ]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.2924001   0.5261069   0.10330454 -0.20135507  0.1031796 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.2924001   0.5261069   0.10330454 -0.20135507  0.1031796 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.2924001   0.5261069   0.10330454 -0.20135507  0.1031796 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.07385912  0.2017977   0.31166562 -1.9589413  -0.8964656 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.07385912  0.2017977   0.31166562 -1.9589413  -0.8964656 ]
  [FlaxMamba2] xBC (step) sample values: [-0.62293774  1.6666474   1.921846   -0.8420479  -0.1484607 ]
  [FlaxMamba2] dt (step) sample values: [-0.1532063   1.2240407  -1.9159645   1.2084659  -0.12419102]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.16301915  2.4909613  -0.6531149  -0.62293774  0.39856797]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.11599986 -0.2911891   0.3990471  -0.20287742 -0.04757258]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.05154674 -0.35191908  0.4143059   0.33472025 -0.05097529]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.02510925 -0.14531343  0.24946183  0.19511093 -0.02483816]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02510925 -0.14531343  0.24946183  0.19511093 -0.02483816]
  [FlaxMamba2] B (step) sample values: [ 0.00113287 -0.03046143 -0.2770907   0.02541914  0.08271197]
  [FlaxMamba2] C (step) sample values: [-0.27694067 -0.21660686  0.00286609  0.04823932 -0.26912388]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.7351256e+02 -2.3790452e+00 -2.6078771e-03 -1.4978828e+00
 -6.3306607e-02]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.23527981 0.7190693  0.0434557  0.3719095  0.00788353]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [1.8636377e-18 1.8073952e-01 9.9988669e-01 5.7288122e-01 9.9950105e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02510925 -0.14531343  0.24946183  0.19511093 -0.02483816]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.6926286e-06  1.7995700e-04  1.6369686e-03 -1.5016862e-04
 -4.8863748e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.6926286e-06  1.7995700e-04  1.6369686e-03 -1.5016862e-04
 -4.8863748e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-6.6926286e-06  1.7995700e-04  1.6369686e-03 -1.5016862e-04
 -4.8863748e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00186562 -0.01079683  0.01853509  0.01449679 -0.00184548]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.1154815  -0.66832     1.1473155   0.8973468  -0.11423474]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.1154815  -0.66832     1.1473155   0.8973468  -0.11423474]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0044221  -0.0742136   0.20642728 -0.21723798  0.02967538]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.0237038  -0.37687     0.9918862  -1.0185386   0.16783968]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0237038  -0.37687     0.9918862  -1.0185386   0.16783968]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.5673712   0.29359293 -8.464728   -5.151807    0.9067005 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.5673712   0.29359293 -8.464728   -5.151807    0.9067005 ]
  [Layer 39] Output shape after mixer: (1, 1, 1024)
  [Layer 39] Output sample values after mixer: [-1.5673712   0.29359293 -8.464728   -5.151807    0.9067005 ]
  [Layer 39] Residual connection shape: (1, 1, 1024)
  [Layer 39] Residual connection sample values: [-17.584438   26.793467   -3.099392  -15.12291     6.2918324]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.3556355   0.5782239  -0.06551716 -0.2927857   0.13173698]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.3556355   0.5782239  -0.06551716 -0.2927857   0.13173698]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.3556355   0.5782239  -0.06551716 -0.2927857   0.13173698]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.9566278   0.81318027  0.8186455  -0.7709333   1.0074377 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.9566278   0.81318027  0.8186455  -0.7709333   1.0074377 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.00375456  1.1060499  -0.8782012  -0.46321487  1.0620607 ]
  [FlaxMamba2] dt (step) sample values: [ 0.9174367  -0.37098524 -0.5461313  -2.9313407  -0.2079705 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.8997272  -0.4070388  -0.30949703  0.00375456 -0.24577239]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00046069 -0.19772738 -0.16042608  0.03796213  0.1889781 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.3317595  -0.24621981 -0.23208135  0.02641123  0.19051066]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.19314621 -0.10802996 -0.10263535  0.01337999  0.10430157]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.19314621 -0.10802996 -0.10263535  0.01337999  0.10430157]
  [FlaxMamba2] B (step) sample values: [ 0.00020409  0.10033374 -0.00751251 -0.02652197  0.01647012]
  [FlaxMamba2] C (step) sample values: [-0.1777101  -0.2657595  -0.2778295  -0.13761002  0.03748119]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.52670574 -0.63007647 -0.38779998 -2.7909086  -0.42841786]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04414213 0.00895708 0.01613963 0.00032455 0.01309377]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9770183  0.99437225 0.9937606  0.9990946  0.9944061 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.19314621 -0.10802996 -0.10263535  0.01337999  0.10430157]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.7400138e-06  8.5543393e-04 -6.4050779e-05 -2.2612329e-04
  1.4042230e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.7400138e-06  8.5543393e-04 -6.4050779e-05 -2.2612329e-04
  1.4042230e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00273516 -0.04340766 -0.00682663  0.00013779 -0.00058024]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0876215  -0.05057188 -0.05551725 -0.01669918  0.05145319]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.5657789  -0.31801346 -0.3096038   0.01642466  0.3096647 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.5657789  -0.31801346 -0.3096038   0.01642466  0.3096647 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.15022323 -0.17915623 -0.1758853  -0.0040048   0.22852223]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.89744765 -1.2671472  -1.2664098  -0.02278855  2.1417718 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.89744765 -1.2671472  -1.2664098  -0.02278855  2.1417718 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.927703    0.6713003  -7.9600377   0.17595729 -3.6209474 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.927703    0.6713003  -7.9600377   0.17595729 -3.6209474 ]
  [Layer 40] Output shape after mixer: (1, 1, 1024)
  [Layer 40] Output sample values after mixer: [ 1.927703    0.6713003  -7.9600377   0.17595729 -3.6209474 ]
  [Layer 40] Residual connection shape: (1, 1, 1024)
  [Layer 40] Residual connection sample values: [-15.656735  27.464767 -11.059429 -14.946952   2.670885]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.19322342  0.3623984  -0.14077903 -0.1822724   0.03303112]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.19322342  0.3623984  -0.14077903 -0.1822724   0.03303112]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.19322342  0.3623984  -0.14077903 -0.1822724   0.03303112]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.4561863  -1.5655063  -0.5801686   1.1806037   0.22420523]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.4561863  -1.5655063  -0.5801686   1.1806037   0.22420523]
  [FlaxMamba2] xBC (step) sample values: [-1.0690017   1.2318239  -0.16823576  1.2908577   0.60607076]
  [FlaxMamba2] dt (step) sample values: [ 2.2523255   0.76760966  0.56535006  0.31615314 -0.4361772 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.21741539 -0.6705064  -1.1127415  -1.0690017   0.0092644 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.27370062  0.01137311 -0.0385259  -0.22391114 -0.13439259]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.30537787  0.1337486  -0.03846338 -0.31662354 -0.14395222]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.12955454  0.07133982 -0.01886187 -0.13345647 -0.06680448]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.12955454  0.07133982 -0.01886187 -0.13345647 -0.06680448]
  [FlaxMamba2] B (step) sample values: [-0.07888427  0.08286893  0.16191621  0.00948985  0.17858306]
  [FlaxMamba2] C (step) sample values: [-0.23870592 -0.03311397  0.08658977 -0.19698925 -0.2352082 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.0530885  -1.135641   -0.87189615 -1.5713016  -1.7430981 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.53047407 0.4070349  0.1738765  0.16938299 0.05371346]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.57198864 0.6298677  0.85933    0.76632285 0.9106216 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.12955454  0.07133982 -0.01886187 -0.13345647 -0.06680448]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00542135 -0.00569519 -0.01112774 -0.00065219 -0.01227318]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00542135 -0.00569519 -0.01112774 -0.00065219 -0.01227318]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00943493 -0.0052904  -0.01334151 -0.00214403 -0.01215918]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.03012968  0.02091621  0.00100234 -0.0333831  -0.00922903]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.19584347  0.11216729 -0.02312397 -0.20408788 -0.09467894]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.19584347  0.11216729 -0.02312397 -0.20408788 -0.09467894]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.23127006 -0.03035362  0.00481485 -0.18433797 -0.01179863]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-4.819413   -0.84441024  0.11564061 -5.3812413  -0.31982648]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-4.819413   -0.84441024  0.11564061 -5.3812413  -0.31982648]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.656396    2.7526689  -4.0507855   0.97707015 -5.828556  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.656396    2.7526689  -4.0507855   0.97707015 -5.828556  ]
  [Layer 41] Output shape after mixer: (1, 1, 1024)
  [Layer 41] Output sample values after mixer: [ 3.656396    2.7526689  -4.0507855   0.97707015 -5.828556  ]
  [Layer 41] Residual connection shape: (1, 1, 1024)
  [Layer 41] Residual connection sample values: [-12.0003395  30.217436  -15.110214  -13.969882   -3.157671 ]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.14015414  0.379234   -0.18867862 -0.16293555 -0.03880422]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.14015414  0.379234   -0.18867862 -0.16293555 -0.03880422]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.14015414  0.379234   -0.18867862 -0.16293555 -0.03880422]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.16996035  1.0208093  -0.83635956 -0.54235286  0.81437755]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.16996035  1.0208093  -0.83635956 -0.54235286  0.81437755]
  [FlaxMamba2] xBC (step) sample values: [ 0.26332572  0.52784085 -0.42744    -0.26796418  0.13293771]
  [FlaxMamba2] dt (step) sample values: [ 1.3078045  -0.7444887   2.8772233   0.17244422  1.3305215 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.1301969   0.85377     0.7886849   0.26332572  0.18243727]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.0615292   0.10988091  0.09530739  0.05409213  0.04171605]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.08240323  0.07411431  0.09992699  0.05035182 -0.00445705]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.039505    0.03842976  0.05245777  0.0258096  -0.00222356]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.039505    0.03842976  0.05245777  0.0258096  -0.00222356]
  [FlaxMamba2] B (step) sample values: [ 0.00654092 -0.07958233  0.04390315 -0.00201679  0.0250528 ]
  [FlaxMamba2] C (step) sample values: [ 0.09607963 -0.22591183 -0.03260243 -0.11904468 -0.24578454]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.2458453 -1.7473589 -3.3796544 -1.2264227 -1.3705136]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.33912426 0.06403306 1.2423182  0.02464492 0.2658372 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.4669091 0.8941437 0.0150165 0.9702271 0.6946595]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.039505    0.03842976  0.05245777  0.0258096  -0.00222356]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-8.7629378e-05  1.0661728e-03 -5.8817508e-04  2.7019187e-05
 -3.3563498e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-8.7629378e-05  1.0661728e-03 -5.8817508e-04  2.7019187e-05
 -3.3563498e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.1675535e-03  1.5377039e-03  9.8140049e-04  2.8120575e-04
 -5.1317329e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00704234  0.00607277  0.00936107  0.00401235  0.00045616]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.06105427  0.05861461  0.08108225  0.03929969 -0.00258393]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.06105427  0.05861461  0.08108225  0.03929969 -0.00258393]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00562826  0.04398603 -0.02050029 -0.007836   -0.00145836]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.13102315  0.9846889  -0.47248137 -0.18296371 -0.02319156]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.13102315  0.9846889  -0.47248137 -0.18296371 -0.02319156]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-4.775626   -5.1136007  -0.28991884  1.3143821   5.8683124 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-4.775626   -5.1136007  -0.28991884  1.3143821   5.8683124 ]
  [Layer 42] Output shape after mixer: (1, 1, 1024)
  [Layer 42] Output sample values after mixer: [-4.775626   -5.1136007  -0.28991884  1.3143821   5.8683124 ]
  [Layer 42] Residual connection shape: (1, 1, 1024)
  [Layer 42] Residual connection sample values: [-16.775967   25.103836  -15.400133  -12.6555      2.7106414]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.17839204  0.29222316 -0.17157067 -0.13448288  0.02930246]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.17839204  0.29222316 -0.17157067 -0.13448288  0.02930246]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.17839204  0.29222316 -0.17157067 -0.13448288  0.02930246]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.78866136  2.7902083  -0.1280566  -0.6503319   0.679342  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.78866136  2.7902083  -0.1280566  -0.6503319   0.679342  ]
  [FlaxMamba2] xBC (step) sample values: [-0.14547695 -0.07147177  0.13653828  0.13938235 -0.19896041]
  [FlaxMamba2] dt (step) sample values: [ 0.3461672   0.8886929  -2.2710989   0.7009137  -0.27205202]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.2407873  -0.4484206  -0.01252129 -0.14547695  0.01753203]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02879066  0.01061211 -0.02910266  0.02603272 -0.03743995]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04338569 -0.04361763 -0.0571178  -0.02178833 -0.04575599]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.02122234 -0.02133327 -0.02774351 -0.01077549 -0.02235468]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02122234 -0.02133327 -0.02774351 -0.01077549 -0.02235468]
  [FlaxMamba2] B (step) sample values: [ 0.03083576 -0.07665664  0.16625237 -0.276989    0.14049418]
  [FlaxMamba2] C (step) sample values: [-0.21209653  0.08849881  0.24958006 -0.2768142   0.02485524]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-3.7045815 -2.655313  -8.210951  -2.2381823 -4.092597 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08603359 0.18298769 0.00663992 0.6190779  0.00097537]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7270802  0.61514974 0.9469395  0.25017133 0.99601614]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02122234 -0.02133327 -0.02774351 -0.01077549 -0.02235468]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.6300978e-05  1.3996230e-04 -3.0354926e-04  5.0573598e-04
 -2.5651907e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.6300978e-05  1.3996230e-04 -3.0354926e-04  5.0573598e-04
 -2.5651907e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.3280479e-04 -7.0954484e-05 -4.6764931e-04  1.2543974e-03
 -1.0364729e-03]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-6.6242035e-04 -3.4661419e-03 -1.9013915e-03  4.9675105e-04
 -4.7996789e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03566614 -0.03865283 -0.047661   -0.01727613 -0.03691939]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03566614 -0.03865283 -0.047661   -0.01727613 -0.03691939]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00878893 -0.10160974  0.00285653  0.00385272 -0.01664347]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.18887638 -2.9257874   0.06583859  0.0894247  -0.39927506]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.18887638 -2.9257874   0.06583859  0.0894247  -0.39927506]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.5342156  5.0509396  2.524834  -2.9000938 -6.093034 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.5342156  5.0509396  2.524834  -2.9000938 -6.093034 ]
  [Layer 43] Output shape after mixer: (1, 1, 1024)
  [Layer 43] Output sample values after mixer: [-1.5342156  5.0509396  2.524834  -2.9000938 -6.093034 ]
  [Layer 43] Residual connection shape: (1, 1, 1024)
  [Layer 43] Residual connection sample values: [-18.310183   30.154776  -12.875299  -15.555594   -3.3823924]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.18360329  0.31268647 -0.1338612  -0.15247077 -0.03433299]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18360329  0.31268647 -0.1338612  -0.15247077 -0.03433299]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18360329  0.31268647 -0.1338612  -0.15247077 -0.03433299]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.5071357  -0.39073473 -0.37344185  0.20235747  0.25999713]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.5071357  -0.39073473 -0.37344185  0.20235747  0.25999713]
  [FlaxMamba2] xBC (step) sample values: [-0.5636504  -0.04230376 -0.3960046  -0.13162658  1.0312152 ]
  [FlaxMamba2] dt (step) sample values: [-0.4642082  -0.47624335  0.46185598  0.20789902  0.6195885 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.47152138  0.2909551  -0.7955969  -0.5636504   0.06587735]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.1151079   0.01088517 -0.06493994  0.02497746  0.19118384]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.09362353 -0.0461827  -0.09367224  0.01182439  0.19781378]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.04462202 -0.02255823 -0.0446441   0.00594715  0.10865769]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04462202 -0.02255823 -0.0446441   0.00594715  0.10865769]
  [FlaxMamba2] B (step) sample values: [-0.07445157 -0.26695192 -0.2668053   0.1125237   0.09820902]
  [FlaxMamba2] C (step) sample values: [ 0.03832739 -0.25190994 -0.15453738 -0.02780891 -0.01438443]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-4.6876054  -0.9752563  -0.82549465 -1.2937802  -0.49527767]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06355069 0.02782048 0.03866383 0.05555836 0.01436342]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.74237514 0.9732327  0.96858716 0.93064225 0.99291134]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04462202 -0.02255823 -0.0446441   0.00594715  0.10865769]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00021113  0.00075701  0.0007566  -0.00031909 -0.0002785 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00021113  0.00075701  0.0007566  -0.00031909 -0.0002785 ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-8.1125234e-04  1.6748810e-03  1.7558999e-03  4.9720693e-05
 -1.2300934e-03]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0020239   0.00089452 -0.00128687  0.00077416  0.00178349]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07956991 -0.03830812 -0.07887124  0.01110936  0.19061334]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07956991 -0.03830812 -0.07887124  0.01110936  0.19061334]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.09817303  0.00604032  0.0120086   0.00123737  0.02798273]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-2.3383844   0.13175409  0.3319717   0.02940154  0.6519787 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-2.3383844   0.13175409  0.3319717   0.02940154  0.6519787 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-5.4311624 12.45726    3.8183644 -1.9926159  4.6389885]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-5.4311624 12.45726    3.8183644 -1.9926159  4.6389885]
  [Layer 44] Output shape after mixer: (1, 1, 1024)
  [Layer 44] Output sample values after mixer: [-5.4311624 12.45726    3.8183644 -1.9926159  4.6389885]
  [Layer 44] Residual connection shape: (1, 1, 1024)
  [Layer 44] Residual connection sample values: [-23.741344   42.612038   -9.056935  -17.54821     1.2565961]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.27447185  0.5318659  -0.11000738 -0.20356591  0.01471747]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.27447185  0.5318659  -0.11000738 -0.20356591  0.01471747]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.27447185  0.5318659  -0.11000738 -0.20356591  0.01471747]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.00662948 -2.143022   -0.84702855 -0.5235071  -1.7689679 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.00662948 -2.143022   -0.84702855 -0.5235071  -1.7689679 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.24022754  1.3188651  -0.6050354  -0.09948613  0.07393379]
  [FlaxMamba2] dt (step) sample values: [ 0.15788907 -0.7229606   0.3497069  -0.2735155   0.94969565]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.3553896  -0.18906733  0.30722773  0.24022754  0.26907235]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04138977  0.14897266 -0.11660437  0.0177176   0.00732794]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03572876  0.4070293  -0.13889746 -0.03828216 -0.00342188]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.01818348  0.24437036 -0.06463335 -0.01877474 -0.00170801]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01818348  0.24437036 -0.06463335 -0.01877474 -0.00170801]
  [FlaxMamba2] B (step) sample values: [-0.15697995  0.09952725 -0.07711244 -0.16269496 -0.10813887]
  [FlaxMamba2] C (step) sample values: [-0.19585761 -0.25985664 -0.2020349  -0.09074205 -0.26683247]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.3039274e+00 -3.9384812e-02 -6.8873577e+00 -8.0558503e-01
 -1.9935181e+03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00259859 0.00904087 0.01094203 0.0004785  0.04870273]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9966174  0.999644   0.92740804 0.9996146  0.        ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01818348  0.24437036 -0.06463335 -0.01877474 -0.00170801]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.4175286e-06  4.7028057e-06 -3.6436741e-06 -7.6875713e-06
 -5.1097172e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.4175286e-06  4.7028057e-06 -3.6436741e-06 -7.6875713e-06
 -5.1097172e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00165306 0.00097195 0.00122247 0.00017602 0.0016229 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00153823  0.02966877 -0.00665693 -0.00964619  0.00398001]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 4.5653600e-02  6.6388631e-01 -1.7440070e-01 -5.8372531e-02
 -4.5281602e-04]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 4.5653600e-02  6.6388631e-01 -1.7440070e-01 -5.8372531e-02
 -4.5281602e-04]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-1.50828258e-04 -1.49364695e-01  4.43250686e-02  1.13687320e-02
  1.16684736e-04]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00186735 -1.3873919   0.49157557  0.11941994  0.00147009]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00186735 -1.3873919   0.49157557  0.11941994  0.00147009]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ -1.8777814   -3.5887702   -3.8944046   -0.30588147 -11.160941  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ -1.8777814   -3.5887702   -3.8944046   -0.30588147 -11.160941  ]
  [Layer 45] Output shape after mixer: (1, 1, 1024)
  [Layer 45] Output sample values after mixer: [ -1.8777814   -3.5887702   -3.8944046   -0.30588147 -11.160941  ]
  [Layer 45] Residual connection shape: (1, 1, 1024)
  [Layer 45] Residual connection sample values: [-25.619125  39.023266 -12.95134  -17.854092  -9.904345]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.26417157  0.4327664  -0.14074922 -0.18741167 -0.10108838]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.26417157  0.4327664  -0.14074922 -0.18741167 -0.10108838]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.26417157  0.4327664  -0.14074922 -0.18741167 -0.10108838]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.0162382  -0.99569124 -0.98561805 -0.5566496  -0.6091153 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.0162382  -0.99569124 -0.98561805 -0.5566496  -0.6091153 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.2188412  -1.1098316   1.0938568   0.2707194   0.32001972]
  [FlaxMamba2] dt (step) sample values: [-0.20676471 -0.43489859 -1.3684022  -0.41460043  0.36782783]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [0.32960883 1.3960607  0.3864614  1.2188412  1.4445618 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.02971646  0.20493975  0.2131921  -0.04701445 -0.05138992]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0851669   0.16761675  0.41607296 -0.0425131  -0.05664276]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.0443957   0.09081582  0.2507019  -0.02080478 -0.02751949]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0443957   0.09081582  0.2507019  -0.02080478 -0.02751949]
  [FlaxMamba2] B (step) sample values: [-0.21124026 -0.01386359 -0.0229699   0.06306169 -0.08283281]
  [FlaxMamba2] C (step) sample values: [ 0.08055471 -0.06420811 -0.15198673 -0.04916975  0.04168963]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.4426116  -0.9829804 -10.158994   -1.363838   -1.7559118]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00714881 0.00904945 0.00027773 0.00864342 0.01567567]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9897401  0.991144   0.9971825  0.98828095 0.97285026]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0443957   0.09081582  0.2507019  -0.02080478 -0.02751949]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.7042645e-05 -4.3999753e-06 -7.2901021e-06  2.0014284e-05
 -2.6289166e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.7042645e-05 -4.3999753e-06 -7.2901021e-06  2.0014284e-05
 -2.6289166e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.5310358e-03  3.0698639e-04 -5.0220206e-05  4.2138557e-04
 -8.2466291e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00021316 -0.00082708  0.00105154  0.00046959 -0.00016839]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.05417685  0.11043308  0.30819115 -0.02501873 -0.03388303]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.05417685  0.11043308  0.30819115 -0.02501873 -0.03388303]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01463188 -0.0296653  -0.08255509  0.00507381  0.0072702 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.5154776  -0.97163194 -2.3065262   0.14034459  0.2009857 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.5154776  -0.97163194 -2.3065262   0.14034459  0.2009857 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.2294097   7.0370884  -0.47787148 -6.638211   -9.927811  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.2294097   7.0370884  -0.47787148 -6.638211   -9.927811  ]
  [Layer 46] Output shape after mixer: (1, 1, 1024)
  [Layer 46] Output sample values after mixer: [ 2.2294097   7.0370884  -0.47787148 -6.638211   -9.927811  ]
  [Layer 46] Residual connection shape: (1, 1, 1024)
  [Layer 46] Residual connection sample values: [-23.389715  46.060356 -13.429212 -24.492302 -19.832155]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.20563187  0.42220798 -0.12058061 -0.20327513 -0.17447156]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.20563187  0.42220798 -0.12058061 -0.20327513 -0.17447156]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.20563187  0.42220798 -0.12058061 -0.20327513 -0.17447156]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.49423096  0.3263255  -0.7181276  -1.1286402  -0.42621735]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.49423096  0.3263255  -0.7181276  -1.1286402  -0.42621735]
  [FlaxMamba2] xBC (step) sample values: [-0.23631448  0.21682525  1.4038353  -0.75996494 -0.46576852]
  [FlaxMamba2] dt (step) sample values: [ 0.31735945 -0.36749744  0.21598886 -1.3760414  -0.13028106]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.17930436 -0.7105696   0.26967475 -0.23631448  0.4095763 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04769665  0.04013662  0.27121702  0.13738069 -0.08023036]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03477246  0.05521993  0.27010313  0.14417848 -0.08214439]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.01768848  0.02837208  0.1531804   0.07727712 -0.03938622]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01768848  0.02837208  0.1531804   0.07727712 -0.03938622]
  [FlaxMamba2] B (step) sample values: [ 0.03157556  0.00051502  0.04675107 -0.09399833 -0.27326018]
  [FlaxMamba2] C (step) sample values: [-0.27752298  0.07675261  0.1722204  -0.26507854 -0.22764204]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-5.7667141e+01 -2.2024069e+00 -3.8371372e+00 -4.6045512e-02
 -2.0699801e+00]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06309082 0.00307916 0.01605248 0.00450876 0.00358115]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.02629787 0.99324137 0.9402631  0.9997924  0.9926145 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01768848  0.02837208  0.1531804   0.07727712 -0.03938622]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.5237721e-05  5.7474819e-07  5.2173291e-05 -1.0490032e-04
 -3.0495308e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.5237721e-05  5.7474819e-07  5.2173291e-05 -1.0490032e-04
 -3.0495308e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 4.51445958e-05  2.82551213e-07  5.14582207e-05 -1.06156265e-04
 -3.14265140e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00048327  0.00079966  0.00423712  0.00214498 -0.00109257]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02835673  0.04550831  0.24561842  0.12391808 -0.06315728]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02835673  0.04550831  0.24561842  0.12391808 -0.06315728]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00531016  0.00862615 -0.05782008 -0.03418322  0.0106337 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.15759365  0.2832611  -1.7405261  -1.4738141   0.36995816]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.15759365  0.2832611  -1.7405261  -1.4738141   0.36995816]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-10.646379   31.989704   -1.0777082   2.1115654   2.0298414]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-10.646379   31.989704   -1.0777082   2.1115654   2.0298414]
  [Layer 47] Output shape after mixer: (1, 1, 1024)
  [Layer 47] Output sample values after mixer: [-10.646379   31.989704   -1.0777082   2.1115654   2.0298414]
  [Layer 47] Residual connection shape: (1, 1, 1024)
  [Layer 47] Residual connection sample values: [-34.036095  78.050064 -14.50692  -22.380737 -17.802315]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.26587906  0.6578257  -0.12082776 -0.17050421 -0.14390305]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.26587906  0.6578257  -0.12082776 -0.17050421 -0.14390305]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.26587906  0.6578257  -0.12082776 -0.17050421 -0.14390305]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.92920244 -1.7140731  -0.66795677 -0.6820172   0.90338594]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.92920244 -1.7140731  -0.66795677 -0.6820172   0.90338594]
  [FlaxMamba2] xBC (step) sample values: [-0.21160093  0.9581109  -0.24147786 -0.8019571  -0.19597182]
  [FlaxMamba2] dt (step) sample values: [-1.267496   -3.6752167  -0.9547983   0.50671947  0.46710843]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.5800574   0.2602709   0.5809656  -0.21160093  1.1265296 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.02865639  0.15081543 -0.03041719 -0.09392329 -0.03230331]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03261605  0.12029785 -0.04245637 -0.17400143 -0.11457871]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.01657395  0.06376246 -0.02077762 -0.07945063 -0.05401087]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01657395  0.06376246 -0.02077762 -0.07945063 -0.05401087]
  [FlaxMamba2] B (step) sample values: [-0.03317083  0.22252616 -0.26654077 -0.1090421  -0.0063864 ]
  [FlaxMamba2] C (step) sample values: [-0.05689379 -0.07487882 -0.27679846 -0.01396986 -0.01078636]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.7303779  -7.389056   -3.3796544  -1.802826  -17.760078 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [3.2468906e-03 5.4465295e-06 2.4715513e-03 3.1849068e-02 1.4746416e-01]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9943974  0.99995977 0.9916818  0.944199   0.07287753]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01657395  0.06376246 -0.02077762 -0.07945063 -0.05401087]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.78504899e-06  1.19749820e-05 -1.43435755e-05 -5.86797159e-06
 -3.43676334e-07]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.78504899e-06  1.19749820e-05 -1.43435755e-05 -5.86797159e-06
 -3.43676334e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.7658585e-04  5.0833297e-04  8.4273232e-04 -2.2637349e-04
 -2.2091564e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00055403  0.00103888 -0.0010796  -0.004859   -0.00335498]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02301987  0.09173115 -0.03063256 -0.11786528 -0.08017711]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02301987  0.09173115 -0.03063256 -0.11786528 -0.08017711]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00605525 -0.02399958  0.00693543  0.02699457 -0.05154506]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.28697598 -1.2739488   0.3485995   1.1941078  -3.104704  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.28697598 -1.2739488   0.3485995   1.1941078  -3.104704  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-18.54906    47.00257     0.3390738  14.313123   -1.8224466]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-18.54906    47.00257     0.3390738  14.313123   -1.8224466]
  [Layer 48] Output shape after mixer: (1, 1, 1024)
  [Layer 48] Output sample values after mixer: [-18.54906    47.00257     0.3390738  14.313123   -1.8224466]
  [Layer 48] Residual connection shape: (1, 1, 1024)
  [Layer 48] Residual connection sample values: [-52.585155 125.052635 -14.167846  -8.067615 -19.624762]
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.87497157  3.0059946  -0.26970717 -0.12123702 -0.33588657]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 1, 1024)
[Mamba2LMHeadModel] Final backbone norm output sample values: [-0.87497157  3.0059946  -0.26970717 -0.12123702 -0.33588657]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 1, 50288)
[Mamba2LMHeadModel] Logits sample values: [-51.906567 -58.131313 -51.436417 -54.758736 -54.23937 ]
[Mamba2LMHeadModel] Forward pass input_ids shape: (1, 1)
[Mamba2LMHeadModel] input_ids sample values: [253]
[Mamba2LMHeadModel] Embedding output shape: (1, 1, 1024)
[Mamba2LMHeadModel] Embedding sample values: [-0.1348877  -0.03662109 -0.26635742 -0.02131653  0.2355957 ]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.18188423 -0.06284313 -0.39386988 -0.02456207  0.29748178]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18188423 -0.06284313 -0.39386988 -0.02456207  0.29748178]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18188423 -0.06284313 -0.39386988 -0.02456207  0.29748178]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.21013384  0.8613406   0.32152975  0.2665166  -0.18941198]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.21013384  0.8613406   0.32152975  0.2665166  -0.18941198]
  [FlaxMamba2] xBC (step) sample values: [ 0.64639604  3.4875457   0.70141697 -0.7220898   1.2973881 ]
  [FlaxMamba2] dt (step) sample values: [ 0.4148918   0.09162405  0.19863752  0.2135621  -0.06532843]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.53985476  0.01573907  0.7266964   0.64639604 -0.40552428]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.08197421 -0.00404936 -0.11210722 -0.0154258   0.05078695]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.12454623 -0.01164061  0.00062471 -0.22489846 -0.1463566 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.06614605 -0.00578643  0.00031245 -0.09985743 -0.06783277]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06614605 -0.00578643  0.00031245 -0.09985743 -0.06783277]
  [FlaxMamba2] B (step) sample values: [-0.24739064 -0.02964979  0.00803771  0.64713866  0.00234538]
  [FlaxMamba2] C (step) sample values: [-0.24993241 -0.06460023  0.08586783 -0.1404059  -0.04616931]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.4383634 -1.0010935 -1.2128745 -1.1529616 -1.4844131]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08321088 0.03709881 0.02961917 0.03221252 0.02104639]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.96418065 0.9635418  0.9647133  0.96354145 0.96924144]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06614605 -0.00578643  0.00031245 -0.09985743 -0.06783277]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.3616558e-03 -1.6319458e-04  4.4240121e-05  3.5618972e-03
  1.2909161e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.3616558e-03 -1.6319458e-04  4.4240121e-05  3.5618972e-03
  1.2909161e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01925637 -0.00375832 -0.00055981  0.04666927 -0.00045809]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.16883217  0.04068026  0.4643801  -0.76569223 -0.5740544 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.28227675  0.03075618  0.46491596 -0.9369539  -0.69039184]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.28227675  0.03075618  0.46491596 -0.9369539  -0.69039184]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0327626   0.01862199  0.08665561 -0.1413973   0.05921041]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00318275  0.00149306  0.0069432  -0.0092899   0.01991866]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00318275  0.00149306  0.0069432  -0.0092899   0.01991866]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.07618547 -0.0926632  -0.02642558 -0.01390013 -0.03581496]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.07618547 -0.0926632  -0.02642558 -0.01390013 -0.03581496]
  [Layer 1] Output shape after mixer: (1, 1, 1024)
  [Layer 1] Output sample values after mixer: [ 0.07618547 -0.0926632  -0.02642558 -0.01390013 -0.03581496]
  [Layer 1] Residual connection shape: (1, 1, 1024)
  [Layer 1] Residual connection sample values: [-0.05870222 -0.12928429 -0.292783   -0.03521666  0.19978075]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.14886189 -0.27533275 -0.57551867 -0.09391021  0.46122575]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.14886189 -0.27533275 -0.57551867 -0.09391021  0.46122575]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.14886189 -0.27533275 -0.57551867 -0.09391021  0.46122575]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.32639825 -0.6268816   0.2598325   2.6846147  -0.9459626 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.32639825 -0.6268816   0.2598325   2.6846147  -0.9459626 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.13903707  0.00776791 -0.17886424  0.48401567 -0.26841408]
  [FlaxMamba2] dt (step) sample values: [ 0.14732628  1.4661018  -0.16800511  0.9014329   1.0118083 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.63347316  0.662316    1.432084    0.13903707 -0.6793369 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.27239263  0.05942698 -0.09714383  0.632978    0.03591796]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.28172338  0.02950449 -0.20896024  0.48893505  0.03929587]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.12114988  0.01496986 -0.09360357  0.30306908  0.02003393]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.12114988  0.01496986 -0.09360357  0.30306908  0.02003393]
  [FlaxMamba2] B (step) sample values: [-0.06477028  0.01022731  0.10290907 -0.0513058  -0.04249996]
  [FlaxMamba2] C (step) sample values: [ 0.01219253 -0.10087717 -0.21666163 -0.15376186  0.04054471]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-12.692555   -19.429585    -0.22886811  -2.10566     -5.0388985 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05814712 0.14336327 0.02086129 0.14783254 0.14877804]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.47805208 0.06169894 0.9952369  0.732505   0.47251895]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.12114988  0.01496986 -0.09360357  0.30306908  0.02003393]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.5627539e-04 -7.2046467e-05 -7.2494475e-04  3.6142458e-04
  2.9939172e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.5627539e-04 -7.2046467e-05 -7.2494475e-04  3.6142458e-04
  2.9939172e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 4.0925792e-04 -4.1633961e-05 -8.1254740e-04  3.6439358e-04
  2.6049057e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-1.8317010e-03  4.0930820e-05 -4.2940932e-03  5.9746171e-04
  1.5199109e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.08259346  0.01002024 -0.06669273  0.20263143  0.01487506]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.08259346  0.01002024 -0.06669273  0.20263143  0.01487506]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01565965 -0.00218733 -0.00978383  0.5092334  -0.00393569]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00436947 -0.00085802 -0.00347372  0.11905228 -0.00160583]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00436947 -0.00085802 -0.00347372  0.11905228 -0.00160583]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.05537602  0.0986526   0.06159102 -0.02890433 -0.13246197]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.05537602  0.0986526   0.06159102 -0.02890433 -0.13246197]
  [Layer 2] Output shape after mixer: (1, 1, 1024)
  [Layer 2] Output sample values after mixer: [ 0.05537602  0.0986526   0.06159102 -0.02890433 -0.13246197]
  [Layer 2] Residual connection shape: (1, 1, 1024)
  [Layer 2] Residual connection sample values: [-0.00332621 -0.03063169 -0.23119196 -0.06412099  0.06731878]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.00970027 -0.07496224 -0.5039651  -0.20014362  0.18737896]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.00970027 -0.07496224 -0.5039651  -0.20014362  0.18737896]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.00970027 -0.07496224 -0.5039651  -0.20014362  0.18737896]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.36229095 -0.3169255  -1.3712946  -0.56286514 -0.61548424]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.36229095 -0.3169255  -1.3712946  -0.56286514 -0.61548424]
  [FlaxMamba2] xBC (step) sample values: [ 0.21543829 -0.02611619  2.276576   -0.35251024  0.9946477 ]
  [FlaxMamba2] dt (step) sample values: [1.181436   0.42795986 0.5880563  0.277503   0.39922452]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.017992    2.5471575  -0.11297893  0.21543829 -0.8149128 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.03715717  0.26986736 -0.21682411 -0.0881517   0.05370228]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00770367  0.19210857 -0.26794106 -0.13478255 -0.01313122]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.003837    0.10525244 -0.11612904 -0.06285655 -0.0065225 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.003837    0.10525244 -0.11612904 -0.06285655 -0.0065225 ]
  [FlaxMamba2] B (step) sample values: [-0.2640993   0.13035744 -0.09377474  0.10288391 -0.27322096]
  [FlaxMamba2] C (step) sample values: [-0.26641104  0.35239273  0.1251438   0.5474283   0.43452346]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-20.926485    -0.880345    -0.67350245  -0.6461216   -0.27258503]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [4.0360417e-02 7.4177743e-03 8.1102524e-05 6.9019590e-03 1.5317539e-02]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.42972848 0.99349105 0.9999454  0.9955504  0.9958334 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.003837    0.10525244 -0.11612904 -0.06285655 -0.0065225 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.0899169e-05 -2.0187525e-05  1.4522223e-05 -1.5932896e-05
  4.2311774e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.0899169e-05 -2.0187525e-05  1.4522223e-05 -1.5932896e-05
  4.2311774e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.6803627e-04 -2.7655184e-04 -3.6223538e-04 -7.6277851e-05
 -6.0178421e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00143939  0.00869054 -0.00945779 -0.00847054 -0.00806856]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00128451  0.08340988 -0.0918985  -0.05309279 -0.01269893]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00128451  0.08340988 -0.0918985  -0.05309279 -0.01269893]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00019099 -0.01114026  0.02550779  0.01084448  0.00274192]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 4.5168992e-05 -2.3505415e-03  4.2517320e-03  2.0115457e-03
  7.5583585e-04]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 4.5168992e-05 -2.3505415e-03  4.2517320e-03  2.0115457e-03
  7.5583585e-04]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.10931756 -0.21324974 -0.15040402  0.07802321  0.01006347]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.10931756 -0.21324974 -0.15040402  0.07802321  0.01006347]
  [Layer 3] Output shape after mixer: (1, 1, 1024)
  [Layer 3] Output sample values after mixer: [-0.10931756 -0.21324974 -0.15040402  0.07802321  0.01006347]
  [Layer 3] Residual connection shape: (1, 1, 1024)
  [Layer 3] Residual connection sample values: [-0.11264377 -0.24388143 -0.38159597  0.01390222  0.07738225]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.18764393 -0.35184577 -0.518266    0.02462282  0.12129051]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18764393 -0.35184577 -0.518266    0.02462282  0.12129051]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18764393 -0.35184577 -0.518266    0.02462282  0.12129051]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.3981624   0.49820554 -0.38604817 -0.10820125  0.07319541]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.3981624   0.49820554 -0.38604817 -0.10820125  0.07319541]
  [FlaxMamba2] xBC (step) sample values: [ 0.05910201 -0.305127    0.37190858 -1.4473193   0.5009321 ]
  [FlaxMamba2] dt (step) sample values: [0.6632494  0.6734026  0.5375665  0.14090149 0.5132835 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.80816627 -0.73858327 -0.72604185  0.05910201 -0.3943857 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.09479719 -0.04683043 -0.11342229 -0.21190044 -0.03271406]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.11684614 -0.03427245 -0.15382756 -0.2765977   0.22631913]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.06183245 -0.0168426  -0.07100969 -0.11929329  0.12591027]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06183245 -0.0168426  -0.07100969 -0.11929329  0.12591027]
  [FlaxMamba2] B (step) sample values: [-0.27629355  0.14281219  0.07965566  0.02531582  0.07897245]
  [FlaxMamba2] C (step) sample values: [-0.27623135 -0.12929983  0.44839537  0.09159465 -0.13034348]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.49070406 -0.5047996  -0.6491257  -0.5552266  -0.46572492]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08544722 0.10888413 0.138888   0.04537432 0.5025952 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9589376  0.9465186  0.91378886 0.9751217  0.79130554]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06183245 -0.0168426  -0.07100969 -0.11929329  0.12591027]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00145977  0.00075454  0.00042085  0.00013375  0.00041724]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00145977  0.00075454  0.00042085  0.00013375  0.00041724]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.03305311 -0.00403919  0.00031468  0.00242847 -0.00087477]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01949988  0.00339748  0.00215719 -0.04057902  0.06556279]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.06051646 -0.00777507 -0.04494712 -0.11971227  0.14908542]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.06051646 -0.00777507 -0.04494712 -0.11971227  0.14908542]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.06784957 -0.00240951  0.00702172  0.00612647  0.00565578]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04399289 -0.0016778   0.00408335  0.00392339  0.00263739]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04399289 -0.0016778   0.00408335  0.00392339  0.00263739]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.02422763  0.00408036  0.08210187  0.19287698 -0.04827771]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.02422763  0.00408036  0.08210187  0.19287698 -0.04827771]
  [Layer 4] Output shape after mixer: (1, 1, 1024)
  [Layer 4] Output sample values after mixer: [-0.02422763  0.00408036  0.08210187  0.19287698 -0.04827771]
  [Layer 4] Residual connection shape: (1, 1, 1024)
  [Layer 4] Residual connection sample values: [-0.1368714  -0.23980108 -0.2994941   0.2067792   0.02910454]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.28247526 -0.4172356  -0.4554584   0.42549217  0.05698293]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.28247526 -0.4172356  -0.4554584   0.42549217  0.05698293]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.28247526 -0.4172356  -0.4554584   0.42549217  0.05698293]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.14813478  0.28170472 -0.19147938  0.23386863  0.44076496]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.14813478  0.28170472 -0.19147938  0.23386863  0.44076496]
  [FlaxMamba2] xBC (step) sample values: [-0.8512082   0.04946149 -0.78849924  1.2419494  -0.22390707]
  [FlaxMamba2] dt (step) sample values: [1.3120606  0.35734475 0.6981492  0.8762141  1.6023506 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.4791298  0.2688788  1.0947375 -0.8512082  1.2426366]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.09708917 -0.80484605 -0.47294247 -0.21883366  0.0378761 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03373468 -1.046179   -0.4802934  -0.19196293  0.04881665]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.01715182 -0.27196416 -0.18355991 -0.08679721  0.02500397]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01715182 -0.27196416 -0.18355991 -0.08679721  0.02500397]
  [FlaxMamba2] B (step) sample values: [-0.10277794  0.02480285 -0.22216825 -0.06414645  0.04383015]
  [FlaxMamba2] C (step) sample values: [-0.02970332  0.11956947 -0.2606502  -0.21065241 -0.21955806]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.07591622 -0.53187454 -0.04695368 -1.4938657  -3.6258397 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.49072546 0.01995317 0.07268526 0.03342808 0.07806474]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.96343136 0.98944354 0.996593   0.9512893  0.7534819 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01715182 -0.27196416 -0.18355991 -0.08679721  0.02500397]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00086506  0.00020876 -0.00186995 -0.00053991  0.00036891]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00086506  0.00020876 -0.00186995 -0.00053991  0.00036891]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.1119729e-02  9.1166166e-04  4.9340647e-01  5.1666602e-02
  2.1499995e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.5878431  -0.78496575 -0.62774277 -0.2710941  -0.19307946]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.5637055  -1.1676989  -0.88606524 -0.39324316 -0.15789156]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.5637055  -1.1676989  -0.88606524 -0.39324316 -0.15789156]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.04483902 -0.18748757  0.07673458 -0.05133631 -0.04234329]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00156576 -0.00691929  0.0057984  -0.00426314 -0.0038221 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00156576 -0.00691929  0.0057984  -0.00426314 -0.0038221 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.5251628  -0.11033583  0.50463164  0.36770964  0.7081862 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.5251628  -0.11033583  0.50463164  0.36770964  0.7081862 ]
  [Layer 5] Output shape after mixer: (1, 1, 1024)
  [Layer 5] Output sample values after mixer: [-0.5251628  -0.11033583  0.50463164  0.36770964  0.7081862 ]
  [Layer 5] Residual connection shape: (1, 1, 1024)
  [Layer 5] Residual connection sample values: [-0.6620342  -0.3501369   0.20513755  0.5744888   0.73729074]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.62121075 -0.27141723  0.15004061  0.5167973   0.61808103]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.62121075 -0.27141723  0.15004061  0.5167973   0.61808103]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.62121075 -0.27141723  0.15004061  0.5167973   0.61808103]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.5209958  -0.3835909  -0.35409677 -1.1480396   0.64276785]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.5209958  -0.3835909  -0.35409677 -1.1480396   0.64276785]
  [FlaxMamba2] xBC (step) sample values: [ 1.1230701  -0.9853393   0.06075051 -0.45523494  0.6308328 ]
  [FlaxMamba2] dt (step) sample values: [1.4830455 1.0576442 1.4980223 1.1269374 0.5328789]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [0.18457492 0.3887714  0.9053893  1.1230701  0.12074345]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.1803544  -0.28117025 -0.19771829  0.19830266  0.2523736 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.22759561 -0.26717794 -0.1164805   0.18662205  0.3905572 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.10090347 -0.11584835 -0.05485215  0.10199279  0.23293489]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.10090347 -0.11584835 -0.05485215  0.10199279  0.23293489]
  [FlaxMamba2] B (step) sample values: [ 0.08436763 -0.03250965 -0.27769256 -0.04520026 -0.07485699]
  [FlaxMamba2] C (step) sample values: [-0.2780424   0.05789433 -0.26478425 -0.15259548 -0.01523795]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.5109995  -0.28622514 -0.5421001  -0.39544863 -0.5985869 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.5374463  0.3036788  0.31961247 0.37786737 0.15702529]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.75984955 0.91674995 0.84091735 0.86120117 0.9102889 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.10090347 -0.11584835 -0.05485215  0.10199279  0.23293489]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00457527  0.001763    0.01505932  0.00245122  0.00405951]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00457527  0.001763    0.01505932  0.00245122  0.00405951]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00757502 -0.00568671  0.01555027  0.00676261  0.00786027]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.03530725 -0.00813999 -0.03668273 -0.0291269   0.05337444]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.15104859 -0.14102386 -0.0996009   0.08786394  0.32056242]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.15104859 -0.14102386 -0.0996009   0.08786394  0.32056242]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02932354  0.02192279  0.01454429 -0.02429458  0.13503899]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01078672  0.00771726  0.00486802 -0.01000057  0.04045437]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01078672  0.00771726  0.00486802 -0.01000057  0.04045437]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.04427758 -0.03256406  0.1623006  -0.18009396  0.03153071]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.04427758 -0.03256406  0.1623006  -0.18009396  0.03153071]
  [Layer 6] Output shape after mixer: (1, 1, 1024)
  [Layer 6] Output sample values after mixer: [-0.04427758 -0.03256406  0.1623006  -0.18009396  0.03153071]
  [Layer 6] Residual connection shape: (1, 1, 1024)
  [Layer 6] Residual connection sample values: [-0.7063118  -0.38270098  0.36743814  0.39439487  0.7688215 ]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.6144893  -0.2704232   0.2521342   0.34634423  0.58004844]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.6144893  -0.2704232   0.2521342   0.34634423  0.58004844]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.6144893  -0.2704232   0.2521342   0.34634423  0.58004844]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.2509349  -3.8247287  -0.5659886  -0.22232945  1.5127914 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.2509349  -3.8247287  -0.5659886  -0.22232945  1.5127914 ]
  [FlaxMamba2] xBC (step) sample values: [-1.3473907  -2.3346946  -1.6330627   0.12664777  0.01161441]
  [FlaxMamba2] dt (step) sample values: [ 0.21093595 -0.31474388  0.10104495  0.35147122  0.8003312 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.875366  -3.0653458 -2.6795866 -1.3473907 -1.2104211]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.41348666 -0.45470056 -0.38795137 -0.12831068  0.08761686]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.44711703 -0.52598965 -0.5189328  -0.11984205  0.08487219]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.17439641 -0.19538029 -0.19361478 -0.05633479  0.04423583]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.17439641 -0.19538029 -0.19361478 -0.05633479  0.04423583]
  [FlaxMamba2] B (step) sample values: [ 0.0392334  -0.00592576  0.12181174 -0.02237235 -0.00633797]
  [FlaxMamba2] C (step) sample values: [ 0.00723063 -0.03865275  0.12944466  0.0150497  -0.14087829]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-6.5957151e-02 -4.5478220e+00 -5.8281250e+00 -4.2033669e-01
 -1.9005252e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.5860513  0.02429365 0.04011698 0.19266574 0.38860962]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9620833  0.8954014  0.79151475 0.922208   0.99926174]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.17439641 -0.19538029 -0.19361478 -0.05633479  0.04423583]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00400986  0.00060564 -0.0124498   0.00228657  0.00064777]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00400986  0.00060564 -0.0124498   0.00228657  0.00064777]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.10082141  0.01038382 -0.03413626  0.00410721  0.08898702]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.21837504 -0.15441434 -0.21874848  0.07124393  0.01476951]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.6227225  -0.607414   -0.66765475 -0.05937129  0.11733267]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.6227225  -0.607414   -0.66765475 -0.05937129  0.11733267]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [0.06837957 0.0496193  0.13685594 0.00586931 0.1454566 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.02103524 0.01842178 0.03046502 0.00158262 0.08583333]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.02103524 0.01842178 0.03046502 0.00158262 0.08583333]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.5011217   0.08275016 -0.34414253 -0.17023364  0.09049007]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.5011217   0.08275016 -0.34414253 -0.17023364  0.09049007]
  [Layer 7] Output shape after mixer: (1, 1, 1024)
  [Layer 7] Output sample values after mixer: [ 0.5011217   0.08275016 -0.34414253 -0.17023364  0.09049007]
  [Layer 7] Residual connection shape: (1, 1, 1024)
  [Layer 7] Residual connection sample values: [-0.20519012 -0.2999508   0.02329561  0.22416124  0.8593115 ]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.2086376  -0.22831424  0.01657001  0.2219876   0.73221695]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.2086376  -0.22831424  0.01657001  0.2219876   0.73221695]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.2086376  -0.22831424  0.01657001  0.2219876   0.73221695]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.6055198  -0.34168866 -1.4975506   0.14161885 -0.7579895 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.6055198  -0.34168866 -1.4975506   0.14161885 -0.7579895 ]
  [FlaxMamba2] xBC (step) sample values: [-2.0932546  -0.414612   -2.9492207   0.8123438  -0.11785747]
  [FlaxMamba2] dt (step) sample values: [2.5993211 3.9548671 2.1667504 1.5453141 3.2070615]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.11993328 -3.2332613  -0.8657562  -2.0932546  -0.57573164]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.51821554  0.31828365  0.17205644  0.11161999 -0.39854127]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.5956081   0.39933833  0.23840165  0.01469617 -0.4611023 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.21164884  0.23901545  0.13334274  0.00740208 -0.17831948]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.21164884  0.23901545  0.13334274  0.00740208 -0.17831948]
  [FlaxMamba2] B (step) sample values: [-0.05808224  0.65910023  0.09570456 -0.07021285  0.07065856]
  [FlaxMamba2] C (step) sample values: [-0.09038737 -0.07611318 -0.0482804  -0.00040879 -0.13165663]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6851114  -0.13800453 -0.41180432 -0.26783535 -0.12443344]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.22773   5.277369  1.4715126 1.1874673 4.319096 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8555417  0.48272854 0.5455421  0.7275695  0.58424205]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.21164884  0.23901545  0.13334274  0.00740208 -0.17831948]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00279949 -0.03176783 -0.00461284  0.00338417 -0.00340566]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00279949 -0.03176783 -0.00461284  0.00338417 -0.00340566]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00472897 -0.02620138  0.00071034 -0.03057132  0.00865274]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.16632108 -0.03452325  0.08874831 -0.07768139  0.00918124]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.96347815  0.86570776  0.5909722  -0.04980211 -0.66244364]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.96347815  0.86570776  0.5909722  -0.04980211 -0.66244364]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.25865677 -0.12287618 -0.16177212 -0.00377575  0.16021961]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.031833   -0.00798199 -0.0323653  -0.00064335  0.01872074]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.031833   -0.00798199 -0.0323653  -0.00064335  0.01872074]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.14465545  0.12887356 -0.16854918 -0.25760525 -0.08905163]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.14465545  0.12887356 -0.16854918 -0.25760525 -0.08905163]
  [Layer 8] Output shape after mixer: (1, 1, 1024)
  [Layer 8] Output sample values after mixer: [-0.14465545  0.12887356 -0.16854918 -0.25760525 -0.08905163]
  [Layer 8] Residual connection shape: (1, 1, 1024)
  [Layer 8] Residual connection sample values: [-0.3498456  -0.17107725 -0.14525357 -0.03344402  0.7702599 ]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.30497205 -0.1152541  -0.09368981 -0.02923164  0.58485556]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.30497205 -0.1152541  -0.09368981 -0.02923164  0.58485556]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.30497205 -0.1152541  -0.09368981 -0.02923164  0.58485556]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.8885604  -2.4630294  -1.6534998  -1.2716881  -0.34474286]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.8885604  -2.4630294  -1.6534998  -1.2716881  -0.34474286]
  [FlaxMamba2] xBC (step) sample values: [ 2.100877    0.81163734 -1.9519695   0.47323343  0.34793267]
  [FlaxMamba2] dt (step) sample values: [2.8111372 3.7602224 2.8444867 3.063414  2.9368277]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [0.8244302 2.8222654 1.138623  2.100877  4.449501 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.8678275  -0.16655765 -0.7629278  -0.09514076  0.09541413]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-1.1212454  -0.07604252 -0.7670934  -0.08841544  0.07675263]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.27558008 -0.03657633 -0.2432516  -0.04225467  0.03984834]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.27558008 -0.03657633 -0.2432516  -0.04225467  0.03984834]
  [FlaxMamba2] B (step) sample values: [ 0.04929539 -0.02729878  0.24112353 -0.1282349   0.07099097]
  [FlaxMamba2] C (step) sample values: [ 0.00677971 -0.1030008   0.02587919 -0.14324328 -0.0917858 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17008033 -0.11351943 -0.10539922 -0.5864362  -0.14965628]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [3.2669957 4.5762334 4.6422553 1.7640634 3.1727345]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.5736982  0.594823   0.6130614  0.35540026 0.62199724]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.27558008 -0.03657633 -0.2432516  -0.04225467  0.03984834]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.04438157  0.02457761 -0.21708807  0.1154523  -0.06391452]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.04438157  0.02457761 -0.21708807  0.1154523  -0.06391452]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.03652431 -0.00854829 -0.31005603  0.33873555  0.03688045]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.29856434  0.18807185  0.08526514 -0.01303381  0.10510151]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-1.0369725   0.09006671 -0.5665199  -0.12625387  0.21187387]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-1.0369725   0.09006671 -0.5665199  -0.12625387  0.21187387]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.65290666 -0.01741219  0.15047473  0.03515659 -0.03028744]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.06164932 -0.00306444  0.01770838  0.004746   -0.00410477]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.06164932 -0.00306444  0.01770838  0.004746   -0.00410477]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.02498678  0.03465264 -0.04148994 -0.08210804  0.4000672 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.02498678  0.03465264 -0.04148994 -0.08210804  0.4000672 ]
  [Layer 9] Output shape after mixer: (1, 1, 1024)
  [Layer 9] Output sample values after mixer: [ 0.02498678  0.03465264 -0.04148994 -0.08210804  0.4000672 ]
  [Layer 9] Residual connection shape: (1, 1, 1024)
  [Layer 9] Residual connection sample values: [-0.3248588  -0.13642462 -0.18674351 -0.11555205  1.1703272 ]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.28181526 -0.09041564 -0.12079871 -0.09860469  0.8595296 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.28181526 -0.09041564 -0.12079871 -0.09860469  0.8595296 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.28181526 -0.09041564 -0.12079871 -0.09860469  0.8595296 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-3.3465998  -0.3176912   0.34199706 -3.3739276  -1.2056522 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-3.3465998  -0.3176912   0.34199706 -3.3739276  -1.2056522 ]
  [FlaxMamba2] xBC (step) sample values: [-2.0003026  1.354348   0.3645958  1.0312047  1.1572579]
  [FlaxMamba2] dt (step) sample values: [1.2640923  0.43463337 0.83285475 0.82947314 0.27718556]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-3.1214604 -0.8984489 -2.820525  -2.0003026 -2.3997755]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.64471    -0.46451485 -0.2159096   0.3308784  -0.35761005]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.8149981  -0.4884559  -0.25387347  0.9348823  -0.3087209 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.25006297 -0.18573897 -0.1109098   0.6713061  -0.13072075]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.25006297 -0.18573897 -0.1109098   0.6713061  -0.13072075]
  [FlaxMamba2] B (step) sample values: [ 0.0165983   0.42932853 -0.04760391 -0.25683782  0.10255463]
  [FlaxMamba2] C (step) sample values: [ 1.756666   -0.22186466  0.9489156   0.17272839  0.2982469 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.08535489 -0.07711172 -0.08452541 -0.0546804  -0.06966463]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [2.4348798  0.13921718 0.19732587 2.064733   0.6944117 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.812346   0.9893221  0.9834593  0.8932396  0.95277554]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.25006297 -0.18573897 -0.1109098   0.6713061  -0.13072075]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01010626 -0.26140666  0.02898475  0.15638168 -0.06244277]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01010626 -0.26140666  0.02898475  0.15638168 -0.06244277]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.08584101 -1.0336014  -0.02625864  0.49733496 -0.11552097]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-3.177898   -0.42497212 -1.8447026  18.329462   -0.17792627]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-4.39549   -1.3293617 -2.3847382 21.598148  -0.8144243]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-4.39549   -1.3293617 -2.3847382 21.598148  -0.8144243]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.5002365   0.1779002  -0.47684583 -2.413496    0.2263026 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00954969  0.00726004 -0.02134031 -0.08307428  0.00944286]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00954969  0.00726004 -0.02134031 -0.08307428  0.00944286]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.0310935   0.05509376 -0.06439423 -0.03458058 -0.3296401 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.0310935   0.05509376 -0.06439423 -0.03458058 -0.3296401 ]
  [Layer 10] Output shape after mixer: (1, 1, 1024)
  [Layer 10] Output sample values after mixer: [ 0.0310935   0.05509376 -0.06439423 -0.03458058 -0.3296401 ]
  [Layer 10] Residual connection shape: (1, 1, 1024)
  [Layer 10] Residual connection sample values: [-0.2937653  -0.08133086 -0.25113773 -0.15013263  0.8406871 ]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.16847089 -0.03784363 -0.1133499  -0.09401644  0.42670745]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.16847089 -0.03784363 -0.1133499  -0.09401644  0.42670745]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.16847089 -0.03784363 -0.1133499  -0.09401644  0.42670745]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.0575799 -2.5741532 -2.8956068  2.0999641 -3.6547992]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.0575799 -2.5741532 -2.8956068  2.0999641 -3.6547992]
  [FlaxMamba2] xBC (step) sample values: [-1.1525992  -0.23637857 -2.2356493   0.3201723  -0.33692175]
  [FlaxMamba2] dt (step) sample values: [-2.2488441  -0.6325971  -0.27953735  0.8275383   1.9953676 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.68330896 -0.13014178 -0.44022954 -1.1525992  -0.5952911 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.35831013  0.03799906  0.60635537 -0.04815394  0.07618105]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [0.5047945  0.22916117 0.63028115 0.05926793 0.19117129]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [0.31478247 0.12765214 0.411292   0.03051188 0.10469453]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [0.31478247 0.12765214 0.411292   0.03051188 0.10469453]
  [FlaxMamba2] B (step) sample values: [-0.25904462 -0.0036996  -0.08575607  0.00468979 -0.08843566]
  [FlaxMamba2] C (step) sample values: [-0.17945707  0.4272824   0.05055261  0.08042711 -0.12502438]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.25934154 -0.12614636 -0.10356269 -0.23775288 -0.43051487]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02393259 0.03804942 0.11660609 1.0345737  2.1708758 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9938125  0.9952117  0.9879966  0.78194344 0.39274517]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [0.31478247 0.12765214 0.411292   0.03051188 0.10469453]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.9515286e-03 -2.7871169e-05 -6.4604863e-04  3.5330802e-05
 -6.6623546e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.9515286e-03 -2.7871169e-05 -6.4604863e-04  3.5330802e-05
 -6.6623546e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.18621674  0.0107427   0.0190271  -0.08617213  0.11308628]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [0.5309203  0.51838416 0.5165795  0.28110346 0.8039791 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.46194893  0.11575094 -0.7806946   0.18486458  0.47375748]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.46194893  0.11575094 -0.7806946   0.18486458  0.47375748]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.36261383 -0.02110173  0.11838945  0.34585527 -0.04365857]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01704497 -0.00734437  0.07392113  0.04059215 -0.00598097]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01704497 -0.00734437  0.07392113  0.04059215 -0.00598097]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.500228   -0.1652829   0.13047577  0.39322168  0.27705562]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.500228   -0.1652829   0.13047577  0.39322168  0.27705562]
  [Layer 11] Output shape after mixer: (1, 1, 1024)
  [Layer 11] Output sample values after mixer: [-0.500228   -0.1652829   0.13047577  0.39322168  0.27705562]
  [Layer 11] Residual connection shape: (1, 1, 1024)
  [Layer 11] Residual connection sample values: [-0.7939933  -0.24661377 -0.12066196  0.24308905  1.1177428 ]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.3621038  -0.08959845 -0.04008731  0.1257221   0.4313278 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.3621038  -0.08959845 -0.04008731  0.1257221   0.4313278 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.3621038  -0.08959845 -0.04008731  0.1257221   0.4313278 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.5487459  -0.14175716  0.25844255 -0.9224609   0.55208594]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.5487459  -0.14175716  0.25844255 -0.9224609   0.55208594]
  [FlaxMamba2] xBC (step) sample values: [-0.75309384  1.349661   -2.3030562   0.7170533  -1.4170852 ]
  [FlaxMamba2] dt (step) sample values: [ 0.4466186   0.030174    0.03194196 -0.34596014  0.04578282]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.6213522  -0.627188    0.5587608  -0.75309384  1.3269696 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.284342   -0.2512988   0.41757903  0.17258954  0.4470564 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.21714228 -1.0857714   0.35282072  0.12836957  0.28043044]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.12031274 -0.27406543  0.20721209  0.06829882  0.1597477 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.12031274 -0.27406543  0.20721209  0.06829882  0.1597477 ]
  [FlaxMamba2] B (step) sample values: [ 0.13380195 -0.12269979 -0.04033091  0.65372306 -0.08820939]
  [FlaxMamba2] C (step) sample values: [-0.05858433 -0.27763948 -0.2425824  -0.27655798 -0.12506174]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.16087165 -0.14748003 -0.27125728 -0.11553253 -0.09015273]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.2911054  0.58752507 1.1563323  1.3066566  0.07295801]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.81244886 0.91699964 0.73076487 0.8598809  0.9934442 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.12031274 -0.27406543  0.20721209  0.06829882  0.1597477 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.02078432 -0.01905975 -0.00626486  0.101547   -0.01370213]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.02078432 -0.01905975 -0.00626486  0.101547   -0.01370213]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.03109366  0.0016118   0.06471418 -0.13172863 -0.03676022]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.3086812  -1.3031796   0.02374407  0.00977032  3.1423588 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.11343032 -1.7479498   0.36002052  0.12060983  3.401607  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.11343032 -1.7479498   0.36002052  0.12060983  3.401607  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.03945329  0.11512557  0.05250074 -0.03164804  1.1918021 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00667955  0.0113886   0.01016974 -0.01157128  0.17359942]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00667955  0.0113886   0.01016974 -0.01157128  0.17359942]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.13194592 -0.24487497 -0.70447546  0.3682831   0.05116057]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.13194592 -0.24487497 -0.70447546  0.3682831   0.05116057]
  [Layer 12] Output shape after mixer: (1, 1, 1024)
  [Layer 12] Output sample values after mixer: [-0.13194592 -0.24487497 -0.70447546  0.3682831   0.05116057]
  [Layer 12] Residual connection shape: (1, 1, 1024)
  [Layer 12] Residual connection sample values: [-0.9259392  -0.49148875 -0.82513744  0.6113721   1.1689034 ]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.3247628  -0.14077263 -0.22496416  0.23070319  0.36775962]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.3247628  -0.14077263 -0.22496416  0.23070319  0.36775962]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.3247628  -0.14077263 -0.22496416  0.23070319  0.36775962]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.8667333  -0.14898871 -0.61967427  1.1236706  -0.83961314]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.8667333  -0.14898871 -0.61967427  1.1236706  -0.83961314]
  [FlaxMamba2] xBC (step) sample values: [ 0.5624532  -0.76635426  0.8670538  -0.7219375  -0.21131605]
  [FlaxMamba2] dt (step) sample values: [ 0.10406024 -1.0827919   0.2034878  -0.32597187  0.3315299 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.41646534  0.25376448  0.12189782  0.5624532  -1.035238  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02383212  0.12202397  0.12138628 -0.02876979 -0.14936775]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.08590488  0.10336247  0.12926745 -0.04048091 -0.17980903]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.04110866  0.05434981  0.06880543 -0.01983084 -0.0818434 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04110866  0.05434981  0.06880543 -0.01983084 -0.0818434 ]
  [FlaxMamba2] B (step) sample values: [-0.05348343 -0.16556709  0.17441836  0.09683421  0.01568029]
  [FlaxMamba2] C (step) sample values: [ 0.16652903 -0.09408093  0.22264811  0.00168366 -0.19098598]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.02338035 -1.090337   -0.5085105  -0.67845345 -0.02513249]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05813034 0.00340622 0.01042604 0.00379541 0.2065462 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9986418  0.99629295 0.9947123  0.9974283  0.99482244]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04110866  0.05434981  0.06880543 -0.01983084 -0.0818434 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.2780725e-04  3.9564908e-04 -4.1680064e-04 -2.3140087e-04
 -3.7470578e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.2780725e-04  3.9564908e-04 -4.1680064e-04 -2.3140087e-04
 -3.7470578e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.09264518  0.10206061 -0.28300068  0.02322954 -0.05857342]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.20522463 -0.09473547 -0.06927054  0.00991473  0.15448394]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.20047645 -0.10101305 -0.07721779  0.01220525  0.16393712]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.20047645 -0.10101305 -0.07721779  0.01220525  0.16393712]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.05142146  0.00696537  0.01674055  0.01035004 -0.0415156 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01770491  0.00158677  0.01291974  0.01886256 -0.01642375]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01770491  0.00158677  0.01291974  0.01886256 -0.01642375]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.17345767  0.24285161 -0.15127909  0.2604262   0.4168203 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.17345767  0.24285161 -0.15127909  0.2604262   0.4168203 ]
  [Layer 13] Output shape after mixer: (1, 1, 1024)
  [Layer 13] Output sample values after mixer: [ 0.17345767  0.24285161 -0.15127909  0.2604262   0.4168203 ]
  [Layer 13] Residual connection shape: (1, 1, 1024)
  [Layer 13] Residual connection sample values: [-0.7524815  -0.24863714 -0.9764165   0.8717983   1.5857236 ]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.2111648  -0.06023628 -0.23134257  0.27683192  0.41686654]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.2111648  -0.06023628 -0.23134257  0.27683192  0.41686654]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.2111648  -0.06023628 -0.23134257  0.27683192  0.41686654]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.52497077 -1.2309256  -0.15457705 -0.6426242  -2.0843532 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.52497077 -1.2309256  -0.15457705 -0.6426242  -2.0843532 ]
  [FlaxMamba2] xBC (step) sample values: [-0.33581305 -0.9601062  -1.1126245  -0.6914322  -0.40172863]
  [FlaxMamba2] dt (step) sample values: [ 1.426573   -0.66740865  1.5276341   1.5554516   1.8687686 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.7296733  -0.38637185  0.00432411 -0.33581305 -1.427727  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.07378176 -0.1931838  -0.5668701   0.17261216  0.11146027]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.14421633 -0.24259175 -0.75864255  0.12500474  0.09768158]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.07729876 -0.10665493 -0.24196225  0.06640384  0.05122432]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.07729876 -0.10665493 -0.24196225  0.06640384  0.05122432]
  [FlaxMamba2] B (step) sample values: [-0.00808374  0.02671901 -0.08977021  0.04864541 -0.08699318]
  [FlaxMamba2] C (step) sample values: [-0.0965604  -0.08740167 -0.09756137 -0.06038681 -0.1774603 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-7.2744994  -0.03854768 -2.202407   -0.01377147 -5.3377523 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08289658 0.03105367 0.05305063 0.21703747 0.10110606]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.5471507  0.9988037  0.88972837 0.99701554 0.5829353 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.07729876 -0.10665493 -0.24196225  0.06640384  0.05122432]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.1799034e-05  1.7121017e-04 -5.7522982e-04  3.1171017e-04
 -5.5743509e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.1799034e-05  1.7121017e-04 -5.7522982e-04  3.1171017e-04
 -5.5743509e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.6570333e-04  7.8085002e-05 -2.5690126e-04  5.9288181e-04
 -6.8310235e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00529294 -0.00893891 -0.0242495   0.00328774  0.00522812]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.06612696 -0.09287618 -0.21467344  0.05554747  0.04554159]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.06612696 -0.09287618 -0.21467344  0.05554747  0.04554159]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01290314  0.02583937  0.01531199 -0.0123028  -0.01050123]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03749333  0.05231539  0.02126957 -0.02474583 -0.02684827]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03749333  0.05231539  0.02126957 -0.02474583 -0.02684827]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.13353826  0.23417859 -0.09772282  0.1348603  -0.05407687]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.13353826  0.23417859 -0.09772282  0.1348603  -0.05407687]
  [Layer 14] Output shape after mixer: (1, 1, 1024)
  [Layer 14] Output sample values after mixer: [ 0.13353826  0.23417859 -0.09772282  0.1348603  -0.05407687]
  [Layer 14] Residual connection shape: (1, 1, 1024)
  [Layer 14] Residual connection sample values: [-0.6189433  -0.01445855 -1.0741394   1.0066586   1.5316467 ]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.19994706 -0.00384233 -0.28656435  0.38548622  0.46183246]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.19994706 -0.00384233 -0.28656435  0.38548622  0.46183246]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.19994706 -0.00384233 -0.28656435  0.38548622  0.46183246]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.2311014   1.3857845   0.44742212 -0.4326365  -4.615219  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.2311014   1.3857845   0.44742212 -0.4326365  -4.615219  ]
  [FlaxMamba2] xBC (step) sample values: [ 0.95938224 -1.1691777   0.56893486  1.1674432   0.35828224]
  [FlaxMamba2] dt (step) sample values: [ 1.9228089  -0.347717   -0.34210378 -0.10203268  0.3493644 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.1422975   0.19749758 -3.226898    0.95938224  0.68286383]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.09845916  0.149321    0.29322     0.24247907  0.15740211]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.4346408   0.12513582  1.6184154   0.68510604  0.14391334]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.17082195  0.06647756  1.3506914   0.45551148  0.07712552]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.17082195  0.06647756  1.3506914   0.45551148  0.07712552]
  [FlaxMamba2] B (step) sample values: [-0.03879786 -0.09404725  0.04828677 -0.05580469 -0.10580806]
  [FlaxMamba2] C (step) sample values: [-0.06548431 -0.04641544 -0.02878986 -0.06294899 -0.09353727]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.4414158  -0.05923919 -0.7389757  -0.00508607 -0.00871955]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.36334416 0.34031856 0.01560036 0.04380868 0.19246776]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.41185904 0.9800417  0.9885379  0.9997772  0.9983232 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.17082195  0.06647756  1.3506914   0.45551148  0.07712552]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00240807  0.00583725 -0.00299702  0.00346364  0.00656721]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00240807  0.00583725 -0.00299702  0.00346364  0.00656721]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00217815  0.00723303 -0.00215716  0.00373368  0.00820081]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01303443  0.00535814  0.12395924  0.04526885  0.00799549]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.31808853  0.12407386  2.5360262   0.8587219   0.14572635]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.31808853  0.12407386  2.5360262   0.8587219   0.14572635]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.08849701  0.13753767  0.69218093 -0.1461898  -0.00659307]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.08265794  0.09376315  0.1386911  -0.07696454 -0.00628329]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.08265794  0.09376315  0.1386911  -0.07696454 -0.00628329]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.16578908  0.306703   -0.01970543  0.4330611   0.39760795]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.16578908  0.306703   -0.01970543  0.4330611   0.39760795]
  [Layer 15] Output shape after mixer: (1, 1, 1024)
  [Layer 15] Output sample values after mixer: [ 0.16578908  0.306703   -0.01970543  0.4330611   0.39760795]
  [Layer 15] Residual connection shape: (1, 1, 1024)
  [Layer 15] Residual connection sample values: [-0.4531542   0.29224443 -1.0938448   1.4397197   1.9292547 ]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.09721857  0.05181266 -0.18073073  0.39189726  0.3912887 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.09721857  0.05181266 -0.18073073  0.39189726  0.3912887 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.09721857  0.05181266 -0.18073073  0.39189726  0.3912887 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.1987932  -0.7837746  -6.421451    0.14788507 -1.4629812 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.1987932  -0.7837746  -6.421451    0.14788507 -1.4629812 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.4790857   0.05527499 -1.0904164  -0.6048248  -0.82214755]
  [FlaxMamba2] dt (step) sample values: [6.049009   0.65618724 2.4079666  0.34395185 1.7585461 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.2533983  -0.13573612  0.8545147   1.4790857   0.58470565]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.08782149 -0.0082917  -0.61765826 -0.22808802  0.1238661 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.08599807  0.00051262 -0.4809395  -0.2662655   0.13139632]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.04484681  0.00025638 -0.18373346 -0.11551241  0.07000821]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04484681  0.00025638 -0.18373346 -0.11551241  0.07000821]
  [FlaxMamba2] B (step) sample values: [ 0.17182998 -0.06619727 -0.01350866  0.00093718 -0.03062375]
  [FlaxMamba2] C (step) sample values: [ 0.00378391 -0.09635762 -0.10186283 -0.2454586  -0.24652028]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.1348554e-03 -3.0370306e-03 -2.7156286e+00 -4.1511287e-03
 -4.2925543e-01]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [3.592548   0.12392769 0.2354111  0.03790335 0.00651417]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99593127 0.9996237  0.5276674  0.99984264 0.99720764]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04484681  0.00025638 -0.18373346 -0.11551241  0.07000821]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.02768427 -0.01066533 -0.00217644  0.00015099 -0.00493393]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.02768427 -0.01066533 -0.00217644  0.00015099 -0.00493393]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.03186339  0.09879439  0.03705482  0.00234995 -0.00102799]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.03245355  0.0025721  -0.09952927 -0.0410477   0.01899788]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02201609  0.00251243 -0.05676789 -0.01416381  0.00270445]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02201609  0.00251243 -0.05676789 -0.01416381  0.00270445]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00611493 -0.00061735  0.00059187 -0.00112461 -0.00074388]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00562237 -0.00032316  0.00124717 -0.00041251 -0.00080963]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00562237 -0.00032316  0.00124717 -0.00041251 -0.00080963]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.60210437 -0.0830282   0.03346634  0.4192543   0.16531794]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.60210437 -0.0830282   0.03346634  0.4192543   0.16531794]
  [Layer 16] Output shape after mixer: (1, 1, 1024)
  [Layer 16] Output sample values after mixer: [-0.60210437 -0.0830282   0.03346634  0.4192543   0.16531794]
  [Layer 16] Residual connection shape: (1, 1, 1024)
  [Layer 16] Residual connection sample values: [-1.0552585   0.20921624 -1.0603784   1.858974    2.0945725 ]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.31642443  0.0539798  -0.27335793  0.6388392   0.5785672 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.31642443  0.0539798  -0.27335793  0.6388392   0.5785672 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.31642443  0.0539798  -0.27335793  0.6388392   0.5785672 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-4.823271  -2.7186327 -1.0607402 -1.2778873 -0.7722779]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-4.823271  -2.7186327 -1.0607402 -1.2778873 -0.7722779]
  [FlaxMamba2] xBC (step) sample values: [ 1.2512957  -1.7857795   0.25495365  1.3117826  -0.42453015]
  [FlaxMamba2] dt (step) sample values: [1.301478  1.807543  0.6353097 2.1782584 1.3948333]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.2817422  -1.7254306   2.4675014   1.2512957   0.23410219]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.40378934  0.16128905 -0.05529888  0.27568334 -0.10353178]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.3087576   0.1834143  -0.1697398   0.31010717 -0.00831693]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.17802407  0.10009385 -0.07768424  0.17890435 -0.00414117]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.17802407  0.10009385 -0.07768424  0.17890435 -0.00414117]
  [FlaxMamba2] B (step) sample values: [-0.0888745   0.08598328 -0.2731934   0.01198632 -0.1913833 ]
  [FlaxMamba2] C (step) sample values: [-0.2018416  -0.16183993 -0.27779087 -0.10519342 -0.06091762]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.3863302  -0.87734115 -1.4026718  -0.6827737  -0.39046   ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.43787336 0.42359224 0.23292366 1.2578287  0.9225222 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.5449632  0.68960595 0.7212889  0.42366493 0.6975312 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.17802407  0.10009385 -0.07768424  0.17890435 -0.00414117]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00692794  0.00670257 -0.02129597  0.00093436 -0.01491871]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00692794  0.00670257 -0.02129597  0.00093436 -0.01491871]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00873387  0.01483343 -0.04917619  0.00619822 -0.0408628 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.09488948  0.0595603  -0.06556731  0.05959886  0.02104719]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.56377965  0.32319334 -0.2701766   0.5308076   0.01013993]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.56377965  0.32319334 -0.2701766   0.5308076   0.01013993]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02168968 -0.05437294  0.07370105 -0.14781107 -0.00247444]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01107752 -0.02833933  0.04040917 -0.09977374 -0.00154004]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01107752 -0.02833933  0.04040917 -0.09977374 -0.00154004]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.01391522  0.20580876 -0.11111779 -0.21928306  1.7148743 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.01391522  0.20580876 -0.11111779 -0.21928306  1.7148743 ]
  [Layer 17] Output shape after mixer: (1, 1, 1024)
  [Layer 17] Output sample values after mixer: [-0.01391522  0.20580876 -0.11111779 -0.21928306  1.7148743 ]
  [Layer 17] Residual connection shape: (1, 1, 1024)
  [Layer 17] Residual connection sample values: [-1.0691737  0.415025  -1.1714963  1.6396909  3.8094468]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.2088989   0.07011209 -0.1949942   0.3893334   0.65869874]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.2088989   0.07011209 -0.1949942   0.3893334   0.65869874]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.2088989   0.07011209 -0.1949942   0.3893334   0.65869874]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.314395   -1.038645   -1.4342499  -0.24460703 -0.9963843 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.314395   -1.038645   -1.4342499  -0.24460703 -0.9963843 ]
  [FlaxMamba2] xBC (step) sample values: [-0.5580068  -1.9547898   0.6067249  -0.07945344  0.7669452 ]
  [FlaxMamba2] dt (step) sample values: [0.8105711  5.3150225  4.101646   1.9088347  0.26903284]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.25384715 -0.15398827 -0.6895262  -0.5580068   0.26534218]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.11832738  1.7914157  -0.1552799  -0.1279881   0.71510273]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.12768102  1.3934665  -0.14403418 -0.09744     0.66285664]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.0679106   1.1163688  -0.06683958 -0.04634824  0.43742028]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0679106   1.1163688  -0.06683958 -0.04634824  0.43742028]
  [FlaxMamba2] B (step) sample values: [ 0.0188339   0.03651465  0.00387072 -0.0331126   0.01551571]
  [FlaxMamba2] C (step) sample values: [-0.07779595 -0.0190204  -0.04646945 -0.05656737  0.04095425]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.3194940e-03 -6.5335674e+00 -1.4897179e+01 -1.3796333e-03
 -2.0873186e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.27499247 6.4279675  5.551823   0.5779287  0.17584595]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.9936235e-01 5.7635763e-19 1.2050952e-36 9.9920297e-01 9.9963301e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0679106   1.1163688  -0.06683958 -0.04634824  0.43742028]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.517212e-04  6.819076e-04  7.228528e-05 -6.183745e-04  2.897543e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.517212e-04  6.819076e-04  7.228528e-05 -6.183745e-04  2.897543e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00595966 -0.00772435  0.09312284 -0.03971085  0.01243413]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.24073265 -1.2819616   0.06058159 -0.16407739 -0.19907796]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.24610907 -1.3703433   0.06587321 -0.16040805 -0.23370808]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.24610907 -1.3703433   0.06587321 -0.16040805 -0.23370808]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03265572  0.37206706 -0.01818122  0.01723095  0.0627922 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03118391  0.08699592 -0.00382839  0.00844865  0.0144683 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03118391  0.08699592 -0.00382839  0.00844865  0.0144683 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.18293428 -0.6171342  -0.4131753   0.06791209  0.57685995]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.18293428 -0.6171342  -0.4131753   0.06791209  0.57685995]
  [Layer 18] Output shape after mixer: (1, 1, 1024)
  [Layer 18] Output sample values after mixer: [ 0.18293428 -0.6171342  -0.4131753   0.06791209  0.57685995]
  [Layer 18] Residual connection shape: (1, 1, 1024)
  [Layer 18] Residual connection sample values: [-0.8862394  -0.20210922 -1.5846716   1.707603    4.386307  ]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.1894181  -0.03587392 -0.28432688  0.45135537  0.8323061 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1894181  -0.03587392 -0.28432688  0.45135537  0.8323061 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1894181  -0.03587392 -0.28432688  0.45135537  0.8323061 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.03310092 -2.1375628  -1.0263057   0.00495549 -0.06940437]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.03310092 -2.1375628  -1.0263057   0.00495549 -0.06940437]
  [FlaxMamba2] xBC (step) sample values: [-1.0118886   0.7380287   0.31834477 -0.5254387  -0.6333054 ]
  [FlaxMamba2] dt (step) sample values: [ 0.29330918  0.07379109  1.2252153   0.95313966 -0.4971672 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.4363782  -1.2168745   1.531876   -1.0118886   0.60322386]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.5010616   0.31790787  0.05155621  0.5325537  -0.15512916]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.4496395   0.31840903  0.03776227  0.32491207 -0.15632126]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.27452898  0.18433861  0.01923759  0.18861824 -0.07206395]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.27452898  0.18433861  0.01923759  0.18861824 -0.07206395]
  [FlaxMamba2] B (step) sample values: [-0.05064333 -0.03726535 -0.23870479 -0.05240379  0.3245637 ]
  [FlaxMamba2] C (step) sample values: [-0.27361557 -0.02921576 -0.09878437 -0.07189591 -0.08283012]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17394373 -1.5063176  -1.5724528  -0.19826236 -0.07681109]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.5021937  0.30152017 0.8197073  2.2195358  0.23749688]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7700521 0.6349652 0.2755597 0.6440039 0.981923 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.27452898  0.18433861  0.01923759  0.18861824 -0.07206395]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.02088509 -0.01536807 -0.09844083 -0.0216111   0.13384868]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.02088509 -0.01536807 -0.09844083 -0.0216111   0.13384868]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01715388  0.04005202 -0.03737463  0.02603637  0.05398119]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [0.02516861 0.2122855  0.14147691 0.19534604 0.22447059]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [0.4431885  0.49297428 0.17076962 0.48255134 0.11474022]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [0.4431885  0.49297428 0.17076962 0.48255134 0.11474022]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00745636 -0.11117117 -0.04623424  0.0011986  -0.00384362]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0021149  -0.05451529 -0.02699571  0.00028819 -0.00341929]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0021149  -0.05451529 -0.02699571  0.00028819 -0.00341929]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.0114323  -0.0665514  -1.9743352   0.05882709 -0.7577635 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.0114323  -0.0665514  -1.9743352   0.05882709 -0.7577635 ]
  [Layer 19] Output shape after mixer: (1, 1, 1024)
  [Layer 19] Output sample values after mixer: [-1.0114323  -0.0665514  -1.9743352   0.05882709 -0.7577635 ]
  [Layer 19] Residual connection shape: (1, 1, 1024)
  [Layer 19] Residual connection sample values: [-1.8976717 -0.2686606 -3.5590067  1.76643    3.6285434]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.22011578 -0.02852278 -0.37812078  0.25072578  0.41113487]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.22011578 -0.02852278 -0.37812078  0.25072578  0.41113487]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.22011578 -0.02852278 -0.37812078  0.25072578  0.41113487]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.61811984 -0.51106614  0.99902886 -0.0333821   0.19610071]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.61811984 -0.51106614  0.99902886 -0.0333821   0.19610071]
  [FlaxMamba2] xBC (step) sample values: [-0.19641498 -1.7616392   0.09721352  0.59328926 -0.1354139 ]
  [FlaxMamba2] dt (step) sample values: [-0.5477084   0.9786238   0.6132473   1.5864885   0.09457958]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.8533652   1.2463926   0.02312712 -0.19641498  0.32795173]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02232701  0.4548911  -0.00397108  0.13906771 -0.0567154 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.03683049  0.4167136  -0.18353651  0.11802584 -0.10322419]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.01807616  0.25115183 -0.0833704   0.06249141 -0.04895065]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01807616  0.25115183 -0.0833704   0.06249141 -0.04895065]
  [FlaxMamba2] B (step) sample values: [-0.08776842 -0.00525621 -0.08625925 -0.08380511 -0.03016296]
  [FlaxMamba2] C (step) sample values: [-0.15301943 -0.20368631 -0.0889962  -0.18704647 -0.20778038]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-3.08577806e-01 -2.93056536e+00 -5.29621363e+00 -1.23260975e+01
 -8.15932546e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00410695 0.06837741 0.10712469 0.32732812 0.04627388]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99873346 0.818416   0.5670231  0.01769137 0.9996225 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01807616  0.25115183 -0.0833704   0.06249141 -0.04895065]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [6.5157392e-06 3.9020958e-07 6.4037013e-06 6.2215117e-06 2.2392335e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [6.5157392e-06 3.9020958e-07 6.4037013e-06 6.2215117e-06 2.2392335e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.1966305e-04 -2.4168545e-04 -1.9579992e-04  9.5411087e-05
 -4.6246903e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0001969   0.00058006 -0.00150868  0.00015123  0.00010004]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01506413  0.20714676 -0.07007895  0.051549   -0.04016077]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01506413  0.20714676 -0.07007895  0.051549   -0.04016077]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00326095 -0.03969367 -0.05116869 -0.00084605 -0.00432265]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03068334 -0.321633   -0.28542247 -0.0077496  -0.02587283]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03068334 -0.321633   -0.28542247 -0.0077496  -0.02587283]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.94565344 -0.1070347   0.6815898  -0.13583328  0.26110697]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.94565344 -0.1070347   0.6815898  -0.13583328  0.26110697]
  [Layer 20] Output shape after mixer: (1, 1, 1024)
  [Layer 20] Output sample values after mixer: [-0.94565344 -0.1070347   0.6815898  -0.13583328  0.26110697]
  [Layer 20] Residual connection shape: (1, 1, 1024)
  [Layer 20] Residual connection sample values: [-2.8433251 -0.3756953 -2.8774168  1.6305968  3.8896503]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.4166801  -0.04981721 -0.39091617  0.28259462  0.5479861 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.4166801  -0.04981721 -0.39091617  0.28259462  0.5479861 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.4166801  -0.04981721 -0.39091617  0.28259462  0.5479861 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.63829154 -0.40260622  0.00278671 -0.5647891   0.04632523]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.63829154 -0.40260622  0.00278671 -0.5647891   0.04632523]
  [FlaxMamba2] xBC (step) sample values: [-0.42845628  0.86223453 -1.6013937  -0.6783341  -0.1557235 ]
  [FlaxMamba2] dt (step) sample values: [-0.6655168   0.7183934  -0.46994492 -0.83439016  0.3417664 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.26750508  0.5754699  -0.08208276 -0.42845628 -0.13879117]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.13564381  0.22433816 -0.07497145  0.1282517   0.05741181]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.49306569  0.12686501 -0.10063674  0.03022924  0.00342621]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.18695652  0.06745081 -0.04778856  0.01534306  0.00171604]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.18695652  0.06745081 -0.04778856  0.01534306  0.00171604]
  [FlaxMamba2] B (step) sample values: [ 0.4331192  -0.20843373 -0.05238545  0.10730198 -0.05075558]
  [FlaxMamba2] C (step) sample values: [ 0.03007858 -0.10100441 -0.00105427 -0.05485205  0.19068176]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.32275575 -0.3764196  -0.15946394 -0.10539922 -0.37568513]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.44208288 0.95805323 0.574669   0.21576466 0.71547043]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.86702734 0.6972369  0.9124345  0.9775152  0.7643025 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.18695652  0.06745081 -0.04778856  0.01534306  0.00171604]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.03579742  0.01722711  0.00432967 -0.00886854  0.00419496]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.03579742  0.01722711  0.00432967 -0.00886854  0.00419496]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.01775128 0.1306347  0.02973459 0.0653588  0.0147499 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.24678357 -0.09456088 -0.07159895 -0.04266031  0.2687817 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.64191556  0.04799616 -0.17259991 -0.01023282  0.27240855]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.64191556  0.04799616 -0.17259991 -0.01023282  0.27240855]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-2.6811337e-01 -7.7426825e-03 -2.4082841e-04  2.0946804e-03
  6.4558163e-03]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.30946466 -0.01129261 -0.00039714  0.00242228  0.00643793]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.30946466 -0.01129261 -0.00039714  0.00242228  0.00643793]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.2498818  -0.7401401  -0.53873134  0.19416921 -0.07698908]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.2498818  -0.7401401  -0.53873134  0.19416921 -0.07698908]
  [Layer 21] Output shape after mixer: (1, 1, 1024)
  [Layer 21] Output sample values after mixer: [-0.2498818  -0.7401401  -0.53873134  0.19416921 -0.07698908]
  [Layer 21] Residual connection shape: (1, 1, 1024)
  [Layer 21] Residual connection sample values: [-3.093207  -1.1158354 -3.4161482  1.8247659  3.8126612]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.43397874 -0.14479986 -0.44375968  0.30243218  0.51824975]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.43397874 -0.14479986 -0.44375968  0.30243218  0.51824975]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.43397874 -0.14479986 -0.44375968  0.30243218  0.51824975]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.18074465  0.30167255  0.49673617 -3.0439644   0.42098904]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.18074465  0.30167255  0.49673617 -3.0439644   0.42098904]
  [FlaxMamba2] xBC (step) sample values: [-0.34415787 -0.99452525 -1.1523784   0.28148082 -0.49752015]
  [FlaxMamba2] dt (step) sample values: [-0.82997185 -2.7041945  -1.2841351   0.46266976 -0.28412765]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.7266351  -0.32190228 -0.01145529 -0.34415787 -0.8233217 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00233558 -0.11215234 -0.0308988   0.03794993  0.07524706]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.00585076 -0.04763818 -0.01826453  0.01959361  0.07585741]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.00293394 -0.02325185 -0.00904887  0.00989278  0.0393666 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00293394 -0.02325185 -0.00904887  0.00989278  0.0393666 ]
  [FlaxMamba2] B (step) sample values: [-0.25570983  0.19694886  0.11723603 -0.08621927 -0.01273046]
  [FlaxMamba2] C (step) sample values: [-0.2458769  -0.07163231 -0.06675698 -0.23839064 -0.18142983]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.07090003 -0.07021102 -0.0699373  -0.08945116 -0.38969815]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.2504343  0.07418041 0.0333576  0.4815979  0.5817424 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9824009  0.9948053  0.99766976 0.95783526 0.79715675]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00293394 -0.02325185 -0.00904887  0.00989278  0.0393666 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.8788496e-04  1.4470983e-04  8.6140157e-05 -6.3350337e-05
 -9.3538110e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.8788496e-04  1.4470983e-04  8.6140157e-05 -6.3350337e-05
 -9.3538110e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00490673 0.02409245 0.00524085 0.01302829 0.0445416 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01411413  0.04606863 -0.15316449  0.02492497  0.01075599]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01917224  0.08615488 -0.13756423  0.0078698  -0.05711213]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01917224  0.08615488 -0.13756423  0.0078698  -0.05711213]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0018888   0.01494071 -0.04248216 -0.00108946 -0.01451559]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00192744  0.00660339 -0.04335136 -0.0016516  -0.01413381]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00192744  0.00660339 -0.04335136 -0.0016516  -0.01413381]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.29867664  0.4520233  -1.2222282   0.80805635  0.55047536]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.29867664  0.4520233  -1.2222282   0.80805635  0.55047536]
  [Layer 22] Output shape after mixer: (1, 1, 1024)
  [Layer 22] Output sample values after mixer: [ 0.29867664  0.4520233  -1.2222282   0.80805635  0.55047536]
  [Layer 22] Residual connection shape: (1, 1, 1024)
  [Layer 22] Residual connection sample values: [-2.7945302  -0.66381216 -4.638376    2.6328223   4.3631363 ]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.31295887 -0.06715796 -0.49378112  0.36246318  0.4547132 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.31295887 -0.06715796 -0.49378112  0.36246318  0.4547132 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.31295887 -0.06715796 -0.49378112  0.36246318  0.4547132 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.44068623  1.0019337  -1.7801117  -0.6014997  -0.21245392]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.44068623  1.0019337  -1.7801117  -0.6014997  -0.21245392]
  [FlaxMamba2] xBC (step) sample values: [ 0.00251446 -1.3988055   0.32469353  0.82698894  0.11188685]
  [FlaxMamba2] dt (step) sample values: [-1.3344288  -0.43137363 -0.21005909 -1.7537755  -0.50129724]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.936926    0.79555124 -1.548761    0.00251446  0.32806945]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.77811265 -0.00803889 -0.06455613 -0.07954417 -0.09866992]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.81180406 -0.01560343 -0.1065178  -0.06320201 -0.10313693]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.24963479 -0.00774085 -0.05042507 -0.03060271 -0.04891152]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.24963479 -0.00774085 -0.05042507 -0.03060271 -0.04891152]
  [FlaxMamba2] B (step) sample values: [0.07145625 0.1347494  0.0275159  1.224703   0.03022433]
  [FlaxMamba2] C (step) sample values: [-0.02397765 -0.09824061  0.29903066  0.23447853  0.21805368]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.12322418 -0.22553998 -0.24196908 -0.09559295 -0.2396176 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01945068 0.14467114 0.17216684 0.01328694 0.10960243]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9976061  0.9678975  0.95919675 0.99873066 0.9740792 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.24963479 -0.00774085 -0.05042507 -0.03060271 -0.04891152]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00034696 -0.00065428 -0.00013361 -0.00594663 -0.00014676]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00034696 -0.00065428 -0.00013361 -0.00594663 -0.00014676]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.02666882  0.01252717 -0.00132527  0.07805289 -0.0114818 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.04889472  0.02544913  0.13793387 -0.02620009  0.01046298]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.06054771  0.02581047  0.14028771 -0.02477155  0.01274618]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.06054771  0.02581047  0.14028771 -0.02477155  0.01274618]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01623426  0.01891528 -0.03603306  0.00527464 -0.0012107 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02917492  0.10304191 -0.32265395  0.04738169 -0.00605544]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02917492  0.10304191 -0.32265395  0.04738169 -0.00605544]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.611599   -0.70349437  0.30065477  0.22779787 -0.33060083]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.611599   -0.70349437  0.30065477  0.22779787 -0.33060083]
  [Layer 23] Output shape after mixer: (1, 1, 1024)
  [Layer 23] Output sample values after mixer: [-0.611599   -0.70349437  0.30065477  0.22779787 -0.33060083]
  [Layer 23] Residual connection shape: (1, 1, 1024)
  [Layer 23] Residual connection sample values: [-3.4061291 -1.3673065 -4.3377213  2.86062    4.0325356]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.45953873 -0.1637563  -0.56452715  0.44292817  0.5012384 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.45953873 -0.1637563  -0.56452715  0.44292817  0.5012384 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.45953873 -0.1637563  -0.56452715  0.44292817  0.5012384 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.55868816 -0.14109287 -1.0283209  -3.028837   -1.1727892 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.55868816 -0.14109287 -1.0283209  -3.028837   -1.1727892 ]
  [FlaxMamba2] xBC (step) sample values: [-0.4168057  -2.0091333  -0.75882053 -0.40501904  0.01370594]
  [FlaxMamba2] dt (step) sample values: [-0.89789456 -1.032494   -0.4862479  -0.6197256  -0.74612206]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.16016293 -0.25741082  0.23978034 -0.4168057  -0.8777343 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.16315146 -0.23272151 -0.10796863 -0.11421359 -0.02527799]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.29010457 -0.13537043 -0.11013919 -0.19331515 -0.01842679]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.16594611 -0.06311091 -0.05203999 -0.08734388 -0.00912851]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.16594611 -0.06311091 -0.05203999 -0.08734388 -0.00912851]
  [FlaxMamba2] B (step) sample values: [-0.2781219  -0.05007931 -0.1313359   0.00602672 -0.01910215]
  [FlaxMamba2] C (step) sample values: [ 0.02385395 -0.07285433 -0.25860775 -0.02099591 -0.1946935 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6296152  -0.19671947 -0.14336194 -0.14017779 -0.22378482]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.3895592  0.33864272 0.39750993 0.7726908  0.24739203]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7824913 0.9355529 0.9446056 0.8973457 0.946142 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.16594611 -0.06311091 -0.05203999 -0.08734388 -0.00912851]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01797942 -0.00323742 -0.00849032  0.0003896  -0.00123487]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01797942 -0.00323742 -0.00849032  0.0003896  -0.00123487]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00263798  0.00119183 -0.01102147  0.01311867 -0.00352616]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.09486129 -0.0574315  -0.07805048 -0.17666331 -0.04163283]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.90763867 -0.3665386  -0.33293402 -0.60445964 -0.08634282]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.90763867 -0.3665386  -0.33293402 -0.60445964 -0.08634282]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [0.32258284 0.02403682 0.09018176 0.08447354 0.02393338]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.14271465 0.03320125 0.109524   0.07619947 0.02001493]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.14271465 0.03320125 0.109524   0.07619947 0.02001493]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.8255496  -0.01359012  0.7802663  -0.61758214  0.66632295]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.8255496  -0.01359012  0.7802663  -0.61758214  0.66632295]
  [Layer 24] Output shape after mixer: (1, 1, 1024)
  [Layer 24] Output sample values after mixer: [-0.8255496  -0.01359012  0.7802663  -0.61758214  0.66632295]
  [Layer 24] Residual connection shape: (1, 1, 1024)
  [Layer 24] Residual connection sample values: [-4.231679  -1.3808966 -3.557455   2.243038   4.6988583]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.3706749  -0.11227052 -0.29041907  0.22495833  0.38569283]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.3706749  -0.11227052 -0.29041907  0.22495833  0.38569283]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.3706749  -0.11227052 -0.29041907  0.22495833  0.38569283]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.6745769   0.1120299  -1.9708532   0.47529835 -0.9129974 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.6745769   0.1120299  -1.9708532   0.47529835 -0.9129974 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.7092835   0.12491158 -0.67457026 -0.95701003  0.07733721]
  [FlaxMamba2] dt (step) sample values: [-0.2260381  -0.26516908  0.02079204  0.2751322  -0.19465166]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.01340183  0.03133045 -0.13636056  0.7092835  -0.33046684]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.20654817 -0.05419232  0.08788937 -0.606683   -0.0679386 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.2258658  -0.05084492  0.1905505  -0.71178555 -0.10657385]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.100233   -0.0247763   0.10432526 -0.23432295 -0.05045011]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.100233   -0.0247763   0.10432526 -0.23432295 -0.05045011]
  [FlaxMamba2] B (step) sample values: [ 0.00125236 -0.09917065 -0.08321571 -0.02283763  0.22863647]
  [FlaxMamba2] C (step) sample values: [-0.27758026 -0.16888386  0.0088382  -0.23099318 -0.27805996]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.16260907 -0.3326761  -0.32944313 -0.2015813  -0.1541056 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.48892406 0.28162122 0.3491034  0.5442168  0.45179808]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9235748 0.9105662 0.8913575 0.8960994 0.9327439]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.100233   -0.0247763   0.10432526 -0.23432295 -0.05045011]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.1373401e-05  4.8599895e-03  4.0780962e-03  1.1191881e-03
 -1.1204634e-02]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.1373401e-05  4.8599895e-03  4.0780962e-03  1.1191881e-03
 -1.1204634e-02]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00147228  0.00549824  0.00297159  0.00231388 -0.01681267]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00822226  0.01700309 -0.06263669 -0.2376345  -0.10032038]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.10032047 -0.00576239  0.03322165 -0.45294005 -0.14667602]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.10032047 -0.00576239  0.03322165 -0.45294005 -0.14667602]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02283809 -0.00034084 -0.00800741 -0.13275065  0.03835145]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.1515744  -0.00177285 -0.03478277 -0.32346576  0.14392678]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.1515744  -0.00177285 -0.03478277 -0.32346576  0.14392678]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.3378279e-01 -3.6032540e-01  5.8653986e-04  6.2536395e-01
 -4.4814196e-01]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.3378279e-01 -3.6032540e-01  5.8653986e-04  6.2536395e-01
 -4.4814196e-01]
  [Layer 25] Output shape after mixer: (1, 1, 1024)
  [Layer 25] Output sample values after mixer: [ 3.3378279e-01 -3.6032540e-01  5.8653986e-04  6.2536395e-01
 -4.4814196e-01]
  [Layer 25] Residual connection shape: (1, 1, 1024)
  [Layer 25] Residual connection sample values: [-3.8978963 -1.7412219 -3.5568686  2.868402   4.250716 ]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.40220648 -0.16737287 -0.35951957  0.3555359   0.4195715 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.40220648 -0.16737287 -0.35951957  0.3555359   0.4195715 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.40220648 -0.16737287 -0.35951957  0.3555359   0.4195715 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.6544165  -1.0407271  -0.40200192  0.3432928  -0.9460905 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.6544165  -1.0407271  -0.40200192  0.3432928  -0.9460905 ]
  [FlaxMamba2] xBC (step) sample values: [-0.8267723  -0.31523755  1.5901166   1.0136372   0.4351972 ]
  [FlaxMamba2] dt (step) sample values: [-0.44906747 -2.0129838   0.08808005  0.29451263 -1.2153727 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.0917618   0.05861462 -1.1091459  -0.8267723  -1.5826412 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.25407058 -0.09892885 -0.40067166  0.2606331   0.09167112]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.345074   -0.15285341 -0.42594022  0.19733965 -0.17615114]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.14305991 -0.07059701 -0.16828735  0.10837409 -0.08033826]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.14305991 -0.07059701 -0.16828735  0.10837409 -0.08033826]
  [FlaxMamba2] B (step) sample values: [ 0.16062726 -0.03870403  0.15770276  0.1731249   0.13151985]
  [FlaxMamba2] C (step) sample values: [ 0.13682869 -0.25797686 -0.05902681  0.10448153 -0.20577948]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.329765   -0.06343037 -0.22886811 -0.12639298 -0.0584348 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.39014214 0.02761699 1.6531312  1.5977485  0.18970065]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.87927705 0.99824977 0.68499136 0.8171405  0.9889761 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.14305991 -0.07059701 -0.16828735  0.10837409 -0.08033826]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0089652   0.00216022 -0.00880197 -0.00966274 -0.00734061]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0089652   0.00216022 -0.00880197 -0.00966274 -0.00734061]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.04483255  0.03534958 -0.00784317 -0.04027951 -0.0033114 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.33810887 -0.2781674  -0.23342721  0.27221894 -0.5348382 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.9150846  -0.5628926  -0.91214794  0.70930314 -0.85885096]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.9150846  -0.5628926  -0.91214794  0.70930314 -0.85885096]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [0.20480248 0.15290411 0.14697897 0.14244431 0.22724746]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.21515162 0.11205714 0.14230336 0.15149435 0.17796475]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.21515162 0.11205714 0.14230336 0.15149435 0.17796475]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.816415   -0.46552694  0.49523586  0.7570245   1.6632673 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.816415   -0.46552694  0.49523586  0.7570245   1.6632673 ]
  [Layer 26] Output shape after mixer: (1, 1, 1024)
  [Layer 26] Output sample values after mixer: [-1.816415   -0.46552694  0.49523586  0.7570245   1.6632673 ]
  [Layer 26] Residual connection shape: (1, 1, 1024)
  [Layer 26] Residual connection sample values: [-5.714311  -2.206749  -3.0616326  3.6254265  5.9139833]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.4491711  -0.16512801 -0.23219942  0.32938257  0.46813425]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.4491711  -0.16512801 -0.23219942  0.32938257  0.46813425]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.4491711  -0.16512801 -0.23219942  0.32938257  0.46813425]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.05187675 -0.7410566   0.6460813   0.29820397  0.06234095]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.05187675 -0.7410566   0.6460813   0.29820397  0.06234095]
  [FlaxMamba2] xBC (step) sample values: [ 0.02095367 -1.2730049   0.4144909  -0.57536554 -0.4691594 ]
  [FlaxMamba2] dt (step) sample values: [ 0.3419296  -0.91809624 -0.2792732   0.281462    0.53969085]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.96141565  0.7113648  -0.38122988  0.02095367 -0.41876656]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.0078757  -0.43161526  0.1255687   0.37401733 -0.0477417 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02455356 -0.4834036   0.07051499  0.17382202 -0.0458849 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.01212607 -0.18439369  0.03650007  0.09444556 -0.02241618]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01212607 -0.18439369  0.03650007  0.09444556 -0.02241618]
  [FlaxMamba2] B (step) sample values: [-0.13063844 -0.09640224  0.10918708  0.04271702 -0.00862458]
  [FlaxMamba2] C (step) sample values: [-0.254831   -0.00842202 -0.11690204 -0.13693145 -0.22165957]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.562595   -0.03025642 -0.75594616 -1.1612954  -0.04055573]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10654786 0.01804257 0.00705037 0.10078705 0.05377933]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.94181794 0.99945426 0.99468446 0.88954645 0.99782133]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01212607 -0.18439369  0.03650007  0.09444556 -0.02241618]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.6878571e-04  1.2455232e-04 -1.4107043e-04 -5.5190667e-05
  1.1143013e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.6878571e-04  1.2455232e-04 -1.4107043e-04 -5.5190667e-05
  1.1143013e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00230822 -0.0103206  -0.00355958 -0.00649507 -0.00420938]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02696897 -0.02581869  0.02776289 -0.07297948  0.02061634]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05108361 -0.3925154   0.10034918  0.11484081 -0.02396187]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05108361 -0.3925154   0.10034918  0.11484081 -0.02396187]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00135939  0.093887    0.04253915  0.01965731 -0.00077018]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.0037898   0.20599084  0.13462822  0.01600726 -0.00311301]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0037898   0.20599084  0.13462822  0.01600726 -0.00311301]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.4807476  1.6123301 -2.4869823 -2.8764482  1.0282668]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.4807476  1.6123301 -2.4869823 -2.8764482  1.0282668]
  [Layer 27] Output shape after mixer: (1, 1, 1024)
  [Layer 27] Output sample values after mixer: [-0.4807476  1.6123301 -2.4869823 -2.8764482  1.0282668]
  [Layer 27] Residual connection shape: (1, 1, 1024)
  [Layer 27] Residual connection sample values: [-6.195059  -0.5944189 -5.548615   0.7489784  6.9422503]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.37356383 -0.03449428 -0.32908687  0.05279908  0.40543935]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.37356383 -0.03449428 -0.32908687  0.05279908  0.40543935]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.37356383 -0.03449428 -0.32908687  0.05279908  0.40543935]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.2306422  -0.76901424  0.52168393 -0.3254401  -0.33584744]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.2306422  -0.76901424  0.52168393 -0.3254401  -0.33584744]
  [FlaxMamba2] xBC (step) sample values: [-0.6237256   0.81648594  0.42360058 -0.38031605 -1.8518465 ]
  [FlaxMamba2] dt (step) sample values: [ 0.8848479   0.22087047 -0.16831502  0.29698098  0.5625587 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5593082   0.00289398 -1.2640718  -0.6237256  -1.449945  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.24093553  0.2829728   0.08563545  0.0885889  -0.39206755]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.11300585  0.19355631 -0.04351494 -0.00149899 -0.45768034]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.05969211  0.10611504 -0.02128416 -0.00074893 -0.17736773]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05969211  0.10611504 -0.02128416 -0.00074893 -0.17736773]
  [FlaxMamba2] B (step) sample values: [-0.1625622   0.02850456  0.06395956 -0.01269227 -0.2709646 ]
  [FlaxMamba2] C (step) sample values: [-0.03945149  0.15184537  0.3008459  -0.12995581 -0.05454454]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.54422176 -0.18426022 -0.10643356 -0.11241624 -0.25234625]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.39004102 0.6020923  0.8154938  1.0253649  0.7336373 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8087473  0.894991   0.9168642  0.8911276  0.83099574]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05969211  0.10611504 -0.02128416 -0.00074893 -0.17736773]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00378483  0.00066365  0.00148913 -0.00029551 -0.0063087 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00378483  0.00066365  0.00148913 -0.00029551 -0.0063087 ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 7.9680691e-03 -3.1581628e-03  5.6204507e-03  3.6922138e-05
 -1.5480858e-03]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00106594 -0.02310029 -0.01284412  0.00437841 -0.00822125]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.11030006  0.17487574 -0.05255342  0.00298115 -0.33913156]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.11030006  0.17487574 -0.05255342  0.00298115 -0.33913156]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01418033 -0.0425894  -0.01720485 -0.00040685  0.04747416]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.08319561 -0.23479241 -0.09054659 -0.00247385  0.33588958]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.08319561 -0.23479241 -0.09054659 -0.00247385  0.33588958]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.4627044   0.7604583  -0.42375284  1.2398317   0.51149213]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.4627044   0.7604583  -0.42375284  1.2398317   0.51149213]
  [Layer 28] Output shape after mixer: (1, 1, 1024)
  [Layer 28] Output sample values after mixer: [-0.4627044   0.7604583  -0.42375284  1.2398317   0.51149213]
  [Layer 28] Residual connection shape: (1, 1, 1024)
  [Layer 28] Residual connection sample values: [-6.657763   0.1660394 -5.972368   1.9888101  7.4537425]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.437665    0.01077578 -0.3956573   0.16155717  0.49216482]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.437665    0.01077578 -0.3956573   0.16155717  0.49216482]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.437665    0.01077578 -0.3956573   0.16155717  0.49216482]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.90484226  0.00243405  0.41627994 -0.24024796 -0.49218816]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.90484226  0.00243405  0.41627994 -0.24024796 -0.49218816]
  [FlaxMamba2] xBC (step) sample values: [ 0.733938    0.22972776  0.4304318   1.7138216  -0.04161013]
  [FlaxMamba2] dt (step) sample values: [ 0.22821893 -1.1114146   0.55263305 -0.03889763 -0.6526247 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [0.7908142  0.2164995  0.17975312 0.733938   0.6934588 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.13362172 -0.07904768 -0.16098583 -0.3120796   0.09919205]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.14761403 -0.15467024 -0.2992915   0.05461961  1.599192  ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.07924462 -0.07136629 -0.12741758  0.02805544  1.3303765 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.07924462 -0.07136629 -0.12741758  0.02805544  1.3303765 ]
  [FlaxMamba2] B (step) sample values: [-0.13340835 -0.00586944 -0.01567592 -0.04516595  0.023949  ]
  [FlaxMamba2] C (step) sample values: [-0.09704003  0.01033286  0.09479214 -0.09954018 -0.05197982]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6542169  -0.13693057 -1.458904   -0.36823887 -0.12178858]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1033913  0.01850303 0.15905647 0.09947989 0.16221797]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.93459654 0.9974696  0.79290795 0.9640305  0.9804376 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.07924462 -0.07136629 -0.12741758  0.02805544  1.3303765 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0930419e-03 -4.8089492e-05 -1.2843602e-04 -3.7005384e-04
  1.9621909e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0930419e-03 -4.8089492e-05 -1.2843602e-04 -3.7005384e-04
  1.9621909e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0063376  -0.00066255 -0.00029676 -0.00302223  0.00243194]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00061754 -0.01263365 -0.02275921  0.04148806  0.24832626]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.13382384 -0.13259685 -0.23694187  0.08864787  2.4846234 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.13382384 -0.13259685 -0.23694187  0.08864787  2.4846234 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-3.4880601e-02 -1.6157028e-04 -5.9436224e-02 -9.3756840e-03
 -4.6394247e-01]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.25621387 -0.00092662 -0.25467524 -0.04932708 -0.37814313]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.25621387 -0.00092662 -0.25467524 -0.04932708 -0.37814313]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.2696748   0.23523913  0.5485816   0.22086196 -0.984125  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.2696748   0.23523913  0.5485816   0.22086196 -0.984125  ]
  [Layer 29] Output shape after mixer: (1, 1, 1024)
  [Layer 29] Output sample values after mixer: [ 1.2696748   0.23523913  0.5485816   0.22086196 -0.984125  ]
  [Layer 29] Residual connection shape: (1, 1, 1024)
  [Layer 29] Residual connection sample values: [-5.388088    0.40127856 -5.423786    2.209672    6.4696174 ]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.3134494   0.02228245 -0.307029    0.14677851  0.36578083]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.3134494   0.02228245 -0.307029    0.14677851  0.36578083]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.3134494   0.02228245 -0.307029    0.14677851  0.36578083]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.59628236  1.5849564   0.8553518  -0.7542895   1.5385495 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.59628236  1.5849564   0.8553518  -0.7542895   1.5385495 ]
  [FlaxMamba2] xBC (step) sample values: [-0.6531412   1.5906767  -0.89429384 -0.4752048   0.7479528 ]
  [FlaxMamba2] dt (step) sample values: [ 0.02478107  0.4174609   0.18803641 -1.6095526   0.6991705 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.0556526  -0.97053677  1.0343224  -0.6531412  -0.24479866]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.30485013 -0.52831924  0.35835764  0.20652063 -0.17264478]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.26203397 -0.5701283   0.933553    0.2559591  -0.2651741 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.14808488 -0.20593445  0.67010015  0.14426947 -0.11511001]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.14808488 -0.20593445  0.67010015  0.14426947 -0.11511001]
  [FlaxMamba2] B (step) sample values: [ 0.06833317 -0.01616219 -0.0779058   0.12174693 -0.23744702]
  [FlaxMamba2] C (step) sample values: [ 0.17057987 -0.07991417 -0.17023776 -0.12714061 -0.2542445 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2037584  -0.36680323 -0.20777717 -0.09522027 -0.4265393 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.53521156 0.34145886 0.514447   0.02065775 0.4609311 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.89668214 0.8822779  0.8986242  0.9980349  0.8215149 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.14808488 -0.20593445  0.67010015  0.14426947 -0.11511001]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00541586 -0.00128096 -0.00617456  0.00964926 -0.01881928]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00541586 -0.00128096 -0.00617456  0.00964926 -0.01881928]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00305741 -0.03462415 -0.00949321 -0.01220254  0.05716353]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.08410981 -0.10157372  1.2967235   0.25861716 -0.11099916]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05965203 -0.13558596  1.4073976   0.28244478 -0.13001078]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05965203 -0.13558596  1.4073976   0.28244478 -0.13001078]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02293537 -0.17834485  0.8447068  -0.06815045 -0.16467385]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.08642436 -0.7422772   2.125309   -0.284646   -0.25217652]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.08642436 -0.7422772   2.125309   -0.284646   -0.25217652]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.08334267 -1.608382   -1.5066975  -3.5655086  -1.2114458 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.08334267 -1.608382   -1.5066975  -3.5655086  -1.2114458 ]
  [Layer 30] Output shape after mixer: (1, 1, 1024)
  [Layer 30] Output sample values after mixer: [ 0.08334267 -1.608382   -1.5066975  -3.5655086  -1.2114458 ]
  [Layer 30] Residual connection shape: (1, 1, 1024)
  [Layer 30] Residual connection sample values: [-5.3047457 -1.2071035 -6.930484  -1.3558366  5.2581716]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.1853685  -0.04277762 -0.24324876 -0.0536618   0.18406594]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1853685  -0.04277762 -0.24324876 -0.0536618   0.18406594]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1853685  -0.04277762 -0.24324876 -0.0536618   0.18406594]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.8730559  -0.801883    0.56645495 -0.10794135 -0.09411136]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.8730559  -0.801883    0.56645495 -0.10794135 -0.09411136]
  [FlaxMamba2] xBC (step) sample values: [-0.40604842  0.4709543   0.01232684  0.02592033 -0.5407101 ]
  [FlaxMamba2] dt (step) sample values: [-0.244898    0.5913282   1.0250024   0.7888773   0.31200308]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.20685734 -0.2252947  -1.1196474  -0.40604842  0.34066603]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.07261562 -0.10514634 -0.00167481 -0.0151027  -0.41317493]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.06970882 -0.07020371 -0.01224915 -0.03326066 -0.47347766]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.03606875 -0.03387022 -0.00608707 -0.01635379 -0.18171762]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03606875 -0.03387022 -0.00608707 -0.01635379 -0.18171762]
  [FlaxMamba2] B (step) sample values: [-0.07077756  0.04340009  0.01622932 -0.03997954  0.06108946]
  [FlaxMamba2] C (step) sample values: [-0.12164385  0.00054858 -0.08271375 -0.13107927 -0.11345205]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-9.5765535e-03 -1.0641767e-02 -2.6350424e+01 -6.4467737e+02
 -1.6546801e-02]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03616457 0.10299143 1.7633889  1.9727961  0.08483539]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.9965376e-01 9.9890459e-01 6.6077393e-21 0.0000000e+00 9.9859720e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03606875 -0.03387022 -0.00608707 -0.01635379 -0.18171762]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.2323018e-05  5.6611549e-05  2.1169699e-05 -5.2149746e-05
  7.9685749e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.2323018e-05  5.6611549e-05  2.1169699e-05 -5.2149746e-05
  7.9685749e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01592819 -0.01047147  0.0078241   0.01538365  0.00592879]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02025359 -0.033725    0.00749207 -0.00971287 -0.0542393 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0247798  -0.02947467  0.00825593 -0.00766065 -0.03143582]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0247798  -0.02947467  0.00825593 -0.00766065 -0.03143582]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01526032  0.00731801  0.00298342  0.00039116  0.00140968]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.4045752   0.17545761  0.0724231   0.04203015  0.00987933]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.4045752   0.17545761  0.0724231   0.04203015  0.00987933]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-6.237569   1.6630791 -3.6150532 -1.9906108  0.2731899]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-6.237569   1.6630791 -3.6150532 -1.9906108  0.2731899]
  [Layer 31] Output shape after mixer: (1, 1, 1024)
  [Layer 31] Output sample values after mixer: [-6.237569   1.6630791 -3.6150532 -1.9906108  0.2731899]
  [Layer 31] Residual connection shape: (1, 1, 1024)
  [Layer 31] Residual connection sample values: [-11.542315     0.45597565 -10.545537    -3.3464475    5.5313616 ]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.6126618   0.02368484 -0.54396904 -0.20703192  0.2978955 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.6126618   0.02368484 -0.54396904 -0.20703192  0.2978955 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.6126618   0.02368484 -0.54396904 -0.20703192  0.2978955 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [1.1473548  0.18483436 0.9364522  1.5763098  0.379983  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [1.1473548  0.18483436 0.9364522  1.5763098  0.379983  ]
  [FlaxMamba2] xBC (step) sample values: [-0.32137263 -0.263564    0.8414227  -1.8360853   0.38459653]
  [FlaxMamba2] dt (step) sample values: [-0.25596133  0.18494843  0.31375575  0.24378562 -0.47266963]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.0760485  -0.37891003 -0.05959322 -0.32137263 -0.8073603 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00405031  0.06281357 -0.04688527  0.0857484  -0.10622194]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00963682 -0.30510634 -0.04896237  0.06226512 -0.11852052]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.0047952  -0.12945957 -0.02388198  0.03210149 -0.05575259]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0047952  -0.12945957 -0.02388198  0.03210149 -0.05575259]
  [FlaxMamba2] B (step) sample values: [ 0.26498517  0.00779139  0.03939077 -0.06101658  0.02682893]
  [FlaxMamba2] C (step) sample values: [-0.24792592 -0.20686829 -0.2515861  -0.05713458 -0.16666675]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.0662153  -0.08112868 -0.58786964 -0.09559295 -0.5447535 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.84384763 1.1820344  0.53994656 1.0233481  0.41309717]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9456568  0.9085577  0.7280263  0.9068077  0.79848737]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0047952  -0.12945957 -0.02388198  0.03210149 -0.05575259]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0722397e-03 -3.1527201e-05 -1.5939135e-04  2.4689833e-04
 -1.0856094e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0722397e-03 -3.1527201e-05 -1.5939135e-04  2.4689833e-04
 -1.0856094e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.02087263 0.10823085 0.13459376 0.27661636 0.1562379 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.4938612  -1.267107    0.20311673  1.1541078  -0.466191  ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.49396977 -1.2641761   0.20365742  1.153381   -0.46492878]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.49396977 -1.2641761   0.20365742  1.153381   -0.46492878]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.43018535 -0.12759821  0.13700663  1.5066136  -0.10491588]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.3623734  -0.23342659  0.24983746  1.721512   -0.13505745]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.3623734  -0.23342659  0.24983746  1.721512   -0.13505745]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-3.9244986   1.9110599   0.64358133  0.17586975  2.6671863 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-3.9244986   1.9110599   0.64358133  0.17586975  2.6671863 ]
  [Layer 32] Output shape after mixer: (1, 1, 1024)
  [Layer 32] Output sample values after mixer: [-3.9244986   1.9110599   0.64358133  0.17586975  2.6671863 ]
  [Layer 32] Residual connection shape: (1, 1, 1024)
  [Layer 32] Residual connection sample values: [-15.466813    2.3670354  -9.901956   -3.1705778   8.198547 ]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.7454607   0.11141976 -0.47458264 -0.16049708  0.399564  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.7454607   0.11141976 -0.47458264 -0.16049708  0.399564  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.7454607   0.11141976 -0.47458264 -0.16049708  0.399564  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.19748124  0.27219787  0.2099976  -1.0567726  -0.6989363 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.19748124  0.27219787  0.2099976  -1.0567726  -0.6989363 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.9715412   1.4759392   0.20998469 -0.78262645  0.70385945]
  [FlaxMamba2] dt (step) sample values: [ 1.6255542   0.6270852  -1.4719371  -1.5225669   0.28057674]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.28016454 -0.709317    1.9686584   0.9715412  -0.51504856]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.2560221   0.39936632  0.0306775  -0.22866848  0.14003783]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01424158  0.36277574  0.0173108  -0.3515933   0.10567504]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.00707008  0.21393329  0.00873031 -0.14520665  0.05562673]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00707008  0.21393329  0.00873031 -0.14520665  0.05562673]
  [FlaxMamba2] B (step) sample values: [ 0.01652472  0.04388826  0.00553908 -0.01374281  0.05171256]
  [FlaxMamba2] C (step) sample values: [ 0.02957281 -0.16026622  0.4561992   0.21683657  0.02574738]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-13.044406    -1.3849771   -0.1667907   -0.23590268  -5.254998  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06971013 0.00900969 0.01298873 0.01167524 0.01099754]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.40279514 0.9875993  0.99783593 0.99724954 0.94384617]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00707008  0.21393329  0.00873031 -0.14520665  0.05562673]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-8.1443131e-06 -2.1630613e-05 -2.7299698e-06  6.7732317e-06
 -2.5486866e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-8.1443131e-06 -2.1630613e-05 -2.7299698e-06  6.7732317e-06
 -2.5486866e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 9.1125147e-04 -6.3689036e-04 -1.3542372e-04  2.3051552e-06
  3.3331024e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 1.32484909e-03 -5.38534368e-04  1.42937815e-05  4.39613359e-04
 -1.13743544e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00624793  0.22860582  0.00936535 -0.1550915   0.05844446]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00624793  0.22860582  0.00936535 -0.1550915   0.05844446]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00067764  0.0353215   0.00108622  0.04227327 -0.01356382]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00716063  0.3618669   0.01518752  0.4967208  -0.1802018 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00716063  0.3618669   0.01518752  0.4967208  -0.1802018 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.6865464  0.9052048 -2.498101  -0.969503   1.8547854]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.6865464  0.9052048 -2.498101  -0.969503   1.8547854]
  [Layer 33] Output shape after mixer: (1, 1, 1024)
  [Layer 33] Output sample values after mixer: [-1.6865464  0.9052048 -2.498101  -0.969503   1.8547854]
  [Layer 33] Residual connection shape: (1, 1, 1024)
  [Layer 33] Residual connection sample values: [-17.15336     3.2722402 -12.400057   -4.140081   10.053333 ]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.63089263  0.11855208 -0.4741642  -0.15445931  0.3776241 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.63089263  0.11855208 -0.4741642  -0.15445931  0.3776241 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.63089263  0.11855208 -0.4741642  -0.15445931  0.3776241 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.2125261  -0.5996804  -0.49357802  0.48544925 -0.4828389 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.2125261  -0.5996804  -0.49357802  0.48544925 -0.4828389 ]
  [FlaxMamba2] xBC (step) sample values: [-0.11966293 -1.0825982   0.07812099  1.7313498  -0.9511829 ]
  [FlaxMamba2] dt (step) sample values: [-0.8231135  -1.3252549   0.6953294   0.17667308  0.7894186 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.21654475 -0.631929    0.37849823 -0.11966293 -1.6984829 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02200749  0.58209866 -0.00466214 -0.32358274 -0.31883273]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.06537297  0.48486966 -0.03865872 -0.40469846 -0.39286837]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.03161846  0.3000844  -0.01895578 -0.16195387 -0.15833656]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03161846  0.3000844  -0.01895578 -0.16195387 -0.15833656]
  [FlaxMamba2] B (step) sample values: [ 0.00220978 -0.02432246 -0.0030307   0.01344224 -0.01532144]
  [FlaxMamba2] C (step) sample values: [-0.27832898  0.06518042  0.01658979  0.00154528 -0.15642522]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2224774  -0.15365478 -0.8168739  -0.85911244 -2.0730147 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00577552 0.00190417 0.35481873 0.1178114  0.3525923 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9987159  0.99970746 0.7483817  0.9037403  0.4814615 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03161846  0.3000844  -0.01895578 -0.16195387 -0.15833656]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.0353444e-07  4.4415956e-06  5.5344481e-07 -2.4547276e-06
  2.7978945e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.0353444e-07  4.4415956e-06  5.5344481e-07 -2.4547276e-06
  2.7978945e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00299054  0.00743741  0.0033799  -0.0066927   0.01063525]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.03043837  0.11098497  0.06554806 -0.02605397 -0.05035173]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.09264808  0.7014048   0.02825233 -0.34470022 -0.3618809 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.09264808  0.7014048   0.02825233 -0.34470022 -0.3618809 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00880282 -0.14907435 -0.00528576 -0.1035857   0.06667388]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.06281722 -0.5948879  -0.03154311 -0.73054546  0.5011763 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.06281722 -0.5948879  -0.03154311 -0.73054546  0.5011763 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.2671614   1.4494839  -2.493552    0.04074865  0.52517563]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.2671614   1.4494839  -2.493552    0.04074865  0.52517563]
  [Layer 34] Output shape after mixer: (1, 1, 1024)
  [Layer 34] Output sample values after mixer: [ 0.2671614   1.4494839  -2.493552    0.04074865  0.52517563]
  [Layer 34] Residual connection shape: (1, 1, 1024)
  [Layer 34] Residual connection sample values: [-16.886198    4.721724  -14.893609   -4.0993323  10.578509 ]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.7860435   0.2180736  -0.6830409  -0.20343256  0.4894266 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.7860435   0.2180736  -0.6830409  -0.20343256  0.4894266 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.7860435   0.2180736  -0.6830409  -0.20343256  0.4894266 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.7258453  -0.2897257   0.04492838 -0.25636423  1.0170101 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.7258453  -0.2897257   0.04492838 -0.25636423  1.0170101 ]
  [FlaxMamba2] xBC (step) sample values: [-0.17228524  0.895756   -0.50744295 -2.2417321   1.5655274 ]
  [FlaxMamba2] dt (step) sample values: [ 0.8593752   1.1858339  -0.90017027  1.3215665   0.8686583 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.9954213   0.36135927 -0.48985565 -0.17228524 -0.1253959 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.02756963  0.2023043  -0.41084027 -0.4380234   0.37670577]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.023883    0.18057579 -0.43827558 -0.4628647   0.2644621 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.01179891  0.09841771 -0.1718706  -0.17880763  0.14961492]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01179891  0.09841771 -0.1718706  -0.17880763  0.14961492]
  [FlaxMamba2] B (step) sample values: [-0.04063851 -0.06752159  0.12774047 -0.11334384 -0.07901525]
  [FlaxMamba2] C (step) sample values: [-0.06394049  0.12745374 -0.27839932  0.01854123  0.16158533]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2053565  -0.14169171 -0.10705902 -0.1460468  -0.2580783 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [2.5006332  3.3919315  0.44748312 3.6829739  1.4760325 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.5983848  0.61840695 0.95322233 0.58398116 0.6832244 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01179891  0.09841771 -0.1718706  -0.17880763  0.14961492]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00119903  0.00199221 -0.00376895  0.00334418  0.00233132]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00119903  0.00199221 -0.00376895  0.00334418  0.00233132]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00582681 -0.00123321 -0.00910575  0.00369698 -0.01001162]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00881454  0.26292032 -0.6933407  -0.66535676  0.5072417 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02208256  0.52064085 -1.143408   -1.1335895   0.8990293 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02208256  0.52064085 -1.143408   -1.1335895   0.8990293 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00522701 -0.06457153 -0.02626265  0.12678161  0.6714687 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01011455 -0.121163   -0.01704428  0.35457435  1.0884455 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01011455 -0.121163   -0.01704428  0.35457435  1.0884455 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.7148876 -0.6738146 -2.0109324  2.0688777  0.5846426]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.7148876 -0.6738146 -2.0109324  2.0688777  0.5846426]
  [Layer 35] Output shape after mixer: (1, 1, 1024)
  [Layer 35] Output sample values after mixer: [-2.7148876 -0.6738146 -2.0109324  2.0688777  0.5846426]
  [Layer 35] Residual connection shape: (1, 1, 1024)
  [Layer 35] Residual connection sample values: [-19.601086    4.0479093 -16.904541   -2.0304546  11.163152 ]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.6915169   0.1460159  -0.59987855 -0.07646033  0.40344563]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.6915169   0.1460159  -0.59987855 -0.07646033  0.40344563]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.6915169   0.1460159  -0.59987855 -0.07646033  0.40344563]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.4002764  -0.65951854 -1.1090661  -0.15046868 -0.8565884 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-2.4002764  -0.65951854 -1.1090661  -0.15046868 -0.8565884 ]
  [FlaxMamba2] xBC (step) sample values: [-0.49706623  1.6250916  -0.221191    0.33963302 -1.2132214 ]
  [FlaxMamba2] dt (step) sample values: [0.5634938 1.1719282 0.6582474 1.1792469 0.5835684]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.8071251   0.94556344  2.9650278  -0.49706623  1.0246267 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.13161078  0.37589005 -0.06529946  0.05738904 -0.19582759]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.09132758  0.25833634 -0.12740272 -0.08726428 -0.2079507 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.04358006  0.1457604  -0.05964898 -0.04172958 -0.09320326]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04358006  0.1457604  -0.05964898 -0.04172958 -0.09320326]
  [FlaxMamba2] B (step) sample values: [ 0.07246929 -0.04030959 -0.07873764  0.2302045  -0.02196766]
  [FlaxMamba2] C (step) sample values: [-0.1001049   0.08648926 -0.2035025  -0.06142711  0.07001728]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.8654757 -5.63779   -3.8975632 -2.4259677 -3.6937442]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1197918  0.05426263 0.03476359 0.1234293  0.04406287]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7094534  0.7364446  0.873285   0.74123657 0.84979767]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04358006  0.1457604  -0.05964898 -0.04172958 -0.09320326]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00037833  0.00021044  0.00041105 -0.00120179  0.00011468]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00037833  0.00021044  0.00041105 -0.00120179  0.00011468]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00954785  0.00158407 -0.00224966  0.00170128  0.00343722]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02013652  0.03120651 -0.00803269 -0.01382268 -0.01334594]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.1537894   0.47822976 -0.19096632 -0.14180045 -0.29918504]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.1537894   0.47822976 -0.19096632 -0.14180045 -0.29918504]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03069435 -0.10750386  0.05253452  0.00986715  0.07638446]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.09031935 -0.67553437  0.22805806  0.04567424  0.40235454]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.09031935 -0.67553437  0.22805806  0.04567424  0.40235454]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.960092  -2.6918905  4.4102182 -5.572975   1.8386931]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.960092  -2.6918905  4.4102182 -5.572975   1.8386931]
  [Layer 36] Output shape after mixer: (1, 1, 1024)
  [Layer 36] Output sample values after mixer: [ 2.960092  -2.6918905  4.4102182 -5.572975   1.8386931]
  [Layer 36] Residual connection shape: (1, 1, 1024)
  [Layer 36] Residual connection sample values: [-16.640993    1.3560188 -12.494323   -7.60343    13.001844 ]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.5180936   0.04335064 -0.4080979  -0.2424752   0.4152468 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.5180936   0.04335064 -0.4080979  -0.2424752   0.4152468 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.5180936   0.04335064 -0.4080979  -0.2424752   0.4152468 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.66090375 -0.6316974  -0.21040212 -1.3822001   2.2890995 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.66090375 -0.6316974  -0.21040212 -1.3822001   2.2890995 ]
  [FlaxMamba2] xBC (step) sample values: [-0.13349202  1.0872566   0.8125347  -1.4223458   1.0415353 ]
  [FlaxMamba2] dt (step) sample values: [ 1.6174593   1.6583693   3.8679218   0.60632354 -0.3492603 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.61719257 -0.649439   -0.63286954 -0.13349202  2.2240481 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06417593 -0.38724622 -0.29980838  0.38132963 -0.2831257 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01358286 -0.45133314 -0.3844031   0.41621122 -0.36674386]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.0067453  -0.17558838 -0.15570839  0.25079903 -0.15011856]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0067453  -0.17558838 -0.15570839  0.25079903 -0.15011856]
  [FlaxMamba2] B (step) sample values: [-0.21464293 -0.24706385 -0.04829567 -0.07699899 -0.12020194]
  [FlaxMamba2] C (step) sample values: [-0.23948427 -0.15589061 -0.03683252 -0.16985379 -0.22779755]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.8178532  -31.169907   -39.01954     -0.46187502  -0.64770097]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00317859 0.03739686 0.14859729 0.00135848 0.00116832]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99423844 0.31171796 0.00303302 0.9993727  0.99924356]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0067453  -0.17558838 -0.15570839  0.25079903 -0.15011856]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [4.6020623e-06 5.2971845e-06 1.0354858e-06 1.6509006e-06 2.5771956e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [4.6020623e-06 5.2971845e-06 1.0354858e-06 1.6509006e-06 2.5771956e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00040597  0.00035262 -0.00061895  0.00089888 -0.00057475]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00165701  0.0061647  -0.00896319  0.01284313 -0.00540994]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01069778 -0.31544518 -0.29416063  0.47220978 -0.280369  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01069778 -0.31544518 -0.29416063  0.47220978 -0.280369  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00240766  0.06917033  0.02770241 -0.13096578 -0.58272856]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02217997  0.46078548  0.17356902 -1.2982247  -3.082443  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02217997  0.46078548  0.17356902 -1.2982247  -3.082443  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.6355784  -4.629191    2.8308687   0.13797908 -1.1897268 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.6355784  -4.629191    2.8308687   0.13797908 -1.1897268 ]
  [Layer 37] Output shape after mixer: (1, 1, 1024)
  [Layer 37] Output sample values after mixer: [ 2.6355784  -4.629191    2.8308687   0.13797908 -1.1897268 ]
  [Layer 37] Residual connection shape: (1, 1, 1024)
  [Layer 37] Residual connection sample values: [-14.005415   -3.2731721  -9.663454   -7.465451   11.812118 ]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.4184477  -0.09779442 -0.28734565 -0.21614559  0.35527012]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.4184477  -0.09779442 -0.28734565 -0.21614559  0.35527012]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.4184477  -0.09779442 -0.28734565 -0.21614559  0.35527012]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.5580271 -1.0693269  0.8706946 -0.7232833  0.5672397]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.5580271 -1.0693269  0.8706946 -0.7232833  0.5672397]
  [FlaxMamba2] xBC (step) sample values: [ 0.53411996 -1.0286534   0.14935522 -0.8803559   0.78906614]
  [FlaxMamba2] dt (step) sample values: [-0.32914126  0.31661454 -0.594985    0.5970022   1.550664  ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [1.7691193  2.66538    0.83034813 0.53411996 0.2552874 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.3293401  -0.13685966  0.26903427  0.10538168  0.13252422]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.33173    -0.4261663   0.17894638  0.0621993   0.22548077]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.13860334 -0.16835365  0.09745734  0.03206653  0.12539719]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.13860334 -0.16835365  0.09745734  0.03206653  0.12539719]
  [FlaxMamba2] B (step) sample values: [-0.04133926 -0.14586167  0.13959937 -0.03464393 -0.06036343]
  [FlaxMamba2] C (step) sample values: [-0.13937244 -0.08864246 -0.27485853 -0.01670877 -0.15600803]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17041285 -2.0831616  -0.13507122 -0.41240796 -3.531486  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.6310367  0.15938953 0.4223604  0.48875165 0.39696506]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8980435  0.71746284 0.944548   0.8174504  0.24613464]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.13860334 -0.16835365  0.09745734  0.03206653  0.12539719]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00361569  0.01275762 -0.01220989  0.00303009  0.00527962]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00361569  0.01275762 -0.01220989  0.00303009  0.00527962]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00850829  0.15947156 -0.01075303  0.00197376 -0.01062564]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.2732189  -0.24446811 -0.11318527 -0.1299811   0.5555013 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.2935466 -0.269159  -0.0988921 -0.1252782  0.5738921]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.2935466 -0.269159  -0.0988921 -0.1252782  0.5738921]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.07954746  0.07354669 -0.06069444  0.02960014  0.20773198]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.28493232  0.17736746 -0.16187243  0.15762454  0.7648369 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.28493232  0.17736746 -0.16187243  0.15762454  0.7648369 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-7.894677  19.176832  -4.2500787 -1.0794319  6.0777836]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-7.894677  19.176832  -4.2500787 -1.0794319  6.0777836]
  [Layer 38] Output shape after mixer: (1, 1, 1024)
  [Layer 38] Output sample values after mixer: [-7.894677  19.176832  -4.2500787 -1.0794319  6.0777836]
  [Layer 38] Residual connection shape: (1, 1, 1024)
  [Layer 38] Residual connection sample values: [-21.900093  15.90366  -13.913532  -8.544883  17.8899  ]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.40468624  0.31959888 -0.27116764 -0.17466402  0.34696314]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.40468624  0.31959888 -0.27116764 -0.17466402  0.34696314]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.40468624  0.31959888 -0.27116764 -0.17466402  0.34696314]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.22665475  0.12589735 -0.84532046 -0.21475506 -1.4219888 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.22665475  0.12589735 -0.84532046 -0.21475506 -1.4219888 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.8239754   0.75142246 -0.2491074   0.24229935  0.33632287]
  [FlaxMamba2] dt (step) sample values: [ 0.5342472  1.8382187 -1.9129449  2.174449   0.8107191]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 2.4909613  -0.6531149  -0.62293774  1.8239754   0.42559588]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.33983564 -0.16167124 -0.02065123  0.05395478  0.09283448]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.40428877 -0.22240122 -0.00539244  0.59155244  0.08943177]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.2424591  -0.09888575 -0.00268895  0.38079488  0.04671406]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.2424591  -0.09888575 -0.00268895  0.38079488  0.04671406]
  [FlaxMamba2] B (step) sample values: [-0.02221019  0.01904711 -0.16438809  0.17861061 -0.08914275]
  [FlaxMamba2] C (step) sample values: [-0.26351193 -0.22988924 -0.00900296 -0.08839914 -0.2780406 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.7351256e+02 -2.3790452e+00 -2.6078771e-03 -1.4978828e+00
 -6.3306607e-02]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.42364126 1.0801783  0.0435843  0.7809906  0.0199581 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [1.1920123e-32 7.6551393e-02 9.9988633e-01 3.1041893e-01 9.9873734e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.2424591  -0.09888575 -0.00268895  0.38079488  0.04671406]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00228133  0.00195644 -0.01688523  0.01834611 -0.00915636]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00228133  0.00195644 -0.01688523  0.01834611 -0.00915636]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00228133  0.00195644 -0.01688523  0.01834611 -0.00915636]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.04656228 -0.0189902  -0.00051639  0.07312853  0.00897106]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 1.1436563  -0.46643454 -0.01268352  1.7961729   0.22034574]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 1.1436563  -0.46643454 -0.01268352  1.7961729   0.22034574]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.11498204 -0.03120727  0.00322095 -0.17223808 -0.06089552]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.7235229  -0.18603595  0.01816817 -0.9479905  -0.4043122 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.7235229  -0.18603595  0.01816817 -0.9479905  -0.4043122 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-4.5584126 -5.007387  -2.240378   7.969514  -4.31864  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-4.5584126 -5.007387  -2.240378   7.969514  -4.31864  ]
  [Layer 39] Output shape after mixer: (1, 1, 1024)
  [Layer 39] Output sample values after mixer: [-4.5584126 -5.007387  -2.240378   7.969514  -4.31864  ]
  [Layer 39] Residual connection shape: (1, 1, 1024)
  [Layer 39] Residual connection sample values: [-26.458506   10.896273  -16.15391    -0.5753689  13.57126  ]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.533734    0.234546   -0.3405957  -0.01111076  0.28342208]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.533734    0.234546   -0.3405957  -0.01111076  0.28342208]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.533734    0.234546   -0.3405957  -0.01111076  0.28342208]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.16428097 -0.34560087  0.7949878  -0.861186    0.00723566]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.16428097 -0.34560087  0.7949878  -0.861186    0.00723566]
  [FlaxMamba2] xBC (step) sample values: [-0.8215866   0.6326279  -0.7038713  -0.57226247 -0.1139725 ]
  [FlaxMamba2] dt (step) sample values: [ 0.7387891   0.4510682  -0.00505585 -3.2478902   0.5157028 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.4070388  -0.30949703  0.00375456 -0.8215866   0.10990922]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.12415732 -0.10474827 -0.12454243  0.13355473 -0.01592949]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.2071415  -0.15324071 -0.1961977   0.12200382 -0.01439694]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.11425946 -0.07076114 -0.08850622  0.06471854 -0.00714665]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.11425946 -0.07076114 -0.08850622  0.06471854 -0.00714665]
  [FlaxMamba2] B (step) sample values: [ 0.03514349 -0.21651366 -0.02695185  0.04498305  0.06188235]
  [FlaxMamba2] C (step) sample values: [-0.22926173 -0.2694707  -0.1923871   0.23308203  1.0903511 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.52670574 -0.63007647 -0.38779998 -2.7909086  -0.42841786]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0370525  0.02026369 0.02756698 0.0002365  0.02681408]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.98067343 0.9873135  0.9893665  0.9993402  0.9885781 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.11425946 -0.07076114 -0.08850622  0.06471854 -0.00714665]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00014878 -0.00091663 -0.0001141   0.00019044  0.00026199]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00014878 -0.00091663 -0.0001141   0.00019044  0.00026199]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00283108 -0.04348538 -0.0068088   0.00032557 -0.00030704]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.08235034 -0.05307489 -0.05888975 -0.00486644  0.02611291]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.3652138  -0.22825286 -0.27799788  0.15535234  0.00842049]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.3652138  -0.22825286 -0.27799788  0.15535234  0.00842049]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-2.7540246e-02  3.2693602e-02 -1.5225059e-01 -3.9747074e-02
  3.0574116e-05]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-1.5391600e-01  2.1632257e-01 -1.0255282e+00 -2.1158491e-01
  2.6806653e-04]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-1.5391600e-01  2.1632257e-01 -1.0255282e+00 -2.1158491e-01
  2.6806653e-04]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-3.9092135  -3.2098167  -8.699794   -1.5898263   0.12181539]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-3.9092135  -3.2098167  -8.699794   -1.5898263   0.12181539]
  [Layer 40] Output shape after mixer: (1, 1, 1024)
  [Layer 40] Output sample values after mixer: [-3.9092135  -3.2098167  -8.699794   -1.5898263   0.12181539]
  [Layer 40] Residual connection shape: (1, 1, 1024)
  [Layer 40] Residual connection sample values: [-30.36772     7.6864557 -24.853703   -2.1651952  13.693076 ]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.3635767   0.09839245 -0.30691752 -0.02561478  0.16428368]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.3635767   0.09839245 -0.30691752 -0.02561478  0.16428368]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.3635767   0.09839245 -0.30691752 -0.02561478  0.16428368]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.8921236  -1.2106898  -0.19674338 -0.1927902   0.04295101]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.8921236  -1.2106898  -0.19674338 -0.1927902   0.04295101]
  [FlaxMamba2] xBC (step) sample values: [-0.864172    0.778222   -0.18162537  1.063316   -0.14393532]
  [FlaxMamba2] dt (step) sample values: [ 1.4662725   0.49601153  0.8829157  -0.82122105 -0.39731878]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6705064 -1.1127415 -1.0690017 -0.864172  -0.6582749]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.22865567 -0.18398976 -0.04088536 -0.18540655  0.03520174]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.2603329  -0.06161427 -0.04082284 -0.27811897  0.02564211]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.1133182  -0.02985836 -0.01999485 -0.11984563  0.01298543]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.1133182  -0.02985836 -0.01999485 -0.11984563  0.01298543]
  [FlaxMamba2] B (step) sample values: [-0.03435754  0.02227836  0.16007385 -0.03780637 -0.03123838]
  [FlaxMamba2] C (step) sample values: [-0.05056686  0.12350812  0.00058395 -0.08812154 -0.20214921]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.0530885  -1.135641   -0.87189615 -1.5713016  -1.7430981 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.2767437  0.32416564 0.23181981 0.05750012 0.05578347]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7471901  0.6920232  0.8169946  0.91361135 0.9073418 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.1133182  -0.02985836 -0.01999485 -0.11984563  0.01298543]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00107746 -0.00069865 -0.00501993  0.00118561  0.00097964]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00107746 -0.00069865 -0.00501993  0.00118561  0.00097964]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00812714 -0.00465158 -0.01498858 -0.00041639 -0.00810558]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01894497  0.00774314 -0.00084636 -0.02126457 -0.00376007]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.1638908  -0.03044882 -0.02642186 -0.17455967  0.01284965]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.1638908  -0.03044882 -0.02642186 -0.17455967  0.01284965]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.10371148  0.00846322  0.0023443   0.01520969  0.00028188]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-2.182844    0.23779343  0.05686724  0.44844496  0.0077173 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-2.182844    0.23779343  0.05686724  0.44844496  0.0077173 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-7.4425125 -3.0588207  1.7867928  4.8953195  1.1712184]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-7.4425125 -3.0588207  1.7867928  4.8953195  1.1712184]
  [Layer 41] Output shape after mixer: (1, 1, 1024)
  [Layer 41] Output sample values after mixer: [-7.4425125 -3.0588207  1.7867928  4.8953195  1.1712184]
  [Layer 41] Residual connection shape: (1, 1, 1024)
  [Layer 41] Residual connection sample values: [-37.810234    4.627635  -23.06691     2.7301242  14.864294 ]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.43065378  0.05663896 -0.2808976   0.03105361  0.1781406 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.43065378  0.05663896 -0.2808976   0.03105361  0.1781406 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.43065378  0.05663896 -0.2808976   0.03105361  0.1781406 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.15009788  0.49690965 -0.8358942  -0.6539962  -0.06346323]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.15009788  0.49690965 -0.8358942  -0.6539962  -0.06346323]
  [FlaxMamba2] xBC (step) sample values: [-0.02132909  0.78899807 -0.5622932   0.29382122 -0.21955697]
  [FlaxMamba2] dt (step) sample values: [ 0.9090342  -0.99207884  1.3703297   0.63173753  0.813902  ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.85377     0.7886849   0.26332572 -0.02132909  1.0389175 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00200501  0.16235098  0.12128559 -0.05550076 -0.04911603]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01886902  0.12658438  0.12590519 -0.05924107 -0.09528913]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.0093455   0.06729275  0.06691039 -0.02874342 -0.04537628]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0093455   0.06729275  0.06691039 -0.02874342 -0.04537628]
  [FlaxMamba2] B (step) sample values: [ 0.14519152 -0.0087716  -0.15916803 -0.00051087  0.01194023]
  [FlaxMamba2] C (step) sample values: [ 0.06771605 -0.23377171 -0.1896255  -0.26469922 -0.27776897]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.2458453 -1.7473589 -3.3796544 -1.2264227 -1.3705136]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.2397671  0.05033613 0.43562862 0.03873644 0.16691858]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.5836348  0.9158018  0.22940318 0.95360357 0.79551613]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0093455   0.06729275  0.06691039 -0.02874342 -0.04537628]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.2533699e-04  1.9654903e-05  3.5665478e-04  1.1447224e-06
 -2.6755000e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.2533699e-04  1.9654903e-05  3.5665478e-04  1.1447224e-06
 -2.6755000e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 3.5608781e-04  9.1711245e-04  9.2943420e-04  1.6526619e-04
 -5.6705579e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00545316  0.01298555  0.01315262 -0.00055525 -0.00498208]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0182305   0.10498938  0.10463367 -0.03985375 -0.06702132]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0182305   0.10498938  0.10463367 -0.03985375 -0.06702132]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00126569  0.03243595 -0.02644873  0.00891629  0.00205923]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02849496  0.7022258  -0.5895161   0.20133579  0.03166912]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02849496  0.7022258  -0.5895161   0.20133579  0.03166912]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-4.198917   -2.4674115   1.6752156  -0.34357095 -2.489684  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-4.198917   -2.4674115   1.6752156  -0.34357095 -2.489684  ]
  [Layer 42] Output shape after mixer: (1, 1, 1024)
  [Layer 42] Output sample values after mixer: [-4.198917   -2.4674115   1.6752156  -0.34357095 -2.489684  ]
  [Layer 42] Residual connection shape: (1, 1, 1024)
  [Layer 42] Residual connection sample values: [-42.00915     2.1602235 -21.391695    2.3865533  12.37461  ]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.4527432   0.02548551 -0.24153712  0.02570271  0.13557628]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.4527432   0.02548551 -0.24153712  0.02570271  0.13557628]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.4527432   0.02548551 -0.24153712  0.02570271  0.13557628]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.27292082  0.6161057  -0.6971336   0.38999954 -1.3112812 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.27292082  0.6161057  -0.6971336   0.38999954 -1.3112812 ]
  [FlaxMamba2] xBC (step) sample values: [-0.25887382 -0.24998187 -0.57939875 -0.4302594  -0.3427334 ]
  [FlaxMamba2] dt (step) sample values: [ 1.2134677   0.4269584  -0.77074003  1.0933822  -0.7706122 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.4484206  -0.01252129 -0.14547695 -0.25887382  0.6541059 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.05377304  0.03639306  0.11997474 -0.0755643  -0.06296047]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.06836808 -0.01783668  0.0919596  -0.12338534 -0.07127651]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.03301595 -0.0088388   0.04809245 -0.05789151 -0.03436871]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03301595 -0.0088388   0.04809245 -0.05789151 -0.03436871]
  [FlaxMamba2] B (step) sample values: [ 0.01115987  0.00235395 -0.00876001 -0.25448373  0.10281547]
  [FlaxMamba2] C (step) sample values: [-0.19089223  0.09686849 -0.06861581 -0.23749307  0.11060636]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-3.7045815 -2.655313  -8.210951  -2.2381823 -4.092597 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.9381277e-01 1.1915262e-01 2.9430442e-02 8.1943578e-01 5.9255620e-04]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.48772907 0.728777   0.78532946 0.15976575 0.99757785]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03301595 -0.0088388   0.04809245 -0.05789151 -0.03436871]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.1411050e-05 -1.5062735e-05  5.6054541e-05  1.6284192e-03
 -6.5790722e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.1411050e-05 -1.5062735e-05  5.6054541e-05  1.6284192e-03
 -6.5790722e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.3618381e-04 -4.9669299e-05 -1.7203162e-04  2.2402252e-03
 -1.1634252e-03]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00341178 -0.00216781  0.00349899 -0.00643523 -0.00399208]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05786765 -0.01674636  0.08282176 -0.10192037 -0.06067917]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05786765 -0.01674636  0.08282176 -0.10192037 -0.06067917]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0068257  -0.00669951 -0.01919483 -0.02370157  0.01688998]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13851944 -0.18216784 -0.41778025 -0.51950353  0.38262993]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.13851944 -0.18216784 -0.41778025 -0.51950353  0.38262993]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.5184305 -4.2713428 -1.0717037  7.926445  -2.4681423]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.5184305 -4.2713428 -1.0717037  7.926445  -2.4681423]
  [Layer 43] Output shape after mixer: (1, 1, 1024)
  [Layer 43] Output sample values after mixer: [ 1.5184305 -4.2713428 -1.0717037  7.926445  -2.4681423]
  [Layer 43] Residual connection shape: (1, 1, 1024)
  [Layer 43] Residual connection sample values: [-40.490723   -2.1111193 -22.463398   10.312998    9.906467 ]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.4209294  -0.02269508 -0.24212453  0.10479748  0.10424913]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.4209294  -0.02269508 -0.24212453  0.10479748  0.10424913]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.4209294  -0.02269508 -0.24212453  0.10479748  0.10424913]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.6190883   0.02758315 -0.34669363  0.32490543  0.17328961]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.6190883   0.02758315 -0.34669363  0.32490543  0.17328961]
  [FlaxMamba2] xBC (step) sample values: [ 0.62443125  0.03908215 -0.5336226  -0.469462   -0.5112647 ]
  [FlaxMamba2] dt (step) sample values: [-0.11458505 -1.3463985  -0.08465145  0.27609068 -0.7104654 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.2909551  -0.7955969  -0.5636504   0.62443125 -0.8587781 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12677473 -0.00795085 -0.08948531  0.08183736 -0.08966463]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.1482591  -0.06501873 -0.11821761  0.06868428 -0.08303469]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.0796147  -0.03145288 -0.05561902  0.03552106 -0.03979464]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0796147  -0.03145288 -0.05561902  0.03552106 -0.03979464]
  [FlaxMamba2] B (step) sample values: [-0.01148174 -0.21829194 -0.27846304  0.07383449 -0.02090438]
  [FlaxMamba2] C (step) sample values: [ 0.14108196 -0.27720028 -0.16624604 -0.14220692 -0.11289503]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-4.6876054  -0.9752563  -0.82549465 -1.2937802  -0.49527767]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08899473 0.01174797 0.02256695 0.05936496 0.0038187 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.6589075  0.9886081  0.98154354 0.9260702  0.9981105 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0796147  -0.03145288 -0.05561902  0.03552106 -0.03979464]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-8.1351442e-05 -1.5466614e-03 -1.9729908e-03  5.2313862e-04
 -1.4811356e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-8.1351442e-05 -1.5466614e-03 -1.9729908e-03  5.2313862e-04
 -1.4811356e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00061589 -0.00044307 -0.00081602  0.0005559  -0.00095863]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-4.0569950e-05 -2.9976366e-04 -9.5136190e-04  6.1016972e-04
  1.3162009e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.13831717 -0.05495989 -0.0976084   0.06234014 -0.06902517]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.13831717 -0.05495989 -0.0976084   0.06234014 -0.06902517]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.05566081 -0.00076844  0.01401609  0.01175822 -0.00649757]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 1.2831485  -0.01622243  0.3750067   0.270405   -0.14652044]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 1.2831485  -0.01622243  0.3750067   0.270405   -0.14652044]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.7151022  1.8543111  1.4422046  1.3868115 -0.6791056]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.7151022  1.8543111  1.4422046  1.3868115 -0.6791056]
  [Layer 44] Output shape after mixer: (1, 1, 1024)
  [Layer 44] Output sample values after mixer: [-0.7151022  1.8543111  1.4422046  1.3868115 -0.6791056]
  [Layer 44] Residual connection shape: (1, 1, 1024)
  [Layer 44] Residual connection sample values: [-41.205826    -0.25680816 -21.021193    11.699809     9.227362  ]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.50452244 -0.00339475 -0.27041277  0.14374089  0.11445754]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.50452244 -0.00339475 -0.27041277  0.14374089  0.11445754]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.50452244 -0.00339475 -0.27041277  0.14374089  0.11445754]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.63147086 -1.6148169   0.16623046 -0.43744898 -1.4203866 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.63147086 -1.6148169   0.16623046 -0.43744898 -1.4203866 ]
  [FlaxMamba2] xBC (step) sample values: [-0.36166283  0.91976583 -0.66419226 -0.49671718  0.7462001 ]
  [FlaxMamba2] dt (step) sample values: [ 0.62978727 -0.527684    0.9528455   1.9191282   0.94977075]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.18906733  0.30722773  0.24022754 -0.36166283  0.38644785]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.05954516  0.10789692 -0.12455153  0.10236582  0.12312926]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.06520617  0.36595356 -0.14684463  0.04636607  0.11237944]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.0315405   0.21608858 -0.06804114  0.02372039  0.05934368]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0315405   0.21608858 -0.06804114  0.02372039  0.05934368]
  [FlaxMamba2] B (step) sample values: [-0.16225328 -0.16213176 -0.11494352 -0.2741526  -0.06639478]
  [FlaxMamba2] C (step) sample values: [-0.24667113 -0.16774993 -0.07285327 -0.07032853 -0.25496477]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.3039274e+00 -3.9384812e-02 -6.8873577e+00 -8.0558503e-01
 -1.9935181e+03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00416237 0.01097984 0.01991064 0.0042787  0.0487063 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99458724 0.9995676  0.87185544 0.9965591  0.        ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0315405   0.21608858 -0.06804114  0.02372039  0.05934368]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [2.1301161e-05 2.1285206e-05 1.5090175e-05 3.5991685e-05 8.7165317e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [2.1301161e-05 2.1285206e-05 1.5090175e-05 3.5991685e-05 8.7165317e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00166542 0.00098798 0.00123095 0.00021106 0.00162284]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00087305  0.0314499  -0.00808846 -0.01145837  0.00592274]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.08273053  0.59226745 -0.18467653  0.05010347  0.15993817]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.08273053  0.59226745 -0.18467653  0.05010347  0.15993817]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0181372  -0.15868735 -0.01662227 -0.00859939 -0.04420829]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.21512267 -1.4120996  -0.17660505 -0.0865375  -0.5335889 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.21512267 -1.4120996  -0.17660505 -0.0865375  -0.5335889 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-3.9893804   4.0028167   0.55634654  2.7097077  -6.349613  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-3.9893804   4.0028167   0.55634654  2.7097077  -6.349613  ]
  [Layer 45] Output shape after mixer: (1, 1, 1024)
  [Layer 45] Output sample values after mixer: [-3.9893804   4.0028167   0.55634654  2.7097077  -6.349613  ]
  [Layer 45] Residual connection shape: (1, 1, 1024)
  [Layer 45] Residual connection sample values: [-45.195206    3.7460084 -20.464846   14.409517    2.8777485]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.50620824  0.04512464 -0.24157658  0.16429462  0.03190387]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.50620824  0.04512464 -0.24157658  0.16429462  0.03190387]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.50620824  0.04512464 -0.24157658  0.16429462  0.03190387]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.12733953 -0.19833437  0.15204373 -1.790749    1.5218238 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.12733953 -0.19833437  0.15204373 -1.790749    1.5218238 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.8542167  -0.64888257  0.07735418  0.06335598  1.3555489 ]
  [FlaxMamba2] dt (step) sample values: [ 0.02210819 -0.00635221 -1.2870094  -0.2723329   0.50046587]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.3960607  0.3864614  1.2188412  0.8542167 -0.681419 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03650741  0.11776281  0.01522052 -0.01216924 -0.2212708 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01894303  0.08043981  0.21810138 -0.0076679  -0.22652364]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.00956122  0.04183668  0.12089583 -0.00381925 -0.10048815]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00956122  0.04183668  0.12089583 -0.00381925 -0.10048815]
  [FlaxMamba2] B (step) sample values: [-0.19055472 -0.04031167 -0.10917338 -0.06164128 -0.04969161]
  [FlaxMamba2] C (step) sample values: [ 0.04775107  0.03664377 -0.11548818 -0.10635033  0.05290195]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.4426116  -0.9829804 -10.158994   -1.363838   -1.7559118]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00897912 0.0138577  0.00030128 0.00995831 0.01787929]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.98713017 0.9864705  0.996944   0.9865103  0.9690932 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00956122  0.04183668  0.12089583 -0.00381925 -0.10048815]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.6359381e-05 -3.4608117e-06 -9.3726831e-06 -5.2919877e-06
 -4.2660927e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.6359381e-05 -3.4608117e-06 -9.3726831e-06 -5.2919877e-06
 -4.2660927e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.5148212e-03  2.9957469e-04 -5.8946564e-05  4.1067044e-04
 -8.1831572e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00036912 -0.00096513  0.00480995 -0.00033525 -0.00258992]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01208275  0.05028976  0.15292169 -0.00501428 -0.12569983]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01208275  0.05028976  0.15292169 -0.00501428 -0.12569983]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00081822 -0.00449415  0.01250748  0.00128387 -0.15701461]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02404478 -0.12278383  0.2914906   0.02962266 -3.6207552 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02404478 -0.12278383  0.2914906   0.02962266 -3.6207552 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.3991433  -1.7249404   4.853687    0.96950483 -4.1447625 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.3991433  -1.7249404   4.853687    0.96950483 -4.1447625 ]
  [Layer 46] Output shape after mixer: (1, 1, 1024)
  [Layer 46] Output sample values after mixer: [ 1.3991433  -1.7249404   4.853687    0.96950483 -4.1447625 ]
  [Layer 46] Residual connection shape: (1, 1, 1024)
  [Layer 46] Residual connection sample values: [-43.796062   2.021068 -15.611158  15.379023  -1.267014]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.4191304   0.02016642 -0.1525846   0.1389415  -0.01213346]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.4191304   0.02016642 -0.1525846   0.1389415  -0.01213346]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.4191304   0.02016642 -0.1525846   0.1389415  -0.01213346]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.55936855 -0.405005   -0.06653444 -0.31741735 -0.6133455 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.55936855 -0.405005   -0.06653444 -0.31741735 -0.6133455 ]
  [FlaxMamba2] xBC (step) sample values: [-0.7599935   0.43224314  1.1127926  -1.9381783   0.05530773]
  [FlaxMamba2] dt (step) sample values: [0.08499932 0.06632868 0.70636415 1.0904106  1.2035486 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.7105696   0.26967475 -0.23631448 -0.7599935   0.90038073]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [0.1680846  0.07335085 0.21601972 0.34428108 0.00510412]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [0.15516041 0.08843417 0.21490583 0.35107887 0.00319009]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [0.08358684 0.04617096 0.11895481 0.20604089 0.00159759]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [0.08358684 0.04617096 0.11895481 0.20604089 0.00159759]
  [FlaxMamba2] B (step) sample values: [-0.02064783 -0.02579861  0.00716737  0.01192923 -0.21895541]
  [FlaxMamba2] C (step) sample values: [-0.25771612 -0.13702583  0.12984698 -0.22000746 -0.2532788 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-5.7667141e+01 -2.2024069e+00 -3.8371372e+00 -4.6045512e-02
 -2.0699801e+00]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05033268 0.00474763 0.02608099 0.05186701 0.01352492]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.05488354 0.9895983  0.90476835 0.9976146  0.97239196]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [0.08358684 0.04617096 0.11895481 0.20604089 0.00159759]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-8.68685165e-05 -1.08538625e-04  3.01541986e-05  5.01880713e-05
 -9.21178202e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-8.68685165e-05 -1.08538625e-04  3.01541986e-05  5.01880713e-05
 -9.21178202e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-8.4390820e-05 -1.0852312e-04  3.2978409e-05  4.4361841e-05
 -9.3842618e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 1.4524651e-03  8.2552573e-04  2.2203650e-03  3.6212967e-03
 -1.9753905e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [0.1331684  0.07358162 0.18966906 0.32830003 0.00249773]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [0.1331684  0.07358162 0.18966906 0.32830003 0.00249773]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02709161 -0.01192366 -0.00609993 -0.04390343 -0.00053818]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.769906   -0.37493107 -0.17583229 -1.8125919  -0.01792931]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.769906   -0.37493107 -0.17583229 -1.8125919  -0.01792931]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.1767261 24.243769  -3.847791   4.380593   1.4930226]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.1767261 24.243769  -3.847791   4.380593   1.4930226]
  [Layer 47] Output shape after mixer: (1, 1, 1024)
  [Layer 47] Output sample values after mixer: [-1.1767261 24.243769  -3.847791   4.380593   1.4930226]
  [Layer 47] Residual connection shape: (1, 1, 1024)
  [Layer 47] Residual connection sample values: [-44.97279     26.264837   -19.45895     19.759615     0.22600853]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.40372664  0.2543932  -0.18625335  0.17299454  0.00209948]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.40372664  0.2543932  -0.18625335  0.17299454  0.00209948]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.40372664  0.2543932  -0.18625335  0.17299454  0.00209948]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.6705931  -1.0580642  -0.54109997 -0.2347804   0.16157278]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.6705931  -1.0580642  -0.54109997 -0.2347804   0.16157278]
  [FlaxMamba2] xBC (step) sample values: [ 0.5649321   0.6335699  -0.11936674 -1.0255166  -0.5217365 ]
  [FlaxMamba2] dt (step) sample values: [-1.2987382  -3.751119   -0.32390583  1.0483807   0.2731265 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.2602709   0.5809656  -0.21160093  0.5649321   1.2447462 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.08648412  0.10101142 -0.01477247 -0.12038685 -0.08236343]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.08252446  0.07049384 -0.02681165 -0.20046498 -0.16463882]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.03956062  0.03648875 -0.01322612 -0.09021945 -0.07555819]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03956062  0.03648875 -0.01322612 -0.09021945 -0.07555819]
  [FlaxMamba2] B (step) sample values: [-0.08752912 -0.07208845 -0.27728504 -0.05564149  0.08234365]
  [FlaxMamba2] C (step) sample values: [-0.02201947 -0.02693797 -0.26645124 -0.05608586  0.01695535]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.7303779  -7.389056   -3.3796544  -1.802826  -17.760078 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [3.1471751e-03 5.0484277e-06 4.6397182e-03 5.4133188e-02 1.2299150e-01]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.994569   0.9999627  0.98444164 0.90701824 0.11255213]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03956062  0.03648875 -0.01322612 -0.09021945 -0.07555819]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0897743e-05  8.9753157e-06  3.4523153e-05  6.9275998e-06
 -1.0252132e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0897743e-05  8.9753157e-06  3.4523153e-05  6.9275998e-06
 -1.0252132e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.6472906e-04  5.1454757e-04  8.7267859e-04 -2.1821646e-04
 -3.2223717e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00045175  0.00107226 -0.001045   -0.0039256  -0.00277813]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05672064  0.05297189 -0.01985712 -0.13224886 -0.11024801]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05672064  0.05297189 -0.01985712 -0.13224886 -0.11024801]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01500433 -0.01444234  0.00395331  0.0137106  -0.00962451]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.6121999  -0.66000813  0.17107168  0.52213997 -0.4990857 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.6121999  -0.66000813  0.17107168  0.52213997 -0.4990857 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.8036394   0.35538638  6.9392514  10.260178   14.0708275 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.8036394   0.35538638  6.9392514  10.260178   14.0708275 ]
  [Layer 48] Output shape after mixer: (1, 1, 1024)
  [Layer 48] Output sample values after mixer: [-2.8036394   0.35538638  6.9392514  10.260178   14.0708275 ]
  [Layer 48] Residual connection shape: (1, 1, 1024)
  [Layer 48] Residual connection sample values: [-47.77643   26.620224 -12.519699  30.019793  14.296836]
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.9085653   0.73133904 -0.27239195  0.5155959   0.2796661 ]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 1, 1024)
[Mamba2LMHeadModel] Final backbone norm output sample values: [-0.9085653   0.73133904 -0.27239195  0.5155959   0.2796661 ]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 1, 50288)
[Mamba2LMHeadModel] Logits sample values: [-31.171795 -38.564358 -35.240444 -36.29675  -34.20038 ]
[Mamba2LMHeadModel] Forward pass input_ids shape: (1, 1)
[Mamba2LMHeadModel] input_ids sample values: [1039]
[Mamba2LMHeadModel] Embedding output shape: (1, 1, 1024)
[Mamba2LMHeadModel] Embedding sample values: [-0.4272461   0.03179932 -0.2668457  -0.17626953  0.05325317]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.5160199   0.0488776  -0.35343844 -0.18192457  0.06022879]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.5160199   0.0488776  -0.35343844 -0.18192457  0.06022879]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.5160199   0.0488776  -0.35343844 -0.18192457  0.06022879]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.89251053 -0.33993286  0.023035    0.41444495 -0.15323389]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.89251053 -0.33993286  0.023035    0.41444495 -0.15323389]
  [FlaxMamba2] xBC (step) sample values: [ 0.08863552 -0.3854498   0.5471444  -0.20644774  0.40202922]
  [FlaxMamba2] dt (step) sample values: [ 0.27700588  0.04239571  0.15596361  0.11023635 -0.00965866]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [0.01573907 0.7266964  0.64639604 0.08863552 0.14707138]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.07837406  0.55616266  0.07146358 -0.0931195  -0.08302861]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.12094608  0.5485714   0.18419552 -0.30259216 -0.28017217]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.06412558  0.3476868   0.10055585 -0.12857866 -0.12058935]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06412558  0.3476868   0.10055585 -0.12857866 -0.12058935]
  [FlaxMamba2] B (step) sample values: [-0.25274622 -0.07528735 -0.08547659  0.64594203 -0.05480159]
  [FlaxMamba2] C (step) sample values: [-0.2734332  -0.05647635 -0.05981461 -0.20418447  0.2381829 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.4383634 -1.0010935 -1.2128745 -1.1529616 -1.4844131]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.07287372 0.03534784 0.02839919 0.02909586 0.02223796]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9685597 0.9652323 0.9661418 0.96701   0.9675286]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06412558  0.3476868   0.10055585 -0.12857866 -0.12058935]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0011811  -0.00035182 -0.00039944  0.00301853 -0.00025609]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0011811  -0.00035182 -0.00039944  0.00301853 -0.00025609]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01983204 -0.00399198 -0.00094165  0.04822051 -0.00069978]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.11247057  0.02523641  0.22773996 -0.36348566 -0.30017233]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.22244993  0.6215409   0.40019947 -0.5840061  -0.50699055]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.22244993  0.6215409   0.40019947 -0.5840061  -0.50699055]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.05769382 -0.08785658  0.00466238 -0.14574419  0.03587376]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.05438611 -0.06835327  0.00362498 -0.09291712  0.11710443]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.05438611 -0.06835327  0.00362498 -0.09291712  0.11710443]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.36077026  0.19559996  1.0731612  -0.1327606  -0.25851333]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.36077026  0.19559996  1.0731612  -0.1327606  -0.25851333]
  [Layer 1] Output shape after mixer: (1, 1, 1024)
  [Layer 1] Output sample values after mixer: [-0.36077026  0.19559996  1.0731612  -0.1327606  -0.25851333]
  [Layer 1] Residual connection shape: (1, 1, 1024)
  [Layer 1] Residual connection sample values: [-0.7880163   0.22739927  0.80631554 -0.30903012 -0.20526016]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.7176217   0.17391318  0.5691804  -0.29593527 -0.17017508]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.7176217   0.17391318  0.5691804  -0.29593527 -0.17017508]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.7176217   0.17391318  0.5691804  -0.29593527 -0.17017508]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.521312   -2.0699599  -0.83910537  3.0657997  -1.0953019 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-2.521312   -2.0699599  -0.83910537  3.0657997  -1.0953019 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.82328     0.4484027   1.3937058  -5.043869    0.38502008]
  [FlaxMamba2] dt (step) sample values: [-0.12744948  0.81130075 -1.1105751   0.52276075  0.88708586]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [0.662316   1.432084   0.13903707 1.82328    0.4700334 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.0622694  -0.00228187 -0.1717674  -0.21779662 -0.0449197 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.05293865 -0.03220435 -0.28358382 -0.3618396  -0.04154179]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.02716979 -0.01584292 -0.12182063 -0.14854033 -0.02033953]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02716979 -0.01584292 -0.12182063 -0.14854033 -0.02033953]
  [FlaxMamba2] B (step) sample values: [-0.02534453 -0.0111317   0.08295353 -0.03946463  0.01216526]
  [FlaxMamba2] C (step) sample values: [-0.02973528 -0.08093027 -0.23837648  0.24872936  0.04009108]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-12.692555   -19.429585    -0.22886811  -2.10566     -5.0388985 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04448231 0.07704196 0.00817991 0.10354593 0.13243553]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.5685909  0.22382444 0.9981296  0.8040993  0.5130771 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02716979 -0.01584292 -0.12182063 -0.14854033 -0.02033953]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.06307593e-05 -1.34534985e-05  1.00255558e-04 -4.76959649e-05
  1.47026285e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.06307593e-05 -1.34534985e-05  1.00255558e-04 -4.76959649e-05
  1.47026285e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.0206955e-04 -3.7126189e-05 -3.6175147e-04  1.5949490e-04
  1.6281519e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00173439  0.0004744  -0.00030269  0.00490798  0.00034019]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01637772 -0.01008691 -0.08151158 -0.09411298 -0.01321868]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01637772 -0.01008691 -0.08151158 -0.09411298 -0.01321868]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0030713   0.00233957  0.0206369  -0.27568027  0.00362861]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00195372  0.00209226  0.01670419 -0.14693359  0.00337531]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00195372  0.00209226  0.01670419 -0.14693359  0.00337531]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.11006036  0.01714283 -0.22977622  0.04147756 -0.08202127]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.11006036  0.01714283 -0.22977622  0.04147756 -0.08202127]
  [Layer 2] Output shape after mixer: (1, 1, 1024)
  [Layer 2] Output sample values after mixer: [ 0.11006036  0.01714283 -0.22977622  0.04147756 -0.08202127]
  [Layer 2] Residual connection shape: (1, 1, 1024)
  [Layer 2] Residual connection sample values: [-0.677956    0.2445421   0.57653934 -0.26755255 -0.28728142]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.8489075   0.25695056  0.5396113  -0.35857087 -0.34333375]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.8489075   0.25695056  0.5396113  -0.35857087 -0.34333375]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.8489075   0.25695056  0.5396113  -0.35857087 -0.34333375]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 2.9303174  -1.1393429  -0.8942702   0.13187163 -1.9326088 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 2.9303174  -1.1393429  -0.8942702   0.13187163 -1.9326088 ]
  [FlaxMamba2] xBC (step) sample values: [-0.5940917  -0.7755268   0.77836144  2.2696302  -0.5298141 ]
  [FlaxMamba2] dt (step) sample values: [ 0.73680973 -0.09632865 -1.3535713   0.52528006  0.58177906]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 2.5471575  -0.11297893  0.21543829 -0.5940917  -0.53134364]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.07076241  0.01525346  0.40112126 -0.11590335  0.17718022]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.11562325 -0.06250533  0.35000432 -0.1625342   0.11034672]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.05447316 -0.03027625  0.20531906 -0.07467727  0.05821438]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05447316 -0.03027625  0.20531906 -0.07467727  0.05821438]
  [FlaxMamba2] B (step) sample values: [-0.16019374  0.3453023  -0.03917547 -0.01927646 -0.25280207]
  [FlaxMamba2] C (step) sample values: [-0.14540675  0.21738501 -0.0879981   0.20461313  0.1364676 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-20.926485    -0.880345    -0.67350245  -0.6461216   -0.27258503]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [2.6060292e-02 4.3977886e-03 1.1636204e-05 8.8340631e-03 1.8357331e-02]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.5796387  0.9961359  0.9999922  0.99430835 0.9950086 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05447316 -0.03027625  0.20531906 -0.07467727  0.05821438]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.2740886e-04 -4.9018650e-04  5.5612960e-05  2.7364598e-05
  3.5887441e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.2740886e-04 -4.9018650e-04  5.5612960e-05  2.7364598e-05
  3.5887441e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.4080782e-05 -6.5048668e-04 -1.5435269e-04 -1.6848999e-05
  1.0056974e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00044438  0.00270456 -0.00263831 -0.0033263  -0.00202818]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03822644 -0.01878873  0.14311893 -0.05634015  0.03929856]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03822644 -0.01878873  0.14311893 -0.05634015  0.03929856]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.10633921  0.00518989 -0.03714558 -0.00395942 -0.00960464]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.07296085  0.00317684 -0.01796244 -0.00213068 -0.00768101]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.07296085  0.00317684 -0.01796244 -0.00213068 -0.00768101]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.24769944  0.5479003  -0.27064216 -0.10156164 -0.30197543]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.24769944  0.5479003  -0.27064216 -0.10156164 -0.30197543]
  [Layer 3] Output shape after mixer: (1, 1, 1024)
  [Layer 3] Output sample values after mixer: [-0.24769944  0.5479003  -0.27064216 -0.10156164 -0.30197543]
  [Layer 3] Residual connection shape: (1, 1, 1024)
  [Layer 3] Residual connection sample values: [-0.9256554   0.79244244  0.30589718 -0.3691142  -0.5892569 ]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.6361256   0.47163668  0.17139204 -0.26969984 -0.38102755]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.6361256   0.47163668  0.17139204 -0.26969984 -0.38102755]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.6361256   0.47163668  0.17139204 -0.26969984 -0.38102755]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.44050315 -2.4329488  -0.58993244 -1.0694314  -1.678434  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.44050315 -2.4329488  -0.58993244 -1.0694314  -1.678434  ]
  [FlaxMamba2] xBC (step) sample values: [-0.19602846  1.8550404  -1.5264482  -1.2792447  -0.88693523]
  [FlaxMamba2] dt (step) sample values: [ 0.41349885  0.68589973  0.42460656  0.06835728 -0.4241043 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.73858327 -0.72604185  0.05910201 -0.19602846  0.5750487 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.02817641 -0.14574912  0.0966944  -0.50109375  0.07935444]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.05022536 -0.13319114  0.05628913 -0.565791    0.33838764]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.0257432  -0.06216714  0.02893647 -0.20493437  0.19755031]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0257432  -0.06216714  0.02893647 -0.20493437  0.19755031]
  [FlaxMamba2] B (step) sample values: [-0.25745097 -0.07558362  0.07128356 -0.02145644  0.02284852]
  [FlaxMamba2] C (step) sample values: [-0.2780381   0.5263849   0.48983243 -0.04729481 -0.09542479]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.49070406 -0.5047996  -0.6491257  -0.5552266  -0.46572492]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06718145 0.11018066 0.1249402  0.04226536 0.22773248]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.96757126 0.9458993  0.9220997  0.97680634 0.8993701 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0257432  -0.06216714  0.02893647 -0.20493437  0.19755031]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.4525252e-04 -1.3071926e-04  1.2328244e-04 -3.7108162e-05
  3.9515726e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.4525252e-04 -1.3071926e-04  1.2328244e-04 -3.7108162e-05
  3.9515726e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.03242649 -0.00403893  0.00042776  0.00231261 -0.00080689]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.02028309  0.00635165 -0.004832   -0.0310416   0.02405964]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03735985 -0.03488695  0.01436302 -0.1669849   0.15510471]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03735985 -0.03488695  0.01436302 -0.1669849   0.15510471]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00644496  0.00684919 -0.00302197  0.04562892 -0.04095115]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00866098  0.00988467 -0.0036423   0.06056231 -0.03957856]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00866098  0.00988467 -0.0036423   0.06056231 -0.03957856]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.13594978 -0.12833169 -0.2547022  -0.01291648 -0.22245054]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.13594978 -0.12833169 -0.2547022  -0.01291648 -0.22245054]
  [Layer 4] Output shape after mixer: (1, 1, 1024)
  [Layer 4] Output sample values after mixer: [-0.13594978 -0.12833169 -0.2547022  -0.01291648 -0.22245054]
  [Layer 4] Residual connection shape: (1, 1, 1024)
  [Layer 4] Residual connection sample values: [-1.0616052   0.6641108   0.05119497 -0.38203067 -0.81170744]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.95275337  0.502482    0.03385614 -0.3418477  -0.69108796]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.95275337  0.502482    0.03385614 -0.3418477  -0.69108796]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.95275337  0.502482    0.03385614 -0.3418477  -0.69108796]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-4.855641   -0.7838984  -0.23209989 -1.405727   -0.28910714]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-4.855641   -0.7838984  -0.23209989 -1.405727   -0.28910714]
  [FlaxMamba2] xBC (step) sample values: [-2.9133613  -2.276117    1.7678832   1.0080012  -0.72815996]
  [FlaxMamba2] dt (step) sample values: [-0.20556453 -1.8748702   0.8366101  -0.94605625  0.9557221 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.2688788  1.0947375 -0.8512082 -2.9133613 -3.925372 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.9207694  -0.8832836   0.14935274 -0.19248834  0.1008925 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.9841239  -1.1246166   0.14200182 -0.16561761  0.11183305]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.2677548  -0.27570644  0.07603358 -0.07596714  0.05903993]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.2677548  -0.27570644  0.07603358 -0.07596714  0.05903993]
  [FlaxMamba2] B (step) sample values: [ 0.03558299  0.05073862 -0.19331227 -0.0817875   0.02041031]
  [FlaxMamba2] C (step) sample values: [ 0.01140479 -0.19317561 -0.2764987  -0.15529707  0.04744193]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.07591622 -0.53187454 -0.04695368 -1.4938657  -3.6258397 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.13004848 0.00215995 0.08304259 0.00548022 0.0416499 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9901758  0.99885184 0.9961084  0.9918467  0.8598341 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.2677548  -0.27570644  0.07603358 -0.07596714  0.05903993]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00123904 -0.00176677  0.00673135  0.00284793 -0.00071071]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00123904 -0.00176677  0.00673135  0.00284793 -0.00071071]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.02215128 -0.00086407  0.49529052  0.05400695 -0.00049782]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.3834144  -0.47262123 -0.32567456 -0.16536407 -0.09890246]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.7602236  -0.8606208  -0.21867308 -0.27227205 -0.01581601]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.7602236  -0.8606208  -0.21867308 -0.27227205 -0.01581601]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [0.02851296 0.21148612 0.02244515 0.07536495 0.00195806]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.0020631  0.01617261 0.00351438 0.01296833 0.00036623]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.0020631  0.01617261 0.00351438 0.01296833 0.00036623]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.3828726  -0.4987739   0.03028297  0.7028036   0.6255909 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.3828726  -0.4987739   0.03028297  0.7028036   0.6255909 ]
  [Layer 5] Output shape after mixer: (1, 1, 1024)
  [Layer 5] Output sample values after mixer: [-0.3828726  -0.4987739   0.03028297  0.7028036   0.6255909 ]
  [Layer 5] Residual connection shape: (1, 1, 1024)
  [Layer 5] Residual connection sample values: [-1.4444778   0.16533688  0.08147794  0.32077295 -0.18611652]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.8657452   0.08186343  0.03806488  0.18431348 -0.09965802]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.8657452   0.08186343  0.03806488  0.18431348 -0.09965802]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.8657452   0.08186343  0.03806488  0.18431348 -0.09965802]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.01764672 -0.8117258  -0.7900104   0.03526436 -2.7396076 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.01764672 -0.8117258  -0.7900104   0.03526436 -2.7396076 ]
  [FlaxMamba2] xBC (step) sample values: [0.06041868 2.1113107  0.9273492  0.6946867  2.317068  ]
  [FlaxMamba2] dt (step) sample values: [-0.50565684 -1.8012002  -0.44859517  0.25684986  0.07229324]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.3887714   0.9053893   1.1230701   0.06041868 -0.5115603 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.25126982 -0.1687638   0.10282633  0.11542578  0.29362115]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.29851103 -0.15477149  0.18406412  0.10374518  0.43180475]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.12714228 -0.07140911  0.10047814  0.05456094  0.2618052 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.12714228 -0.07140911  0.10047814  0.05456094  0.2618052 ]
  [FlaxMamba2] B (step) sample values: [ 0.06511302  0.16836296 -0.26208425 -0.02180032 -0.12618706]
  [FlaxMamba2] C (step) sample values: [-0.24816348  0.03909437 -0.27530083  0.01055354 -0.12144814]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.5109995  -0.28622514 -0.5421001  -0.39544863 -0.5985869 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.09294643 0.0201402  0.0523658  0.1759286  0.10189869]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9536147  0.99425197 0.9720116  0.93279415 0.9408277 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.12714228 -0.07140911  0.10047814  0.05456094  0.2618052 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00076947 -0.00198962  0.00309716  0.00025762  0.00149121]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00076947 -0.00198962  0.00309716  0.00025762  0.00149121]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00799312 -0.00741254  0.01792613  0.00670654  0.00898688]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.03828225 -0.03969526 -0.05023732  0.00080654  0.14290659]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.1841208  -0.12160508  0.06501613  0.06339067  0.44321024]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.1841208  -0.12160508  0.06501613  0.06339067  0.44321024]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0016389   0.03035558 -0.01603394  0.00113742 -0.07367447]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00102991  0.01825494 -0.00916801  0.00079986 -0.03770493]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00102991  0.01825494 -0.00916801  0.00079986 -0.03770493]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.57174337 -0.54030955  0.2897298  -0.5085385  -0.7030918 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.57174337 -0.54030955  0.2897298  -0.5085385  -0.7030918 ]
  [Layer 6] Output shape after mixer: (1, 1, 1024)
  [Layer 6] Output sample values after mixer: [-0.57174337 -0.54030955  0.2897298  -0.5085385  -0.7030918 ]
  [Layer 6] Residual connection shape: (1, 1, 1024)
  [Layer 6] Residual connection sample values: [-2.016221   -0.37497267  0.37120774 -0.18776554 -0.8892083 ]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-1.0675815  -0.16126087  0.1550278  -0.10035469 -0.40830743]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-1.0675815  -0.16126087  0.1550278  -0.10035469 -0.40830743]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-1.0675815  -0.16126087  0.1550278  -0.10035469 -0.40830743]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.56858647 -0.5106108  -1.6984082   1.8248073  -0.28903952]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.56858647 -0.5106108  -1.6984082   1.8248073  -0.28903952]
  [FlaxMamba2] xBC (step) sample values: [ 0.35408875 -1.305054    1.0447016   0.8244382  -2.0430067 ]
  [FlaxMamba2] dt (step) sample values: [-1.0488782   1.5259067  -0.40455875 -0.16746613 -0.55416614]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-3.0653458  -2.6795866  -1.3473907   0.35408875 -2.156381  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03490911 -0.27495283  0.00731415  0.09817762 -0.04466986]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.06853948 -0.3462419  -0.1236673   0.10664625 -0.04741453]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.03309578 -0.14344595 -0.05801511  0.05616379 -0.02314534]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03309578 -0.14344595 -0.05801511  0.05616379 -0.02314534]
  [FlaxMamba2] B (step) sample values: [-0.02823993 -0.08168944  0.16052574  0.02335171 -0.15514962]
  [FlaxMamba2] C (step) sample values: [ 0.0113598   0.0146346  -0.13611759 -0.07785115  0.29447347]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-6.5957151e-02 -4.5478220e+00 -5.8281250e+00 -4.2033669e-01
 -1.9005252e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.20382206 0.14404826 0.02438828 0.11907688 0.11561906]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9866464  0.51938707 0.8675016  0.9511796  0.9997803 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03309578 -0.14344595 -0.05801511  0.05616379 -0.02314534]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0001905   0.00055105 -0.00108285 -0.00015752  0.00104659]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0001905   0.00055105 -0.00108285 -0.00015752  0.00104659]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.09966557  0.0107962  -0.03476327  0.00389485  0.08884531]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.20829014 -0.11353355 -0.174842    0.03561382  0.02332212]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.2850245  -0.4461207  -0.30935314  0.16583258 -0.03034158]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.2850245  -0.4461207  -0.30935314  0.16583258 -0.03034158]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [0.05859529 0.08543424 0.08126657 0.26059234 0.00375562]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.03265711 0.05746545 0.03277507 0.12730485 0.00401512]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.03265711 0.05746545 0.03277507 0.12730485 0.00401512]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.8415868  -0.92823994 -0.25153053 -0.29959404  0.34679273]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.8415868  -0.92823994 -0.25153053 -0.29959404  0.34679273]
  [Layer 7] Output shape after mixer: (1, 1, 1024)
  [Layer 7] Output sample values after mixer: [-0.8415868  -0.92823994 -0.25153053 -0.29959404  0.34679273]
  [Layer 7] Residual connection shape: (1, 1, 1024)
  [Layer 7] Residual connection sample values: [-2.8578079  -1.3032126   0.11967722 -0.48735958 -0.5424156 ]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-1.7354946  -0.59245086  0.05084103 -0.28825167 -0.2760422 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-1.7354946  -0.59245086  0.05084103 -0.28825167 -0.2760422 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-1.7354946  -0.59245086  0.05084103 -0.28825167 -0.2760422 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.7290646 -2.7486901 -1.5138752 -2.038752  -3.6228497]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.7290646 -2.7486901 -1.5138752 -2.038752  -3.6228497]
  [FlaxMamba2] xBC (step) sample values: [ 1.9844451   1.816307   -1.4132125  -0.2506142   0.36562324]
  [FlaxMamba2] dt (step) sample values: [ 1.0516263  -2.0669975  -0.8539389  -0.05022764 -1.2031363 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-3.2332613 -0.8657562 -2.0932546  1.9844451  0.5373835]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.15611282 -0.33397415  0.31750607 -0.02022836 -0.00939282]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.07872024 -0.25291947  0.3838513  -0.11715218 -0.07195386]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.04090854 -0.11055238  0.22831538 -0.05514885 -0.03468315]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04090854 -0.11055238  0.22831538 -0.05514885 -0.03468315]
  [FlaxMamba2] B (step) sample values: [ 0.04427827  0.43390658 -0.02602743 -0.1667859  -0.01160417]
  [FlaxMamba2] C (step) sample values: [ 0.06302332  0.05396299 -0.1947847  -0.03656485  0.20051815]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6851114  -0.13800453 -0.41180432 -0.26783535 -0.12443344]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05297842 0.38699466 0.15156607 0.37989482 0.6422599 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9643547 0.9479941 0.9394924 0.903256  0.9231915]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04090854 -0.11055238  0.22831538 -0.05514885 -0.03468315]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.5962954e-05  9.4039267e-04 -5.6408466e-05 -3.6147004e-04
 -2.5149364e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.5962954e-05  9.4039267e-04 -5.6408466e-05 -3.6147004e-04
 -2.5149364e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00446445 -0.02432703  0.00062861 -0.02984306  0.00831916]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0882671  -0.00928182  0.04581905 -0.03884892 -0.02085278]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.06581137 -0.42566776  0.9057492  -0.24656232 -0.15148383]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.06581137 -0.42566776  0.9057492  -0.24656232 -0.15148383]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.09664281  0.07038973 -0.24731521  0.05790559  0.01427535]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02844885  0.0109369  -0.11835004  0.02359957  0.00398966]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02844885  0.0109369  -0.11835004  0.02359957  0.00398966]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.33148792 -0.7763177  -0.40528604 -0.4161053   0.9254056 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.33148792 -0.7763177  -0.40528604 -0.4161053   0.9254056 ]
  [Layer 8] Output shape after mixer: (1, 1, 1024)
  [Layer 8] Output sample values after mixer: [-0.33148792 -0.7763177  -0.40528604 -0.4161053   0.9254056 ]
  [Layer 8] Residual connection shape: (1, 1, 1024)
  [Layer 8] Residual connection sample values: [-3.1892958  -2.0795302  -0.28560883 -0.9034649   0.38299   ]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-1.6986382  -0.85595673 -0.11255365 -0.48246792  0.17767291]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-1.6986382  -0.85595673 -0.11255365 -0.48246792  0.17767291]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-1.6986382  -0.85595673 -0.11255365 -0.48246792  0.17767291]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.4034983 -3.5910249 -3.5294766 -1.2366661 -2.2713377]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.4034983 -3.5910249 -3.5294766 -1.2366661 -2.2713377]
  [FlaxMamba2] xBC (step) sample values: [ 3.729537   -0.99142414 -1.4891667   0.50008506 -0.72010547]
  [FlaxMamba2] dt (step) sample values: [-0.92499536 -0.6423263   0.41479293  0.9968344  -0.45806825]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 2.8222654  1.138623   2.100877   3.729537  -3.0781999]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-1.2696893  -0.2629999  -0.7049265  -0.09488314 -0.06216849]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-1.5231073  -0.17248476 -0.70909214 -0.08815783 -0.08082999]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.27264294 -0.07882302 -0.23385821 -0.04213722 -0.03878251]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.27264294 -0.07882302 -0.23385821 -0.04213722 -0.03878251]
  [FlaxMamba2] B (step) sample values: [-0.06614003 -0.03487552  0.22116825 -0.08833071  0.25704384]
  [FlaxMamba2] C (step) sample values: [ 0.2354094  -0.27557498  0.03018236 -0.20479214 -0.02658454]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17008033 -0.11351943 -0.10539922 -0.5864362  -0.14965628]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.47106302 0.7781472  2.3076754  0.4776855  0.5694201 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9230069 0.9154543 0.7840934 0.7556839 0.9183127]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.27264294 -0.07882302 -0.23385821 -0.04213722 -0.03878251]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0084945   0.00447913 -0.02840508  0.01134449 -0.03301265]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0084945   0.00447913 -0.02840508  0.01134449 -0.03301265]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.02521769 -0.003411   -0.31458893  0.32399973  0.00102825]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.7179288   0.01537914 -0.4031669  -0.07601433  0.15845215]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-1.448467   -0.19582465 -1.0297827  -0.1889197   0.05453562]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-1.448467   -0.19582465 -1.0297827  -0.1889197   0.05453562]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.23405752  0.0188674   0.10353165  0.05257081 -0.0115848 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04510125  0.0067764   0.02486435  0.01448286 -0.00320408]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04510125  0.0067764   0.02486435  0.01448286 -0.00320408]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.0545983  -0.40868583  2.4186912   1.6658735   1.6865833 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.0545983  -0.40868583  2.4186912   1.6658735   1.6865833 ]
  [Layer 9] Output shape after mixer: (1, 1, 1024)
  [Layer 9] Output sample values after mixer: [ 3.0545983  -0.40868583  2.4186912   1.6658735   1.6865833 ]
  [Layer 9] Residual connection shape: (1, 1, 1024)
  [Layer 9] Residual connection sample values: [-0.13469744 -2.4882162   2.1330824   0.7624086   2.0695734 ]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.05239608 -0.7394496   0.6187198   0.29172748  0.68155986]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05239608 -0.7394496   0.6187198   0.29172748  0.68155986]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05239608 -0.7394496   0.6187198   0.29172748  0.68155986]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-3.1731386  -1.9991857  -1.1165988  -1.9803913  -0.03671781]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-3.1731386  -1.9991857  -1.1165988  -1.9803913  -0.03671781]
  [FlaxMamba2] xBC (step) sample values: [ 0.16141228 -1.8032408  -1.8598661   1.0349923   5.3949776 ]
  [FlaxMamba2] dt (step) sample values: [-1.9984945 -0.6843646 -0.6799648 -3.0030932 -0.9941708]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.8984489  -2.820525   -2.0003026   0.16141228 -0.8320072 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.6837706  -0.11130396  0.32596248  0.28476852 -1.113335  ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.8540587  -0.135245    0.28799862  0.8887724  -1.0644459 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.25500667 -0.06305665  0.16459297  0.62981683 -0.2729886 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.25500667 -0.06305665  0.16459297  0.62981683 -0.2729886 ]
  [FlaxMamba2] B (step) sample values: [-0.05246627  0.20668155  0.05267978 -0.10364244 -0.03384346]
  [FlaxMamba2] C (step) sample values: [ 0.59966904 -0.17511605 -0.1800806  -0.2697096   0.15323132]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.08535489 -0.07711172 -0.08452541 -0.0546804  -0.06966463]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.33558688 0.04763376 0.04693494 0.13893417 0.24776645]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.97176236 0.9963336  0.99604064 0.9924318  0.98288757]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.25500667 -0.06305665  0.16459297  0.62981683 -0.2729886 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0044899  -0.01768716 -0.00450817  0.0088694   0.00289622]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0044899  -0.01768716 -0.00450817  0.0088694   0.00289622]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.08790696 -1.0221021  -0.03002533  0.4921608  -0.10936271]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-2.7959044  -0.8046697  -1.4140931  14.2899885  -0.39818314]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-4.037568  -1.1117015 -0.6126664 17.356657  -1.7274035]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-4.037568  -1.1117015 -0.6126664 17.356657  -1.7274035]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.5148942   0.2651183   0.1687289  -4.168656    0.03113108]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0226687   0.02495153  0.01741433 -0.33091053  0.00299573]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0226687   0.02495153  0.01741433 -0.33091053  0.00299573]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.45468625 -0.26454562  0.04844636 -0.9493967   0.45903394]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.45468625 -0.26454562  0.04844636 -0.9493967   0.45903394]
  [Layer 10] Output shape after mixer: (1, 1, 1024)
  [Layer 10] Output sample values after mixer: [ 0.45468625 -0.26454562  0.04844636 -0.9493967   0.45903394]
  [Layer 10] Residual connection shape: (1, 1, 1024)
  [Layer 10] Residual connection sample values: [ 0.31998882 -2.7527618   2.1815288  -0.18698812  2.5286074 ]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.08413048 -0.5872193   0.4514029  -0.05368302  0.5883984 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.08413048 -0.5872193   0.4514029  -0.05368302  0.5883984 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.08413048 -0.5872193   0.4514029  -0.05368302  0.5883984 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.2858105  -0.44207835 -2.6171882   0.9364931  -1.9160534 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.2858105  -0.44207835 -2.6171882   0.9364931  -1.9160534 ]
  [FlaxMamba2] xBC (step) sample values: [-1.5224556   0.94138616  0.2616797   0.6698758  -1.5000657 ]
  [FlaxMamba2] dt (step) sample values: [-1.8407148 -1.2499287 -1.7452575 -0.827294  -0.7382695]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.13014178 -0.44022954 -1.1525992  -1.5224556  -0.9643714 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.45163393 -0.1476102  -0.10739563 -0.1000054  -0.34004894]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.5981183   0.04355191 -0.08346985  0.00741648 -0.2250587 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.3859213   0.02225007 -0.03999414  0.00372199 -0.09991968]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.3859213   0.02225007 -0.03999414  0.00372199 -0.09991968]
  [FlaxMamba2] B (step) sample values: [-0.24869965  0.11105555 -0.01552706  0.24985945 -0.11736427]
  [FlaxMamba2] C (step) sample values: [-0.2734638   0.01002205 -0.08875594  0.03640529 -0.27840906]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.25934154 -0.12614636 -0.10356269 -0.23775288 -0.43051487]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03578099 0.02070282 0.02815821 0.2976432  0.40856132]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9907634  0.9973918  0.99708813 0.9316803  0.83870876]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.3859213   0.02225007 -0.03999414  0.00372199 -0.09991968]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00343421  0.00153353 -0.00021441  0.00345022 -0.00162064]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00343421  0.00153353 -0.00021441  0.00345022 -0.00162064]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.18793094  0.012177    0.01863695 -0.08192597  0.11042111]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [0.44425598 0.4307305  0.46312824 0.23916414 0.67938155]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.7729955   0.36055055  0.5892755   0.22742444  0.9945426 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.7729955   0.36055055  0.5892755   0.22742444  0.9945426 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.7786784  -0.0623613  -0.10493492  0.15300387 -0.24449246]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.06373446 -0.03779342 -0.11408797  0.03126902 -0.05832188]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.06373446 -0.03779342 -0.11408797  0.03126902 -0.05832188]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.9390573   0.80079967 -1.3873581  -0.438858   -0.0103348 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.9390573   0.80079967 -1.3873581  -0.438858   -0.0103348 ]
  [Layer 11] Output shape after mixer: (1, 1, 1024)
  [Layer 11] Output sample values after mixer: [-0.9390573   0.80079967 -1.3873581  -0.438858   -0.0103348 ]
  [Layer 11] Residual connection shape: (1, 1, 1024)
  [Layer 11] Residual connection sample values: [-0.6190685  -1.9519622   0.79417074 -0.62584615  2.5182726 ]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.13459152 -0.33807832  0.12578045 -0.15430377  0.46326667]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.13459152 -0.33807832  0.12578045 -0.15430377  0.46326667]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.13459152 -0.33807832  0.12578045 -0.15430377  0.46326667]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.2512059  -1.4870524   0.62108964 -0.53673476 -1.4056776 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.2512059  -1.4870524   0.62108964 -0.53673476 -1.4056776 ]
  [FlaxMamba2] xBC (step) sample values: [-2.45501    3.5917914 -0.5252804  2.321114   1.4815826]
  [FlaxMamba2] dt (step) sample values: [-2.2731066 -2.2531652 -2.9209864 -3.810077  -1.303825 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.627188    0.5587608  -0.75309384 -2.45501     0.5299009 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.09191036  0.6171515   0.2340168   0.5149274   0.16717541]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.15911007 -0.21732116  0.1692585   0.47070742  0.00054944]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-7.3239349e-02 -9.6899711e-02  9.1774315e-02  2.8974450e-01
  2.7479330e-04]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-7.3239349e-02 -9.6899711e-02  9.1774315e-02  2.8974450e-01
  2.7479330e-04]
  [FlaxMamba2] B (step) sample values: [ 0.12440526 -0.27738118  0.05749453  0.64639145 -0.11421438]
  [FlaxMamba2] C (step) sample values: [ 0.35917372 -0.16359827  0.28381413 -0.25767028  0.44431072]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.16087165 -0.14748003 -0.27125728 -0.11553253 -0.09015273]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.16020085 0.07835505 0.10766611 0.08095099 0.01943824]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.97455746 0.9885107  0.97121716 0.9906911  0.9982491 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-7.3239349e-02 -9.6899711e-02  9.1774315e-02  2.8974450e-01
  2.7479330e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00145965  0.00325451 -0.00067458 -0.00758411  0.00134008]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00145965  0.00325451 -0.00067458 -0.00758411  0.00134008]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.03176221  0.0048253   0.0623931  -0.13596123 -0.03448487]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.27770257 -1.6950262   0.11875929  0.02909304  3.878011  ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.39655986 -1.852281    0.26769626  0.4993081   3.8784568 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.39655986 -1.852281    0.26769626  0.4993081   3.8784568 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.3857827   0.5078209   0.10814873 -0.09887645 -1.0735623 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.08507921  0.06543741  0.0272887  -0.04709172 -0.20369874]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.08507921  0.06543741  0.0272887  -0.04709172 -0.20369874]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.82502854 -0.00969634 -0.27370682  0.7486159   0.6901292 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.82502854 -0.00969634 -0.27370682  0.7486159   0.6901292 ]
  [Layer 12] Output shape after mixer: (1, 1, 1024)
  [Layer 12] Output sample values after mixer: [ 0.82502854 -0.00969634 -0.27370682  0.7486159   0.6901292 ]
  [Layer 12] Residual connection shape: (1, 1, 1024)
  [Layer 12] Residual connection sample values: [ 0.20596004 -1.9616586   0.52046394  0.12276977  3.208402  ]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.03561189 -0.276985    0.06995293  0.0228385   0.49762523]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.03561189 -0.276985    0.06995293  0.0228385   0.49762523]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.03561189 -0.276985    0.06995293  0.0228385   0.49762523]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.1972737  -1.7761996  -0.73748136  0.17454454 -0.90491277]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.1972737  -1.7761996  -0.73748136  0.17454454 -0.90491277]
  [FlaxMamba2] xBC (step) sample values: [-0.96905917  0.7766244  -0.20689854  0.3977148  -2.0526702 ]
  [FlaxMamba2] dt (step) sample values: [-0.964134   -1.7810779  -0.33929637 -1.4591613  -0.46174705]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.25376448  0.12189782  0.5624532  -0.96905917 -0.03297378]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.22967516 -0.2347923  -0.16500089  0.00285624 -0.45244515]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.29174793 -0.2534538  -0.15711972 -0.00885488 -0.48288643]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.12474441 -0.1107526  -0.07240088 -0.00440784 -0.18425535]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.12474441 -0.1107526  -0.07240088 -0.00440784 -0.18425535]
  [FlaxMamba2] B (step) sample values: [ 0.2042381  -0.16452055  0.03200603  0.13142031 -0.04889974]
  [FlaxMamba2] C (step) sample values: [ 0.47808862 -0.14068973  0.23586696  0.04690867 -0.26769197]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.02338035 -1.090337   -0.5085105  -0.67845345 -0.02513249]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02035859 0.00169583 0.00607209 0.00122371 0.0987429 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9995241  0.9981527  0.99691707 0.9991701  0.9975214 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.12474441 -0.1107526  -0.07240088 -0.00440784 -0.18425535]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.1868719e-04  4.1781968e-04 -8.1283149e-05 -3.3375766e-04
  1.2418677e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.1868719e-04  4.1781968e-04 -8.1283149e-05 -3.3375766e-04
  1.2418677e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.09311978  0.10242986 -0.28294727  0.02288472 -0.05842136]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.147943   -0.0389096  -0.00336509 -0.00173818  0.30910543]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.13353461 -0.02611731  0.00499745 -0.00122906  0.33038753]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.13353461 -0.02611731  0.00499745 -0.00122906  0.33038753]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01446643  0.00671596 -0.00119247 -0.0001166  -0.08611645]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00830184  0.00255    -0.0015339  -0.00035418 -0.05678202]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00830184  0.00255    -0.0015339  -0.00035418 -0.05678202]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.13178082  0.04255731  0.06752624  0.9829672   0.18112275]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.13178082  0.04255731  0.06752624  0.9829672   0.18112275]
  [Layer 13] Output shape after mixer: (1, 1, 1024)
  [Layer 13] Output sample values after mixer: [-0.13178082  0.04255731  0.06752624  0.9829672   0.18112275]
  [Layer 13] Residual connection shape: (1, 1, 1024)
  [Layer 13] Residual connection sample values: [ 0.07417922 -1.9191012   0.58799016  1.105737    3.3895247 ]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.01044619 -0.23331366  0.06991021  0.17619847  0.4471554 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.01044619 -0.23331366  0.06991021  0.17619847  0.4471554 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.01044619 -0.23331366  0.06991021  0.17619847  0.4471554 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.8806895  -2.0752945  -0.96007776 -0.3568085  -0.38097706]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.8806895  -2.0752945  -0.96007776 -0.3568085  -0.38097706]
  [FlaxMamba2] xBC (step) sample values: [-0.95331764 -0.77537024 -1.92116     0.5931767  -0.9463877 ]
  [FlaxMamba2] dt (step) sample values: [-0.2190195  -0.99104464 -0.14400709  1.9238402   0.7878902 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.38637185  0.00432411 -0.33581305 -0.95331764  0.43252176]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.20320311 -0.27562922 -0.83533186 -0.13451459  0.25941113]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.27363768 -0.32503718 -1.0271044  -0.182122    0.24563244]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.1554223  -0.1363364  -0.27079183 -0.08279175  0.13782465]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.1554223  -0.1363364  -0.27079183 -0.08279175  0.13782465]
  [FlaxMamba2] B (step) sample values: [-0.03758702 -0.02246732 -0.15898567  0.02782103 -0.10721011]
  [FlaxMamba2] C (step) sample values: [-0.06591473  0.01942474 -0.14366803  0.05103124 -0.16371964]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-7.2744994  -0.03854768 -2.202407   -0.01377147 -5.3377523 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01653463 0.02256376 0.01018738 0.3003655  0.03546289]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.88667107 0.9991306  0.97781307 0.9958721  0.82754475]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.1554223  -0.1363364  -0.27079183 -0.08279175  0.13782465]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.6593016e-05 -5.7737645e-05 -4.0856941e-04  7.1495895e-05
 -2.7551394e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.6593016e-05 -5.7737645e-05 -4.0856941e-04  7.1495895e-05
 -2.7551394e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.32184485e-04  1.14980685e-05 -6.36356301e-04  5.97187027e-04
 -8.81201006e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00738822 -0.00954322 -0.02408521  0.00014441  0.0074663 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.12970535 -0.11683977 -0.237198   -0.06501257  0.1159341 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.12970535 -0.11683977 -0.237198   -0.06501257  0.1159341 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.03347342  0.02704136  0.06304952  0.00955097 -0.0179275 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.14898442  0.0838606   0.13415012  0.02942575 -0.07020656]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.14898442  0.0838606   0.13415012  0.02942575 -0.07020656]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.12578641 -0.13506384  0.04488602  0.10300641  0.7703248 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.12578641 -0.13506384  0.04488602  0.10300641  0.7703248 ]
  [Layer 14] Output shape after mixer: (1, 1, 1024)
  [Layer 14] Output sample values after mixer: [-0.12578641 -0.13506384  0.04488602  0.10300641  0.7703248 ]
  [Layer 14] Residual connection shape: (1, 1, 1024)
  [Layer 14] Residual connection sample values: [-0.05160719 -2.0541651   0.63287616  1.2087433   4.1598496 ]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.00874643 -0.28639275  0.08858025  0.24283843  0.6580519 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.00874643 -0.28639275  0.08858025  0.24283843  0.6580519 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.00874643 -0.28639275  0.08858025  0.24283843  0.6580519 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-3.9481075   4.581143   -0.06992695 -0.8164154  -4.2304053 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-3.9481075   4.581143   -0.06992695 -0.8164154  -4.2304053 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.548849   -0.18793046  0.96606505  1.696335    1.9253582 ]
  [FlaxMamba2] dt (step) sample values: [ 0.8633429  -2.371594   -0.05161986 -4.2297716   0.01638244]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.19749758 -3.226898    0.95938224  1.548849    0.04048364]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.16358046 -0.0503841   0.25744987  0.34950143 -0.07768717]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.49976212 -0.07456928  1.5826452   0.7921284  -0.09117594]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.18870845 -0.03589514  1.3129289   0.54521257 -0.04351114]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.18870845 -0.03589514  1.3129289   0.54521257 -0.04351114]
  [FlaxMamba2] B (step) sample values: [-0.08999557 -0.05996422 -0.02696388 -0.08151387 -0.09103075]
  [FlaxMamba2] C (step) sample values: [-0.05348607 -0.05412575 -0.10427188 -0.03865112 -0.11202094]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.4414158  -0.05923919 -0.7389757  -0.00508607 -0.00871955]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.14139019 0.05218421 0.02080448 0.0007216  0.14161086]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7080842  0.99691343 0.9847436  0.9999963  0.998766  ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.18870845 -0.03589514  1.3129289   0.54521257 -0.04351114]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00240122 0.00159994 0.00071944 0.00217491 0.00242884]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00240122 0.00159994 0.00071944 0.00217491 0.00242884]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00394353  0.00672153 -0.00080801  0.00481867  0.0082357 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01111306  0.00263516  0.07348721  0.02154213  0.00195467]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.3481089  -0.06146644  2.4181178   0.9951836  -0.07574759]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.3481089  -0.06146644  2.4181178   0.9951836  -0.07574759]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02601145 -0.27873147 -0.081591   -0.24904652  0.00459449]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03706304 -0.2898791  -0.02493972 -0.2000205   0.0066797 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03706304 -0.2898791  -0.02493972 -0.2000205   0.0066797 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.19610491 -0.16994804  0.48720428 -0.37097707  0.70055324]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.19610491 -0.16994804  0.48720428 -0.37097707  0.70055324]
  [Layer 15] Output shape after mixer: (1, 1, 1024)
  [Layer 15] Output sample values after mixer: [ 0.19610491 -0.16994804  0.48720428 -0.37097707  0.70055324]
  [Layer 15] Residual connection shape: (1, 1, 1024)
  [Layer 15] Residual connection sample values: [ 0.14449772 -2.2241132   1.1200805   0.8377663   4.860403  ]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.01755465 -0.22329275  0.10479815  0.12913539  0.5582234 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.01755465 -0.22329275  0.10479815  0.12913539  0.5582234 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.01755465 -0.22329275  0.10479815  0.12913539  0.5582234 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.49112365 -0.18427914 -5.415351    1.479734    0.4055362 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.49112365 -0.18427914 -5.415351    1.479734    0.4055362 ]
  [FlaxMamba2] xBC (step) sample values: [ 2.1004107   0.07986379 -0.75693935 -2.2377737   0.28828812]
  [FlaxMamba2] dt (step) sample values: [2.403662   0.7706065  1.2988213  1.070808   0.48462301]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.13573612  0.8545147   1.4790857   2.1004107   0.22628108]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.14951783 -0.01556967 -0.29364955  0.15163693  0.08706942]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.14769441 -0.00676535 -0.1569308   0.11345944  0.09459963]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.07929072 -0.00337123 -0.07232118  0.05994453  0.04953542]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.07929072 -0.00337123 -0.07232118  0.05994453  0.04953542]
  [FlaxMamba2] B (step) sample values: [ 0.02956675 -0.0815407  -0.10434261 -0.01339401 -0.02687451]
  [FlaxMamba2] C (step) sample values: [ 0.09577572 -0.08724447  0.029411   -0.26880485 -0.20970698]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.1348554e-03 -3.0370306e-03 -2.7156286e+00 -4.1511287e-03
 -4.2925543e-01]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.6536048  0.137958   0.08392679 0.07687814 0.0018265 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9992585  0.9995811  0.79619277 0.99968094 0.99921626]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.07929072 -0.00337123 -0.07232118  0.05994453  0.04953542]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00153229 -0.00422583 -0.00540753 -0.00069414 -0.00139277]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00153229 -0.00422583 -0.00540753 -0.00069414 -0.00139277]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.03337206  0.09449531  0.03161981  0.00165407 -0.00242   ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.03920873  0.05648682 -0.19733067  0.10243159  0.07620839]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02075493  0.05727143 -0.18049893  0.08848034  0.06467971]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02075493  0.05727143 -0.18049893  0.08848034  0.06467971]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00386965 -0.00479212  0.00432829  0.10664457  0.01573843]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00505896 -0.00356677  0.01296809  0.05562101  0.02435614]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00505896 -0.00356677  0.01296809  0.05562101  0.02435614]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.92614615  0.10525139  0.15087518 -0.33710825 -0.3516924 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.92614615  0.10525139  0.15087518 -0.33710825 -0.3516924 ]
  [Layer 16] Output shape after mixer: (1, 1, 1024)
  [Layer 16] Output sample values after mixer: [-0.92614615  0.10525139  0.15087518 -0.33710825 -0.3516924 ]
  [Layer 16] Residual connection shape: (1, 1, 1024)
  [Layer 16] Residual connection sample values: [-0.7816484  -2.118862    1.2709557   0.50065804  4.508711  ]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.14001477 -0.3265802   0.19572778  0.10278049  0.7439813 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.14001477 -0.3265802   0.19572778  0.10278049  0.7439813 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.14001477 -0.3265802   0.19572778  0.10278049  0.7439813 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-4.914759   -0.9500201  -0.05382058 -0.7533746  -1.8357483 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-4.914759   -0.9500201  -0.05382058 -0.7533746  -1.8357483 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.33920607  0.20555189  0.31054446 -0.15663624  0.58746773]
  [FlaxMamba2] dt (step) sample values: [-0.36033386  0.6252457  -0.9854031   0.41185078 -0.95281106]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.7254306   2.4675014   1.2512957   0.33920607 -1.4416928 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.23729223  0.21300608  0.03451776  0.00732834  0.14401428]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.33232397  0.23513132 -0.07992315  0.04175216  0.23922913]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.13880351  0.13132402 -0.0383655   0.02131183  0.13385436]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.13880351  0.13132402 -0.0383655   0.02131183  0.13385436]
  [FlaxMamba2] B (step) sample values: [-0.03924838  0.10186537 -0.27352825  0.01541963 -0.0441272 ]
  [FlaxMamba2] C (step) sample values: [-0.1928416  -0.14826103 -0.27055946 -0.14608282 -0.03055205]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.3863302  -0.87734115 -1.4026718  -0.6827737  -0.39046   ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.09918892 0.14988342 0.05056849 0.35795665 0.1353042 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.87152684 0.8767803  0.9315262  0.78317165 0.9485404 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.13880351  0.13132402 -0.0383655   0.02131183  0.13385436]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00054036 -0.00140246  0.00376587 -0.00021229  0.00060753]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00054036 -0.00140246  0.00376587 -0.00021229  0.00060753]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00707144  0.01152527 -0.0390925   0.00518962 -0.03500549]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.1196674   0.0948938  -0.08957362  0.08120877  0.04198075]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.24592142  0.44078267 -0.19062291  0.13734111  0.39453417]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.24592142  0.44078267 -0.19062291  0.13734111  0.39453417]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00880381 -0.11678199  0.00499171 -0.03311912 -0.09962627]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00598123 -0.08096787  0.00364071 -0.02973845 -0.08248173]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00598123 -0.08096787  0.00364071 -0.02973845 -0.08248173]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.0327636   0.6963607   1.2554493   0.13056505 -1.0067065 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.0327636   0.6963607   1.2554493   0.13056505 -1.0067065 ]
  [Layer 17] Output shape after mixer: (1, 1, 1024)
  [Layer 17] Output sample values after mixer: [-0.0327636   0.6963607   1.2554493   0.13056505 -1.0067065 ]
  [Layer 17] Residual connection shape: (1, 1, 1024)
  [Layer 17] Residual connection sample values: [-0.814412  -1.4225012  2.5264049  0.6312231  3.5020044]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.09706868 -0.14659475  0.25652564  0.09143019  0.36939302]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.09706868 -0.14659475  0.25652564  0.09143019  0.36939302]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.09706868 -0.14659475  0.25652564  0.09143019  0.36939302]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.16916126 -0.14999813 -1.4207662  -0.82168823 -1.0347266 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.16916126 -0.14999813 -1.4207662  -0.82168823 -1.0347266 ]
  [FlaxMamba2] xBC (step) sample values: [-0.22164887  1.0388703  -0.4085811   0.57234     0.33185217]
  [FlaxMamba2] dt (step) sample values: [ 2.3173378   4.8834767   4.134869   -0.01862784  2.7635372 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.15398827 -0.6895262  -0.5580068  -0.22164887 -1.262538  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06679554  0.49068862  0.100748    0.01834586 -0.29321086]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.07614917  0.0927394   0.11199372  0.04889395 -0.34545696]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.03952356  0.04851831  0.05912923  0.02504451 -0.14318657]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03952356  0.04851831  0.05912923  0.02504451 -0.14318657]
  [FlaxMamba2] B (step) sample values: [-0.06403637  0.05190344 -0.01986326 -0.0460154   0.04705834]
  [FlaxMamba2] C (step) sample values: [-0.00720324 -0.02841262  0.07815299 -0.1407179   0.01511584]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.3194940e-03 -6.5335674e+00 -1.4897179e+01 -1.3796333e-03
 -2.0873186e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.88714164 5.9972935  5.5849195  0.10781724 1.2027625 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.979444e-01 9.610075e-18 7.360363e-37 9.998513e-01 9.974926e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03952356  0.04851831  0.05912923  0.02504451 -0.14318657]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00224531  0.00181989 -0.00069647 -0.00161344  0.00165001]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00224531  0.00181989 -0.00069647 -0.00161344  0.00165001]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0037021  -0.00588858  0.09223495 -0.04124266  0.01405858]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.2564507  -1.4010086   0.13275257 -0.17657341 -0.32365546]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.25957975 -1.4048498   0.12807137 -0.17855616 -0.31231952]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.25957975 -1.4048498   0.12807137 -0.17855616 -0.31231952]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02010283  0.09747511 -0.03539867  0.04480832  0.08472385]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02987974  0.03547477 -0.01160188  0.03419675  0.03038544]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02987974  0.03547477 -0.01160188  0.03419675  0.03038544]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.16358998  0.4725687   0.52265525 -0.44300076  0.10579517]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.16358998  0.4725687   0.52265525 -0.44300076  0.10579517]
  [Layer 18] Output shape after mixer: (1, 1, 1024)
  [Layer 18] Output sample values after mixer: [ 0.16358998  0.4725687   0.52265525 -0.44300076  0.10579517]
  [Layer 18] Residual connection shape: (1, 1, 1024)
  [Layer 18] Residual connection sample values: [-0.65082204 -0.9499325   3.04906     0.18822232  3.6077995 ]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.0953517  -0.11557961  0.37500787  0.03410347  0.4692694 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0953517  -0.11557961  0.37500787  0.03410347  0.4692694 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0953517  -0.11557961  0.37500787  0.03410347  0.4692694 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.67583156 -1.5815517  -1.5125457  -0.8465285  -1.3843354 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.67583156 -1.5815517  -1.5125457  -0.8465285  -1.3843354 ]
  [FlaxMamba2] xBC (step) sample values: [-0.58679503  0.8875692  -1.4625561   1.9379787   0.42232695]
  [FlaxMamba2] dt (step) sample values: [-1.1211405  -0.29189935  0.04393294 -1.728199   -1.5417674 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.2168745   1.531876   -1.0118886  -0.58679503 -0.12161038]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.20488799  0.24363872 -0.36104542 -0.7672821   0.08000028]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.2563101   0.24413988 -0.37483937 -0.97492373  0.07880819]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.11182066  0.13689743 -0.15269913 -0.2670318   0.04095597]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.11182066  0.13689743 -0.15269913 -0.2670318   0.04095597]
  [FlaxMamba2] B (step) sample values: [-0.01835494  0.14027996  1.225855   -0.17542166  0.42370522]
  [FlaxMamba2] C (step) sample values: [-0.08099052 -0.00823135 -0.05761373 -0.14703296  0.11057168]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17394373 -1.5063176  -1.5724528  -0.19826236 -0.07681109]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.6144552  0.21843474 0.32908309 0.445759   0.09012961]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.89863294 0.7196199  0.59602803 0.91541547 0.99310094]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.11182066  0.13689743 -0.15269913 -0.2670318   0.04095597]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00126115 -0.00963847 -0.08422702  0.01205301 -0.02911227]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00126115 -0.00963847 -0.08422702  0.01205301 -0.02911227]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01415389  0.0263536  -0.1178131   0.03545015  0.019397  ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.39075163  0.10302019  0.0006704  -0.20301881  0.38307443]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.56101876  0.31147122 -0.23184155 -0.60962284  0.44543728]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.56101876  0.31147122 -0.23184155 -0.60962284  0.44543728]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.12784788 -0.08402699  0.06331778  0.15490232 -0.12352031]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04933558 -0.05605933  0.05029903  0.05067178 -0.14949848]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04933558 -0.05605933  0.05029903  0.05067178 -0.14949848]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.32564345 -0.36556968  1.6028961  -0.2539107   0.6463517 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.32564345 -0.36556968  1.6028961  -0.2539107   0.6463517 ]
  [Layer 19] Output shape after mixer: (1, 1, 1024)
  [Layer 19] Output sample values after mixer: [-0.32564345 -0.36556968  1.6028961  -0.2539107   0.6463517 ]
  [Layer 19] Residual connection shape: (1, 1, 1024)
  [Layer 19] Residual connection sample values: [-0.97646546 -1.3155022   4.651956   -0.06568837  4.2541513 ]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.0824415  -0.10165723  0.35974622 -0.00678656  0.35085192]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0824415  -0.10165723  0.35974622 -0.00678656  0.35085192]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0824415  -0.10165723  0.35974622 -0.00678656  0.35085192]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.3661316  -0.9036496   1.0132898  -0.9514728  -0.23155236]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.3661316  -0.9036496   1.0132898  -0.9514728  -0.23155236]
  [FlaxMamba2] xBC (step) sample values: [ 0.3090722  -1.4873462  -1.208936   -0.11886768 -0.622492  ]
  [FlaxMamba2] dt (step) sample values: [-1.1482316   0.43895176  0.9059988   1.1213844   0.11984208]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.2463926   0.02312712 -0.19641498  0.3090722  -0.38905513]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06563476  0.43627855 -0.42723462  0.01662372 -0.09461594]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.05113128  0.39810106 -0.6068001  -0.00441815 -0.14112473]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.0262191   0.23815653 -0.21407269 -0.0022042  -0.06559156]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0262191   0.23815653 -0.21407269 -0.0022042  -0.06559156]
  [FlaxMamba2] B (step) sample values: [-0.01718907 -0.05549359  0.05818789 -0.0253105  -0.04260314]
  [FlaxMamba2] C (step) sample values: [-0.10195918 -0.0419021  -0.12239107 -0.27423277 -0.18188074]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-3.08577806e-01 -2.93056536e+00 -5.29621363e+00 -1.23260975e+01
 -8.15932546e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00225485 0.04042599 0.14109172 0.21770813 0.04743011]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9993045  0.8882776  0.47366646 0.06832419 0.9996131 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0262191   0.23815653 -0.21407269 -0.0022042  -0.06559156]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0162205e-06 -3.2807891e-06  3.4400766e-06 -1.4963606e-06
 -2.5187037e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0162205e-06 -3.2807891e-06  3.4400766e-06 -1.4963606e-06
 -2.5187037e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.2052649e-04 -2.4479814e-04 -1.9222367e-04  9.3848364e-05
 -4.8733440e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00040506  0.00057953 -0.00198958  0.00193821 -0.0011908 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 2.1969672e-02  1.9645789e-01 -1.7805952e-01  1.2531120e-04
 -5.5138372e-02]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 2.1969672e-02  1.9645789e-01 -1.7805952e-01  1.2531120e-04
 -5.5138372e-02]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-3.2937406e-03 -5.1181834e-02 -1.3237189e-01 -3.3216187e-05
  5.6479136e-03]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-4.1013002e-02 -5.4881895e-01 -9.7713262e-01 -4.0263223e-04
  4.4735901e-02]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-4.1013002e-02 -5.4881895e-01 -9.7713262e-01 -4.0263223e-04
  4.4735901e-02]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.3966677   0.76907676 -0.10831439 -1.3214962  -0.5823547 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.3966677   0.76907676 -0.10831439 -1.3214962  -0.5823547 ]
  [Layer 20] Output shape after mixer: (1, 1, 1024)
  [Layer 20] Output sample values after mixer: [ 1.3966677   0.76907676 -0.10831439 -1.3214962  -0.5823547 ]
  [Layer 20] Residual connection shape: (1, 1, 1024)
  [Layer 20] Residual connection sample values: [ 0.42020226 -0.5464254   4.5436416  -1.3871846   3.6717966 ]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.04764488 -0.0560604   0.47760248 -0.18600868  0.40023884]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.04764488 -0.0560604   0.47760248 -0.18600868  0.40023884]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.04764488 -0.0560604   0.47760248 -0.18600868  0.40023884]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.01318647 -1.0806767   0.43651038 -0.5838323  -0.49002483]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.01318647 -1.0806767   0.43651038 -0.5838323  -0.49002483]
  [FlaxMamba2] xBC (step) sample values: [-2.0421271   0.1544307   0.1788968   1.2067406  -0.26716107]
  [FlaxMamba2] dt (step) sample values: [-2.0973306  -0.77120167 -1.9047428  -1.8195636  -1.2612113 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5754699  -0.08208276 -0.42845628 -2.0421271   0.19803557]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.63244915  0.06768852  0.18021595 -0.3041383  -0.07908398]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.989871   -0.02978462  0.15455067 -0.40216076 -0.13306957]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.26819324 -0.01467055  0.08323495 -0.16118334 -0.06211443]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.26819324 -0.01467055  0.08323495 -0.16118334 -0.06211443]
  [FlaxMamba2] B (step) sample values: [ 0.408498   -0.10352835 -0.09652707 -0.09469122 -0.04099002]
  [FlaxMamba2] C (step) sample values: [ 0.10174614 -0.14757064 -0.02947744 -0.03285321 -0.16779101]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.32275575 -0.3764196  -0.15946394 -0.10539922 -0.37568513]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.12469369 0.30912614 0.16969557 0.08609735 0.19093804]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.96055347 0.8901537  0.97330254 0.99096644 0.93077976]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.26819324 -0.01467055  0.08323495 -0.16118334 -0.06211443]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01366099  0.0034622   0.00322806  0.00316666  0.00137079]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01366099  0.0034622   0.00322806  0.00316666  0.00137079]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00339006 0.1289438  0.03178972 0.06594728 0.01553886]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.43283775 -0.15128087 -0.10059377 -0.11782736  0.3997278 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.99966323 -0.18228701  0.07532301 -0.45848778  0.26844916]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.99966323 -0.18228701  0.07532301 -0.45848778  0.26844916]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00654756  0.04991376  0.01997177  0.09584315 -0.049973  ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00745688  0.07183042  0.03249652  0.10935857 -0.04917173]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00745688  0.07183042  0.03249652  0.10935857 -0.04917173]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.26107854 -1.1773725  -1.6047502   2.0877059   1.2000285 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.26107854 -1.1773725  -1.6047502   2.0877059   1.2000285 ]
  [Layer 21] Output shape after mixer: (1, 1, 1024)
  [Layer 21] Output sample values after mixer: [ 0.26107854 -1.1773725  -1.6047502   2.0877059   1.2000285 ]
  [Layer 21] Residual connection shape: (1, 1, 1024)
  [Layer 21] Residual connection sample values: [ 0.6812808  -1.7237978   2.9388914   0.70052123  4.871825  ]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.07557939 -0.17687726  0.30186474  0.09180364  0.52362496]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.07557939 -0.17687726  0.30186474  0.09180364  0.52362496]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.07557939 -0.17687726  0.30186474  0.09180364  0.52362496]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.90201896  0.450079    0.6050715  -4.948737    0.7991685 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.90201896  0.450079    0.6050715  -4.948737    0.7991685 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.25605208  1.3061261  -1.3554904  -1.8725389  -1.4498432 ]
  [FlaxMamba2] dt (step) sample values: [-1.8408271 -3.8004506 -1.5669919 -1.3165387 -1.0127227]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.32190228 -0.01145529 -0.34415787  0.25605208  1.2202941 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03330841  0.1320818  -0.12888092 -0.41118997 -0.05676385]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02512207  0.19659597 -0.11624664 -0.4295463  -0.0561535 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.01240326  0.10792948 -0.0547488  -0.16934206 -0.02728865]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01240326  0.10792948 -0.0547488  -0.16934206 -0.02728865]
  [FlaxMamba2] B (step) sample values: [-0.27255687  0.1546321   0.19630054 -0.09827304  0.08569177]
  [FlaxMamba2] C (step) sample values: [-0.27809072  0.587346    0.79437315 -0.27681163 -0.1214715 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.07090003 -0.07021102 -0.0699373  -0.08945116 -0.38969815]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.09854313 0.02540219 0.02524193 0.09931314 0.32268813]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99303764 0.99821806 0.9982362  0.9911557  0.8818344 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01240326  0.10792948 -0.0547488  -0.16934206 -0.02728865]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00033313 -0.000189   -0.00023993  0.00012011 -0.00010474]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00033313 -0.000189   -0.00023993  0.00012011 -0.00010474]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.0052057  0.02373571 0.00496444 0.0130577  0.04412675]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0078703   0.24024168 -0.26161826 -0.0574557   0.01286226]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01351296  0.05417098 -0.16723119  0.23449042  0.05990797]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01351296  0.05417098 -0.16723119  0.23449042  0.05990797]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00867078  0.01488859 -0.06544923 -0.00817224  0.03302509]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00895287  0.00665821 -0.06757852 -0.01253555  0.03253693]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00895287  0.00665821 -0.06757852 -0.01253555  0.03253693]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.0991099  0.5768735 -0.8378097 -2.9062293  4.034319 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.0991099  0.5768735 -0.8378097 -2.9062293  4.034319 ]
  [Layer 22] Output shape after mixer: (1, 1, 1024)
  [Layer 22] Output sample values after mixer: [-1.0991099  0.5768735 -0.8378097 -2.9062293  4.034319 ]
  [Layer 22] Residual connection shape: (1, 1, 1024)
  [Layer 22] Residual connection sample values: [-0.4178291 -1.1469243  2.1010818 -2.205708   8.906144 ]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.03367214 -0.08349888  0.16095522 -0.21851638  0.66791636]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.03367214 -0.08349888  0.16095522 -0.21851638  0.66791636]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.03367214 -0.08349888  0.16095522 -0.21851638  0.66791636]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.2123971   0.28710103 -1.591665    0.48779833 -1.7670064 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.2123971   0.28710103 -1.591665    0.48779833 -1.7670064 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.20315395 -0.04116982  0.9684981   0.3187042  -1.4771134 ]
  [FlaxMamba2] dt (step) sample values: [-1.300016  -0.8501014 -0.8745346 -1.3148377 -1.0587385]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.79555124 -1.548761    0.00251446  0.20315395  0.31863585]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.10631613  0.28091234 -0.01918858 -0.10576392  0.00342624]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.14000753  0.2733478  -0.06115025 -0.08942176 -0.00104077]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.06511123  0.15523821 -0.02964058 -0.04271315 -0.00052011]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06511123  0.15523821 -0.02964058 -0.04271315 -0.00052011]
  [FlaxMamba2] B (step) sample values: [0.70618844 0.16300267 0.05704419 0.83279705 0.03641842]
  [FlaxMamba2] C (step) sample values: [-0.08641452 -0.12322327  0.5096453   0.17994338 -0.07786274]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.12322418 -0.22553998 -0.24196908 -0.09559295 -0.2396176 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02012488 0.09749483 0.09227862 0.02053408 0.06422768]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9975232  0.97825104 0.97791886 0.998039   0.98472774]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06511123  0.15523821 -0.02964058 -0.04271315 -0.00052011]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.2535815e-04 -2.1359150e-04 -7.4748190e-05 -1.0912605e-03
 -4.7721092e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.2535815e-04 -2.1359150e-04 -7.4748190e-05 -1.0912605e-03
 -4.7721092e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.02567741  0.01228256 -0.00139674  0.07676831 -0.01150108]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.02783364  0.02223695  0.18364656 -0.02559631  0.03507211]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03087304  0.0149904   0.18503019 -0.02360245  0.03509639]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03087304  0.0149904   0.18503019 -0.02360245  0.03509639]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00858193  0.00245868 -0.04981564 -0.00713346 -0.009049  ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01927851  0.01674226 -0.557587   -0.08009937 -0.05657464]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01927851  0.01674226 -0.557587   -0.08009937 -0.05657464]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.1751179 -2.3109882  2.2873328  2.0696018 -2.9925199]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.1751179 -2.3109882  2.2873328  2.0696018 -2.9925199]
  [Layer 23] Output shape after mixer: (1, 1, 1024)
  [Layer 23] Output sample values after mixer: [ 1.1751179 -2.3109882  2.2873328  2.0696018 -2.9925199]
  [Layer 23] Residual connection shape: (1, 1, 1024)
  [Layer 23] Residual connection sample values: [ 0.75728875 -3.4579124   4.3884144  -0.13610625  5.9136243 ]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.07224474 -0.29283962  0.4038448  -0.01490167  0.51976085]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.07224474 -0.29283962  0.4038448  -0.01490167  0.51976085]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.07224474 -0.29283962  0.4038448  -0.01490167  0.51976085]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.3596925 -0.9659816 -0.7386085 -1.4427909 -1.2719886]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.3596925 -0.9659816 -0.7386085 -1.4427909 -1.2719886]
  [FlaxMamba2] xBC (step) sample values: [ 0.16669989 -1.808473   -0.6329377  -0.9614126   0.62063974]
  [FlaxMamba2] dt (step) sample values: [-1.2008971  -1.7053648  -0.22759598 -1.157968   -0.5833164 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.25741082  0.23978034 -0.4168057   0.16669989 -2.265154  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03280791 -0.2080648  -0.08548892 -0.25170216 -0.16755015]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.09414522 -0.11071372 -0.08765948 -0.33080372 -0.16069895]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.04928681 -0.05229561 -0.04190992 -0.13829087 -0.07390729]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04928681 -0.05229561 -0.04190992 -0.13829087 -0.07390729]
  [FlaxMamba2] B (step) sample values: [ 9.6780843e-01  1.0505830e-01 -3.9095039e-04  2.1996405e-02
 -5.6346759e-02]
  [FlaxMamba2] C (step) sample values: [-0.06764981 -0.08692748 -0.23938197 -0.14073853 -0.20343496]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6296152  -0.19671947 -0.14336194 -0.14017779 -0.22378482]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.30144882 0.18701783 0.4899274  0.51905435 0.28541034]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8271272  0.9638785  0.9321729  0.92982405 0.93812644]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04928681 -0.05229561 -0.04190992 -0.13829087 -0.07390729]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.4379166e-02  1.5608985e-03 -5.8085261e-06  3.2681049e-04
 -8.3716918e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.4379166e-02  1.5608985e-03 -5.8085261e-06  3.2681049e-04
 -8.3716918e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01219722  0.00254669 -0.00912197  0.01117762 -0.00375375]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.10758203 -0.07605596 -0.09910217 -0.24342896 -0.0335141 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.3489809  -0.33219147 -0.30437022 -0.92075545 -0.39550018]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.3489809  -0.33219147 -0.30437022 -0.92075545 -0.39550018]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.05159538  0.0884639   0.07268313  0.25388622  0.11013097]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02490519  0.13331996  0.09631102  0.24987462  0.10048732]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02490519  0.13331996  0.09631102  0.24987462  0.10048732]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.02400732 -0.7258387  -0.05872105  3.564574    0.5416712 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.02400732 -0.7258387  -0.05872105  3.564574    0.5416712 ]
  [Layer 24] Output shape after mixer: (1, 1, 1024)
  [Layer 24] Output sample values after mixer: [-0.02400732 -0.7258387  -0.05872105  3.564574    0.5416712 ]
  [Layer 24] Residual connection shape: (1, 1, 1024)
  [Layer 24] Residual connection sample values: [ 0.73328143 -4.183751    4.3296933   3.4284678   6.4552956 ]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.04541606 -0.24050756  0.24992007  0.24312176  0.37464818]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.04541606 -0.24050756  0.24992007  0.24312176  0.37464818]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.04541606 -0.24050756  0.24992007  0.24312176  0.37464818]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.7668958   1.2794845  -1.8222865   0.00873767 -0.7073343 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.7668958   1.2794845  -1.8222865   0.00873767 -0.7073343 ]
  [FlaxMamba2] xBC (step) sample values: [-0.59246755  0.10794807  1.4646002  -0.9297252  -0.75727636]
  [FlaxMamba2] dt (step) sample values: [-0.8512777  -0.29767305 -0.71112096 -0.1360384  -0.6062577 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.03133045 -0.13636056  0.7092835  -0.59246755  0.25178578]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.23496103  0.00618208 -0.27888575 -0.50771034 -0.08093385]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.2156434   0.00952948 -0.17622462 -0.6128129  -0.1195691 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.11940238  0.00478744 -0.08036856 -0.21535335 -0.05621461]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.11940238  0.00478744 -0.08036856 -0.21535335 -0.05621461]
  [FlaxMamba2] B (step) sample values: [-0.01889431 -0.04783936 -0.01695297  0.05000201 -0.14528492]
  [FlaxMamba2] C (step) sample values: [-0.21777329 -0.23814297  0.77000475 -0.04046429  0.06588239]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.16260907 -0.3326761  -0.32944313 -0.2015813  -0.1541056 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.2907529  0.27374074 0.18311684 0.3916562  0.32094187]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9538212  0.91295654 0.94145703 0.9240856  0.95174426]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.11940238  0.00478744 -0.08036856 -0.21535335 -0.05621461]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00065595 -0.00166082 -0.00058855  0.0017359  -0.0050438 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00065595 -0.00166082 -0.00058855  0.0017359  -0.0050438 ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00074834  0.00358352  0.00224582  0.00394292 -0.02108008]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00786564  0.0231303  -0.1083314  -0.43168727 -0.18801485]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.10184617  0.0275292  -0.18217734 -0.6295628  -0.23966715]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.10184617  0.0275292  -0.18217734 -0.6295628  -0.23966715]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02626012  0.02755728  0.04619815 -0.00276247  0.05597507]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.17901666  0.14722699  0.20612343 -0.00691386  0.21576712]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.17901666  0.14722699  0.20612343 -0.00691386  0.21576712]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.4564986 -0.7367803 -1.9922615 -0.7517808  0.7762449]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.4564986 -0.7367803 -1.9922615 -0.7517808  0.7762449]
  [Layer 25] Output shape after mixer: (1, 1, 1024)
  [Layer 25] Output sample values after mixer: [-1.4564986 -0.7367803 -1.9922615 -0.7517808  0.7762449]
  [Layer 25] Residual connection shape: (1, 1, 1024)
  [Layer 25] Residual connection sample values: [-0.7232172 -4.9205313  2.337432   2.676687   7.2315407]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.05105643 -0.32359797  0.16164286  0.2269885   0.4883572 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05105643 -0.32359797  0.16164286  0.2269885   0.4883572 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05105643 -0.32359797  0.16164286  0.2269885   0.4883572 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.42730275  0.48655632 -0.10941909 -1.2446339  -0.20445055]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.42730275  0.48655632 -0.10941909 -1.2446339  -0.20445055]
  [FlaxMamba2] xBC (step) sample values: [-1.5060759  -1.6324902   2.0376074  -0.39622676 -1.1155659 ]
  [FlaxMamba2] dt (step) sample values: [-0.11698078 -1.3225462  -2.0732262  -1.6946732  -1.4468616 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.05861462 -1.1091459  -0.8267723  -1.5060759  -1.1958063 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.4061286  -0.51973814 -0.5367051  -0.13465853 -0.32797182]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.497132   -0.5736627  -0.56197363 -0.19795199 -0.5957941 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.18802273 -0.20674352 -0.20404753 -0.08921161 -0.21168953]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.18802273 -0.20674352 -0.20404753 -0.08921161 -0.21168953]
  [FlaxMamba2] B (step) sample values: [ 0.08017521 -0.0310273  -0.10323489  0.1429364  -0.04240645]
  [FlaxMamba2] C (step) sample values: [-0.05035628 -0.27827457 -0.27131593 -0.01825806  0.05022532]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.329765   -0.06343037 -0.22886811 -0.12639298 -0.0584348 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.50991136 0.05434822 0.39636913 0.4313132  0.15334007]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8452263  0.9965586  0.9132768  0.94694436 0.9910796 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.18802273 -0.20674352 -0.20404753 -0.08921161 -0.21168953]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00768679  0.00297474  0.00989764 -0.01370402  0.00406572]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00768679  0.00297474  0.00989764 -0.01370402  0.00406572]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.04558044  0.03285313  0.00326838 -0.04774931  0.00126683]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.30252928 -0.27682006 -0.23200922  0.15872341 -0.5160435 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-1.0608449  -1.1106386  -1.0549545  -0.20107645 -1.3698097 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-1.0608449  -1.1106386  -1.0549545  -0.20107645 -1.3698097 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.2743517  -0.33465967  0.05456161  0.05596722  0.12576431]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.37754562 -0.32127443  0.06919895  0.07797179  0.12901635]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.37754562 -0.32127443  0.06919895  0.07797179  0.12901635]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.4683149  -0.99072754  1.211131    1.4048167   0.292069  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.4683149  -0.99072754  1.211131    1.4048167   0.292069  ]
  [Layer 26] Output shape after mixer: (1, 1, 1024)
  [Layer 26] Output sample values after mixer: [ 1.4683149  -0.99072754  1.211131    1.4048167   0.292069  ]
  [Layer 26] Residual connection shape: (1, 1, 1024)
  [Layer 26] Residual connection sample values: [ 0.7450977 -5.9112587  3.548563   4.081504   7.5236096]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.0427788  -0.3230838   0.19657485  0.27085018  0.4349947 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.0427788  -0.3230838   0.19657485  0.27085018  0.4349947 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.0427788  -0.3230838   0.19657485  0.27085018  0.4349947 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.5812905  -1.0830566  -0.28164503  0.0014484   0.9015314 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.5812905  -1.0830566  -0.28164503  0.0014484   0.9015314 ]
  [FlaxMamba2] xBC (step) sample values: [-0.5378049   1.1548247  -0.53347254  0.04795402 -0.19109243]
  [FlaxMamba2] dt (step) sample values: [ 0.03014969 -1.787477   -0.19697064  1.3641509  -0.29920167]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.7113648  -0.38122988  0.02095367 -0.5378049  -0.76518303]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.13976552  0.27286857 -0.08708252 -0.03078954 -0.02709187]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.12308766  0.22108024 -0.14213623 -0.23098485 -0.02523506]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.0653267   0.12270971 -0.06602592 -0.10221292 -0.01245834]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0653267   0.12270971 -0.06602592 -0.10221292 -0.01245834]
  [FlaxMamba2] B (step) sample values: [-0.09321668 -0.05781586  0.04578153  0.0202181  -0.09457889]
  [FlaxMamba2] C (step) sample values: [-0.26052073  0.09094665 -0.06401409 -0.1256895  -0.24523655]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.562595   -0.03025642 -0.75594616 -1.1612954  -0.04055573]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.07910286 0.00760331 0.00765287 0.27238905 0.02359853]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9564729 0.99977   0.9942315 0.7288232 0.9990434]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0653267   0.12270971 -0.06602592 -0.10221292 -0.01245834]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0004817  -0.00029877  0.00023658  0.00010448 -0.00048874]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0004817  -0.00029877  0.00023658  0.00010448 -0.00048874]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00172605 -0.01017014 -0.00316806 -0.00610788 -0.0045149 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.03223583 -0.04716632  0.00892141 -0.0034021   0.010219  ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.09767687  0.19686179 -0.12238181 -0.20666903 -0.01455642]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.09767687  0.19686179 -0.12238181 -0.20666903 -0.01455642]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02036285 -0.0539274   0.01482308 -0.00014978 -0.00933397]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.06568427 -0.1368994   0.05427943 -0.00014112 -0.04365222]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.06568427 -0.1368994   0.05427943 -0.00014112 -0.04365222]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.7760991  -0.09614734  0.56444716  0.5988544  -1.0549412 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.7760991  -0.09614734  0.56444716  0.5988544  -1.0549412 ]
  [Layer 27] Output shape after mixer: (1, 1, 1024)
  [Layer 27] Output sample values after mixer: [-0.7760991  -0.09614734  0.56444716  0.5988544  -1.0549412 ]
  [Layer 27] Residual connection shape: (1, 1, 1024)
  [Layer 27] Residual connection sample values: [-0.03100139 -6.007406    4.1130104   4.6803584   6.4686685 ]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.00144856 -0.27013206  0.1890255   0.2556647   0.29273534]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.00144856 -0.27013206  0.1890255   0.2556647   0.29273534]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.00144856 -0.27013206  0.1890255   0.2556647   0.29273534]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.9678709 -1.3039845  0.0436768  0.9792664  1.1650964]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.9678709 -1.3039845  0.0436768  0.9792664  1.1650964]
  [FlaxMamba2] xBC (step) sample values: [-1.445223    1.6297375  -0.8635483  -0.77355814  0.5704117 ]
  [FlaxMamba2] dt (step) sample values: [-0.2950362  -0.9222286  -0.5478217  -0.42300874 -0.67166895]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.00289398 -1.2640718  -0.6237256  -1.445223    0.00508321]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.46812153  0.5328465  -0.19545774  0.19199352  0.05638747]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.34019184  0.44343    -0.32460815  0.10190563 -0.00922533]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.1987527   0.2700826  -0.13619037  0.05354676 -0.00459139]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.1987527   0.2700826  -0.13619037  0.05354676 -0.00459139]
  [FlaxMamba2] B (step) sample values: [ 1.0470625  -0.05358505 -0.01221996  0.00985428  1.6653342 ]
  [FlaxMamba2] C (step) sample values: [-0.05938324  0.07464593  0.29549167 -0.13190964 -0.11430578]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.54422176 -0.18426022 -0.10643356 -0.11241624 -0.25234625]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1368025  0.23375304 0.621807   0.62613994 0.27392277]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.92825305 0.957843   0.9359613  0.93203187 0.93321157]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.1987527   0.2700826  -0.13619037  0.05354676 -0.00459139]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.02846949 -0.00145697 -0.00033226  0.00026794  0.04528021]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.02846949 -0.00145697 -0.00033226  0.00026794  0.04528021]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.03586587 -0.00438854  0.00488494  0.00030221  0.0438432 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00487027 -0.00570166 -0.00324168  0.00065751 -0.01385006]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.36593744  0.49818432 -0.25732848  0.1005583  -0.02241609]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.36593744  0.49818432 -0.25732848  0.1005583  -0.02241609]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.09750762 -0.13869174 -0.00574235  0.07158645 -0.01990781]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.612682   -0.8188713  -0.03236632  0.46618053 -0.15084995]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.612682   -0.8188713  -0.03236632  0.46618053 -0.15084995]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.8124352  -2.4066527   1.303183   -0.67867345  2.5556293 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.8124352  -2.4066527   1.303183   -0.67867345  2.5556293 ]
  [Layer 28] Output shape after mixer: (1, 1, 1024)
  [Layer 28] Output sample values after mixer: [ 1.8124352  -2.4066527   1.303183   -0.67867345  2.5556293 ]
  [Layer 28] Residual connection shape: (1, 1, 1024)
  [Layer 28] Residual connection sample values: [ 1.7814338 -8.414059   5.4161935  4.001685   9.024298 ]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.09817288 -0.45777452  0.30079818  0.27251112  0.49952585]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.09817288 -0.45777452  0.30079818  0.27251112  0.49952585]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.09817288 -0.45777452  0.30079818  0.27251112  0.49952585]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.78865725 -1.1881562  -0.60456365  1.9296174   1.5967842 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.78865725 -1.1881562  -0.60456365  1.9296174   1.5967842 ]
  [FlaxMamba2] xBC (step) sample values: [0.04194061 0.30087364 0.11703199 1.7091676  0.9372607 ]
  [FlaxMamba2] dt (step) sample values: [ 0.70692104 -1.2535039   0.11778472 -0.5619123  -1.1375487 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [0.2164995  0.17975312 0.733938   0.04194061 0.68811774]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.02581105 -0.08773216 -0.07780466 -0.30340615  0.00138376]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03980336 -0.16335472 -0.21611032  0.06329307  1.5013838 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.0202977  -0.07502097 -0.09642448  0.0326477   1.2278029 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0202977  -0.07502097 -0.09642448  0.0326477   1.2278029 ]
  [FlaxMamba2] B (step) sample values: [-0.08752774  0.00637185  0.0065234   0.05565641  0.08023564]
  [FlaxMamba2] C (step) sample values: [-0.19838275 -0.02866052 -0.19124492  0.12281159 -0.06526316]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6542169  -0.13693057 -1.458904   -0.36823887 -0.12178858]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1619513  0.01607177 0.10580765 0.06015151 0.10295609]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8994685 0.9978017 0.8569607 0.9780934 0.9875394]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0202977  -0.07502097 -0.09642448  0.0326477   1.2278029 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.8772466e-04  2.0945801e-05  2.1443966e-05  1.8295596e-04
  2.6375375e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.8772466e-04  2.0945801e-05  2.1443966e-05  1.8295596e-04
  2.6375375e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00541275 -0.000575   -0.00024548 -0.00253544  0.00245121]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0037392  -0.034328   -0.03796563  0.05735352  0.4142565 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03785864 -0.16043454 -0.20005041  0.1122327   2.4781325 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03785864 -0.16043454 -0.20005041  0.1122327   2.4781325 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00932918  0.04452702  0.04272927  0.18910712  3.290552  ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.06092727  0.22704497  0.16278352  0.88458544  2.3845713 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.06092727  0.22704497  0.16278352  0.88458544  2.3845713 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.8920367 -0.6586416  3.8275144  3.7605877 -0.8387727]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.8920367 -0.6586416  3.8275144  3.7605877 -0.8387727]
  [Layer 29] Output shape after mixer: (1, 1, 1024)
  [Layer 29] Output sample values after mixer: [-2.8920367 -0.6586416  3.8275144  3.7605877 -0.8387727]
  [Layer 29] Residual connection shape: (1, 1, 1024)
  [Layer 29] Residual connection sample values: [-1.1106029 -9.0727005  9.243708   7.762273   8.185525 ]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.04992798 -0.3893194   0.4043668   0.398452    0.35763606]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.04992798 -0.3893194   0.4043668   0.398452    0.35763606]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.04992798 -0.3893194   0.4043668   0.398452    0.35763606]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.3875651  -0.15451562 -0.15129842 -1.0362097   2.5929098 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.3875651  -0.15451562 -0.15129842 -1.0362097   2.5929098 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.6208633   0.4423574   0.31336194 -0.5084125   0.13049074]
  [FlaxMamba2] dt (step) sample values: [-1.074546    0.2333976  -0.924231   -0.97351944  0.36734626]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.97053677  1.0343224  -0.6531412   1.6208633  -0.935274  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.08807044 -0.3827014   0.04934563  0.17702845 -0.42492756]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.1308866  -0.42451048  0.6245409   0.22646692 -0.5174569 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.06116658 -0.16786754  0.40673265  0.12600078 -0.19324279]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06116658 -0.16786754  0.40673265  0.12600078 -0.19324279]
  [FlaxMamba2] B (step) sample values: [ 0.08157525 -0.05620162 -0.04487302  0.13839185 -0.26598835]
  [FlaxMamba2] C (step) sample values: [-0.25476792 -0.16492471 -0.27236223 -0.27539003 -0.26853108]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2037584  -0.36680323 -0.20777717 -0.09522027 -0.4265393 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.21169259 0.29160586 0.19983114 0.03867034 0.35079643]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9577829  0.8985598  0.95932984 0.9963246  0.86102784]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06116658 -0.16786754  0.40673265  0.12600078 -0.19324279]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00105628  0.00072773  0.00058104 -0.00179197  0.00344415]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00105628  0.00072773  0.00058104 -0.00179197  0.00344415]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00187206 -0.03243469 -0.00851139 -0.01347935  0.05819441]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.09362171 -0.10104186  1.403669    0.33074716 -0.12523401]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.10372402 -0.12876695  1.4708452   0.35155752 -0.15715009]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.10372402 -0.12876695  1.4708452   0.35155752 -0.15715009]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02394688  0.0091812  -0.10286693 -0.09540029 -0.37911728]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.09587722  0.0406014  -0.27499697 -0.42337203 -0.6168644 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.09587722  0.0406014  -0.27499697 -0.42337203 -0.6168644 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 4.71535   -1.9588392 -5.4437714 -5.234549   0.5159022]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 4.71535   -1.9588392 -5.4437714 -5.234549   0.5159022]
  [Layer 30] Output shape after mixer: (1, 1, 1024)
  [Layer 30] Output sample values after mixer: [ 4.71535   -1.9588392 -5.4437714 -5.234549   0.5159022]
  [Layer 30] Residual connection shape: (1, 1, 1024)
  [Layer 30] Residual connection sample values: [  3.6047473 -11.03154     3.7999363   2.5277238   8.701427 ]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.0996883  -0.30939     0.10555077  0.07917453  0.24106112]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.0996883  -0.30939     0.10555077  0.07917453  0.24106112]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.0996883  -0.30939     0.10555077  0.07917453  0.24106112]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.52128494 -1.0506369   0.2986216  -0.20711139 -0.270677  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.52128494 -1.0506369   0.2986216  -0.20711139 -0.270677  ]
  [FlaxMamba2] xBC (step) sample values: [ 0.7384626   0.5896053   0.67552346  0.5685084  -0.10518034]
  [FlaxMamba2] dt (step) sample values: [0.8558903 1.8479785 1.6823843 1.1462756 0.9874164]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.2252947  -1.1196474  -0.40604842  0.7384626   0.02871544]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.14688997 -0.13215388 -0.14301263 -0.24376659 -0.05212032]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.14979677 -0.09721126 -0.15358697 -0.26192456 -0.11242305]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.06929908 -0.04624498 -0.07090781 -0.11390855 -0.05305511]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06929908 -0.04624498 -0.07090781 -0.11390855 -0.05305511]
  [FlaxMamba2] B (step) sample values: [-0.07924208  0.03724521 -0.00157371 -0.03648186 -0.01486574]
  [FlaxMamba2] C (step) sample values: [-0.09887606 -0.0289235  -0.09647474 -0.02459211 -0.05637938]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-9.5765535e-03 -1.0641767e-02 -2.6350424e+01 -6.4467737e+02
 -1.6546801e-02]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1050085  0.32292774 2.3345485  2.2875054  0.16038534]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.9899489e-01 9.9656940e-01 1.9221711e-27 0.0000000e+00 9.9734968e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06929908 -0.04624498 -0.07090781 -0.11390855 -0.05305511]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.7664403e-04 -2.7103309e-04  1.1451907e-05  2.6547824e-04
  1.0817791e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.7664403e-04 -2.7103309e-04  1.1451907e-05  2.6547824e-04
  1.0817791e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01648882 -0.01073197  0.00782769  0.01563367  0.00603101]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00673272 -0.02773223 -0.01745112 -0.0450363  -0.07084196]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00196351 -0.02192902 -0.008553   -0.03074209 -0.06418415]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00196351 -0.02192902 -0.008553   -0.03074209 -0.06418415]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00064222  0.00596958 -0.00146633  0.00285502  0.00751808]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01630019  0.13702294 -0.03407722  0.2936891   0.05044106]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01630019  0.13702294 -0.03407722  0.2936891   0.05044106]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [0.59466714 3.30599    0.27906406 4.6359277  1.3690385 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [0.59466714 3.30599    0.27906406 4.6359277  1.3690385 ]
  [Layer 31] Output shape after mixer: (1, 1, 1024)
  [Layer 31] Output sample values after mixer: [0.59466714 3.30599    0.27906406 4.6359277  1.3690385 ]
  [Layer 31] Residual connection shape: (1, 1, 1024)
  [Layer 31] Residual connection sample values: [ 4.1994143 -7.7255497  4.0790005  7.1636515 10.070466 ]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.18449208 -0.33213848  0.17414875  0.3668165   0.44889277]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.18449208 -0.33213848  0.17414875  0.3668165   0.44889277]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.18449208 -0.33213848  0.17414875  0.3668165   0.44889277]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.09330399 -2.3002195   1.3846906   0.5561982   0.32287052]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.09330399 -2.3002195   1.3846906   0.5561982   0.32287052]
  [FlaxMamba2] xBC (step) sample values: [-0.7309479   0.60745287 -0.13472037 -0.60086614  0.24363855]
  [FlaxMamba2] dt (step) sample values: [-1.8088328 -1.5990885 -0.7624786 -1.1953388 -1.0201303]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.37891003 -0.05959322 -0.32137263 -0.7309479   0.21737818]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.09499416 -0.03129603  0.10452886  0.32656482 -0.05794106]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.08130702 -0.39921597  0.10245176  0.30308154 -0.07023964]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.04230531 -0.1602855   0.05384767  0.17433119 -0.03388692]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04230531 -0.1602855   0.05384767  0.17433119 -0.03388692]
  [FlaxMamba2] B (step) sample values: [ 0.07231108  0.22898932  0.15272471 -0.06436453  0.10873357]
  [FlaxMamba2] C (step) sample values: [-0.26381204 -0.0673365  -0.27798873 -0.27090946 -0.13659899]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.0662153  -0.08112868 -0.58786964 -0.09559295 -0.5447535 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.24723889 0.3219059  0.21836324 0.35255122 0.2591711 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.98376226 0.97422224 0.87952864 0.9668602  0.8683292 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04230531 -0.1602855   0.05384767  0.17433119 -0.03388692]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00075634  0.00239512  0.00159743 -0.00067322  0.0011373 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00075634  0.00239512  0.00159743 -0.00067322  0.0011373 ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.02129005 0.10886855 0.1340057  0.2714515  0.15483825]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.61399263 -1.3835815   0.34926006  1.3049315  -0.494772  ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.61303484 -1.3799527   0.34804097  1.3009847  -0.4940048 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.61303484 -1.3799527   0.34804097  1.3009847  -0.4940048 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02726605  0.28918424  0.38541955  0.45990363 -0.09251353]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01834835  0.42262423  0.5614664   0.4198064  -0.09513856]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01834835  0.42262423  0.5614664   0.4198064  -0.09513856]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [1.251658  2.9384754 1.5007415 2.561337  5.0427985]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [1.251658  2.9384754 1.5007415 2.561337  5.0427985]
  [Layer 32] Output shape after mixer: (1, 1, 1024)
  [Layer 32] Output sample values after mixer: [1.251658  2.9384754 1.5007415 2.561337  5.0427985]
  [Layer 32] Residual connection shape: (1, 1, 1024)
  [Layer 32] Residual connection sample values: [ 5.451072 -4.787074  5.579742  9.724989 15.113264]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.22400768 -0.19212535  0.22801429  0.41973475  0.6280074 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.22400768 -0.19212535  0.22801429  0.41973475  0.6280074 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.22400768 -0.19212535  0.22801429  0.41973475  0.6280074 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.8131838 -0.4531522  2.3534813 -0.7204115  1.3998319]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.8131838 -0.4531522  2.3534813 -0.7204115  1.3998319]
  [FlaxMamba2] xBC (step) sample values: [ 1.6151876  -0.12150099  1.1568025   0.02607366 -1.1831131 ]
  [FlaxMamba2] dt (step) sample values: [ 0.2416384 -0.3313345 -1.2943515 -1.2632701 -0.99313  ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.709317    1.9686584   0.9715412   1.6151876  -0.10803429]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.4236806   0.05645696  0.17471755 -0.03831793 -0.24117723]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.15341693  0.01986639  0.16135085 -0.16124274 -0.27554002]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.08258114  0.01003186  0.08716986 -0.07413561 -0.11890862]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.08258114  0.01003186  0.08716986 -0.07413561 -0.11890862]
  [FlaxMamba2] B (step) sample values: [-0.00077856  0.0965559   0.02536023 -0.03006416  0.0410094 ]
  [FlaxMamba2] C (step) sample values: [-0.06205632  1.1334133   0.09312274 -0.2774944  -0.02447196]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-13.044406    -1.3849771   -0.1667907   -0.23590268  -5.254998  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0179306  0.00346481 0.01549338 0.01510533 0.00308924]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.79144573 0.9952128  0.9974192  0.996443   0.98389715]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.08258114  0.01003186  0.08716986 -0.07413561 -0.11890862]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.1528359e-06  1.4297312e-04  3.7551632e-05 -4.4516866e-05
  6.0723800e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.1528359e-06  1.4297312e-04  3.7551632e-05 -4.4516866e-05
  6.0723800e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 7.2005321e-04 -3.6109102e-04 -6.9628892e-05 -4.2692460e-05
  8.7103494e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 1.01054415e-04  1.87745376e-03  3.91731155e-04 -1.87137513e-03
  8.28875054e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.08855387  0.0126226   0.09375954 -0.08127817 -0.12728037]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.08855387  0.0126226   0.09375954 -0.08127817 -0.12728037]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02212255 -0.00222284  0.20151025  0.01916477 -0.14292124]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.20885386 -0.02034581  2.517224    0.20119028 -1.6964098 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.20885386 -0.02034581  2.517224    0.20119028 -1.6964098 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.4328399  0.4368635 -1.6584412 -2.6245825  3.0584984]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.4328399  0.4368635 -1.6584412 -2.6245825  3.0584984]
  [Layer 33] Output shape after mixer: (1, 1, 1024)
  [Layer 33] Output sample values after mixer: [ 2.4328399  0.4368635 -1.6584412 -2.6245825  3.0584984]
  [Layer 33] Residual connection shape: (1, 1, 1024)
  [Layer 33] Residual connection sample values: [ 7.883912  -4.3502107  3.921301   7.1004066 18.171762 ]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.25614107 -0.13922125  0.13245443  0.23400205  0.60294527]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.25614107 -0.13922125  0.13245443  0.23400205  0.60294527]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.25614107 -0.13922125  0.13245443  0.23400205  0.60294527]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.7787709  -0.8031416  -0.586766    0.56456727 -1.9134167 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.7787709  -0.8031416  -0.586766    0.56456727 -1.9134167 ]
  [FlaxMamba2] xBC (step) sample values: [-0.456136  -1.2735611 -1.0543302  1.3134199 -1.4762484]
  [FlaxMamba2] dt (step) sample values: [-0.05993908 -0.3490702   1.8139888  -1.0987172   0.4818036 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.631929    0.37849823 -0.11966293 -0.456136   -1.059739  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.09364472  0.65158343  0.24991094 -0.23226902 -0.43666664]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.1370102   0.5543544   0.21591435 -0.31338474 -0.51070225]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.06381948  0.35209557  0.11956687 -0.13233885 -0.19152813]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06381948  0.35209557  0.11956687 -0.13233885 -0.19152813]
  [FlaxMamba2] B (step) sample values: [-0.03722817 -0.0590364  -0.06594817 -0.12151036  0.04897828]
  [FlaxMamba2] C (step) sample values: [-0.25573987 -0.03743246 -0.17931217 -0.01637764 -0.10695677]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2224774  -0.15365478 -0.8168739  -0.85911244 -2.0730147 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01234821 0.00504633 0.83449066 0.03432814 0.27064207]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9972566 0.9992249 0.5057698 0.9709389 0.5706125]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06381948  0.35209557  0.11956687 -0.13233885 -0.19152813]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.9337893e-05  4.6524005e-05  5.1970870e-05  9.5757001e-05
 -3.8597638e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.9337893e-05  4.6524005e-05  5.1970870e-05  9.5757001e-05
 -3.8597638e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00301167  0.00746353  0.0034226  -0.00657858  0.01056747]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0203118   0.0697543   0.03203162 -0.0142418  -0.02964707]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.14587744  0.7625067   0.2672809  -0.27462012 -0.40648106]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.14587744  0.7625067   0.2672809  -0.27462012 -0.40648106]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03748354 -0.18944858 -0.05604795 -0.09884032  0.10001896]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.26106858 -0.73787135 -0.32644773 -0.6803599   0.7337941 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.26106858 -0.73787135 -0.32644773 -0.6803599   0.7337941 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.5469128 -4.2581515  1.0830472  3.6779602 -2.916537 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.5469128 -4.2581515  1.0830472  3.6779602 -2.916537 ]
  [Layer 34] Output shape after mixer: (1, 1, 1024)
  [Layer 34] Output sample values after mixer: [ 0.5469128 -4.2581515  1.0830472  3.6779602 -2.916537 ]
  [Layer 34] Residual connection shape: (1, 1, 1024)
  [Layer 34] Residual connection sample values: [ 8.430825 -8.608362  5.004348 10.778367 15.255225]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.33771285 -0.3421258   0.19749545  0.46028104  0.6073577 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.33771285 -0.3421258   0.19749545  0.46028104  0.6073577 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.33771285 -0.3421258   0.19749545  0.46028104  0.6073577 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.05307329 -0.7110982  -0.14164758 -1.9769058   2.9164717 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.05307329 -0.7110982  -0.14164758 -1.9769058   2.9164717 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.0362945   0.75901115 -1.4869554  -1.3113716  -0.25955626]
  [FlaxMamba2] dt (step) sample values: [-0.13863046 -1.2376492  -1.6042295  -2.0774248   0.6723486 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.36135927 -0.48985565 -0.17228524  1.0362945   1.2329392 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.20295766  0.18701448 -0.17680112 -0.2681754  -0.05518792]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.2544103   0.16528596 -0.20423642 -0.2930167  -0.16743158]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.11111071  0.08945734 -0.09172617 -0.12519592 -0.07672378]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.11111071  0.08945734 -0.09172617 -0.12519592 -0.07672378]
  [FlaxMamba2] B (step) sample values: [-0.27811313  0.0821956   0.31481695  0.47844198  0.22187497]
  [FlaxMamba2] C (step) sample values: [-0.24223709 -0.178223   -0.27727222 -0.07467438  0.04629812]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2053565  -0.14169171 -0.10705902 -0.1460468  -0.2580783 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.6341044  1.2656064  0.24617432 0.83073395 1.3281051 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7149277  0.83583343 0.97398907 0.8857451  0.70981205]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.11111071  0.08945734 -0.09172617 -0.12519592 -0.07672378]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.05049602 -0.01492397 -0.05716021 -0.08686903 -0.04028506]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.05049602 -0.01492397 -0.05716021 -0.08686903 -0.04028506]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.04633027 -0.01580562 -0.06367017 -0.08422596 -0.04744264]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.19084637  0.28512874 -0.6097277  -0.6574053   0.11580279]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.48180532  0.51938534 -0.8499255  -0.9852483  -0.08510917]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.48180532  0.51938534 -0.8499255  -0.9852483  -0.08510917]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0131247  -0.12164245  0.05593883  0.23694113 -0.23547362]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02033276 -0.18273772  0.02906482  0.5305247  -0.30558866]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02033276 -0.18273772  0.02906482  0.5305247  -0.30558866]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.1999718   0.48172447 -3.254634   -1.3301027   2.978127  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.1999718   0.48172447 -3.254634   -1.3301027   2.978127  ]
  [Layer 35] Output shape after mixer: (1, 1, 1024)
  [Layer 35] Output sample values after mixer: [-1.1999718   0.48172447 -3.254634   -1.3301027   2.978127  ]
  [Layer 35] Residual connection shape: (1, 1, 1024)
  [Layer 35] Residual connection sample values: [ 7.2308536 -8.126637   1.7497139  9.448264  18.233353 ]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.2233209  -0.2566241   0.05435558  0.311467    0.5768752 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.2233209  -0.2566241   0.05435558  0.311467    0.5768752 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.2233209  -0.2566241   0.05435558  0.311467    0.5768752 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.8862342  -0.30850643 -2.1422663   0.5450548  -0.6545414 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.8862342  -0.30850643 -2.1422663   0.5450548  -0.6545414 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.1748698  2.3698785  1.3898084 -0.9520379 -1.878675 ]
  [FlaxMamba2] dt (step) sample values: [0.29268536 2.4203525  1.7227436  0.42311335 1.4581591 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.94556344  2.9650278  -0.49706623  1.1748698   1.5891014 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.28166908  0.5415494   0.40193778 -0.21456727 -0.29964182]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.24138588  0.42399567  0.3398345  -0.3592206  -0.31176493]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.10619648  0.2562795   0.19851443 -0.1476929  -0.13177805]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.10619648  0.2562795   0.19851443 -0.1476929  -0.13177805]
  [FlaxMamba2] B (step) sample values: [ 0.0219506  -0.02013829 -0.05997156  0.17928526 -0.0712667 ]
  [FlaxMamba2] C (step) sample values: [-0.14367187 -0.1220475  -0.17755957 -0.08028101 -0.15220132]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.8654757 -5.63779   -3.8975632 -2.4259677 -3.6937442]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.09264372 0.17757824 0.09763948 0.05984817 0.10257503]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7668468  0.36745706 0.6834813  0.86485815 0.6846237 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.10619648  0.2562795   0.19851443 -0.1476929  -0.13177805]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00021596  0.00019813  0.00059003 -0.00176389  0.00070115]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00021596  0.00019813  0.00059003 -0.00176389  0.00070115]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0075377   0.00141287 -0.00113512 -0.00045926  0.00333698]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.03090387  0.06884444  0.00132099 -0.04113529 -0.03396703]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.35659105  0.8548116   0.6101322  -0.4940852  -0.43810868]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.35659105  0.8548116   0.6101322  -0.4940852  -0.43810868]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0885661  -0.11167781 -0.13731524 -0.17046575  0.09806252]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.2012192  -0.54183835 -0.4602554  -0.60925066  0.3988287 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.2012192  -0.54183835 -0.4602554  -0.60925066  0.3988287 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.5067221 -2.7820342  2.0092826 -8.414134   0.66008  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.5067221 -2.7820342  2.0092826 -8.414134   0.66008  ]
  [Layer 36] Output shape after mixer: (1, 1, 1024)
  [Layer 36] Output sample values after mixer: [-1.5067221 -2.7820342  2.0092826 -8.414134   0.66008  ]
  [Layer 36] Residual connection shape: (1, 1, 1024)
  [Layer 36] Residual connection sample values: [  5.7241316 -10.908671    3.7589965   1.0341301  18.893433 ]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.16351421 -0.3199769   0.11265241  0.03025867  0.5536421 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.16351421 -0.3199769   0.11265241  0.03025867  0.5536421 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.16351421 -0.3199769   0.11265241  0.03025867  0.5536421 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.36370024 -0.7811142   0.03406639  1.0823704   0.15889144]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.36370024 -0.7811142   0.03406639  1.0823704   0.15889144]
  [FlaxMamba2] xBC (step) sample values: [-0.5111333   0.22026938  2.7497683  -1.4538935  -3.5785384 ]
  [FlaxMamba2] dt (step) sample values: [-1.6062917  -0.23060744  2.6286926  -1.181465    0.07806255]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.649439   -0.63286954 -0.13349202 -0.5111333   2.078097  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.13984193 -0.14159358 -0.818706    0.40830782 -0.9221463 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.06208314 -0.20568049 -0.9033007   0.4431894  -1.0057645 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.03200484 -0.09230126 -0.26048726  0.26991066 -0.26935336]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03200484 -0.09230126 -0.26048726  0.26991066 -0.26935336]
  [FlaxMamba2] B (step) sample values: [-0.22337943 -0.02196913 -0.02609851 -0.11299822  0.0122667 ]
  [FlaxMamba2] C (step) sample values: [-0.27371135 -0.24118863 -0.15392858 -0.22287086 -0.27845135]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.8178532  -31.169907   -39.01954     -0.46187502  -0.64770097]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00012672 0.00574593 0.04535259 0.00022744 0.00179065]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9997697  0.83602214 0.17039484 0.999895   0.99884087]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03200484 -0.09230126 -0.26048726  0.26991066 -0.26935336]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.0593869e-07 -8.9098108e-08 -1.0584523e-07 -4.5827611e-07
  4.9748873e-08]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.0593869e-07 -8.9098108e-08 -1.0584523e-07 -4.5827611e-07
  4.9748873e-08]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00040678  0.00035245 -0.00061891  0.00089822 -0.00057457]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00070447  0.00146395 -0.0086493   0.00649055 -0.00327388]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.05932494 -0.16759619 -0.48576102  0.5008623  -0.4966249 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.05932494 -0.16759619 -0.48576102  0.5008623  -0.4966249 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01272875  0.04111674 -0.00841498  0.40493125 -0.04258265]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.09477508  0.22138122 -0.04261388  3.244266   -0.18205585]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.09477508  0.22138122 -0.04261388  3.244266   -0.18205585]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-13.096493   -3.4844396   5.903298   -1.3142852   2.2651515]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-13.096493   -3.4844396   5.903298   -1.3142852   2.2651515]
  [Layer 37] Output shape after mixer: (1, 1, 1024)
  [Layer 37] Output sample values after mixer: [-13.096493   -3.4844396   5.903298   -1.3142852   2.2651515]
  [Layer 37] Residual connection shape: (1, 1, 1024)
  [Layer 37] Residual connection sample values: [ -7.372361   -14.393111     9.662294    -0.28015506  21.158585  ]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.20397918 -0.39822996  0.26606423 -0.00751143  0.5893205 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.20397918 -0.39822996  0.26606423 -0.00751143  0.5893205 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.20397918 -0.39822996  0.26606423 -0.00751143  0.5893205 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.25527653 -0.681473   -0.34134305 -1.8645738   1.6706744 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.25527653 -0.681473   -0.34134305 -1.8645738   1.6706744 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.89194643 -0.3671469  -1.6557721   1.0658389   1.3784301 ]
  [FlaxMamba2] dt (step) sample values: [-1.3746282  -0.01935345 -1.3026106  -1.2402059   1.1724908 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 2.66538     0.83034813  0.53411996  0.89194643 -0.7356998 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.2806179  -0.5377113   0.00167838 -0.08478843  0.24679649]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.2830078  -0.82701796 -0.08840951 -0.1279708   0.33975303]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.12161313 -0.2516417  -0.04225197 -0.05989685  0.19846012]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.12161313 -0.2516417  -0.04225197 -0.05989685  0.19846012]
  [FlaxMamba2] B (step) sample values: [ 0.1842506   0.71905845 -0.08556604 -0.0540409   0.00616199]
  [FlaxMamba2] C (step) sample values: [-0.18886733 -0.12624876 -0.27826416 -0.25785202  0.03388235]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17041285 -2.0831616  -0.13507122 -0.41240796 -3.531486  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.26940313 0.11643729 0.23031925 0.09565491 0.28807527]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.95512813 0.7846185  0.9693694  0.96131915 0.36155766]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.12161313 -0.2516417  -0.04225197 -0.05989685  0.19846012]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00603659 -0.02355848  0.0028034   0.00177054 -0.00020189]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00603659 -0.02355848  0.0028034   0.00177054 -0.00020189]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0141631   0.12875728 -0.00746712  0.00365573 -0.01035073]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.43910068 -0.35927352 -0.26890114 -0.23275557  1.1258838 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.45693657 -0.3961795  -0.27509785 -0.24154009  1.1549902 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.45693657 -0.3961795  -0.27509785 -0.24154009  1.1549902 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [0.05091856 0.09069698 0.03901502 0.06042643 1.6240889 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.18056364 0.21654217 0.10301361 0.31856343 5.9198966 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.18056364 0.21654217 0.10301361 0.31856343 5.9198966 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 6.703807   1.0548934  9.198347   8.211094  -1.1611774]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 6.703807   1.0548934  9.198347   8.211094  -1.1611774]
  [Layer 38] Output shape after mixer: (1, 1, 1024)
  [Layer 38] Output sample values after mixer: [ 6.703807   1.0548934  9.198347   8.211094  -1.1611774]
  [Layer 38] Residual connection shape: (1, 1, 1024)
  [Layer 38] Residual connection sample values: [ -0.6685543 -13.338218   18.860641    7.9309387  19.997408 ]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.01239738 -0.2689842   0.3688737   0.1626832   0.3891974 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.01239738 -0.2689842   0.3688737   0.1626832   0.3891974 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.01239738 -0.2689842   0.3688737   0.1626832   0.3891974 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.6538969   0.48865467 -0.50162774 -2.2429001  -0.1788602 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.6538969   0.48865467 -0.50162774 -2.2429001  -0.1788602 ]
  [FlaxMamba2] xBC (step) sample values: [-1.2064722e+00  5.3262290e-02  2.2886209e+00 -2.7722725e-01
  6.3606269e-05]
  [FlaxMamba2] dt (step) sample values: [ 1.4836885   2.7235     -0.4140138   2.0113063   0.35083333]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-6.5311491e-01 -6.2293774e-01  1.8239754e+00 -1.2064722e+00
 -1.7277411e-03]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.22177744 -0.03375107  0.47347465 -0.06859896 -0.00631616]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.15732431 -0.09448105  0.48873344  0.4689987  -0.00971887]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.07248715 -0.04501052  0.3029209   0.288503   -0.00483582]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07248715 -0.04501052  0.3029209   0.288503   -0.00483582]
  [FlaxMamba2] B (step) sample values: [-0.00675026  0.04067422 -0.19554369 -0.03624222 -0.03991881]
  [FlaxMamba2] C (step) sample values: [-0.27154317 -0.16179502 -0.00228009 -0.04004019 -0.2779042 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.7351256e+02 -2.3790452e+00 -2.6078771e-03 -1.4978828e+00
 -6.3306607e-02]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.8600313  1.7430115  0.18185243 0.69587433 0.01264693]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.         0.01581647 0.99952585 0.35262918 0.9991997 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07248715 -0.04501052  0.3029209   0.288503   -0.00483582]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00042082 -0.00253568  0.01219043  0.00225938  0.00248859]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00042082 -0.00253568  0.01219043  0.00225938  0.00248859]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00042082 -0.00253568  0.01219043  0.00225938  0.00248859]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01919558 -0.0119194   0.08021757  0.07639949 -0.00128059]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.34718993 -0.21558578  1.4508928   1.3818356  -0.02316202]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.34718993 -0.21558578  1.4508928   1.3818356  -0.02316202]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.14935799 -0.06529296 -0.2744988  -0.297422    0.00188663]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.6707374  -0.27778536 -1.1050198  -1.1682873   0.00893964]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.6707374  -0.27778536 -1.1050198  -1.1682873   0.00893964]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.9964001   0.67171055 -6.522099   -2.563436   -5.450649  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.9964001   0.67171055 -6.522099   -2.563436   -5.450649  ]
  [Layer 39] Output shape after mixer: (1, 1, 1024)
  [Layer 39] Output sample values after mixer: [-1.9964001   0.67171055 -6.522099   -2.563436   -5.450649  ]
  [Layer 39] Residual connection shape: (1, 1, 1024)
  [Layer 39] Residual connection sample values: [ -2.6649544 -12.666507   12.338543    5.3675027  14.546759 ]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.05737803 -0.29100686  0.27766535  0.11062825  0.32424703]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05737803 -0.29100686  0.27766535  0.11062825  0.32424703]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05737803 -0.29100686  0.27766535  0.11062825  0.32424703]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.43599173  0.5607303   0.7243644   0.9518454  -1.1654329 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.43599173  0.5607303   0.7243644   0.9518454  -1.1654329 ]
  [FlaxMamba2] xBC (step) sample values: [-0.16800253  0.95515627 -0.10297879  0.5688176   0.90199214]
  [FlaxMamba2] dt (step) sample values: [ 1.095903    0.4685738   0.37845123 -0.6489835   0.2856146 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.30949703  0.00375456 -0.8215866  -0.16800253  1.3096424 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02569912 -0.16478011 -0.0090636  -0.07085024  0.15487705]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.3055997  -0.21327254 -0.08071887 -0.08240114  0.1564096 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.17596762 -0.09530789 -0.03873144 -0.03950405  0.08430836]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.17596762 -0.09530789 -0.03873144 -0.03950405  0.08430836]
  [FlaxMamba2] B (step) sample values: [ 0.00167766 -0.05011285 -0.06073728  0.05468379 -0.01870297]
  [FlaxMamba2] C (step) sample values: [-0.16697307 -0.23416735 -0.24350561 -0.278021   -0.01975624]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.52670574 -0.63007647 -0.38779998 -2.7909086  -0.42841786]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05254376 0.02061788 0.04019632 0.00317599 0.02136121]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.97270435 0.98709315 0.9845327  0.99117523 0.9908902 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.17596762 -0.09530789 -0.03873144 -0.03950405  0.08430836]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.5511627e-05 -4.6334337e-04 -5.6157680e-04  5.0560629e-04
 -1.7292766e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.5511627e-05 -4.6334337e-04 -5.6157680e-04  5.0560629e-04
 -1.7292766e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00276932 -0.04276176 -0.00718452  0.00082229 -0.00047159]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.07288563 -0.03839265 -0.04155687 -0.01350142  0.02877946]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.5085153  -0.27433917 -0.13744135 -0.11129858  0.23749526]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.5085153  -0.27433917 -0.13744135 -0.11129858  0.23749526]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.13464433 -0.09793166 -0.06705876 -0.07643355 -0.06578662]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.71333134 -0.6142561  -0.42818496 -0.38570103 -0.5467811 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.71333134 -0.6142561  -0.42818496 -0.38570103 -0.5467811 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [  3.5262666    3.4775896  -10.451408    -8.376293     0.83231574]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [  3.5262666    3.4775896  -10.451408    -8.376293     0.83231574]
  [Layer 40] Output shape after mixer: (1, 1, 1024)
  [Layer 40] Output sample values after mixer: [  3.5262666    3.4775896  -10.451408    -8.376293     0.83231574]
  [Layer 40] Residual connection shape: (1, 1, 1024)
  [Layer 40] Residual connection sample values: [ 0.86131215 -9.188917    1.8871346  -3.0087905  15.379074  ]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.01122684 -0.12805983  0.02537152 -0.0387524   0.20087993]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.01122684 -0.12805983  0.02537152 -0.0387524   0.20087993]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.01122684 -0.12805983  0.02537152 -0.0387524   0.20087993]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.89531946 -3.0290523  -0.07197301  1.169832    0.34634945]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.89531946 -3.0290523  -0.07197301  1.169832    0.34634945]
  [FlaxMamba2] xBC (step) sample values: [-0.80119365  0.6232047   0.2125712   0.31404033  0.04888302]
  [FlaxMamba2] dt (step) sample values: [ 0.36301127  0.33306485 -0.73727775  0.30763093  0.7929703 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.1127415  -1.0690017  -0.864172   -0.80119365  0.07123789]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.2108581  -0.13515954  0.04518924 -0.06267411 -0.00950951]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.24253535 -0.01278405  0.04525176 -0.15538651 -0.01906914]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.10663349 -0.00635117  0.02313772 -0.07166912 -0.00944366]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.10663349 -0.00635117  0.02313772 -0.07166912 -0.00944366]
  [FlaxMamba2] B (step) sample values: [-0.07368762 -0.00279581  0.020075    0.00785472 -0.03953085]
  [FlaxMamba2] C (step) sample values: [-0.15295021  0.11871508  0.01057147 -0.13027254 -0.27722046]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.0530885  -1.135641   -0.87189615 -1.5713016  -1.7430981 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10055386 0.28164315 0.05033212 0.16805989 0.17280148]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8995217  0.72626126 0.9570646  0.76791763 0.7399224 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.10663349 -0.00635117  0.02313772 -0.07166912 -0.00944366]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 7.9010881e-04  2.9977815e-05 -2.1525237e-04 -8.4221560e-05
  4.2386595e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 7.9010881e-04  2.9977815e-05 -2.1525237e-04 -8.4221560e-05
  4.2386595e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00810065 -0.00415422 -0.0136978  -0.00045877 -0.00686728]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01054217  0.0063187   0.0011219  -0.01155601 -0.00188627]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.14693756 -0.00180511  0.03071747 -0.10322832 -0.0139657 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.14693756 -0.00180511  0.03071747 -0.10322832 -0.0139657 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.09340305  0.00025223 -0.00106565 -0.09215356 -0.00283319]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-1.8664639   0.00672861 -0.02454295 -2.5796669  -0.07364497]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-1.8664639   0.00672861 -0.02454295 -2.5796669  -0.07364497]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-4.043885    2.956095   -0.05372702  1.6566573   3.0792825 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-4.043885    2.956095   -0.05372702  1.6566573   3.0792825 ]
  [Layer 41] Output shape after mixer: (1, 1, 1024)
  [Layer 41] Output sample values after mixer: [-4.043885    2.956095   -0.05372702  1.6566573   3.0792825 ]
  [Layer 41] Residual connection shape: (1, 1, 1024)
  [Layer 41] Residual connection sample values: [-3.182573  -6.2328224  1.8334075 -1.3521332 18.458357 ]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.03958997 -0.08331607  0.02438403 -0.0167972   0.24160144]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.03958997 -0.08331607  0.02438403 -0.0167972   0.24160144]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.03958997 -0.08331607  0.02438403 -0.0167972   0.24160144]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.30575177  1.0041177  -0.23438574 -1.4607441   0.17986602]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.30575177  1.0041177  -0.23438574 -1.4607441   0.17986602]
  [FlaxMamba2] xBC (step) sample values: [-0.8487252   0.8345112  -0.9201522   0.69157964 -1.1116234 ]
  [FlaxMamba2] dt (step) sample values: [ 0.6632028  -0.8771217   2.1251173  -0.19315392  1.2226405 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.7886849   0.26332572 -0.02132909 -0.8487252   0.02392032]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.17637575  0.17505386  0.19848186 -0.13661954 -0.28616822]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.15550172  0.13928726  0.20310146 -0.14035985 -0.3323413 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.0837839   0.07448604  0.11182798 -0.06526277 -0.13880935]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0837839   0.07448604  0.11182798 -0.06526277 -0.13880935]
  [FlaxMamba2] B (step) sample values: [-0.00771144 -0.10858711  0.05517289 -0.03382809 -0.07444074]
  [FlaxMamba2] C (step) sample values: [ 0.05317038 -0.1986949  -0.03625208 -0.27803397 -0.18266983]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.2458453 -1.7473589 -3.3796544 -1.2264227 -1.3705136]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.19218935 0.05629876 0.7707052  0.0171625  0.24167517]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.64945126 0.9063098  0.07392403 0.9791715  0.71804786]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0837839   0.07448604  0.11182798 -0.06526277 -0.13880935]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00012417 -0.00174851  0.00088841 -0.00054471 -0.00119867]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00012417 -0.00174851  0.00088841 -0.00054471 -0.00119867]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00010709 -0.00115289  0.00149204 -0.00043738 -0.0012355 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00378453  0.01091647  0.01565768 -0.00461375 -0.01314148]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.11833534  0.11275508  0.16855083 -0.09384215 -0.20292404]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.11833534  0.11275508  0.16855083 -0.09384215 -0.20292404]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01534635  0.08286157 -0.01744859  0.02581938 -0.0198864 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.3290235   1.7083822  -0.37036747  0.55521894 -0.2912515 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.3290235   1.7083822  -0.37036747  0.55521894 -0.2912515 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-4.307627  -2.4638596  1.2506254 -3.7374482 -1.8479424]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-4.307627  -2.4638596  1.2506254 -3.7374482 -1.8479424]
  [Layer 42] Output shape after mixer: (1, 1, 1024)
  [Layer 42] Output sample values after mixer: [-4.307627  -2.4638596  1.2506254 -3.7374482 -1.8479424]
  [Layer 42] Residual connection shape: (1, 1, 1024)
  [Layer 42] Residual connection sample values: [-7.4902    -8.696682   3.084033  -5.0895815 16.610415 ]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.08613106 -0.1094729   0.0371549  -0.0584855   0.19417398]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08613106 -0.1094729   0.0371549  -0.0584855   0.19417398]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08613106 -0.1094729   0.0371549  -0.0584855   0.19417398]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.99618584  0.90764534 -0.4787317  -0.9531734  -0.56464946]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.99618584  0.90764534 -0.4787317  -0.9531734  -0.56464946]
  [FlaxMamba2] xBC (step) sample values: [-0.99983454  0.27314812  0.13452986 -0.3608015  -0.17908967]
  [FlaxMamba2] dt (step) sample values: [ 2.2074625   0.43253896  0.01353934  0.81270176 -0.41526574]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.01252129 -0.14547695 -0.25887382 -0.99983454  1.0406868 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.1994072  -0.03848485 -0.02482225 -0.07045411 -0.03568577]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.21400224 -0.09271459 -0.05283739 -0.11827516 -0.04400181]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.09559537 -0.04420983 -0.02572091 -0.0556444  -0.02151694]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09559537 -0.04420983 -0.02572091 -0.0556444  -0.02151694]
  [FlaxMamba2] B (step) sample values: [-0.12766644  0.00849745  0.08213981 -0.24237706  0.19603437]
  [FlaxMamba2] C (step) sample values: [ 0.16797197  0.05801613  0.24825755 -0.26623896 -0.14205323]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-3.7045815 -2.655313  -8.210951  -2.2381823 -4.092597 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.45607933 0.11978104 0.06338335 0.67223126 0.00084528]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.18459648 0.72756195 0.59426045 0.22211143 0.99654657]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09559537 -0.04420983 -0.02572091 -0.0556444  -0.02151694]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00556614 -0.00037048 -0.00358122  0.01056741 -0.00854692]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00556614 -0.00037048 -0.00358122  0.01056741 -0.00854692]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.005541   -0.00037965 -0.00361298  0.01098095 -0.00876168]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00311368 -0.00150079 -0.00073714 -0.00177064 -0.00075753]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.16078685 -0.07441965 -0.04316071 -0.09354946 -0.03624716]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.16078685 -0.07441965 -0.04316071 -0.09354946 -0.03624716]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.04319753 -0.04812821  0.00790444  0.02481098  0.0074187 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.8240126  -1.2300996   0.16171348  0.51117176  0.15797529]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.8240126  -1.2300996   0.16171348  0.51117176  0.15797529]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.4237769 -7.9622984 -1.5528502 -8.111233   4.9087033]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.4237769 -7.9622984 -1.5528502 -8.111233   4.9087033]
  [Layer 43] Output shape after mixer: (1, 1, 1024)
  [Layer 43] Output sample values after mixer: [-2.4237769 -7.9622984 -1.5528502 -8.111233   4.9087033]
  [Layer 43] Residual connection shape: (1, 1, 1024)
  [Layer 43] Residual connection sample values: [ -9.913977  -16.658981    1.5311828 -13.200814   21.519117 ]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.10645645 -0.18498553  0.0170475  -0.13855973  0.23390983]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.10645645 -0.18498553  0.0170475  -0.13855973  0.23390983]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.10645645 -0.18498553  0.0170475  -0.13855973  0.23390983]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.6893013   1.2434865  -0.05252394 -0.44582444  0.07366193]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.6893013   1.2434865  -0.05252394 -0.44582444  0.07366193]
  [FlaxMamba2] xBC (step) sample values: [-1.0671846  -0.94732875 -0.47422835 -0.40471175  0.46781477]
  [FlaxMamba2] dt (step) sample values: [ 1.2012818  -0.21737044  0.9320212   0.6635317  -0.10613832]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.7955969  -0.5636504   0.62443125 -1.0671846  -0.84187806]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.21882664  0.20134206 -0.07924713  0.07172378  0.08847469]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.19734226  0.14427419 -0.10797943  0.05857071  0.09510463]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.08896662  0.07733185 -0.05107766  0.03014274  0.04981184]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08896662  0.07733185 -0.05107766  0.03014274  0.04981184]
  [FlaxMamba2] B (step) sample values: [-0.01797667 -0.23750302 -0.27335876  0.04409897 -0.00581396]
  [FlaxMamba2] C (step) sample values: [-0.0084018  -0.27458254 -0.16950044 -0.02135453 -0.06100935]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-4.6876054  -0.9752563  -0.82549465 -1.2937802  -0.49527767]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.29786617 0.0358946  0.06117393 0.08627393 0.00697727]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.24751623 0.9655992  0.9507551  0.8943845  0.99655026]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08896662  0.07733185 -0.05107766  0.03014274  0.04981184]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00047638  0.00629386  0.00724405 -0.00116863  0.00015407]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00047638  0.00629386  0.00724405 -0.00116863  0.00015407]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 3.2394120e-04  6.1841975e-03  7.0420699e-03 -1.0310347e-03
 -8.3206090e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00961674  0.00827599 -0.00560818  0.00328469  0.00544066]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.16422662  0.14266649 -0.09437305  0.055668    0.09200574]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.16422662  0.14266649 -0.09437305  0.055668    0.09200574]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.23418613  0.13769561  0.00241335 -0.00968787  0.00351341]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-4.819882    2.59523     0.05764746 -0.19890663  0.07073329]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-4.819882    2.59523     0.05764746 -0.19890663  0.07073329]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.8535745   4.552003    1.4010751   1.1347445  -0.77329713]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.8535745   4.552003    1.4010751   1.1347445  -0.77329713]
  [Layer 44] Output shape after mixer: (1, 1, 1024)
  [Layer 44] Output sample values after mixer: [-2.8535745   4.552003    1.4010751   1.1347445  -0.77329713]
  [Layer 44] Residual connection shape: (1, 1, 1024)
  [Layer 44] Residual connection sample values: [-12.767551 -12.106978   2.932258 -12.06607   20.745821]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.15525039 -0.15894182  0.03746065 -0.1472213   0.25556463]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.15525039 -0.15894182  0.03746065 -0.1472213   0.25556463]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.15525039 -0.15894182  0.03746065 -0.1472213   0.25556463]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.44375524 -2.9665601   0.14629626 -0.19848683 -0.44940877]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.44375524 -2.9665601   0.14629626 -0.19848683 -0.44940877]
  [FlaxMamba2] xBC (step) sample values: [ 0.10074349  0.5763502  -0.7031866   0.89356154 -0.23548627]
  [FlaxMamba2] dt (step) sample values: [ 0.645552   -0.6652804  -0.6644743  -0.07414835  1.303023  ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.30722773  0.24022754 -0.36166283  0.10074349  1.3222003 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01321207  0.07170583 -0.13168636 -0.18146442 -0.02456513]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.00755106  0.32976246 -0.15397945 -0.23746417 -0.03531495]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.00378978  0.19182335 -0.07107399 -0.10470064 -0.01734572]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00378978  0.19182335 -0.07107399 -0.10470064 -0.01734572]
  [FlaxMamba2] B (step) sample values: [-0.20768346 -0.0599189  -0.0115968   0.13633233  0.02795991]
  [FlaxMamba2] C (step) sample values: [-0.26982045 -0.00659061 -0.23170224  0.01649583 -0.09087376]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.3039274e+00 -3.9384812e-02 -6.8873577e+00 -8.0558503e-01
 -1.9935181e+03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00422837 0.00957512 0.00398252 0.00058404 0.06864801]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99450165 0.99962294 0.9729437  0.9995296  0.        ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00378978  0.19182335 -0.07107399 -0.10470064 -0.01734572]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.3280492e-06 -9.6017789e-07 -1.8583431e-07  2.1846743e-06
  4.4804702e-07]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.3280492e-06 -9.6017789e-07 -1.8583431e-07  2.1846743e-06
  4.4804702e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00165293 0.00098158 0.00122399 0.00021209 0.00161436]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00112625  0.02845587 -0.00394591 -0.007456    0.0067083 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00870942  0.5262975  -0.18840517 -0.27918693 -0.03830928]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00870942  0.5262975  -0.18840517 -0.27918693 -0.03830928]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00235429 -0.07644036 -0.01478778  0.02496668  0.00670586]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02649253 -0.64534736 -0.14906085  0.2383665   0.07679012]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02649253 -0.64534736 -0.14906085  0.2383665   0.07679012]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 5.053022  -6.0505714  0.4211932 -4.8124743 -1.6145638]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 5.053022  -6.0505714  0.4211932 -4.8124743 -1.6145638]
  [Layer 45] Output shape after mixer: (1, 1, 1024)
  [Layer 45] Output sample values after mixer: [ 5.053022  -6.0505714  0.4211932 -4.8124743 -1.6145638]
  [Layer 45] Residual connection shape: (1, 1, 1024)
  [Layer 45] Residual connection sample values: [ -7.7145295 -18.15755     3.353451  -16.878544   19.131258 ]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.08515989 -0.21557136  0.0390146  -0.18966958  0.20903687]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08515989 -0.21557136  0.0390146  -0.18966958  0.20903687]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08515989 -0.21557136  0.0390146  -0.18966958  0.20903687]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.0922856  -0.9901953  -0.61974216 -0.16556272  0.7442607 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.0922856  -0.9901953  -0.61974216 -0.16556272  0.7442607 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.20801969 -0.1183005   1.0011523  -0.2783841   0.49774447]
  [FlaxMamba2] dt (step) sample values: [-0.04265949 -0.10365259 -0.92540294 -0.29907715  1.1860557 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.3864614   1.2188412   0.8542167   0.20801969 -0.01227555]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.05139122  0.02124788  0.19785859  0.04645324 -0.08117066]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.00405922 -0.01607512  0.40073943  0.05095458 -0.0864235 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.00203373 -0.00797296  0.23998892  0.02612624 -0.04134565]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00203373 -0.00797296  0.23998892  0.02612624 -0.04134565]
  [FlaxMamba2] B (step) sample values: [-0.1309947  -0.00530126 -0.03262513 -0.06528126 -0.13402419]
  [FlaxMamba2] C (step) sample values: [-0.04700324  0.06293494 -0.06995001 -0.08341144  0.06118521]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.4426116  -0.9829804 -10.158994   -1.363838   -1.7559118]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00841836 0.01258091 0.0004325  0.00969679 0.0351823 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.98792905 0.98770934 0.9956159  0.98686224 0.9400925 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00203373 -0.00797296  0.23998892  0.02612624 -0.04134565]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.2427155e-06 -9.0761077e-08 -5.5856373e-07 -1.1176581e-06
 -2.2945821e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.2427155e-06 -9.0761077e-08 -5.5856373e-07 -1.1176581e-06
 -2.2945821e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.4867076e-03  2.9586777e-04 -5.8793587e-05  4.0459560e-04
 -8.1073248e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 1.3280262e-03 -3.9897579e-05  3.5120675e-03 -4.8801617e-04
 -1.2347329e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00381958 -0.00980772  0.297527    0.03151973 -0.05188807]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00381958 -0.00980772  0.297527    0.03151973 -0.05188807]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00104798  0.0026306  -0.06450702 -0.00239374 -0.02618035]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03066016  0.07155196 -1.4967003  -0.05498603 -0.6010458 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03066016  0.07155196 -1.4967003  -0.05498603 -0.6010458 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.9600961  4.002917  -5.89433   -2.3698263 -7.2244916]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.9600961  4.002917  -5.89433   -2.3698263 -7.2244916]
  [Layer 46] Output shape after mixer: (1, 1, 1024)
  [Layer 46] Output sample values after mixer: [ 2.9600961  4.002917  -5.89433   -2.3698263 -7.2244916]
  [Layer 46] Residual connection shape: (1, 1, 1024)
  [Layer 46] Residual connection sample values: [ -4.7544336 -14.154634   -2.540879  -19.248371   11.906767 ]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.04628742 -0.14368007 -0.02526444 -0.17690794  0.11599714]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.04628742 -0.14368007 -0.02526444 -0.17690794  0.11599714]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.04628742 -0.14368007 -0.02526444 -0.17690794  0.11599714]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.223875   -0.07980011 -0.776216   -0.65251803  0.44660428]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.223875   -0.07980011 -0.776216   -0.65251803  0.44660428]
  [FlaxMamba2] xBC (step) sample values: [-0.5188107  -0.54382575  0.41104865 -0.5591162  -0.09548841]
  [FlaxMamba2] dt (step) sample values: [-0.44642243  0.6886477   0.11481897  1.3447295  -0.6018567 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.26967475 -0.23631448 -0.7599935  -0.5188107   0.4964663 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12661265 -0.08552395  0.0811379   0.10411869 -0.01662689]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.11368845 -0.07044064  0.08002401  0.11091648 -0.01854091]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.06007202 -0.03398036  0.04161211  0.05853071 -0.00918452]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06007202 -0.03398036  0.04161211  0.05853071 -0.00918452]
  [FlaxMamba2] B (step) sample values: [ 1.5781501e-02 -5.6082481e-03  1.5684906e-04 -3.6005694e-02
 -2.5705355e-01]
  [FlaxMamba2] C (step) sample values: [ 1.3913931  -0.03741139  0.4859197  -0.27313808 -0.25739813]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-5.7667141e+01 -2.2024069e+00 -3.8371372e+00 -4.6045512e-02
 -2.0699801e+00]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02988996 0.00882795 0.01451906 0.06639785 0.0022362 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.17841044 0.980745   0.94581187 0.99694735 0.9953818 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06007202 -0.03398036  0.04161211  0.05853071 -0.00918452]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.8336477e-05 -1.0069891e-05  2.8163035e-07 -6.4650027e-05
 -4.6155252e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.8336477e-05 -1.0069891e-05  2.8163035e-07 -6.4650027e-05
 -4.6155252e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.3280273e-05 -2.9431549e-05  6.1653232e-06 -5.6735411e-05
 -6.2897755e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00093277 -0.00033151  0.00079817  0.00117193 -0.00012127]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.09559411 -0.05387767  0.06637044  0.09340448 -0.01459421]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.09559411 -0.05387767  0.06637044  0.09340448 -0.01459421]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00950775  0.00206399 -0.01623511 -0.02086999 -0.00397478]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.22850196  0.05488573 -0.39576584 -0.72867393 -0.11198571]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.22850196  0.05488573 -0.39576584 -0.72867393 -0.11198571]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ -3.038199    3.4506793 -18.144318  -10.349722  -14.417948 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ -3.038199    3.4506793 -18.144318  -10.349722  -14.417948 ]
  [Layer 47] Output shape after mixer: (1, 1, 1024)
  [Layer 47] Output sample values after mixer: [ -3.038199    3.4506793 -18.144318  -10.349722  -14.417948 ]
  [Layer 47] Residual connection shape: (1, 1, 1024)
  [Layer 47] Residual connection sample values: [ -7.7926326 -10.703955  -20.685196  -29.598093   -2.5111809]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.06511387 -0.09649988 -0.18428758 -0.24119557 -0.02171283]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.06511387 -0.09649988 -0.18428758 -0.24119557 -0.02171283]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.06511387 -0.09649988 -0.18428758 -0.24119557 -0.02171283]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.0016861 -1.3870128 -1.0241876 -0.862836  -0.696112 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.0016861 -1.3870128 -1.0241876 -0.862836  -0.696112 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.07681827  0.19765253 -0.32099113 -1.0823113  -0.36631837]
  [FlaxMamba2] dt (step) sample values: [-1.394151   -0.91936356 -0.5535595   0.63837904  0.25481388]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5809656  -0.21160093  0.5649321   0.07681827  0.8314233 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01533056  0.03397501 -0.03519962 -0.12707125 -0.05821721]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01137091  0.00345743 -0.04723881 -0.20714937 -0.14049259]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.00565313  0.0017317  -0.02306163 -0.09288517 -0.06531986]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00565313  0.0017317  -0.02306163 -0.09288517 -0.06531986]
  [FlaxMamba2] B (step) sample values: [-0.08751494  0.01114496 -0.2655847  -0.07171465  0.02706036]
  [FlaxMamba2] C (step) sample values: [-0.08038537 -0.08821654 -0.27594215 -0.0349542  -0.04629187]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.7303779  -7.389056   -3.3796544  -1.802826  -17.760078 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [2.86118570e-03 8.56947227e-05 3.68944369e-03 3.62505428e-02
 1.20889276e-01]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9950613  0.999367   0.9876084  0.93673635 0.11683379]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00565313  0.0017317  -0.02306163 -0.09288517 -0.06531986]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.4155239e-06 -1.8026591e-07  4.2957408e-06  1.1599598e-06
 -4.3769191e-07]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.4155239e-06 -1.8026591e-07  4.2957408e-06  1.1599598e-06
 -4.3769191e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.6249999e-04  5.1182607e-04  8.7266439e-04 -2.1597878e-04
 -3.2502267e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00053939  0.00089837 -0.00100236 -0.00502595 -0.00340106]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00858009  0.00336145 -0.03380397 -0.13714078 -0.09630848]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00858009  0.00336145 -0.03380397 -0.13714078 -0.09630848]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00230858 -0.00093194  0.00914746  0.03511409  0.02230302]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0933207  -0.04219445  0.39216894  1.3248522   1.1458181 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0933207  -0.04219445  0.39216894  1.3248522   1.1458181 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [  3.1323738 -20.79491   -17.76179     3.5366735  10.731589 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [  3.1323738 -20.79491   -17.76179     3.5366735  10.731589 ]
  [Layer 48] Output shape after mixer: (1, 1, 1024)
  [Layer 48] Output sample values after mixer: [  3.1323738 -20.79491   -17.76179     3.5366735  10.731589 ]
  [Layer 48] Residual connection shape: (1, 1, 1024)
  [Layer 48] Residual connection sample values: [ -4.660259 -31.498865 -38.446983 -26.06142    8.220408]
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.07835117 -0.7650591  -0.7395297  -0.39572445  0.14216293]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 1, 1024)
[Mamba2LMHeadModel] Final backbone norm output sample values: [-0.07835117 -0.7650591  -0.7395297  -0.39572445  0.14216293]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 1, 50288)
[Mamba2LMHeadModel] Logits sample values: [90.435394 82.0428   93.14488  87.10173  87.08554 ]
[Mamba2LMHeadModel] Forward pass input_ids shape: (1, 1)
[Mamba2LMHeadModel] input_ids sample values: [432]
[Mamba2LMHeadModel] Embedding output shape: (1, 1, 1024)
[Mamba2LMHeadModel] Embedding sample values: [-0.0597229  -0.2578125  -0.17041016 -0.20568848 -0.01266479]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.07987311 -0.43880087 -0.24993119 -0.23506904 -0.01586091]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.07987311 -0.43880087 -0.24993119 -0.23506904 -0.01586091]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.07987311 -0.43880087 -0.24993119 -0.23506904 -0.01586091]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.35109326  0.13885419 -0.62938446 -0.5778886  -0.57917565]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.35109326  0.13885419 -0.62938446 -0.5778886  -0.57917565]
  [FlaxMamba2] xBC (step) sample values: [ 0.07741071 -0.66668236  0.25519916 -1.1728932   1.4597844 ]
  [FlaxMamba2] dt (step) sample values: [0.32134676 0.18518177 0.16986339 0.10924518 0.01459961]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [0.7266964  0.64639604 0.08863552 0.07741071 0.6819766 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01109627 -0.0285065   0.06180359 -0.00793287  0.07099612]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.05366829 -0.03609774  0.17453551 -0.21740553 -0.12614743]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.02755404 -0.01772314  0.09486414 -0.0969328  -0.05910069]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02755404 -0.01772314  0.09486414 -0.0969328  -0.05910069]
  [FlaxMamba2] B (step) sample values: [-0.22542466 -0.03909118  0.05813627  0.6480466  -0.01170386]
  [FlaxMamba2] C (step) sample values: [-0.24343966 -0.11635356 -0.1233292  -0.25520453  0.07111212]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.4383634 -1.0010935 -1.2128745 -1.1529616 -1.4844131]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.07605513 0.04066422 0.02879103 0.02906745 0.02277784]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9672099  0.96010876 0.96568274 0.96704173 0.9667535 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02755404 -0.01772314  0.09486414 -0.0969328  -0.05910069]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.7240587e-04 -8.1920502e-05  1.2183191e-04  1.3580637e-03
 -2.4526909e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.7240587e-04 -8.1920502e-05  1.2183191e-04  1.3580637e-03
 -2.4526909e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01965415 -0.003943   -0.00078894  0.04799742 -0.00070136]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.15353882  0.03904437  0.40243664 -0.6531857  -0.48621717]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.20079572  0.00864807  0.5651345  -0.8194315  -0.58757854]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.20079572  0.00864807  0.5651345  -0.8194315  -0.58757854]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02912396  0.00064203 -0.12365459  0.17019911  0.12221333]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-4.1021812e-03  7.4635449e-05 -1.4365267e-02  1.6213156e-02
  5.9610218e-02]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-4.1021812e-03  7.4635449e-05 -1.4365267e-02  1.6213156e-02
  5.9610218e-02]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.03662551 -0.04395    -0.10558385  0.03207394  0.04954346]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.03662551 -0.04395    -0.10558385  0.03207394  0.04954346]
  [Layer 1] Output shape after mixer: (1, 1, 1024)
  [Layer 1] Output sample values after mixer: [-0.03662551 -0.04395    -0.10558385  0.03207394  0.04954346]
  [Layer 1] Residual connection shape: (1, 1, 1024)
  [Layer 1] Residual connection sample values: [-0.09634841 -0.3017625  -0.275994   -0.17361453  0.03687866]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.18496424 -0.48650977 -0.41070256 -0.3504813   0.06445391]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18496424 -0.48650977 -0.41070256 -0.3504813   0.06445391]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18496424 -0.48650977 -0.41070256 -0.3504813   0.06445391]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.24558468 -0.8036945  -1.3042563   3.5855997  -0.3634516 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.24558468 -0.8036945  -1.3042563   3.5855997  -0.3634516 ]
  [FlaxMamba2] xBC (step) sample values: [-0.5496252   0.08866026  0.4686682  -1.1392263  -0.72592854]
  [FlaxMamba2] dt (step) sample values: [ 0.73349065  0.52427214 -0.07505465  0.33483124  0.03104797]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.432084    0.13903707  1.82328    -0.5496252  -0.35968962]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.38271585 -0.07646804 -0.33234555  0.85005563  0.06279051]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.3920466  -0.10639053 -0.44416195  0.70601267  0.06616842]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.15808287 -0.0503682  -0.17355615  0.47268924  0.03417838]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.15808287 -0.0503682  -0.17355615  0.47268924  0.03417838]
  [FlaxMamba2] B (step) sample values: [-0.00712907 -0.06361036 -0.03005301  0.08069625  0.01560257]
  [FlaxMamba2] C (step) sample values: [-0.02495602  0.22571185  0.42728034  0.09968796  0.0805993 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-12.692555   -19.429585    -0.22886811  -2.10566     -5.0388985 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10218917 0.05836779 0.02287026 0.08654966 0.05841977]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.27333924 0.3217238  0.9947794  0.83339787 0.7449998 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.15808287 -0.0503682  -0.17355615  0.47268924  0.03417838]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00011517  0.00102758  0.00048549 -0.0013036  -0.00025205]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00011517  0.00102758  0.00048549 -0.0013036  -0.00025205]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0001704   0.00101744  0.00038661 -0.00126    -0.00020755]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00313414  0.00091218  0.00194366 -0.01093847 -0.00046018]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.10224813 -0.0326646  -0.11375352  0.30416882  0.02232404]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.10224813 -0.0326646  -0.11375352  0.30416882  0.02232404]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01408928  0.00811817  0.03166818  1.0612108  -0.00332763]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00389336  0.00315379  0.01113522  0.24570392 -0.00134463]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00389336  0.00315379  0.01113522  0.24570392 -0.00134463]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.03599286  0.02390013  0.03638625 -0.00183138 -0.08685091]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.03599286  0.02390013  0.03638625 -0.00183138 -0.08685091]
  [Layer 2] Output shape after mixer: (1, 1, 1024)
  [Layer 2] Output sample values after mixer: [ 0.03599286  0.02390013  0.03638625 -0.00183138 -0.08685091]
  [Layer 2] Residual connection shape: (1, 1, 1024)
  [Layer 2] Residual connection sample values: [-0.06035556 -0.27786237 -0.23960775 -0.17544591 -0.04997225]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.1542736  -0.59599304 -0.4577923  -0.4799817  -0.12191395]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1542736  -0.59599304 -0.4577923  -0.4799817  -0.12191395]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1542736  -0.59599304 -0.4577923  -0.4799817  -0.12191395]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.592889   -0.98164165 -1.1078669  -0.8428255  -1.4759122 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.592889   -0.98164165 -1.1078669  -0.8428255  -1.4759122 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.307889   -1.0469126  -1.1914666   0.35971057  1.1677518 ]
  [FlaxMamba2] dt (step) sample values: [-0.8174726   0.17413178  1.6465728   0.04068268  0.23550493]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.11297893  0.21543829 -0.5940917   0.307889    1.192221  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02916916 -0.16863379  0.20058654  0.4511999  -0.10529698]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.07403    -0.24639258  0.1494696   0.40456903 -0.17213048]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.03564552 -0.10809529  0.08030972  0.2426544  -0.07867625]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03564552 -0.10809529  0.08030972  0.2426544  -0.07867625]
  [FlaxMamba2] B (step) sample values: [-0.24422424  0.2669662   0.1252058  -0.214642   -0.13537116]
  [FlaxMamba2] C (step) sample values: [-0.2779203   0.06607523 -0.03668898  0.43340057  0.26470885]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-20.926485    -0.880345    -0.67350245  -0.6461216   -0.27258503]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00556449 0.00575967 0.00023373 0.00545052 0.01301928]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.89007884 0.9949423  0.9998426  0.9964845  0.99645746]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03564552 -0.10809529  0.08030972  0.2426544  -0.07867625]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.8441671e-05 -5.2952517e-05 -2.4834464e-05  4.2574058e-05
  2.6850756e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.8441671e-05 -5.2952517e-05 -2.4834464e-05  4.2574058e-05
  2.6850756e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 6.0974678e-05 -6.3193694e-04 -1.6222052e-04  2.7577120e-05
  3.5802255e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00150507  0.0059249  -0.00916077 -0.00337732 -0.0069033 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0237999  -0.0708126   0.04785158  0.1688845  -0.06275604]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0237999  -0.0708126   0.04785158  0.1688845  -0.06275604]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00640605  0.01894678 -0.01316152 -0.04283585  0.017232  ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00147327  0.0038875  -0.00213334 -0.00772664  0.00461923]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00147327  0.0038875  -0.00213334 -0.00772664  0.00461923]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.18152264 -0.3348075   0.17156902 -0.07865891  0.22164118]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.18152264 -0.3348075   0.17156902 -0.07865891  0.22164118]
  [Layer 3] Output shape after mixer: (1, 1, 1024)
  [Layer 3] Output sample values after mixer: [-0.18152264 -0.3348075   0.17156902 -0.07865891  0.22164118]
  [Layer 3] Residual connection shape: (1, 1, 1024)
  [Layer 3] Residual connection sample values: [-0.2418782  -0.6126698  -0.06803873 -0.25410482  0.17166893]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.33340386 -0.731386   -0.07646307 -0.37240303  0.22265053]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.33340386 -0.731386   -0.07646307 -0.37240303  0.22265053]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.33340386 -0.731386   -0.07646307 -0.37240303  0.22265053]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.2470543   0.14588499 -1.2313033  -0.3236671   0.10879129]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.2470543   0.14588499 -1.2313033  -0.3236671   0.10879129]
  [FlaxMamba2] xBC (step) sample values: [-0.53104764 -0.46391752 -1.249819   -0.8179115   0.5204238 ]
  [FlaxMamba2] dt (step) sample values: [ 0.01742462  0.05164738  1.0329813  -0.14141564  0.4171712 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.72604185  0.05910201 -0.19602846 -0.53104764  0.89185596]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.05589674 -0.09171659  0.35237515 -0.49000376 -0.11547735]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.07794569 -0.0791586   0.31196988 -0.55470103  0.14355585]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.04049096 -0.0380136   0.1801208  -0.20234075  0.07692116]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04049096 -0.0380136   0.1801208  -0.20234075  0.07692116]
  [FlaxMamba2] B (step) sample values: [-0.25752583  0.0647812   0.05049235  0.00450981  0.01576772]
  [FlaxMamba2] C (step) sample values: [-0.27502504  0.01069194  0.22289298 -0.10625188  0.07648835]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.49070406 -0.5047996  -0.6491257  -0.5552266  -0.46572492]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04570297 0.05994008 0.21875644 0.03440326 0.46572286]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.97782296 0.9701955  0.8676209  0.9810797  0.8050115 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04049096 -0.0380136   0.1801208  -0.20234075  0.07692116]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.7656620e-04  1.1988129e-04  9.3438961e-05  8.3456589e-06
  2.9179057e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.7656620e-04  1.1988129e-04  9.3438961e-05  8.3456589e-06
  2.9179057e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.03218393 -0.00382947  0.00051171  0.00226966 -0.00075981]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0892802   0.01169742  0.0161003  -0.17985836  0.29843745]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.1161399  -0.01351892  0.1355835  -0.3140812   0.34946314]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.1161399  -0.01351892  0.1355835  -0.3140812   0.34946314]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.11250458 -0.00105791 -0.03772166  0.04267412  0.02004228]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04978535 -0.00050275 -0.01497132  0.0186514   0.0063786 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04978535 -0.00050275 -0.01497132  0.0186514   0.0063786 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.03274537 -0.23054728 -0.02119024  0.12784566 -0.19783032]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.03274537 -0.23054728 -0.02119024  0.12784566 -0.19783032]
  [Layer 4] Output shape after mixer: (1, 1, 1024)
  [Layer 4] Output sample values after mixer: [ 0.03274537 -0.23054728 -0.02119024  0.12784566 -0.19783032]
  [Layer 4] Residual connection shape: (1, 1, 1024)
  [Layer 4] Residual connection sample values: [-0.20913282 -0.84321713 -0.08922897 -0.12625916 -0.02616139]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.36012405 -1.2241423  -0.11322141 -0.21677533 -0.0427373 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.36012405 -1.2241423  -0.11322141 -0.21677533 -0.0427373 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.36012405 -1.2241423  -0.11322141 -0.21677533 -0.0427373 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.1601852 -0.660592  -0.8921877 -0.919154  -0.6812543]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.1601852 -0.660592  -0.8921877 -0.919154  -0.6812543]
  [FlaxMamba2] xBC (step) sample values: [-0.01039147 -1.2028353  -0.75413024  1.0489715   1.5645078 ]
  [FlaxMamba2] dt (step) sample values: [ 1.2941865   0.47250935 -0.79199713  0.7796581   0.9947988 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.0947375  -0.8512082  -2.9133613  -0.01039147 -0.65005153]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-1.0470265  -1.556443    0.23759246 -0.18255723 -0.06299541]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-1.110381   -1.797776    0.23024154 -0.1556865  -0.05205486]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.27515227 -0.25550354  0.12831533 -0.07179589 -0.02535016]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.27515227 -0.25550354  0.12831533 -0.07179589 -0.02535016]
  [FlaxMamba2] B (step) sample values: [-0.029109   -0.03570205 -0.21411854  0.05979422 -0.05638331]
  [FlaxMamba2] C (step) sample values: [-0.05997057 -0.02805977 -0.2543503  -0.27467516  0.2501579 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.07591622 -0.53187454 -0.04695368 -1.4938657  -3.6258397 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.4838314  0.02236158 0.01684612 0.0303976  0.04327424]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.96393573 0.9881769  0.99920934 0.9556057  0.85478485]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.27515227 -0.25550354  0.12831533 -0.07179589 -0.02535016]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0038752   0.00475292  0.02850502 -0.00796024  0.00750616]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0038752   0.00475292  0.02850502 -0.00796024  0.00750616]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01747721  0.00392001  0.5059332   0.04409898  0.00702629]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.5911516  -0.84995246 -0.5882634  -0.26128048 -0.21568522]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.97837126 -1.2095206  -0.4076862  -0.36231828 -0.2513603 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.97837126 -1.2095206  -0.4076862  -0.36231828 -0.2513603 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [0.2708711  0.2721446  0.105722   0.09495589 0.05753355]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.00849468 0.00901997 0.00717462 0.0070818  0.00466396]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.00849468 0.00901997 0.00717462 0.0070818  0.00466396]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.00171089 -0.02796981  0.06987199 -0.00256606  0.03099811]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.00171089 -0.02796981  0.06987199 -0.00256606  0.03099811]
  [Layer 5] Output shape after mixer: (1, 1, 1024)
  [Layer 5] Output sample values after mixer: [ 0.00171089 -0.02796981  0.06987199 -0.00256606  0.03099811]
  [Layer 5] Residual connection shape: (1, 1, 1024)
  [Layer 5] Residual connection sample values: [-0.20742193 -0.871187   -0.01935698 -0.12882523  0.00483673]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.270868   -0.9398431  -0.01970361 -0.16128132  0.0056429 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.270868   -0.9398431  -0.01970361 -0.16128132  0.0056429 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.270868   -0.9398431  -0.01970361 -0.16128132  0.0056429 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.0794046  -0.30254525 -0.93350077 -0.9004734  -1.9608318 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.0794046  -0.30254525 -0.93350077 -0.9004734  -1.9608318 ]
  [FlaxMamba2] xBC (step) sample values: [-0.79676634  0.12279274 -0.9522989  -0.05697001 -0.6439388 ]
  [FlaxMamba2] dt (step) sample values: [1.0767736 2.0664444 1.9499488 1.4783354 1.5129509]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.9053893   1.1230701   0.06041868 -0.79676634 -1.4638896 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.04199103  0.36730203 -0.02849922 -0.12579608  0.3173953 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.08923224  0.38129434  0.05273857 -0.13747668  0.4555789 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.04262684  0.22655946  0.02706446 -0.06402081  0.27879828]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04262684  0.22655946  0.02706446 -0.06402081  0.27879828]
  [FlaxMamba2] B (step) sample values: [ 0.03311712 -0.00535067 -0.26975644  0.03758967 -0.05355042]
  [FlaxMamba2] C (step) sample values: [ 0.529884    0.09871866 -0.2634518   0.03660336 -0.01622287]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.5109995  -0.28622514 -0.5421001  -0.39544863 -0.5985869 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.38800535 0.6795876  0.46483788 0.5022917  0.3736698 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.82014793 0.8232338  0.77725357 0.8198527  0.79957587]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04262684  0.22655946  0.02706446 -0.06402081  0.27879828]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.4773851e-04  8.8497021e-05  4.4616205e-03 -6.2171201e-04
  8.8569400e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.4773851e-04  8.8497021e-05  4.4616205e-03 -6.2171201e-04
  8.8569400e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00710328 -0.00599089  0.0191637   0.00487865  0.00825626]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.02694783 -0.02203991 -0.05786817  0.01315976  0.1948094 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02194729  0.23783511 -0.02682388 -0.06027531  0.514605  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02194729  0.23783511 -0.02682388 -0.06027531  0.514605  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00090593 -0.0305766   0.0070667   0.01568331 -0.12449409]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00028656 -0.00925552  0.00203386  0.00555134 -0.03207004]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00028656 -0.00925552  0.00203386  0.00555134 -0.03207004]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.33146393 -0.44713596  0.1520155   0.08646442  0.03445026]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.33146393 -0.44713596  0.1520155   0.08646442  0.03445026]
  [Layer 6] Output shape after mixer: (1, 1, 1024)
  [Layer 6] Output sample values after mixer: [ 0.33146393 -0.44713596  0.1520155   0.08646442  0.03445026]
  [Layer 6] Residual connection shape: (1, 1, 1024)
  [Layer 6] Residual connection sample values: [ 0.124042   -1.3183229   0.13265853 -0.04236081  0.03928698]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.1452625  -1.2539291   0.12253201 -0.05007349  0.03989829]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.1452625  -1.2539291   0.12253201 -0.05007349  0.03989829]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.1452625  -1.2539291   0.12253201 -0.05007349  0.03989829]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 2.2958276  -1.180482   -0.43365657 -1.8747137  -0.8127635 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 2.2958276  -1.180482   -0.43365657 -1.8747137  -0.8127635 ]
  [FlaxMamba2] xBC (step) sample values: [-1.0369145  -1.628478    0.04504382  0.6855743  -0.47801074]
  [FlaxMamba2] dt (step) sample values: [0.09365328 2.5048826  1.6037669  0.7400762  0.8523471 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.6795866  -1.3473907   0.35408875 -1.0369145  -1.152298  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.21717772 -0.32177964  0.02742513  0.18673778  0.1753068 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.2508081  -0.3930687  -0.10355631  0.1952064   0.17256212]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.10975979 -0.15839835 -0.04909957  0.10709945  0.09370706]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.10975979 -0.15839835 -0.04909957  0.10709945  0.09370706]
  [FlaxMamba2] B (step) sample values: [-0.00045375 -0.03301886 -0.15466033 -0.08847921  0.2247615 ]
  [FlaxMamba2] C (step) sample values: [-0.02563272  0.06632415 -0.0468567  -0.03739959  0.03119503]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-6.5957151e-02 -4.5478220e+00 -5.8281250e+00 -4.2033669e-01
 -1.9005252e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.53572786 0.34529597 0.1688537  0.27260977 0.40565598]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9652819  0.20797351 0.3737753  0.8917336  0.9992293 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.10975979 -0.15839835 -0.04909957  0.10709945  0.09370706]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.6681253e-05  1.9415546e-03  9.0942411e-03  5.2026995e-03
 -1.3216286e-02]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.6681253e-05  1.9415546e-03  9.0942411e-03  5.2026995e-03
 -1.3216286e-02]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.09623206  0.01236293 -0.02446211  0.00896232  0.07254448]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.07765637 -0.05403275 -0.04643475 -0.01206295  0.0320074 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.33214033 -0.4212878  -0.16027474  0.23625287  0.24927226]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.33214033 -0.4212878  -0.16027474  0.23625287  0.24927226]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.6927883   0.11685369  0.02733277 -0.05890534 -0.06225918]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.19613199  0.03992549  0.00559949 -0.01461743 -0.0338106 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.19613199  0.03992549  0.00559949 -0.01461743 -0.0338106 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.11390044 -0.3848138   0.40073708 -0.1904228   0.2864039 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.11390044 -0.3848138   0.40073708 -0.1904228   0.2864039 ]
  [Layer 7] Output shape after mixer: (1, 1, 1024)
  [Layer 7] Output sample values after mixer: [-0.11390044 -0.3848138   0.40073708 -0.1904228   0.2864039 ]
  [Layer 7] Residual connection shape: (1, 1, 1024)
  [Layer 7] Residual connection sample values: [ 0.01014157 -1.7031367   0.5333956  -0.23278362  0.32569087]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.0131403  -1.6519488   0.48346198 -0.29375464  0.35363796]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.0131403  -1.6519488   0.48346198 -0.29375464  0.35363796]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.0131403  -1.6519488   0.48346198 -0.29375464  0.35363796]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.9615145  -2.7682729  -2.1960926   0.28690618 -2.3779228 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.9615145  -2.7682729  -2.1960926   0.28690618 -2.3779228 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.5381477   0.30097488 -3.072468   -0.7550777  -1.1899669 ]
  [FlaxMamba2] dt (step) sample values: [ 0.8375772  3.0908055  1.2101498 -0.4414786  1.832341 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.8657562 -2.0932546  1.9844451  0.5381477 -2.1259277]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.17751162 -0.21797621  0.03464583 -0.08856337 -0.15744476]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.10011904 -0.13692153  0.10099104 -0.1854872  -0.2200058 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.05256338 -0.0637812   0.05304315 -0.0841668  -0.09795083]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05256338 -0.0637812   0.05304315 -0.0841668  -0.09795083]
  [FlaxMamba2] B (step) sample values: [-0.12350131  0.12431098 -0.24227795 -0.12901615  0.11868695]
  [FlaxMamba2] C (step) sample values: [ 0.02987516  0.0379766  -0.07519387 -0.07950467 -0.08142096]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6851114  -0.13800453 -0.41180432 -0.26783535 -0.12443344]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04298589 4.420292   0.8282437  0.27193195 2.9829447 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.97097933 0.54333985 0.71100605 0.9297561  0.6899211 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05256338 -0.0637812   0.05304315 -0.0841668  -0.09795083]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00027905  0.00028088 -0.00054742 -0.00029151  0.00026817]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00027905  0.00028088 -0.00054742 -0.00029151  0.00026817]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-4.6139336e-03 -2.3340167e-02  6.2942097e-05 -2.9268509e-02
  8.3459001e-03]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.11621856 -0.05045711  0.05255586 -0.07027686  0.0371094 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.08175688 -0.29068348  0.2523383  -0.38728383 -0.33181393]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.08175688 -0.29068348  0.2523383  -0.38728383 -0.33181393]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01977381  0.04752741 -0.05547231 -0.06347267  0.06696619]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00286369  0.00363304 -0.01305974 -0.01272656  0.00920757]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00286369  0.00363304 -0.01305974 -0.01272656  0.00920757]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.01764449  0.00289457 -0.14301334 -0.04204336  0.06104333]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.01764449  0.00289457 -0.14301334 -0.04204336  0.06104333]
  [Layer 8] Output shape after mixer: (1, 1, 1024)
  [Layer 8] Output sample values after mixer: [-0.01764449  0.00289457 -0.14301334 -0.04204336  0.06104333]
  [Layer 8] Residual connection shape: (1, 1, 1024)
  [Layer 8] Residual connection sample values: [-0.00750292 -1.7002422   0.39038223 -0.27482697  0.3867342 ]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.0076847  -1.3458216   0.29584768 -0.28223228  0.34501383]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0076847  -1.3458216   0.29584768 -0.28223228  0.34501383]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0076847  -1.3458216   0.29584768 -0.28223228  0.34501383]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.4020219 -2.8969574 -1.0158534 -0.6201841 -2.1015666]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.4020219 -2.8969574 -1.0158534 -0.6201841 -2.1015666]
  [FlaxMamba2] xBC (step) sample values: [ 1.9979417   2.1030085   0.25521734 -0.16904901  0.12248109]
  [FlaxMamba2] dt (step) sample values: [1.9325758 2.697431  2.2720993 2.1638136 1.7475115]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [1.138623  2.100877  3.729537  1.9979417 2.1194863]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-1.392504    0.3167405  -0.4400263  -0.1484069  -0.08056872]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-1.645922    0.40725565 -0.44419196 -0.14168158 -0.09923022]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.26608118  0.24452837 -0.1735647  -0.06583075 -0.04715547]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.26608118  0.24452837 -0.1735647  -0.06583075 -0.04715547]
  [FlaxMamba2] B (step) sample values: [-0.05096645 -0.04782123  0.15343441 -0.07547771  0.49038166]
  [FlaxMamba2] C (step) sample values: [-0.0466542  -0.2453076   0.30924067 -0.17354555 -0.09053075]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17008033 -0.11351943 -0.10539922 -0.5864362  -0.14965628]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [2.440697  3.532755  4.0772843 1.0875509 2.07482  ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.6602646  0.66962576 0.65067655 0.52846473 0.7330731 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.26608118  0.24452837 -0.1735647  -0.06583075 -0.04715547]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.03309881  0.03105623 -0.09964392  0.049017   -0.31846538]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.03309881  0.03105623 -0.09964392  0.049017   -0.31846538]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01644846  0.02880407 -0.30735585  0.26294255 -0.31778646]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.6055468   0.25765407 -0.22102994 -0.08812233  0.07221089]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-1.3185029   0.91286016 -0.6860911  -0.26451376 -0.0541407 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-1.3185029   0.91286016 -0.6860911  -0.26451376 -0.0541407 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.36508417 -0.13831928  0.1852791   0.05737381  0.01239576]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03085574 -0.02178946  0.01951675  0.00693267  0.00150371]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03085574 -0.02178946  0.01951675  0.00693267  0.00150371]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.04127146  0.19793507  0.03417351 -0.22664402 -0.00876655]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.04127146  0.19793507  0.03417351 -0.22664402 -0.00876655]
  [Layer 9] Output shape after mixer: (1, 1, 1024)
  [Layer 9] Output sample values after mixer: [ 0.04127146  0.19793507  0.03417351 -0.22664402 -0.00876655]
  [Layer 9] Residual connection shape: (1, 1, 1024)
  [Layer 9] Residual connection sample values: [ 0.03376853 -1.502307    0.42455575 -0.501471    0.37796763]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.03617223 -1.229427    0.3391132  -0.5283953   0.34276885]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.03617223 -1.229427    0.3391132  -0.5283953   0.34276885]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.03617223 -1.229427    0.3391132  -0.5283953   0.34276885]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.6407769 -0.1023861 -1.2919041 -4.6026134 -1.4483027]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-2.6407769 -0.1023861 -1.2919041 -4.6026134 -1.4483027]
  [FlaxMamba2] xBC (step) sample values: [ 1.1222445  -2.3390756  -0.38966286  2.1203399   1.8144724 ]
  [FlaxMamba2] dt (step) sample values: [0.51345766 0.8666976  1.6483817  0.9129606  0.02927491]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.820525   -2.0003026   0.16141228  1.1222445   1.5775404 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.10187476  0.5804151   0.29496896  0.43312573 -0.699535  ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.27216285  0.5564741   0.2570051   1.0371296  -0.65064585]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.11767673  0.35371515  0.14492516  0.7657084  -0.22307003]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.11767673  0.35371515  0.14492516  0.7657084  -0.22307003]
  [FlaxMamba2] B (step) sample values: [-0.22795883  0.26145923  0.09530512 -0.17579418 -0.16572301]
  [FlaxMamba2] C (step) sample values: [-0.21054868 -0.25088906 -0.26631752 -0.23779109  0.0058581 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.08535489 -0.07711172 -0.08452541 -0.0546804  -0.06966463]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.7777138  0.20709571 0.40084007 2.1380079  0.5779634 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8592146  0.9841573  0.96668637 0.8896678  0.9605362 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.11767673  0.35371515  0.14492516  0.7657084  -0.22307003]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.04768797 -0.05469611 -0.01993741  0.03677536  0.03466852]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.04768797 -0.05469611 -0.01993741  0.03677536  0.03466852]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.12321891 -0.93290114 -0.04573561  0.4596471  -0.05929752]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-2.774418    0.8850171  -0.84582424 16.197563   -1.4464871 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-3.347403    2.6073067  -0.14016289 19.925907   -2.532647  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-3.347403    2.6073067  -0.14016289 19.925907   -2.532647  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.5883712  -0.12664892  0.03902765 -0.9103337   0.69789183]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01174664 -0.00540521  0.0018266  -0.03276943  0.03045444]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01174664 -0.00540521  0.0018266  -0.03276943  0.03045444]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.16369556  0.08746734 -0.08272232 -0.1396872   0.35204962]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.16369556  0.08746734 -0.08272232 -0.1396872   0.35204962]
  [Layer 10] Output shape after mixer: (1, 1, 1024)
  [Layer 10] Output sample values after mixer: [ 0.16369556  0.08746734 -0.08272232 -0.1396872   0.35204962]
  [Layer 10] Residual connection shape: (1, 1, 1024)
  [Layer 10] Residual connection sample values: [ 0.1974641  -1.4148397   0.3418334  -0.64115816  0.73001724]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.13257515 -0.77071583  0.18062311 -0.4700494   0.433789  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.13257515 -0.77071583  0.18062311 -0.4700494   0.433789  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.13257515 -0.77071583  0.18062311 -0.4700494   0.433789  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.0238798 -1.6836314 -2.3646872  1.5591959 -1.0469123]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.0238798 -1.6836314 -2.3646872  1.5591959 -1.0469123]
  [FlaxMamba2] xBC (step) sample values: [-6.4846438e-01 -6.5557927e-02 -9.1167196e-05 -9.0671521e-01
  3.7215811e-01]
  [FlaxMamba2] dt (step) sample values: [-2.3844457  -0.90829843 -0.56074417  0.50574076  0.4946385 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.44022954 -1.1525992  -1.5224556  -0.6484644  -0.5750426 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.14793658  0.00501138 -0.02445623  0.14104694 -0.29166487]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.29442096  0.19617349 -0.00053045  0.24846882 -0.17667463]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.1687262   0.10767702 -0.00026515  0.13958968 -0.08055407]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.1687262   0.10767702 -0.00026515  0.13958968 -0.08055407]
  [FlaxMamba2] B (step) sample values: [-0.27763933 -0.0364242   0.7400634  -0.04443929 -0.14316398]
  [FlaxMamba2] C (step) sample values: [-0.11671483 -0.01756009 -0.05262931 -0.03009841 -0.27454826]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.25934154 -0.12614636 -0.10356269 -0.23775288 -0.43051487]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02092924 0.02901253 0.08925562 0.8393236  1.0048716 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9945869  0.9963469  0.990799   0.81909794 0.64881206]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.1687262   0.10767702 -0.00026515  0.13958968 -0.08055407]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00098043 -0.00012863  0.00261339 -0.00015693 -0.00050556]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00098043 -0.00012863  0.00261339 -0.00015693 -0.00050556]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.18789409  0.01198246  0.02114946 -0.08163943  0.10931782]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [0.33215803 0.31672284 0.33587548 0.17295215 0.47066322]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.20002872 -0.02290601  0.33671182 -0.2673338   0.72474235]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.20002872 -0.02290601  0.33671182 -0.2673338   0.72474235]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.15068097  0.00603991 -0.06839944 -0.3443973  -0.19713509]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00637939  0.00189337 -0.03846601 -0.03640628 -0.02432399]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00637939  0.00189337 -0.03846601 -0.03640628 -0.02432399]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.4632924  -0.08237483  0.03029899 -0.19202226  0.1892371 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.4632924  -0.08237483  0.03029899 -0.19202226  0.1892371 ]
  [Layer 11] Output shape after mixer: (1, 1, 1024)
  [Layer 11] Output sample values after mixer: [-0.4632924  -0.08237483  0.03029899 -0.19202226  0.1892371 ]
  [Layer 11] Residual connection shape: (1, 1, 1024)
  [Layer 11] Residual connection sample values: [-0.2658283  -1.4972146   0.37213242 -0.8331804   0.91925436]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.14006408 -0.6284584   0.14283784 -0.49784547  0.40983644]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.14006408 -0.6284584   0.14283784 -0.49784547  0.40983644]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.14006408 -0.6284584   0.14283784 -0.49784547  0.40983644]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.7064892  -0.2618267   0.21723375 -0.84115344 -0.3802097 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.7064892  -0.2618267   0.21723375 -0.84115344 -0.3802097 ]
  [FlaxMamba2] xBC (step) sample values: [0.28649288 1.4184653  0.53408605 1.1387478  1.801244  ]
  [FlaxMamba2] dt (step) sample values: [-0.6140621  -0.00657651 -0.31634018 -1.8516778   0.53044015]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5587608  -0.75309384 -2.45501     0.28649288  0.31702283]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.6748728   0.61194485 -0.06621177  0.09581138 -0.75062895]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.7420725  -0.2225278  -0.13097008  0.05159141 -0.9172549 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.23935631 -0.09893509 -0.06120287  0.02646098 -0.26189238]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.23935631 -0.09893509 -0.06120287  0.02646098 -0.26189238]
  [FlaxMamba2] B (step) sample values: [ 0.12110645 -0.17963964  0.09265716  0.5022532  -0.0223524 ]
  [FlaxMamba2] C (step) sample values: [ 0.3894146  -0.14491506  0.08143579 -0.2766248   1.2508209 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.16087165 -0.14748003 -0.27125728 -0.11553253 -0.09015273]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.6486281  0.57136333 0.9312303  0.4685287  0.11590053]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.90091366 0.9191879  0.7767762  0.94730866 0.98960567]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.23935631 -0.09893509 -0.06120287  0.02646098 -0.26189238]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01880217  0.02788963 -0.01438532 -0.07797643  0.00347028]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01880217  0.02788963 -0.01438532 -0.07797643  0.00347028]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.04741718  0.03223681  0.04182547 -0.20046577 -0.02759761]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.52460223 -1.2451642  -0.0890172  -0.03576079  2.6474771 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.91304433 -1.405722   -0.18834096  0.0071817   2.2224622 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.91304433 -1.405722   -0.18834096  0.0071817   2.2224622 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.43194556  0.16007277 -0.02267029 -0.00182008 -0.34313518]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.06068565  0.01314042 -0.00364414 -0.00055223 -0.04147655]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.06068565  0.01314042 -0.00364414 -0.00055223 -0.04147655]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.11670112 -0.49789518  0.17219135  0.05157065  0.4634146 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.11670112 -0.49789518  0.17219135  0.05157065  0.4634146 ]
  [Layer 12] Output shape after mixer: (1, 1, 1024)
  [Layer 12] Output sample values after mixer: [-0.11670112 -0.49789518  0.17219135  0.05157065  0.4634146 ]
  [Layer 12] Residual connection shape: (1, 1, 1024)
  [Layer 12] Residual connection sample values: [-0.38252944 -1.9951098   0.5443238  -0.7816098   1.382669  ]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.14658986 -0.6243479   0.16214354 -0.32225022  0.47529027]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.14658986 -0.6243479   0.16214354 -0.32225022  0.47529027]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.14658986 -0.6243479   0.16214354 -0.32225022  0.47529027]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.5060891  -0.6817284  -0.55237705 -0.30827522  0.0962225 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.5060891  -0.6817284  -0.55237705 -0.30827522  0.0962225 ]
  [FlaxMamba2] xBC (step) sample values: [-0.8990746   0.36125487  0.83371645  0.14799537 -1.031434  ]
  [FlaxMamba2] dt (step) sample values: [ 1.2258385  -0.9129032   0.45469904  0.7107159  -0.36554834]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.12189782  0.5624532  -0.96905917 -0.8990746   0.40596503]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.32088125  0.2850267   0.06324552  0.01338603 -0.56702507]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.2588085   0.2663652   0.07112668  0.00167491 -0.59746635]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.14605686  0.15081605  0.03682756  0.00083815 -0.2120549 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.14605686  0.15081605  0.03682756  0.00083815 -0.2120549 ]
  [FlaxMamba2] B (step) sample values: [ 0.54361427 -0.23805788  0.13448629 -0.1184888  -0.2133392 ]
  [FlaxMamba2] C (step) sample values: [ 0.16268438 -0.16163562  0.10280921  0.18768263 -0.2311731 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.02338035 -1.090337   -0.5085105  -0.67845345 -0.02513249]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.16870224 0.00403569 0.01338368 0.01066577 0.1081925 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9960635  0.9956094  0.99321735 0.99278986 0.99728453]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.14605686  0.15081605  0.03682756  0.00083815 -0.2120549 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01339472 -0.00586578  0.00331376 -0.00291958 -0.0052567 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01339472 -0.00586578  0.00331376 -0.00291958 -0.0052567 ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.07935849  0.09616087 -0.2785197   0.01987506 -0.06344809]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0267855   0.04918319  0.03317609  0.00437315  0.3349422 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04365555  0.03176343  0.02892238  0.00427634  0.35943523]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04365555  0.03176343  0.02892238  0.00427634  0.35943523]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00830964 -0.00727306 -0.00583626 -0.00055834  0.01812422]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00264834 -0.00153365 -0.00416928 -0.00094189  0.00663684]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00264834 -0.00153365 -0.00416928 -0.00094189  0.00663684]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.35448846  0.27536818 -0.09224173 -0.18655656  0.10338545]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.35448846  0.27536818 -0.09224173 -0.18655656  0.10338545]
  [Layer 13] Output shape after mixer: (1, 1, 1024)
  [Layer 13] Output sample values after mixer: [ 0.35448846  0.27536818 -0.09224173 -0.18655656  0.10338545]
  [Layer 13] Residual connection shape: (1, 1, 1024)
  [Layer 13] Residual connection sample values: [-0.02804098 -1.7197416   0.45208207 -0.96816635  1.4860544 ]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.00849809 -0.44994357  0.11567524 -0.33201128  0.4218975 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.00849809 -0.44994357  0.11567524 -0.33201128  0.4218975 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.00849809 -0.44994357  0.11567524 -0.33201128  0.4218975 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.17590658 -0.7978059   0.30063543 -0.13314411  0.7265864 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.17590658 -0.7978059   0.30063543 -0.13314411  0.7265864 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.4262729 -1.0928919 -1.0111479 -2.290793   0.8292499]
  [FlaxMamba2] dt (step) sample values: [ 1.1172678  -0.60154104  1.1500356   1.7164015   1.3108029 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.00432411 -0.33581305 -0.95331764  0.4262729   0.2673232 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.09299253 -0.37758145 -0.8127967   0.5915522  -0.22898959]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02255796 -0.4269894  -1.0045692   0.5439448  -0.24276827]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.01115177 -0.16859482 -0.26926875  0.34416994 -0.10672197]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01115177 -0.16859482 -0.26926875  0.34416994 -0.10672197]
  [FlaxMamba2] B (step) sample values: [-0.04903227  0.06778301 -0.10689732 -0.03437481 -0.11378574]
  [FlaxMamba2] C (step) sample values: [-0.17862101  0.07737574 -0.16962616 -0.11338398 -0.17835313]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-7.2744994  -0.03854768 -2.202407   -0.01377147 -5.3377523 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06150467 0.03313332 0.03666787 0.2505395  0.05911474]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.6392781  0.9987236  0.9224173  0.9965556  0.72939503]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01115177 -0.16859482 -0.26926875  0.34416994 -0.10672197]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.3630542e-05 -4.6491412e-05  7.3319359e-05  2.3577199e-05
  7.8044031e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.3630542e-05 -4.6491412e-05  7.3319359e-05  2.3577199e-05
  7.8044031e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.7872773e-04 -3.9140949e-05 -3.3348930e-04  4.0534578e-04
 -4.8528850e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00189187 -0.01618496 -0.02996169  0.02588223 -0.0052424 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00688455 -0.14886884 -0.24187581  0.2967435  -0.08923244]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00688455 -0.14886884 -0.24187581  0.2967435  -0.08923244]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0005524   0.03687701 -0.04178271 -0.01844165 -0.04370246]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00145535  0.06769523 -0.05262338 -0.03363199 -0.10130637]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00145535  0.06769523 -0.05262338 -0.03363199 -0.10130637]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.31811047  0.308316    0.05885663 -0.6309517   0.13722393]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.31811047  0.308316    0.05885663 -0.6309517   0.13722393]
  [Layer 14] Output shape after mixer: (1, 1, 1024)
  [Layer 14] Output sample values after mixer: [-0.31811047  0.308316    0.05885663 -0.6309517   0.13722393]
  [Layer 14] Residual connection shape: (1, 1, 1024)
  [Layer 14] Residual connection sample values: [-0.34615144 -1.4114256   0.5109387  -1.599118    1.6232784 ]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.12416214 -0.41647303  0.15135236 -0.67993283  0.5434727 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.12416214 -0.41647303  0.15135236 -0.67993283  0.5434727 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.12416214 -0.41647303  0.15135236 -0.67993283  0.5434727 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.0154564   2.2819846  -0.18762618 -0.7326231  -4.3170586 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.0154564   2.2819846  -0.18762618 -0.7326231  -4.3170586 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.15227515 -0.82988805  0.0535567  -1.6644473   0.29288378]
  [FlaxMamba2] dt (step) sample values: [ 1.2659284   0.03487733 -0.9659027  -0.7993383   0.45282575]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-3.226898    0.95938224  1.548849    0.15227515 -0.2153511 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.0159322   0.03726314  0.22841242 -0.32171994 -0.22658099]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.35211384  0.01307796  1.5536077   0.12090701 -0.24006976]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.1453772   0.00658174  1.282401    0.06410369 -0.10569531]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.1453772   0.00658174  1.282401    0.06410369 -0.10569531]
  [FlaxMamba2] B (step) sample values: [-0.10093828 -0.12814468 -0.07997988 -0.05622519 -0.1229673 ]
  [FlaxMamba2] C (step) sample values: [-0.02551093  0.02524724  0.01196333 -0.04463166 -0.05944682]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.4414158  -0.05923919 -0.7389757  -0.00508607 -0.00871955]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.20469926 0.46646184 0.00839056 0.02205333 0.21137209]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.60667866 0.9727455  0.99381876 0.9998878  0.99815863]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.1453772   0.00658174  1.282401    0.06410369 -0.10569531]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00300378 0.00381341 0.00238009 0.00167318 0.00365934]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00300378 0.00381341 0.00238009 0.00167318 0.00365934]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00539624 0.00789121 0.00188989 0.00459657 0.00865576]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01675873  0.00226163  0.14224702  0.02415875 -0.00464121]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.27637357  0.01401531  2.4323606   0.1386352  -0.19339207]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.27637357  0.01401531  2.4323606   0.1386352  -0.19339207]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.07462734  0.02902029 -0.20684288 -0.03297073  0.01098998]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.06043538  0.01715337 -0.0359341  -0.0150501   0.009081  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.06043538  0.01715337 -0.0359341  -0.0150501   0.009081  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.41218966 -0.31917378  0.5004658   0.09987512  0.21600242]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.41218966 -0.31917378  0.5004658   0.09987512  0.21600242]
  [Layer 15] Output shape after mixer: (1, 1, 1024)
  [Layer 15] Output sample values after mixer: [ 0.41218966 -0.31917378  0.5004658   0.09987512  0.21600242]
  [Layer 15] Residual connection shape: (1, 1, 1024)
  [Layer 15] Residual connection sample values: [ 0.06603822 -1.7305994   1.0114045  -1.4992429   1.8392808 ]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.0154573  -0.33475047  0.1823208  -0.44524732  0.4069966 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.0154573  -0.33475047  0.1823208  -0.44524732  0.4069966 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.0154573  -0.33475047  0.1823208  -0.44524732  0.4069966 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.0896928   1.2109351  -4.9619155   0.42913157  0.48028153]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.0896928   1.2109351  -4.9619155   0.42913157  0.48028153]
  [FlaxMamba2] xBC (step) sample values: [-0.18268262  0.22115201 -1.0751145  -0.2342294  -0.05163282]
  [FlaxMamba2] dt (step) sample values: [ 0.64494216 -0.3285139   1.7285095   0.33008698  0.91865355]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.8545147   1.4790857   2.1004107  -0.18268262  0.34328327]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.20806919 -0.03689712 -0.26327628  0.5844667  -0.00981575]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.20624577 -0.02809279 -0.12655753  0.5462892  -0.00228554]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.11371967 -0.01384911 -0.05927989  0.3459509  -0.00114147]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.11371967 -0.01384911 -0.05927989  0.3459509  -0.00114147]
  [FlaxMamba2] B (step) sample values: [ 0.13653645 -0.07716402  0.028167   -0.03713972  0.00110676]
  [FlaxMamba2] C (step) sample values: [ 0.03915583 -0.04517554 -0.0437172  -0.2761974  -0.1338972 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.1348554e-03 -3.0370306e-03 -2.7156286e+00 -4.1511287e-03
 -4.2925543e-01]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.14747778 0.04810809 0.12623063 0.03739108 0.00281775]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99983263 0.9998539  0.7097833  0.9998448  0.9987912 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.11371967 -0.01384911 -0.05927989  0.3459509  -0.00114147]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.2898698e-03 -1.2941273e-03  4.7239222e-04 -6.2287482e-04
  1.8561577e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.2898698e-03 -1.2941273e-03  4.7239222e-04 -6.2287482e-04
  1.8561577e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.03565634  0.09318537  0.03208691  0.00103092 -0.00240103]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00818621  0.02607957 -0.15335749  0.09668609  0.02855095]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01828045  0.02930275 -0.13956092  0.01617088  0.02881661]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01828045  0.02930275 -0.13956092  0.01617088  0.02881661]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01490667  0.02733895  0.00481339  0.00420298  0.0085506 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01252684  0.01307976  0.00927003  0.00140906  0.00850579]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01252684  0.01307976  0.00927003  0.00140906  0.00850579]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.2971878   0.16326728 -0.0320686  -0.03225157 -0.20935833]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.2971878   0.16326728 -0.0320686  -0.03225157 -0.20935833]
  [Layer 16] Output shape after mixer: (1, 1, 1024)
  [Layer 16] Output sample values after mixer: [ 0.2971878   0.16326728 -0.0320686  -0.03225157 -0.20935833]
  [Layer 16] Residual connection shape: (1, 1, 1024)
  [Layer 16] Residual connection sample values: [ 0.36322603 -1.5673321   0.9793359  -1.5314945   1.6299225 ]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.12173638 -0.4519905   0.28218558 -0.58825547  0.5032197 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.12173638 -0.4519905   0.28218558 -0.58825547  0.5032197 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.12173638 -0.4519905   0.28218558 -0.58825547  0.5032197 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-4.934398   -2.0508935   0.43566686 -0.96935135 -1.9960653 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-4.934398   -2.0508935   0.43566686 -0.96935135 -1.9960653 ]
  [FlaxMamba2] xBC (step) sample values: [-0.16899     0.9229756   0.80665934  0.04802825 -0.9839718 ]
  [FlaxMamba2] dt (step) sample values: [1.951261   1.43885    0.51413757 0.9906607  0.3490704 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 2.4675014   1.2512957   0.33920607 -0.16899    -1.3282504 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.79019696 -0.03668166  0.22095375  0.00848234 -0.24246491]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.8852287  -0.01455641  0.10651283  0.04290617 -0.14725007]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.25857124 -0.00722523  0.05608999  0.02191325 -0.06821416]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.25857124 -0.00722523  0.05608999  0.02191325 -0.06821416]
  [FlaxMamba2] B (step) sample values: [-0.0517652   0.17871724 -0.27741045 -0.12373134 -0.19242205]
  [FlaxMamba2] C (step) sample values: [-0.1674646  -0.07869981 -0.27839547 -0.21394289 -0.06904955]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.3863302  -0.87734115 -1.4026718  -0.6827737  -0.39046   ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.7189058  0.31100535 0.20892577 0.5697375  0.42698342]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.36911726 0.761201   0.74598163 0.67773306 0.8464366 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.25857124 -0.00722523  0.05608999  0.02191325 -0.06821416]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00962255 -0.03322146  0.05156738  0.02300022  0.03576902]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00962255 -0.03322146  0.05156738  0.02300022  0.03576902]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00701236 -0.02896728  0.03713766  0.0249158   0.02284789]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.10071787  0.026895   -0.00157896  0.03091028 -0.01929499]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.78175795  0.00786475  0.14615412  0.08862667 -0.19896144]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.78175795  0.00786475  0.14615412  0.08862667 -0.19896144]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02755568 -0.00183818  0.03866482 -0.0236262   0.04750457]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01080596 -0.00073563  0.0162774  -0.0122452   0.02270137]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01080596 -0.00073563  0.0162774  -0.0122452   0.02270137]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.29943955 -0.12937327 -0.254355    0.36598036 -1.1461653 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.29943955 -0.12937327 -0.254355    0.36598036 -1.1461653 ]
  [Layer 17] Output shape after mixer: (1, 1, 1024)
  [Layer 17] Output sample values after mixer: [-0.29943955 -0.12937327 -0.254355    0.36598036 -1.1461653 ]
  [Layer 17] Residual connection shape: (1, 1, 1024)
  [Layer 17] Residual connection sample values: [ 0.06378648 -1.6967055   0.7249809  -1.1655141   0.48375726]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.01437749 -0.3306676   0.13921107 -0.31925938  0.09649812]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.01437749 -0.3306676   0.13921107 -0.31925938  0.09649812]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.01437749 -0.3306676   0.13921107 -0.31925938  0.09649812]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.08738346 -0.52432007 -0.81092423 -0.5786832  -0.3866445 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.08738346 -0.52432007 -0.81092423 -0.5786832  -0.3866445 ]
  [FlaxMamba2] xBC (step) sample values: [-0.6630224   1.6619896   0.60713905 -0.19244358 -0.03286516]
  [FlaxMamba2] dt (step) sample values: [ 2.2493207   2.612196    2.143737    2.2452943  -0.16002376]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6895262  -0.5580068  -0.22164887 -0.6630224  -0.87735415]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.14282054 -0.85528076 -0.14109866 -0.0051179  -0.10955541]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.15217417 -1.25323    -0.12985294  0.0254302  -0.1618015 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.08186518 -0.27839443 -0.06071693  0.01287676 -0.07437006]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.08186518 -0.27839443 -0.06071693  0.01287676 -0.07437006]
  [FlaxMamba2] B (step) sample values: [-0.0206353   0.02732481  0.06263363 -0.11614414  0.02837231]
  [FlaxMamba2] C (step) sample values: [ 0.01685783  0.11565679  0.01242951 -0.1916603   0.03601071]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.3194940e-03 -6.5335674e+00 -1.4897179e+01 -1.3796333e-03
 -2.0873186e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.84769857 3.7473857  3.6172497  0.7396806  0.11794415]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.9803573e-01 2.3271374e-11 3.9559789e-24 9.9898005e-01 9.9975383e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.08186518 -0.27839443 -0.06071693  0.01287676 -0.07437006]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00143203  0.00189626  0.00434659 -0.00806005  0.00196895]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00143203  0.00189626  0.00434659 -0.00806005  0.00196895]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0022628  -0.00398076  0.09640037 -0.0492217   0.01599992]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.1729619  -1.4885008   0.10192227 -0.13620222 -0.302972  ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.17944309 -1.4664606   0.10672916 -0.13722165 -0.29708418]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.17944309 -1.4664606   0.10672916 -0.13722165 -0.29708418]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00749785  0.2859078  -0.02663065  0.02852613  0.04646619]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0082849   0.0773541  -0.00648865  0.01618454  0.01238878]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0082849   0.0773541  -0.00648865  0.01618454  0.01238878]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.04162764 -0.17312211  0.37551528 -0.18287684 -0.09887409]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.04162764 -0.17312211  0.37551528 -0.18287684 -0.09887409]
  [Layer 18] Output shape after mixer: (1, 1, 1024)
  [Layer 18] Output sample values after mixer: [ 0.04162764 -0.17312211  0.37551528 -0.18287684 -0.09887409]
  [Layer 18] Residual connection shape: (1, 1, 1024)
  [Layer 18] Residual connection sample values: [ 0.10541411 -1.8698275   1.1004962  -1.3483909   0.38488317]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.02861618 -0.42153803  0.2507897  -0.45267868  0.09275887]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.02861618 -0.42153803  0.2507897  -0.45267868  0.09275887]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.02861618 -0.42153803  0.2507897  -0.45267868  0.09275887]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.7254872  -0.5389154  -0.52264595 -1.5021996  -1.5443478 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.7254872  -0.5389154  -0.52264595 -1.5021996  -1.5443478 ]
  [FlaxMamba2] xBC (step) sample values: [-2.6270058   1.8048857   0.14850402  0.80017203  0.8015818 ]
  [FlaxMamba2] dt (step) sample values: [0.8941129  0.4650539  1.3608552  0.7422916  0.65201694]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.531876   -1.0118886  -0.58679503 -2.6270058   1.2369012 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.0434639   0.34419638  0.05869304 -0.7715937   0.12192353]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.09488602  0.34469754  0.0448991  -0.9792353   0.12073144]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.04519386  0.2017622   0.02295345 -0.26737386  0.06400532]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04519386  0.2017622   0.02295345 -0.26737386  0.06400532]
  [FlaxMamba2] B (step) sample values: [ 0.02702027 -0.09354341  1.0595347  -0.05389521  0.57810485]
  [FlaxMamba2] C (step) sample values: [-0.12834519  0.01182921 -0.11419027 -0.00060757  0.09807544]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17394373 -1.5063176  -1.5724528  -0.19826236 -0.07681109]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.997024   0.41898963 0.89784306 2.0338728  0.61298305]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.706544   0.5319895  0.24370036 0.66815144 0.9540074 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04519386  0.2017622   0.02295345 -0.26737386  0.06400532]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00243867  0.00844259 -0.09562641  0.00486422 -0.05217582]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00243867  0.00844259 -0.09562641  0.00486422 -0.05217582]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01243902  0.02706257 -0.17886655  0.0299113  -0.03847099]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.32294655  0.61728954  0.07931715 -0.81074923  0.33083382]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.39176235  0.92450887  0.11426792 -1.2178742   0.42829347]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.39176235  0.92450887  0.11426792 -1.2178742   0.42829347]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.19151048 -0.1835686  -0.02223042  0.33314592 -0.11634897]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03592711 -0.05953749 -0.00858508  0.05297924 -0.06845795]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03592711 -0.05953749 -0.00858508  0.05297924 -0.06845795]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.83320516  0.15995395  1.0539728   0.03630112 -0.02015458]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.83320516  0.15995395  1.0539728   0.03630112 -0.02015458]
  [Layer 19] Output shape after mixer: (1, 1, 1024)
  [Layer 19] Output sample values after mixer: [-0.83320516  0.15995395  1.0539728   0.03630112 -0.02015458]
  [Layer 19] Residual connection shape: (1, 1, 1024)
  [Layer 19] Residual connection sample values: [-0.7277911  -1.7098736   2.154469   -1.3120898   0.36472857]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.10709053 -0.23028523  0.290373   -0.23625465  0.05242471]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.10709053 -0.23028523  0.290373   -0.23625465  0.05242471]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.10709053 -0.23028523  0.290373   -0.23625465  0.05242471]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.05142972 -0.76134825  0.00945989  0.56429565  0.7333604 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.05142972 -0.76134825  0.00945989  0.56429565  0.7333604 ]
  [FlaxMamba2] xBC (step) sample values: [-0.03154976 -1.0853176  -0.66868275  0.54812217 -1.0764427 ]
  [FlaxMamba2] dt (step) sample values: [-0.37631127  1.5501952   0.02688627  0.6329041   0.6559098 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.02312712 -0.19641498  0.3090722  -0.03154976 -1.0546438 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00054452  0.34611914 -0.26833138  0.12091789 -0.18684891]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01395896  0.30794165 -0.4478968   0.09987602 -0.2333577 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.00693077  0.17749226 -0.17461747  0.05242974 -0.10312634]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00693077  0.17749226 -0.17461747  0.05242974 -0.10312634]
  [FlaxMamba2] B (step) sample values: [ 0.03187287  0.01362749  0.00105767 -0.17381427 -0.05306077]
  [FlaxMamba2] C (step) sample values: [-0.03658877  0.13864256  0.06660423  0.05286984 -0.00206512]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-3.08577806e-01 -2.93056536e+00 -5.29621363e+00 -1.23260975e+01
 -8.15932546e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00487292 0.11808157 0.06100851 0.13909402 0.07975744]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9984974  0.7074801  0.72389126 0.18005615 0.9993494 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00693077  0.17749226 -0.17461747  0.05242974 -0.10312634]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0764456e-06 -4.6024275e-07 -3.5720941e-08  5.8702467e-06
  1.7920265e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0764456e-06 -4.6024275e-07 -3.5720941e-08  5.8702467e-06
  1.7920265e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.2127158e-04 -2.4489057e-04 -1.9197057e-04  9.9577599e-05
 -4.6868190e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00091217  0.00092063  0.00221043 -0.00218331 -0.00199751]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00661257  0.14690399 -0.14140849  0.04093896 -0.08681659]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00661257  0.14690399 -0.14140849  0.04093896 -0.08681659]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00016567 -0.03560629 -0.00067202  0.01472607 -0.04301032]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00130483 -0.24150167 -0.00313775  0.11290827 -0.21548697]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00130483 -0.24150167 -0.00313775  0.11290827 -0.21548697]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.1773396   0.67128694  0.7232667  -0.6950945   0.47992316]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.1773396   0.67128694  0.7232667  -0.6950945   0.47992316]
  [Layer 20] Output shape after mixer: (1, 1, 1024)
  [Layer 20] Output sample values after mixer: [ 0.1773396   0.67128694  0.7232667  -0.6950945   0.47992316]
  [Layer 20] Residual connection shape: (1, 1, 1024)
  [Layer 20] Residual connection sample values: [-0.55045146 -1.0385866   2.8777356  -2.0071843   0.8446517 ]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.11089257 -0.18931873  0.5374511  -0.47820237  0.16358513]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.11089257 -0.18931873  0.5374511  -0.47820237  0.16358513]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.11089257 -0.18931873  0.5374511  -0.47820237  0.16358513]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.05911713 -1.2998056  -0.1172284  -0.04126677 -1.142013  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.05911713 -1.2998056  -0.1172284  -0.04126677 -1.142013  ]
  [FlaxMamba2] xBC (step) sample values: [-1.2194853  -0.58118755  0.40719903  0.21908414  2.0294225 ]
  [FlaxMamba2] dt (step) sample values: [-0.23693188 -0.18020783 -0.12056304  0.2556085   0.15846744]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.08208276 -0.42845628 -2.0421271  -1.2194853  -0.45895997]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.56273353 -0.15936804 -0.00902318 -0.12508114  0.5188783 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.9201554  -0.25684118 -0.03468847 -0.2231036   0.4648927 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.26217642 -0.11201882 -0.01704344 -0.09915936  0.2855251 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.26217642 -0.11201882 -0.01704344 -0.09915936  0.2855251 ]
  [FlaxMamba2] B (step) sample values: [ 0.58300227  0.0806133  -0.19908664 -0.24971226 -0.04555717]
  [FlaxMamba2] C (step) sample values: [-0.06094586 -0.11963974  0.07576139 -0.10616895 -0.08151572]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.32275575 -0.3764196  -0.15946394 -0.10539922 -0.37568513]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.61703336 0.50326675 0.74254924 0.5401329  0.6259952 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.81942606 0.8274228  0.8883319  0.9446606  0.79043084]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.26217642 -0.11201882 -0.01704344 -0.09915936  0.2855251 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0943132  -0.01304094  0.03220656  0.04039635  0.00736986]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0943132  -0.01304094  0.03220656  0.04039635  0.00736986]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0915353   0.09261896  0.05825589  0.09443527  0.0201028 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.518461   -0.21739711 -0.10176688 -0.17477429  0.5406861 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-1.07257    -0.45414847 -0.13778813 -0.38434726  1.1441424 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-1.07257    -0.45414847 -0.13778813 -0.38434726  1.1441424 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.03264047  0.12644193  0.00760349  0.00776678 -0.31613928]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02190452  0.10722073  0.0072901   0.00522194 -0.1832982 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02190452  0.10722073  0.0072901   0.00522194 -0.1832982 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.5887415  -0.17633973 -0.6632723  -0.31010908 -0.14560616]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.5887415  -0.17633973 -0.6632723  -0.31010908 -0.14560616]
  [Layer 21] Output shape after mixer: (1, 1, 1024)
  [Layer 21] Output sample values after mixer: [ 0.5887415  -0.17633973 -0.6632723  -0.31010908 -0.14560616]
  [Layer 21] Residual connection shape: (1, 1, 1024)
  [Layer 21] Residual connection sample values: [ 0.03829002 -1.2149264   2.2144632  -2.3172934   0.69904554]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.00697253 -0.20462698  0.37335724 -0.49847898  0.1233279 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.00697253 -0.20462698  0.37335724 -0.49847898  0.1233279 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.00697253 -0.20462698  0.37335724 -0.49847898  0.1233279 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.1029718   1.53887     0.84403056 -4.086257    0.49415877]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.1029718   1.53887     0.84403056 -4.086257    0.49415877]
  [FlaxMamba2] xBC (step) sample values: [-0.6606246  -0.77949256 -0.11960508  0.96225935 -0.37690723]
  [FlaxMamba2] dt (step) sample values: [-0.19247425 -0.5197412  -0.2250268   1.1530939  -0.17184974]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.01145529 -0.34415787  0.25605208 -0.6606246   0.80547583]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.02122287 -0.20288959 -0.16064827  0.2579571  -0.13710539]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.02940921 -0.13837543 -0.148014    0.23960078 -0.13649504]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.01492082 -0.0644084  -0.06853994  0.13408425 -0.06359701]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01492082 -0.0644084  -0.06853994  0.13408425 -0.06359701]
  [FlaxMamba2] B (step) sample values: [-0.2753517   0.05229866  0.06792784 -0.13926676  0.2005425 ]
  [FlaxMamba2] C (step) sample values: [-0.27632847  0.10203721  0.28689113 -0.27411708 -0.1153449 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.07090003 -0.07021102 -0.0699373  -0.08945116 -0.38969815]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.43071544 0.5212999  0.0933255  0.8037726  0.6328255 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.96992385 0.9640607  0.99349433 0.93062544 0.78144467]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01492082 -0.0644084  -0.06853994  0.13408425 -0.06359701]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00176958  0.0003361   0.00043655 -0.00089502  0.00128881]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00176958  0.0003361   0.00043655 -0.00089502  0.00128881]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00327955 0.02335794 0.00525167 0.01176996 0.0440884 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02407539  0.13578303 -0.19444256  0.03505884 -0.0101714 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04979891  0.24682328 -0.07627953 -0.19610275  0.09947   ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04979891  0.24682328 -0.07627953 -0.19610275  0.09947   ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.04123995  0.31271333 -0.04502337  0.01324141  0.03052883]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02940921  0.09658541 -0.03210727  0.01402806  0.02077322]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02940921  0.09658541 -0.03210727  0.01402806  0.02077322]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.05484092  0.24637851 -1.0217966  -0.32967383  0.6297209 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.05484092  0.24637851 -1.0217966  -0.32967383  0.6297209 ]
  [Layer 22] Output shape after mixer: (1, 1, 1024)
  [Layer 22] Output sample values after mixer: [ 0.05484092  0.24637851 -1.0217966  -0.32967383  0.6297209 ]
  [Layer 22] Residual connection shape: (1, 1, 1024)
  [Layer 22] Residual connection sample values: [ 0.09313095 -0.9685478   1.1926666  -2.6469672   1.3287665 ]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.01344676 -0.12633348  0.16369396 -0.46982488  0.17853875]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.01344676 -0.12633348  0.16369396 -0.46982488  0.17853875]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.01344676 -0.12633348  0.16369396 -0.46982488  0.17853875]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.1956485   1.6702688  -2.2459304   0.95362604 -1.0305403 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.1956485   1.6702688  -2.2459304   0.95362604 -1.0305403 ]
  [FlaxMamba2] xBC (step) sample values: [-0.11811411 -0.23992074  0.9307774  -0.2340713   0.743277  ]
  [FlaxMamba2] dt (step) sample values: [-0.11337138  0.346983    0.33270815 -0.0648948   0.11089304]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.548761    0.00251446  0.20315395 -0.11811411 -0.21289878]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.10733264  0.00653748  0.18416375 -0.04553162  0.28668663]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.07364123 -0.00102707  0.14220208 -0.02918945  0.28221962]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.03817576 -0.00051327  0.0761479  -0.01438173  0.16089067]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03817576 -0.00051327  0.0761479  -0.01438173  0.16089067]
  [FlaxMamba2] B (step) sample values: [-0.14380783  0.0221634   0.04964948  0.29431298  0.04477166]
  [FlaxMamba2] C (step) sample values: [ 0.02376794 -0.03604184  0.18478468  0.0802618  -0.00331417]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.12322418 -0.22553998 -0.24196908 -0.09559295 -0.2396176 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06447453 0.29192996 0.28012097 0.06990636 0.1936345 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99208665 0.9362789  0.93446547 0.9933397  0.9546617 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03817576 -0.00051327  0.0761479  -0.01438173  0.16089067]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.53963464e-04  5.45522125e-05  1.22205442e-04  7.24411453e-04
  1.10199355e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.53963464e-04  5.45522125e-05  1.22205442e-04  7.24411453e-04
  1.10199355e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.02512025  0.01223991 -0.00126348  0.07688522 -0.01129987]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.03899384  0.00979656  0.23836742 -0.04024804  0.04437388]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0407759   0.00982052  0.23481283 -0.0395767   0.03686348]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0407759   0.00982052  0.23481283 -0.0395767   0.03686348]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0035999   0.01380488 -0.05047019 -0.02724338 -0.0099904 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00379966  0.04416827 -0.26542848 -0.14373268 -0.02934742]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00379966  0.04416827 -0.26542848 -0.14373268 -0.02934742]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.2253794  -0.476753   -0.10107861  0.20620102 -1.407941  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.2253794  -0.476753   -0.10107861  0.20620102 -1.407941  ]
  [Layer 23] Output shape after mixer: (1, 1, 1024)
  [Layer 23] Output sample values after mixer: [-0.2253794  -0.476753   -0.10107861  0.20620102 -1.407941  ]
  [Layer 23] Residual connection shape: (1, 1, 1024)
  [Layer 23] Residual connection sample values: [-0.13224846 -1.4453008   1.091588   -2.440766   -0.07917452]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.02114381 -0.20512658  0.16835015 -0.4478482  -0.01166227]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.02114381 -0.20512658  0.16835015 -0.4478482  -0.01166227]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.02114381 -0.20512658  0.16835015 -0.4478482  -0.01166227]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.3240143  -1.210295    0.8109046   0.03461988 -0.7383482 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.3240143  -1.210295    0.8109046   0.03461988 -0.7383482 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.7084974  -0.09366113 -2.2438593  -0.7280566   0.15095988]
  [FlaxMamba2] dt (step) sample values: [-0.09006852  0.6229249   1.0718124   0.08083958  1.0132145 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.23978034 -0.4168057   0.16669989  0.7084974  -1.811397  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.31127706 -0.00750305 -0.24147528 -0.19364649 -0.04523284]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.18432394  0.08984803 -0.24364585 -0.27274805 -0.03838164]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.08369211  0.04694082 -0.10705508 -0.11789059 -0.01882258]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08369211  0.04694082 -0.10705508 -0.11789059 -0.01882258]
  [FlaxMamba2] B (step) sample values: [ 0.42363417 -0.16532516  0.07365038 -0.06781543 -0.01078811]
  [FlaxMamba2] C (step) sample values: [-0.00122122 -0.0158622  -0.11437168  0.16379084 -0.12629586]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6296152  -0.19671947 -0.14336194 -0.14017779 -0.22378482]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.72678536 1.1346338  1.1994674  1.2085209  0.9671204 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.6328036  0.7999512  0.84201455 0.8441646  0.80539143]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08369211  0.04694082 -0.10705508 -0.11789059 -0.01882258]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.02576806  0.0100561  -0.00447987  0.00412495  0.0006562 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.02576806  0.0100561  -0.00447987  0.00412495  0.0006562 ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01804961  0.01166766 -0.01025229  0.01119819 -0.00171919]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0280962  -0.02312347 -0.09870351 -0.17812635 -0.03711794]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.38181433  0.20678514 -0.6230421  -0.75553554 -0.1293079 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.38181433  0.20678514 -0.6230421  -0.75553554 -0.1293079 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.3992904  -0.05747446 -0.34977028 -0.01330463  0.03087308]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.10789036 -0.04848627 -0.25944185 -0.00732995  0.01576872]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.10789036 -0.04848627 -0.25944185 -0.00732995  0.01576872]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.5890742 -2.2832491 -0.6621963  0.4241594  0.4028725]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.5890742 -2.2832491 -0.6621963  0.4241594  0.4028725]
  [Layer 24] Output shape after mixer: (1, 1, 1024)
  [Layer 24] Output sample values after mixer: [-0.5890742 -2.2832491 -0.6621963  0.4241594  0.4028725]
  [Layer 24] Residual connection shape: (1, 1, 1024)
  [Layer 24] Residual connection sample values: [-0.72132266 -3.72855     0.42939174 -2.0166068   0.32369798]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.06907509 -0.33140263  0.03832223 -0.22110476  0.02904695]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.06907509 -0.33140263  0.03832223 -0.22110476  0.02904695]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.06907509 -0.33140263  0.03832223 -0.22110476  0.02904695]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.1248139  -0.4450135  -2.1032145   0.90722936  0.13194118]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.1248139  -0.4450135  -2.1032145   0.90722936  0.13194118]
  [FlaxMamba2] xBC (step) sample values: [ 0.5787873  -0.15982583  1.1738288  -0.61321956 -0.2334372 ]
  [FlaxMamba2] dt (step) sample values: [0.11977115 1.1462351  0.6278662  0.82754314 0.64637935]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.13636056  0.7092835  -0.59246755  0.5787873  -0.4162161 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.20296265  0.02140646 -0.28222004 -0.42510352 -0.13886052]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.22228028  0.02475386 -0.1795589  -0.5302061  -0.17749578]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.09883861  0.01253011 -0.08174069 -0.19642483 -0.08089232]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09883861  0.01253011 -0.08174069 -0.19642483 -0.08089232]
  [FlaxMamba2] B (step) sample values: [-0.04143024 -0.07179353 -0.06929757 -0.0367774  -0.02975818]
  [FlaxMamba2] C (step) sample values: [-0.21912391 -0.22477005  0.25414294  0.01826979 -0.02571405]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.16260907 -0.3326761  -0.32944313 -0.2015813  -0.1541056 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.6371409  0.8476652  0.56910086 0.81386614 0.8434285 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.90158147 0.7542752  0.8290404  0.8486909  0.8781156 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09883861  0.01253011 -0.08174069 -0.19642483 -0.08089232]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00260903 0.00452113 0.00436395 0.00231602 0.001874  ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00260903 0.00452113 0.00436395 0.00231602 0.001874  ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00328373  0.00775197  0.00638874  0.00587089 -0.01713142]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00179286  0.01160115 -0.1050606  -0.35662767 -0.1487829 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.09260984  0.02311433 -0.18016732 -0.53711087 -0.22311008]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.09260984  0.02311433 -0.18016732 -0.53711087 -0.22311008]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0255338  -0.00401724  0.04122188 -0.34715626 -0.0156883 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13083655 -0.01613227  0.13824429 -0.6530766  -0.04545516]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.13083655 -0.01613227  0.13824429 -0.6530766  -0.04545516]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.30438083 -0.33971384 -0.9464891   0.75734097 -1.8912323 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.30438083 -0.33971384 -0.9464891   0.75734097 -1.8912323 ]
  [Layer 25] Output shape after mixer: (1, 1, 1024)
  [Layer 25] Output sample values after mixer: [ 0.30438083 -0.33971384 -0.9464891   0.75734097 -1.8912323 ]
  [Layer 25] Residual connection shape: (1, 1, 1024)
  [Layer 25] Residual connection sample values: [-0.41694182 -4.068264   -0.51709735 -1.2592659  -1.5675342 ]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.04623896 -0.4202946  -0.0561747  -0.16775467 -0.16629326]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.04623896 -0.4202946  -0.0561747  -0.16775467 -0.16629326]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.04623896 -0.4202946  -0.0561747  -0.16775467 -0.16629326]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.39386344  0.40848836 -0.9907829  -1.1138465   1.3751497 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.39386344  0.40848836 -0.9907829  -1.1138465   1.3751497 ]
  [FlaxMamba2] xBC (step) sample values: [-0.5481895  -0.5525676   1.9437807  -0.767437    0.06956189]
  [FlaxMamba2] dt (step) sample values: [0.7378489  1.3973548  0.57739556 1.161755   1.5452024 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.1091459  -0.8267723  -1.5060759  -0.5481895  -0.24700804]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.21177377 -0.20178778 -0.5501141  -0.22992724 -0.05788567]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.30277717 -0.25571233 -0.57538265 -0.2932207  -0.32570794]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.12864357 -0.11159747 -0.2071353  -0.12526844 -0.13656457]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.12864357 -0.11159747 -0.2071353  -0.12526844 -0.13656457]
  [FlaxMamba2] B (step) sample values: [0.02039788 0.08918434 0.07618885 0.07904222 0.04446092]
  [FlaxMamba2] C (step) sample values: [-0.08172385 -0.25856045 -0.24496832  0.00961569 -0.06746465]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.329765   -0.06343037 -0.22886811 -0.12639298 -0.0584348 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.9414653 0.6139799 2.065477  2.3401735 1.4591477]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7331079 0.9618036 0.6233035 0.74395   0.9182689]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.12864357 -0.11159747 -0.2071353  -0.12526844 -0.13656457]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00247046 -0.01080142 -0.0092275  -0.00957308 -0.00538482]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00247046 -0.01080142 -0.0092275  -0.00957308 -0.00538482]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.03588584  0.01328347 -0.00683142 -0.04457848 -0.00445609]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.41140488 -0.41252202 -0.40181392  0.02546692 -0.6670865 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.930238   -0.8626064  -1.2372125  -0.47975397 -1.2178658 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.930238   -0.8626064  -1.2372125  -0.47975397 -1.2178658 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.14757605 -0.21167439  0.33189696  0.1320725  -1.336802  ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.10668673 -0.10675147  0.22113037  0.09666047 -0.7204224 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.10668673 -0.10675147  0.22113037  0.09666047 -0.7204224 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.4939907  -0.36962643  0.7400556  -0.25515738 -1.6152678 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.4939907  -0.36962643  0.7400556  -0.25515738 -1.6152678 ]
  [Layer 26] Output shape after mixer: (1, 1, 1024)
  [Layer 26] Output sample values after mixer: [-0.4939907  -0.36962643  0.7400556  -0.25515738 -1.6152678 ]
  [Layer 26] Residual connection shape: (1, 1, 1024)
  [Layer 26] Residual connection sample values: [-0.91093254 -4.4378905   0.22295827 -1.5144233  -3.182802  ]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.07949854 -0.3686968   0.01877399 -0.15276146 -0.2797209 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.07949854 -0.3686968   0.01877399 -0.15276146 -0.2797209 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.07949854 -0.3686968   0.01877399 -0.15276146 -0.2797209 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.697712   -1.9497154   0.76664066 -0.33235258 -0.9748638 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.697712   -1.9497154   0.76664066 -0.33235258 -0.9748638 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.5523377   0.19299132 -0.268826   -0.41544715 -0.18344401]
  [FlaxMamba2] dt (step) sample values: [ 1.8192267  -0.21099372  1.2476544   2.2901835   0.27837464]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.38122988  0.02095367 -0.5378049   0.5523377  -0.51706624]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.11993406  0.07763236 -0.06399772  0.2716691  -0.02480948]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.13661191  0.02584403 -0.11905143  0.07147378 -0.02295267]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.06364749  0.01308898 -0.05598658  0.03701347 -0.01134463]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06364749  0.01308898 -0.05598658  0.03701347 -0.01134463]
  [FlaxMamba2] B (step) sample values: [-0.11161084 -0.0121654   0.19846492  0.06285721 -0.19198702]
  [FlaxMamba2] C (step) sample values: [-0.1706358   0.23768981 -0.16774642  0.4520534  -0.08455589]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.562595   -0.03025642 -0.75594616 -1.1612954  -0.04055573]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.40050003 0.03625896 0.03205536 0.58244306 0.04166569]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7982613  0.9989035  0.97605914 0.50845    0.99831164]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06364749  0.01308898 -0.05598658  0.03701347 -0.01134463]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00284505  0.00031011 -0.00505903 -0.00160228  0.00489391]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00284505  0.00031011 -0.00505903 -0.00160228  0.00489391]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00422289 -0.00780832 -0.00758797 -0.00647796  0.00128984]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.06227528 -0.01177862 -0.01742243 -0.00513691  0.01233775]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.1888486   0.01425095 -0.1287608   0.06847037 -0.01022289]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.1888486   0.01425095 -0.1287608   0.06847037 -0.01022289]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.04378709 -0.00346161 -0.06740081 -0.00950459  0.00272979]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.09241899 -0.00574993 -0.16149317 -0.0058596   0.00835336]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.09241899 -0.00574993 -0.16149317 -0.0058596   0.00835336]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.5602805   0.9899111   0.00738561 -0.9881067  -0.8497479 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.5602805   0.9899111   0.00738561 -0.9881067  -0.8497479 ]
  [Layer 27] Output shape after mixer: (1, 1, 1024)
  [Layer 27] Output sample values after mixer: [ 0.5602805   0.9899111   0.00738561 -0.9881067  -0.8497479 ]
  [Layer 27] Residual connection shape: (1, 1, 1024)
  [Layer 27] Residual connection sample values: [-0.35065204 -3.4479795   0.23034388 -2.50253    -4.03255   ]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.02512639 -0.23776802  0.01623443 -0.20963831 -0.27985924]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.02512639 -0.23776802  0.01623443 -0.20963831 -0.27985924]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.02512639 -0.23776802  0.01623443 -0.20963831 -0.27985924]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.1398777  -0.92692184 -0.21866308 -0.33735594  0.6798118 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.1398777  -0.92692184 -0.21866308 -0.33735594  0.6798118 ]
  [FlaxMamba2] xBC (step) sample values: [-1.6444194   1.050475   -0.48122337 -0.71211445 -1.1700792 ]
  [FlaxMamba2] dt (step) sample values: [1.3941778  0.6405017  0.3527374  0.37338373 1.3981487 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.2640718 -0.6237256 -1.445223  -1.6444194  0.919124 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.57789576  0.43259314 -0.15739112  0.19079931 -0.23993962]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.44996607  0.34317663 -0.28654152  0.10071142 -0.30555242]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.27476332  0.20074527 -0.12288356  0.05288927 -0.12961556]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.27476332  0.20074527 -0.12288356  0.05288927 -0.12961556]
  [FlaxMamba2] B (step) sample values: [-0.12082508  0.0552253  -0.06667238 -0.00958456 -0.22160159]
  [FlaxMamba2] C (step) sample values: [-0.04966186  0.00109129  0.07146883  0.30259827 -0.0753748 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.54422176 -0.18426022 -0.10643356 -0.11241624 -0.25234625]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.5843812 0.8138496 1.1384987 1.075031  1.2518371]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.72757876 0.86074233 0.8858794  0.88616604 0.729135  ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.27476332  0.20074527 -0.12288356  0.05288927 -0.12961556]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01940046  0.00886733 -0.01070535 -0.00153896 -0.0355818 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01940046  0.00886733 -0.01070535 -0.00153896 -0.0355818 ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00669478  0.00567432 -0.00715117 -0.00131908 -0.00368242]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.03461828  0.01929895 -0.02163503  0.00614507 -0.02632624]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.547237    0.39382413 -0.25089568  0.10481919 -0.26814657]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.547237    0.39382413 -0.25089568  0.10481919 -0.26814657]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.15116939 -0.10350814  0.02444365 -0.01472631 -0.12098473]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.6092711  -0.39200333  0.08837309 -0.06151308 -0.58803415]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.6092711  -0.39200333  0.08837309 -0.06151308 -0.58803415]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.16831957 -0.44169414  0.21392296  1.828205    2.5825167 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.16831957 -0.44169414  0.21392296  1.828205    2.5825167 ]
  [Layer 28] Output shape after mixer: (1, 1, 1024)
  [Layer 28] Output sample values after mixer: [ 0.16831957 -0.44169414  0.21392296  1.828205    2.5825167 ]
  [Layer 28] Residual connection shape: (1, 1, 1024)
  [Layer 28] Residual connection sample values: [-0.18233247 -3.8896737   0.44426686 -0.6743251  -1.4500332 ]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.01367565 -0.28801918  0.03358049 -0.06249895 -0.10924073]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.01367565 -0.28801918  0.03358049 -0.06249895 -0.10924073]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.01367565 -0.28801918  0.03358049 -0.06249895 -0.10924073]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.6663203  -0.26113293  0.13089453 -1.0761315   2.411473  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.6663203  -0.26113293  0.13089453 -1.0761315   2.411473  ]
  [FlaxMamba2] xBC (step) sample values: [0.51662797 0.49783996 1.7296691  0.47638717 1.1811074 ]
  [FlaxMamba2] dt (step) sample values: [1.7958188  0.30475172 1.3981732  1.143015   0.95119   ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [0.17975312 0.733938   0.04194061 0.51662797 0.21746472]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.09672963 -0.12937017 -0.45112368 -0.07099016  0.1961663 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.11072194 -0.20499273 -0.5894294   0.29570907  1.6961663 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.05842268 -0.09202749 -0.21028823  0.16955759  1.4333171 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05842268 -0.09202749 -0.21028823  0.16955759  1.4333171 ]
  [FlaxMamba2] B (step) sample values: [-0.16848677  0.13334234 -0.06297277 -0.01645369  0.0421518 ]
  [FlaxMamba2] C (step) sample values: [-0.20070869 -0.11848901 -0.18500419  0.12761998  0.29673347]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6542169  -0.13693057 -1.458904   -0.36823887 -0.12178858]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.42022902 0.07414801 0.33759296 0.29345065 0.6289527 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.75963223 0.98989826 0.61108714 0.8975738  0.92626095]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05842268 -0.09202749 -0.21028823  0.16955759  1.4333171 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0041365   0.00327368 -0.00154604 -0.00040395  0.00103486]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0041365   0.00327368 -0.00154604 -0.00040395  0.00103486]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.4802517e-05  2.8368863e-03 -1.7325154e-03 -2.3299556e-03
  2.8968835e-03]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00456673 -0.01280007 -0.01484072  0.04379832  0.16137388]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.09363891 -0.16749375 -0.36832485  0.32881626  2.570709  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.09363891 -0.16749375 -0.36832485  0.32881626  2.570709  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02117144  0.01902981 -0.02568127 -0.08996227  5.6889896 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.11983549  0.08409878 -0.0847946  -0.36471963  3.573086  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.11983549  0.08409878 -0.0847946  -0.36471963  3.573086  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.9763751  0.7267454  1.1684417 -3.4649282  1.102669 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.9763751  0.7267454  1.1684417 -3.4649282  1.102669 ]
  [Layer 29] Output shape after mixer: (1, 1, 1024)
  [Layer 29] Output sample values after mixer: [ 1.9763751  0.7267454  1.1684417 -3.4649282  1.102669 ]
  [Layer 29] Residual connection shape: (1, 1, 1024)
  [Layer 29] Residual connection sample values: [ 1.7940426 -3.1629283  1.6127086 -4.139253  -0.3473642]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.11157963 -0.1877698   0.09760053 -0.29395178 -0.02099649]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.11157963 -0.1877698   0.09760053 -0.29395178 -0.02099649]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.11157963 -0.1877698   0.09760053 -0.29395178 -0.02099649]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.49360394  0.80644345 -0.55961233 -1.3765947   1.9570104 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.49360394  0.80644345 -0.55961233 -1.3765947   1.9570104 ]
  [FlaxMamba2] xBC (step) sample values: [-0.9774104   1.0288047  -0.95971215  0.17380369  1.7038773 ]
  [FlaxMamba2] dt (step) sample values: [0.39998704 1.1940839  0.84540564 0.28808123 1.4079096 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.0343224 -0.6531412  1.6208633 -0.9774104  1.0553019]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.37182286 -0.21013844  0.01479869  0.0359593  -0.09207463]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.3290067  -0.25194752  0.589994    0.08539778 -0.18460393]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.1913232  -0.11018778  0.37958077  0.04452098 -0.08380642]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.1913232  -0.11018778  0.37958077  0.04452098 -0.08380642]
  [FlaxMamba2] B (step) sample values: [-0.03404669 -0.09900621 -0.02946506  0.04263432 -0.26423302]
  [FlaxMamba2] C (step) sample values: [-0.20829077 -0.16990526 -0.19257426  0.01021843 -0.26735726]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2037584  -0.36680323 -0.20777717 -0.09522027 -0.4265393 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.7080697  0.6338552  0.8321004  0.1303457  0.78367406]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8656495  0.7925496  0.8412289  0.9876652  0.71586204]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.1913232  -0.11018778  0.37958077  0.04452098 -0.08380642]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00461231 -0.01341239 -0.00399164  0.00577568 -0.03579569]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00461231 -0.01341239 -0.00399164  0.00577568 -0.03579569]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00299177 -0.04148946 -0.01135952 -0.00589272  0.01458027]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01765676 -0.1149141   1.0680205   0.20063001 -0.14219177]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01394228 -0.13311277  1.1307123   0.20798312 -0.15603328]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01394228 -0.13311277  1.1307123   0.20798312 -0.15603328]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00260857 -0.07421511 -0.23009525 -0.05770732 -0.2675581 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00902352 -0.28355706 -0.5314548  -0.22126356 -0.3761324 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00902352 -0.28355706 -0.5314548  -0.22126356 -0.3761324 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.5962847 -2.5583067  0.5318694 -4.20622   -3.9821792]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.5962847 -2.5583067  0.5318694 -4.20622   -3.9821792]
  [Layer 30] Output shape after mixer: (1, 1, 1024)
  [Layer 30] Output sample values after mixer: [ 1.5962847 -2.5583067  0.5318694 -4.20622   -3.9821792]
  [Layer 30] Residual connection shape: (1, 1, 1024)
  [Layer 30] Residual connection sample values: [ 3.3903275 -5.7212353  2.144578  -8.345473  -4.329543 ]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.11693592 -0.20012295  0.07429573 -0.32601961 -0.1495945 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.11693592 -0.20012295  0.07429573 -0.32601961 -0.1495945 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.11693592 -0.20012295  0.07429573 -0.32601961 -0.1495945 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 2.0140138   0.31280616  1.8167156  -0.400508   -0.08430413]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 2.0140138   0.31280616  1.8167156  -0.400508   -0.08430413]
  [FlaxMamba2] xBC (step) sample values: [ 0.23523258 -0.04496231  0.33753848  0.64197206  0.4864937 ]
  [FlaxMamba2] dt (step) sample values: [ 0.34674785  1.0231645   0.62213534 -0.5687139   1.4167345 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.1196474  -0.40604842  0.7384626   0.23523258  0.2735545 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.04110217 -0.0023711  -0.05972416 -0.23809306  0.43558985]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04400897  0.03257152 -0.0702985  -0.25625104  0.37528712]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.02152037  0.01655097 -0.03391429 -0.11179861  0.22244616]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02152037  0.01655097 -0.03391429 -0.11179861  0.22244616]
  [FlaxMamba2] B (step) sample values: [-0.0564606   0.04570231  0.00857895  0.02319493  0.02184274]
  [FlaxMamba2] C (step) sample values: [-0.01324027 -0.07416324 -0.11469909 -0.12175936 -0.06418463]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-9.5765535e-03 -1.0641767e-02 -2.6350424e+01 -6.4467737e+02
 -1.6546801e-02]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06442346 0.15449733 1.442161   0.9527214  0.23684436]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.9938321e-01 9.9835724e-01 3.1342628e-17 0.0000000e+00 9.9608862e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02152037  0.01655097 -0.03391429 -0.11179861  0.22244616]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 7.8277910e-05 -6.3362437e-05 -1.1893993e-05 -3.2157834e-05
 -3.0283141e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 7.8277910e-05 -6.3362437e-05 -1.1893993e-05 -3.2157834e-05
 -3.0283141e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01655693 -0.01078872  0.00781097  0.01559186  0.00599701]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00916943 -0.02571271 -0.00672488 -0.07275327  0.018979  ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01186999 -0.02778967 -0.00246902 -0.05872383 -0.00893544]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01186999 -0.02778967 -0.00246902 -0.05872383 -0.00893544]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02109161 -0.00502069 -0.00385831  0.00943574  0.00036078]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.5761199  -0.12402526 -0.09649997  1.0446053   0.00260506]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.5761199  -0.12402526 -0.09649997  1.0446053   0.00260506]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.0216155  -0.03327978 -2.2226617   1.0621731   1.3274578 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.0216155  -0.03327978 -2.2226617   1.0621731   1.3274578 ]
  [Layer 31] Output shape after mixer: (1, 1, 1024)
  [Layer 31] Output sample values after mixer: [-1.0216155  -0.03327978 -2.2226617   1.0621731   1.3274578 ]
  [Layer 31] Residual connection shape: (1, 1, 1024)
  [Layer 31] Residual connection sample values: [ 2.368712   -5.754515   -0.07808375 -7.2833004  -3.0020852 ]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.12491991 -0.29698122 -0.00400182 -0.44768554 -0.16063732]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.12491991 -0.29698122 -0.00400182 -0.44768554 -0.16063732]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.12491991 -0.29698122 -0.00400182 -0.44768554 -0.16063732]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.2735564  -2.0029109  -0.63506466  0.35886365 -1.3329798 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.2735564  -2.0029109  -0.63506466  0.35886365 -1.3329798 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.01557062 -0.08574536  0.01253148 -1.0108292   0.8905488 ]
  [FlaxMamba2] dt (step) sample values: [-1.1660477  -1.0086515   0.41557682 -0.72628945  0.07880222]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.05959322 -0.32137263 -0.7309479   0.01557062  0.34624848]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.29880598  0.1056734  -0.03254388  0.05791051 -0.0076941 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.28511885 -0.26224652 -0.03462098  0.03442723 -0.01999269]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.16274604 -0.11402782 -0.01701087  0.0175099  -0.00989642]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.16274604 -0.11402782 -0.01701087  0.0175099  -0.00989642]
  [FlaxMamba2] B (step) sample values: [-0.09289566  0.24032009  0.09439789 -0.11065322  0.06003366]
  [FlaxMamba2] C (step) sample values: [-0.2731649  -0.1959017  -0.2607452  -0.24935901 -0.13114555]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.0662153  -0.08112868 -0.58786964 -0.09559295 -0.5447535 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.4274992  0.52198684 0.5836955  0.5162089  0.63543904]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9720899 0.958536  0.7095411 0.9518518 0.7074009]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.16274604 -0.11402782 -0.01701087  0.0175099  -0.00989642]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0064631   0.01671998  0.00656762 -0.00769857  0.00417677]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0064631   0.01671998  0.00656762 -0.00769857  0.00417677]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.01423273 0.12255    0.1368332  0.25617668 0.15469345]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.6414035 -1.5275066  0.4892226  1.814425  -0.5159118]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.637719   -1.524925    0.48960772  1.8140286  -0.51568776]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.637719   -1.524925    0.48960772  1.8140286  -0.51568776]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.17758045  0.36314774 -0.10769555  0.3832797   0.14343792]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.10506726  0.46661708 -0.13793844  0.30760652  0.1296919 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.10506726  0.46661708 -0.13793844  0.30760652  0.1296919 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.8870292  1.5606365  3.0422204 -1.5176134  1.7496462]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.8870292  1.5606365  3.0422204 -1.5176134  1.7496462]
  [Layer 32] Output shape after mixer: (1, 1, 1024)
  [Layer 32] Output sample values after mixer: [-2.8870292  1.5606365  3.0422204 -1.5176134  1.7496462]
  [Layer 32] Residual connection shape: (1, 1, 1024)
  [Layer 32] Residual connection sample values: [-0.5183172 -4.1938787  2.9641366 -8.800914  -1.252439 ]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.02527169 -0.19970459  0.14371556 -0.45068303 -0.06174769]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.02527169 -0.19970459  0.14371556 -0.45068303 -0.06174769]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.02527169 -0.19970459  0.14371556 -0.45068303 -0.06174769]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.65191764 -1.6376468   0.17765716 -0.33367985 -0.07328764]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.65191764 -1.6376468   0.17765716 -0.33367985 -0.07328764]
  [FlaxMamba2] xBC (step) sample values: [ 0.29317662 -0.4517366   0.948249   -0.58435786 -1.5919044 ]
  [FlaxMamba2] dt (step) sample values: [ 0.13319808  0.52278256 -0.7580459  -0.7659847  -0.09136761]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [1.9686584  0.9715412  1.6151876  0.29317662 1.3172693 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.09494247 -0.06381928  0.14641927 -0.19547662 -0.30780715]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.1753212  -0.10040986  0.13305257 -0.31840143 -0.34216994]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.07999585 -0.04768651  0.07094552 -0.13406782 -0.14209719]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07999585 -0.04768651  0.07094552 -0.13406782 -0.14209719]
  [FlaxMamba2] B (step) sample values: [-0.16397567  0.1935519   0.04678424 -0.05180271 -0.26076135]
  [FlaxMamba2] C (step) sample values: [-0.06882268  0.10805306  0.08956182 -0.27348325 -0.13042697]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-13.044406    -1.3849771   -0.1667907   -0.23590268  -5.254998  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01610267 0.00812092 0.02634487 0.02471749 0.00759456]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8105439  0.9888157  0.99561554 0.99418604 0.9608765 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07999585 -0.04768651  0.07094552 -0.13406782 -0.14209719]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.1122475e-04 -2.4932326e-04 -6.0264978e-05  6.6729503e-05
  3.3589892e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.1122475e-04 -2.4932326e-04 -6.0264978e-05  6.6729503e-05
  3.3589892e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 7.9485949e-04 -5.4200337e-04 -1.1670225e-04  3.2125390e-05
  4.0650013e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00017728 -0.00197207 -0.00015767  0.00069055 -0.00112577]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.08550642 -0.05304918  0.0758322  -0.14290975 -0.15332633]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.08550642 -0.05304918  0.0758322  -0.14290975 -0.15332633]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [0.01909523 0.01414213 0.00733285 0.01990158 0.00541267]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.17960788 0.1289657  0.09126215 0.20815362 0.06400867]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.17960788 0.1289657  0.09126215 0.20815362 0.06400867]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.0682772  -6.545568   -0.47827512  3.4013498   5.790892  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.0682772  -6.545568   -0.47827512  3.4013498   5.790892  ]
  [Layer 33] Output shape after mixer: (1, 1, 1024)
  [Layer 33] Output sample values after mixer: [-1.0682772  -6.545568   -0.47827512  3.4013498   5.790892  ]
  [Layer 33] Residual connection shape: (1, 1, 1024)
  [Layer 33] Residual connection sample values: [ -1.5865945 -10.739447    2.4858615  -5.399564    4.538453 ]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.06053526 -0.4036288   0.09860938 -0.20897779  0.17684537]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.06053526 -0.4036288   0.09860938 -0.20897779  0.17684537]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.06053526 -0.4036288   0.09860938 -0.20897779  0.17684537]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.1452427  -1.6144047  -0.11137149  1.3795862  -2.1185753 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.1452427  -1.6144047  -0.11137149  1.3795862  -2.1185753 ]
  [FlaxMamba2] xBC (step) sample values: [-1.7558019 -1.7026213 -1.0418417  1.7767836 -1.8487625]
  [FlaxMamba2] dt (step) sample values: [-0.9785551  -1.8468428   1.5987719   0.41772515  2.162987  ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.37849823 -0.11966293 -0.456136   -1.7558019  -0.68964386]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.35952076  0.83987135  0.25403762 -0.3152222  -0.54338205]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.40288624  0.74264234  0.22004104 -0.39633793 -0.6174177 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.16140392  0.5031947   0.12207643 -0.15940414 -0.21632402]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.16140392  0.5031947   0.12207643 -0.15940414 -0.21632402]
  [FlaxMamba2] B (step) sample values: [-0.03749932  0.01664046 -0.0686268  -0.05936587  0.03978182]
  [FlaxMamba2] C (step) sample values: [-0.20688765 -0.04679659 -0.08089945  0.2654942  -0.04362477]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2224774  -0.15365478 -0.8168739  -0.85911244 -2.0730147 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00494611 0.00113071 0.7184308  0.14765592 0.98193634]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99890023 0.99982625 0.5560665  0.88086313 0.13060622]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.16140392  0.5031947   0.12207643 -0.15940414 -0.21632402]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.9936504e-05 -1.3284436e-05  5.4786236e-05  4.7393041e-05
 -3.1758675e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.9936504e-05 -1.3284436e-05  5.4786236e-05  4.7393041e-05
 -3.1758675e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00303829  0.00744203  0.00347362 -0.00652395  0.01052409]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.04687548  0.16105331  0.07950427 -0.03529841 -0.06238484]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.36443973  1.1510952   0.31969118 -0.34892806 -0.48800504]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.36443973  1.1510952   0.31969118 -0.34892806 -0.48800504]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.10073651 -0.3084424  -0.01681193 -0.3845834   0.11093945]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.62635225 -1.0724603  -0.08741567 -2.3632677   0.7266004 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.62635225 -1.0724603  -0.08741567 -2.3632677   0.7266004 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.29409146 -1.9800774  -2.818673   -1.347755    2.886559  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.29409146 -1.9800774  -2.818673   -1.347755    2.886559  ]
  [Layer 34] Output shape after mixer: (1, 1, 1024)
  [Layer 34] Output sample values after mixer: [ 0.29409146 -1.9800774  -2.818673   -1.347755    2.886559  ]
  [Layer 34] Residual connection shape: (1, 1, 1024)
  [Layer 34] Residual connection sample values: [ -1.292503   -12.719524    -0.33281136  -6.7473187    7.425012  ]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.0618625  -0.60402447 -0.01569373 -0.3442863   0.35321686]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0618625  -0.60402447 -0.01569373 -0.3442863   0.35321686]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0618625  -0.60402447 -0.01569373 -0.3442863   0.35321686]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.8268642  -1.188937   -0.94863504 -3.538817   -0.66876525]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.8268642  -1.188937   -0.94863504 -3.538817   -0.66876525]
  [FlaxMamba2] xBC (step) sample values: [-1.0326835  0.9422297 -2.1002665  1.4071785 -1.3435516]
  [FlaxMamba2] dt (step) sample values: [2.4288278 2.8170986 0.6104197 2.2492964 3.2488782]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.48985565 -0.17228524  1.0362945  -1.0326835   0.03885267]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.1989539   0.23033674 -0.47533187  0.2568416  -0.32881278]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.14750126  0.20860822 -0.5027672   0.23200029 -0.44105643]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.07917995  0.11514418 -0.18948823  0.12939616 -0.17266886]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.07917995  0.11514418 -0.18948823  0.12939616 -0.17266886]
  [FlaxMamba2] B (step) sample values: [-0.26842612 -0.00903722  0.23974976 -0.13299692 -0.15934499]
  [FlaxMamba2] C (step) sample values: [-0.20989889 -0.14553677 -0.25215772  0.09776308 -0.15310627]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2053565  -0.14169171 -0.10705902 -0.1460468  -0.2580783 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [4.002923  4.9957633 1.2687091 4.595383  3.6238215]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.43954015 0.4926983  0.8729938  0.511125   0.3924957 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.07917995  0.11514418 -0.18948823  0.12939616 -0.17266886]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.08507799 -0.00286436  0.07598899 -0.04215354 -0.05050459]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.08507799 -0.00286436  0.07598899 -0.04215354 -0.05050459]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.06471398 -0.00981156  0.04800339 -0.07917423 -0.07135754]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.25351748  0.6089333  -1.0492365   0.25963306 -0.6605289 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.46086127  0.9104545  -1.545438    0.598475   -1.1126865 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.46086127  0.9104545  -1.545438    0.598475   -1.1126865 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.11670195 -0.2527024   0.40926352 -0.05978331  0.2520901 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.13582928 -0.28520736  0.15975909 -0.10056651  0.24578711]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.13582928 -0.28520736  0.15975909 -0.10056651  0.24578711]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.28644967 -3.9205859  -3.7853684  -1.8786238   6.081301  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.28644967 -3.9205859  -3.7853684  -1.8786238   6.081301  ]
  [Layer 35] Output shape after mixer: (1, 1, 1024)
  [Layer 35] Output sample values after mixer: [ 0.28644967 -3.9205859  -3.7853684  -1.8786238   6.081301  ]
  [Layer 35] Residual connection shape: (1, 1, 1024)
  [Layer 35] Residual connection sample values: [ -1.0060533 -16.64011    -4.11818    -8.625942   13.506313 ]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.0365043  -0.6173421  -0.15030228 -0.33407944  0.5020366 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0365043  -0.6173421  -0.15030228 -0.33407944  0.5020366 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0365043  -0.6173421  -0.15030228 -0.33407944  0.5020366 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.0439006  -1.192436   -1.4304559  -0.36722195 -1.6778592 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.0439006  -1.192436   -1.4304559  -0.36722195 -1.6778592 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.9087267   1.4494094  -0.60220283  0.59336966 -0.42811403]
  [FlaxMamba2] dt (step) sample values: [0.5757902 3.065166  2.5000458 1.4481381 2.485782 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 2.9650278  -0.49706623  1.1748698   0.9087267   2.6882513 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.30465472  0.32345983 -0.17346732  0.11166213 -0.06394123]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.2643715   0.20590612 -0.2355706  -0.03299119 -0.07606433]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.11481375  0.1135151  -0.10397573 -0.01622351 -0.03658642]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.11481375  0.1135151  -0.10397573 -0.01622351 -0.03658642]
  [FlaxMamba2] B (step) sample values: [-0.1805876  -0.02348978 -0.08740509 -0.01281843 -0.03146807]
  [FlaxMamba2] C (step) sample values: [-0.106995   -0.1015901  -0.27796364 -0.10842913 -0.20113602]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.8654757 -5.63779   -3.8975632 -2.4259677 -3.6937442]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1211876  0.31503347 0.20142163 0.1586258  0.2637894 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7066215  0.16929838 0.45609528 0.6805724  0.37742987]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.11481375  0.1135151  -0.10397573 -0.01622351 -0.03658642]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [0.0025127  0.00032684 0.00121615 0.00017836 0.00043785]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [0.0025127  0.00032684 0.00121615 0.00017836 0.00043785]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0028136   0.0013252   0.00041406 -0.00014617  0.00279583]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0098021   0.02046822 -0.01807268 -0.00818863 -0.00915924]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.36191702  0.3686004  -0.33694917 -0.05794348 -0.12136378]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.36191702  0.3686004  -0.33694917 -0.05794348 -0.12136378]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.09837979 -0.10233349  0.09303758  0.00870727  0.03204733]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.21814401 -0.48456958  0.30435053  0.03037222  0.1272069 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.21814401 -0.48456958  0.30435053  0.03037222  0.1272069 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.501209  -3.6260483  3.3670397  1.1370686  4.222226 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.501209  -3.6260483  3.3670397  1.1370686  4.222226 ]
  [Layer 36] Output shape after mixer: (1, 1, 1024)
  [Layer 36] Output sample values after mixer: [ 2.501209  -3.6260483  3.3670397  1.1370686  4.222226 ]
  [Layer 36] Residual connection shape: (1, 1, 1024)
  [Layer 36] Residual connection sample values: [  1.4951557 -20.26616    -0.7511401  -7.4888735  17.728539 ]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.04621803 -0.64327586 -0.02435951 -0.23712113  0.56217337]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.04621803 -0.64327586 -0.02435951 -0.23712113  0.56217337]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.04621803 -0.64327586 -0.02435951 -0.23712113  0.56217337]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.4134618  -1.7759165   0.30352002 -2.1210403  -3.1081543 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.4134618  -1.7759165   0.30352002 -2.1210403  -3.1081543 ]
  [FlaxMamba2] xBC (step) sample values: [-0.16051315 -0.9571513   2.3497238   1.4174074  -1.0436105 ]
  [FlaxMamba2] dt (step) sample values: [-1.0175292  -0.23244305  0.6599988  -2.5261018  -0.13457152]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.63286954 -0.13349202 -0.5111333  -0.16051315  0.6878755 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06282829  0.21969375 -0.7618905  -0.24756135  0.78215736]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.0149305   0.15560684 -0.8464852  -0.21267976  0.6985392 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.00740952  0.08384461 -0.25409004 -0.09507414  0.46652907]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00740952  0.08384461 -0.25409004 -0.09507414  0.46652907]
  [FlaxMamba2] B (step) sample values: [-0.12181939 -0.14392774 -0.12109595 -0.1770958  -0.08337106]
  [FlaxMamba2] C (step) sample values: [-0.24729788 -0.2638481  -0.22800705 -0.263276   -0.2659344 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.8178532  -31.169907   -39.01954     -0.46187502  -0.64770097]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [2.2830431e-04 5.7354267e-03 6.4579034e-03 5.9284484e-05 1.4479025e-03]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9995851  0.83629596 0.77725685 0.99997264 0.99906266]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00740952  0.08384461 -0.25409004 -0.09507414  0.46652907]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [2.0607283e-07 2.4347187e-07 2.0484903e-07 2.9957982e-07 1.4103263e-07]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [2.0607283e-07 2.4347187e-07 2.0484903e-07 2.9957982e-07 1.4103263e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00040641  0.00035255 -0.00061845  0.00089815 -0.00057419]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00017736  0.00164397 -0.00480162  0.00264237  0.0009372 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01339401  0.15521482 -0.47019616 -0.17149661  0.85543776]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01339401  0.15521482 -0.47019616 -0.17149661  0.85543776]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00333337 -0.03991614 -0.08210374  0.03894632 -0.11372398]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02315802 -0.20053053 -0.38794535  0.29114643 -0.4536635 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02315802 -0.20053053 -0.38794535  0.29114643 -0.4536635 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.5491965   0.6175451  -8.298305    1.3837078  -0.05270759]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.5491965   0.6175451  -8.298305    1.3837078  -0.05270759]
  [Layer 37] Output shape after mixer: (1, 1, 1024)
  [Layer 37] Output sample values after mixer: [-2.5491965   0.6175451  -8.298305    1.3837078  -0.05270759]
  [Layer 37] Residual connection shape: (1, 1, 1024)
  [Layer 37] Residual connection sample values: [ -1.0540408 -19.648613   -9.049444   -6.1051655  17.67583  ]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.03140232 -0.5853778  -0.2683201  -0.17625722  0.5301147 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.03140232 -0.5853778  -0.2683201  -0.17625722  0.5301147 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.03140232 -0.5853778  -0.2683201  -0.17625722  0.5301147 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.37800848 -2.0375097  -0.2235781  -0.4516747   0.25690454]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.37800848 -2.0375097  -0.2235781  -0.4516747   0.25690454]
  [FlaxMamba2] xBC (step) sample values: [ 0.45082816 -1.5422729   0.15702797  0.4669241  -0.39118597]
  [FlaxMamba2] dt (step) sample values: [ 0.3005069   0.7942643  -0.1268463   0.36359176  2.1422276 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.83034813  0.53411996  0.89194643  0.45082816 -0.96329474]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.26438034  0.42377216 -0.59901255 -0.22186434  0.35783222]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.26677024  0.13446552 -0.68910044 -0.26504672  0.45078877]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.1156983   0.0717462  -0.23032026 -0.11506301  0.27535382]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.1156983   0.0717462  -0.23032026 -0.11506301  0.27535382]
  [FlaxMamba2] B (step) sample values: [-0.10530424 -0.24462272  0.03018273  0.09118799 -0.0823231 ]
  [FlaxMamba2] C (step) sample values: [-0.2733764   0.00699891  0.38911808 -0.2674453   0.11435059]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17041285 -2.0831616  -0.13507122 -0.41240796 -3.531486  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.97489417 0.24576071 0.60939944 0.40484723 0.6315198 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8469323  0.59932023 0.92098427 0.8462316  0.10750656]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.1156983   0.0717462  -0.23032026 -0.11506301  0.27535382]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01187764  0.02759188 -0.00340442 -0.01028542  0.00928552]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01187764  0.02759188 -0.00340442 -0.01028542  0.00928552]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.1754222e-04  1.3664058e-01 -9.7285677e-03 -7.1892641e-03
  5.1914807e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.40070328 -0.23742051 -0.2768631  -0.24887095  0.81682914]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.41767168 -0.22689816 -0.31064206 -0.26574618  0.8572128 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.41767168 -0.22689816 -0.31064206 -0.26574618  0.8572128 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [0.06419656 0.05331352 0.03086044 0.04668751 0.12417764]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.24903946 0.1392481  0.08913888 0.26926005 0.49516505]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.24903946 0.1392481  0.08913888 0.26926005 0.49516505]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.48404   -4.805013   3.6618044 -4.7802224 -1.6514652]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.48404   -4.805013   3.6618044 -4.7802224 -1.6514652]
  [Layer 38] Output shape after mixer: (1, 1, 1024)
  [Layer 38] Output sample values after mixer: [ 3.48404   -4.805013   3.6618044 -4.7802224 -1.6514652]
  [Layer 38] Residual connection shape: (1, 1, 1024)
  [Layer 38] Residual connection sample values: [  2.4299994 -24.453627   -5.38764   -10.885387   16.024366 ]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.04134572 -0.45248416 -0.09668318 -0.20487699  0.28615955]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.04134572 -0.45248416 -0.09668318 -0.20487699  0.28615955]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.04134572 -0.45248416 -0.09668318 -0.20487699  0.28615955]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.8435707   0.7587244  -1.7513871  -0.42113963 -2.2579474 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.8435707   0.7587244  -1.7513871  -0.42113963 -2.2579474 ]
  [FlaxMamba2] xBC (step) sample values: [0.25050467 0.3018824  0.07835682 0.31687608 1.040046  ]
  [FlaxMamba2] dt (step) sample values: [ 2.1297596  3.5058587 -1.7699505  2.5920713 -1.094629 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.62293774  1.8239754  -1.2064722   0.25050467  1.6666474 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04478209 -0.07071423  0.05351134  0.07440405  0.29326242]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.10923521 -0.13144422  0.06877013  0.6120017   0.2898597 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.05759773 -0.06140892  0.03556693  0.39682025  0.1657887 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05759773 -0.06140892  0.03556693  0.39682025  0.1657887 ]
  [FlaxMamba2] B (step) sample values: [ 0.01133644  0.09188721 -0.25624925  0.06370133 -0.02469421]
  [FlaxMamba2] C (step) sample values: [-0.24368747 -0.27672786  0.00108221 -0.13152005 -0.19764273]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.7351256e+02 -2.3790452e+00 -2.6078771e-03 -1.4978828e+00
 -6.3306607e-02]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.2812371  2.4255896  0.05011892 1.0286074  0.00299452]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.         0.00311793 0.9998693  0.21422395 0.99981046]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05759773 -0.06140892  0.03556693  0.39682025  0.1657887 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00083659  0.00678094 -0.01891026  0.00470093 -0.00182234]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00083659  0.00678094 -0.01891026  0.00470093 -0.00182234]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00083659  0.00678094 -0.01891026  0.00470093 -0.00182234]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0069447  -0.00740423  0.00428839  0.04784561  0.01998956]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.26756647 -0.28527114  0.16522384  1.8434024   0.7701605 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.26756647 -0.28527114  0.16522384  1.8434024   0.7701605 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.15782107 -0.14741372 -0.04278995 -0.3076161  -0.16462271]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 1.0064791  -0.89062846 -0.24461727 -1.7159373  -1.1077422 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 1.0064791  -0.89062846 -0.24461727 -1.7159373  -1.1077422 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-5.3195233  1.2032958 -4.7366676  0.5496738 -5.6080074]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-5.3195233  1.2032958 -4.7366676  0.5496738 -5.6080074]
  [Layer 39] Output shape after mixer: (1, 1, 1024)
  [Layer 39] Output sample values after mixer: [-5.3195233  1.2032958 -4.7366676  0.5496738 -5.6080074]
  [Layer 39] Residual connection shape: (1, 1, 1024)
  [Layer 39] Residual connection sample values: [ -2.889524 -23.25033  -10.124308 -10.335713  10.416359]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.05734928 -0.4924037  -0.21002401 -0.19637223  0.21402848]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05734928 -0.4924037  -0.21002401 -0.19637223  0.21402848]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05734928 -0.4924037  -0.21002401 -0.19637223  0.21402848]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 5.6431875  -1.530819   -0.43090922 -0.8131802  -0.3610812 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 5.6431875  -1.530819   -0.43090922 -0.8131802  -0.3610812 ]
  [FlaxMamba2] xBC (step) sample values: [-2.0063157   0.3283075  -0.40826723  0.5124556   0.62245196]
  [FlaxMamba2] dt (step) sample values: [ 2.5384874   1.2717712   1.1892633  -0.65344065  2.726599  ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.00375456 -0.8215866  -0.16800253 -2.0063157   1.1060499 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.30342215 -0.05098892 -0.07410337 -0.12871128  0.11179148]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.02787668 -0.09948135 -0.14575864 -0.14026219  0.11332404]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.0141326  -0.04726857 -0.0675773  -0.06522077  0.05986917]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0141326  -0.04726857 -0.0675773  -0.06522077  0.05986917]
  [FlaxMamba2] B (step) sample values: [ 0.05355801 -0.20612709 -0.01237154 -0.00542104 -0.09334224]
  [FlaxMamba2] C (step) sample values: [-0.10948726 -0.26937002  0.61503774  0.3368256   0.26430085]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.52670574 -0.63007647 -0.38779998 -2.7909086  -0.42841786]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.20562313 0.0454615  0.08826096 0.00316189 0.22150883]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.89735574 0.9717621  0.9663515  0.9912143  0.9094654 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0141326  -0.04726857 -0.0675773  -0.06522077  0.05986917]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.5563906e-04 -5.9900334e-04 -3.5951587e-05 -1.5753501e-05
 -2.7125163e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.5563906e-04 -5.9900334e-04 -3.5951587e-05 -1.5753501e-05
 -2.7125163e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0026407  -0.03897151 -0.00648303  0.00072213 -0.00069443]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00747914 -0.01316698 -0.01829012 -0.00964348 -0.00800183]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02750787 -0.1301862  -0.18558611 -0.1711056   0.14021173]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02750787 -0.1301862  -0.18558611 -0.1711056   0.14021173]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.15468426  0.03544876  0.03150123  0.04274555 -0.02079274]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 1.2408539   0.3366655   0.30456123  0.32660967 -0.261673  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 1.2408539   0.3366655   0.30456123  0.32660967 -0.261673  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [10.376494 -5.387992 -9.561479  0.45712   6.794476]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [10.376494 -5.387992 -9.561479  0.45712   6.794476]
  [Layer 40] Output shape after mixer: (1, 1, 1024)
  [Layer 40] Output sample values after mixer: [10.376494 -5.387992 -9.561479  0.45712   6.794476]
  [Layer 40] Residual connection shape: (1, 1, 1024)
  [Layer 40] Residual connection sample values: [  7.4869704 -28.63832   -19.685787   -9.878593   17.210835 ]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.08934934 -0.3654135  -0.24231747 -0.11649039  0.2058243 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.08934934 -0.3654135  -0.24231747 -0.11649039  0.2058243 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.08934934 -0.3654135  -0.24231747 -0.11649039  0.2058243 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.01212098 -4.508444   -0.35141352 -0.7377793   0.6376933 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.01212098 -4.508444   -0.35141352 -0.7377793   0.6376933 ]
  [FlaxMamba2] xBC (step) sample values: [-0.5914106  -0.19439152 -0.06674562  0.89699334 -0.11627354]
  [FlaxMamba2] dt (step) sample values: [ 2.0481122  -0.52299166  1.0496371   0.806746    0.96084887]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.0690017  -0.864172   -0.80119365 -0.5914106   1.2318239 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.15979144 -0.12207211 -0.01380933 -0.1491306   0.02608313]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.19146869  0.00030338 -0.01374681 -0.241843    0.0165235 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.08659717  0.00015171 -0.00682616 -0.10637034  0.00833001]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08659717  0.00015171 -0.00682616 -0.10637034  0.00833001]
  [FlaxMamba2] B (step) sample values: [0.06411745 0.14158083 0.0147436  0.02804886 0.06136811]
  [FlaxMamba2] C (step) sample values: [ 1.000248    0.0287206  -0.09682375 -0.03371196 -0.2508109 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.0530885  -1.135641   -0.87189615 -1.5713016  -1.7430981 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.4513865  0.12944892 0.2686712  0.26348776 0.2013971 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.62166744 0.8632875  0.7911613  0.66098857 0.7039451 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08659717  0.00015171 -0.00682616 -0.10637034  0.00833001]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00250627 -0.00553422 -0.00057631 -0.0010964  -0.00239881]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00250627 -0.00553422 -0.00057631 -0.0010964  -0.00239881]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00252964 -0.00811677 -0.00909179 -0.0013816  -0.00666797]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00596595 -0.00369118 -0.00198545 -0.00831484  0.002622  ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.11673279 -0.00349713 -0.01071682 -0.14437363  0.01327695]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.11673279 -0.00349713 -0.01071682 -0.14437363  0.01327695]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [0.00070317 0.00017179 0.00155552 0.03445681 0.00553913]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.0193735  0.00631835 0.04939428 1.3298887  0.19851683]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.0193735  0.00631835 0.04939428 1.3298887  0.19851683]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.21337983  7.2716613   2.1369002  -0.3418104   2.6900249 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.21337983  7.2716613   2.1369002  -0.3418104   2.6900249 ]
  [Layer 41] Output shape after mixer: (1, 1, 1024)
  [Layer 41] Output sample values after mixer: [-0.21337983  7.2716613   2.1369002  -0.3418104   2.6900249 ]
  [Layer 41] Residual connection shape: (1, 1, 1024)
  [Layer 41] Residual connection sample values: [  7.2735906 -21.36666   -17.548887  -10.220404   19.90086  ]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.08177172 -0.25812384 -0.21093252 -0.11474481  0.2354105 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.08177172 -0.25812384 -0.21093252 -0.11474481  0.2354105 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.08177172 -0.25812384 -0.21093252 -0.11474481  0.2354105 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.19014405  2.3577504  -1.12322    -1.3273219   0.07447175]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.19014405  2.3577504  -1.12322    -1.3273219   0.07447175]
  [FlaxMamba2] xBC (step) sample values: [ 0.09180145  2.7927175  -0.9328251  -0.2845787  -0.03295272]
  [FlaxMamba2] dt (step) sample values: [ 1.6346655 -0.6176244  1.0289522 -1.0926108  1.5435276]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.26332572 -0.02132909 -0.8487252   0.09180145  0.52784085]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.0112482   0.5636019   0.20376708  0.05302731 -0.04066406]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.03212222  0.5278353   0.20838667  0.049287   -0.08683716]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.01580317  0.33199683  0.11501048  0.02525068 -0.04153458]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01580317  0.33199683  0.11501048  0.02525068 -0.04153458]
  [FlaxMamba2] B (step) sample values: [ 0.00460919 -0.00949653 -0.01142879 -0.00675411  0.04003204]
  [FlaxMamba2] C (step) sample values: [-0.01154467 -0.01804543 -0.09022807 -0.2113863  -0.27831483]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.2458453 -1.7473589 -3.3796544 -1.2264227 -1.3705136]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.4445567  0.07238789 0.32789636 0.00701712 0.31977212]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.36846644 0.88118505 0.3301605  0.991431   0.6451632 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01580317  0.33199683  0.11501048  0.02525068 -0.04153458]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.2381398e-05  6.6717010e-05  8.0291902e-05  4.7450347e-05
 -2.8124131e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.2381398e-05  6.6717010e-05  8.0291902e-05  4.7450347e-05
 -2.8124131e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 7.0773567e-06 -3.5808436e-04  6.3005736e-04 -1.1370961e-04
 -7.3648163e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00530933  0.10607657  0.037441    0.0077403  -0.01373684]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0269157   0.5599884   0.19468533  0.04226347 -0.07052365]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0269157   0.5599884   0.19468533  0.04226347 -0.07052365]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00280148  1.2061695  -0.05366588 -0.01175813 -0.00272375]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.07783819 32.22723    -1.4762282  -0.3276721  -0.05169654]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.07783819 32.22723    -1.4762282  -0.3276721  -0.05169654]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ -1.096271    3.7965677   5.97397   -12.520865    5.6063333]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ -1.096271    3.7965677   5.97397   -12.520865    5.6063333]
  [Layer 42] Output shape after mixer: (1, 1, 1024)
  [Layer 42] Output sample values after mixer: [ -1.096271    3.7965677   5.97397   -12.520865    5.6063333]
  [Layer 42] Residual connection shape: (1, 1, 1024)
  [Layer 42] Residual connection sample values: [  6.1773195 -17.570091  -11.574917  -22.741268   25.507193 ]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.06366529 -0.19822721 -0.12498306 -0.23421627  0.26724488]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.06366529 -0.19822721 -0.12498306 -0.23421627  0.26724488]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.06366529 -0.19822721 -0.12498306 -0.23421627  0.26724488]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.07528228 -0.9788766  -0.34406358 -0.41795474 -0.69372153]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.07528228 -0.9788766  -0.34406358 -0.41795474 -0.69372153]
  [FlaxMamba2] xBC (step) sample values: [ 0.53693     0.6877494   1.3485913  -0.09980752 -0.11129598]
  [FlaxMamba2] dt (step) sample values: [ 0.61910313  0.16495313  0.2830929   1.2084239  -1.2757496 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.14547695 -0.25887382 -0.99983454  0.53693    -0.07147177]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.08225594 -0.09795618 -0.27936727 -0.02351483 -0.02242382]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.06766091 -0.15218592 -0.3073824  -0.07133587 -0.03073986]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.03497452 -0.07031397 -0.13025446 -0.03439627 -0.01513372]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03497452 -0.07031397 -0.13025446 -0.03439627 -0.01513372]
  [FlaxMamba2] B (step) sample values: [-0.00183919  0.01682731 -0.00726232 -0.18897572  0.08931755]
  [FlaxMamba2] C (step) sample values: [-0.06473793 -0.08473807 -0.25261068 -0.27823967 -0.07179915]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-3.7045815 -2.655313  -8.210951  -2.2381823 -4.092597 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.1157457e-01 9.2920817e-02 8.2206078e-02 8.8540351e-01 3.5760386e-04]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.6614393  0.7813486  0.5091615  0.13783549 0.99853754]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03497452 -0.07031397 -0.13025446 -0.03439627 -0.01513372]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.1769937e-06  6.5664659e-05 -2.8339513e-05 -7.3743373e-04
  3.4854090e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.1769937e-06  6.5664659e-05 -2.8339513e-05 -7.3743373e-04
  3.4854090e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00365786 -0.00018545 -0.0024181   0.0065258  -0.00544678]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00793067 -0.00813804 -0.00898631 -0.00776591 -0.00317008]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.04975564 -0.12411256 -0.22382553 -0.06449847 -0.02813134]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.04975564 -0.12411256 -0.22382553 -0.06449847 -0.02813134]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [0.00194332 0.03318095 0.03194559 0.01070227 0.00650261]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.04937163 1.1295022  0.87045    0.29366806 0.1844196 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.04937163 1.1295022  0.87045    0.29366806 0.1844196 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.9726689  -8.802962    0.51256186 -0.3778449   0.68690354]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.9726689  -8.802962    0.51256186 -0.3778449   0.68690354]
  [Layer 43] Output shape after mixer: (1, 1, 1024)
  [Layer 43] Output sample values after mixer: [ 1.9726689  -8.802962    0.51256186 -0.3778449   0.68690354]
  [Layer 43] Residual connection shape: (1, 1, 1024)
  [Layer 43] Residual connection sample values: [  8.149988 -26.373055 -11.062355 -23.119114  26.194096]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.07987064 -0.2672735  -0.11240546 -0.22146933  0.25985646]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.07987064 -0.2672735  -0.11240546 -0.22146933  0.25985646]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.07987064 -0.2672735  -0.11240546 -0.22146933  0.25985646]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.48349166  0.500941   -0.51890665 -1.0157287   0.9504495 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.48349166  0.500941   -0.51890665 -1.0157287   0.9504495 ]
  [FlaxMamba2] xBC (step) sample values: [-0.83548874 -0.72035784 -0.47044685 -0.41343617 -0.63045675]
  [FlaxMamba2] dt (step) sample values: [ 0.4376162   0.80833405  0.7458347   2.0731204  -0.18990128]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.5636504   0.62443125 -1.0671846  -0.83548874 -0.04230376]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.17047554  0.155679   -0.07911897  0.07358859 -0.11662143]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.14899117  0.09861113 -0.10785127  0.06043552 -0.10999148]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.06895624  0.05173463 -0.05102048  0.0311306  -0.05197425]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06895624  0.05173463 -0.05102048  0.0311306  -0.05197425]
  [FlaxMamba2] B (step) sample values: [ 0.01688383 -0.27233252 -0.27515686  0.05914958  0.0955051 ]
  [FlaxMamba2] C (step) sample values: [ 0.24379654 -0.2678557  -0.17753285 -0.06776752 -0.16152717]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-4.6876054  -0.9752563  -0.82549465 -1.2937802  -0.49527767]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1498654  0.09706376 0.05104196 0.3140176  0.00641843]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.4953405 0.9096803 0.9587405 0.6661304 0.9968261]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06895624  0.05173463 -0.05102048  0.0311306  -0.05197425]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00017448  0.00281433  0.00284351 -0.00061126 -0.00098696]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00017448  0.00281433  0.00284351 -0.00061126 -0.00098696]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.4018937e-05  5.8776098e-03  6.3317358e-03 -1.1219742e-03
 -1.0281799e-03]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00549096  0.00430545 -0.00400756  0.0024322  -0.00257069]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.12532598  0.09421205 -0.09267307  0.05653224 -0.0928937 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.12532598  0.09421205 -0.09267307  0.05653224 -0.0928937 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0374818   0.0293872   0.01794227 -0.01526607 -0.0636758 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-1.0649612   0.76463145  0.5916645  -0.4326997  -1.7697314 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-1.0649612   0.76463145  0.5916645  -0.4326997  -1.7697314 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-18.65085      0.79260147   5.5839095   19.260017    -3.2454178 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-18.65085      0.79260147   5.5839095   19.260017    -3.2454178 ]
  [Layer 44] Output shape after mixer: (1, 1, 1024)
  [Layer 44] Output sample values after mixer: [-18.65085      0.79260147   5.5839095   19.260017    -3.2454178 ]
  [Layer 44] Residual connection shape: (1, 1, 1024)
  [Layer 44] Residual connection sample values: [-10.500862  -25.580454   -5.4784455  -3.8590965  22.948677 ]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.11551905 -0.30381852 -0.063319   -0.04259847  0.25575924]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.11551905 -0.30381852 -0.063319   -0.04259847  0.25575924]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.11551905 -0.30381852 -0.063319   -0.04259847  0.25575924]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.48989445 -1.5587775  -0.05343978 -1.0160908  -0.7416781 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.48989445 -1.5587775  -0.05343978 -1.0160908  -0.7416781 ]
  [FlaxMamba2] xBC (step) sample values: [-0.88069165 -0.7049796   1.2420932  -0.9091916  -0.15454741]
  [FlaxMamba2] dt (step) sample values: [ 5.2638054e-01 -9.5808411e-01  1.9430077e-01  8.8533616e-01
 -1.7718607e-04]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.24022754 -0.36166283  0.10074349 -0.88069165  1.3188651 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.14909936 -0.06997067  0.20454015  0.18222974 -0.02724561]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.15476038  0.18808597  0.18224706  0.12622999 -0.03799542]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.07140442  0.1028611   0.09940412  0.06709322 -0.01863684]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07140442  0.1028611   0.09940412  0.06709322 -0.01863684]
  [FlaxMamba2] B (step) sample values: [-0.12001221  0.18414228 -0.147679   -0.25207388 -0.07442196]
  [FlaxMamba2] C (step) sample values: [-0.16719724  0.05134894 -0.25715885  0.01159984 -0.156168  ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.3039274e+00 -3.9384812e-02 -6.8873577e+00 -8.0558503e-01
 -1.9935181e+03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00375423 0.00715332 0.00937447 0.00152384 0.01912005]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.9511671e-01 9.9971831e-01 9.3747485e-01 9.9877316e-01 2.7948904e-17]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07140442  0.1028611   0.09940412  0.06709322 -0.01863684]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.2171505e-05 -4.9362763e-05  3.9588103e-05  6.7573092e-05
  1.9950192e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.2171505e-05 -4.9362763e-05  3.9588103e-05  6.7573092e-05
  1.9950192e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00167703 0.00092743 0.0012576  0.00027862 0.00162643]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00328615  0.0322595  -0.00203346 -0.00467387  0.00825363]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.18860298  0.29921624  0.25595137  0.16945404 -0.04011482]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.18860298  0.29921624  0.25595137  0.16945404 -0.04011482]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03510277 -0.08107266 -0.0066563  -0.04576383  0.0095992 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.50415015 -0.8735745  -0.08563435 -0.5576497   0.14029443]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.50415015 -0.8735745  -0.08563435 -0.5576497   0.14029443]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.1602587 -4.002148   3.2208672  8.104136  -6.4900017]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.1602587 -4.002148   3.2208672  8.104136  -6.4900017]
  [Layer 45] Output shape after mixer: (1, 1, 1024)
  [Layer 45] Output sample values after mixer: [-1.1602587 -4.002148   3.2208672  8.104136  -6.4900017]
  [Layer 45] Residual connection shape: (1, 1, 1024)
  [Layer 45] Residual connection sample values: [-11.66112   -29.582602   -2.2575784   4.24504    16.458675 ]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.11517505 -0.31424084 -0.02350014  0.04268123  0.16090396]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.11517505 -0.31424084 -0.02350014  0.04268123  0.16090396]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.11517505 -0.31424084 -0.02350014  0.04268123  0.16090396]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.4284006  -0.5665898   0.35674042 -0.4466663   0.89157736]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.4284006  -0.5665898   0.35674042 -0.4466663   0.89157736]
  [FlaxMamba2] xBC (step) sample values: [ 1.3816338   0.8630739  -1.5096542  -0.21316081  1.6088814 ]
  [FlaxMamba2] dt (step) sample values: [ 1.1107876   1.6535784  -0.04157502  1.0037016   1.3754681 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.2188412   0.8542167   0.20801969  1.3816338  -1.1098316 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.05072773 -0.15924612 -0.29798946  0.0376895  -0.26185995]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.10617817 -0.19656911 -0.0951086   0.04219085 -0.2671128 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.0559049  -0.08865569 -0.04529459  0.02154037 -0.1158244 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0559049  -0.08865569 -0.04529459  0.02154037 -0.1158244 ]
  [FlaxMamba2] B (step) sample values: [-0.18734948 -0.0440275   0.03142736  0.24518634 -0.0810467 ]
  [FlaxMamba2] C (step) sample values: [-0.05225266 -0.10005687  0.09324102 -0.04311853  0.1183965 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.4426116  -0.9829804 -10.158994   -1.363838   -1.7559118]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02643862 0.07081646 0.00104639 0.03522519 0.04236578]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9625775 0.9327564 0.9894261 0.9530943 0.9283091]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0559049  -0.08865569 -0.04529459  0.02154037 -0.1158244 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.7691157e-04 -6.5074768e-05  4.6451154e-05  3.6239723e-04
 -1.1979093e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.7691157e-04 -6.5074768e-05  4.6451154e-05  3.6239723e-04
 -1.1979093e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.6705605e-03  2.1972088e-04 -1.0142230e-05  7.5185183e-04
 -9.0018380e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0029858  -0.00147202  0.0070706  -0.00096787 -0.00591291]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.07147593 -0.11008576 -0.04842066  0.02542165 -0.14781156]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.07147593 -0.11008576 -0.04842066  0.02542165 -0.14781156]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01974011  0.0225807  -0.01016122 -0.00443019 -0.09346429]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.8113334   0.8628406  -0.3312078  -0.14296332 -3.0144267 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.8113334   0.8628406  -0.3312078  -0.14296332 -3.0144267 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 8.86699    1.3965254 -4.791052  -8.473741  -5.5745144]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 8.86699    1.3965254 -4.791052  -8.473741  -5.5745144]
  [Layer 46] Output shape after mixer: (1, 1, 1024)
  [Layer 46] Output sample values after mixer: [ 8.86699    1.3965254 -4.791052  -8.473741  -5.5745144]
  [Layer 46] Residual connection shape: (1, 1, 1024)
  [Layer 46] Residual connection sample values: [ -2.7941303 -28.186077   -7.04863    -4.2287006  10.884161 ]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.02340865 -0.24620561 -0.06031091 -0.03344458  0.091246  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.02340865 -0.24620561 -0.06031091 -0.03344458  0.091246  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.02340865 -0.24620561 -0.06031091 -0.03344458  0.091246  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.05807845  0.6335162  -0.76801014 -1.8199575   0.01656318]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.05807845  0.6335162  -0.76801014 -1.8199575   0.01656318]
  [FlaxMamba2] xBC (step) sample values: [-1.1000143  -0.1829248  -0.06013283 -0.54173297  0.39389658]
  [FlaxMamba2] dt (step) sample values: [1.7349768 2.2837257 1.0737599 0.9134653 2.3643022]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.23631448 -0.7599935  -0.5188107  -1.1000143   0.21682525]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.2496351  -0.03152815 -0.01012093  0.09760176  0.06303903]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.2367109  -0.01644484 -0.01123482  0.10439955  0.061125  ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.13229842 -0.00815481 -0.00558586  0.05492212  0.03149628]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.13229842 -0.00815481 -0.00558586  0.05492212  0.03149628]
  [FlaxMamba2] B (step) sample values: [ 0.45058006 -0.05711564 -0.00260123 -0.05453278 -0.27330342]
  [FlaxMamba2] C (step) sample values: [-0.237054   -0.19324023 -0.0223137  -0.27458492 -0.2603145 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-5.7667141e+01 -2.2024069e+00 -3.8371372e+00 -4.6045512e-02
 -2.0699801e+00]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.23805808 0.04277504 0.03744564 0.04363614 0.04255113]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [1.0913136e-06 9.1009343e-01 8.6616135e-01 9.9799275e-01 9.1568762e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.13229842 -0.00815481 -0.00558586  0.05492212  0.03149628]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.4190887e-02 -1.7988402e-03 -8.1924976e-05 -1.7174939e-03
 -8.6076111e-03]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.4190887e-02 -1.7988402e-03 -8.1924976e-05 -1.7174939e-03
 -8.6076111e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.4190887e-02 -1.7988402e-03 -8.1924969e-05 -1.7174940e-03
 -8.6076120e-03]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00894059 -0.00055109 -0.00037749  0.00371158  0.00212849]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.21741612 -0.01340143 -0.00917966  0.09025772  0.05176024]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.21741612 -0.01340143 -0.00917966  0.09025772  0.05176024]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00649689 -0.00554641  0.00223424 -0.02290497  0.00043221]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.2131892  -0.20137765  0.07436354 -1.0919142   0.01662604]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.2131892  -0.20137765  0.07436354 -1.0919142   0.01662604]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-11.823685   16.622189  -12.996972  -13.492741   -6.2303123]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-11.823685   16.622189  -12.996972  -13.492741   -6.2303123]
  [Layer 47] Output shape after mixer: (1, 1, 1024)
  [Layer 47] Output sample values after mixer: [-11.823685   16.622189  -12.996972  -13.492741   -6.2303123]
  [Layer 47] Residual connection shape: (1, 1, 1024)
  [Layer 47] Residual connection sample values: [-14.617815  -11.563889  -20.045603  -17.721441    4.6538486]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.10001978 -0.08536906 -0.14624117 -0.1182548   0.03295071]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.10001978 -0.08536906 -0.14624117 -0.1182548   0.03295071]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.10001978 -0.08536906 -0.14624117 -0.1182548   0.03295071]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.08565001 -0.7648343  -0.40672693  0.11189968 -0.9536251 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.08565001 -0.7648343  -0.40672693  0.11189968 -0.9536251 ]
  [FlaxMamba2] xBC (step) sample values: [-0.9858096   0.11738551 -0.7984422  -0.796517   -1.8126454 ]
  [FlaxMamba2] dt (step) sample values: [-0.09310865 -2.732858    1.0596217   0.45003095  1.4713472 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.21160093  0.5649321   0.07681827 -0.9858096   0.9581109 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.15099669  0.02096634 -0.08673897 -0.0934182  -0.28591028]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.15495634 -0.00955124 -0.09877815 -0.17349634 -0.36818567]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.08346906 -0.00475281 -0.04695178 -0.07924174 -0.15058039]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.08346906 -0.00475281 -0.04695178 -0.07924174 -0.15058039]
  [FlaxMamba2] B (step) sample values: [-0.0251323  -0.03753066 -0.27736598  0.050554   -0.01073222]
  [FlaxMamba2] C (step) sample values: [ 0.03858517 -0.06689456 -0.2446478  -0.02612474 -0.01390876]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.7303779  -7.389056   -3.3796544  -1.802826  -17.760078 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.0469537e-02 1.3975886e-05 1.8380634e-02 3.0119972e-02 3.6029142e-01]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.98204684 0.99989676 0.9397699  0.9471469  0.00166355]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.08346906 -0.00475281 -0.04695178 -0.07924174 -0.15058039]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.1962673e-05 -3.2797387e-05 -2.4238524e-04  4.4178250e-05
 -9.3786948e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.1962673e-05 -3.2797387e-05 -2.4238524e-04  4.4178250e-05
 -9.3786948e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.8154527e-04  4.6983978e-04  6.1461207e-04 -1.6792303e-04
 -4.1297444e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-6.7121546e-05  1.0347742e-03 -1.0229776e-03 -4.1213944e-03
 -2.8619007e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.11865474 -0.00572537 -0.06780465 -0.11683055 -0.2170393 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.11865474 -0.00572537 -0.06780465 -0.11683055 -0.2170393 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00486391  0.00139075  0.01102284 -0.00690199  0.05757118]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.28613317  0.09163589  0.68772745 -0.3789753   4.3043494 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.28613317  0.09163589  0.68772745 -0.3789753   4.3043494 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 37.449104  -5.850029 -16.2781     8.570654  33.418804]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 37.449104  -5.850029 -16.2781     8.570654  33.418804]
  [Layer 48] Output shape after mixer: (1, 1, 1024)
  [Layer 48] Output sample values after mixer: [ 37.449104  -5.850029 -16.2781     8.570654  33.418804]
  [Layer 48] Residual connection shape: (1, 1, 1024)
  [Layer 48] Residual connection sample values: [ 22.83129  -17.413918 -36.3237    -9.150787  38.072655]
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.3169315  -0.34921753 -0.57687664 -0.1147236   0.54363275]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 1, 1024)
[Mamba2LMHeadModel] Final backbone norm output sample values: [ 0.3169315  -0.34921753 -0.57687664 -0.1147236   0.54363275]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 1, 50288)
[Mamba2LMHeadModel] Logits sample values: [57.88656  50.128098 56.75174  57.47701  55.477596]
[Mamba2LMHeadModel] Forward pass input_ids shape: (1, 1)
[Mamba2LMHeadModel] input_ids sample values: [253]
[Mamba2LMHeadModel] Embedding output shape: (1, 1, 1024)
[Mamba2LMHeadModel] Embedding sample values: [-0.1348877  -0.03662109 -0.26635742 -0.02131653  0.2355957 ]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.18188423 -0.06284313 -0.39386988 -0.02456207  0.29748178]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18188423 -0.06284313 -0.39386988 -0.02456207  0.29748178]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18188423 -0.06284313 -0.39386988 -0.02456207  0.29748178]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.21013384  0.8613406   0.32152975  0.2665166  -0.18941198]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.21013384  0.8613406   0.32152975  0.2665166  -0.18941198]
  [FlaxMamba2] xBC (step) sample values: [ 0.64639604  3.4875457   0.70141697 -0.7220898   1.2973881 ]
  [FlaxMamba2] dt (step) sample values: [ 0.4148918   0.09162405  0.19863752  0.2135621  -0.06532843]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [0.64639604 0.08863552 0.07741071 0.64639604 3.4875457 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00375231 -0.21436736  0.01943257 -0.14562555 -0.02809167]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04632433 -0.2219586   0.13216451 -0.3550982  -0.22523522]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.02369856 -0.09871322  0.07044277 -0.14635254 -0.09998823]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02369856 -0.09871322  0.07044277 -0.14635254 -0.09998823]
  [FlaxMamba2] B (step) sample values: [-0.21920606 -0.0906469   0.01345709  0.64756167  0.02071332]
  [FlaxMamba2] C (step) sample values: [-0.25360778 -0.05051282  0.26058415 -0.20149639  0.0177735 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.4383634 -1.0010935 -1.2128745 -1.1529616 -1.4844131]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08321088 0.03709881 0.02961917 0.03221252 0.02104639]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.96418065 0.9635418  0.9647133  0.96354145 0.96924144]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02369856 -0.09871322  0.07044277 -0.14635254 -0.09998823]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.3226947e-04 -1.7875367e-04  2.6537091e-05  1.2769772e-03
  4.0846204e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.3226947e-04 -1.7875367e-04  2.6537091e-05  1.2769772e-03
  4.0846204e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01938242 -0.00398052 -0.00073414  0.04755516 -0.00063539]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.17145248  0.01423825  0.4881671  -0.7880955  -0.5782293 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.21209697 -0.15506105  0.60898083 -1.0390992  -0.7497153 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.21209697 -0.15506105  0.60898083 -1.0390992  -0.7497153 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02461715 -0.09388503  0.11350784 -0.15681222  0.0642982 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00235865 -0.00742417  0.00896996 -0.01016135  0.02133349]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00235865 -0.00742417  0.00896996 -0.01016135  0.02133349]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.08323161 -0.08486687 -0.01798515 -0.01705777 -0.04131984]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.08323161 -0.08486687 -0.01798515 -0.01705777 -0.04131984]
  [Layer 1] Output shape after mixer: (1, 1, 1024)
  [Layer 1] Output sample values after mixer: [ 0.08323161 -0.08486687 -0.01798515 -0.01705777 -0.04131984]
  [Layer 1] Residual connection shape: (1, 1, 1024)
  [Layer 1] Residual connection sample values: [-0.05165608 -0.12148797 -0.28434256 -0.03837429  0.19427587]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.13139175 -0.25951532 -0.5606258  -0.10264142  0.4498797 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.13139175 -0.25951532 -0.5606258  -0.10264142  0.4498797 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.13139175 -0.25951532 -0.5606258  -0.10264142  0.4498797 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.3209126  -0.62118787  0.28646395  2.8418334  -0.92502844]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.3209126  -0.62118787  0.28646395  2.8418334  -0.92502844]
  [FlaxMamba2] xBC (step) sample values: [ 0.06908027 -0.08440048 -0.23075266  0.5159766  -0.24884465]
  [FlaxMamba2] dt (step) sample values: [ 0.16394417  1.4270291  -0.2891718   0.9090572   1.0526823 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.13903707  1.82328    -0.5496252   0.06908027  0.00776791]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.08667304 -0.01560786 -0.07951383  0.4046362  -0.11835778]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.07734229 -0.04553034 -0.19133022  0.26059324 -0.11497986]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.04016586 -0.02224701 -0.08654112  0.1471784  -0.05418847]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04016586 -0.02224701 -0.08654112  0.1471784  -0.05418847]
  [FlaxMamba2] B (step) sample values: [-0.02566001  0.03362177  0.11520202  0.05186414 -0.01591287]
  [FlaxMamba2] C (step) sample values: [ 0.05933668 -0.08975229 -0.25653985 -0.16524614  0.03154901]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-12.692555   -19.429585    -0.22886811  -2.10566     -5.0388985 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05909326 0.13823219 0.01850261 0.14888376 0.15452895]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.4723456  0.06816705 0.99577427 0.7308854  0.4590227 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04016586 -0.02224701 -0.08654112  0.1471784  -0.05418847]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.0904826e-05  7.9802332e-05  2.7343561e-04  1.2310116e-04
 -3.7769685e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.0904826e-05  7.9802332e-05  2.7343561e-04  1.2310116e-04
 -3.7769685e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.9582407e-05  5.6038401e-04  4.5604733e-04 -4.7205423e-04
 -1.3580301e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00277643 -0.00117919 -0.00486415  0.00934052  0.00031466]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.0239992  -0.01600964 -0.06255478  0.10745358 -0.03580882]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.0239992  -0.01600964 -0.06255478  0.10745358 -0.03580882]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00446346  0.00347589 -0.01023448  0.28853804  0.0094051 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00125832  0.0013776  -0.00367134  0.0681549   0.00387718]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00125832  0.0013776  -0.00367134  0.0681549   0.00387718]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.11477442  0.07091627 -0.01515026  0.12722094 -0.05349473]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.11477442  0.07091627 -0.01515026  0.12722094 -0.05349473]
  [Layer 2] Output shape after mixer: (1, 1, 1024)
  [Layer 2] Output sample values after mixer: [ 0.11477442  0.07091627 -0.01515026  0.12722094 -0.05349473]
  [Layer 2] Residual connection shape: (1, 1, 1024)
  [Layer 2] Residual connection sample values: [ 0.06311834 -0.0505717  -0.2994928   0.08884665  0.14078113]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.1784958  -0.1200099  -0.63307047  0.2689184   0.37998545]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.1784958  -0.1200099  -0.63307047  0.2689184   0.37998545]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.1784958  -0.1200099  -0.63307047  0.2689184   0.37998545]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.34115532  0.74286187 -1.8497535  -0.42435127 -0.98497903]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.34115532  0.74286187 -1.8497535  -0.42435127 -0.98497903]
  [FlaxMamba2] xBC (step) sample values: [-0.28603148 -0.11629307  2.7931259  -0.47417638  0.54008454]
  [FlaxMamba2] dt (step) sample values: [1.480125   0.32613912 0.74325126 0.39475572 0.29062906]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.21543829 -0.5940917   0.307889   -0.28603148 -0.02611619]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00787864 -0.25176108 -0.27858883  0.10626019  0.19563463]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.05273948 -0.32951987 -0.32970577  0.05962933  0.12880114]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.02567454 -0.13785708 -0.13791996  0.03070332  0.06854228]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02567454 -0.13785708 -0.13791996  0.03070332  0.06854228]
  [FlaxMamba2] B (step) sample values: [-0.07324973  0.02802258  0.10115786  0.00153761 -0.2725052 ]
  [FlaxMamba2] C (step) sample values: [-0.27789107  0.32002005  0.4974841   0.6482068   0.53078234]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-20.926485    -0.880345    -0.67350245  -0.6461216   -0.27258503]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [5.4035809e-02 6.7020692e-03 9.4717754e-05 7.7572661e-03 1.3752049e-02]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.32278156 0.99411726 0.9999362  0.9950004  0.99625844]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02567454 -0.13785708 -0.13791996  0.03070332  0.06854228]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0162260e-04 -3.8876969e-05 -1.4034080e-04 -2.1331930e-06
  3.7805855e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0162260e-04 -3.8876969e-05 -1.4034080e-04 -2.1331930e-06
  3.7805855e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.2130410e-04 -2.4285457e-04 -1.9270259e-04  6.7681926e-06
  3.8961487e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00171008  0.00877439  0.00575157 -0.00137441 -0.00663146]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01651643 -0.08909118 -0.09215865  0.02042206  0.04202712]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01651643 -0.08909118 -0.09215865  0.02042206  0.04202712]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00234137 -0.04484664  0.0231673  -0.00342725 -0.01125573]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00055775 -0.0095311   0.00388964 -0.00064034 -0.00312527]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00055775 -0.0095311   0.00388964 -0.00064034 -0.00312527]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.04673817 -0.03671413 -0.07599764  0.0578593   0.03148013]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.04673817 -0.03671413 -0.07599764  0.0578593   0.03148013]
  [Layer 3] Output shape after mixer: (1, 1, 1024)
  [Layer 3] Output sample values after mixer: [-0.04673817 -0.03671413 -0.07599764  0.0578593   0.03148013]
  [Layer 3] Residual connection shape: (1, 1, 1024)
  [Layer 3] Residual connection sample values: [ 0.01638016 -0.08728583 -0.37549043  0.14670596  0.17226127]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.02747833 -0.12681249 -0.5135615   0.26166528  0.27190536]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.02747833 -0.12681249 -0.5135615   0.26166528  0.27190536]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.02747833 -0.12681249 -0.5135615   0.26166528  0.27190536]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 3.0712497   0.20100154 -0.38148955  0.50481045  1.1912894 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 3.0712497   0.20100154 -0.38148955  0.50481045  1.1912894 ]
  [FlaxMamba2] xBC (step) sample values: [-1.043289   -0.61502504  0.03823647 -1.6472045   1.5263191 ]
  [FlaxMamba2] dt (step) sample values: [0.37151274 0.38461906 0.48424268 0.01454475 0.35502276]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.05910201 -0.19602846 -0.53104764 -1.043289   -0.305127  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.11836071  0.04914713  0.20217636 -0.56764674  0.04640302]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.14040966  0.06170511  0.16177109 -0.632344    0.30543622]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.07512547  0.03180413  0.08741378 -0.21941024  0.1758613 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.07512547  0.03180413  0.08741378 -0.21941024  0.1758613 ]
  [FlaxMamba2] B (step) sample values: [-0.26992545  0.20262885 -0.02332139  0.06023197  0.01635934]
  [FlaxMamba2] C (step) sample values: [-0.27691665 -0.21740505  0.7987247  -0.03080998  0.1441878 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.49070406 -0.5047996  -0.6491257  -0.5552266  -0.46572492]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06450632 0.08266684 0.13213162 0.04009486 0.44303277]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9688422  0.9591285  0.91780525 0.97798425 0.8135634 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.07512547  0.03180413  0.08741378 -0.21941024  0.1758613 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.3080770e-03  9.8195311e-04 -1.1301703e-04  2.9188822e-04
  7.9278478e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.3080770e-03  9.8195311e-04 -1.1301703e-04  2.9188822e-04
  7.9278478e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.03248923 -0.0027282   0.00038275  0.00249084 -0.00065686]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.06362464  0.00233946  0.01319292 -0.1598694   0.26255098]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.11345915  0.02343674  0.07117888 -0.30541527  0.37920865]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.11345915  0.02343674  0.07117888 -0.30541527  0.37920865]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.33302143  0.00259134 -0.01101821 -0.09614298  0.34647733]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13297856  0.00111124 -0.00394601 -0.03791775  0.09950192]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.13297856  0.00111124 -0.00394601 -0.03791775  0.09950192]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.02952216 -0.00477295  0.02023279  0.0678132  -0.06822888]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.02952216 -0.00477295  0.02023279  0.0678132  -0.06822888]
  [Layer 4] Output shape after mixer: (1, 1, 1024)
  [Layer 4] Output sample values after mixer: [-0.02952216 -0.00477295  0.02023279  0.0678132  -0.06822888]
  [Layer 4] Residual connection shape: (1, 1, 1024)
  [Layer 4] Residual connection sample values: [-0.013142   -0.09205878 -0.35525763  0.21451916  0.10403239]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.02746041 -0.16217108 -0.5469931   0.44691893  0.2062199 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.02746041 -0.16217108 -0.5469931   0.44691893  0.2062199 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.02746041 -0.16217108 -0.5469931   0.44691893  0.2062199 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.41970742 -0.5146957  -0.8237962  -0.09008268 -0.13373548]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.41970742 -0.5146957  -0.8237962  -0.09008268 -0.13373548]
  [FlaxMamba2] xBC (step) sample values: [-1.2361823 -1.2377851 -1.3290215  0.820983   1.2489413]
  [FlaxMamba2] dt (step) sample values: [ 0.6617175   0.48268843 -0.23677166  0.78933597  1.3589667 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.8512082  -2.9133613  -0.01039147 -1.2361823   0.04946149]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.61599904 -1.2744404  -0.3154768  -0.15758672 -0.3086427 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.67935354 -1.5157734  -0.32282773 -0.130716   -0.29770213]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.22853833 -0.27296767 -0.13558337 -0.0610924  -0.12685664]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.22853833 -0.27296767 -0.13558337 -0.0610924  -0.12685664]
  [FlaxMamba2] B (step) sample values: [-0.07834296  0.13202503 -0.24222012 -0.05757527 -0.02514837]
  [FlaxMamba2] C (step) sample values: [ 0.02664642  0.12594287 -0.21927622 -0.27606753 -0.13106318]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.07591622 -0.53187454 -0.04695368 -1.4938657  -3.6258397 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.28563216 0.0225878  0.02917056 0.03068872 0.06170888]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9785493  0.98805803 0.9986313  0.9551902  0.7995178 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.22853833 -0.27296767 -0.13558337 -0.0610924  -0.12685664]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00511406 -0.00861832  0.01581162  0.00375839  0.00164163]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00511406 -0.00861832  0.01581162  0.00375839  0.00164163]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01198825 -0.00478239  0.5108922   0.04691142  0.0085172 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-1.0246637  -1.22041    -0.88463897 -0.38505745 -0.33872187]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-1.3462839  -1.6045554  -1.0754445  -0.47103232 -0.51724625]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-1.3462839  -1.6045554  -1.0754445  -0.47103232 -0.51724625]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [0.2240895  0.30894792 0.27017704 0.02026098 0.03227777]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.00654691 0.0095394  0.01708096 0.00140771 0.00243763]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.00654691 0.0095394  0.01708096 0.00140771 0.00243763]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.00555703 -0.13181525  0.05093384  0.1373393   0.14610136]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.00555703 -0.13181525  0.05093384  0.1373393   0.14610136]
  [Layer 5] Output shape after mixer: (1, 1, 1024)
  [Layer 5] Output sample values after mixer: [ 0.00555703 -0.13181525  0.05093384  0.1373393   0.14610136]
  [Layer 5] Residual connection shape: (1, 1, 1024)
  [Layer 5] Residual connection sample values: [-0.00758497 -0.22387403 -0.3043238   0.35185844  0.25013375]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.0093796  -0.2287047  -0.29334015  0.4171368   0.27634448]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0093796  -0.2287047  -0.29334015  0.4171368   0.27634448]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0093796  -0.2287047  -0.29334015  0.4171368   0.27634448]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.7149243   0.12359957  0.17071585 -1.585913    0.00696432]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.7149243   0.12359957  0.17071585 -1.585913    0.00696432]
  [FlaxMamba2] xBC (step) sample values: [ 0.8933227  -0.4442959  -1.1514765   0.8881194  -0.48690167]
  [FlaxMamba2] dt (step) sample values: [1.2333481 0.5994678 1.460001  1.4424608 1.509385 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.1230701   0.06041868 -0.79676634  0.8933227  -0.9853393 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.18519282  0.04873133 -0.27598995  0.04718967 -0.14252014]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.13795161  0.06272364 -0.19475216  0.03550906 -0.00433655]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.07372594  0.03234506 -0.08792384  0.01806972 -0.00216357]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.07372594  0.03234506 -0.08792384  0.01806972 -0.00216357]
  [FlaxMamba2] B (step) sample values: [ 0.03312089 -0.05967508 -0.2775767   0.02248277 -0.0638071 ]
  [FlaxMamba2] C (step) sample values: [ 0.24698971 -0.10436232 -0.2739849  -0.01582658  0.09924992]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.5109995  -0.28622514 -0.5421001  -0.39544863 -0.5985869 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.44108063 0.20245877 0.3093538  0.48827967 0.37255934]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7982033  0.9436983  0.84560686 0.8244082  0.80010754]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.07372594  0.03234506 -0.08792384  0.01806972 -0.00216357]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00107706 -0.00194058 -0.00902654  0.00073112 -0.00207495]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00107706 -0.00194058 -0.00902654  0.00073112 -0.00207495]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0045928  -0.00672252  0.00626998  0.00462527  0.00451523]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-8.2687028e-03  4.3197640e-05 -2.4502663e-02  3.7353325e-03
  1.3095421e-01]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.07629864  0.0371446  -0.1253557   0.02446221  0.12847248]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.07629864  0.0371446  -0.1253557   0.02446221  0.12847248]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.11088891  0.00243721 -0.01161123 -0.00659357  0.00044892]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03145687  0.00066163 -0.00299704 -0.0020931   0.00010371]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03145687  0.00066163 -0.00299704 -0.0020931   0.00010371]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.10666621 -0.17161784 -0.22025491 -0.03304614  0.1825527 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.10666621 -0.17161784 -0.22025491 -0.03304614  0.1825527 ]
  [Layer 6] Output shape after mixer: (1, 1, 1024)
  [Layer 6] Output sample values after mixer: [-0.10666621 -0.17161784 -0.22025491 -0.03304614  0.1825527 ]
  [Layer 6] Residual connection shape: (1, 1, 1024)
  [Layer 6] Residual connection sample values: [-0.11425119 -0.39549187 -0.5245787   0.3188123   0.43268645]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.12967904 -0.36459702 -0.46962303  0.36526075  0.42589566]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.12967904 -0.36459702 -0.46962303  0.36526075  0.42589566]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.12967904 -0.36459702 -0.46962303  0.36526075  0.42589566]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.25772524 -1.4595045  -1.4850761   0.77346647 -0.59669423]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.25772524 -1.4595045  -1.4850761   0.77346647 -0.59669423]
  [FlaxMamba2] xBC (step) sample values: [-2.6750462  -0.95261556 -0.49710956 -0.2501428   1.6341989 ]
  [FlaxMamba2] dt (step) sample values: [ 0.6589916  2.2828918  3.0261145  1.3642967 -0.3713726]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.3473907   0.35408875 -1.0369145  -2.6750462  -2.3346946 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.55022204 -0.19692686 -0.07742347  0.07828183  0.10441348]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.5838524  -0.26821592 -0.20840491  0.08675046  0.1016688 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.20904638 -0.11623006 -0.09338343  0.04525546  0.05341632]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.20904638 -0.11623006 -0.09338343  0.04525546  0.05341632]
  [FlaxMamba2] B (step) sample values: [-0.02147998  0.05704414 -0.09963585 -0.05076112  0.11712433]
  [FlaxMamba2] C (step) sample values: [-0.07520109 -0.09461862  0.11169888  0.08374333 -0.09186998]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-6.5957151e-02 -4.5478220e+00 -5.8281250e+00 -4.2033669e-01
 -1.9005252e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.80974174 0.28540963 0.566903   0.46060264 0.13728169]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9479929  0.2730795  0.03673661 0.8239807  0.9997391 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.20904638 -0.11623006 -0.09338343  0.04525546  0.05341632]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00363599 -0.00965607  0.01686572  0.00859252 -0.01982605]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00363599 -0.00965607  0.01686572  0.00859252 -0.01982605]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0948633   0.00206391 -0.00632419  0.01708873  0.0489456 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.12780358 -0.09700408 -0.08722683  0.00859919  0.01236628]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.6124888  -0.3664897  -0.30374134  0.1135264   0.13621487]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.6124888  -0.3664897  -0.30374134  0.1135264   0.13621487]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.06881211  0.10085047  0.08329712  0.060085   -0.02886207]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01686776  0.0298353   0.01477541  0.01291002 -0.01357131]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01686776  0.0298353   0.01477541  0.01291002 -0.01357131]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.02907588  0.14538644  0.03601365 -0.03312531 -0.18881701]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.02907588  0.14538644  0.03601365 -0.03312531 -0.18881701]
  [Layer 7] Output shape after mixer: (1, 1, 1024)
  [Layer 7] Output sample values after mixer: [ 0.02907588  0.14538644  0.03601365 -0.03312531 -0.18881701]
  [Layer 7] Residual connection shape: (1, 1, 1024)
  [Layer 7] Residual connection sample values: [-0.08517531 -0.25010544 -0.48856503  0.285687    0.24386944]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.10762616 -0.23657784 -0.4318562   0.35158205  0.25823468]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.10762616 -0.23657784 -0.4318562   0.35158205  0.25823468]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.10762616 -0.23657784 -0.4318562   0.35158205  0.25823468]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.1167593   1.2663746  -3.4047692  -0.13147452 -0.7347013 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.1167593   1.2663746  -3.4047692  -0.13147452 -0.7347013 ]
  [FlaxMamba2] xBC (step) sample values: [-1.8329356  0.5714168 -1.4418645  1.0541402  0.7906878]
  [FlaxMamba2] dt (step) sample values: [1.5502776 4.2470937 2.9821696 2.3588202 4.06299  ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.0932546  1.9844451  0.5381477 -1.8329356 -0.414612 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.27821404 -0.22807524  0.32295832  0.10742299 -0.01449488]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.35560662 -0.14702055  0.38930354  0.01049916 -0.07705592]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.14651828 -0.06811623  0.23206967  0.00527714 -0.03704429]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.14651828 -0.06811623  0.23206967  0.00527714 -0.03704429]
  [FlaxMamba2] B (step) sample values: [-0.0469171   0.26599455 -0.02199295  0.08401717  0.00139872]
  [FlaxMamba2] C (step) sample values: [-0.00645125 -0.00616309 -0.11808928  0.03124708 -0.09028769]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6851114  -0.13800453 -0.41180432 -0.26783535 -0.12443344]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08579315 5.5683007  2.1499655  1.8148979  5.167339  ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9429162  0.463731   0.41256353 0.6150241  0.52571833]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.14651828 -0.06811623  0.23206967  0.00527714 -0.03704429]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.8976025e-04 -3.3436217e-03  2.7645717e-04 -1.0561181e-03
 -1.7582253e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.8976025e-04 -3.3436217e-03  2.7645717e-04 -1.0561181e-03
 -1.7582253e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00376079 -0.02535144  0.00033581 -0.02865387  0.0078519 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.14092685 -0.02614377  0.07039277 -0.06985698  0.04144894]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.69277525 -0.28269765  0.94446313 -0.04998109 -0.09807517]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.69277525 -0.28269765  0.94446313 -0.04998109 -0.09807517]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.19079533 -0.2792844  -0.10337362  0.00306994  0.02335794]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02248901 -0.01737557 -0.01980773  0.00050098  0.00261391]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02248901 -0.01737557 -0.01980773  0.00050098  0.00261391]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.17064844  0.3580746  -0.15892883  0.04864419 -0.14804028]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.17064844  0.3580746  -0.15892883  0.04864419 -0.14804028]
  [Layer 8] Output shape after mixer: (1, 1, 1024)
  [Layer 8] Output sample values after mixer: [ 0.17064844  0.3580746  -0.15892883  0.04864419 -0.14804028]
  [Layer 8] Residual connection shape: (1, 1, 1024)
  [Layer 8] Residual connection sample values: [ 0.08547313  0.10796916 -0.64749384  0.33433118  0.09582916]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.08420061  0.08219888 -0.47195783  0.33022782  0.08222636]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.08420061  0.08219888 -0.47195783  0.33022782  0.08222636]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.08420061  0.08219888 -0.47195783  0.33022782  0.08222636]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.98439    -2.539697   -0.307127   -0.9359907   0.36696023]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.98439    -2.539697   -0.307127   -0.9359907   0.36696023]
  [FlaxMamba2] xBC (step) sample values: [2.839903   2.0542326  0.06976454 1.6937832  0.1929235 ]
  [FlaxMamba2] dt (step) sample values: [2.6761303 3.877929  1.9475179 3.0853267 2.3977168]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [2.100877   3.729537   1.9979417  2.839903   0.81163734]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-1.3193216  -0.09118536  0.02956662  0.1286554   0.04523663]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-1.5727396e+00 -6.7022443e-04  2.5400966e-02  1.3538072e-01
  2.6575133e-02]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.27023783 -0.000335    0.01286178  0.07226536  0.01346411]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.27023783 -0.000335    0.01286178  0.07226536  0.01346411]
  [FlaxMamba2] B (step) sample values: [-0.03129658 -0.01004777  0.20759812 -0.11932992  0.14057457]
  [FlaxMamba2] C (step) sample values: [ 0.09231025 -0.26868862 -0.10053089 -0.14170103 -0.08134823]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17008033 -0.11351943 -0.10539922 -0.5864362  -0.14965628]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [3.1374838 4.692796  3.7591825 1.7822553 2.6631134]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.58647555 0.58700407 0.67286205 0.35162887 0.6712916 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.27023783 -0.000335    0.01286178  0.07226536  0.01346411]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.02653533  0.00851917 -0.17601556  0.10117588 -0.11918852]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.02653533  0.00851917 -0.17601556  0.10117588 -0.11918852]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.03618195  0.02541205 -0.35627225  0.25538525 -0.3055625 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.27191007  0.11811499  0.00869763  0.00886261  0.02520217]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.99600387  0.11721737  0.04316036  0.20249537  0.06127884]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.99600387  0.11721737  0.04316036  0.20249537  0.06127884]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.26670527 -0.02176808 -0.00561798 -0.05339373  0.01328356]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0245039  -0.00372773 -0.00064331 -0.00701355  0.00175173]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0245039  -0.00372773 -0.00064331 -0.00701355  0.00175173]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.08403156 -0.07033169  0.21633017 -0.02558984  0.12066796]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.08403156 -0.07033169  0.21633017 -0.02558984  0.12066796]
  [Layer 9] Output shape after mixer: (1, 1, 1024)
  [Layer 9] Output sample values after mixer: [ 0.08403156 -0.07033169  0.21633017 -0.02558984  0.12066796]
  [Layer 9] Residual connection shape: (1, 1, 1024)
  [Layer 9] Residual connection sample values: [ 0.16950469  0.03763747 -0.43116367  0.30874133  0.21649712]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.17065875  0.02894998 -0.32369497  0.30576774  0.18453668]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.17065875  0.02894998 -0.32369497  0.30576774  0.18453668]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.17065875  0.02894998 -0.32369497  0.30576774  0.18453668]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.2098804  -1.080377    0.736857   -3.410275    0.54089123]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-2.2098804  -1.080377    0.736857   -3.410275    0.54089123]
  [FlaxMamba2] xBC (step) sample values: [-1.1175879  -0.5647476  -2.0711985   2.0793943  -0.26314464]
  [FlaxMamba2] dt (step) sample values: [2.7670345  1.140567   1.4048691  2.4193249  0.62138236]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.0003026   0.16141228  1.1222445  -1.1175879   1.354348  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.48023796  0.4996475   0.3791766   0.50844187 -0.08225474]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.30994987  0.47570646  0.34121272  1.1124458  -0.03336558]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.17880172  0.2933841   0.19943373  0.83720976 -0.0164045 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.17880172  0.2933841   0.19943373  0.83720976 -0.0164045 ]
  [FlaxMamba2] B (step) sample values: [-0.07419268  0.02452774 -0.04626631 -0.07711763  0.29564112]
  [FlaxMamba2] C (step) sample values: [-0.24204898 -0.2778776  -0.23746789 -0.22068043  0.15392628]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.08535489 -0.07711172 -0.08452541 -0.0546804  -0.06966463]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [3.8672733  0.26435596 0.3267892  3.5481348  0.88146174]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.71885854 0.97982144 0.972756   0.82364684 0.94044065]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.17880172  0.2933841   0.19943373  0.83720976 -0.0164045 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.05130239  0.01696032 -0.031992   -0.05332492  0.20442848]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.05130239  0.01696032 -0.031992   -0.05332492  0.20442848]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.03727457 -0.65366364 -0.06486943  0.27709633  0.16180195]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-1.024404    0.9551979  -0.07037779  9.391119   -0.72727567]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.15379292  2.383727    0.9006936  13.467613   -0.80715156]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.15379292  2.383727    0.9006936  13.467613   -0.80715156]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03360124 -0.65267634  0.4488538  -1.4685968  -0.27592793]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0009001  -0.03737507  0.028187   -0.07093226 -0.0161559 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0009001  -0.03737507  0.028187   -0.07093226 -0.0161559 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.2723632  -0.1462393   0.38461632 -0.03433501  0.06361972]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.2723632  -0.1462393   0.38461632 -0.03433501  0.06361972]
  [Layer 10] Output shape after mixer: (1, 1, 1024)
  [Layer 10] Output sample values after mixer: [ 0.2723632  -0.1462393   0.38461632 -0.03433501  0.06361972]
  [Layer 10] Residual connection shape: (1, 1, 1024)
  [Layer 10] Residual connection sample values: [ 0.4418679  -0.10860182 -0.04654735  0.2744063   0.28011686]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.29113212 -0.0580561  -0.02413668  0.19742225  0.16334596]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.29113212 -0.0580561  -0.02413668  0.19742225  0.16334596]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.29113212 -0.0580561  -0.02413668  0.19742225  0.16334596]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.9724122 -1.4060695 -2.6754584  0.703696  -1.0505999]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.9724122 -1.4060695 -2.6754584  0.703696  -1.0505999]
  [FlaxMamba2] xBC (step) sample values: [ 0.20363046 -1.4009993  -0.83358663 -0.11457967 -1.3077525 ]
  [FlaxMamba2] dt (step) sample values: [-0.6673664  -0.56515586 -0.28059492  3.093331    2.6865747 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.1525992  -1.5224556  -0.6484644   0.20363046 -0.23637857]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.11239771  0.22079244  0.22913529  0.01967743 -0.23128012]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03408667  0.41195455  0.25306106  0.1270993  -0.11628988]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.01733378  0.24781393  0.14245561  0.06758279 -0.05476791]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01733378  0.24781393  0.14245561  0.06758279 -0.05476791]
  [FlaxMamba2] B (step) sample values: [-0.26424545  0.05591491 -0.14480808 -0.04782224 -0.12471507]
  [FlaxMamba2] C (step) sample values: [-0.21354528 -0.13442978 -0.02055496  0.00034148 -0.2783762 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.25934154 -0.12614636 -0.10356269 -0.23775288 -0.43051487]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11133305 0.04065076 0.11648976 2.9168954  2.8034704 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.97153956 0.9948852  0.9880085  0.49982348 0.29911247]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01733378  0.24781393  0.14245561  0.06758279 -0.05476791]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.0994690e-04  1.0790587e-04 -2.7945393e-04 -9.2288443e-05
 -2.4067797e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.0994690e-04  1.0790587e-04 -2.7945393e-04 -9.2288443e-05
 -2.4067797e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.18305649  0.01174934  0.02026808 -0.07940823  0.10596591]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [0.35582933 0.3615658  0.3559817  0.18960126 0.49326628]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.30115607 -0.42007503 -0.09334379 -0.02356459  0.66601217]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.30115607 -0.42007503 -0.09334379 -0.02356459  0.66601217]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.52145827  0.11627318  0.01609236 -0.01109368 -0.1813024 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02253343  0.0372025   0.009237   -0.00119696 -0.0228329 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02253343  0.0372025   0.009237   -0.00119696 -0.0228329 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.17198706 -0.08100678  0.27091026  0.43508056  0.10996685]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.17198706 -0.08100678  0.27091026  0.43508056  0.10996685]
  [Layer 11] Output shape after mixer: (1, 1, 1024)
  [Layer 11] Output sample values after mixer: [-0.17198706 -0.08100678  0.27091026  0.43508056  0.10996685]
  [Layer 11] Residual connection shape: (1, 1, 1024)
  [Layer 11] Residual connection sample values: [ 0.26988083 -0.1896086   0.22436291  0.70948684  0.3900837 ]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.13691838 -0.0766328   0.08292033  0.40819156  0.1674545 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.13691838 -0.0766328   0.08292033  0.40819156  0.1674545 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.13691838 -0.0766328   0.08292033  0.40819156  0.1674545 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.27701816 -1.1193311   1.1502416  -0.81000584  0.22330655]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.27701816 -1.1193311   1.1502416  -0.81000584  0.22330655]
  [FlaxMamba2] xBC (step) sample values: [-0.16463476  1.1181682  -0.34054506  1.4908634  -1.3295094 ]
  [FlaxMamba2] dt (step) sample values: [0.61765265 0.6921688  0.05683352 0.2688154  0.72913533]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.75309384 -2.45501     0.28649288 -0.16463476  1.349661  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.13640927 -1.2440443  -0.02077129  0.18064378 -0.3429863 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.06920956 -2.078517   -0.0855296   0.13642381 -0.50961226]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.03580179 -0.23113619 -0.04093708  0.07285757 -0.19124953]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03580179 -0.23113619 -0.04093708  0.07285757 -0.19124953]
  [FlaxMamba2] B (step) sample values: [ 0.24073552 -0.03142342 -0.08810307  0.51262337 -0.0140458 ]
  [FlaxMamba2] C (step) sample values: [ 0.16236909 -0.24283788 -0.12649475 -0.27291062  0.41955918]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.16087165 -0.14748003 -0.27125728 -0.11553253 -0.09015273]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.4179506  0.936098   1.1734586  1.7886701  0.13967094]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.79603827 0.8710501  0.7273779  0.8133046  0.9874872 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03580179 -0.23113619 -0.04093708  0.07285757 -0.19124953]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01222098 -0.00159522 -0.00447257  0.02602342 -0.00071304]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01222098 -0.00159522 -0.00447257  0.02602342 -0.00071304]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0255249   0.02406652  0.02882211 -0.13355501 -0.02268179]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.19745407 -0.7467464  -0.10634775  0.03995636  1.1423849 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.13935272 -1.1218483  -0.17278296  0.15819407  0.8320135 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.13935272 -1.1218483  -0.17278296  0.15819407  0.8320135 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01664514  0.30907705 -0.1509556  -0.03945235  0.1032264 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00387523  0.04204478 -0.04021059 -0.01983601  0.02067672]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00387523  0.04204478 -0.04021059 -0.01983601  0.02067672]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.05759493 -0.08010174 -0.06053512  0.21551678 -0.37561956]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.05759493 -0.08010174 -0.06053512  0.21551678 -0.37561956]
  [Layer 12] Output shape after mixer: (1, 1, 1024)
  [Layer 12] Output sample values after mixer: [ 0.05759493 -0.08010174 -0.06053512  0.21551678 -0.37561956]
  [Layer 12] Residual connection shape: (1, 1, 1024)
  [Layer 12] Residual connection sample values: [ 0.32747576 -0.26971033  0.16382779  0.92500365  0.01446414]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.13330151 -0.08965496  0.05183782  0.40510118  0.00528141]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.13330151 -0.08965496  0.05183782  0.40510118  0.00528141]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.13330151 -0.08965496  0.05183782  0.40510118  0.00528141]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.08134402  0.03270804 -0.10434069 -0.7229106  -0.51850355]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.08134402  0.03270804 -0.10434069 -0.7229106  -0.51850355]
  [FlaxMamba2] xBC (step) sample values: [-0.11584947 -0.2956195   0.2279825  -0.27644804 -0.19905126]
  [FlaxMamba2] dt (step) sample values: [ 0.7169086  -0.93779695  0.792645    0.6284789  -0.21035051]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5624532  -0.96905917 -0.8990746  -0.11584947 -0.76635426]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.30451608  0.15492956 -0.16144493 -0.00885923 -0.12321612]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.24244332  0.13626806 -0.15356377 -0.02057035 -0.1536574 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.1358448   0.07276911 -0.07089798 -0.01017939 -0.07093764]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.1358448   0.07276911 -0.07089798 -0.01017939 -0.07093764]
  [FlaxMamba2] B (step) sample values: [ 0.10670301 -0.22350657  0.1362732  -0.00952574 -0.10589922]
  [FlaxMamba2] C (step) sample values: [ 0.28436232 -0.19535854  0.1517554   0.12481422 -0.20535018]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.02338035 -1.090337   -0.5085105  -0.67845345 -0.02513249]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10478314 0.00393666 0.01871471 0.00982787 0.12526219]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9975531  0.9957169  0.9905285  0.99335444 0.9968568 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.1358448   0.07276911 -0.07089798 -0.01017939 -0.07093764]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00151884 -0.00318145  0.00193975 -0.00013559 -0.0015074 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00151884 -0.00318145  0.00193975 -0.00013559 -0.0015074 ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.07764547  0.09274412 -0.27589843  0.01969083 -0.06480023]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01355532 -0.04209447  0.10782834 -0.00823377  0.24863864]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02924584 -0.05049954  0.11601729 -0.00705801  0.25683218]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02924584 -0.05049954  0.11601729 -0.00705801  0.25683218]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00114113 -0.00083938 -0.00573718  0.00166719 -0.04969874]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00036341 -0.00017686 -0.00409534  0.00281029 -0.01818501]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00036341 -0.00017686 -0.00409534  0.00281029 -0.01818501]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.1449803e-01  2.5651185e-04  3.0959299e-01  2.1787882e-01
 -1.0990741e-01]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.1449803e-01  2.5651185e-04  3.0959299e-01  2.1787882e-01
 -1.0990741e-01]
  [Layer 13] Output shape after mixer: (1, 1, 1024)
  [Layer 13] Output sample values after mixer: [ 1.1449803e-01  2.5651185e-04  3.0959299e-01  2.1787882e-01
 -1.0990741e-01]
  [Layer 13] Residual connection shape: (1, 1, 1024)
  [Layer 13] Residual connection sample values: [ 0.44197378 -0.26945382  0.4734208   1.1428825  -0.09544327]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.14083447 -0.07412475  0.12736629  0.4120866  -0.0284906 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.14083447 -0.07412475  0.12736629  0.4120866  -0.0284906 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.14083447 -0.07412475  0.12736629  0.4120866  -0.0284906 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.13204797 -0.04344231 -0.34121484  0.35508516 -0.3377929 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.13204797 -0.04344231 -0.34121484  0.35508516 -0.3377929 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.50619423 -1.5005318  -0.34993264 -0.2551976   0.80231005]
  [FlaxMamba2] dt (step) sample values: [ 2.03056   -0.1664347  1.9005291  0.513885   1.7845964]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.33581305 -0.95331764  0.4262729   0.50619423 -0.9601062 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.11173545 -0.517301   -0.53383696  0.13634197 -0.22507589]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04130088 -0.566709   -0.7256094   0.08873455 -0.23885457]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.02022406 -0.20514669 -0.236664    0.04633444 -0.10523183]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02022406 -0.20514669 -0.236664    0.04633444 -0.10523183]
  [FlaxMamba2] B (step) sample values: [-0.00788301 -0.01819235 -0.02016336 -0.01432287 -0.05011583]
  [FlaxMamba2] C (step) sample values: [-0.13710374 -0.10615057 -0.06263856 -0.17171302 -0.12305045]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-7.2744994  -0.03854768 -2.202407   -0.01377147 -5.3377523 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.14679268 0.05074327 0.0761326  0.08207756 0.09331282]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.34374908 0.99804586 0.8456286  0.9988703  0.6076959 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02022406 -0.20514669 -0.236664    0.04633444 -0.10523183]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [2.3402627e-05 5.4008433e-05 5.9859856e-05 4.2520929e-05 1.4878105e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [2.3402627e-05 5.4008433e-05 5.9859856e-05 4.2520929e-05 1.4878105e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.8034868e-05  4.0553768e-05 -5.4776785e-05  1.8185817e-04
 -1.8036430e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00211279 -0.0303141  -0.0373556   0.01084948 -0.01464328]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0180291  -0.19176425 -0.22360983  0.04731462 -0.09746058]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0180291  -0.19176425 -0.22360983  0.04731462 -0.09746058]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [0.00111187 0.00407488 0.03170333 0.00987631 0.01370672]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.00318088 0.0081226  0.04335757 0.01955803 0.03450184]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.00318088 0.0081226  0.04335757 0.01955803 0.03450184]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.5066287   0.41021416 -0.25319594 -0.06804369  0.1706466 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.5066287   0.41021416 -0.25319594 -0.06804369  0.1706466 ]
  [Layer 14] Output shape after mixer: (1, 1, 1024)
  [Layer 14] Output sample values after mixer: [ 0.5066287   0.41021416 -0.25319594 -0.06804369  0.1706466 ]
  [Layer 14] Residual connection shape: (1, 1, 1024)
  [Layer 14] Residual connection sample values: [0.94860244 0.14076033 0.22022486 1.0748388  0.07520332]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [0.34689045 0.04234422 0.06650767 0.46592268 0.02566887]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [0.34689045 0.04234422 0.06650767 0.46592268 0.02566887]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [0.34689045 0.04234422 0.06650767 0.46592268 0.02566887]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.440145   0.8019836  0.6049744 -0.6042609 -2.486895 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.440145   0.8019836  0.6049744 -0.6042609 -2.486895 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.0156238  -0.56235766 -0.10818537 -1.6576874  -0.2144856 ]
  [FlaxMamba2] dt (step) sample values: [1.1241949  1.248864   0.34397396 1.5811802  0.6812899 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.95938224  1.548849    0.15227515  1.0156238  -1.1691777 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.10366959 -0.01573785  0.05218085 -0.33417746  0.01002114]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.43985122 -0.03992303  1.3773762   0.10844949 -0.00346763]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.17232335 -0.0195631   1.0999304   0.05716219 -0.00173081]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.17232335 -0.0195631   1.0999304   0.05716219 -0.00173081]
  [FlaxMamba2] B (step) sample values: [-0.0526658   0.00030917  0.0073219  -0.02417378 -0.07530553]
  [FlaxMamba2] C (step) sample values: [-0.02252005  0.02029072 -0.01229837 -0.02411981 -0.06320556]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.4414158  -0.05923919 -0.7389757  -0.00508607 -0.00871955]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1799336  1.098973   0.0307463  0.21596262 0.2591163 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.6444921 0.9369716 0.9775354 0.9989022 0.9977432]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.17232335 -0.0195631   1.0999304   0.05716219 -0.00173081]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.6329957e-03 -9.5864707e-06 -2.2702826e-04  7.4955041e-04
  2.3349803e-03]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.6329957e-03 -9.5864707e-06 -2.2702826e-04  7.4955041e-04
  2.3349803e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00511083 0.00507624 0.00099099 0.003712   0.00791355]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00906794  0.00027303  0.07318856  0.01406997 -0.00045727]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.31680325 -0.03466279  2.037446    0.1161503  -0.00354815]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.31680325 -0.03466279  2.037446    0.1161503  -0.00354815]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 8.7380901e-02 -1.9192385e-02  7.9723942e-01 -2.4801267e-02
  6.7751552e-04]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.08951522 -0.01435039  0.17520322 -0.01432095  0.00070818]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.08951522 -0.01435039  0.17520322 -0.01432095  0.00070818]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.28220174 -0.45626745 -0.18981847  0.03726964  0.17944475]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.28220174 -0.45626745 -0.18981847  0.03726964  0.17944475]
  [Layer 15] Output shape after mixer: (1, 1, 1024)
  [Layer 15] Output sample values after mixer: [-0.28220174 -0.45626745 -0.18981847  0.03726964  0.17944475]
  [Layer 15] Residual connection shape: (1, 1, 1024)
  [Layer 15] Residual connection sample values: [ 0.6664007  -0.3155071   0.03040639  1.1121083   0.25464806]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.15862107 -0.06206132  0.00557395  0.33586413  0.05730207]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.15862107 -0.06206132  0.00557395  0.33586413  0.05730207]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.15862107 -0.06206132  0.00557395  0.33586413  0.05730207]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.15003103 -0.31388876 -4.449181   -0.02454942 -1.5289402 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.15003103 -0.31388876 -4.449181   -0.02454942 -1.5289402 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.42665908  0.3462187   0.00486619 -0.3464556  -1.5878823 ]
  [FlaxMamba2] dt (step) sample values: [ 5.563948   -0.9152479   2.2675307  -0.25550342  0.8140818 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.4790857   2.1004107  -0.18268262  0.42665908  0.05527499]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01684786 -0.05790568 -0.22156604  0.05311731  0.02020154]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01867129 -0.04910136 -0.08484729  0.01493981  0.02773175]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.00924849 -0.02394807 -0.04062496  0.00752571  0.01405813]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00924849 -0.02394807 -0.04062496  0.00752571  0.01405813]
  [FlaxMamba2] B (step) sample values: [ 0.05345774 -0.04327761 -0.03203887 -0.07337476  0.01287966]
  [FlaxMamba2] C (step) sample values: [ 0.05098115  0.02344117 -0.02608544 -0.21688108  0.02686043]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.1348554e-03 -3.0370306e-03 -2.7156286e+00 -4.1511287e-03
 -4.2925543e-01]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [3.1245263e+00 2.7039975e-02 2.0754427e-01 2.0990750e-02 2.5383267e-03]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9964604  0.99991786 0.5691489  0.99991286 0.998911  ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00924849 -0.02394807 -0.04062496  0.00752571  0.01405813]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00154478  0.0012506   0.00092583  0.00212032 -0.00037219]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00154478  0.0012506   0.00092583  0.00212032 -0.00037219]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.03398535  0.09410612  0.03289916  0.00314759 -0.00276472]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01021549 -0.0136111  -0.04878987  0.030549    0.01208498]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00806304 -0.00803752 -0.03933498  0.0287975   0.00881315]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00806304 -0.00803752 -0.03933498  0.0287975   0.00881315]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00055956  0.00106508  0.00202189 -0.00034914 -0.00240052]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00054753  0.00059333  0.00453402 -0.00013629 -0.00278047]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00054753  0.00059333  0.00453402 -0.00013629 -0.00278047]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.32142857 -0.10289864 -0.10881975  0.08937195  0.1366717 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.32142857 -0.10289864 -0.10881975  0.08937195  0.1366717 ]
  [Layer 16] Output shape after mixer: (1, 1, 1024)
  [Layer 16] Output sample values after mixer: [-0.32142857 -0.10289864 -0.10881975  0.08937195  0.1366717 ]
  [Layer 16] Residual connection shape: (1, 1, 1024)
  [Layer 16] Residual connection sample values: [ 0.3449721  -0.41840577 -0.07841337  1.2014803   0.39131975]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.11145303 -0.11631356 -0.02177999  0.44486848  0.11646272]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.11145303 -0.11631356 -0.02177999  0.44486848  0.11646272]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.11145303 -0.11631356 -0.02177999  0.44486848  0.11646272]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-3.7167966  -0.6127566  -0.27042422 -0.9129838  -2.3023534 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-3.7167966  -0.6127566  -0.27042422 -0.9129838  -2.3023534 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.6221373  -0.9966244  -0.20580144  0.10019135 -1.5157789 ]
  [FlaxMamba2] dt (step) sample values: [2.7798524 2.2917364 1.579866  2.555224  2.1530252]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.2512957   0.33920607 -0.16899     0.6221373  -1.7857795 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.22550371 -0.12101248  0.05631996  0.02329923 -0.3841701 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.32053545 -0.09888723 -0.05812095  0.05772306 -0.28895524]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.13479967 -0.04700093 -0.02821621  0.02969429 -0.12374788]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.13479967 -0.04700093 -0.02821621  0.02969429 -0.12374788]
  [FlaxMamba2] B (step) sample values: [-0.05553772  0.22544846 -0.25474513 -0.122196   -0.19549179]
  [FlaxMamba2] C (step) sample values: [-0.10300562 -0.05536616 -0.23749533 -0.1553972  -0.01509576]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.3863302  -0.87734115 -1.4026718  -0.6827737  -0.39046   ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.2265956 0.6184032 0.5155214 1.5412765 1.4433775]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.1825983  0.5812638  0.4852421  0.3491188  0.56916714]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.13479967 -0.04700093 -0.02821621  0.02969429 -0.12374788]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00918287 -0.0372767   0.04212075  0.02020446  0.03232353]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00918287 -0.0372767   0.04212075  0.02020446  0.03232353]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01046331 -0.04256608  0.04890202  0.02475404  0.03649551]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.1232635  -0.03304164 -0.0238209   0.02810889 -0.10189255]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.47830677 -0.15683544 -0.09813839  0.10631943 -0.42782694]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.47830677 -0.15683544 -0.09813839  0.10631943 -0.42782694]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0421948   0.03377317  0.01148616 -0.02779925  0.08956513]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01900281  0.01552201  0.00555329 -0.01654672  0.04915439]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01900281  0.01552201  0.00555329 -0.01654672  0.04915439]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.7363624  -0.17405455 -0.4936232  -0.4289244   0.04494811]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.7363624  -0.17405455 -0.4936232  -0.4289244   0.04494811]
  [Layer 17] Output shape after mixer: (1, 1, 1024)
  [Layer 17] Output sample values after mixer: [ 0.7363624  -0.17405455 -0.4936232  -0.4289244   0.04494811]
  [Layer 17] Residual connection shape: (1, 1, 1024)
  [Layer 17] Residual connection sample values: [ 1.0813345  -0.59246033 -0.57203656  0.7725558   0.43626785]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.23099016 -0.10942675 -0.10409985  0.20055571  0.08247525]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.23099016 -0.10942675 -0.10409985  0.20055571  0.08247525]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.23099016 -0.10942675 -0.10409985  0.20055571  0.08247525]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.47587776 -0.30012268 -2.1661365   0.2769575  -1.1041346 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.47587776 -0.30012268 -2.1661365   0.2769575  -1.1041346 ]
  [FlaxMamba2] xBC (step) sample values: [-0.8443349  -0.50310034  0.21954545  0.34537965  0.7038214 ]
  [FlaxMamba2] dt (step) sample values: [ 1.399932    2.4990525   1.4188639   0.24338558 -0.5782114 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.5580068  -0.22164887 -0.6630224  -0.8443349  -1.9547898 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.18058164 -0.19850379 -0.03248273  0.0469355   0.04679464]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.18993528 -0.596453   -0.021237    0.07748359 -0.00545146]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.10395948 -0.21183364 -0.01050575  0.04024197 -0.0027183 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.10395948 -0.21183364 -0.01050575  0.04024197 -0.0027183 ]
  [FlaxMamba2] B (step) sample values: [ 0.04055795  0.05495688 -0.03374068 -0.17022471  0.01842747]
  [FlaxMamba2] C (step) sample values: [-0.00442069  0.07595221 -0.06329992 -0.15583985  0.09151904]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.3194940e-03 -6.5335674e+00 -1.4897179e+01 -1.3796333e-03
 -2.0873186e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.45148006 3.637063   2.9205635  0.13797382 0.07918002]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.9895334e-01 4.7847767e-11 1.2724713e-19 9.9980968e-01 9.9983472e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.10395948 -0.21183364 -0.01050575  0.04024197 -0.0027183 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00190361  0.00257944 -0.00158364 -0.0079896   0.0008649 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00190361  0.00257944 -0.00158364 -0.0079896   0.0008649 ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00416404 -0.00139716  0.09471583 -0.05715979  0.01684808]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.17411546 -1.802579    0.14270777 -0.10737054 -0.30094698]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.18234584 -1.7858084   0.14353949 -0.11055645 -0.30073178]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.18234584 -1.7858084   0.14353949 -0.11055645 -0.30073178]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03325418  0.2280664  -0.03197344 -0.01741634  0.08266875]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04728622  0.0794065  -0.01002535 -0.01271604  0.02836417]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04728622  0.0794065  -0.01002535 -0.01271604  0.02836417]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.18966538  0.4986202  -0.15588985 -0.5145435   0.1157451 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.18966538  0.4986202  -0.15588985 -0.5145435   0.1157451 ]
  [Layer 18] Output shape after mixer: (1, 1, 1024)
  [Layer 18] Output sample values after mixer: [-0.18966538  0.4986202  -0.15588985 -0.5145435   0.1157451 ]
  [Layer 18] Residual connection shape: (1, 1, 1024)
  [Layer 18] Residual connection sample values: [ 0.8916691  -0.09384012 -0.72792643  0.25801235  0.552013  ]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.21708126 -0.01897271 -0.14876963  0.077682    0.11931129]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.21708126 -0.01897271 -0.14876963  0.077682    0.11931129]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.21708126 -0.01897271 -0.14876963  0.077682    0.11931129]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.07432039 -0.7757179  -0.36065507 -0.47360808 -0.9696924 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.07432039 -0.7757179  -0.36065507 -0.47360808 -0.9696924 ]
  [FlaxMamba2] xBC (step) sample values: [-0.65265405 -0.39436442 -0.16268937  0.5809818  -0.38272274]
  [FlaxMamba2] dt (step) sample values: [2.301139   0.36074933 1.3456137  2.358187   1.1589861 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.0118886  -0.58679503 -2.6270058  -0.65265405  0.7380287 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.5747757   0.36604226 -0.01665932 -0.39026824 -0.09761145]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.6261978   0.3665434  -0.03045326 -0.5979098  -0.09880354]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.21815053  0.21648915 -0.0149948  -0.2121516  -0.04696322]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.21815053  0.21648915 -0.0149948  -0.2121516  -0.04696322]
  [FlaxMamba2] B (step) sample values: [ 0.00372388  0.04763018 -0.27431795  0.16703817  0.44595844]
  [FlaxMamba2] C (step) sample values: [ 0.03845192  0.10137765 -0.17772867  0.01170068 -0.08815301]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17394373 -1.5063176  -1.5724528  -0.19826236 -0.07681109]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [3.295908  0.3844982 0.8888397 3.5390258 0.8773238]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.56366086 0.56035966 0.24717505 0.49576384 0.9348322 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.21815053  0.21648915 -0.0149948  -0.2121516  -0.04696322]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00267749 -0.0342463   0.19723572 -0.12010112 -0.32064593]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00267749 -0.0342463   0.19723572 -0.12010112 -0.32064593]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00968887 -0.01899218  0.09641565 -0.10324129 -0.34233052]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.6147175   0.77673256  0.01103703 -0.80657333  0.01242413]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.94689095  1.1063763  -0.01179526 -1.1296124  -0.05908584]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.94689095  1.1063763  -0.01179526 -1.1296124  -0.05908584]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0364936  -0.2705533   0.00174756  0.20531054  0.01575282]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00823653 -0.10557059  0.00081194  0.03928081  0.0111511 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00823653 -0.10557059  0.00081194  0.03928081  0.0111511 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.541092    0.8032664  -0.21244869  0.2586925  -0.02140274]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.541092    0.8032664  -0.21244869  0.2586925  -0.02140274]
  [Layer 19] Output shape after mixer: (1, 1, 1024)
  [Layer 19] Output sample values after mixer: [-1.541092    0.8032664  -0.21244869  0.2586925  -0.02140274]
  [Layer 19] Residual connection shape: (1, 1, 1024)
  [Layer 19] Residual connection sample values: [-0.64942294  0.7094263  -0.9403751   0.51670486  0.53061026]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.08194432  0.08193251 -0.10868359  0.07978225  0.06540166]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08194432  0.08193251 -0.10868359  0.07978225  0.06540166]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08194432  0.08193251 -0.10868359  0.07978225  0.06540166]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.5514548  -0.46539786  0.52812093  0.43584552  0.2635926 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.5514548  -0.46539786  0.52812093  0.43584552  0.2635926 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.03043384  0.32525283  0.21678804  0.6298756  -1.967365  ]
  [FlaxMamba2] dt (step) sample values: [-0.11749555  2.4600394   1.4609528   0.537808    0.16542244]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.19641498  0.3090722  -0.03154976  0.03043384 -1.7616392 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00751492  0.00489898  0.04771977  0.15278737 -0.3388216 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00698856 -0.03327851 -0.13184565  0.1317455  -0.38533038]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.00348207 -0.01636242 -0.0615833   0.0702057  -0.15599789]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00348207 -0.01636242 -0.0615833   0.0702057  -0.15599789]
  [FlaxMamba2] B (step) sample values: [0.01974986 0.06822742 0.06583527 0.06175274 0.02157652]
  [FlaxMamba2] C (step) sample values: [-0.01830627 -0.0055174   0.00313389 -0.06669978 -0.06570156]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-3.08577806e-01 -2.93056536e+00 -5.29621363e+00 -1.23260975e+01
 -8.15932546e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00630783 0.27103907 0.23423749 0.12724447 0.04958805]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99805546 0.4518985  0.28921878 0.20837253 0.99959546]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00348207 -0.01636242 -0.0615833   0.0702057  -0.15599789]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.3379211e-07 -1.4985683e-06 -1.4460263e-06 -1.3563565e-06
 -4.7391342e-07]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.3379211e-07 -1.4985683e-06 -1.4460263e-06 -1.3563565e-06
 -4.7391342e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.2127510e-04 -2.4591293e-04 -1.9304329e-04  9.8027609e-05
 -4.7250964e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-1.1008712e-03  9.2771539e-04 -1.0941109e-03  3.5066204e-04
 -6.9483962e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0039648  -0.01253    -0.05174498  0.05809326 -0.12837422]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0039648  -0.01253    -0.05174498  0.05809326 -0.12837422]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00079919  0.00224922 -0.01719029  0.01537586 -0.01913632]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00728656  0.01765979 -0.09291396  0.13647029 -0.1109856 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00728656  0.01765979 -0.09291396  0.13647029 -0.1109856 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.00574621 -0.3282626   0.21881182 -0.5538448   0.39481857]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.00574621 -0.3282626   0.21881182 -0.5538448   0.39481857]
  [Layer 20] Output shape after mixer: (1, 1, 1024)
  [Layer 20] Output sample values after mixer: [-0.00574621 -0.3282626   0.21881182 -0.5538448   0.39481857]
  [Layer 20] Residual connection shape: (1, 1, 1024)
  [Layer 20] Residual connection sample values: [-0.6551691   0.3811637  -0.7215633  -0.03713995  0.92542887]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.10558262  0.05557993 -0.10779983 -0.00707818  0.14337215]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.10558262  0.05557993 -0.10779983 -0.00707818  0.14337215]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.10558262  0.05557993 -0.10779983 -0.00707818  0.14337215]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.08619368 -1.1672517  -0.59955806 -0.13724099 -1.3044227 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.08619368 -1.1672517  -0.59955806 -0.13724099 -1.3044227 ]
  [FlaxMamba2] xBC (step) sample values: [-0.00947738 -0.38929725 -0.30588946  1.1313336   0.6985502 ]
  [FlaxMamba2] dt (step) sample values: [0.35352924 1.2706271  0.4488283  0.4055435  0.8415634 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.42845628 -2.0421271  -1.2194853  -0.00947738  0.86223453]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.12888591 -0.12845358 -0.05270195 -0.33210266  0.33033708]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.4863078  -0.22592673 -0.07836723 -0.43012512  0.27635148]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.18516839 -0.10025664 -0.03764905 -0.16951078  0.15714769]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.18516839 -0.10025664 -0.03764905 -0.16951078  0.15714769]
  [FlaxMamba2] B (step) sample values: [ 0.7109188  -0.22042173 -0.15183702 -0.2749103  -0.00198602]
  [FlaxMamba2] C (step) sample values: [ 0.0086308  -0.08962304  0.1249433  -0.09499998  0.1854301 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.32275575 -0.3764196  -0.15946394 -0.10539922 -0.37568513]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.93227136 1.3326037  1.0805099  0.6054586  1.0016639 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.74015474 0.60555    0.84172463 0.93817866 0.6863893 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.18516839 -0.10025664 -0.03764905 -0.16951078  0.15714769]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.12272391  0.03805078  0.0262112   0.04745699  0.00034284]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.12272391  0.03805078  0.0262112   0.04745699  0.00034284]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.1904742   0.10660315  0.06932957  0.11735371  0.01522203]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.36278966 -0.1622042  -0.07018967 -0.16404381  0.3632868 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.7541424  -0.37409627 -0.1497608  -0.5223043   0.6954179 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.7541424  -0.37409627 -0.1497608  -0.5223043   0.6954179 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03110133  0.10364325  0.0318257   0.03338522 -0.19359879]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03028859  0.12754148  0.04428134  0.0325738  -0.16289403]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03028859  0.12754148  0.04428134  0.0325738  -0.16289403]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.22232842 -0.3613237   0.03560043  0.09958468  0.61661667]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.22232842 -0.3613237   0.03560043  0.09958468  0.61661667]
  [Layer 21] Output shape after mixer: (1, 1, 1024)
  [Layer 21] Output sample values after mixer: [ 0.22232842 -0.3613237   0.03560043  0.09958468  0.61661667]
  [Layer 21] Residual connection shape: (1, 1, 1024)
  [Layer 21] Residual connection sample values: [-0.4328407   0.01983997 -0.68596286  0.06244472  1.5420456 ]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.06441306  0.00273083 -0.09451442  0.01097749  0.22232816]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.06441306  0.00273083 -0.09451442  0.01097749  0.22232816]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.06441306  0.00273083 -0.09451442  0.01097749  0.22232816]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.57583857  0.27220485  0.89650124 -3.5415661   0.30747008]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.57583857  0.27220485  0.89650124 -3.5415661   0.30747008]
  [FlaxMamba2] xBC (step) sample values: [-1.1091923  -0.45966342  0.59466827  0.10249969  0.22442274]
  [FlaxMamba2] dt (step) sample values: [ 0.61277324 -0.4888565   0.01744401  0.9710298   0.84104425]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.34415787  0.25605208 -0.6606246  -1.1091923  -0.99452525]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.08010254  0.15409449 -0.0138573   0.00452706 -0.03275507]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.0719162   0.21860865 -0.00122302 -0.01382926 -0.03214472]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.03466567  0.12120441 -0.00061114 -0.00686682 -0.01581406]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03466567  0.12120441 -0.00061114 -0.00686682 -0.01581406]
  [FlaxMamba2] B (step) sample values: [-2.7650860e-01  2.4931224e-01  7.7933673e-06 -2.3289558e-01
  1.5852014e-02]
  [FlaxMamba2] C (step) sample values: [-0.2782349  -0.14611466 -0.01900771 -0.23182786  0.09856149]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.07090003 -0.07021102 -0.0699373  -0.08945116 -0.38969815]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.7904739  0.53396213 0.11748074 0.70732564 1.2329044 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9454969  0.963204   0.99181736 0.93868893 0.61849844]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03466567  0.12120441 -0.00061114 -0.00686682 -0.01581406]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 7.5769732e-03 -6.8317303e-03 -2.1355623e-07  6.3818758e-03
 -4.3438171e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 7.5769732e-03 -6.8317303e-03 -2.1355623e-07  6.3818758e-03
 -4.3438171e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.01067778 0.01525313 0.00496522 0.01751034 0.04125107]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01233686  0.09850334 -0.07104564  0.02387982 -0.05227226]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.04742683 -0.11045337 -0.06999204  0.03571824 -0.02500878]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.04742683 -0.11045337 -0.06999204  0.03571824 -0.02500878]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01748151 -0.01706645 -0.04456548 -0.00356124 -0.00443118]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0175854  -0.0074356  -0.04483031 -0.00532197 -0.00425325]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0175854  -0.0074356  -0.04483031 -0.00532197 -0.00425325]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.4882893  -0.2246385  -0.51818407 -0.18539713 -0.56325597]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.4882893  -0.2246385  -0.51818407 -0.18539713 -0.56325597]
  [Layer 22] Output shape after mixer: (1, 1, 1024)
  [Layer 22] Output sample values after mixer: [-0.4882893  -0.2246385  -0.51818407 -0.18539713 -0.56325597]
  [Layer 22] Residual connection shape: (1, 1, 1024)
  [Layer 22] Residual connection sample values: [-0.92113    -0.20479853 -1.2041469  -0.12295241  0.9787896 ]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.1125187  -0.02259979 -0.13982129 -0.0184631   0.11126368]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1125187  -0.02259979 -0.13982129 -0.0184631   0.11126368]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1125187  -0.02259979 -0.13982129 -0.0184631   0.11126368]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.3553079   0.6782866  -1.7801814   0.4595416   0.01396725]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.3553079   0.6782866  -1.7801814   0.4595416   0.01396725]
  [FlaxMamba2] xBC (step) sample values: [-0.728753   -0.70272654  0.4143636  -0.6266912  -0.34564403]
  [FlaxMamba2] dt (step) sample values: [0.22925709 0.7482195  0.77424943 0.10187456 0.61911863]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.00251446  0.20315395 -0.11811411 -0.728753   -1.3988055 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00535997  0.00652468  0.19636476  0.0260202  -0.1310318 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02833144 -0.00103986  0.15440309  0.04236237 -0.1354988 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.01396506 -0.00051966  0.08314981  0.02162976 -0.06316643]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01396506 -0.00051966  0.08314981  0.02162976 -0.06316643]
  [FlaxMamba2] B (step) sample values: [-0.20494084  0.07304002  0.02636534  0.5689408   0.04364204]
  [FlaxMamba2] C (step) sample values: [ 0.04758298  0.00120406  0.1066016  -0.00816681  0.12322399]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.12322418 -0.22553998 -0.24196908 -0.09559295 -0.2396176 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08967026 0.40970156 0.4072959  0.08208536 0.30392182]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9890113  0.91173667 0.90614766 0.9921839  0.9297635 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01396506 -0.00051966  0.08314981  0.02162976 -0.06316643]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.5663734e-04 -9.1464426e-05 -3.3016026e-05 -7.1245665e-04
 -5.4650776e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.5663734e-04 -9.1464426e-05 -3.3016026e-05 -7.1245665e-04
 -5.4650776e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.02510085  0.01201395 -0.00128261  0.0753279  -0.01123035]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00624757  0.00615601  0.21000177 -0.02953708  0.01287782]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00559568  0.00618027  0.20612031 -0.03054676  0.01582644]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00559568  0.00618027  0.20612031 -0.03054676  0.01582644]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00116886  0.00278079 -0.05294115 -0.00860366  0.0001113 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00194524  0.01402815 -0.43899643 -0.07157032  0.0005155 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00194524  0.01402815 -0.43899643 -0.07157032  0.0005155 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.2756029  -0.72019184 -0.3208028  -0.09943265 -0.9695783 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.2756029  -0.72019184 -0.3208028  -0.09943265 -0.9695783 ]
  [Layer 23] Output shape after mixer: (1, 1, 1024)
  [Layer 23] Output sample values after mixer: [-0.2756029  -0.72019184 -0.3208028  -0.09943265 -0.9695783 ]
  [Layer 23] Residual connection shape: (1, 1, 1024)
  [Layer 23] Residual connection sample values: [-1.1967329  -0.92499036 -1.5249497  -0.22238505  0.0092113 ]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.17049    -0.11697957 -0.2095653  -0.03635962  0.001209  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.17049    -0.11697957 -0.2095653  -0.03635962  0.001209  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.17049    -0.11697957 -0.2095653  -0.03635962  0.001209  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.0173102  -1.0672946  -0.2117854  -1.8915483  -0.22772795]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.0173102  -1.0672946  -0.2117854  -1.8915483  -0.22772795]
  [FlaxMamba2] xBC (step) sample values: [ 0.37178186 -1.5433699  -1.2654723   0.04003223 -0.7007354 ]
  [FlaxMamba2] dt (step) sample values: [-0.1665694   0.4461779   0.5842881  -0.01399129  0.13091321]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.4168057   0.16669989  0.7084974   0.37178186 -2.0091333 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-2.2014639e-01 -1.8027857e-01 -1.6461323e-01 -1.7686933e-04
  1.6883625e-01]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.09319326 -0.0829275  -0.1667838  -0.07927843  0.17568745]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.04442696 -0.03974549 -0.07645376 -0.03806877  0.09554046]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04442696 -0.03974549 -0.07645376 -0.03806877  0.09554046]
  [FlaxMamba2] B (step) sample values: [-0.26599672  0.07649784 -0.03504862  0.01825172  0.08403537]
  [FlaxMamba2] C (step) sample values: [ 0.05747262  0.01059487 -0.01996119  0.15118718 -0.22761336]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6296152  -0.19671947 -0.14336194 -0.14017779 -0.22378482]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.6880008 1.0181942 0.8853376 1.1429636 0.5156285]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.6484465  0.81848633 0.88080084 0.8519579  0.89101875]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04442696 -0.03974549 -0.07645376 -0.03806877  0.09554046]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0081304  -0.00233822  0.00107129 -0.00055788 -0.00256861]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0081304  -0.00233822  0.00107129 -0.00055788 -0.00256861]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00357381  0.00522764 -0.00557677  0.00670355 -0.00368341]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01302704 -0.01707901 -0.07603065 -0.09047242  0.01931807]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.23062314 -0.21174605 -0.4504889  -0.27692714  0.4872599 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.23062314 -0.21174605 -0.4504889  -0.27692714  0.4872599 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00201334  0.05783628  0.04267083  0.0686562  -0.04919118]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00076746  0.0688313   0.04465088  0.05336043 -0.03544424]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00076746  0.0688313   0.04465088  0.05336043 -0.03544424]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.11109542 -2.7747664  -1.158453   -0.44735128  0.24440967]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.11109542 -2.7747664  -1.158453   -0.44735128  0.24440967]
  [Layer 24] Output shape after mixer: (1, 1, 1024)
  [Layer 24] Output sample values after mixer: [-0.11109542 -2.7747664  -1.158453   -0.44735128  0.24440967]
  [Layer 24] Residual connection shape: (1, 1, 1024)
  [Layer 24] Residual connection sample values: [-1.3078283  -3.6997569  -2.6834025  -0.6697363   0.25362098]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.11798795 -0.30980203 -0.22562021 -0.06917924  0.02144079]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.11798795 -0.30980203 -0.22562021 -0.06917924  0.02144079]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.11798795 -0.30980203 -0.22562021 -0.06917924  0.02144079]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.4456977  -0.24792784 -2.64715     0.6957447  -0.30119795]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.4456977  -0.24792784 -2.64715     0.6957447  -0.30119795]
  [FlaxMamba2] xBC (step) sample values: [ 1.1918046  -0.42925957  0.986705   -0.9572754   0.27104548]
  [FlaxMamba2] dt (step) sample values: [0.34596345 0.307564   0.64264196 0.662887   0.82884425]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.7092835  -0.59246755  0.5787873   1.1918046   0.12491158]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.26870254 -0.00368316 -0.25005937 -0.40161952 -0.01266394]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-2.8802016e-01 -3.3576600e-04 -1.4739823e-01 -5.0672209e-01
 -5.1299192e-02]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-1.2341337e-01 -1.6785483e-04 -6.8277374e-02 -1.9050838e-01
 -2.4991838e-02]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-1.2341337e-01 -1.6785483e-04 -6.8277374e-02 -1.9050838e-01
 -2.4991838e-02]
  [FlaxMamba2] B (step) sample values: [-0.01500371 -0.06105535 -0.10566018 -0.01204402  0.03879552]
  [FlaxMamba2] C (step) sample values: [-0.2099162  -0.19224058  0.12636986 -0.18305512 -0.14325388]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.16260907 -0.3326761  -0.32944313 -0.2015813  -0.1541056 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.7501105  0.45536587 0.5755399  0.72553825 0.9514319 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8851707  0.85942703 0.8272836  0.86393744 0.86362123]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-1.2341337e-01 -1.6785483e-04 -6.8277374e-02 -1.9050838e-01
 -2.4991838e-02]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00138895  0.00565212  0.00978135  0.00111496 -0.00359144]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00138895  0.00565212  0.00978135  0.00111496 -0.00359144]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00429561  0.01251393  0.01543648  0.0063117  -0.01875567]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00754098  0.00996974 -0.05419069 -0.1719697  -0.06532586]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.12093826  0.00981551 -0.11692674 -0.34701663 -0.08828939]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.12093826  0.00981551 -0.11692674 -0.34701663 -0.08828939]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02104245 -0.0010667   0.02047953 -0.16109595  0.01130889]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15565987 -0.00618411  0.09915309 -0.4375126   0.04730358]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.15565987 -0.00618411  0.09915309 -0.4375126   0.04730358]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.6830348  -0.11802614 -0.9439497   0.5014776  -1.4108968 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.6830348  -0.11802614 -0.9439497   0.5014776  -1.4108968 ]
  [Layer 25] Output shape after mixer: (1, 1, 1024)
  [Layer 25] Output sample values after mixer: [-0.6830348  -0.11802614 -0.9439497   0.5014776  -1.4108968 ]
  [Layer 25] Residual connection shape: (1, 1, 1024)
  [Layer 25] Residual connection sample values: [-1.9908631  -3.817783   -3.6273522  -0.16825873 -1.1572758 ]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.21409485 -0.38246194 -0.3821118  -0.02173537 -0.11904927]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.21409485 -0.38246194 -0.3821118  -0.02173537 -0.11904927]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.21409485 -0.38246194 -0.3821118  -0.02173537 -0.11904927]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.43521208  0.701395   -0.22246127 -0.05084316  0.5517216 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.43521208  0.701395   -0.22246127 -0.05084316  0.5517216 ]
  [FlaxMamba2] xBC (step) sample values: [-0.24176234 -0.6753795   0.6922781  -0.31888357 -0.99430823]
  [FlaxMamba2] dt (step) sample values: [1.1442721 1.2306308 1.9246808 1.6358783 1.0664965]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.8267723  -1.5060759  -0.5481895  -0.24176234 -0.31523755]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.09798231 -0.22266585 -0.28513232 -0.08132149 -0.3148613 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.18898574 -0.2765904  -0.31040087 -0.14461493 -0.58268356]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.08559044 -0.11929064 -0.13130482 -0.06708819 -0.20878446]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08559044 -0.11929064 -0.13130482 -0.06708819 -0.20878446]
  [FlaxMamba2] B (step) sample values: [0.1575239  0.09072939 0.09586686 0.03184369 0.09349237]
  [FlaxMamba2] C (step) sample values: [ 0.0208168  -0.26705116 -0.1614791  -0.10573877 -0.06272265]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.329765   -0.06343037 -0.22886811 -0.12639298 -0.0584348 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.2083187 0.540917  3.3142583 2.777255  1.1138453]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.6713523  0.96627134 0.4683553  0.7039658  0.9369856 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08559044 -0.11929064 -0.13130482 -0.06708819 -0.20878446]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0162912  -0.00938328 -0.0099146  -0.00329329 -0.00966903]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0162912  -0.00938328 -0.0099146  -0.00329329 -0.00966903]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.04038325 -0.0004654  -0.01450089 -0.03322116 -0.01266064]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.34518883 -0.38858104 -0.3981497  -0.07631106 -0.64085406]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.69038415 -0.8696928  -0.9277159  -0.34688485 -1.482904  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.69038415 -0.8696928  -0.9277159  -0.34688485 -1.482904  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.18241669 -0.40778196  0.09175959  0.00859423 -0.51914483]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.1390024  -0.21676879  0.06444062  0.0066299  -0.29489797]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.1390024  -0.21676879  0.06444062  0.0066299  -0.29489797]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.9276314   0.03156406 -0.05871154 -1.2032835  -1.5741016 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.9276314   0.03156406 -0.05871154 -1.2032835  -1.5741016 ]
  [Layer 26] Output shape after mixer: (1, 1, 1024)
  [Layer 26] Output sample values after mixer: [-0.9276314   0.03156406 -0.05871154 -1.2032835  -1.5741016 ]
  [Layer 26] Residual connection shape: (1, 1, 1024)
  [Layer 26] Residual connection sample values: [-2.9184945 -3.7862191 -3.6860638 -1.3715422 -2.7313774]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.2517369  -0.31089494 -0.30676866 -0.1367385  -0.23725322]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.2517369  -0.31089494 -0.30676866 -0.1367385  -0.23725322]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.2517369  -0.31089494 -0.30676866 -0.1367385  -0.23725322]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.1389554 -0.91287    1.3078084 -0.8557479 -0.8743381]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.1389554 -0.91287    1.3078084 -0.8557479 -0.8743381]
  [FlaxMamba2] xBC (step) sample values: [ 0.589558   0.1311285 -0.0693172  0.1492529 -0.575077 ]
  [FlaxMamba2] dt (step) sample values: [ 1.6727622  -1.0895793   1.2530866   1.8395494  -0.51570714]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.02095367 -0.5378049   0.5523377   0.589558   -1.2730049 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.16832659  0.05979701 -0.02649041 -0.10423193 -0.06366857]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.18500444  0.00800868 -0.08154412 -0.30442724 -0.06181177]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.08396988  0.00402038 -0.03911062 -0.12922192 -0.02995101]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08396988  0.00402038 -0.03911062 -0.12922192 -0.02995101]
  [FlaxMamba2] B (step) sample values: [-0.00923533  0.06512161 -0.00355631  0.6673281  -0.02064371]
  [FlaxMamba2] C (step) sample values: [-0.02108575  0.42458338 -0.1242737  -0.11369591 -0.17301317]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.562595   -0.03025642 -0.75594616 -1.1612954  -0.04055573]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.3544954  0.01522083 0.03222717 0.4079064  0.019048  ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8191916  0.99953955 0.97593236 0.62269413 0.9992278 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08396988  0.00402038 -0.03911062 -0.12922192 -0.02995101]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00027491 -0.00193847  0.00010586 -0.01986432  0.0006145 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00027491 -0.00193847  0.00010586 -0.01986432  0.0006145 ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00373426 -0.00833498 -0.00611014 -0.02517101  0.00167112]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.06219029  0.01044466 -0.02111561 -0.08512875  0.00316488]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.229178    0.01843983 -0.09889341 -0.34210745 -0.05639756]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.229178    0.01843983 -0.09889341 -0.34210745 -0.05639756]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01702726 -0.00482124 -0.10180449  0.0873087   0.01451468]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.04397446 -0.00979903 -0.2984672   0.06586166  0.05434757]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.04397446 -0.00979903 -0.2984672   0.06586166  0.05434757]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.6680244   0.73113394  0.4671839  -0.05996674 -0.54553515]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.6680244   0.73113394  0.4671839  -0.05996674 -0.54553515]
  [Layer 27] Output shape after mixer: (1, 1, 1024)
  [Layer 27] Output sample values after mixer: [ 0.6680244   0.73113394  0.4671839  -0.05996674 -0.54553515]
  [Layer 27] Residual connection shape: (1, 1, 1024)
  [Layer 27] Residual connection sample values: [-2.2504702 -3.0550852 -3.21888   -1.4315089 -3.2769125]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.15714423 -0.20529747 -0.2210734  -0.11685757 -0.2216135 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.15714423 -0.20529747 -0.2210734  -0.11685757 -0.2216135 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.15714423 -0.20529747 -0.2210734  -0.11685757 -0.2216135 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.65113986 -0.56713486 -0.38912818 -0.6173269  -0.27917176]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.65113986 -0.56713486 -0.38912818 -0.6173269  -0.27917176]
  [FlaxMamba2] xBC (step) sample values: [-0.02011488  0.31095308 -0.17096165 -0.9538686  -1.0273646 ]
  [FlaxMamba2] dt (step) sample values: [2.203146   1.100558   0.77586275 0.57573676 1.9470524 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6237256  -1.445223   -1.6444194  -0.02011488  0.81648594]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.14479125  0.19742474 -0.0846369   0.2504992  -0.24487962]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01686156  0.10800824 -0.21378729  0.1604113  -0.3104924 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.00850186  0.05691773 -0.09551071  0.08662484 -0.1313366 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00850186  0.05691773 -0.09551071  0.08662484 -0.1313366 ]
  [FlaxMamba2] B (step) sample values: [-0.26892257 -0.12211952 -0.04682951  0.04917984 -0.17154889]
  [FlaxMamba2] C (step) sample values: [-0.00943262  0.00700836 -0.03622377 -0.02833759 -0.01511717]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.54422176 -0.18426022 -0.10643356 -0.11241624 -0.25234625]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.0234325 1.0954825 1.4445232 1.2128226 1.6719952]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.57294005 0.81721437 0.85749    0.8725451  0.6557854 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00850186  0.05691773 -0.09551071  0.08662484 -0.1313366 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00233992 -0.00106257 -0.00040747  0.00042792 -0.00149266]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00233992 -0.00106257 -0.00040747  0.00042792 -0.00149266]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00149579  0.00218848 -0.00450466 -0.00032784 -0.00360246]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00626842  0.00897823 -0.01545144  0.01304043 -0.02152487]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02213011  0.11516814 -0.19364329  0.17465413 -0.2665561 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02213011  0.11516814 -0.19364329  0.17465413 -0.2665561 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00493871 -0.0236377   0.03043674 -0.03777855  0.03204731]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02724217 -0.12251855  0.15060304 -0.21597342  0.21317928]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02724217 -0.12251855  0.15060304 -0.21597342  0.21317928]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.7227733   0.47458565 -0.08804628  0.7079622   1.4289113 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.7227733   0.47458565 -0.08804628  0.7079622   1.4289113 ]
  [Layer 28] Output shape after mixer: (1, 1, 1024)
  [Layer 28] Output sample values after mixer: [ 1.7227733   0.47458565 -0.08804628  0.7079622   1.4289113 ]
  [Layer 28] Residual connection shape: (1, 1, 1024)
  [Layer 28] Residual connection sample values: [-0.52769685 -2.5804996  -3.3069263  -0.7235467  -1.8480011 ]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.03862148 -0.18645434 -0.24390915 -0.06543805 -0.13585304]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.03862148 -0.18645434 -0.24390915 -0.06543805 -0.13585304]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.03862148 -0.18645434 -0.24390915 -0.06543805 -0.13585304]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.5302826 -0.2992583 -0.3362884 -1.315797   1.3570261]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.5302826 -0.2992583 -0.3362884 -1.315797   1.3570261]
  [FlaxMamba2] xBC (step) sample values: [-0.25573054  0.5775491   1.171732    0.80952656  0.44429073]
  [FlaxMamba2] dt (step) sample values: [ 1.362525  -0.0919679  1.6509099  1.039213   1.023793 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.733938    0.04194061  0.51662797 -0.25573054  0.22972776]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02647696 -0.1559231  -0.3883977  -0.14004777  0.29563963]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01248465 -0.23154566 -0.52670336  0.22665145  1.7956396 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.00620336 -0.10242905 -0.19555764  0.12611376  1.5399716 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00620336 -0.10242905 -0.19555764  0.12611376  1.5399716 ]
  [FlaxMamba2] B (step) sample values: [-0.17311326  0.09663548 -0.08848149 -0.00560272  0.09232562]
  [FlaxMamba2] C (step) sample values: [-0.12258615 -0.06021203 -0.16973343  0.05818442  0.5056574 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6542169  -0.13693057 -1.458904   -0.36823887 -0.12178858]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.2916618  0.05046638 0.41676044 0.2680565  0.6635043 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.82628953 0.99311346 0.5444313  0.90600646 0.92237145]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00620336 -0.10242905 -0.19555764  0.12611376  1.5399716 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.1321091e-04 -1.7484096e-04  1.6008806e-04  1.0136913e-05
 -1.6704320e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.1321091e-04 -1.7484096e-04  1.6008806e-04  1.0136913e-05
 -1.6704320e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00029272  0.00216925 -0.00127147 -0.00191508  0.00222662]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00210892 -0.01244559 -0.0185003   0.02720718  0.17907745]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01253646 -0.18462378 -0.34722304  0.23919818  2.7676935 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01253646 -0.18462378 -0.34722304  0.23919818  2.7676935 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 2.4627093e-03  2.3522155e-02  4.8658170e-02 -6.6572517e-02
  2.9869230e+00]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01577166  0.11761464  0.18177606 -0.30536753  2.1225674 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01577166  0.11761464  0.18177606 -0.30536753  2.1225674 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.67669743 -0.9100671   1.5445027  -0.8983134   0.39655393]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.67669743 -0.9100671   1.5445027  -0.8983134   0.39655393]
  [Layer 29] Output shape after mixer: (1, 1, 1024)
  [Layer 29] Output sample values after mixer: [ 0.67669743 -0.9100671   1.5445027  -0.8983134   0.39655393]
  [Layer 29] Residual connection shape: (1, 1, 1024)
  [Layer 29] Residual connection sample values: [ 0.14900059 -3.4905667  -1.7624235  -1.62186    -1.4514472 ]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.00940785 -0.21036953 -0.10828218 -0.11692783 -0.0890663 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.00940785 -0.21036953 -0.10828218 -0.11692783 -0.0890663 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.00940785 -0.21036953 -0.10828218 -0.11692783 -0.0890663 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.24604897  0.80363095  0.20178042 -0.18339947  1.6963602 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.24604897  0.80363095  0.20178042 -0.18339947  1.6963602 ]
  [FlaxMamba2] xBC (step) sample values: [-0.46683487  0.18229283 -0.9195659  -0.46676892  0.88937783]
  [FlaxMamba2] dt (step) sample values: [0.6472361  0.4358905  1.0319602  0.17792869 0.95425195]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6531412   1.6208633  -0.9774104  -0.46683487  1.5906767 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.32202306 -0.19171476  0.299533    0.05085104 -0.91013515]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.36483923 -0.23352385  0.8747283   0.10028951 -1.0026644 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.14950697 -0.1031902   0.61732084  0.05265715 -0.2691331 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.14950697 -0.1031902   0.61732084  0.05265715 -0.2691331 ]
  [FlaxMamba2] B (step) sample values: [-0.06058342 -0.06171847  0.00772551  0.00435071 -0.25708413]
  [FlaxMamba2] C (step) sample values: [-0.19928564 -0.14171942 -0.21831529 -0.2306993  -0.25591975]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2037584  -0.36680323 -0.20777717 -0.09522027 -0.4265393 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.8411366  0.3468249  0.94171554 0.11751717 0.5628624 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8424941  0.880543   0.822286   0.98887235 0.7865626 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.14950697 -0.1031902   0.61732084  0.05265715 -0.2691331 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00761872  0.00776145 -0.00097153 -0.00054713  0.03232982]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00761872  0.00776145 -0.00097153 -0.00054713  0.03232982]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00509817 -0.02719317 -0.01054186 -0.00551171  0.04461361]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.07436249 -0.13088286  1.1084528   0.19341041 -0.23635527]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.09905514 -0.14792581  1.2104099   0.2021073  -0.28080544]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.09905514 -0.14792581  1.2104099   0.2021073  -0.28080544]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01367789 -0.08211488  0.13439745 -0.01683845 -0.40254137]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.04993901 -0.33114478  0.32764047 -0.06814419 -0.5972842 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.04993901 -0.33114478  0.32764047 -0.06814419 -0.5972842 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.6360736 -1.6124785 -1.263633  -3.5110598 -3.672646 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.6360736 -1.6124785 -1.263633  -3.5110598 -3.672646 ]
  [Layer 30] Output shape after mixer: (1, 1, 1024)
  [Layer 30] Output sample values after mixer: [ 2.6360736 -1.6124785 -1.263633  -3.5110598 -3.672646 ]
  [Layer 30] Residual connection shape: (1, 1, 1024)
  [Layer 30] Residual connection sample values: [ 2.7850742 -5.1030455 -3.0260565 -5.13292   -5.124093 ]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.09881985 -0.18362749 -0.10784505 -0.20628063 -0.1821343 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.09881985 -0.18362749 -0.10784505 -0.20628063 -0.1821343 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.09881985 -0.18362749 -0.10784505 -0.20628063 -0.1821343 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.111616   -0.12649807  1.0187345  -0.26236188  0.12884116]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.111616   -0.12649807  1.0187345  -0.26236188  0.12884116]
  [FlaxMamba2] xBC (step) sample values: [ 0.23937568  0.15372583 -0.07986958  0.23254971  0.20058176]
  [FlaxMamba2] dt (step) sample values: [-0.16064584  0.12348362  0.8087531   0.22050907  0.2614146 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.40604842  0.7384626   0.23523258  0.23937568  0.4709543 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.04038676 -0.03543875  0.0290562  -0.04913569  0.16575085]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04329356 -0.00049612  0.01848186 -0.06729364  0.10544811]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.02117827 -0.000248    0.00932632 -0.03251514  0.05550131]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02117827 -0.000248    0.00932632 -0.03251514  0.05550131]
  [FlaxMamba2] B (step) sample values: [ 0.0117718   0.00886765 -0.00216208 -0.01238442  0.00372054]
  [FlaxMamba2] C (step) sample values: [-0.01213803 -0.07511932 -0.08255877 -0.10193574 -0.07657471]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-9.5765535e-03 -1.0641767e-02 -2.6350424e+01 -6.4467737e+02
 -1.6546801e-02]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03928188 0.06573881 1.5876989  1.5055755  0.08081497]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.9962389e-01 9.9930066e-01 6.7705105e-19 0.0000000e+00 9.9866366e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02117827 -0.000248    0.00932632 -0.03251514  0.05550131]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.79322158e-06 -7.37719756e-06  1.79868448e-06  1.03028715e-05
 -3.09520010e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.79322158e-06 -7.37719756e-06  1.79868448e-06  1.03028715e-05
 -3.09520010e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01654091 -0.01079204  0.00780983  0.0155963   0.00599166]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00140186 -0.02637987 -0.00096604 -0.0516266  -0.00836296]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00405949 -0.02634875 -0.00213639 -0.04754633 -0.01532774]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00405949 -0.02634875 -0.00213639 -0.04754633 -0.01532774]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00339541  0.00156127 -0.00159907  0.00542363 -0.00105094]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.06825213  0.02838211 -0.02943183  0.44186276 -0.00558438]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.06825213  0.02838211 -0.02943183  0.44186276 -0.00558438]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.6567157   0.34046277 -1.0225307   0.02495032  1.0995629 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.6567157   0.34046277 -1.0225307   0.02495032  1.0995629 ]
  [Layer 31] Output shape after mixer: (1, 1, 1024)
  [Layer 31] Output sample values after mixer: [-0.6567157   0.34046277 -1.0225307   0.02495032  1.0995629 ]
  [Layer 31] Residual connection shape: (1, 1, 1024)
  [Layer 31] Residual connection sample values: [ 2.1283586 -4.762583  -4.0485873 -5.1079693 -4.0245304]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.11258973 -0.24654564 -0.2081302  -0.31493992 -0.21600968]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.11258973 -0.24654564 -0.2081302  -0.31493992 -0.21600968]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.11258973 -0.24654564 -0.2081302  -0.31493992 -0.21600968]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.7648243  -0.744255   -0.6601568   0.44290003 -1.0619186 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.7648243  -0.744255   -0.6601568   0.44290003 -1.0619186 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.35602915 -0.15740441 -0.12673807 -1.6045715   0.05966921]
  [FlaxMamba2] dt (step) sample values: [0.07565821 0.2907225  1.4062474  0.46925157 0.3590281 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.32137263 -0.7309479   0.01557062  0.35602915 -0.263564  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01931191 -0.03275601 -0.00279497  0.12933181 -0.20148002]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.00562477 -0.40067592 -0.00487208  0.10584854 -0.2137786 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.0028203  -0.16073114 -0.0024301   0.05572264 -0.09550729]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0028203  -0.16073114 -0.0024301   0.05572264 -0.09550729]
  [FlaxMamba2] B (step) sample values: [-0.01566456  0.08760545  0.02716843 -0.07137814  0.00550572]
  [FlaxMamba2] C (step) sample values: [-0.27377883 -0.21437205 -0.27846438 -0.20244636 -0.23000814]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.0662153  -0.08112868 -0.58786964 -0.09559295 -0.5447535 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.0460668  1.2565452  1.1425143  1.1735032  0.77703196]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.93307877 0.9030821  0.5108652  0.8938846  0.6548881 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0028203  -0.16073114 -0.0024301   0.05572264 -0.09550729]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.6213874e-05  2.5845526e-04  8.0152822e-05 -2.1058113e-04
  1.6243068e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.6213874e-05  2.5845526e-04  8.0152822e-05 -2.1058113e-04
  1.6243068e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.01323405 0.11460725 0.12775631 0.23882243 0.14435741]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.4641066  -1.3537475   0.26974237  1.2743213  -0.4837963 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.46404275 -1.3501086   0.26979738  1.2730597  -0.48163402]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.46404275 -1.3501086   0.26979738  1.2730597  -0.48163402]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.11271971  0.32362843 -0.06068237  0.34334916  0.13141507]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.06898986  0.43016702 -0.08040133  0.28505513  0.12291566]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.06898986  0.43016702 -0.08040133  0.28505513  0.12291566]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.2296907  3.197875   0.7462492 -2.5138004  3.2325506]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.2296907  3.197875   0.7462492 -2.5138004  3.2325506]
  [Layer 32] Output shape after mixer: (1, 1, 1024)
  [Layer 32] Output sample values after mixer: [-1.2296907  3.197875   0.7462492 -2.5138004  3.2325506]
  [Layer 32] Residual connection shape: (1, 1, 1024)
  [Layer 32] Residual connection sample values: [ 0.89866793 -1.5647078  -3.3023381  -7.62177    -0.7919798 ]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.04310206 -0.07329351 -0.15750243 -0.3839365  -0.03840947]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.04310206 -0.07329351 -0.15750243 -0.3839365  -0.03840947]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.04310206 -0.07329351 -0.15750243 -0.3839365  -0.03840947]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.4846612  -0.8358424  -0.37228483  0.6560008  -0.78611094]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.4846612  -0.8358424  -0.37228483  0.6560008  -0.78611094]
  [FlaxMamba2] xBC (step) sample values: [ 1.7261065   0.12415277  0.6140474  -0.36454436 -0.24531642]
  [FlaxMamba2] dt (step) sample values: [ 1.1648073   0.6146107  -0.69308245 -0.82443166  0.35605633]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [0.9715412  1.6151876  0.29317662 1.7261065  1.4759392 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.44217834  0.02628884  0.09422096 -0.1474188  -0.03937658]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.17191467 -0.01030174  0.08085426 -0.2703436  -0.07373937]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.09332786 -0.00512434  0.0420606  -0.11701085 -0.03551093]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.09332786 -0.00512434  0.0420606  -0.11701085 -0.03551093]
  [FlaxMamba2] B (step) sample values: [-0.13333689  0.12214739 -0.00353281 -0.02843734 -0.18891376]
  [FlaxMamba2] C (step) sample values: [-0.05094632 -0.06680766  0.22599058 -0.2381749  -0.08834722]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-13.044406    -1.3849771   -0.1667907   -0.23590268  -5.254998  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04453634 0.00889849 0.02808853 0.02333048 0.01185467]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.55936664 0.9877514  0.99532604 0.99451137 0.93960446]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.09332786 -0.00512434  0.0420606  -0.11701085 -0.03551093]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.54212311e-04  5.07703342e-04 -1.46840512e-05 -1.18199256e-04
 -7.85216573e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.54212311e-04  5.07703342e-04 -1.46840512e-05 -1.18199256e-04
 -7.85216573e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.0959443e-04  2.0452472e-04 -7.9963400e-05 -1.0022939e-04
 -5.5783393e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 3.623520e-04 -9.381428e-04 -2.703314e-05  2.834752e-04 -4.136858e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.10032599 -0.00642683  0.04502415 -0.12504706 -0.03844951]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.10032599 -0.00642683  0.04502415 -0.12504706 -0.03844951]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01853318  0.0016245  -0.00683863 -0.05400603  0.00946074]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.20902371  0.01776329 -0.1020545  -0.677304    0.13415197]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.20902371  0.01776329 -0.1020545  -0.677304    0.13415197]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-3.924227   -3.8215592  -0.63021994  2.296756    4.125992  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-3.924227   -3.8215592  -0.63021994  2.296756    4.125992  ]
  [Layer 33] Output shape after mixer: (1, 1, 1024)
  [Layer 33] Output sample values after mixer: [-3.924227   -3.8215592  -0.63021994  2.296756    4.125992  ]
  [Layer 33] Residual connection shape: (1, 1, 1024)
  [Layer 33] Residual connection sample values: [-3.025559  -5.3862667 -3.932558  -5.325014   3.334012 ]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.11005547 -0.19299749 -0.14872365 -0.19648336  0.12385587]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.11005547 -0.19299749 -0.14872365 -0.19648336  0.12385587]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.11005547 -0.19299749 -0.14872365 -0.19648336  0.12385587]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.6139182  -0.6209052  -0.11371453  0.29454944 -1.9234519 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.6139182  -0.6209052  -0.11371453  0.29454944 -1.9234519 ]
  [FlaxMamba2] xBC (step) sample values: [-0.56008327 -1.797497   -0.09145639  1.6277137  -0.609673  ]
  [FlaxMamba2] dt (step) sample values: [-1.7447193 -1.2158495  1.5329298  1.0657479  1.1683624]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.11966293 -0.456136   -1.7558019  -0.56008327 -1.0825982 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.15906407  0.9333187   0.03711075 -0.2830237  -0.24656661]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.20242955  0.8360897   0.00311417 -0.3641394  -0.32060224]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.09100518  0.58329046  0.00155951 -0.14928183 -0.13482253]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09100518  0.58329046  0.00155951 -0.14928183 -0.13482253]
  [FlaxMamba2] B (step) sample values: [-0.0303958   0.01147329  0.03731456  0.12964666 -0.01154315]
  [FlaxMamba2] C (step) sample values: [-0.1706414   0.01300681 -0.07249697  0.16375902 -0.04545768]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2224774  -0.15365478 -0.8168739  -0.85911244 -2.0730147 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00230196 0.00212409 0.6852296  0.26558012 0.48090005]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.999488   0.99967366 0.57135403 0.79599434 0.3690169 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09100518  0.58329046  0.00155951 -0.14928183 -0.13482253]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 6.3676162e-06 -2.4035389e-06 -7.8170269e-06 -2.7159680e-05
  2.4181745e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 6.3676162e-06 -2.4035389e-06 -7.8170269e-06 -2.7159680e-05
  2.4181745e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00304311  0.00743582  0.00346403 -0.00654777  0.01052112]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.03650208  0.14212304  0.06755937 -0.03188732 -0.05926847]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.2155559   1.2897544   0.07062773 -0.3256012  -0.3245335 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.2155559   1.2897544   0.07062773 -0.3256012  -0.3245335 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.04647108 -0.27994546 -0.00378762 -0.05496445  0.07957435]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.31324175 -1.0552263  -0.02135028 -0.36615866  0.5649992 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.31324175 -1.0552263  -0.02135028 -0.36615866  0.5649992 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.8151228 -1.4421215 -0.6401831 -3.1253908  1.2872082]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.8151228 -1.4421215 -0.6401831 -3.1253908  1.2872082]
  [Layer 34] Output shape after mixer: (1, 1, 1024)
  [Layer 34] Output sample values after mixer: [ 0.8151228 -1.4421215 -0.6401831 -3.1253908  1.2872082]
  [Layer 34] Residual connection shape: (1, 1, 1024)
  [Layer 34] Residual connection sample values: [-2.210436 -6.828388 -4.572741 -8.450405  4.62122 ]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.09807453 -0.30059677 -0.19988811 -0.3997132   0.20379022]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.09807453 -0.30059677 -0.19988811 -0.3997132   0.20379022]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.09807453 -0.30059677 -0.19988811 -0.3997132   0.20379022]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.1333488 -0.7968884 -0.8327095 -2.0382314 -1.6144783]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.1333488 -0.7968884 -0.8327095 -2.0382314 -1.6144783]
  [FlaxMamba2] xBC (step) sample values: [-1.1648918   1.240338   -0.7802404   0.5674198  -0.83793634]
  [FlaxMamba2] dt (step) sample values: [ 2.606684    3.5713987  -0.28838572  3.4463565   2.4896107 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.17228524  1.0362945  -1.0326835  -1.1648918   0.895756  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.22700968  0.2980115  -0.5543685   0.14272629 -0.21086305]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.17555705  0.276283   -0.5818038   0.11788498 -0.3231067 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.09546386  0.1571041  -0.20858693  0.06241269 -0.13567859]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.09546386  0.1571041  -0.20858693  0.06241269 -0.13567859]
  [FlaxMamba2] B (step) sample values: [-0.25105223 -0.07685836  0.17836885 -0.01598368  0.00968198]
  [FlaxMamba2] C (step) sample values: [-0.05252772  0.02779261 -0.2711894   0.21112175  0.0488123 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2053565  -0.14169171 -0.10705902 -0.1460468  -0.2580783 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [4.1777987 5.746473  0.7132143 5.7853713 2.894431 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.4240355  0.44298136 0.9264863  0.42958528 0.47379056]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.09546386  0.1571041  -0.20858693  0.06241269 -0.13567859]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.10012686 -0.03065333  0.07113864 -0.00637475  0.00386145]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.10012686 -0.03065333  0.07113864 -0.00637475  0.00386145]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.12756789 -0.03481378  0.09149378 -0.03994744 -0.02639668]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.42860183  0.8021624  -1.1221768   0.28118697 -0.70683384]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.6785873   1.2135615  -1.6683908   0.44462335 -1.0621272 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.6785873   1.2135615  -1.6683908   0.44462335 -1.0621272 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.18730356 -0.3004614   0.42105398 -0.10444201  0.28459844]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.24595566 -0.38259166  0.18543674 -0.19821846  0.31306267]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.24595566 -0.38259166  0.18543674 -0.19821846  0.31306267]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.2252855  -0.12778318  0.50540686  2.3495224   4.4106197 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.2252855  -0.12778318  0.50540686  2.3495224   4.4106197 ]
  [Layer 35] Output shape after mixer: (1, 1, 1024)
  [Layer 35] Output sample values after mixer: [-2.2252855  -0.12778318  0.50540686  2.3495224   4.4106197 ]
  [Layer 35] Residual connection shape: (1, 1, 1024)
  [Layer 35] Residual connection sample values: [-4.4357214 -6.9561715 -4.067334  -6.1008825  9.031839 ]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.14634804 -0.23466031 -0.1349801  -0.21485008  0.30526316]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.14634804 -0.23466031 -0.1349801  -0.21485008  0.30526316]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.14634804 -0.23466031 -0.1349801  -0.21485008  0.30526316]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.3835663  -1.7471682  -0.51828194 -0.8278938  -0.8418062 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.3835663  -1.7471682  -0.51828194 -0.8278938  -0.8418062 ]
  [FlaxMamba2] xBC (step) sample values: [-1.8935751   0.10604808 -0.3926326  -0.8824832  -0.6954962 ]
  [FlaxMamba2] dt (step) sample values: [0.82034093 1.4158666  1.9764093  0.99909574 1.5272027 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.49706623  1.1748698   0.9087267  -1.8935751   1.6250916 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.3570448   0.00692171 -0.11105078 -0.19208655 -0.1131651 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.397328   -0.110632   -0.17315406 -0.33673987 -0.1252882 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.23762023 -0.05225926 -0.07910012 -0.14028637 -0.05872494]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.23762023 -0.05225926 -0.07910012 -0.14028637 -0.05872494]
  [FlaxMamba2] B (step) sample values: [-0.07669029 -0.05466203 -0.10795433  0.07223517 -0.01657333]
  [FlaxMamba2] C (step) sample values: [-0.04519231 -0.03907527 -0.2601508   0.03766978 -0.11190513]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.8654757 -5.63779   -3.8975632 -2.4259677 -3.6937442]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.15231803 0.06874864 0.12414499 0.1041013  0.10951971]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.646318   0.67869025 0.6163977  0.7768202  0.66728514]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.23762023 -0.05225926 -0.07910012 -0.14028637 -0.05872494]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00277572 -0.00197843 -0.00390728  0.00261447 -0.00059985]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00277572 -0.00197843 -0.00390728  0.00261447 -0.00059985]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0045942  -0.00112193 -0.00363967  0.00252     0.00120714]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00339307  0.01816529 -0.00648045 -0.0167847  -0.01282183]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.7253492  -0.14210527 -0.24906752 -0.44701996 -0.19292161]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.7253492  -0.14210527 -0.24906752 -0.44701996 -0.19292161]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.20115215  0.03684619  0.04818232  0.11253938  0.04890827]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.4517668   0.17671898  0.1596451   0.39760438  0.19663164]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.4517668   0.17671898  0.1596451   0.39760438  0.19663164]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.8239048 -5.5736237  0.8693952 -1.7325518  6.0524006]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.8239048 -5.5736237  0.8693952 -1.7325518  6.0524006]
  [Layer 36] Output shape after mixer: (1, 1, 1024)
  [Layer 36] Output sample values after mixer: [ 1.8239048 -5.5736237  0.8693952 -1.7325518  6.0524006]
  [Layer 36] Residual connection shape: (1, 1, 1024)
  [Layer 36] Residual connection sample values: [ -2.6118166 -12.529795   -3.197939   -7.833434   15.08424  ]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.07248531 -0.357069   -0.09311081 -0.22268362  0.4294406 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.07248531 -0.357069   -0.09311081 -0.22268362  0.4294406 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.07248531 -0.357069   -0.09311081 -0.22268362  0.4294406 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.2428045  -0.5368345  -0.23333612 -1.4125946   1.1767671 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.2428045  -0.5368345  -0.23333612 -1.4125946   1.1767671 ]
  [FlaxMamba2] xBC (step) sample values: [-0.06146366 -0.16693419  2.7629735   0.4082975   0.9075155 ]
  [FlaxMamba2] dt (step) sample values: [-1.0162048 -1.1237701  1.5136675 -1.7271825 -0.4083144]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.13349202 -0.5111333  -0.16051315 -0.06146366  1.0872566 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.02549586  0.06666344 -0.8957304  -0.09983206  0.48094654]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.05226293  0.00257653 -0.9803251  -0.06495047  0.39732838]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.02544877  0.00128992 -0.26745945 -0.03142096  0.23762049]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02544877  0.00128992 -0.26745945 -0.03142096  0.23762049]
  [FlaxMamba2] B (step) sample values: [-0.0034401  -0.2555088  -0.00668027 -0.21218625 -0.05664022]
  [FlaxMamba2] C (step) sample values: [-0.08096687 -0.27351412 -0.14514886 -0.2741628  -0.2654036 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.8178532  -31.169907   -39.01954     -0.46187502  -0.64770097]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00022861 0.00235614 0.01509925 0.00013179 0.00110136]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9995845  0.92919123 0.5547899  0.99993914 0.9992869 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02544877  0.00128992 -0.26745945 -0.03142096  0.23762049]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [2.0013678e-08 1.4864900e-06 3.8864211e-08 1.2344494e-06 3.2951939e-07]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [2.0013678e-08 1.4864900e-06 3.8864211e-08 1.2344494e-06 3.2951939e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00040622  0.00035389 -0.00061815  0.00089901 -0.00057362]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00130667  0.00512367 -0.0117182   0.0077921  -0.0044804 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04530561  0.00748631 -0.5016003  -0.04975892  0.43074828]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04530561  0.00748631 -0.5016003  -0.04975892  0.43074828]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00483573 -0.00148267  0.05172404  0.01376439  0.3874498 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03664611 -0.00812504  0.26659244  0.11224052  1.6859511 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03664611 -0.00812504  0.26659244  0.11224052  1.6859511 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.56490433 -1.8801427  -1.7247473   3.8809419  -1.9797996 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.56490433 -1.8801427  -1.7247473   3.8809419  -1.9797996 ]
  [Layer 37] Output shape after mixer: (1, 1, 1024)
  [Layer 37] Output sample values after mixer: [-0.56490433 -1.8801427  -1.7247473   3.8809419  -1.9797996 ]
  [Layer 37] Residual connection shape: (1, 1, 1024)
  [Layer 37] Residual connection sample values: [ -3.176721  -14.409937   -4.922686   -3.9524922  13.104441 ]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.08660385 -0.39284405 -0.13356332 -0.10441773  0.35963526]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08660385 -0.39284405 -0.13356332 -0.10441773  0.35963526]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08660385 -0.39284405 -0.13356332 -0.10441773  0.35963526]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.17262971 -1.9971036   1.2590883  -0.24945635 -0.6823452 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.17262971 -1.9971036   1.2590883  -0.24945635 -0.6823452 ]
  [FlaxMamba2] xBC (step) sample values: [-0.22204053 -0.0540061   0.41885388  0.1003833   0.11808625]
  [FlaxMamba2] dt (step) sample values: [-0.22744583  0.50474316 -0.46305794  0.09597387  0.78585297]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.53411996  0.89194643  0.45082816 -0.22204053 -1.0286534 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.05895621 -0.95616275  0.0010376  -0.11508521 -0.1383072 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.06134612 -1.2454693  -0.08905029 -0.15826759 -0.04535066]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.02973252 -0.2783442  -0.04254397 -0.07288467 -0.02216124]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02973252 -0.2783442  -0.04254397 -0.07288467 -0.02216124]
  [FlaxMamba2] B (step) sample values: [-0.03516923 -0.27781817  0.06031423 -0.04240576 -0.02820535]
  [FlaxMamba2] C (step) sample values: [-0.27302548 -0.04273735 -0.23246047 -0.27178663 -0.10824864]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17041285 -2.0831616  -0.13507122 -0.41240796 -3.531486  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.6799158 0.1894306 0.4698006 0.3234529 0.2044107]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.89059424 0.67393976 0.9385149  0.87511975 0.48584116]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02973252 -0.2783442  -0.04254397 -0.07288467 -0.02216124]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00071097  0.00561626 -0.00121929  0.00085726  0.00057019]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00071097  0.00561626 -0.00121929  0.00085726  0.00057019]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00060628  0.12730758 -0.0098835  -0.00554546  0.00103254]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.28408653 -0.27616638 -0.20293681 -0.19856219  0.46783656]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.2884471  -0.31698856 -0.20917635 -0.20925152  0.46458638]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.2884471  -0.31698856 -0.20917635 -0.20925152  0.46458638]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02275359  0.07565521 -0.20513192  0.02286099 -0.10643176]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.09050007  0.20259717 -0.6074925   0.13517888 -0.43513143]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.09050007  0.20259717 -0.6074925   0.13517888 -0.43513143]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.8633132 -4.5409718  3.3818378 -1.0673748 -2.5525033]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.8633132 -4.5409718  3.3818378 -1.0673748 -2.5525033]
  [Layer 38] Output shape after mixer: (1, 1, 1024)
  [Layer 38] Output sample values after mixer: [ 3.8633132 -4.5409718  3.3818378 -1.0673748 -2.5525033]
  [Layer 38] Residual connection shape: (1, 1, 1024)
  [Layer 38] Residual connection sample values: [  0.6865921 -18.950909   -1.5408483  -5.019867   10.551937 ]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.01150945 -0.345479   -0.0272423  -0.09308357  0.18564835]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.01150945 -0.345479   -0.0272423  -0.09308357  0.18564835]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.01150945 -0.345479   -0.0272423  -0.09308357  0.18564835]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.3672782  0.6534337 -1.8984846 -0.5924503 -1.8171127]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.3672782  0.6534337 -1.8984846 -0.5924503 -1.8171127]
  [FlaxMamba2] xBC (step) sample values: [-0.11333404  0.29899368 -0.44226733  1.2322133   0.04759122]
  [FlaxMamba2] dt (step) sample values: [ 2.10778    3.4341884 -1.6118354  2.85221   -0.539406 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.8239754  -1.2064722   0.25050467 -0.11333404  0.75142246]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02015273 -0.06279523 -0.07436614  0.3011137  -0.00397552]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04430039 -0.12352521 -0.05910736  0.8387114  -0.00737823]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.02264075 -0.05795283 -0.02868051  0.58558303 -0.0036755 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02264075 -0.05795283 -0.02868051  0.58558303 -0.0036755 ]
  [FlaxMamba2] B (step) sample values: [ 0.03352261 -0.04210896 -0.16949055  0.03277396  0.05019639]
  [FlaxMamba2] C (step) sample values: [-0.25583908 -0.26933038  0.00732842 -0.13753167 -0.20876361]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.7351256e+02 -2.3790452e+00 -2.6078771e-03 -1.4978828e+00
 -6.3306607e-02]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.2654098  2.360468   0.05845787 1.2033098  0.00521166]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.         0.00364041 0.99984753 0.16489984 0.99967015]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02264075 -0.05795283 -0.02868051  0.58558303 -0.0036755 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00096042 -0.00120641 -0.00485587  0.00093897  0.00143812]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00096042 -0.00120641 -0.00485587  0.00093897  0.00143812]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00096042 -0.00120641 -0.00485587  0.00093897  0.00143812]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00336913 -0.00862385 -0.00426789  0.08713952 -0.00054694]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.10581539 -0.2708524  -0.13404325  2.736822   -0.0171781 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.10581539 -0.2708524  -0.13404325  2.736822   -0.0171781 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02296071 -0.11641726  0.03315355 -0.5773476   0.00436319]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.1294845  -0.6219691   0.16759773 -2.8478847   0.02596246]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.1294845  -0.6219691   0.16759773 -2.8478847   0.02596246]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-7.7980185  -2.5300007   0.34363708  1.6069441   0.7056178 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-7.7980185  -2.5300007   0.34363708  1.6069441   0.7056178 ]
  [Layer 39] Output shape after mixer: (1, 1, 1024)
  [Layer 39] Output sample values after mixer: [-7.7980185  -2.5300007   0.34363708  1.6069441   0.7056178 ]
  [Layer 39] Residual connection shape: (1, 1, 1024)
  [Layer 39] Residual connection sample values: [ -7.1114264 -21.48091    -1.1972111  -3.4129229  11.257555 ]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.13864172 -0.44686913 -0.02439551 -0.06369445  0.22721405]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.13864172 -0.44686913 -0.02439551 -0.06369445  0.22721405]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.13864172 -0.44686913 -0.02439551 -0.06369445  0.22721405]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 2.1493845e+00 -1.2306011e+00  1.0636045e+00 -1.6648499e-03
 -4.1855559e-01]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 2.1493845e+00 -1.2306011e+00  1.0636045e+00 -1.6648499e-03
 -4.1855559e-01]
  [FlaxMamba2] xBC (step) sample values: [-3.3809352   0.13789031  0.13564876  0.7907056   1.0393887 ]
  [FlaxMamba2] dt (step) sample values: [ 2.6625142  0.9969498  0.9498518 -1.2047787  1.8529934]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.8215866  -0.16800253 -2.0063157  -3.3809352   0.6326279 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.51140815 -0.01788198  0.03112829 -0.17462488  0.18005037]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.18010932 -0.06637441 -0.04052698 -0.18617578  0.18158293]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.08196668 -0.03208622 -0.01985294 -0.08444748  0.09901198]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08196668 -0.03208622 -0.01985294 -0.08444748  0.09901198]
  [FlaxMamba2] B (step) sample values: [ 0.0401383  -0.13849886  0.02950687  0.06185159  0.00615921]
  [FlaxMamba2] C (step) sample values: [-0.09321643 -0.2541272   0.53444535  0.20445779  0.40987608]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.52670574 -0.63007647 -0.38779998 -2.7909086  -0.42841786]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.22986895 0.03472461 0.0701111  0.00182303 0.09849478]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.88596904 0.97835845 0.9731772  0.994925   0.958681  ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08196668 -0.03208622 -0.01985294 -0.08444748  0.09901198]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00075627  0.00260954 -0.00055596 -0.00116538 -0.00011605]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00075627  0.00260954 -0.00055596 -0.00116538 -0.00011605]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00158331 -0.03191802 -0.00629972 -0.0005256  -0.00073129]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00183479 -0.01383718 -0.01676321 -0.01131587  0.00393771]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.20475346 -0.09327059 -0.06591162 -0.22037609  0.24905415]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.20475346 -0.09327059 -0.06591162 -0.22037609  0.24905415]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-3.9415306e-01  2.5948780e-02 -5.2113745e-02  1.8329387e-04
 -4.1370131e-02]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-3.0760849e+00  2.3975818e-01 -4.9018309e-01  1.3625264e-03
 -5.0651580e-01]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-3.0760849e+00  2.3975818e-01 -4.9018309e-01  1.3625264e-03
 -5.0651580e-01]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.48094735 -6.9940176  -3.7097347  -3.4777718   6.7274055 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.48094735 -6.9940176  -3.7097347  -3.4777718   6.7274055 ]
  [Layer 40] Output shape after mixer: (1, 1, 1024)
  [Layer 40] Output sample values after mixer: [ 0.48094735 -6.9940176  -3.7097347  -3.4777718   6.7274055 ]
  [Layer 40] Residual connection shape: (1, 1, 1024)
  [Layer 40] Residual connection sample values: [ -6.630479  -28.474926   -4.9069457  -6.8906946  17.98496  ]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.07704087 -0.3537453  -0.05880771 -0.07911322  0.20940898]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.07704087 -0.3537453  -0.05880771 -0.07911322  0.20940898]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.07704087 -0.3537453  -0.05880771 -0.07911322  0.20940898]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.4484407  -3.0908492  -0.9329615  -0.5431693   0.19993731]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.4484407  -3.0908492  -0.9329615  -0.5431693   0.19993731]
  [FlaxMamba2] xBC (step) sample values: [-0.43994457  0.4428929  -0.12320807  0.5480811  -0.4621366 ]
  [FlaxMamba2] dt (step) sample values: [ 2.1288857  -0.5245822   1.0661137  -0.03792613  1.1491411 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.864172   -0.80119365 -0.5914106  -0.43994457  0.778222  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.1197559   0.02119034 -0.02680637 -0.09718178  0.10125005]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.15143314  0.14356583 -0.02674384 -0.18989418  0.09169041]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.0699945   0.07692687 -0.01319312 -0.08595913  0.04794552]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0699945   0.07692687 -0.01319312 -0.08595913  0.04794552]
  [FlaxMamba2] B (step) sample values: [ 0.03589129  0.09353242  0.04474139 -0.02058632  0.02874509]
  [FlaxMamba2] C (step) sample values: [ 0.61500555 -0.10229643 -0.07850192 -0.05140697 -0.2419413 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.0530885  -1.135641   -0.87189615 -1.5713016  -1.7430981 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.48148787 0.12925594 0.2725777  0.12180817 0.23849376]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.60227    0.86347675 0.78847116 0.82580435 0.65986633]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0699945   0.07692687 -0.01319312 -0.08595913  0.04794552]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00120959 -0.00315218 -0.00150785  0.00069379 -0.00096875]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00120959 -0.00315218 -0.00150785  0.00069379 -0.00096875]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00031393 -0.00804067 -0.00698356 -0.00013831 -0.00498467]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01428104  0.00861299 -0.0022406  -0.01779478  0.00612806]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.10381133  0.10701051 -0.01911599 -0.1277455   0.06745539]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.10381133  0.10701051 -0.01911599 -0.1277455   0.06745539]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02840996 -0.01438324  0.00503511  0.02549646  0.00741532]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.6921936  -0.4678235   0.14139001  0.8702213   0.2350147 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.6921936  -0.4678235   0.14139001  0.8702213   0.2350147 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.49531725 -4.276567    2.172654    1.0731174   4.685869  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.49531725 -4.276567    2.172654    1.0731174   4.685869  ]
  [Layer 41] Output shape after mixer: (1, 1, 1024)
  [Layer 41] Output sample values after mixer: [ 0.49531725 -4.276567    2.172654    1.0731174   4.685869  ]
  [Layer 41] Residual connection shape: (1, 1, 1024)
  [Layer 41] Residual connection sample values: [ -6.1351614 -32.75149    -2.7342918  -5.8175774  22.67083  ]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.06705525 -0.38465834 -0.03195151 -0.06349795  0.26071975]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.06705525 -0.38465834 -0.03195151 -0.06349795  0.26071975]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.06705525 -0.38465834 -0.03195151 -0.06349795  0.26071975]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.23551627  1.7600197  -0.14209968 -1.3800892  -0.644732  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.23551627  1.7600197  -0.14209968 -1.3800892  -0.644732  ]
  [FlaxMamba2] xBC (step) sample values: [-0.28390524  2.3854027  -1.0463072  -0.60136575 -0.34409246]
  [FlaxMamba2] dt (step) sample values: [ 1.2198683  -0.8392284  -0.15082048 -0.8562526   1.2949789 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.02132909 -0.8487252   0.09180145 -0.28390524  0.78899807]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.05759895  0.50325185  0.22757465  0.11930685 -0.09825777]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03672493  0.46748525  0.23219424  0.11556654 -0.14443086]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.01869961  0.2874045   0.12951542  0.06111847 -0.06700941]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01869961  0.2874045   0.12951542  0.06111847 -0.06700941]
  [FlaxMamba2] B (step) sample values: [-0.08641485  0.01101498 -0.07679978 -0.02417692  0.01338859]
  [FlaxMamba2] C (step) sample values: [ 0.05451803 -0.19635104 -0.03005193 -0.24156114 -0.25680503]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.2458453 -1.7473589 -3.3796544 -1.2264227 -1.3705136]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.3146155  0.05841073 0.11267231 0.00887979 0.25765258]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.4933296  0.90297127 0.683319   0.9891687  0.70249546]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01869961  0.2874045   0.12951542  0.06111847 -0.06700941]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.0839467e-04  6.4803156e-05 -4.5182739e-04 -1.4223733e-04
  7.8767553e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.0839467e-04  6.4803156e-05 -4.5182739e-04 -1.4223733e-04
  7.8767553e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0005049  -0.00011185 -0.000141   -0.00019833 -0.00028456]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00273121  0.14360327  0.05967795  0.02248203 -0.02795176]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02829764  0.5365477   0.2367537   0.10604426 -0.1195682 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02829764  0.5365477   0.2367537   0.10604426 -0.1195682 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00372288  0.80571777 -0.01562817 -0.02941568  0.02653246]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.09801278 20.398443   -0.4073453  -0.7767468   0.47716853]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.09801278 20.398443   -0.4073453  -0.7767468   0.47716853]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.0769318 -6.5762086  6.713849  -1.028421  -3.9958463]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.0769318 -6.5762086  6.713849  -1.028421  -3.9958463]
  [Layer 42] Output shape after mixer: (1, 1, 1024)
  [Layer 42] Output sample values after mixer: [-0.0769318 -6.5762086  6.713849  -1.028421  -3.9958463]
  [Layer 42] Residual connection shape: (1, 1, 1024)
  [Layer 42] Residual connection sample values: [ -6.2120934 -39.3277      3.9795573  -6.8459983  18.674984 ]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.06283239 -0.4354425   0.04217072 -0.06919619  0.19202155]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.06283239 -0.4354425   0.04217072 -0.06919619  0.19202155]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.06283239 -0.4354425   0.04217072 -0.06919619  0.19202155]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.37537077 -0.9384776  -0.5854312   0.05094749 -1.2988881 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.37537077 -0.9384776  -0.5854312   0.05094749 -1.2988881 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.31073657  0.0924923   1.0227323  -0.6896867  -0.3923702 ]
  [FlaxMamba2] dt (step) sample values: [ 1.1513551  -0.13000517 -0.66187733  0.77096397 -0.62529504]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.25887382 -0.99983454  0.53693     0.31073657 -0.24998187]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06992491 -0.01305194 -0.21537462 -0.12704727 -0.07089984]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.05532988 -0.06728168 -0.24338976 -0.17486832 -0.07921588]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.02843009 -0.03250956 -0.10695792 -0.07980885 -0.03803997]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02843009 -0.03250956 -0.10695792 -0.07980885 -0.03803997]
  [FlaxMamba2] B (step) sample values: [ 0.00164044 -0.02282754  0.04213088 -0.15950273  0.15352099]
  [FlaxMamba2] C (step) sample values: [-0.16032824 -0.06394962 -0.20580705 -0.24528852  0.0524215 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-3.7045815 -2.655313  -8.210951  -2.2381823 -4.092597 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.18314552 0.06999393 0.03276034 0.652021   0.0006852 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.5073889  0.8303933  0.76414824 0.23238917 0.99719965]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02843009 -0.03250956 -0.10695792 -0.07980885 -0.03803997]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.5415304e-06 -1.1885946e-04  2.1936897e-04 -8.3050597e-04
  7.9935993e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.5415304e-06 -1.1885946e-04  2.1936897e-04 -8.3050597e-04
  7.9935993e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0018645  -0.00021295 -0.00100755  0.00248061 -0.00196428]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00048381 -0.00410611 -0.00767293 -0.00555776 -0.00254029]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.04640824 -0.05772676 -0.18408729 -0.13719295 -0.06528269]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.04640824 -0.05772676 -0.18408729 -0.13719295 -0.06528269]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01032599  0.01523452  0.03854775 -0.00358383  0.01817597]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.25327808  0.5006801   1.0140641  -0.09494255  0.49768004]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.25327808  0.5006801   1.0140641  -0.09494255  0.49768004]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.1840138 -2.8763525 -2.9635499 -2.166092  -9.879757 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.1840138 -2.8763525 -2.9635499 -2.166092  -9.879757 ]
  [Layer 43] Output shape after mixer: (1, 1, 1024)
  [Layer 43] Output sample values after mixer: [ 3.1840138 -2.8763525 -2.9635499 -2.166092  -9.879757 ]
  [Layer 43] Residual connection shape: (1, 1, 1024)
  [Layer 43] Residual connection sample values: [ -3.0280795 -42.204056    1.0160074  -9.012091    8.795227 ]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.02932473 -0.4226552   0.01020172 -0.08531091  0.08622115]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.02932473 -0.4226552   0.01020172 -0.08531091  0.08622115]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.02932473 -0.4226552   0.01020172 -0.08531091  0.08622115]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.7298102   0.70956904 -0.40277854 -1.1212232   0.8368011 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.7298102   0.70956904 -0.40277854 -1.1212232   0.8368011 ]
  [FlaxMamba2] xBC (step) sample values: [-0.20393051 -0.68632704 -0.18297331 -0.3834383  -0.23118311]
  [FlaxMamba2] dt (step) sample values: [ 0.06453414 -0.28745574 -0.16437344  1.2315599  -0.48256934]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.62443125 -1.0671846  -0.83548874 -0.20393051  0.03908215]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.04389042  0.14684929 -0.0246303   0.06800125 -0.04440206]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02240605  0.08978142 -0.0533626   0.05484817 -0.03777212]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.01107752  0.04690453 -0.02596958  0.02817598 -0.01852942]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01107752  0.04690453 -0.02596958  0.02817598 -0.01852942]
  [FlaxMamba2] B (step) sample values: [-0.0289885  -0.22682813 -0.27411583  0.03420082  0.06257342]
  [FlaxMamba2] C (step) sample values: [ 0.19283871 -0.25614607 -0.16755226 -0.0560369  -0.13198727]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-4.6876054  -0.9752563  -0.82549465 -1.2937802  -0.49527767]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10556    0.03350529 0.02085562 0.14757107 0.00479378]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.60967845 0.9678519  0.98293114 0.82619494 0.99762857]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01107752  0.04690453 -0.02596958  0.02817598 -0.01852942]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.3897515e-05  2.6523997e-04  3.2053553e-04 -3.9992505e-05
 -7.3169809e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.3897515e-05  2.6523997e-04  3.2053553e-04 -3.9992505e-05
 -7.3169809e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.5350471e-05  3.8486919e-03  4.1808584e-03 -7.2403601e-04
 -7.0002896e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00293172  0.003032   -0.00244438  0.00170615 -0.00129368]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0221827   0.08454465 -0.04757539  0.05067154 -0.03349487]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0221827   0.08454465 -0.04757539  0.05067154 -0.03349487]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01092385  0.04021183  0.0076773  -0.01396402 -0.01955807]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.31007862  1.0452743   0.25292346 -0.39541432 -0.5430521 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.31007862  1.0452743   0.25292346 -0.39541432 -0.5430521 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ -4.4244704   0.9443712   0.9415845   8.928719  -12.197529 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ -4.4244704   0.9443712   0.9415845   8.928719  -12.197529 ]
  [Layer 44] Output shape after mixer: (1, 1, 1024)
  [Layer 44] Output sample values after mixer: [ -4.4244704   0.9443712   0.9415845   8.928719  -12.197529 ]
  [Layer 44] Residual connection shape: (1, 1, 1024)
  [Layer 44] Residual connection sample values: [ -7.45255    -41.259686     1.957592    -0.08337212  -3.4023018 ]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.08303852 -0.49633852  0.02291632 -0.00093213 -0.03840543]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08303852 -0.49633852  0.02291632 -0.00093213 -0.03840543]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08303852 -0.49633852  0.02291632 -0.00093213 -0.03840543]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.756739   -0.43740672 -0.12688076 -0.759524   -0.10542914]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.756739   -0.43740672 -0.12688076 -0.759524   -0.10542914]
  [FlaxMamba2] xBC (step) sample values: [-0.16219962  0.2833395   0.6872751  -0.45722103  0.28061545]
  [FlaxMamba2] dt (step) sample values: [ 1.0754162  -0.5203609   0.599447    0.24028338 -0.19469808]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.36166283  0.10074349 -0.88069165 -0.16219962  0.91976583]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.0346945   0.03272449  0.13212126  0.10043523  0.04398458]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04035551  0.29078114  0.10982817  0.04443548  0.03323476]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.01977067  0.1663813   0.05792661  0.02271129  0.01689349]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01977067  0.1663813   0.05792661  0.02271129  0.01689349]
  [FlaxMamba2] B (step) sample values: [ 0.06226855  0.24696186 -0.11068828 -0.27839246  0.01304975]
  [FlaxMamba2] C (step) sample values: [-0.23363008 -0.06816079 -0.15330715  0.05168336 -0.24198852]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.3039274e+00 -3.9384812e-02 -6.8873577e+00 -8.0558503e-01
 -1.9935181e+03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00649186 0.01106009 0.01402452 0.00079975 0.01576667]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.9157083e-01 9.9956447e-01 9.0792650e-01 9.9935591e-01 2.2368221e-14]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01977067  0.1663813   0.05792661  0.02271129  0.01689349]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.9920665e-06 -3.1697153e-05  1.4206660e-05  3.5731220e-05
 -1.6749136e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.9920665e-06 -3.1697153e-05  1.4206660e-05  3.5731220e-05
 -1.6749136e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.0016549  0.00088791 0.00126121 0.00031201 0.00161104]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00111509  0.03482411 -0.00451077 -0.00898955  0.00680797]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05242616  0.46663567  0.14582692  0.04995336  0.05065187]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05242616  0.46663567  0.14582692  0.04995336  0.05065187]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01266973 -0.08008425 -0.00866519 -0.01209361 -0.00252947]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.1804507  -0.8557466  -0.11055187 -0.14613949 -0.03666127]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.1804507  -0.8557466  -0.11055187 -0.14613949 -0.03666127]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.404352   -6.1448855   0.88580495  3.1265078  -4.2628107 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.404352   -6.1448855   0.88580495  3.1265078  -4.2628107 ]
  [Layer 45] Output shape after mixer: (1, 1, 1024)
  [Layer 45] Output sample values after mixer: [-1.404352   -6.1448855   0.88580495  3.1265078  -4.2628107 ]
  [Layer 45] Residual connection shape: (1, 1, 1024)
  [Layer 45] Residual connection sample values: [ -8.856902  -47.40457     2.843397    3.0431356  -7.6651125]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.08993972 -0.5177237   0.03043103  0.03145778 -0.07704455]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08993972 -0.5177237   0.03043103  0.03145778 -0.07704455]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.08993972 -0.5177237   0.03043103  0.03145778 -0.07704455]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.54098904 -0.9056425   0.4325321  -0.92713594  0.392671  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.54098904 -0.9056425   0.4325321  -0.92713594  0.392671  ]
  [FlaxMamba2] xBC (step) sample values: [ 1.4706861   0.5735955  -1.1777627   0.07337404  1.1003605 ]
  [FlaxMamba2] dt (step) sample values: [0.529922   1.2689662  0.38236845 0.40537575 1.4985589 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.8542167   0.20801969  1.3816338   1.4706861  -0.64888257]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01116493 -0.10475613 -0.22883779 -0.01076512 -0.1796181 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04428551 -0.14207913 -0.02595693 -0.00626378 -0.18487094]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.02263298 -0.06600142 -0.01281003 -0.00312208 -0.08391541]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02263298 -0.06600142 -0.01281003 -0.00312208 -0.08391541]
  [FlaxMamba2] B (step) sample values: [-0.22601989 -0.0468611  -0.05296787 -0.06556635  0.01021644]
  [FlaxMamba2] C (step) sample values: [0.07294463 0.03910188 0.05240413 0.06360143 0.10301641]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.4426116  -0.9829804 -10.158994   -1.363838   -1.7559118]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01487618 0.04874606 0.00159841 0.01951776 0.04778453]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9787681  0.95321345 0.98389286 0.9737321  0.91951823]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02263298 -0.06600142 -0.01281003 -0.00312208 -0.08391541]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.6099132e-05 -1.5777767e-05 -1.7833867e-05 -2.2075679e-05
  3.4397970e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.6099132e-05 -1.5777767e-05 -1.7833867e-05 -2.2075679e-05
  3.4397970e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.6899586e-03  1.9927802e-04 -2.7760758e-05  7.1381294e-04
 -8.7763142e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00315542 -0.00200828  0.00794734 -0.0012576  -0.00638335]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.0308835  -0.08286785 -0.00774647 -0.00508251 -0.10918969]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.0308835  -0.08286785 -0.00774647 -0.00508251 -0.10918969]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0061477   0.02160593 -0.00203206  0.00133593 -0.02559355]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.25572464  0.8355574  -0.06703512  0.04363114 -0.83540994]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.25572464  0.8355574  -0.06703512  0.04363114 -0.83540994]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [10.939281  -3.4984205 -2.9886718 -6.15847   -4.7170596]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [10.939281  -3.4984205 -2.9886718 -6.15847   -4.7170596]
  [Layer 46] Output shape after mixer: (1, 1, 1024)
  [Layer 46] Output sample values after mixer: [10.939281  -3.4984205 -2.9886718 -6.15847   -4.7170596]
  [Layer 46] Residual connection shape: (1, 1, 1024)
  [Layer 46] Residual connection sample values: [  2.0823793  -50.902992    -0.14527488  -3.1153345  -12.382172  ]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.01789073 -0.45597944 -0.00127474 -0.02526749 -0.10645213]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.01789073 -0.45597944 -0.00127474 -0.02526749 -0.10645213]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.01789073 -0.45597944 -0.00127474 -0.02526749 -0.10645213]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.06582028  0.10053781 -0.6490665  -0.8004511   0.40835616]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.06582028  0.10053781 -0.6490665  -0.8004511   0.40835616]
  [FlaxMamba2] xBC (step) sample values: [-1.1328294   0.4746063   0.20889805 -0.53707117 -0.17188622]
  [FlaxMamba2] dt (step) sample values: [0.857473  1.6545516 1.0545827 1.0296046 2.0683506]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.7599935  -0.5188107  -1.1000143  -1.1328294   0.43224314]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.26858577  0.07560862  0.04057365  0.09436015 -0.02550032]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.25566158  0.09069193  0.03945976  0.10115794 -0.02741434]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.14408307  0.04740081  0.0201191   0.05313503 -0.0135193 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.14408307  0.04740081  0.0201191   0.05313503 -0.0135193 ]
  [FlaxMamba2] B (step) sample values: [-0.02335829 -0.02047105  0.00737301 -0.03402547 -0.22352481]
  [FlaxMamba2] C (step) sample values: [-0.15360546 -0.2554898  -0.04873096 -0.2490837  -0.27360556]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-5.7667141e+01 -2.2024069e+00 -3.8371372e+00 -4.6045512e-02
 -2.0699801e+00]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.105949   0.02302794 0.03674728 0.04888069 0.03182184]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.00222105 0.95054775 0.8684855  0.9977518  0.93625206]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.14408307  0.04740081  0.0201191   0.05313503 -0.0135193 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00035657 -0.0003125   0.00011255 -0.00051941 -0.00341221]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00035657 -0.0003125   0.00011255 -0.00051941 -0.00341221]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00032506 -0.0003165   0.00011237 -0.00052323 -0.00343133]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00652362  0.00213726  0.00090679  0.00240684 -0.00060455]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.23356937  0.07683135  0.03261041  0.08613688 -0.02190823]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.23356937  0.07683135  0.03261041  0.08613688 -0.02190823]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00743392  0.00405621 -0.00726428 -0.0213691  -0.00537402]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.25170887  0.15196393 -0.24948482 -1.0511522  -0.21331292]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.25170887  0.15196393 -0.24948482 -1.0511522  -0.21331292]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-10.662651   17.571878   -3.1891086  -7.4085712   4.8374557]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-10.662651   17.571878   -3.1891086  -7.4085712   4.8374557]
  [Layer 47] Output shape after mixer: (1, 1, 1024)
  [Layer 47] Output sample values after mixer: [-10.662651   17.571878   -3.1891086  -7.4085712   4.8374557]
  [Layer 47] Residual connection shape: (1, 1, 1024)
  [Layer 47] Residual connection sample values: [ -8.580272  -33.331116   -3.3343835 -10.523906   -7.544716 ]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.06317566 -0.26478404 -0.02617649 -0.07556872 -0.05748318]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.06317566 -0.26478404 -0.02617649 -0.07556872 -0.05748318]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.06317566 -0.26478404 -0.02617649 -0.07556872 -0.05748318]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.11459541 -1.0119781  -0.62556547  0.06706066 -0.5396324 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.11459541 -1.0119781  -0.62556547  0.06706066 -0.5396324 ]
  [FlaxMamba2] xBC (step) sample values: [-0.16182798 -0.36672652 -0.6309927  -0.507649   -1.9141046 ]
  [FlaxMamba2] dt (step) sample values: [-0.62013805 -3.7752728   0.78382534 -0.01471749  0.9811176 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5649321   0.07681827 -0.9858096  -0.16182798  0.6335699 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.03160356 -0.05411173 -0.07095136 -0.05937124 -0.3039065 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03556321 -0.0846293  -0.08299055 -0.13944937 -0.3861819 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.01809776 -0.04052519 -0.0397744  -0.06487102 -0.1562634 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01809776 -0.04052519 -0.0397744  -0.06487102 -0.1562634 ]
  [FlaxMamba2] B (step) sample values: [-0.09582943 -0.05281718 -0.27827948  0.18080822  0.00113828]
  [FlaxMamba2] C (step) sample values: [-0.00674989 -0.07470152 -0.20424622 -0.09911609 -0.01686406]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.7303779  -7.389056   -3.3796544  -1.802826  -17.760078 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [6.1939997e-03 4.9279506e-06 1.3981108e-02 1.9029830e-02 2.3559687e-01]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9893393  0.9999636  0.95384765 0.9662744  0.0152341 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01809776 -0.04052519 -0.0397744  -0.06487102 -0.1562634 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0742240e-05 -5.9206745e-06 -3.1194435e-05  2.0268149e-05
  1.2759848e-07]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0742240e-05 -5.9206745e-06 -3.1194435e-05  2.0268149e-05
  1.2759848e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.9035210e-04  4.5891028e-04  5.7686545e-04 -1.4586470e-04
 -4.0729585e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0001773   0.00069137 -0.00055693 -0.00199359 -0.00128521]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02556397 -0.05694947 -0.05712989 -0.09426262 -0.2235458 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02556397 -0.05694947 -0.05712989 -0.09426262 -0.2235458 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00154859  0.01536418  0.01245546 -0.0032666   0.04442573]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.08944298  0.9939251   0.7629734  -0.17609958  3.2610967 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.08944298  0.9939251   0.7629734  -0.17609958  3.2610967 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [  2.55232  -19.683182   4.701296  14.128273  30.525805]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [  2.55232  -19.683182   4.701296  14.128273  30.525805]
  [Layer 48] Output shape after mixer: (1, 1, 1024)
  [Layer 48] Output sample values after mixer: [  2.55232  -19.683182   4.701296  14.128273  30.525805]
  [Layer 48] Residual connection shape: (1, 1, 1024)
  [Layer 48] Residual connection sample values: [ -6.0279517 -53.014297    1.3669124   3.6043673  22.981089 ]
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.09483661 -1.2049356   0.02460395  0.05121469  0.37190697]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 1, 1024)
[Mamba2LMHeadModel] Final backbone norm output sample values: [-0.09483661 -1.2049356   0.02460395  0.05121469  0.37190697]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 1, 50288)
[Mamba2LMHeadModel] Logits sample values: [22.472324 14.886241 21.329374 18.539381 18.912832]
[Mamba2LMHeadModel] Forward pass input_ids shape: (1, 1)
[Mamba2LMHeadModel] input_ids sample values: [209]
[Mamba2LMHeadModel] Embedding output shape: (1, 1, 1024)
[Mamba2LMHeadModel] Embedding sample values: [ 0.0218811   0.11560059 -0.18286133  0.0668335   0.05038452]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.02291879  0.1540942  -0.21004367  0.05981945  0.04941854]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.02291879  0.1540942  -0.21004367  0.05981945  0.04941854]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.02291879  0.1540942  -0.21004367  0.05981945  0.04941854]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.24454619  0.49420813  0.15215264 -0.3011539  -0.54894817]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.24454619  0.49420813  0.15215264 -0.3011539  -0.54894817]
  [FlaxMamba2] xBC (step) sample values: [ 0.45542032 -0.35162482 -0.1342011   0.22669017  0.18198697]
  [FlaxMamba2] dt (step) sample values: [0.31521335 0.24694209 0.25600716 0.27121675 0.03335766]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.08863552  0.07741071  0.64639604  0.45542032 -0.3854498 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.07405717  0.5510563   0.08406711 -0.10340089 -0.10655777]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.11662919  0.5434651   0.19679904 -0.31287354 -0.30370134]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.06171134  0.34380585  0.10805085 -0.132162   -0.12896766]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06171134  0.34380585  0.10805085 -0.132162   -0.12896766]
  [FlaxMamba2] B (step) sample values: [-0.2291838  -0.02616231 -0.03612319  0.644953   -0.0133518 ]
  [FlaxMamba2] C (step) sample values: [-0.26343268 -0.00393134 -0.15547547 -0.12236178  0.03905902]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.4383634 -1.0010935 -1.2128745 -1.1529616 -1.4844131]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.07560723 0.04319964 0.03134097 0.03409208 0.02320417]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9673998  0.9576749  0.9627007  0.96145564 0.9661419 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06171134  0.34380585  0.10805085 -0.132162   -0.12896766]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0693312e-03 -1.2206873e-04 -1.6854441e-04  3.0092371e-03
 -6.2297127e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0693312e-03 -1.2206873e-04 -1.6854441e-04  3.0092371e-03
 -6.2297127e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01981988 -0.00397282 -0.00087876  0.04901409 -0.00067698]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0731419   0.03776541  0.1525479  -0.24489424 -0.19321872]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.17898068  0.6274138   0.33786184 -0.4715603  -0.41440627]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.17898068  0.6274138   0.33786184 -0.4715603  -0.41440627]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01922189  0.1925855   0.02765493  0.06039431  0.08328512]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01993732  0.16486202  0.02365824  0.04236552  0.29914096]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01993732  0.16486202  0.02365824  0.04236552  0.29914096]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.12766755 -0.01130289  0.47215867 -0.18826157 -0.17718628]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.12766755 -0.01130289  0.47215867 -0.18826157 -0.17718628]
  [Layer 1] Output shape after mixer: (1, 1, 1024)
  [Layer 1] Output sample values after mixer: [ 0.12766755 -0.01130289  0.47215867 -0.18826157 -0.17718628]
  [Layer 1] Residual connection shape: (1, 1, 1024)
  [Layer 1] Residual connection sample values: [ 0.14954865  0.1042977   0.28929734 -0.12142807 -0.12680176]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.16843836  0.09865437  0.25257337 -0.143818   -0.13002138]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.16843836  0.09865437  0.25257337 -0.143818   -0.13002138]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.16843836  0.09865437  0.25257337 -0.143818   -0.13002138]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.3107703  -0.7516786  -0.89016885  2.8219323  -0.21884365]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.3107703  -0.7516786  -0.89016885  2.8219323  -0.21884365]
  [FlaxMamba2] xBC (step) sample values: [ 0.5476473  -0.9346466   1.3484722  -1.2895417  -0.32725522]
  [FlaxMamba2] dt (step) sample values: [ 2.5755424  -0.95168227 -0.8663978   2.4941008   2.2597106 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.82328    -0.5496252   0.06908027  0.5476473   0.4484027 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.0239491   0.0185052  -0.15492114 -0.04801547 -0.04307086]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01461835 -0.01141729 -0.26673755 -0.19205844 -0.03969295]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.0073626  -0.00567605 -0.11568626 -0.08683585 -0.01945264]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0073626  -0.00567605 -0.11568626 -0.08683585 -0.01945264]
  [FlaxMamba2] B (step) sample values: [ 0.08590773 -0.00692446 -0.00841215 -0.04640629  0.03674822]
  [FlaxMamba2] C (step) sample values: [-0.12086431  0.02997176  0.2478988   0.20028424 -0.10314289]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-12.692555   -19.429585    -0.22886811  -2.10566     -5.0388985 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.5181118  0.01364408 0.01043047 0.57849157 0.44387233]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.00139318 0.76713014 0.99761564 0.29578972 0.10681813]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0073626  -0.00567605 -0.11568626 -0.08683585 -0.01945264]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.2770782e-04 -2.6414365e-05 -3.2089385e-05 -1.7702370e-04
  1.4018157e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.2770782e-04 -2.6414365e-05 -3.2089385e-05 -1.7702370e-04
  1.4018157e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 3.2773509e-04 -2.5633648e-05 -3.1454027e-05 -1.7768136e-04
  1.3999236e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00068651  0.000527    0.01076539  0.00809698  0.0018099 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.0042216  -0.00325681 -0.06635416 -0.04979011 -0.01115775]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.0042216  -0.00325681 -0.06635416 -0.04979011 -0.01115775]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00435845  0.0007845   0.01719275 -0.13261494  0.00108784]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00224072  0.000567    0.01124709 -0.05712442  0.00081781]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00224072  0.000567    0.01124709 -0.05712442  0.00081781]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.54220164 -0.86594164  0.6901317   0.5343747   0.00781138]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.54220164 -0.86594164  0.6901317   0.5343747   0.00781138]
  [Layer 2] Output shape after mixer: (1, 1, 1024)
  [Layer 2] Output sample values after mixer: [-0.54220164 -0.86594164  0.6901317   0.5343747   0.00781138]
  [Layer 2] Residual connection shape: (1, 1, 1024)
  [Layer 2] Residual connection sample values: [-0.392653   -0.76164395  0.97942907  0.41294664 -0.11899038]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.40643016 -0.6615552   0.75778013  0.45748618 -0.11755442]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.40643016 -0.6615552   0.75778013  0.45748618 -0.11755442]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.40643016 -0.6615552   0.75778013  0.45748618 -0.11755442]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.4014819  -0.38271314 -2.4749827  -0.7951066  -2.888732  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-2.4014819  -0.38271314 -2.4749827  -0.7951066  -2.888732  ]
  [FlaxMamba2] xBC (step) sample values: [ 1.6465372 -0.8986222  1.858763  -0.3547043  1.9694884]
  [FlaxMamba2] dt (step) sample values: [ 2.232628    1.4432397  -0.50313675  0.6421181   0.5426372 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.5940917   0.307889   -0.28603148  1.6465372  -0.7755268 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.22500196 -0.03204016  0.4702924  -0.09090554  0.06913701]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.18014112 -0.10979895  0.41917545 -0.1375364   0.00230352]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.0981614  -0.05188855  0.25288263 -0.06404658  0.00115309]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0981614  -0.05188855  0.25288263 -0.06404658  0.00115309]
  [FlaxMamba2] B (step) sample values: [-0.0741896  -0.17383401 -0.0131015   0.1916859  -0.2766037 ]
  [FlaxMamba2] C (step) sample values: [-0.24151665  0.80681044  0.6868694   0.7599674   0.5371659 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-20.926485    -0.880345    -0.67350245  -0.6461216   -0.27258503]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.11394234e-01 2.03418806e-02 2.72362231e-05 9.92351770e-03
 1.76588595e-02]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.09718978 0.9822515  0.99998164 0.9936087  0.995198  ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0981614  -0.05188855  0.25288263 -0.06404658  0.00115309]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00081123 -0.00190081 -0.00014326  0.00209601 -0.00302455]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00081123 -0.00190081 -0.00014326  0.00209601 -0.00302455]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00079945 -0.00192441 -0.00016199  0.00209667 -0.00298669]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.03060326  0.01627929 -0.07878523  0.01990478 -0.0004821 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03908211 -0.0205567   0.10073767 -0.02556228  0.00033649]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03908211 -0.0205567   0.10073767 -0.02556228  0.00033649]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-7.7955727e-03  3.1899833e-03 -1.9355195e-02  6.3224812e-03
 -5.1238309e-05]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-2.4110090e-03  8.8019820e-04 -4.2190044e-03  1.5336568e-03
 -1.8470844e-05]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-2.4110090e-03  8.8019820e-04 -4.2190044e-03  1.5336568e-03
 -1.8470844e-05]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.21868086 -0.11006094 -0.08945952  0.5003914  -0.07679388]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.21868086 -0.11006094 -0.08945952  0.5003914  -0.07679388]
  [Layer 3] Output shape after mixer: (1, 1, 1024)
  [Layer 3] Output sample values after mixer: [-0.21868086 -0.11006094 -0.08945952  0.5003914  -0.07679388]
  [Layer 3] Residual connection shape: (1, 1, 1024)
  [Layer 3] Residual connection sample values: [-0.61133385 -0.8717049   0.8899695   0.91333807 -0.19578427]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.39193696 -0.48400906  0.46519443  0.62258077 -0.11810647]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.39193696 -0.48400906  0.46519443  0.62258077 -0.11810647]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.39193696 -0.48400906  0.46519443  0.62258077 -0.11810647]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.14509849  0.12643646  0.19783059 -0.28851822  0.8929016 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.14509849  0.12643646  0.19783059 -0.28851822  0.8929016 ]
  [FlaxMamba2] xBC (step) sample values: [-0.22336185  0.06742124 -0.21401267 -0.5467338   1.6086873 ]
  [FlaxMamba2] dt (step) sample values: [0.59594476 1.1688771  1.4058341  0.7956502  0.713745  ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.19602846 -0.53104764 -1.043289   -0.22336185  1.8550404 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.13339129  0.03741204  0.03330943 -0.5369163   0.21231766]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.15544024  0.04997002 -0.00709584 -0.6016136   0.47135085]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.08374841  0.02560913 -0.00353533 -0.21295594  0.29021233]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.08374841  0.02560913 -0.00353533 -0.21295594  0.29021233]
  [FlaxMamba2] B (step) sample values: [-0.27516803  0.07383829  0.03320419  0.00247875 -0.08015735]
  [FlaxMamba2] C (step) sample values: [-0.27071524 -0.2328501   0.33850503 -0.01699375  0.26388696]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.49070406 -0.5047996  -0.6491257  -0.5552266  -0.46572492]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08010222 0.17294545 0.30381858 0.08557354 0.5866477 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.961456   0.9163996  0.8210129  0.9535984  0.76092803]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.08374841  0.02560913 -0.00353533 -0.21295594  0.29021233]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.8459464e-03  4.9533922e-04  2.2274813e-04  1.6628499e-05
 -5.3773029e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.8459464e-03  4.9533922e-04  2.2274813e-04  1.6628499e-05
 -5.3773029e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.03308291 -0.00212771  0.00059075  0.00241146 -0.00116927]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.088717    0.01497339  0.01510939 -0.25411487  0.37545496]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.14427154  0.03196122  0.01276422 -0.39537928  0.5679674 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.14427154  0.03196122  0.01276422 -0.39537928  0.5679674 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [0.01122482 0.0021481  0.00138706 0.04886555 0.35980937]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.00629163 0.00129304 0.0006973  0.02705218 0.14504525]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.00629163 0.00129304 0.0006973  0.02705218 0.14504525]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.04201031  0.00214852  0.05071405  0.2055625  -0.08126763]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.04201031  0.00214852  0.05071405  0.2055625  -0.08126763]
  [Layer 4] Output shape after mixer: (1, 1, 1024)
  [Layer 4] Output sample values after mixer: [ 0.04201031  0.00214852  0.05071405  0.2055625  -0.08126763]
  [Layer 4] Residual connection shape: (1, 1, 1024)
  [Layer 4] Residual connection sample values: [-0.56932354 -0.86955637  0.9406836   1.1189005  -0.2770519 ]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.49392912 -0.6360127   0.60137004  0.9678632  -0.22802526]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.49392912 -0.6360127   0.60137004  0.9678632  -0.22802526]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.49392912 -0.6360127   0.60137004  0.9678632  -0.22802526]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.5084249   0.43652496 -3.8224454   1.3466648  -1.9396392 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.5084249   0.43652496 -3.8224454   1.3466648  -1.9396392 ]
  [FlaxMamba2] xBC (step) sample values: [-0.38902977  1.495196   -0.6021957   1.1398869   1.2343515 ]
  [FlaxMamba2] dt (step) sample values: [0.8079099 1.6372986 1.5226481 1.6416228 2.2250996]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.9133613  -0.01039147 -1.2361823  -0.38902977 -2.276117  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.63208866 -0.5727043  -0.3705183  -0.18166342 -0.28497618]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.69544315 -0.8140373  -0.37786922 -0.1547927  -0.27403563]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.23145969 -0.24993455 -0.1536571  -0.07141808 -0.11836054]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.23145969 -0.24993455 -0.1536571  -0.07141808 -0.11836054]
  [FlaxMamba2] B (step) sample values: [ 0.06902546  0.06735127 -0.17640787 -0.05081303  0.01932218]
  [FlaxMamba2] C (step) sample values: [-0.02240888  0.0294087  -0.27510047 -0.27333796  0.0271302 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.07591622 -0.53187454 -0.04695368 -1.4938657  -3.6258397 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.3239991  0.06997538 0.15866852 0.07053376 0.14093235]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.97570324 0.963466   0.9925776  0.8999933  0.5998965 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.23145969 -0.24993455 -0.1536571  -0.07141808 -0.11836054]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00517641 -0.00505086  0.01322931  0.00381061 -0.00144902]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00517641 -0.00505086  0.01322931  0.00381061 -0.00144902]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01687338 -0.00971705  0.5117085   0.04958223  0.00686124]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-1.6799842 -2.1425118 -1.3844706 -0.6084131 -0.6012449]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-2.0057156  -2.494243   -1.600711   -0.7089192  -0.76781285]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-2.0057156  -2.494243   -1.600711   -0.7089192  -0.76781285]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-2.4773397  -0.6613701   0.13097543 -0.75761586  0.18718386]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.10232056 -0.02886974  0.0117062  -0.07441553  0.01998458]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.10232056 -0.02886974  0.0117062  -0.07441553  0.01998458]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.19596545 -0.4585941   0.25038087  0.41817096  0.59070575]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.19596545 -0.4585941   0.25038087  0.41817096  0.59070575]
  [Layer 5] Output shape after mixer: (1, 1, 1024)
  [Layer 5] Output sample values after mixer: [-0.19596545 -0.4585941   0.25038087  0.41817096  0.59070575]
  [Layer 5] Residual connection shape: (1, 1, 1024)
  [Layer 5] Residual connection sample values: [-0.765289   -1.3281505   1.1910645   1.5370715   0.31365386]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.5182356  -0.7430022   0.6286982   0.9978746   0.18975818]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.5182356  -0.7430022   0.6286982   0.9978746   0.18975818]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.5182356  -0.7430022   0.6286982   0.9978746   0.18975818]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.62628806  1.4148246  -0.9885308  -1.3619472  -1.1807364 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.62628806  1.4148246  -0.9885308  -1.3619472  -1.1807364 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.8282191  -0.6492229  -0.73421425  1.4676198   0.29643685]
  [FlaxMamba2] dt (step) sample values: [1.1221328 1.2026155 2.0814607 1.0934173 1.4945028]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.06041868 -0.79676634  0.8933227   0.8282191   2.1113107 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.16117284 -0.09049163 -0.29035094 -0.08861729 -0.0577343 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.20841405 -0.07649932 -0.20911315 -0.10029789  0.0804493 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.09338705 -0.03678733 -0.09366416 -0.04763614  0.0418418 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09338705 -0.03678733 -0.09366416 -0.04763614  0.0418418 ]
  [FlaxMamba2] B (step) sample values: [ 0.12706876  0.05241451 -0.2772384  -0.04316566 -0.10098573]
  [FlaxMamba2] C (step) sample values: [ 0.05906562  0.0458993  -0.27390176  0.14334232 -0.03161304]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.5109995  -0.28622514 -0.5421001  -0.39544863 -0.5985869 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.40281802 0.34372455 0.51577044 0.36744    0.36795425]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8139635  0.9063021  0.7560867  0.8647597  0.80231607]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09338705 -0.03678733 -0.09366416 -0.04763614  0.0418418 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00478007 -0.00197173  0.01042915  0.00162381  0.00379888]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00478007 -0.00197173  0.01042915  0.00162381  0.00379888]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00851844 -0.00744362  0.01553269  0.00538861  0.00747411]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.03514712  0.00937196 -0.07161633 -0.0158607   0.15012754]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.14226674 -0.03282496 -0.17905381 -0.07050173  0.19812219]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.14226674 -0.03282496 -0.17905381 -0.07050173  0.19812219]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03103821 -0.03736343  0.04800288  0.01958071 -0.05495481]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01045487 -0.01204377  0.01471214  0.00738062 -0.01507512]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01045487 -0.01204377  0.01471214  0.00738062 -0.01507512]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.08832037  0.08637784  0.01828658  0.08135471  0.06355299]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.08832037  0.08637784  0.01828658  0.08135471  0.06355299]
  [Layer 6] Output shape after mixer: (1, 1, 1024)
  [Layer 6] Output sample values after mixer: [-0.08832037  0.08637784  0.01828658  0.08135471  0.06355299]
  [Layer 6] Residual connection shape: (1, 1, 1024)
  [Layer 6] Residual connection sample values: [-0.8536094  -1.2417727   1.2093511   1.6184262   0.37720686]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.5589694  -0.6604462   0.62461287  1.0697459   0.21420486]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.5589694  -0.6604462   0.62461287  1.0697459   0.21420486]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.5589694  -0.6604462   0.62461287  1.0697459   0.21420486]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.238763  -2.3889039 -1.6963867 -1.6090366 -1.1192576]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.238763  -2.3889039 -1.6963867 -1.6090366 -1.1192576]
  [FlaxMamba2] xBC (step) sample values: [-0.25964287 -1.3250881  -2.1674888  -0.4227852  -1.105892  ]
  [FlaxMamba2] dt (step) sample values: [0.27013054 3.2303007  4.7775836  0.9830241  0.11376294]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.35408875 -1.0369145  -2.6750462  -0.25964287 -1.305054  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.16101262 -0.26005095 -0.43641308 -0.05740972 -0.16588072]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.19464299 -0.33134001 -0.5673945  -0.04894109 -0.1686254 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.08787981 -0.13847184 -0.20530505 -0.02387186 -0.07722086]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08787981 -0.13847184 -0.20530505 -0.02387186 -0.07722086]
  [FlaxMamba2] B (step) sample values: [-0.09300269 -0.10916848  0.10247149  0.07446112 -0.092261  ]
  [FlaxMamba2] C (step) sample values: [ 0.01862496  0.13293098  0.01774938  0.01569872 -0.0545095 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-6.5957151e-02 -4.5478220e+00 -5.8281250e+00 -4.2033669e-01
 -1.9005252e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.6127362  0.61619455 1.685669   0.336165   0.21433023]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.6039140e-01 6.0667742e-02 5.4120945e-05 8.6822665e-01 9.9959272e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08787981 -0.13847184 -0.20530505 -0.02387186 -0.07722086]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00500793  0.00587841 -0.0055178  -0.00400952  0.00496799]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00500793  0.00587841 -0.0055178  -0.00400952  0.00496799]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.09611383  0.00786057 -0.0115915   0.01240235  0.05197492]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.19038025 -0.04625048 -0.24769604  0.17180946 -0.03052825]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.3941343  -0.3673049  -0.72370684  0.11646128 -0.20956895]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.3941343  -0.3673049  -0.72370684  0.11646128 -0.20956895]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.37855542  0.07372627  0.19021504 -0.03124219  0.05773711]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.11666472  0.02742156  0.0424201  -0.00843956  0.03413239]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.11666472  0.02742156  0.0424201  -0.00843956  0.03413239]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.6464073   0.09595503  0.27808082  0.33754504 -0.43256477]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.6464073   0.09595503  0.27808082  0.33754504 -0.43256477]
  [Layer 7] Output shape after mixer: (1, 1, 1024)
  [Layer 7] Output sample values after mixer: [ 0.6464073   0.09595503  0.27808082  0.33754504 -0.43256477]
  [Layer 7] Residual connection shape: (1, 1, 1024)
  [Layer 7] Residual connection sample values: [-0.20720208 -1.1458176   1.4874319   1.9559712  -0.0553579 ]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.13447042 -0.5566663   0.6752776   1.2363094  -0.03010685]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.13447042 -0.5566663   0.6752776   1.2363094  -0.03010685]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.13447042 -0.5566663   0.6752776   1.2363094  -0.03010685]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.6561676  -1.1551406  -0.6616194   0.99729985 -1.4270848 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.6561676  -1.1551406  -0.6616194   0.99729985 -1.4270848 ]
  [FlaxMamba2] xBC (step) sample values: [-2.0454454   0.5989972   0.76410973 -0.28364754 -0.48652253]
  [FlaxMamba2] dt (step) sample values: [2.775675  2.360514  2.8340268 1.7464354 1.9103167]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.9844451  0.5381477 -1.8329356 -2.0454454  1.816307 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-4.6534389e-01 -2.4706756e-01  2.5651804e-01 -2.0897608e-02
 -2.8536469e-04]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.5427365  -0.16601287  0.32286325 -0.11782144 -0.0628464 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.19948345 -0.07613215  0.18726774 -0.05544426 -0.03043611]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.19948345 -0.07613215  0.18726774 -0.05544426 -0.03043611]
  [FlaxMamba2] B (step) sample values: [ 0.05137223  0.04748233 -0.11452468 -0.00954378  0.01028319]
  [FlaxMamba2] C (step) sample values: [ 0.22039115  0.03124272  0.04138668  0.06673747 -0.08541687]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6851114  -0.13800453 -0.41180432 -0.26783535 -0.12443344]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.26625633 3.7028587  2.0202525  1.3314196  3.0571141 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8332553 0.5998886 0.4352004 0.7000516 0.683583 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.19948345 -0.07613215  0.18726774 -0.05544426 -0.03043611]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00272857 -0.00252196  0.00608283  0.00050691 -0.00054618]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00272857 -0.00252196  0.00608283  0.00050691 -0.00054618]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00586227 -0.02364619  0.00636265 -0.02336908  0.00599646]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.10849486 -0.02876217  0.06632102 -0.05051792 -0.00462987]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.85983205 -0.31550732  0.7716487  -0.25934392 -0.11926484]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.85983205 -0.31550732  0.7716487  -0.25934392 -0.11926484]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.22823878  0.08730577 -0.17377476 -0.18894628  0.03294297]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04948943  0.00999207 -0.06125367 -0.05672178  0.00678171]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04948943  0.00999207 -0.06125367 -0.05672178  0.00678171]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.11505396  0.31431693  0.16158292 -0.13352273  0.2514207 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.11505396  0.31431693  0.16158292 -0.13352273  0.2514207 ]
  [Layer 8] Output shape after mixer: (1, 1, 1024)
  [Layer 8] Output sample values after mixer: [ 0.11505396  0.31431693  0.16158292 -0.13352273  0.2514207 ]
  [Layer 8] Residual connection shape: (1, 1, 1024)
  [Layer 8] Residual connection sample values: [-0.09214812 -0.8315007   1.6490148   1.8224485   0.1960628 ]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.05230694 -0.36476734  0.6925949   1.0372398   0.09693838]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05230694 -0.36476734  0.6925949   1.0372398   0.09693838]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05230694 -0.36476734  0.6925949   1.0372398   0.09693838]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.02137564 -1.1290476  -3.578117   -1.2039549  -0.59859145]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.02137564 -1.1290476  -3.578117   -1.2039549  -0.59859145]
  [FlaxMamba2] xBC (step) sample values: [-0.7172392  -0.4369099  -0.747902   -0.92009497 -0.38218513]
  [FlaxMamba2] dt (step) sample values: [3.0659776 5.3774414 2.669564  3.282275  2.9181912]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 3.729537    1.9979417   2.839903   -0.7172392  -0.99142414]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.9143246  -0.40142268 -0.02963729 -0.42525402 -0.03302934]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-1.1677425  -0.31090754 -0.03380294 -0.4185287  -0.05169084]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.2770624  -0.1314807  -0.01661584 -0.16610102 -0.02517758]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.2770624  -0.1314807  -0.01661584 -0.16610102 -0.02517758]
  [FlaxMamba2] B (step) sample values: [ 0.03877022 -0.02735646  0.20831183 -0.12230454  0.2819168 ]
  [FlaxMamba2] C (step) sample values: [-0.02587647 -0.2768062  -0.138006   -0.1322926  -0.09804504]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17008033 -0.11351943 -0.10539922 -0.5864362  -0.14965628]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [3.5132234 6.1851673 4.469173  1.9486629 3.1548855]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.55016875 0.4955254  0.62434804 0.31893548 0.6236609 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.2770624  -0.1314807  -0.01661584 -0.16610102 -0.02517758]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.03773823  0.02662829 -0.202767    0.11904905 -0.27441275]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.03773823  0.02662829 -0.202767    0.11904905 -0.27441275]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01783206  0.0406092  -0.39877686  0.25955403 -0.4425237 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.4671379   0.00234763 -0.04153237 -0.08957241  0.01003576]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-1.2095178  -0.3499508  -0.08605398 -0.5346349  -0.05742678]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-1.2095178  -0.3499508  -0.08605398 -0.5346349  -0.05742678]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01306527  0.09654023  0.00836578  0.14854273  0.01219171]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00136767  0.01883614  0.00109146  0.02223095  0.00183179]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00136767  0.01883614  0.00109146  0.02223095  0.00183179]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.07399144 -0.0758795   0.06373954  0.02514959 -0.4212412 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.07399144 -0.0758795   0.06373954  0.02514959 -0.4212412 ]
  [Layer 9] Output shape after mixer: (1, 1, 1024)
  [Layer 9] Output sample values after mixer: [ 0.07399144 -0.0758795   0.06373954  0.02514959 -0.4212412 ]
  [Layer 9] Residual connection shape: (1, 1, 1024)
  [Layer 9] Residual connection sample values: [-0.01815668 -0.9073802   1.7127544   1.8475981  -0.22517839]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.01028032 -0.3925009   0.7231233   1.0290297  -0.10793959]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.01028032 -0.3925009   0.7231233   1.0290297  -0.10793959]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.01028032 -0.3925009   0.7231233   1.0290297  -0.10793959]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.6643876   0.28266975  1.1303657  -1.5836928   0.5300492 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.6643876   0.28266975  1.1303657  -1.5836928   0.5300492 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.5411758   0.49698362 -0.72804     2.9034164   0.65840393]
  [FlaxMamba2] dt (step) sample values: [ 0.66361415  1.3954124   0.7478674  -0.09096936  0.24900678]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.16141228  1.1222445  -1.1175879   1.5411758  -1.8032408 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.48964918  0.01165016  0.32341877  0.65067196 -0.09463763]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.65993726 -0.01229088  0.2854549   1.2546759  -0.04574847]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.22487606 -0.00610767  0.16296136  0.97627366 -0.0223511 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.22487606 -0.00610767  0.16296136  0.97627366 -0.0223511 ]
  [FlaxMamba2] B (step) sample values: [ 0.03170472 -0.11640672 -0.00385771 -0.143445    0.07188933]
  [FlaxMamba2] C (step) sample values: [-0.27262512 -0.26170993 -0.17544033 -0.16858126 -0.1249544 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.08535489 -0.07711172 -0.08452541 -0.0546804  -0.06966463]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.9040216  0.32960787 0.18262789 1.3195853  0.68040365]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.85000116 0.97490364 0.98468184 0.93038625 0.9537058 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.22487606 -0.00610767  0.16296136  0.97627366 -0.0223511 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01357497  0.04984174  0.00165175  0.06141869 -0.03078078]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01357497  0.04984174  0.00165175  0.06141869 -0.03078078]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01810846 -0.50577307 -0.05348734  0.2969509   0.10675107]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-1.2232959   0.5380804   0.31437257  8.37801    -0.3490762 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-2.3182497   0.50834125  1.1078547  13.131626   -0.4579069 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-2.3182497   0.50834125  1.1078547  13.131626   -0.4579069 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.6141671   0.08193366  0.94660723 -3.5410786  -0.15278663]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02016455  0.0057506   0.07285853 -0.20962518 -0.01096447]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02016455  0.0057506   0.07285853 -0.20962518 -0.01096447]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.00214757 -0.08342118  0.10582009 -0.01842724  0.07449464]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.00214757 -0.08342118  0.10582009 -0.01842724  0.07449464]
  [Layer 10] Output shape after mixer: (1, 1, 1024)
  [Layer 10] Output sample values after mixer: [-0.00214757 -0.08342118  0.10582009 -0.01842724  0.07449464]
  [Layer 10] Residual connection shape: (1, 1, 1024)
  [Layer 10] Residual connection sample values: [-0.02030425 -0.9908014   1.8185744   1.8291708  -0.15068375]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.00792172 -0.31364068  0.5584041   0.7792761  -0.05203201]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.00792172 -0.31364068  0.5584041   0.7792761  -0.05203201]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.00792172 -0.31364068  0.5584041   0.7792761  -0.05203201]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.6190133  -1.5695472  -3.2541595   1.0298532   0.19587092]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.6190133  -1.5695472  -3.2541595   1.0298532   0.19587092]
  [FlaxMamba2] xBC (step) sample values: [ 0.05245996 -1.1465105  -2.9368336  -1.1261274  -1.2691685 ]
  [FlaxMamba2] dt (step) sample values: [-1.8025762 -0.3975191 -1.0104824  2.1802197  2.0724416]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.5224556  -0.6484644   0.20363046  0.05245996  0.94138616]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02739686  0.18667653  0.8037581   0.16964303 -0.5641822 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.11908752  0.37783864  0.82768387  0.27706492 -0.449192  ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.06308503  0.22419119  0.5759562   0.15760186 -0.17498404]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06308503  0.22419119  0.5759562   0.15760186 -0.17498404]
  [FlaxMamba2] B (step) sample values: [-0.26694673  0.20047389 -0.0734238  -0.01814726 -0.02811429]
  [FlaxMamba2] C (step) sample values: [-0.15669873 -0.23558088  0.02346053 -0.02666937 -0.27160904]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.25934154 -0.12614636 -0.10356269 -0.23775288 -0.43051487]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03714647 0.04789474 0.05783922 2.081414   2.2394516 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99041265 0.9939765  0.9940279  0.6096549  0.38131967]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06308503  0.22419119  0.5759562   0.15760186 -0.17498404]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.2555936e-04  4.6978780e-04 -1.7206035e-04 -4.2526051e-05
 -6.5882647e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.2555936e-04  4.6978780e-04 -1.7206035e-04 -4.2526051e-05
 -6.5882647e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.18192703  0.01210648  0.0199017  -0.07868944  0.1048841 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [0.5254287  0.51816195 0.5188731  0.28303668 0.7580326 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.32644942 -0.18896937 -1.2977759  -0.2140623   1.3099575 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.32644942 -0.18896937 -1.2977759  -0.2140623   1.3099575 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.44113898  0.0510979   0.15700778 -0.16244887  0.14081554]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02517879  0.02159471  0.11903763 -0.02315111  0.02342394]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02517879  0.02159471  0.11903763 -0.02315111  0.02342394]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.07870259 -0.09276449  0.0182635  -0.22856277  0.17850177]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.07870259 -0.09276449  0.0182635  -0.22856277  0.17850177]
  [Layer 11] Output shape after mixer: (1, 1, 1024)
  [Layer 11] Output sample values after mixer: [ 0.07870259 -0.09276449  0.0182635  -0.22856277  0.17850177]
  [Layer 11] Residual connection shape: (1, 1, 1024)
  [Layer 11] Residual connection sample values: [ 0.05839834 -1.0835658   1.8368379   1.6006081   0.02781802]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.01876468 -0.27737224  0.4299637   0.58325136  0.00756339]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.01876468 -0.27737224  0.4299637   0.58325136  0.00756339]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.01876468 -0.27737224  0.4299637   0.58325136  0.00756339]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.0514032  -1.7138741   3.778065   -0.49732682  1.5054822 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.0514032  -1.7138741   3.778065   -0.49732682  1.5054822 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.2160035  1.1990644 -1.9252985  1.9177411 -1.6276064]
  [FlaxMamba2] dt (step) sample values: [0.5775588  0.6363176  1.4417986  0.39623153 0.46415696]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.45501     0.28649288 -0.16463476  1.2160035   3.5917914 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00572579 -0.9176942   0.2795509   0.27942047  0.6701859 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.06147391 -1.7521669   0.21479261  0.2352005   0.50355995]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.0297925  -0.25892487  0.11888614  0.13136666  0.31386667]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0297925  -0.25892487  0.11888614  0.13136666  0.31386667]
  [FlaxMamba2] B (step) sample values: [ 0.29175052  0.14596865  0.12319156  0.5526766  -0.06035267]
  [FlaxMamba2] C (step) sample values: [-0.09761936 -0.27846432 -0.2784357  -0.2564791  -0.27083808]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.16087165 -0.14748003 -0.27125728 -0.11553253 -0.09015273]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.3877165  0.9025224  2.294629   1.895883   0.10885718]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7999194  0.875374   0.53663623 0.80329263 0.99023426]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0297925  -0.25892487  0.11888614  0.13136666  0.31386667]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.012062   -0.00603486 -0.00509317 -0.02284961  0.00249519]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.012062   -0.00603486 -0.00509317 -0.02284961  0.00249519]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.03247987  0.01321642  0.01796219 -0.12968285 -0.01564841]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.06376842 -0.6190124   0.11086832  0.17841975  0.5745536 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.11211751 -1.0392115   0.303804    0.3916096   1.0839157 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.11211751 -1.0392115   0.303804    0.3916096   1.0839157 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03052589  0.2719027   1.1221317  -0.07365144  1.3354629 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0078427   0.04081742  0.32985404 -0.0408648   0.2951953 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0078427   0.04081742  0.32985404 -0.0408648   0.2951953 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.24920511  0.57726157  0.43373653 -0.7614685  -0.46700948]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.24920511  0.57726157  0.43373653 -0.7614685  -0.46700948]
  [Layer 12] Output shape after mixer: (1, 1, 1024)
  [Layer 12] Output sample values after mixer: [ 0.24920511  0.57726157  0.43373653 -0.7614685  -0.46700948]
  [Layer 12] Residual connection shape: (1, 1, 1024)
  [Layer 12] Residual connection sample values: [ 0.30760345 -0.50630426  2.2705743   0.8391396  -0.43919146]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.07944892 -0.10678966  0.45586452  0.23318206 -0.1017542 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.07944892 -0.10678966  0.45586452  0.23318206 -0.1017542 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.07944892 -0.10678966  0.45586452  0.23318206 -0.1017542 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.9305926 -0.5560191 -1.024068   1.202236   1.4219551]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.9305926 -0.5560191 -1.024068   1.202236   1.4219551]
  [FlaxMamba2] xBC (step) sample values: [-0.9277646   0.4060056  -0.11110289 -0.05631452  0.61196166]
  [FlaxMamba2] dt (step) sample values: [ 1.1958275  -0.36800405  0.323565   -0.10399838 -0.10458036]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.96905917 -0.8990746  -0.11584947 -0.9277646   0.7766244 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03270891 -0.08618103 -0.03555053 -0.00934642  0.18895346]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.09478167 -0.10484253 -0.02766936 -0.02105754  0.15851218]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.04514663 -0.04967579 -0.0136433  -0.01041792  0.08552449]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04514663 -0.04967579 -0.0136433  -0.01041792  0.08552449]
  [FlaxMamba2] B (step) sample values: [ 0.13536608 -0.08536653  0.00374192 -0.03993132 -0.1097616 ]
  [FlaxMamba2] C (step) sample values: [-0.16505955 -0.2586975  -0.05088565  0.28467602 -0.05724675]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.02338035 -1.090337   -0.5085105  -0.67845345 -0.02513249]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.16410197 0.00694914 0.01174845 0.00473648 0.13831186]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9961706  0.9924517  0.9940436  0.99679166 0.99652994]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04514663 -0.04967579 -0.0136433  -0.01041792  0.08552449]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0028799e-03  6.3245074e-04 -2.7722541e-05  2.9583718e-04
  8.1318530e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0028799e-03  6.3245074e-04 -2.7722541e-05  2.9583718e-04
  8.1318530e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.07835101  0.09302142 -0.27486962  0.01991127 -0.0637389 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01192829 -0.21000496  0.13591139 -0.01936436  0.03950023]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01714288 -0.20426723  0.13748723 -0.01816105  0.02962187]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01714288 -0.20426723  0.13748723 -0.01816105  0.02962187]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01144144  0.04139512 -0.03720341 -0.01678855  0.03393453]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0055119   0.01319436 -0.04017334 -0.04280974  0.01878338]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0055119   0.01319436 -0.04017334 -0.04280974  0.01878338]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.18066405  0.04682998  0.26788017 -0.3425721  -0.14788923]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.18066405  0.04682998  0.26788017 -0.3425721  -0.14788923]
  [Layer 13] Output shape after mixer: (1, 1, 1024)
  [Layer 13] Output sample values after mixer: [-0.18066405  0.04682998  0.26788017 -0.3425721  -0.14788923]
  [Layer 13] Residual connection shape: (1, 1, 1024)
  [Layer 13] Residual connection sample values: [ 0.1269394 -0.4594743  2.5384545  0.4965675 -0.5870807]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.02732371 -0.0853829   0.4613254   0.12094726 -0.11838179]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.02732371 -0.0853829   0.4613254   0.12094726 -0.11838179]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.02732371 -0.0853829   0.4613254   0.12094726 -0.11838179]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.06802123 -0.13753669  0.3618982   0.33652157  0.45693165]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.06802123 -0.13753669  0.3618982   0.33652157  0.45693165]
  [FlaxMamba2] xBC (step) sample values: [-0.86091554 -0.40401217 -0.6572206  -1.0921645   0.3122022 ]
  [FlaxMamba2] dt (step) sample values: [2.4484642  0.417606   1.7241582  0.83878523 1.7146647 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.95331764  0.4262729   0.50619423 -0.86091554 -0.77537024]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.18432766 -0.31980985 -0.44050682  0.2866118  -0.08484638]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.25476223 -0.3692178  -0.6322793   0.23900437 -0.09862507]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.14351986 -0.15091042 -0.21939705  0.13371536 -0.04688278]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.14351986 -0.15091042 -0.21939705  0.13371536 -0.04688278]
  [FlaxMamba2] B (step) sample values: [-0.03371074  0.05217455  0.03078824  0.01220762 -0.03005449]
  [FlaxMamba2] C (step) sample values: [-0.09782918  0.02349147  0.01598364 -0.12309209 -0.01990791]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-7.2744994  -0.03854768 -2.202407   -0.01377147 -5.3377523 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.21522376 0.08924149 0.06420862 0.11187956 0.08727718]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.20895317 0.9965659  0.86813027 0.9984604  0.6275927 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.14351986 -0.15091042 -0.21939705  0.13371536 -0.04688278]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00104129  0.00161161  0.00095101  0.00037708 -0.00092835]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00104129  0.00161161  0.00095101  0.00037708 -0.00092835]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00104923  0.00162009  0.00093957  0.00041508 -0.00093212]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.04767258 -0.05354351 -0.07704405  0.04539767 -0.01717228]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.1606225  -0.1723098  -0.24970922  0.15063146 -0.05406895]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.1606225  -0.1723098  -0.24970922  0.15063146 -0.05406895]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00564859  0.01103587 -0.05327271  0.0295702  -0.01512703]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01766702  0.02405018 -0.0796519   0.0640201  -0.04162878]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01766702  0.02405018 -0.0796519   0.0640201  -0.04162878]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.3218944   0.78249454  1.1353606  -0.07903104  0.30303216]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.3218944   0.78249454  1.1353606  -0.07903104  0.30303216]
  [Layer 14] Output shape after mixer: (1, 1, 1024)
  [Layer 14] Output sample values after mixer: [ 0.3218944   0.78249454  1.1353606  -0.07903104  0.30303216]
  [Layer 14] Residual connection shape: (1, 1, 1024)
  [Layer 14] Residual connection sample values: [ 0.44883382  0.32302025  3.6738153   0.41753644 -0.28404856]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.10690888  0.06329418  0.7226747   0.11789219 -0.06315132]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.10690888  0.06329418  0.7226747   0.11789219 -0.06315132]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.10690888  0.06329418  0.7226747   0.11789219 -0.06315132]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.0157285   0.6042754   0.7043889   0.16621386 -3.7679272 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.0157285   0.6042754   0.7043889   0.16621386 -3.7679272 ]
  [FlaxMamba2] xBC (step) sample values: [-0.43446398  0.79428136  1.6370553  -1.5807195  -1.8675525 ]
  [FlaxMamba2] dt (step) sample values: [ 2.7179387   0.6072476   0.66299576 -0.95227957  0.4834608 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.548849    0.15227515  1.0156238  -0.43446398 -0.18793046]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04511986 -0.16675875  0.15090576 -0.325118    0.26705754]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.2910618  -0.19094393  1.476101    0.11750895  0.25356877]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.12449992 -0.08638467  1.2015212   0.0622026   0.14277308]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.12449992 -0.08638467  1.2015212   0.0622026   0.14277308]
  [FlaxMamba2] B (step) sample values: [-0.0446644   0.04208909  0.00272784 -0.01287494 -0.03729632]
  [FlaxMamba2] C (step) sample values: [-0.03795108  0.09045354  0.10701771 -0.07140944 -0.04370486]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.4414158  -0.05923919 -0.7389757  -0.00508607 -0.00871955]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.6782064  0.719522   0.04206014 0.01895517 0.21728173]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.19094235 0.95827174 0.96939665 0.9999036  0.9981072 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.12449992 -0.08638467  1.2015212   0.0622026   0.14277308]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00377131 -0.00355386 -0.00023033  0.00108712  0.00314918]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00377131 -0.00355386 -0.00023033  0.00108712  0.00314918]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 4.7471859e-03 -2.5845924e-03 -4.1108462e-05  1.7958952e-03
  4.6602078e-03]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00140623 -0.00100435  0.01341392  0.00072029  0.00139957]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.22373837 -0.15527023  2.1590922   0.11180178  0.25636396]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.22373837 -0.15527023  2.1590922   0.11180178  0.25636396]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.06041873 -0.06067105  1.0176859   0.01006192 -0.02180979]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.06994087 -0.05126199  0.25272378  0.00656535 -0.02576049]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.06994087 -0.05126199  0.25272378  0.00656535 -0.02576049]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.4470255  -0.25764498  0.71393365 -0.5106219   0.08055922]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.4470255  -0.25764498  0.71393365 -0.5106219   0.08055922]
  [Layer 15] Output shape after mixer: (1, 1, 1024)
  [Layer 15] Output sample values after mixer: [-0.4470255  -0.25764498  0.71393365 -0.5106219   0.08055922]
  [Layer 15] Residual connection shape: (1, 1, 1024)
  [Layer 15] Residual connection sample values: [ 1.8083155e-03  6.5375268e-02  4.3877487e+00 -9.3085468e-02
 -2.0348933e-01]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 2.8995753e-04  8.6628366e-03  5.4184490e-01 -1.8937960e-02
 -3.0846534e-02]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 2.8995753e-04  8.6628366e-03  5.4184490e-01 -1.8937960e-02
 -3.0846534e-02]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 2.8995753e-04  8.6628366e-03  5.4184490e-01 -1.8937960e-02
 -3.0846534e-02]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.9751223 -0.8460454 -4.089084  -1.2521002 -1.2377323]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.9751223 -0.8460454 -4.089084  -1.2521002 -1.2377323]
  [FlaxMamba2] xBC (step) sample values: [-2.4088502   0.7910334  -0.37716857  1.2015431  -0.6355234 ]
  [FlaxMamba2] dt (step) sample values: [ 4.8675947  -0.93995667  2.2571328   2.5799766   0.4899879 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 2.1004107  -0.18268262  0.42665908 -2.4088502   0.07986379]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.03998538 -0.13358393 -0.03754852  0.08893331  0.1468628 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03816196 -0.12477961  0.09917022  0.05075582  0.15439302]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.01944502 -0.05850236  0.05204178  0.02602181  0.083144  ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01944502 -0.05850236  0.05204178  0.02602181  0.083144  ]
  [FlaxMamba2] B (step) sample values: [ 0.05821776  0.01471151 -0.0223004  -0.03664253  0.04811618]
  [FlaxMamba2] C (step) sample values: [-0.04345115 -0.10667433  0.19171925 -0.15193443 -0.11592049]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.1348554e-03 -3.0370306e-03 -2.7156286e+00 -4.1511287e-03
 -4.2925543e-01]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [2.4714622e+00 2.6388668e-02 2.0560369e-01 3.0853754e-01 1.8363177e-03]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9971992  0.99991983 0.5721562  0.99872005 0.9992121 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01944502 -0.05850236  0.05204178  0.02602181  0.083144  ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00279781  0.000707   -0.0010717  -0.00176095  0.00231235]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00279781  0.000707   -0.0010717  -0.00176095  0.00231235]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.03668797  0.09454955  0.03173532  0.00137782 -0.00044463]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.02459534 -0.01698632 -0.12560244 -0.06096067  0.04690599]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02006978 -0.00337072 -0.13771443 -0.06701688  0.02755539]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02006978 -0.00337072 -0.13771443 -0.06701688  0.02755539]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03481051  0.00085629  0.00927946  0.01865669 -0.00766813]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03420008  0.00047895  0.02089337  0.00731242 -0.00891791]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03420008  0.00047895  0.02089337  0.00731242 -0.00891791]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.22574086  0.22907963 -0.08194318  0.03816811 -0.07935564]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.22574086  0.22907963 -0.08194318  0.03816811 -0.07935564]
  [Layer 16] Output shape after mixer: (1, 1, 1024)
  [Layer 16] Output sample values after mixer: [-0.22574086  0.22907963 -0.08194318  0.03816811 -0.07935564]
  [Layer 16] Residual connection shape: (1, 1, 1024)
  [Layer 16] Residual connection sample values: [-0.22393255  0.2944549   4.3058057  -0.05491735 -0.28284496]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.0486332   0.05502488  0.80395114 -0.01366886 -0.0565863 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0486332   0.05502488  0.80395114 -0.01366886 -0.0565863 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0486332   0.05502488  0.80395114 -0.01366886 -0.0565863 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.131124  -3.0283823 -0.4709294 -0.5652038 -2.2665694]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-2.131124  -3.0283823 -0.4709294 -0.5652038 -2.2665694]
  [FlaxMamba2] xBC (step) sample values: [ 0.20830995  0.76621085 -0.8545602  -0.1899416  -2.272927  ]
  [FlaxMamba2] dt (step) sample values: [2.4981947 1.9608376 1.7559661 2.0114188 2.511369 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.33920607 -0.16899     0.6221373   0.20830995  0.20555189]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02390721  0.12851007 -0.17821985 -0.03890104 -0.5696659 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.11893895  0.15063532 -0.29266077 -0.00447721 -0.47445107]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.05593701  0.0809797  -0.12506934 -0.00223359 -0.18198201]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05593701  0.0809797  -0.12506934 -0.00223359 -0.18198201]
  [FlaxMamba2] B (step) sample values: [ 0.02262497  0.12460236 -0.23644315 -0.09138416 -0.10675126]
  [FlaxMamba2] C (step) sample values: [-0.04828003 -0.00327358 -0.24637686 -0.1235574   0.07589381]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.3863302  -0.87734115 -1.4026718  -0.6827737  -0.39046   ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.0360707  0.4792226  0.59022456 1.1413147  1.7279518 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.23779741 0.65675664 0.43696973 0.4587455  0.5093112 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05593701  0.0809797  -0.12506934 -0.00223359 -0.18198201]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00131122 -0.00722129  0.01370299  0.00529614  0.00618674]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00131122 -0.00722129  0.01370299  0.00529614  0.00618674]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00117693 -0.0173434   0.02533177  0.01118259  0.01486528]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0496716   0.03315323 -0.06465331  0.00389347 -0.10667917]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.19700179  0.24644232 -0.39406824 -0.0019895  -0.585994  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.19700179  0.24644232 -0.39406824 -0.0019895  -0.585994  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.04454802 -0.0344502   0.07133562  0.00040745  0.12475716]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02543015 -0.02006918  0.04371635  0.0003074   0.08678617]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02543015 -0.02006918  0.04371635  0.0003074   0.08678617]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.14590806  0.40476963 -0.38850608 -0.7457789  -0.9073944 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.14590806  0.40476963 -0.38850608 -0.7457789  -0.9073944 ]
  [Layer 17] Output shape after mixer: (1, 1, 1024)
  [Layer 17] Output sample values after mixer: [-0.14590806  0.40476963 -0.38850608 -0.7457789  -0.9073944 ]
  [Layer 17] Residual connection shape: (1, 1, 1024)
  [Layer 17] Residual connection sample values: [-0.36984062  0.69922453  3.9172995  -0.80069625 -1.1902394 ]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.05348716  0.08743442  0.48263034 -0.14072606 -0.15233731]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05348716  0.08743442  0.48263034 -0.14072606 -0.15233731]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.05348716  0.08743442  0.48263034 -0.14072606 -0.15233731]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.0144915e-03 -1.8152614e-01 -1.6294521e+00 -5.3201669e-01
 -1.1728570e+00]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.0144915e-03 -1.8152614e-01 -1.6294521e+00 -5.3201669e-01
 -1.1728570e+00]
  [FlaxMamba2] xBC (step) sample values: [-0.31026247 -1.4707968   0.23430596  0.82651937 -0.26335186]
  [FlaxMamba2] dt (step) sample values: [-1.4929639  5.1258326  5.438853   3.7004964  2.620268 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.22164887 -0.6630224  -0.8443349  -0.31026247  1.0388703 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.09074181  0.5702465  -0.05046587  0.12664689 -0.21485616]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.10009545  0.1722973  -0.03922015  0.15719499 -0.26710224]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.05255041  0.09355193 -0.01922557  0.08476236 -0.1158205 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05255041  0.09355193 -0.01922557  0.08476236 -0.1158205 ]
  [FlaxMamba2] B (step) sample values: [ 0.02585956  0.08456891 -0.04169154 -0.17595534  0.07712927]
  [FlaxMamba2] C (step) sample values: [-0.03273282  0.03446291 -0.14606449 -0.08619547  0.05774748]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.3194940e-03 -6.5335674e+00 -1.4897179e+01 -1.3796333e-03
 -2.0873186e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03113235 6.2391143  6.886164   1.7393425  1.104723  ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.9992782e-01 1.9795230e-18 0.0000000e+00 9.9760324e-01 9.9769676e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05255041  0.09355193 -0.01922557  0.08476236 -0.1158205 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.2306707e-05  1.3835625e-04 -6.8208101e-05 -2.8786607e-04
  1.2618487e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.2306707e-05  1.3835625e-04 -6.8208101e-05 -2.8786607e-04
  1.2618487e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00420605 -0.0012587   0.09464078 -0.05744353  0.01697304]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.11681893 -1.1523305   0.14134483 -0.03500343 -0.16605622]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.12097929 -1.1597369   0.1428669  -0.04171399 -0.15688682]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.12097929 -1.1597369   0.1428669  -0.04171399 -0.15688682]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 6.1335108e-05  9.5733590e-02 -3.8156327e-02  8.2122739e-03
  4.3487739e-02]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 7.9978556e-05  3.0565757e-02 -1.0971168e-02  5.4983767e-03
  1.3682695e-02]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 7.9978556e-05  3.0565757e-02 -1.0971168e-02  5.4983767e-03
  1.3682695e-02]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.45586768  0.02125224 -0.04870668  0.1790116   0.3580986 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.45586768  0.02125224 -0.04870668  0.1790116   0.3580986 ]
  [Layer 18] Output shape after mixer: (1, 1, 1024)
  [Layer 18] Output sample values after mixer: [-0.45586768  0.02125224 -0.04870668  0.1790116   0.3580986 ]
  [Layer 18] Residual connection shape: (1, 1, 1024)
  [Layer 18] Residual connection sample values: [-0.82570827  0.72047675  3.8685927  -0.6216847  -0.8321408 ]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.13087799  0.09483796  0.5147557  -0.12186287 -0.11709825]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.13087799  0.09483796  0.5147557  -0.12186287 -0.11709825]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.13087799  0.09483796  0.5147557  -0.12186287 -0.11709825]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.42661962 -1.8543261  -1.1682155  -1.7695948   0.7660372 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.42661962 -1.8543261  -1.1682155  -1.7695948   0.7660372 ]
  [FlaxMamba2] xBC (step) sample values: [-1.3605541  -0.5226657  -0.7336691  -0.48018625 -1.2972633 ]
  [FlaxMamba2] dt (step) sample values: [1.9208039 1.7853237 1.2631603 2.2323606 0.9249956]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.58679503 -2.6270058  -0.65265405 -1.3605541   0.8875692 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02859366 -0.09045933 -0.15880942  0.11015375 -0.2325937 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.08001578 -0.08995818 -0.17260337 -0.09748785 -0.2337858 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.03840811 -0.04295733 -0.07887214 -0.04636984 -0.10329084]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03840811 -0.04295733 -0.07887214 -0.04636984 -0.10329084]
  [FlaxMamba2] B (step) sample values: [ 0.06508114 -0.02067448 -0.24625899  0.17233458 -0.07685876]
  [FlaxMamba2] C (step) sample values: [-0.11441091 -0.06806047 -0.09991562  0.0525388  -0.04574799]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17394373 -1.5063176  -1.5724528  -0.19826236 -0.07681109]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [2.9325662  1.0813625  0.8411124  3.417086   0.74737185]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.60043466 0.19615005 0.2664391  0.5078955  0.94421023]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03840811 -0.04295733 -0.07887214 -0.04636984 -0.10329084]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00733037  0.00232866  0.02773722 -0.01941079  0.00865693]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00733037  0.00232866  0.02773722 -0.01941079  0.00865693]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01314791 -0.00907491  0.08562851 -0.08140044 -0.19689018]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.33749732  0.2513087  -0.15796873 -0.4472577  -0.21118338]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.3959806   0.18589842 -0.2780658  -0.5178641  -0.36846232]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.3959806   0.18589842 -0.2780658  -0.5178641  -0.36846232]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0667174  -0.04666279  0.07704499  0.13342258 -0.19268566]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0203201  -0.02457083  0.04830569  0.03444749 -0.18406354]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0203201  -0.02457083  0.04830569  0.03444749 -0.18406354]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.01817456  0.73872614 -0.14066201  0.29621345  0.22113734]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.01817456  0.73872614 -0.14066201  0.29621345  0.22113734]
  [Layer 19] Output shape after mixer: (1, 1, 1024)
  [Layer 19] Output sample values after mixer: [-0.01817456  0.73872614 -0.14066201  0.29621345  0.22113734]
  [Layer 19] Residual connection shape: (1, 1, 1024)
  [Layer 19] Residual connection sample values: [-0.8438828   1.4592029   3.7279308  -0.32547122 -0.61100346]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.07983186  0.12634774  0.32302308 -0.03767724 -0.05646244]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.07983186  0.12634774  0.32302308 -0.03767724 -0.05646244]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.07983186  0.12634774  0.32302308 -0.03767724 -0.05646244]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.7374213   0.03600847  0.4386135   0.24086304  0.56121856]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.7374213   0.03600847  0.4386135   0.24086304  0.56121856]
  [FlaxMamba2] xBC (step) sample values: [ 0.19904317 -0.86737114 -0.8127291   0.45868546 -0.16925438]
  [FlaxMamba2] dt (step) sample values: [1.5117787  1.4933497  0.49481168 0.7627384  1.5246742 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.3090722  -0.03154976  0.03043384  0.19904317 -1.4873462 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04359455  0.21244341 -0.2845362   0.13071986 -0.23971839]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.02909107  0.17426592 -0.46410164  0.10967799 -0.28622717]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.01475709  0.09470595 -0.17914937  0.05784329 -0.12277077]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01475709  0.09470595 -0.17914937  0.05784329 -0.12277077]
  [FlaxMamba2] B (step) sample values: [ 0.02089502  0.02309459  0.04391693 -0.00629238 -0.01175965]
  [FlaxMamba2] C (step) sample values: [-0.07445382 -0.07410897 -0.15032935 -0.08175433 -0.02995612]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-3.08577806e-01 -2.93056536e+00 -5.29621363e+00 -1.23260975e+01
 -8.15932546e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03176287 0.11190788 0.09571355 0.1569368  0.18059255]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99024653 0.72039664 0.6023483  0.14450832 0.9985276 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01475709  0.09470595 -0.17914937  0.05784329 -0.12277077]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.79407650e-06  1.08250715e-05  2.05850793e-05 -2.94941401e-06
 -5.51207449e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.79407650e-06  1.08250715e-05  2.05850793e-05 -2.94941401e-06
 -5.51207449e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.0932282e-04 -2.3268936e-04 -1.7057537e-04  9.4122086e-05
 -5.2302181e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00052211  0.00057897  0.0002332  -0.00019936  0.00044386]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01161527  0.07847248 -0.14711311  0.04737544 -0.10053232]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01161527  0.07847248 -0.14711311  0.04737544 -0.10053232]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00277148  0.00143827 -0.03922708  0.00638932 -0.03592495]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02534113  0.01132497 -0.21263096  0.05687166 -0.20895225]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02534113  0.01132497 -0.21263096  0.05687166 -0.20895225]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.51743364 -0.9772933  -0.23338859 -0.20993824  0.37034926]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.51743364 -0.9772933  -0.23338859 -0.20993824  0.37034926]
  [Layer 20] Output shape after mixer: (1, 1, 1024)
  [Layer 20] Output sample values after mixer: [-0.51743364 -0.9772933  -0.23338859 -0.20993824  0.37034926]
  [Layer 20] Residual connection shape: (1, 1, 1024)
  [Layer 20] Residual connection sample values: [-1.3613164   0.48190957  3.4945421  -0.53540945 -0.2406542 ]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.1552573   0.04973086  0.36947736 -0.07221377 -0.02638573]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1552573   0.04973086  0.36947736 -0.07221377 -0.02638573]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1552573   0.04973086  0.36947736 -0.07221377 -0.02638573]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.09939185 -1.2661175  -0.8269414  -0.5794286   0.22814012]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.09939185 -1.2661175  -0.8269414  -0.5794286   0.22814012]
  [FlaxMamba2] xBC (step) sample values: [-1.2506956e+00  2.8186193e-01  5.0316733e-01 -5.1375303e-02
  9.2445995e-04]
  [FlaxMamba2] dt (step) sample values: [ 0.04525967  0.843319   -0.22746937 -1.337665    0.64618003]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.0421271  -1.2194853  -0.00947738 -1.2506956   0.1544307 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.38098407  0.07041486  0.03443367 -0.04842402  0.05325589]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-7.3840594e-01 -2.7058288e-02  8.7683834e-03 -1.4644648e-01
 -7.2970241e-04]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.23876564 -0.01334612  0.00440341 -0.06787116 -0.00036472]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.23876564 -0.01334612  0.00440341 -0.06787116 -0.00036472]
  [FlaxMamba2] B (step) sample values: [ 0.07338049 -0.27660683 -0.07375471 -0.21714702 -0.01389954]
  [FlaxMamba2] C (step) sample values: [-0.0058515  -0.09500685 -0.14866951 -0.07135738  0.06691145]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.32275575 -0.3764196  -0.15946394 -0.10539922 -0.37568513]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.7569033  1.0368787  0.68794656 0.13591221 0.8825451 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.78325665 0.6768528  0.8961005  0.9857771  0.7178037 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.23876564 -0.01334612  0.00440341 -0.06787116 -0.00036472]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01326151  0.04998908  0.01332914  0.03924336  0.00251196]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01326151  0.04998908  0.01332914  0.03924336  0.00251196]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.1624517   0.1334867   0.06763198  0.13116142  0.01443471]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.15432043 -0.03776956 -0.01606201 -0.04982841  0.06850571]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.6589508  -0.06597653 -0.00675541 -0.19327387  0.06773488]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.6589508  -0.06597653 -0.00675541 -0.19327387  0.06773488]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.03437323  0.01837102  0.00169988  0.04021101  0.00860408]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.0396759   0.02679477  0.00280328  0.04650135  0.00858052]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0396759   0.02679477  0.00280328  0.04650135  0.00858052]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.2673902  -0.3257542   0.36631325  0.02612268 -0.26079208]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.2673902  -0.3257542   0.36631325  0.02612268 -0.26079208]
  [Layer 21] Output shape after mixer: (1, 1, 1024)
  [Layer 21] Output sample values after mixer: [-0.2673902  -0.3257542   0.36631325  0.02612268 -0.26079208]
  [Layer 21] Residual connection shape: (1, 1, 1024)
  [Layer 21] Residual connection sample values: [-1.6287067   0.15615538  3.8608553  -0.50928676 -0.50144625]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.18342142  0.01626569  0.40257084 -0.06775337 -0.05471205]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18342142  0.01626569  0.40257084 -0.06775337 -0.05471205]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18342142  0.01626569  0.40257084 -0.06775337 -0.05471205]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.12419172  0.5850111  -0.55813724 -3.2798297  -0.1319466 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.12419172  0.5850111  -0.55813724 -3.2798297  -0.1319466 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.13990876  0.5686065  -0.45666572  0.27695292 -0.762015  ]
  [FlaxMamba2] dt (step) sample values: [-0.69005346 -1.0064057  -0.379887   -0.29316822  1.1459965 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.25605208 -0.6606246  -1.1091923   0.13990876  1.3061261 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.11374846  0.06645948  0.07821     0.05600094  0.01728277]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.10556212  0.13097364  0.09084428  0.03764462  0.01789312]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.0499978   0.06976922  0.04748389  0.01917654  0.0090266 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0499978   0.06976922  0.04748389  0.01917654  0.0090266 ]
  [FlaxMamba2] B (step) sample values: [-0.27829468  0.28614676  0.19673315 -0.11941122 -0.03307713]
  [FlaxMamba2] C (step) sample values: [-0.27504262 -0.13301583 -0.18742971  0.15779999 -0.06800903]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.07090003 -0.07021102 -0.0699373  -0.08945116 -0.38969815]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.2831633  0.35105747 0.08045992 0.25505504 1.4581598 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9801239  0.9756532  0.99438864 0.97744334 0.5665204 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0499978   0.06976922  0.04748389  0.01917654  0.0090266 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00393997 -0.00405113 -0.00278526  0.00169057  0.00046829]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00393997 -0.00405113 -0.00278526  0.00169057  0.00046829]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.01440551 0.01089882 0.00208128 0.01885287 0.04089945]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01268948  0.13518056 -0.09772182  0.0187522  -0.0076977 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.07350685  0.01489826 -0.17958418 -0.01430821 -0.02325958]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.07350685  0.01489826 -0.17958418 -0.01430821 -0.02325958]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [0.00484754 0.00559736 0.03648252 0.00170208 0.00143342]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.00409526 0.00204806 0.03082083 0.00213618 0.00115548]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.00409526 0.00204806 0.03082083 0.00213618 0.00115548]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.23501077  0.13426504 -0.16994561 -0.38734597  0.29706633]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.23501077  0.13426504 -0.16994561 -0.38734597  0.29706633]
  [Layer 22] Output shape after mixer: (1, 1, 1024)
  [Layer 22] Output sample values after mixer: [ 0.23501077  0.13426504 -0.16994561 -0.38734597  0.29706633]
  [Layer 22] Residual connection shape: (1, 1, 1024)
  [Layer 22] Residual connection sample values: [-1.393696    0.2904204   3.6909096  -0.89663273 -0.20437992]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.13074933  0.02461345  0.32915077 -0.103407   -0.01784308]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.13074933  0.02461345  0.32915077 -0.103407   -0.01784308]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.13074933  0.02461345  0.32915077 -0.103407   -0.01784308]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.32127088  0.61501867 -1.5514022  -0.02030482  0.20825867]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.32127088  0.61501867 -1.5514022  -0.02030482  0.20825867]
  [FlaxMamba2] xBC (step) sample values: [-0.32199144 -0.8367731   1.1511409   0.26051715  0.425965  ]
  [FlaxMamba2] dt (step) sample values: [-0.09758686  0.27381173  0.3758009  -0.26235858  0.1961013 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.20315395 -0.11811411 -0.728753   -0.32199144 -0.04116982]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.36851585  0.10966159  0.01074551  0.08132259  0.03497204]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.40220726  0.10209705 -0.03121616  0.09766475  0.03050503]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.16119748  0.05365221 -0.01536449  0.05121509  0.01548514]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.16119748  0.05365221 -0.01536449  0.05121509  0.01548514]
  [FlaxMamba2] B (step) sample values: [0.17689098 0.13979429 0.05329598 0.8424049  0.01274932]
  [FlaxMamba2] C (step) sample values: [-0.00972174 -0.05130734  0.05445034  0.0728552   0.03735005]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.12322418 -0.22553998 -0.24196908 -0.09559295 -0.2396176 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06546745 0.27390456 0.29082152 0.05773386 0.20917095]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9919653  0.94009304 0.93204904 0.9944962  0.9511143 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.16119748  0.05365221 -0.01536449  0.05121509  0.01548514]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00186676 -0.00147528 -0.00056244 -0.00889006 -0.00013455]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00186676 -0.00147528 -0.00056244 -0.00889006 -0.00013455]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.02303241  0.01044214 -0.00183475  0.06583261 -0.01127466]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00861441  0.01758146  0.19027518 -0.02744732  0.01347644]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01613913  0.01507697  0.1909924  -0.02983805  0.01275359]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01613913  0.01507697  0.1909924  -0.02983805  0.01275359]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00300542  0.00601871 -0.05181913  0.00029985  0.00146581]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0045827   0.02781911 -0.39369914  0.00228541  0.00622052]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0045827   0.02781911 -0.39369914  0.00228541  0.00622052]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.08865911  0.04374355  0.1432644   0.5927313  -0.20079271]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.08865911  0.04374355  0.1432644   0.5927313  -0.20079271]
  [Layer 23] Output shape after mixer: (1, 1, 1024)
  [Layer 23] Output sample values after mixer: [ 0.08865911  0.04374355  0.1432644   0.5927313  -0.20079271]
  [Layer 23] Residual connection shape: (1, 1, 1024)
  [Layer 23] Residual connection sample values: [-1.3050368   0.33416396  3.834174   -0.30390143 -0.40517265]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.15037373  0.03418062  0.4261703  -0.04018778 -0.04301248]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.15037373  0.03418062  0.4261703  -0.04018778 -0.04301248]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.15037373  0.03418062  0.4261703  -0.04018778 -0.04301248]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.401289   -0.15849763 -0.67083836 -0.82431227 -1.0883846 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.401289   -0.15849763 -0.67083836 -0.82431227 -1.0883846 ]
  [FlaxMamba2] xBC (step) sample values: [-0.33407882 -0.54519475 -1.7179995  -0.29853472 -0.28166625]
  [FlaxMamba2] dt (step) sample values: [-0.9932981   0.49205402 -0.21466577 -0.4490898  -0.28210524]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.16669989  0.7084974   0.37178186 -0.33407882 -1.808473  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.08866376 -0.06050751 -0.20349607 -0.07886969  0.08492941]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.21561688  0.03684357 -0.20566663 -0.15797126  0.0917806 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.11938628  0.01876111 -0.09229575 -0.07275984  0.04799474]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.11938628  0.01876111 -0.09229575 -0.07275984  0.04799474]
  [FlaxMamba2] B (step) sample values: [-0.26920363  0.03384652  0.05883136  0.03567526  0.08316647]
  [FlaxMamba2] C (step) sample values: [ 0.03204725 -0.13048404 -0.22952664 -0.1772454  -0.22262275]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6296152  -0.19671947 -0.14336194 -0.14017779 -0.22378482]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.35976088 1.0477394  0.49495554 0.8681307  0.3690841 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.79731065 0.813743   0.9315012  0.88542044 0.92072356]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.11938628  0.01876111 -0.09229575 -0.07275984  0.04799474]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01156243  0.00145373  0.00252684  0.00153227  0.00357204]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01156243  0.00145373  0.00252684  0.00153227  0.00357204]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01441187  0.00562178 -0.00191958  0.00687708  0.00063522]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01969238 -0.00352988 -0.03224974 -0.03004826  0.0124863 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.6044272   0.08835902 -0.48429954 -0.3864143   0.24755684]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.6044272   0.08835902 -0.48429954 -0.3864143   0.24755684]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.14528678 -0.00644858  0.10991214  0.09710237 -0.06787728]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05004383 -0.00693487  0.10392821  0.06819589 -0.04419485]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.05004383 -0.00693487  0.10392821  0.06819589 -0.04419485]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.14475724 -0.49881873  0.04218718 -0.14256363 -0.38597372]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.14475724 -0.49881873  0.04218718 -0.14256363 -0.38597372]
  [Layer 24] Output shape after mixer: (1, 1, 1024)
  [Layer 24] Output sample values after mixer: [ 0.14475724 -0.49881873  0.04218718 -0.14256363 -0.38597372]
  [Layer 24] Residual connection shape: (1, 1, 1024)
  [Layer 24] Residual connection sample values: [-1.1602795  -0.16465476  3.8763611  -0.44646508 -0.7911464 ]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.09035347 -0.01190092  0.2813272  -0.03980656 -0.05773083]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.09035347 -0.01190092  0.2813272  -0.03980656 -0.05773083]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.09035347 -0.01190092  0.2813272  -0.03980656 -0.05773083]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.47695166  0.20351993 -0.84587044  0.03954195 -0.3639342 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.47695166  0.20351993 -0.84587044  0.03954195 -0.3639342 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.9602928   0.29986718 -0.26949257  0.02934233 -0.7116573 ]
  [FlaxMamba2] dt (step) sample values: [-0.22691205 -0.34451145 -0.30552453 -0.04483066 -0.10721245]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.59246755  0.5787873   1.1918046   0.9602928   0.10794807]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.12129715 -0.06806526  0.02858835 -0.28394106 -0.04561726]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.14061478 -0.06471786  0.13124949 -0.3890436  -0.08425251]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.06537239 -0.0313122   0.06992518 -0.15715322 -0.04035269]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06537239 -0.0313122   0.06992518 -0.15715322 -0.04035269]
  [FlaxMamba2] B (step) sample values: [-0.00581852 -0.10101768 -0.04861762 -0.00321444 -0.04072521]
  [FlaxMamba2] C (step) sample values: [-0.21213545 -0.24740022 -0.25100487 -0.24506804 -0.02890199]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.16260907 -0.3326761  -0.32944313 -0.2015813  -0.1541056 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.48858622 0.26272243 0.26349565 0.42213392 0.48447514]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9236255 0.9163091 0.9168542 0.9184257 0.9280587]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06537239 -0.0313122   0.06992518 -0.15715322 -0.04035269]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00018584 0.00322651 0.00155285 0.00010267 0.00130077]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00018584 0.00322651 0.00155285 0.00010267 0.00130077]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00415338  0.0147847   0.01581037  0.00593232 -0.01602245]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01339253  0.00110597 -0.00420029 -0.0465313  -0.01422868]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07345936 -0.02766496  0.06004985 -0.19093013 -0.05130639]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07345936 -0.02766496  0.06004985 -0.19093013 -0.05130639]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01341803 -0.00310067 -0.01525355 -0.0038495   0.00765572]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07063866 -0.01279275 -0.05255698 -0.00744018  0.02278944]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.07063866 -0.01279275 -0.05255698 -0.00744018  0.02278944]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.56879354 -0.02892798  0.22892207 -1.7500455  -1.3682102 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.56879354 -0.02892798  0.22892207 -1.7500455  -1.3682102 ]
  [Layer 25] Output shape after mixer: (1, 1, 1024)
  [Layer 25] Output sample values after mixer: [-0.56879354 -0.02892798  0.22892207 -1.7500455  -1.3682102 ]
  [Layer 25] Residual connection shape: (1, 1, 1024)
  [Layer 25] Residual connection sample values: [-1.729073   -0.19358274  4.1052833  -2.1965106  -2.1593566 ]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.15884382 -0.01656669  0.36943328 -0.24239011 -0.18976076]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.15884382 -0.01656669  0.36943328 -0.24239011 -0.18976076]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.15884382 -0.01656669  0.36943328 -0.24239011 -0.18976076]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.27316722  1.4368732  -0.25230974  0.27095088 -0.30318707]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.27316722  1.4368732  -0.25230974  0.27095088 -0.30318707]
  [FlaxMamba2] xBC (step) sample values: [ 0.60414135 -1.2301817  -0.37820867  0.2987791   0.28331256]
  [FlaxMamba2] dt (step) sample values: [ 0.5125379   0.13906883  0.8657677   0.3451443  -0.25787243]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.5060759  -0.5481895  -0.24176234  0.60414135 -1.6324902 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12185971 -0.39647022  0.02585883  0.09744725  0.01257746]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0308563  -0.45039478  0.00059028  0.03415379 -0.2552448 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.01566616 -0.17532377  0.00029523  0.01736849 -0.11142277]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01566616 -0.17532377  0.00029523  0.01736849 -0.11142277]
  [FlaxMamba2] B (step) sample values: [ 0.35880765  0.0093135  -0.06188889 -0.0651509   0.1904434 ]
  [FlaxMamba2] C (step) sample values: [ 0.08751669 -0.21400551 -0.13133633 -0.14891618 -0.23391892]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.329765   -0.06343037 -0.22886811 -0.12639298 -0.0584348 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.81016535 0.2158257  2.321579   1.6383395  0.434499  ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7655474  0.98640335 0.58781946 0.81295896 0.97492975]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01566616 -0.17532377  0.00029523  0.01736849 -0.11142277]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00455405  0.00011821 -0.0007855  -0.00082691  0.00241714]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00455405  0.00011821 -0.0007855  -0.00082691  0.00241714]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.02636124 -0.00023807 -0.01188662 -0.02625928 -0.00727518]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.15048683 -0.389023   -0.20049083 -0.00997998 -0.43238714]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.08730356 -1.0961223  -0.19930016  0.06006898 -0.881767  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.08730356 -1.0961223  -0.19930016  0.06006898 -0.881767  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01354284 -1.2725435   0.02198754  0.00923366  0.11356045]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00944354 -0.61902624  0.01413034  0.0065184   0.05903071]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00944354 -0.61902624  0.01413034  0.0065184   0.05903071]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.10582782  0.24478212  0.44312495  0.02965644 -0.69598645]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.10582782  0.24478212  0.44312495  0.02965644 -0.69598645]
  [Layer 26] Output shape after mixer: (1, 1, 1024)
  [Layer 26] Output sample values after mixer: [ 0.10582782  0.24478212  0.44312495  0.02965644 -0.69598645]
  [Layer 26] Residual connection shape: (1, 1, 1024)
  [Layer 26] Residual connection sample values: [-1.6232452   0.05119938  4.548408   -2.1668541  -2.855343  ]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.12629779  0.00379224  0.3414531  -0.19486544 -0.22372383]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.12629779  0.00379224  0.3414531  -0.19486544 -0.22372383]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.12629779  0.00379224  0.3414531  -0.19486544 -0.22372383]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.01619951 -0.1103242   0.520464   -0.8523061  -0.3797291 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.01619951 -0.1103242   0.520464   -0.8523061  -0.3797291 ]
  [FlaxMamba2] xBC (step) sample values: [-0.33014047  0.10731125  0.14212006 -1.1220484  -0.30941674]
  [FlaxMamba2] dt (step) sample values: [ 1.0172882  -0.7816977   0.2278675   0.4591303   0.30807558]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.5378049   0.5523377   0.589558   -0.33014047  1.1548247 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.05834728  0.05561837  0.02212486  0.73313135 -0.04330061]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04166943  0.00383004 -0.03292885  0.53293604 -0.04144381]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.02126874  0.00191869 -0.01619337  0.33583903 -0.02029257]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02126874  0.00191869 -0.01619337  0.33583903 -0.02029257]
  [FlaxMamba2] B (step) sample values: [ 0.16925213  0.29172343 -0.03194233  0.25545043 -0.06821121]
  [FlaxMamba2] C (step) sample values: [-0.22256981  0.26028863 -0.00055006 -0.11964101 -0.24559881]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.562595   -0.03025642 -0.75594616 -1.1612954  -0.04055573]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1995864  0.02065222 0.01168028 0.11925623 0.04289519]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.89378834 0.99937534 0.9912092  0.87067044 0.99826187]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02126874  0.00191869 -0.01619337  0.33583903 -0.02029257]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00071847  0.00123835 -0.00013559  0.00108437 -0.00028955]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00071847  0.00123835 -0.00013559  0.00108437 -0.00028955]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00405611 -0.00621136 -0.00559677 -0.02141318  0.00120408]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01562667 -0.00171196 -0.00567728  0.01346359  0.00145214]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02666966  0.00210366 -0.03788041  0.68133384 -0.03890292]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02666966  0.00210366 -0.03788041  0.68133384 -0.03890292]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 2.1776735e-04 -1.0964764e-04 -1.2366603e-02 -1.7360136e-01
  6.0005030e-03]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.000503   -0.00019932 -0.0324267  -0.11712536  0.02009477]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.000503   -0.00019932 -0.0324267  -0.11712536  0.02009477]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.56615454 -0.48150465  0.42321268 -0.40913454 -0.27191222]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.56615454 -0.48150465  0.42321268 -0.40913454 -0.27191222]
  [Layer 27] Output shape after mixer: (1, 1, 1024)
  [Layer 27] Output sample values after mixer: [-0.56615454 -0.48150465  0.42321268 -0.40913454 -0.27191222]
  [Layer 27] Residual connection shape: (1, 1, 1024)
  [Layer 27] Residual connection sample values: [-2.1893997  -0.43030527  4.9716206  -2.5759888  -3.1272554 ]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.13922116 -0.02633249  0.31094584 -0.19149694 -0.19259714]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.13922116 -0.02633249  0.31094584 -0.19149694 -0.19259714]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.13922116 -0.02633249  0.31094584 -0.19149694 -0.19259714]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.2092285   0.43901154  0.06366207 -0.11913241 -0.06775674]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.2092285   0.43901154  0.06366207 -0.11913241 -0.06775674]
  [FlaxMamba2] xBC (step) sample values: [-0.50437963 -0.60885346  0.58683425 -1.0540239   0.64274687]
  [FlaxMamba2] dt (step) sample values: [0.9274518  0.83704776 0.34823796 0.3438408  1.2454937 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.445223   -1.6444194  -0.02011488 -0.50437963  1.6297375 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.19981728 -0.11744604  0.11353     0.28011274  0.08916272]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0718876  -0.20686254 -0.01562039  0.19002485  0.02354993]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.0372352  -0.09277122 -0.0077492   0.10401272  0.01191361]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0372352  -0.09277122 -0.0077492   0.10401272  0.01191361]
  [FlaxMamba2] B (step) sample values: [-0.27084568 -0.09505421  0.0229362   0.06262371 -0.25310078]
  [FlaxMamba2] C (step) sample values: [ 0.01647397 -0.09620368 -0.00221471 -0.04631879 -0.01034531]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.54422176 -0.18426022 -0.10643356 -0.11241624 -0.25234625]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.40400022 0.9280201  1.1354426  1.0556691  1.1452682 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8026266  0.8428239  0.8861676  0.888097   0.74900913]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0372352  -0.09277122 -0.0077492   0.10401272  0.01191361]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00407434 -0.0014299   0.00034503  0.00094205 -0.0038074 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00407434 -0.0014299   0.00034503  0.00094205 -0.0038074 ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00287378  0.00032663 -0.00327053  0.00067892 -0.00669884]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00091255 -0.00660077 -0.00113846  0.01137474 -0.00177989]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.07038128 -0.17968161 -0.01559593  0.20542854  0.02044701]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.07038128 -0.17968161 -0.01559593  0.20542854  0.02044701]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00659542 -0.04796229 -0.00051223 -0.01150857 -0.00066925]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02561793 -0.17505318 -0.00178474 -0.04632866 -0.00313485]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02561793 -0.17505318 -0.00178474 -0.04632866 -0.00313485]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.12458511 -0.5840838   1.0761193  -0.09528938  0.7827233 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.12458511 -0.5840838   1.0761193  -0.09528938  0.7827233 ]
  [Layer 28] Output shape after mixer: (1, 1, 1024)
  [Layer 28] Output sample values after mixer: [ 0.12458511 -0.5840838   1.0761193  -0.09528938  0.7827233 ]
  [Layer 28] Residual connection shape: (1, 1, 1024)
  [Layer 28] Residual connection sample values: [-2.0648146 -1.014389   6.04774   -2.6712782 -2.344532 ]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.1595897  -0.07740207  0.47105983 -0.25513047 -0.1820131 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1595897  -0.07740207  0.47105983 -0.25513047 -0.1820131 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1595897  -0.07740207  0.47105983 -0.25513047 -0.1820131 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.29045948  0.4770945  -0.23345609 -0.9464361   0.33851567]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.29045948  0.4770945  -0.23345609 -0.9464361   0.33851567]
  [FlaxMamba2] xBC (step) sample values: [ 0.26955572  0.8462164   0.22242492 -0.9596301   0.15879782]
  [FlaxMamba2] dt (step) sample values: [0.6785365  0.15198666 0.7093896  0.9068346  0.92954636]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.04194061  0.51662797 -0.25573054  0.26955572  0.30087364]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04593917 -0.22331841 -0.15612558  0.18879622  0.23158693]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.05993148 -0.29894096 -0.29443124  0.55549544  1.7315869 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.03086342 -0.12729394 -0.1256984   0.35296717  1.4711828 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03086342 -0.12729394 -0.1256984   0.35296717  1.4711828 ]
  [FlaxMamba2] B (step) sample values: [-0.13470487 -0.0596977  -0.03868967  0.01394987  0.0362114 ]
  [FlaxMamba2] C (step) sample values: [-0.03901196 -0.02210726 -0.021279   -0.09859364  0.3575802 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6542169  -0.13693057 -1.458904   -0.36823887 -0.12178858]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.15775818 0.06397196 0.18370645 0.23846851 0.6189066 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9019393 0.9912785 0.7649001 0.9159318 0.9273949]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03086342 -0.12729394 -0.1256984   0.35296717  1.4711828 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.5587217e-04 -2.9066548e-04 -1.8837831e-04  6.7921312e-05
  1.7631173e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.5587217e-04 -2.9066548e-04 -1.8837831e-04  6.7921312e-05
  1.7631173e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00039186  0.00166587 -0.00133517 -0.00165937  0.00218459]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0018397  -0.00157775  0.00353177  0.00498554  0.0106604 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.05004018 -0.21555258 -0.20776103  0.5983059   2.4836462 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.05004018 -0.21555258 -0.20776103  0.5983059   2.4836462 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0083154  -0.06345797  0.02143349 -0.158327    0.4908568 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03703348 -0.22065708  0.05568283 -0.50504524  0.2425715 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03703348 -0.22065708  0.05568283 -0.50504524  0.2425715 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.5038041  -0.3314107  -0.24689712 -0.31596273 -0.27930683]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.5038041  -0.3314107  -0.24689712 -0.31596273 -0.27930683]
  [Layer 29] Output shape after mixer: (1, 1, 1024)
  [Layer 29] Output sample values after mixer: [-0.5038041  -0.3314107  -0.24689712 -0.31596273 -0.27930683]
  [Layer 29] Residual connection shape: (1, 1, 1024)
  [Layer 29] Residual connection sample values: [-2.5686188 -1.3457997  5.800843  -2.987241  -2.623839 ]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.18010326 -0.09007133  0.39578295 -0.23916307 -0.17880046]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18010326 -0.09007133  0.39578295 -0.23916307 -0.17880046]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.18010326 -0.09007133  0.39578295 -0.23916307 -0.17880046]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.12492682 -0.6552433   0.14422333 -0.45847258  1.1005679 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.12492682 -0.6552433   0.14422333 -0.45847258  1.1005679 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.1416911 -0.5550783 -1.0053806 -1.018953  -1.1823848]
  [FlaxMamba2] dt (step) sample values: [-0.06199803 -1.0764333   0.07552145  0.45736486 -0.41403037]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.6208633  -0.9774104  -0.46683487  0.1416911   0.4423574 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.13591391  0.1026054   0.30357975  0.31179324 -0.50223464]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.17873007  0.06079631  0.87877506  0.3612317  -0.59476393]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.08140013  0.03132192  0.6209146   0.21288778 -0.21146388]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08140013  0.03132192  0.6209146   0.21288778 -0.21146388]
  [FlaxMamba2] B (step) sample values: [-0.04963849 -0.03791626  0.02889424  0.05939891 -0.20604157]
  [FlaxMamba2] C (step) sample values: [-0.08598294 -0.02159344 -0.15187766 -0.23208095 -0.21034288]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2037584  -0.36680323 -0.20777717 -0.09522027 -0.4265393 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.50015455 0.08743368 0.47070694 0.15263739 0.17593153]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9031102  0.96843785 0.9068283  0.9855709  0.9277048 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08140013  0.03132192  0.6209146   0.21288778 -0.21146388]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00202091  0.00154367 -0.00117636 -0.00241829  0.0083885 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00202091  0.00154367 -0.00117636 -0.00241829  0.0083885 ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00662512 -0.02301476 -0.01069682 -0.00739597  0.0486795 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.07845351 -0.05695788  0.73264575  0.1523237  -0.18979977]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0918976  -0.05178474  0.8351963   0.18748435 -0.22472526]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0918976  -0.05178474  0.8351963   0.18748435 -0.22472526]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00609833  0.01159812  0.06456298 -0.03329507 -0.18558471]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01816141  0.03815063  0.12838316 -0.10990685 -0.2246108 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01816141  0.03815063  0.12838316 -0.10990685 -0.2246108 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.49532914 -0.1453848  -0.5607103  -0.7463433  -0.7629658 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.49532914 -0.1453848  -0.5607103  -0.7463433  -0.7629658 ]
  [Layer 30] Output shape after mixer: (1, 1, 1024)
  [Layer 30] Output sample values after mixer: [ 0.49532914 -0.1453848  -0.5607103  -0.7463433  -0.7629658 ]
  [Layer 30] Residual connection shape: (1, 1, 1024)
  [Layer 30] Residual connection sample values: [-2.0732896 -1.4911845  5.2401323 -3.7335844 -3.3868046]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.0951268  -0.06938652  0.24149098 -0.194024   -0.15566836]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0951268  -0.06938652  0.24149098 -0.194024   -0.15566836]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0951268  -0.06938652  0.24149098 -0.194024   -0.15566836]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.60374707  0.12190989  0.25805643 -0.10827849 -0.30112675]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.60374707  0.12190989  0.25805643 -0.10827849 -0.30112675]
  [FlaxMamba2] xBC (step) sample values: [ 0.22414674  0.4402387  -0.84529334 -0.02826935  0.2063927 ]
  [FlaxMamba2] dt (step) sample values: [1.4946297 1.101213  1.4030219 1.2019594 0.3323605]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [0.7384626  0.23523258 0.23937568 0.22414674 0.5896053 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.04257411 -0.09792112  0.18287498  0.04818612  0.16351978]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04548091 -0.06297849  0.17230064  0.03002816  0.10321705]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.02222341 -0.030498    0.09355389  0.01523949  0.0542696 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02222341 -0.030498    0.09355389  0.01523949  0.0542696 ]
  [FlaxMamba2] B (step) sample values: [ 0.01691287 -0.0015724   0.00683403 -0.00261197 -0.00539674]
  [FlaxMamba2] C (step) sample values: [-0.06013487 -0.0550936  -0.06886821 -0.0279454  -0.00830013]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-9.5765535e-03 -1.0641767e-02 -2.6350424e+01 -6.4467737e+02
 -1.6546801e-02]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.19038391 0.16605087 2.0859237  2.3376756  0.08650675]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.9817842e-01 9.9823451e-01 1.3459079e-24 0.0000000e+00 9.9856961e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02222341 -0.030498    0.09355389  0.01523949  0.0542696 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.15580099e-05  6.65281050e-06 -2.89146592e-05  1.10511755e-05
  2.28334975e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.15580099e-05  6.65281050e-06 -2.89146592e-05  1.10511755e-05
  2.28334975e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01643922 -0.01076573  0.00776668  0.01557894  0.00600358]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01685338 -0.01761601  0.00339349  0.01787346 -0.05461797]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0140646  -0.01378886 -0.00834645  0.01596108 -0.06142819]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0140646  -0.01378886 -0.00834645  0.01596108 -0.06142819]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00548984 -0.00089167 -0.00121512 -0.00081738  0.00786673]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.10597339 -0.01556626 -0.02147741 -0.06394935  0.04014235]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.10597339 -0.01556626 -0.02147741 -0.06394935  0.04014235]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.035739    0.24740936  1.336648   -0.39088276  1.0312523 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.035739    0.24740936  1.336648   -0.39088276  1.0312523 ]
  [Layer 31] Output shape after mixer: (1, 1, 1024)
  [Layer 31] Output sample values after mixer: [-1.035739    0.24740936  1.336648   -0.39088276  1.0312523 ]
  [Layer 31] Residual connection shape: (1, 1, 1024)
  [Layer 31] Residual connection sample values: [-3.1090286 -1.2437751  6.5767803 -4.1244674 -2.3555522]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.2352446  -0.09209534  0.48359954 -0.36373764 -0.18083884]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.2352446  -0.09209534  0.48359954 -0.36373764 -0.18083884]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.2352446  -0.09209534  0.48359954 -0.36373764 -0.18083884]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.3242115  -0.32376662  0.6197723   0.8913758  -0.21226214]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.3242115  -0.32376662  0.6197723   0.8913758  -0.21226214]
  [FlaxMamba2] xBC (step) sample values: [-1.2513026  -0.20801724 -0.16086279 -1.5502657   2.0013342 ]
  [FlaxMamba2] dt (step) sample values: [-0.10581475 -0.07853921  0.94119334 -0.04180381 -0.21996142]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.7309479   0.01557062  0.35602915 -1.2513026   0.60745287]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.20320058 -0.05064815 -0.0117409   0.27366075  0.0766772 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.21688771 -0.41856807 -0.01381801  0.25017747  0.06437861]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.09672967 -0.1661127  -0.00686127  0.14065483  0.0332251 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09672967 -0.1661127  -0.00686127  0.14065483  0.0332251 ]
  [FlaxMamba2] B (step) sample values: [-0.04418289 -0.0165636   0.18924764 -0.03929142  0.00584473]
  [FlaxMamba2] C (step) sample values: [-0.27694693 -0.1050121  -0.27375048 -0.26035905 -0.23142244]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.0662153  -0.08112868 -0.58786964 -0.09559295 -0.5447535 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.93216443 1.0069644  0.85047996 0.85001063 0.50594354]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.94014275 0.9215542  0.606548   0.92195857 0.7591055 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09672967 -0.1661127  -0.00686127  0.14065483  0.0332251 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00398388  0.00149351 -0.01706407  0.00354283 -0.00052701]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00398388  0.00149351 -0.01706407  0.00354283 -0.00052701]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.01642577 0.10924068 0.1030451  0.22807    0.13518956]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.13867457 -0.91518617  0.05417747  0.6984829  -0.18966252]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.1408645  -0.9114254   0.05433281  0.6952985  -0.19041473]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.1408645  -0.9114254   0.05433281  0.6952985  -0.19041473]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01916536  0.12386603  0.0218937   0.43952638  0.01807214]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00728081  0.10219267  0.01800516  0.22649308  0.01049177]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00728081  0.10219267  0.01800516  0.22649308  0.01049177]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.28932354 -0.29937196  1.6407957  -1.2982692   0.82541144]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.28932354 -0.29937196  1.6407957  -1.2982692   0.82541144]
  [Layer 32] Output shape after mixer: (1, 1, 1024)
  [Layer 32] Output sample values after mixer: [ 0.28932354 -0.29937196  1.6407957  -1.2982692   0.82541144]
  [Layer 32] Residual connection shape: (1, 1, 1024)
  [Layer 32] Residual connection sample values: [-2.819705  -1.5431471  8.217576  -5.4227366 -1.5301408]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.21318622 -0.11394528  0.617826   -0.4306047  -0.1169802 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.21318622 -0.11394528  0.617826   -0.4306047  -0.1169802 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.21318622 -0.11394528  0.617826   -0.4306047  -0.1169802 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.18715371 -0.20068435 -0.0933416   0.35682538 -1.3851794 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.18715371 -0.20068435 -0.0933416   0.35682538 -1.3851794 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.5544128   0.24387667 -0.99742043  1.1659329   0.9625152 ]
  [FlaxMamba2] dt (step) sample values: [-0.38089052  0.47413838 -0.6167307  -0.37222517  0.34634516]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.6151876   0.29317662  1.7261065   0.5544128  -0.12150099]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.1565083   0.05145219 -0.15197383  0.2968377   0.19865093]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.11375538  0.01486162 -0.16534053  0.17391288  0.16428813]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.0536461   0.00748602 -0.07585142  0.09449886  0.08887658]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0536461   0.00748602 -0.07585142  0.09449886  0.08887658]
  [FlaxMamba2] B (step) sample values: [-0.11111337  0.08033171  0.06706893  0.00654802 -0.08533153]
  [FlaxMamba2] C (step) sample values: [-0.00709729 -0.08623962  0.1143339  -0.17297474 -0.03791334]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-13.044406    -1.3849771   -0.1667907   -0.23590268  -5.254998  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00966126 0.00773682 0.03028372 0.03642972 0.01174078]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.88159245 0.98934186 0.9949617  0.991443   0.940167  ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0536461   0.00748602 -0.07585142  0.09449886  0.08887658]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.7588830e-05 -4.1635034e-05 -3.4761088e-05 -3.3937674e-06
  4.4226388e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.7588830e-05 -4.1635034e-05 -3.4761088e-05 -3.3937674e-06
  4.4226388e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.90287933e-05  1.38672418e-04 -1.05256215e-04 -9.17552388e-05
 -4.47555823e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-6.6652297e-05 -4.4642622e-04 -2.5015275e-04  6.7654654e-04
  7.9803009e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05752709  0.00757187 -0.08149475  0.10189445  0.09527568]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05752709  0.00757187 -0.08149475  0.10189445  0.09527568]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00488093 -0.00068379  0.00362605  0.02138869 -0.02641833]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02958873 -0.00401892  0.02908537  0.14417973 -0.20135203]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02958873 -0.00401892  0.02908537  0.14417973 -0.20135203]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.11107009 -0.4302104  -0.52897674  0.12361012 -0.3117462 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.11107009 -0.4302104  -0.52897674  0.12361012 -0.3117462 ]
  [Layer 33] Output shape after mixer: (1, 1, 1024)
  [Layer 33] Output sample values after mixer: [ 0.11107009 -0.4302104  -0.52897674  0.12361012 -0.3117462 ]
  [Layer 33] Residual connection shape: (1, 1, 1024)
  [Layer 33] Residual connection sample values: [-2.7086349 -1.9733574  7.688599  -5.2991266 -1.841887 ]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.16496089 -0.11838429  0.48682916 -0.3273662  -0.11456103]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.16496089 -0.11838429  0.48682916 -0.3273662  -0.11456103]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.16496089 -0.11838429  0.48682916 -0.3273662  -0.11456103]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.10082158  0.1928823  -0.1553431   1.4063914  -1.1321518 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.10082158  0.1928823  -0.1553431   1.4063914  -1.1321518 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.06419    -2.174598   -0.6088964  -0.8764475  -0.24654186]
  [FlaxMamba2] dt (step) sample values: [-0.432881    0.07079606  0.0182186  -0.57299787  0.5959896 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.456136   -1.7558019  -0.56008327  0.06419    -1.2735611 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02718032  1.1135786   0.15032542  0.19063126 -0.11702961]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.07054579  1.0163496   0.11632884  0.10951553 -0.19106525]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.03402924  0.74626577  0.06154371  0.05775319 -0.08643381]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03402924  0.74626577  0.06154371  0.05775319 -0.08643381]
  [FlaxMamba2] B (step) sample values: [-0.01281294  0.05783148 -0.04032644 -0.00669652 -0.06468885]
  [FlaxMamba2] C (step) sample values: [-0.26209182 -0.01051448 -0.07764128 -0.04505628 -0.08077272]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2224774  -0.15365478 -0.8168739  -0.85911244 -2.0730147 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00852059 0.00766921 0.19589876 0.05740092 0.29891947]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9981062  0.9988223  0.85212284 0.95188236 0.538125  ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03402924  0.74626577  0.06154371  0.05775319 -0.08643381]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.7151044e-06 -1.6768199e-05  1.1692624e-05  1.9416500e-06
  1.8756489e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.7151044e-06 -1.6768199e-05  1.1692624e-05  1.9416500e-06
  1.8756489e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00304106  0.00740497  0.00346916 -0.00653343  0.01051995]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02264116  0.08407979  0.03916156 -0.01603068 -0.03050857]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.08959411  1.552367    0.16024956  0.09759943 -0.20056815]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.08959411  1.552367    0.16024956  0.09759943 -0.20056815]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.004744    0.16410586 -0.01148201  0.11024912  0.05535242]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01882522  0.36416242 -0.03810249  0.43237582  0.23137166]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01882522  0.36416242 -0.03810249  0.43237582  0.23137166]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.89392734  1.2635685   1.5472829  -1.6493738  -1.0968184 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.89392734  1.2635685   1.5472829  -1.6493738  -1.0968184 ]
  [Layer 34] Output shape after mixer: (1, 1, 1024)
  [Layer 34] Output sample values after mixer: [ 0.89392734  1.2635685   1.5472829  -1.6493738  -1.0968184 ]
  [Layer 34] Residual connection shape: (1, 1, 1024)
  [Layer 34] Residual connection sample values: [-1.8147075 -0.7097889  9.235882  -6.9485006 -2.9387054]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.14044756 -0.05450353  0.7042356  -0.57331234 -0.22605391]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.14044756 -0.05450353  0.7042356  -0.57331234 -0.22605391]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.14044756 -0.05450353  0.7042356  -0.57331234 -0.22605391]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.6043334  -1.8277596   0.72952265 -2.0316522   0.31632107]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.6043334  -1.8277596   0.72952265 -2.0316522   0.31632107]
  [FlaxMamba2] xBC (step) sample values: [ 0.26968104  0.14567669 -0.49427983 -0.3358907  -0.7312423 ]
  [FlaxMamba2] dt (step) sample values: [ 1.2485665  1.6418847 -1.2002351  1.1165211  0.4835215]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.0362945  -1.0326835  -1.1648918   0.26968104  0.75901115]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.06746451  0.05074727 -0.1847688  -0.06207977 -0.16558406]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.11891714  0.02901876 -0.2122041  -0.08692108 -0.2778277 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.05592741  0.01471989 -0.09488646 -0.04157291 -0.11973997]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05592741  0.01471989 -0.09488646 -0.04157291 -0.11973997]
  [FlaxMamba2] B (step) sample values: [ 2.23459993e-02  7.12280598e-06  2.28007734e-01 -1.21131865e-02
  1.65976658e-01]
  [FlaxMamba2] C (step) sample values: [ 0.11766826 -0.0299771  -0.23380958 -0.06525047  0.01027029]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2053565  -0.14169171 -0.10705902 -0.1460468  -0.2580783 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [2.8630214  3.8355849  0.34929565 3.4836352  1.1928861 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.55547035 0.58072925 0.96329534 0.60123235 0.7350197 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05592741  0.01471989 -0.09488646 -0.04157291 -0.11973997]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.5780719e-03 -1.1405134e-06 -3.6508910e-02  1.9395800e-03
 -2.6576409e-02]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.5780719e-03 -1.1405134e-06 -3.6508910e-02  1.9395800e-03
 -2.6576409e-02]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.07443825 -0.01933916  0.01431317 -0.02025004 -0.04123898]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.03178343  0.32090548 -0.67818016 -0.03329438 -0.6169379 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.17823718  0.35945156 -0.9266536  -0.14215885 -0.9304937 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.17823718  0.35945156 -0.9266536  -0.14215885 -0.9304937 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0380613  -0.09099679 -0.45610753  0.03347956 -0.1702513 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03809073 -0.08830754 -0.15309118  0.04842544 -0.14272963]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03809073 -0.08830754 -0.15309118  0.04842544 -0.14272963]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.0289293  -0.10645637  0.00916448 -0.11494509  1.4482943 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.0289293  -0.10645637  0.00916448 -0.11494509  1.4482943 ]
  [Layer 35] Output shape after mixer: (1, 1, 1024)
  [Layer 35] Output sample values after mixer: [-0.0289293  -0.10645637  0.00916448 -0.11494509  1.4482943 ]
  [Layer 35] Residual connection shape: (1, 1, 1024)
  [Layer 35] Residual connection sample values: [-1.8436369 -0.8162453  9.245047  -7.0634456 -1.4904112]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.11793513 -0.05338697  0.5948592  -0.48228595 -0.09766735]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.11793513 -0.05338697  0.5948592  -0.48228595 -0.09766735]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.11793513 -0.05338697  0.5948592  -0.48228595 -0.09766735]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.615946  -2.3131907 -0.9428691 -1.1269611 -1.0533273]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-2.615946  -2.3131907 -0.9428691 -1.1269611 -1.0533273]
  [FlaxMamba2] xBC (step) sample values: [ 0.27150157  1.0127587   0.32801652 -1.0018518  -0.5560296 ]
  [FlaxMamba2] dt (step) sample values: [-1.545638    0.8174599  -0.44762176 -0.45172876 -0.19984996]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.1748698   0.9087267  -1.8935751   0.27150157  2.3698785 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06623266  0.21865769  0.09357668 -0.24793495 -0.08837159]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.10651586  0.10110398  0.03147341 -0.39258826 -0.1004947 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.05609166  0.05310532  0.01598433 -0.15825012 -0.04772468]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05609166  0.05310532  0.01598433 -0.15825012 -0.04772468]
  [FlaxMamba2] B (step) sample values: [ 0.18598528 -0.16888069 -0.01605937 -0.01271846 -0.1328018 ]
  [FlaxMamba2] C (step) sample values: [ 0.01809765 -0.10726338 -0.24793991 -0.08914097 -0.11391634]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.8654757 -5.63779   -3.8975632 -2.4259677 -3.6937442]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01532438 0.03837373 0.01163838 0.02538912 0.02037093]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9570385  0.80545896 0.9556521  0.9402653  0.9275162 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05609166  0.05310532  0.01598433 -0.15825012 -0.04772468]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.5986738e-04 -1.4516478e-04 -1.3804157e-05 -1.0932407e-05
 -1.1415245e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.5986738e-04 -1.4516478e-04 -1.3804157e-05 -1.0932407e-05
 -1.1415245e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00423696 -0.00121889 -0.00349711  0.0024008   0.00104113]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00210617  0.01276647 -0.0057142  -0.01546934 -0.00960991]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.17413008  0.17563178  0.04330711 -0.5007965  -0.15597367]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.17413008  0.17563178  0.04330711 -0.5007965  -0.15597367]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0310293  -0.03657906 -0.01144634  0.13811596  0.04248355]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.0454951  -0.1145318  -0.02475924  0.31856158  0.11150513]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0454951  -0.1145318  -0.02475924  0.31856158  0.11150513]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.02432686 -0.5461353   2.0440483   0.30060503  2.1937754 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.02432686 -0.5461353   2.0440483   0.30060503  2.1937754 ]
  [Layer 36] Output shape after mixer: (1, 1, 1024)
  [Layer 36] Output sample values after mixer: [ 0.02432686 -0.5461353   2.0440483   0.30060503  2.1937754 ]
  [Layer 36] Residual connection shape: (1, 1, 1024)
  [Layer 36] Residual connection sample values: [-1.8193101  -1.3623806  11.289095   -6.7628407   0.70336425]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.101497   -0.07804512  0.6607364  -0.3864599   0.04025308]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.101497   -0.07804512  0.6607364  -0.3864599   0.04025308]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.101497   -0.07804512  0.6607364  -0.3864599   0.04025308]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.90801823 -0.5475323  -0.29038233 -0.08393676 -2.6806355 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.90801823 -0.5475323  -0.29038233 -0.08393676 -2.6806355 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.5326118   0.65764046  0.38982433 -0.24705331  0.58800834]
  [FlaxMamba2] dt (step) sample values: [-0.7675746  -1.2053665   0.13590729 -0.9242651   0.07978207]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.5111333  -0.16051315 -0.06146366  0.5326118   0.22026938]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.12832431 -0.15456355 -0.27629608  0.04235399 -0.11759387]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.2060831  -0.21865046 -0.3608908   0.07723558 -0.20121203]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.09246141 -0.09742062 -0.14823371  0.04010838 -0.09051845]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09246141 -0.09742062 -0.14823371  0.04010838 -0.09051845]
  [FlaxMamba2] B (step) sample values: [ 0.0421899  -0.18566968 -0.10272972 -0.08379112 -0.06869406]
  [FlaxMamba2] C (step) sample values: [-0.2561561  -0.27091417 -0.27582812 -0.26056263 -0.27788115]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.8178532  -31.169907   -39.01954     -0.46187502  -0.64770097]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00029313 0.00217172 0.00382871 0.00029414 0.00179373]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99946725 0.93454784 0.8612292  0.99986416 0.9988389 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09246141 -0.09742062 -0.14823371  0.04010838 -0.09051845]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.1434659e-06  5.0321742e-06  2.7842666e-06  2.2709769e-06
  1.8618035e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.1434659e-06  5.0321742e-06  2.7842666e-06  2.2709769e-06
  1.8618035e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00040715  0.00035873 -0.00061504  0.0009008  -0.00057146]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00034088  0.00405706 -0.00667248  0.00496276 -0.00251197]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.16969435 -0.17437977 -0.2781792   0.07842577 -0.16830671]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.16969435 -0.17437977 -0.2781792   0.07842577 -0.16830671]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.10980052  0.03498689  0.03456588 -0.00315335  0.02893154]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.5186576   0.11950754  0.11104864 -0.01602784  0.07847138]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.5186576   0.11950754  0.11104864 -0.01602784  0.07847138]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.2083238  1.5740621  2.8835633  2.3509963 -3.7145722]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.2083238  1.5740621  2.8835633  2.3509963 -3.7145722]
  [Layer 37] Output shape after mixer: (1, 1, 1024)
  [Layer 37] Output sample values after mixer: [-1.2083238  1.5740621  2.8835633  2.3509963 -3.7145722]
  [Layer 37] Residual connection shape: (1, 1, 1024)
  [Layer 37] Residual connection sample values: [-3.027634    0.21168149 14.172658   -4.4118443  -3.011208  ]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.16246204  0.01135877  0.7568797  -0.22941078 -0.16265783]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.16246204  0.01135877  0.7568797  -0.22941078 -0.16265783]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.16246204  0.01135877  0.7568797  -0.22941078 -0.16265783]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.2116873  -2.3194416  -0.4802773  -1.5834363  -0.09225304]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.2116873  -2.3194416  -0.4802773  -1.5834363  -0.09225304]
  [FlaxMamba2] xBC (step) sample values: [ 1.8935394  -0.01483322  0.35477236  0.406734    0.16463779]
  [FlaxMamba2] dt (step) sample values: [-1.0981759  -0.62261546 -1.3014667  -0.5941652   0.15056685]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.89194643  0.45082816 -0.22204053  1.8935394  -0.3671469 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.35835174 -0.16216396  0.23502006 -0.10229608  0.02419886]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.36074165 -0.4514706   0.14493217 -0.14547846  0.1171554 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.14818546 -0.17562711  0.07770824 -0.06745754  0.06200513]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.14818546 -0.17562711  0.07770824 -0.06745754  0.06200513]
  [FlaxMamba2] B (step) sample values: [ 0.04261753  0.13972728 -0.04361926  0.01679254  0.00734841]
  [FlaxMamba2] C (step) sample values: [-0.2634795  -0.03747793 -0.16981822 -0.25264242 -0.11194838]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17041285 -2.0831616  -0.13507122 -0.41240796 -3.531486  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.3419147  0.0653667  0.23055468 0.17523046 0.11346795]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.94339836 0.8726948  0.9693386  0.930283   0.669844  ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.14818546 -0.17562711  0.07770824 -0.06745754  0.06200513]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00215929 -0.00707953  0.00221005 -0.00085082 -0.00037232]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00215929 -0.00707953  0.00221005 -0.00085082 -0.00037232]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00158733  0.11302222 -0.00711403 -0.0060824   0.00060177]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.20058766 -0.24675715 -0.05832766 -0.11975524  0.2411364 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.22232066 -0.27251476 -0.04693091 -0.12964861  0.25023013]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.22232066 -0.27251476 -0.04693091 -0.12964861  0.25023013]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0617972   0.05658751  0.00861443  0.03496286 -0.01101022]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13061653  0.08052772  0.01355703  0.10986293 -0.02392079]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.13061653  0.08052772  0.01355703  0.10986293 -0.02392079]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [  6.2053347    1.2766088    1.7172935  -14.2197485   -0.58979326]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [  6.2053347    1.2766088    1.7172935  -14.2197485   -0.58979326]
  [Layer 38] Output shape after mixer: (1, 1, 1024)
  [Layer 38] Output sample values after mixer: [  6.2053347    1.2766088    1.7172935  -14.2197485   -0.58979326]
  [Layer 38] Residual connection shape: (1, 1, 1024)
  [Layer 38] Residual connection sample values: [  3.1777008   1.4882903  15.889952  -18.631592   -3.6010013]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.07444209  0.03791656  0.39260525 -0.48281458 -0.08853842]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.07444209  0.03791656  0.39260525 -0.48281458 -0.08853842]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.07444209  0.03791656  0.39260525 -0.48281458 -0.08853842]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.17885232 -1.7239672  -2.4880064  -1.1960237  -0.95423555]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.17885232 -1.7239672  -2.4880064  -1.1960237  -0.95423555]
  [FlaxMamba2] xBC (step) sample values: [ 0.22376694  0.69996923  0.2916455   0.0067919  -1.8009832 ]
  [FlaxMamba2] dt (step) sample values: [ 4.4045525   4.855165    1.0643301   0.99607974 -0.14101753]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.2064722   0.25050467 -0.11333404  0.22376694  0.05326229]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04087025 -0.12758379  0.06449328  0.01091646 -0.52392864]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.10532337 -0.18831377  0.07975207  0.5485141  -0.52733135]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.05543238 -0.08531748  0.04146529  0.3476432  -0.19571349]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05543238 -0.08531748  0.04146529  0.3476432  -0.19571349]
  [FlaxMamba2] B (step) sample values: [ 0.01655595 -0.01718612 -0.12467039 -0.19920944  0.02660123]
  [FlaxMamba2] C (step) sample values: [-0.27469963 -0.27794564 -0.01386285  0.00581187 -0.27819896]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.7351256e+02 -2.3790452e+00 -2.6078771e-03 -1.4978828e+00
 -6.3306607e-02]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [3.269492   3.7071667  0.628431   0.31064093 0.0077525 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.0000000e+00 1.4781972e-04 9.9836248e-01 6.2794435e-01 9.9950933e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05543238 -0.08531748  0.04146529  0.3476432  -0.19571349]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00300053 -0.00311474 -0.02259473 -0.03610386  0.00482109]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00300053 -0.00311474 -0.02259473 -0.03610386  0.00482109]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00300053 -0.00311474 -0.02259473 -0.03610386  0.00482109]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.02225523 -0.03425362  0.01664765  0.13957319 -0.07857588]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.2730791  -0.42030343  0.20427236  1.7126106  -0.96415234]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.2730791  -0.42030343  0.20427236  1.7126106  -0.96415234]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02224239  0.10967448 -0.03898297 -0.47558647  0.255799  ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.10666705  0.49827975 -0.16758275 -1.9949445   1.2943652 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.10666705  0.49827975 -0.16758275 -1.9949445   1.2943652 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 4.33612    -1.9084543   7.8128257  -0.71424633 -1.3371899 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 4.33612    -1.9084543   7.8128257  -0.71424633 -1.3371899 ]
  [Layer 39] Output shape after mixer: (1, 1, 1024)
  [Layer 39] Output sample values after mixer: [ 4.33612    -1.9084543   7.8128257  -0.71424633 -1.3371899 ]
  [Layer 39] Residual connection shape: (1, 1, 1024)
  [Layer 39] Residual connection sample values: [  7.5138206  -0.420164   23.702778  -19.345839   -4.9381914]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.21369481 -0.01275095  0.70458657 -0.5266944  -0.14539686]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.21369481 -0.01275095  0.70458657 -0.5266944  -0.14539686]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.21369481 -0.01275095  0.70458657 -0.5266944  -0.14539686]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.779308    0.07951166  0.07819928 -1.1426489   0.58965516]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.779308    0.07951166  0.07819928 -1.1426489   0.58965516]
  [FlaxMamba2] xBC (step) sample values: [-0.48685253  0.47063348  0.69951135 -1.0584444  -1.3925978 ]
  [FlaxMamba2] dt (step) sample values: [-0.5685069  -0.03883461  1.4151398  -4.043105    1.1459143 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.16800253 -2.0063157  -3.3809352  -0.48685253  0.95515627]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.07596846 -0.08243747  0.13701037  0.14831749 -0.23366514]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.25533038 -0.1309299   0.06535509  0.13676658 -0.23213258]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.14387561 -0.0611854   0.03374499  0.07305229 -0.10265508]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.14387561 -0.0611854   0.03374499  0.07305229 -0.10265508]
  [FlaxMamba2] B (step) sample values: [-0.04501901  0.10642532 -0.06291444 -0.07085969  0.09362581]
  [FlaxMamba2] C (step) sample values: [-0.1756156  -0.22473119  0.13564219 -0.27447942 -0.11619244]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.52670574 -0.63007647 -0.38779998 -2.7909086  -0.42841786]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.0160817e-02 1.2463925e-02 1.0944351e-01 1.0678201e-04 4.9778506e-02]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9946625  0.99217755 0.95844585 0.99970204 0.9788998 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.14387561 -0.0611854   0.03374499  0.07305229 -0.10265508]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.58130157e-05  1.55582515e-04 -9.19742233e-05 -1.03589344e-04
  1.36870993e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.58130157e-05  1.55582515e-04 -9.19742233e-05 -1.03589344e-04
  1.36870993e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00150905 -0.03159207 -0.00635807 -0.00062638 -0.00059052]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.02738499 -0.01838643 -0.01821256 -0.01410857  0.02036906]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.38356695 -0.16985849  0.06532735  0.16674143 -0.23376632]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.38356695 -0.16985849  0.06532735  0.16674143 -0.23376632]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.09854288 -0.00702119  0.0026541  -0.04607595 -0.08867152]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.71570534 -0.060373    0.02323263 -0.31874755 -1.0103362 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.71570534 -0.060373    0.02323263 -0.31874755 -1.0103362 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.452722    2.8410141  -8.272071    0.17684914 -2.4450128 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.452722    2.8410141  -8.272071    0.17684914 -2.4450128 ]
  [Layer 40] Output shape after mixer: (1, 1, 1024)
  [Layer 40] Output sample values after mixer: [ 3.452722    2.8410141  -8.272071    0.17684914 -2.4450128 ]
  [Layer 40] Residual connection shape: (1, 1, 1024)
  [Layer 40] Residual connection sample values: [ 10.966543    2.4208503  15.430707  -19.16899    -7.3832045]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.20449814  0.04826578  0.29679197 -0.3532064  -0.13796662]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.20449814  0.04826578  0.29679197 -0.3532064  -0.13796662]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.20449814  0.04826578  0.29679197 -0.3532064  -0.13796662]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.73847103 -2.587778   -1.135452   -0.29522908  0.765553  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.73847103 -2.587778   -1.135452   -0.29522908  0.765553  ]
  [FlaxMamba2] xBC (step) sample values: [-0.31086007  0.5970675   2.306456   -0.09990326  0.2436097 ]
  [FlaxMamba2] dt (step) sample values: [-0.39706025 -0.7405911   1.3662088  -1.3397622   2.0631657 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.80119365 -0.5914106  -0.43994457 -0.31086007  0.6232047 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.0856225  -0.06622105  0.5115697   0.00973596 -0.05693216]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.11729974  0.05615444  0.5116322  -0.08297644 -0.06649178]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.055214    0.02886534  0.31986684 -0.03976793 -0.03214101]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.055214    0.02886534  0.31986684 -0.03976793 -0.03214101]
  [FlaxMamba2] B (step) sample values: [ 0.11156338  0.16866657 -0.07734534 -0.04748929  0.27497345]
  [FlaxMamba2] C (step) sample values: [-0.1510241  -0.05972187  0.00414855 -0.16005607 -0.21522115]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.0530885  -1.135641   -0.87189615 -1.5713016  -1.7430981 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04828309 0.10541841 0.3527761  0.03463164 0.51391006]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9504247  0.88717103 0.735221   0.94703734 0.40828264]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.055214    0.02886534  0.31986684 -0.03976793 -0.03214101]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00029742 -0.00044965  0.0002062   0.0001266  -0.00073305]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00029742 -0.00044965  0.0002062   0.0001266  -0.00073305]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 9.5265568e-07 -8.0916993e-03 -6.4311549e-03 -4.8471557e-06
 -5.4706070e-03]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01626322  0.0080471  -0.00112316 -0.02007733  0.00532636]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.08688771  0.04496889  0.40802    -0.07094468 -0.03578535]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.08688771  0.04496889  0.40802    -0.07094468 -0.03578535]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.04341734 -0.00813762 -0.1126512   0.00893771 -0.01869908]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.9775787  -0.24459884 -2.9233265   0.28190818 -0.54766744]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.9775787  -0.24459884 -2.9233265   0.28190818 -0.54766744]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 5.489595  -4.3193235 -5.8905616  0.8084123 -1.7891983]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 5.489595  -4.3193235 -5.8905616  0.8084123 -1.7891983]
  [Layer 41] Output shape after mixer: (1, 1, 1024)
  [Layer 41] Output sample values after mixer: [ 5.489595  -4.3193235 -5.8905616  0.8084123 -1.7891983]
  [Layer 41] Residual connection shape: (1, 1, 1024)
  [Layer 41] Residual connection sample values: [ 16.456139   -1.8984733   9.540146  -18.360577   -9.172402 ]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.2878041  -0.03567884  0.17838721 -0.32067573 -0.168792  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.2878041  -0.03567884  0.17838721 -0.32067573 -0.168792  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.2878041  -0.03567884  0.17838721 -0.32067573 -0.168792  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.83339566  0.26047006 -1.1101195  -1.0221593   0.01278008]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.83339566  0.26047006 -1.1101195  -1.0221593   0.01278008]
  [FlaxMamba2] xBC (step) sample values: [-0.03868053  1.281979    2.0525413   1.318295   -0.15741833]
  [FlaxMamba2] dt (step) sample values: [ 1.3994383  -0.50382817  0.7341838  -3.3921626  -0.8645378 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.8487252   0.09180145 -0.28390524 -0.03868053  0.8345112 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01125028  0.29179862 -0.43371075 -0.25719327 -0.05376787]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00962374  0.25603202 -0.42909116 -0.26093358 -0.09994096]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.00478872  0.14431517 -0.16920926 -0.11354113 -0.04747551]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00478872  0.14431517 -0.16920926 -0.11354113 -0.04747551]
  [FlaxMamba2] B (step) sample values: [-0.03057199  0.05327407 -0.21821277  0.08429447 -0.04786283]
  [FlaxMamba2] C (step) sample values: [ 0.02266621 -0.24276018 -0.24555773 -0.26012263 -0.2685517 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.2458453 -1.7473589 -3.3796544 -1.2264227 -1.3705136]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.36634985 0.08076885 0.25385025 0.00070607 0.03334695]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.43921548 0.8683745  0.4240406  0.9991344  0.9553262 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00478872  0.14431517 -0.16920926 -0.11354113 -0.04747551]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.3633841e-05 -9.3461153e-05  3.8282070e-04 -1.4788166e-04
  8.3967956e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.3633841e-05 -9.3461153e-05  3.8282070e-04 -1.4788166e-04
  8.3967956e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.6812747e-04 -1.4258761e-04  3.2089069e-04 -2.3499287e-04
 -4.1015490e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00018752  0.05755944 -0.0053115  -0.00859623 -0.01352553]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00673474  0.25486964 -0.23665735 -0.16383165 -0.07843488]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00673474  0.25486964 -0.23665735 -0.16383165 -0.07843488]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00170024  0.03749156  0.06511427  0.04431163 -0.0005044 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04201814  0.89098376  1.5931365   1.0983491  -0.00851521]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04201814  0.89098376  1.5931365   1.0983491  -0.00851521]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-4.0445127 -1.8879168  2.6282935  2.9734044  5.486159 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-4.0445127 -1.8879168  2.6282935  2.9734044  5.486159 ]
  [Layer 42] Output shape after mixer: (1, 1, 1024)
  [Layer 42] Output sample values after mixer: [-4.0445127 -1.8879168  2.6282935  2.9734044  5.486159 ]
  [Layer 42] Residual connection shape: (1, 1, 1024)
  [Layer 42] Residual connection sample values: [ 12.411626   -3.78639    12.16844   -15.387173   -3.6862435]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.1987412  -0.06636991  0.20413843 -0.24621688 -0.06000499]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.1987412  -0.06636991  0.20413843 -0.24621688 -0.06000499]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.1987412  -0.06636991  0.20413843 -0.24621688 -0.06000499]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.15999772  1.420113   -1.2107862   0.22589326 -1.3574313 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.15999772  1.420113   -1.2107862   0.22589326 -1.3574313 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.05096196 -0.57152855 -1.1794319  -0.3276123   0.62971497]
  [FlaxMamba2] dt (step) sample values: [-2.1053896  -0.45558143 -0.37249598 -0.05708495 -1.3194116 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.99983454  0.53693     0.31073657  0.05096196  0.27314812]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01606471  0.08178099  0.24335775 -0.06787948  0.10691625]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.00146968  0.02755126  0.21534261 -0.11570052  0.09860021]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.00073538  0.01396538  0.11921982 -0.05450733  0.05172864]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00073538  0.01396538  0.11921982 -0.05450733  0.05172864]
  [FlaxMamba2] B (step) sample values: [ 0.03266048  0.01914458 -0.19024613 -0.27521196  0.17194961]
  [FlaxMamba2] C (step) sample values: [ 0.14125822  0.17078581 -0.16252594 -0.2649971  -0.08626698]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-3.7045815 -2.655313  -8.210951  -2.2381823 -4.092597 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.007711   0.0510298  0.04351853 0.3376813  0.00034233]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9718381  0.8732791  0.69954264 0.46963838 0.99859995]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00073538  0.01396538  0.11921982 -0.05450733  0.05172864]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.85201742e-07  1.08559625e-07 -1.07879350e-06 -1.56059355e-06
  9.75042781e-07]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.85201742e-07  1.08559625e-07 -1.07879350e-06 -1.56059355e-06
  9.75042781e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00181218 -0.00020685 -0.00098025  0.00240919 -0.00190798]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00191061 -0.00413588 -0.01004437 -0.0071555  -0.00328084]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00312353  0.01889835  0.18659453 -0.09705886  0.08203939]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00312353  0.01889835  0.18659453 -0.09705886  0.08203939]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00022993  0.02161398 -0.05186404 -0.01219541 -0.02279131]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00496277  0.6250655  -1.2005819  -0.28429508 -0.549137  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00496277  0.6250655  -1.2005819  -0.28429508 -0.549137  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.3001509  -0.80335546 -3.7443488  -3.8203723  -5.2509303 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.3001509  -0.80335546 -3.7443488  -3.8203723  -5.2509303 ]
  [Layer 43] Output shape after mixer: (1, 1, 1024)
  [Layer 43] Output sample values after mixer: [-1.3001509  -0.80335546 -3.7443488  -3.8203723  -5.2509303 ]
  [Layer 43] Residual connection shape: (1, 1, 1024)
  [Layer 43] Residual connection sample values: [ 11.111475   -4.5897455   8.424091  -19.207544   -8.937174 ]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.16944207 -0.07237747  0.13319325 -0.28630808 -0.13795888]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.16944207 -0.07237747  0.13319325 -0.28630808 -0.13795888]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.16944207 -0.07237747  0.13319325 -0.28630808 -0.13795888]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.62485105 -0.42629537  0.12256883 -0.3294564  -0.06033679]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.62485105 -0.42629537  0.12256883 -0.3294564  -0.06033679]
  [FlaxMamba2] xBC (step) sample values: [ 0.97556025  0.6331688  -0.06999843 -1.9996171   0.20048632]
  [FlaxMamba2] dt (step) sample values: [ 0.52645856 -0.72081333 -0.56664383 -1.9193286  -0.5830165 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.0671846  -0.83548874 -0.20393051  0.97556025 -0.94732875]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.2000361  -0.13151781 -0.00762678  0.34989697  0.03445324]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.22152047 -0.18858568 -0.03635908  0.3367439   0.04108318]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.12297814 -0.08542796 -0.01784908  0.19645616  0.02096349]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.12297814 -0.08542796 -0.01784908  0.19645616  0.02096349]
  [FlaxMamba2] B (step) sample values: [ 0.05148114 -0.2778197  -0.2760663   0.00663525 -0.07149147]
  [FlaxMamba2] C (step) sample values: [ 0.22454354 -0.15241763 -0.14403056  0.14290138  0.18998511]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-4.6876054  -0.9752563  -0.82549465 -1.2937802  -0.49527767]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.16271313 0.02184999 0.0139963  0.00678504 0.00433664]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.46638912 0.9789161  0.98851264 0.99126005 0.9978545 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.12297814 -0.08542796 -0.01784908  0.19645616  0.02096349]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00103015 -0.00555922 -0.00552413  0.00013277 -0.00143056]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00103015 -0.00555922 -0.00552413  0.00013277 -0.00143056]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00104197 -0.00376423 -0.00357422 -0.00020491 -0.00175704]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00136379  0.0012613  -0.00064644 -0.00030704 -0.00016404]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.21235272 -0.14719896 -0.03166531  0.34110266  0.03626718]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.21235272 -0.14719896 -0.03166531  0.34110266  0.03626718]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.08642302  0.02478705 -0.00205937 -0.0470161  -0.00106112]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 2.3641124   0.62093204 -0.06538193 -1.2830132  -0.02839387]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 2.3641124   0.62093204 -0.06538193 -1.2830132  -0.02839387]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 8.253393   3.4294655  2.5730937 -3.9959507  4.6331677]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 8.253393   3.4294655  2.5730937 -3.9959507  4.6331677]
  [Layer 44] Output shape after mixer: (1, 1, 1024)
  [Layer 44] Output sample values after mixer: [ 8.253393   3.4294655  2.5730937 -3.9959507  4.6331677]
  [Layer 44] Residual connection shape: (1, 1, 1024)
  [Layer 44] Residual connection sample values: [ 19.364868  -1.16028   10.997185 -23.203495  -4.304006]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.3321783  -0.02148804  0.19819207 -0.39938325 -0.07479536]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.3321783  -0.02148804  0.19819207 -0.39938325 -0.07479536]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.3321783  -0.02148804  0.19819207 -0.39938325 -0.07479536]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.53468186 -3.581124   -0.6795896  -1.7705685  -1.0234472 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.53468186 -3.581124   -0.6795896  -1.7705685  -1.0234472 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.3444906  -2.6220813   0.8005515  -0.33559707  1.0507442 ]
  [FlaxMamba2] dt (step) sample values: [ 0.46064216  4.1335807   0.668486    2.3148756  -0.42938295]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.10074349 -0.88069165 -0.16219962  1.3444906   0.5763502 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.22841452 -0.2856188   0.14906333  0.07163597  0.1759159 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.22275351 -0.02756217  0.12677024  0.01563621  0.16516608]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.1237305  -0.01359118  0.06739742  0.00787923  0.08938754]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.1237305  -0.01359118  0.06739742  0.00787923  0.08938754]
  [FlaxMamba2] B (step) sample values: [-0.04733267  0.08634573 -0.01084569  0.05187568 -0.06055192]
  [FlaxMamba2] C (step) sample values: [-0.27755287 -0.12681735 -0.1876213   0.12412094 -0.03614543]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.3039274e+00 -3.9384812e-02 -6.8873577e+00 -8.0558503e-01
 -1.9935181e+03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00351579 0.77368236 0.01501947 0.0063494  0.01248909]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.9542618e-01 9.6998823e-01 9.0172613e-01 9.9489808e-01 1.5391036e-11]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.1237305  -0.01359118  0.06739742  0.00787923  0.08938754]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.0590207e-05  3.7561294e-05 -4.7179865e-06  2.2566461e-05
 -2.6340716e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.0590207e-05  3.7561294e-05 -4.7179865e-06  2.2566461e-05
 -2.6340716e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00162674 0.00092141 0.00125072 0.00033315 0.00157733]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00219983  0.0176127  -0.00367427 -0.00454768  0.00437482]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.31891957 -0.01766067  0.17124315  0.01590139  0.23636346]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.31891957 -0.01766067  0.17124315  0.01590139  0.23636346]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.06299464  0.00171331 -0.03914309 -0.00409568 -0.06394929]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.90021425  0.01836902 -0.50106514 -0.04965799 -0.92996186]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.90021425  0.01836902 -0.50106514 -0.04965799 -0.92996186]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.9713737  2.4295678 -2.8329682  4.1793714  1.1359969]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.9713737  2.4295678 -2.8329682  4.1793714  1.1359969]
  [Layer 45] Output shape after mixer: (1, 1, 1024)
  [Layer 45] Output sample values after mixer: [-0.9713737  2.4295678 -2.8329682  4.1793714  1.1359969]
  [Layer 45] Residual connection shape: (1, 1, 1024)
  [Layer 45] Residual connection sample values: [ 18.393494    1.2692878   8.164217  -19.024124   -3.1680093]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.28361246  0.0210489   0.13267379 -0.29860893 -0.04835053]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.28361246  0.0210489   0.13267379 -0.29860893 -0.04835053]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.28361246  0.0210489   0.13267379 -0.29860893 -0.04835053]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.5099944  -0.47204974 -0.57007194 -1.7128105   0.6189586 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.5099944  -0.47204974 -0.57007194 -1.7128105   0.6189586 ]
  [FlaxMamba2] xBC (step) sample values: [0.03051866 0.37947872 0.7516814  1.1784091  0.46432003]
  [FlaxMamba2] dt (step) sample values: [-0.94940037 -0.33427638  0.08288343 -1.405525    0.20355222]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.20801969  1.3816338   1.4706861   0.03051866 -0.1183005 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.09939244 -0.06938314  0.14808106 -0.2003197  -0.07477144]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.043942   -0.10670613  0.35096192 -0.19581836 -0.08002428]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.02148835 -0.05050921  0.2059623  -0.08835348 -0.03841202]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02148835 -0.05050921  0.2059623  -0.08835348 -0.03841202]
  [FlaxMamba2] B (step) sample values: [-0.10983773 -0.0347482   0.10846725  0.07812109 -0.10912637]
  [FlaxMamba2] C (step) sample values: [-0.01294988 -0.17481647 -0.03929583 -0.08845188  0.18329616]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.4426116  -0.9829804 -10.158994   -1.363838   -1.7559118]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00340819 0.01000264 0.00118499 0.00321745 0.01331667]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9950954  0.9902158  0.9880339  0.9956215  0.97688836]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02148835 -0.05050921  0.2059623  -0.08835348 -0.03841202]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.0441187e-06  2.5448326e-06 -7.9437505e-06 -5.7213065e-06
  7.9920210e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.0441187e-06  2.5448326e-06 -7.9437505e-06 -5.7213065e-06
  7.9920210e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.6687211e-03  2.0084548e-04 -3.5568351e-05  7.0459070e-04
 -8.6533494e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00269399 -0.00106914 -0.01145981  0.00152173  0.00322139]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02901978 -0.06294893  0.24086846 -0.10672178 -0.0438379 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02901978 -0.06294893  0.24086846 -0.10672178 -0.0438379 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00924707  0.01141447 -0.0496      0.02793087 -0.0176365 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.38681614  0.4439147  -1.6454592   0.9173546  -0.5789247 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.38681614  0.4439147  -1.6454592   0.9173546  -0.5789247 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-4.5323305 -1.8540281 -3.8667192 -1.6188958 -0.544197 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-4.5323305 -1.8540281 -3.8667192 -1.6188958 -0.544197 ]
  [Layer 46] Output shape after mixer: (1, 1, 1024)
  [Layer 46] Output sample values after mixer: [-4.5323305 -1.8540281 -3.8667192 -1.6188958 -0.544197 ]
  [Layer 46] Residual connection shape: (1, 1, 1024)
  [Layer 46] Residual connection sample values: [ 13.861163   -0.5847403   4.2974977 -20.64302    -3.7122064]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.17711562 -0.00779029  0.05608339 -0.2490116  -0.04746555]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.17711562 -0.00779029  0.05608339 -0.2490116  -0.04746555]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.17711562 -0.00779029  0.05608339 -0.2490116  -0.04746555]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.43162933  0.79359686 -1.6278747  -1.3287897   0.39395198]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.43162933  0.79359686 -1.6278747  -1.3287897   0.39395198]
  [FlaxMamba2] xBC (step) sample values: [-2.0535622  -0.35219088  0.55094457 -0.040139   -0.22797258]
  [FlaxMamba2] dt (step) sample values: [ 2.4339488  0.5867112 -1.1803321  2.9273853  2.503321 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.5188107  -1.1000143  -1.1328294  -2.0535622  -0.54382575]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.46819288 -0.05577802  0.10609502  0.00814431 -0.03760577]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.45526868 -0.04069471  0.10498113  0.0149421  -0.0395198 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.27857488 -0.0199334   0.0552433   0.00752686 -0.0193695 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.27857488 -0.0199334   0.0552433   0.00752686 -0.0193695 ]
  [FlaxMamba2] B (step) sample values: [-0.05718318  0.00722924 -0.11657017  0.02267827 -0.12639719]
  [FlaxMamba2] C (step) sample values: [-0.2281472  -0.24595347 -0.17162982 -0.260244   -0.24843803]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-5.7667141e+01 -2.2024069e+00 -3.8371372e+00 -4.6045512e-02
 -2.0699801e+00]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.43224084 0.00797581 0.00399714 0.28832272 0.0487451 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [1.4953226e-11 9.8258740e-01 9.8477942e-01 9.8681176e-01 9.0402216e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.27857488 -0.0199334   0.0552433   0.00752686 -0.0193695 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00688551  0.00087048 -0.01403638  0.00273072 -0.01521967]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00688551  0.00087048 -0.01403638  0.00273072 -0.01521967]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00688551  0.00087048 -0.01403638  0.00273072 -0.01521967]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-2.1171358e-03  1.5149133e-04 -4.1984374e-04 -5.7203619e-05
  1.4720697e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.4368605  -0.03125951  0.08663242  0.01180361 -0.0303752 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.4368605  -0.03125951  0.08663242  0.01180361 -0.0303752 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.07424382 -0.01708248 -0.02314555 -0.0032837  -0.00714672]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-2.1731055  -0.5532361  -0.68716145 -0.13963148 -0.24522471]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-2.1731055  -0.5532361  -0.68716145 -0.13963148 -0.24522471]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [10.484644  8.874974 28.541225 -8.5168   29.431152]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [10.484644  8.874974 28.541225 -8.5168   29.431152]
  [Layer 47] Output shape after mixer: (1, 1, 1024)
  [Layer 47] Output sample values after mixer: [10.484644  8.874974 28.541225 -8.5168   29.431152]
  [Layer 47] Residual connection shape: (1, 1, 1024)
  [Layer 47] Residual connection sample values: [ 24.345806   8.290234  32.838722 -29.15982   25.718946]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.24222577  0.08899305  0.34836102 -0.28294194  0.26478812]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.24222577  0.08899305  0.34836102 -0.28294194  0.26478812]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.24222577  0.08899305  0.34836102 -0.28294194  0.26478812]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.15617715 -1.0644215  -1.794654   -0.6182869   1.1093979 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.15617715 -1.0644215  -1.794654   -0.6182869   1.1093979 ]
  [FlaxMamba2] xBC (step) sample values: [-1.2684846   0.20816517  0.06620917  1.0872225   0.7849862 ]
  [FlaxMamba2] dt (step) sample values: [-0.65737706 -2.5026324  -2.898392   -2.1430688   3.1220376 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.07681827 -0.9858096  -0.16182798 -1.2684846   0.19765253]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [0.19817482 0.03188052 0.00333885 0.1281118  0.11890107]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.20213448  0.00136295 -0.00870034  0.04803367  0.03662568]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.11124718  0.00068194 -0.00433125  0.02459353  0.01864816]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.11124718  0.00068194 -0.00433125  0.02459353  0.01864816]
  [FlaxMamba2] B (step) sample values: [ 0.19456637 -0.08217968 -0.23625283 -0.01084862  0.07599132]
  [FlaxMamba2] C (step) sample values: [ 0.12263849 -0.11289036 -0.21512465 -0.03644456 -0.04205074]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.7303779  -7.389056   -3.3796544  -1.802826  -17.760078 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [5.9682573e-03 1.7593986e-05 3.5427260e-04 2.2842647e-03 1.1817496e+00]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.8972583e-01 9.9987000e-01 9.9880338e-01 9.9589032e-01 7.6743706e-10]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.11124718  0.00068194 -0.00433125  0.02459353  0.01864816]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.2918269e-04 -5.4563345e-05 -1.5686049e-04 -7.2029593e-06
  5.0454571e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.2918269e-04 -5.4563345e-05 -1.5686049e-04 -7.2029593e-06
  5.0454571e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-5.9213708e-05  3.9963200e-04  4.1407812e-04 -1.5156902e-04
  1.0143449e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0001743  -0.00033306  0.0001045   0.00083519  0.00104815]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.15805767  0.0006369  -0.00605603  0.0358157   0.02757229]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.15805767  0.0006369  -0.00605603  0.0358157   0.02757229]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01330435 -0.00017386  0.00154879 -0.00775432  0.02300317]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.6471579  -0.00947245  0.07990064 -0.35205808  1.4220808 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.6471579  -0.00947245  0.07990064 -0.35205808  1.4220808 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 13.951805  10.160037  16.712074  14.524573 -14.08997 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 13.951805  10.160037  16.712074  14.524573 -14.08997 ]
  [Layer 48] Output shape after mixer: (1, 1, 1024)
  [Layer 48] Output sample values after mixer: [ 13.951805  10.160037  16.712074  14.524573 -14.08997 ]
  [Layer 48] Residual connection shape: (1, 1, 1024)
  [Layer 48] Residual connection sample values: [ 38.29761   18.450272  49.550797 -14.635247  11.628977]
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.9687561   0.67423314  1.4340069  -0.33435062  0.30258107]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 1, 1024)
[Mamba2LMHeadModel] Final backbone norm output sample values: [ 0.9687561   0.67423314  1.4340069  -0.33435062  0.30258107]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 1, 50288)
[Mamba2LMHeadModel] Logits sample values: [11.906334   -0.01741498 -6.227387   -2.4497182  -0.0725814 ]
ript[Mamba2LMHeadModel] Forward pass input_ids shape: (1, 1)
[Mamba2LMHeadModel] input_ids sample values: [1122]
[Mamba2LMHeadModel] Embedding output shape: (1, 1, 1024)
[Mamba2LMHeadModel] Embedding sample values: [ 0.34106445  0.58203125  0.08282471 -0.00920868  0.0249176 ]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.23121028  0.50213534  0.06157378 -0.0053345   0.01581784]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.23121028  0.50213534  0.06157378 -0.0053345   0.01581784]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.23121028  0.50213534  0.06157378 -0.0053345   0.01581784]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.340464   -0.6199689  -0.33038384  0.1265388  -0.00069501]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.340464   -0.6199689  -0.33038384  0.1265388  -0.00069501]
  [FlaxMamba2] xBC (step) sample values: [-0.24756625  0.08365326 -1.0692465   0.04785587 -0.49366036]
  [FlaxMamba2] dt (step) sample values: [ 0.15851447  0.09996233  0.15400796  0.21149535 -0.07929847]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.07741071  0.64639604  0.45542032 -0.24756625 -0.66668236]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.05821159 -0.04727565  0.00247668  0.02715877 -0.06636553]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.10078362 -0.0548669   0.11520862 -0.18231389 -0.2635091 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.052929   -0.02668105  0.0609189  -0.0828703  -0.11449504]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.052929   -0.02668105  0.0609189  -0.0828703  -0.11449504]
  [FlaxMamba2] B (step) sample values: [-0.24286757  0.13257934  0.05395161  0.6474254  -0.01231388]
  [FlaxMamba2] C (step) sample values: [-0.25248817  0.17689788  0.09877574 -0.24809572 -0.08637919]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.4383634 -1.0010935 -1.2128745 -1.1529616 -1.4844131]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0649894  0.03740371 0.02834448 0.03214708 0.02075742]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.97191304 0.9632478  0.9662059  0.9636141  0.9696573 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.052929   -0.02668105  0.0609189  -0.0828703  -0.11449504]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-8.3542155e-04  4.5604951e-04  1.8558402e-04  2.2270291e-03
 -4.2357558e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-8.3542155e-04  4.5604951e-04  1.8558402e-04  2.2270291e-03
 -4.2357558e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.02009863 -0.00340519 -0.00066849  0.04986446 -0.00070032]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01534192 -0.0089769   0.04240721 -0.07042938 -0.05288873]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.10611844 -0.05473655  0.1468869  -0.21255708 -0.24925484]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.10611844 -0.05473655  0.1468869  -0.21255708 -0.24925484]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-1.50189195e-02  1.18700592e-02 -2.02922914e-02 -1.42980944e-02
  8.65873808e-05]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.16998723  0.11088093 -0.18942955 -0.10944644  0.00339367]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.16998723  0.11088093 -0.18942955 -0.10944644  0.00339367]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.64866364 -1.0102545   0.68187356 -0.7821803  -0.9794692 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.64866364 -1.0102545   0.68187356 -0.7821803  -0.9794692 ]
  [Layer 1] Output shape after mixer: (1, 1, 1024)
  [Layer 1] Output sample values after mixer: [ 0.64866364 -1.0102545   0.68187356 -0.7821803  -0.9794692 ]
  [Layer 1] Residual connection shape: (1, 1, 1024)
  [Layer 1] Residual connection sample values: [ 0.9897281  -0.42822325  0.76469827 -0.791389   -0.9545516 ]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.31433818 -0.114218    0.18825908 -0.26430592 -0.2760016 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.31433818 -0.114218    0.18825908 -0.26430592 -0.2760016 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.31433818 -0.114218    0.18825908 -0.26430592 -0.2760016 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 2.5369096  -0.67910016 -1.5234622  -0.04696679 -2.5148716 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 2.5369096  -0.67910016 -1.5234622  -0.04696679 -2.5148716 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.4978831  -0.15070195  1.5882255   0.52490085  2.8400037 ]
  [FlaxMamba2] dt (step) sample values: [-0.6146929   0.16174614  0.28908288  0.14976838  1.0552171 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.5496252   0.06908027  0.5476473   0.4978831   0.08866026]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.07565862  0.15904006 -0.48202187  0.24736546 -0.05454263]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.08498937  0.12911758 -0.5938383   0.10332249 -0.05116472]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.04068997  0.06872085 -0.21126072  0.05432776 -0.02492805]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04068997  0.06872085 -0.21126072  0.05432776 -0.02492805]
  [FlaxMamba2] B (step) sample values: [-0.06755441 -0.04707636  0.13721703  0.11836713 -0.03253062]
  [FlaxMamba2] C (step) sample values: [-0.03991066  0.19879426 -0.17541416 -0.22334835 -0.16824543]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-12.692555   -19.429585    -0.22886811  -2.10566     -5.0388985 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02755985 0.04097678 0.03275352 0.07244315 0.1548923 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7048255  0.4510569  0.9925318  0.858524   0.45818305]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04068997  0.06872085 -0.21126072  0.05432776 -0.02492805]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 7.5756165e-05  5.2791882e-05 -1.5387651e-04 -1.3273805e-04
  3.6480156e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 7.5756165e-05  5.2791882e-05 -1.5387651e-04 -1.3273805e-04
  3.6480156e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 3.0675222e-04  3.4724631e-05 -1.7604610e-04 -2.5797240e-04
  1.3515035e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00111043 -0.00133652 -0.00647689 -0.00760299 -0.00122621]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0260146   0.04447464 -0.14730893  0.02861335 -0.01784391]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0260146   0.04447464 -0.14730893  0.02861335 -0.01784391]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.06115841 -0.01016208  0.04016039 -0.00065616  0.00335766]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.10868729 -0.02538889  0.09081557 -0.00097703  0.00872553]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.10868729 -0.02538889  0.09081557 -0.00097703  0.00872553]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.4951371  -0.6376217   0.52922064  0.6871312  -0.25847474]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.4951371  -0.6376217   0.52922064  0.6871312  -0.25847474]
  [Layer 2] Output shape after mixer: (1, 1, 1024)
  [Layer 2] Output sample values after mixer: [-0.4951371  -0.6376217   0.52922064  0.6871312  -0.25847474]
  [Layer 2] Residual connection shape: (1, 1, 1024)
  [Layer 2] Residual connection sample values: [ 0.494591   -1.065845    1.2939188  -0.10425776 -1.2130263 ]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.22753692 -0.41146868  0.4449446  -0.05133589 -0.53263044]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.22753692 -0.41146868  0.4449446  -0.05133589 -0.53263044]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.22753692 -0.41146868  0.4449446  -0.05133589 -0.53263044]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.51465803 -5.148572    0.17350402 -2.9942138   0.32843512]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.51465803 -5.148572    0.17350402 -2.9942138   0.32843512]
  [FlaxMamba2] xBC (step) sample values: [-3.0346487  -1.2019322  -1.2823616   0.62731314  0.12200184]
  [FlaxMamba2] dt (step) sample values: [ 0.20604618 -0.02730851 -1.1996335   0.18268952  0.11263327]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.307889   -0.28603148  1.6465372  -3.0346487  -1.0469126 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.26223394 -0.20008121  0.4122843  -0.08961949  0.34315413]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.30709478 -0.27784002  0.36116737 -0.13625035  0.27632064]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.13015415 -0.11974444  0.21284424 -0.0634913   0.15712805]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.13015415 -0.11974444  0.21284424 -0.0634913   0.15712805]
  [FlaxMamba2] B (step) sample values: [-0.25051373  0.21846507  0.05456857  0.06772868 -0.23391373]
  [FlaxMamba2] C (step) sample values: [-0.27810127  0.36566496  0.19395784  0.28562433  0.17225756]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-20.926485    -0.880345    -0.67350245  -0.6461216   -0.27258503]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.5409634e-02 4.7113062e-03 1.3572663e-05 6.2795826e-03 1.1522586e-02]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7243581 0.995861  0.9999909 0.9959508 0.996864 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.13015415 -0.11974444  0.21284424 -0.0634913   0.15712805]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00050244 -0.00043816 -0.00010944 -0.00013584  0.00046914]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00050244 -0.00043816 -0.00010944 -0.00013584  0.00046914]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-7.6647208e-05 -1.8321220e-03 -2.2678199e-04  1.3829006e-03
 -1.6942876e-03]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00656065 -0.00558579  0.02434526 -0.00631851  0.00195412]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.08583657 -0.09059309  0.17544468 -0.05139137  0.11350027]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.08583657 -0.09059309  0.17544468 -0.05139137  0.11350027]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02764996  0.00269321  0.01653726  0.00733807  0.02167233]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03722841  0.00323513  0.01569296  0.0077491   0.03401156]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03722841  0.00323513  0.01569296  0.0077491   0.03401156]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.3090482  -0.74413556 -0.04291361  0.6568106  -0.13412972]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.3090482  -0.74413556 -0.04291361  0.6568106  -0.13412972]
  [Layer 3] Output shape after mixer: (1, 1, 1024)
  [Layer 3] Output sample values after mixer: [ 0.3090482  -0.74413556 -0.04291361  0.6568106  -0.13412972]
  [Layer 3] Residual connection shape: (1, 1, 1024)
  [Layer 3] Residual connection sample values: [ 0.8036392 -1.8099806  1.2510053  0.5525528 -1.347156 ]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.23656794 -0.46143973  0.30024484  0.17293982 -0.37313917]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.23656794 -0.46143973  0.30024484  0.17293982 -0.37313917]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.23656794 -0.46143973  0.30024484  0.17293982 -0.37313917]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 1.5885538  -0.33556643  0.18044552  0.56189483  0.7732611 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 1.5885538  -0.33556643  0.18044552  0.56189483  0.7732611 ]
  [FlaxMamba2] xBC (step) sample values: [-0.7614499   0.9857316  -0.25819477 -0.8367508   1.228408  ]
  [FlaxMamba2] dt (step) sample values: [0.30539528 0.5689141  0.9393395  0.6974622  0.31403494]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.53104764 -1.043289   -0.22336185 -0.7614499  -0.46391752]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.09492309 -0.06996421  0.05867508 -0.38925296  0.2850787 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.11697204 -0.05740622  0.01826981 -0.45395023  0.5441119 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.06190274 -0.02787947  0.00921835 -0.17632425  0.34429684]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06190274 -0.02787947  0.00921835 -0.17632425  0.34429684]
  [FlaxMamba2] B (step) sample values: [-0.2671268  -0.02638283 -0.12513049 -0.039223    0.0561401 ]
  [FlaxMamba2] C (step) sample values: [-0.26939535 -0.18445863 -0.23009443 -0.06315562 -0.13785155]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.49070406 -0.5047996  -0.6491257  -0.5552266  -0.46572492]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06050156 0.09859584 0.20103657 0.07787386 0.4285549 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.970748   0.9514471  0.87765825 0.9576838  0.8190676 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06190274 -0.02787947  0.00921835 -0.17632425  0.34429684]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0004466e-03 -9.8809309e-05 -4.6864030e-04 -1.4689847e-04
  2.1025662e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0004466e-03 -9.8809309e-05 -4.6864030e-04 -1.4689847e-04
  2.1025662e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.03311561 -0.00216428  0.00010483  0.00219402 -0.00092481]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.03789095  0.00544064  0.01344995 -0.08798949  0.12740293]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.07895416 -0.01305321  0.01956494 -0.20495427  0.3557924 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.07895416 -0.01305321  0.01956494 -0.20495427  0.3557924 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.10415278  0.00182606  0.00192403 -0.0733461   0.1882445 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.19994931  0.00376478  0.00331283 -0.13907263  0.25990734]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.19994931  0.00376478  0.00331283 -0.13907263  0.25990734]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.02160163 -0.00232467 -0.00243368  0.04727323 -0.49065104]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.02160163 -0.00232467 -0.00243368  0.04727323 -0.49065104]
  [Layer 4] Output shape after mixer: (1, 1, 1024)
  [Layer 4] Output sample values after mixer: [ 0.02160163 -0.00232467 -0.00243368  0.04727323 -0.49065104]
  [Layer 4] Residual connection shape: (1, 1, 1024)
  [Layer 4] Residual connection sample values: [ 0.8252408  -1.8123053   1.2485716   0.59982604 -1.837807  ]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.33474725 -0.6197695   0.37320074  0.24259321 -0.7072168 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.33474725 -0.6197695   0.37320074  0.24259321 -0.7072168 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.33474725 -0.6197695   0.37320074  0.24259321 -0.7072168 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.42364514 -0.80012    -0.94891405 -1.5972012  -0.41300002]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.42364514 -0.80012    -0.94891405 -1.5972012  -0.41300002]
  [FlaxMamba2] xBC (step) sample values: [-0.55207294 -1.4812305  -0.7657008  -2.0379813  -1.996762  ]
  [FlaxMamba2] dt (step) sample values: [0.72097373 0.85299796 0.03199071 1.3515228  1.06499   ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.01039147 -1.2361823  -0.38902977 -0.55207294 -1.2028353 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.38837734  0.1715818  -0.22907746  0.16938922  0.03012809]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.45173183 -0.0697512  -0.23642838  0.19625995  0.04106864]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.1757007  -0.03365979 -0.10430432  0.10772868  0.02095592]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.1757007  -0.03365979 -0.10430432  0.10772868  0.02095592]
  [FlaxMamba2] B (step) sample values: [ 0.29588592  0.02506821 -0.21417807 -0.09249736 -0.01885197]
  [FlaxMamba2] C (step) sample values: [-0.0486851  -0.09624461 -0.27798206 -0.2784429  -0.00369665]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.07591622 -0.53187454 -0.04695368 -1.4938657  -3.6258397 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.30068612 0.03254801 0.03799614 0.05323573 0.04634902]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9774316  0.9828375  0.9982175  0.92355305 0.84530807]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.1757007  -0.03365979 -0.10430432  0.10772868  0.02095592]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01563188 -0.00132437  0.01131519  0.00488671  0.00099596]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01563188 -0.00132437  0.01131519  0.00488671  0.00099596]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.03212445 -0.01082213  0.5114752   0.05334995  0.00770236]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.620681   -0.6871866  -0.5735009  -0.1906746  -0.20590521]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.8679432  -0.7345558  -0.72028756 -0.03906886 -0.1764141 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.8679432  -0.7345558  -0.72028756 -0.03906886 -0.1764141 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.22222133  0.18219708  0.19076458  0.01050662  0.02901195]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02518569  0.0218238   0.04678588  0.00283184  0.00849952]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02518569  0.0218238   0.04678588  0.00283184  0.00849952]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.4745329  -0.34930786  0.31072837 -0.11316138  0.1252745 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.4745329  -0.34930786  0.31072837 -0.11316138  0.1252745 ]
  [Layer 5] Output shape after mixer: (1, 1, 1024)
  [Layer 5] Output sample values after mixer: [-0.4745329  -0.34930786  0.31072837 -0.11316138  0.1252745 ]
  [Layer 5] Residual connection shape: (1, 1, 1024)
  [Layer 5] Residual connection sample values: [ 0.3507079  -2.1616132   1.5593      0.48666465 -1.7125325 ]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.1227208  -0.6248728   0.42531183  0.16326103 -0.5353768 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.1227208  -0.6248728   0.42531183  0.16326103 -0.5353768 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.1227208  -0.6248728   0.42531183  0.16326103 -0.5353768 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.8779175   0.79866517 -1.3955196  -3.5318108  -0.8403782 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.8779175   0.79866517 -1.3955196  -3.5318108  -0.8403782 ]
  [FlaxMamba2] xBC (step) sample values: [-1.2679706   2.4123802  -0.05197802 -1.8077352   0.6539407 ]
  [FlaxMamba2] dt (step) sample values: [1.117077  1.9524779 1.3953707 0.8108147 0.9573249]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.79676634  0.8933227   0.8282191  -1.2679706   0.12279274]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.2137313  -0.09183685 -0.15113789 -0.3396793   0.10217348]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.2609725  -0.07784455 -0.0699001  -0.3513599   0.24035707]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.11355557 -0.03740809 -0.03372904 -0.14513016  0.13455229]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.11355557 -0.03740809 -0.03372904 -0.14513016  0.13455229]
  [FlaxMamba2] B (step) sample values: [ 0.06121562  0.04062602 -0.26784298 -0.01707978  0.5991086 ]
  [FlaxMamba2] C (step) sample values: [-0.27449387  0.10363678 -0.27786008 -0.01603762  0.36202914]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.5109995  -0.28622514 -0.5421001  -0.39544863 -0.5985869 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.40114456 0.62500376 0.2925608  0.28872207 0.23105213]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.81465983 0.83619636 0.85334    0.89210206 0.8708332 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.11355557 -0.03740809 -0.03372904 -0.14513016  0.13455229]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00278851 -0.0018506   0.01220084  0.00077802 -0.02729071]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00278851 -0.0018506   0.01220084  0.00077802 -0.02729071]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00972814 -0.00791462  0.02485469  0.0051679  -0.02120186]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02421268 -0.01410712 -0.00241252 -0.02280732 -0.00137951]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.1544666  -0.05701607 -0.04110141 -0.18927889  0.15295868]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.1544666  -0.05701607 -0.04110141 -0.18927889  0.15295868]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03847221 -0.03140619  0.01138714  0.01899906 -0.03874999]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05107712 -0.03990144  0.01375564  0.02822628 -0.04189711]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.05107712 -0.03990144  0.01375564  0.02822628 -0.04189711]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.2776112  1.7629772  0.6213624 -0.5008625 -1.2138625]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.2776112  1.7629772  0.6213624 -0.5008625 -1.2138625]
  [Layer 6] Output shape after mixer: (1, 1, 1024)
  [Layer 6] Output sample values after mixer: [-0.2776112  1.7629772  0.6213624 -0.5008625 -1.2138625]
  [Layer 6] Residual connection shape: (1, 1, 1024)
  [Layer 6] Residual connection sample values: [ 0.07309669 -0.39863598  2.1806624  -0.01419783 -2.926395  ]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.02254466 -0.09985939  0.53047395 -0.00442004 -0.782708  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.02254466 -0.09985939  0.53047395 -0.00442004 -0.782708  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.02254466 -0.09985939  0.53047395 -0.00442004 -0.782708  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-3.0748668 -2.2166615 -0.9602417 -1.1181065 -1.6599218]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-3.0748668 -2.2166615 -0.9602417 -1.1181065 -1.6599218]
  [FlaxMamba2] xBC (step) sample values: [-3.2949913   0.18728057  2.0918121   0.8989597  -2.072615  ]
  [FlaxMamba2] dt (step) sample values: [-0.60417014  1.4025387   1.3876868  -0.8342865   1.0508982 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.0369145  -2.6750462  -0.25964287 -3.2949913  -1.628478  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.68260163  0.02266353  0.16384353  0.07201584  0.03292222]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.716232   -0.04862554  0.03286208  0.08048446  0.03017755]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.235084   -0.02372178  0.016701    0.0418608   0.01531643]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.235084   -0.02372178  0.016701    0.0418608   0.01531643]
  [FlaxMamba2] B (step) sample values: [-0.00444664  0.08456763  0.0234291  -0.00685815 -0.05732225]
  [FlaxMamba2] C (step) sample values: [-0.00377918  0.25462034 -0.05554552 -0.13894905 -0.05484143]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-6.5957151e-02 -4.5478220e+00 -5.8281250e+00 -4.2033669e-01
 -1.9005252e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.30209714 0.12835562 0.13819608 0.06289495 0.4763375 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.98027176 0.5578091  0.4468984  0.9739093  0.99909514]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.235084   -0.02372178  0.016701    0.0418608   0.01531643]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00031579 -0.00600584 -0.00166389  0.00048705  0.00407092]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00031579 -0.00600584 -0.00166389  0.00048705  0.00407092]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.09453347  0.00169965 -0.01302671  0.01264473  0.05502047]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.14667147 -0.09141099 -0.06871168 -0.02690397  0.01630863]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.6917263  -0.14641121 -0.02998953  0.07015253  0.05182059]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.6917263  -0.14641121 -0.02998953  0.07015253  0.05182059]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.09391824  0.03189107  0.00797192 -0.01932419 -0.01374333]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04914596  0.02014034  0.00301868 -0.00886355 -0.01379531]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04914596  0.02014034  0.00301868 -0.00886355 -0.01379531]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.3522621   0.07083283  0.21407326  0.08819127 -0.22920008]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.3522621   0.07083283  0.21407326  0.08819127 -0.22920008]
  [Layer 7] Output shape after mixer: (1, 1, 1024)
  [Layer 7] Output sample values after mixer: [-0.3522621   0.07083283  0.21407326  0.08819127 -0.22920008]
  [Layer 7] Residual connection shape: (1, 1, 1024)
  [Layer 7] Residual connection sample values: [-0.27916542 -0.32780313  2.3947356   0.07399344 -3.155595  ]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.10571928 -0.09292924  0.63439935  0.0272909  -1.0014445 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.10571928 -0.09292924  0.63439935  0.0272909  -1.0014445 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.10571928 -0.09292924  0.63439935  0.0272909  -1.0014445 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.06415365 -2.3208864  -3.2786613   0.80608803 -5.5470653 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.06415365 -2.3208864  -3.2786613   0.80608803 -5.5470653 ]
  [FlaxMamba2] xBC (step) sample values: [-0.44828343 -1.3996747   0.5601723   1.2427435   1.0322113 ]
  [FlaxMamba2] dt (step) sample values: [2.8212688 0.1471034 2.238264  2.0797071 1.6272804]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5381477  -1.8329356  -2.0454454  -0.44828343  0.30097488]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.26128972  0.25313696 -0.05551494  0.13102973  0.12264091]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.3386823   0.33419165  0.01083027  0.0341059   0.06007987]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.14093572  0.19475983  0.00544446  0.01734372  0.03094206]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.14093572  0.19475983  0.00544446  0.01734372  0.03094206]
  [FlaxMamba2] B (step) sample values: [-0.05137068 -0.13658594  0.08124317 -0.11217058 -0.06515442]
  [FlaxMamba2] C (step) sample values: [-0.22775029 -0.01696007 -0.03964333  0.05161625 -0.07145373]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6851114  -0.13800453 -0.41180432 -0.26783535 -0.12443344]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.27710184 1.672473   1.5270547  1.5868887  2.7893445 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8270868  0.7938912  0.53320587 0.6537535  0.70674336]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.14093572  0.19475983  0.00544446  0.01734372  0.03094206]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00200621  0.00533417 -0.00317283  0.00438066  0.00254451]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00200621  0.00533417 -0.00317283  0.00438066  0.00254451]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0028424  -0.01422329  0.00208963 -0.0149476   0.0075041 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.09838222  0.02064324  0.0490521  -0.02630608  0.0105595 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.62920445  0.75418925  0.06955819  0.03901756  0.12710011]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.62920445  0.75418925  0.06955819  0.03901756  0.12710011]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02083006 -0.15649843 -0.0082809   0.0217417  -0.00273816]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00551349 -0.02186431 -0.00356317  0.00796743 -0.0006881 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00551349 -0.02186431 -0.00356317  0.00796743 -0.0006881 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.19193871  0.42358816 -0.28516796 -0.6248461  -0.07498471]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.19193871  0.42358816 -0.28516796 -0.6248461  -0.07498471]
  [Layer 8] Output shape after mixer: (1, 1, 1024)
  [Layer 8] Output sample values after mixer: [-0.19193871  0.42358816 -0.28516796 -0.6248461  -0.07498471]
  [Layer 8] Residual connection shape: (1, 1, 1024)
  [Layer 8] Residual connection sample values: [-0.47110415  0.09578502  2.1095676  -0.55085266 -3.2305799 ]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.16179869  0.02542355  0.53608465 -0.18969005 -0.96642065]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.16179869  0.02542355  0.53608465 -0.18969005 -0.96642065]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.16179869  0.02542355  0.53608465 -0.18969005 -0.96642065]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.6542969  -1.5938184  -1.0239933   0.09400395 -1.0042385 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.6542969  -1.5938184  -1.0239933   0.09400395 -1.0042385 ]
  [FlaxMamba2] xBC (step) sample values: [ 3.83316     0.49083087 -2.2037263  -2.9841218   1.5937939 ]
  [FlaxMamba2] dt (step) sample values: [2.024949  3.2798314 1.229052  2.8115861 1.2366997]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.9979417  2.839903  -0.7172392  3.83316    2.1030085]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.7581372   0.04627208 -0.35919917 -0.10922946  0.19574551]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-1.0115552   0.13678722 -0.36336482 -0.10250415  0.17708401]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.2697571   0.07306401 -0.14903237 -0.0486276   0.09636126]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.2697571   0.07306401 -0.14903237 -0.0486276   0.09636126]
  [FlaxMamba2] B (step) sample values: [-0.06408443 -0.04480287  0.08027268 -0.11257239  0.17812923]
  [FlaxMamba2] C (step) sample values: [-0.11412061 -0.25989717 -0.05915365 -0.09535597 -0.01760147]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17008033 -0.11351943 -0.10539922 -0.5864362  -0.14965628]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [2.5253553 4.1021705 3.0649192 1.5601391 1.6444045]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.6508258  0.6277106  0.7239448  0.40054786 0.7818476 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.2697571   0.07306401 -0.14903237 -0.0486276   0.09636126]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0436564   0.03052117 -0.05468436  0.07668797 -0.12134742]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0436564   0.03052117 -0.05468436  0.07668797 -0.12134742]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.03205084  0.05695069 -0.31421864  0.24561241 -0.40935326]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.14675777  0.0025922  -0.01311822 -0.03252477  0.00805662]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.86956346  0.19836494 -0.41244575 -0.16282089  0.2662536 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.86956346  0.19836494 -0.41244575 -0.16282089  0.2662536 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.23092364 -0.05338239  0.11160391 -0.00801234 -0.07168752]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04315198 -0.01859307  0.0259926  -0.0021406  -0.01922759]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04315198 -0.01859307  0.0259926  -0.0021406  -0.01922759]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.32736483  0.73737156 -0.3894721   0.3172964  -0.3077519 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.32736483  0.73737156 -0.3894721   0.3172964  -0.3077519 ]
  [Layer 9] Output shape after mixer: (1, 1, 1024)
  [Layer 9] Output sample values after mixer: [-0.32736483  0.73737156 -0.3894721   0.3172964  -0.3077519 ]
  [Layer 9] Residual connection shape: (1, 1, 1024)
  [Layer 9] Residual connection sample values: [-0.79846895  0.8331566   1.7200955  -0.23355627 -3.5383317 ]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.2813747   0.22430275  0.45198756 -0.08095965 -1.0556239 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.2813747   0.22430275  0.45198756 -0.08095965 -1.0556239 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.2813747   0.22430275  0.45198756 -0.08095965 -1.0556239 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.413458   -4.3577166  -0.62031525  0.29070517 -0.39333534]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-2.413458   -4.3577166  -0.62031525  0.29070517 -0.39333534]
  [FlaxMamba2] xBC (step) sample values: [ 1.6903932  3.901986  -4.214313   3.6111662 -1.4954411]
  [FlaxMamba2] dt (step) sample values: [-0.9012526   0.5998363   0.47372705 -2.290735   -1.6582397 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.1222445 -1.1175879  1.5411758  1.6903932 -2.3390756]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.25582865 -0.45764792  0.7924273   0.83094084  0.25079066]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.08554056 -0.48158896  0.75446343  1.4349447   0.29967982]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.04459846 -0.18390775  0.51314867  1.1589627   0.17212537]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04459846 -0.18390775  0.51314867  1.1589627   0.17212537]
  [FlaxMamba2] B (step) sample values: [ 0.1650486  -0.07400414 -0.05003659 -0.14393507  0.04596134]
  [FlaxMamba2] C (step) sample values: [-0.23435582  0.00066381 -0.17312962 -0.16123363 -0.08038711]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.08535489 -0.07711172 -0.08452541 -0.0546804  -0.06966463]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.78602016 0.16229406 0.14178126 0.2653437  0.13516721]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9351104  0.9875632  0.9880874  0.98559564 0.9906278 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04459846 -0.18390775  0.51314867  1.1589627   0.17212537]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00578583 -0.00259424 -0.00175405 -0.00504568  0.00161119]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00578583 -0.00259424 -0.00175405 -0.00504568  0.00161119]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.02271923 -0.47554788 -0.05177062  0.2726362   0.10143522]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.7039496   0.06942481  0.84210247  6.8627586   0.01478739]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.48679328 -0.8260483   3.3406968  12.505914    0.85289043]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.48679328 -0.8260483   3.3406968  12.505914    0.85289043]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.09651692  0.04552031 -0.7246983   2.080139   -0.13516656]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00502187  0.00506309 -0.08839497  0.19514613 -0.01537203]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00502187  0.00506309 -0.08839497  0.19514613 -0.01537203]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.27666813 -0.80919766 -0.80778456  0.0725465   0.5495801 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.27666813 -0.80919766 -0.80778456  0.0725465   0.5495801 ]
  [Layer 10] Output shape after mixer: (1, 1, 1024)
  [Layer 10] Output sample values after mixer: [ 0.27666813 -0.80919766 -0.80778456  0.0725465   0.5495801 ]
  [Layer 10] Residual connection shape: (1, 1, 1024)
  [Layer 10] Residual connection sample values: [-0.5218008   0.02395892  0.91231096 -0.16100977 -2.9887516 ]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.1253729   0.00467067  0.1725149  -0.04224308 -0.6355654 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1253729   0.00467067  0.1725149  -0.04224308 -0.6355654 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.1253729   0.00467067  0.1725149  -0.04224308 -0.6355654 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.4320825 -2.4037142 -4.4416223  2.9085984 -3.8444774]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.4320825 -2.4037142 -4.4416223  2.9085984 -3.8444774]
  [FlaxMamba2] xBC (step) sample values: [ 0.24249028 -0.55461645 -2.372851    0.30811986 -0.14764696]
  [FlaxMamba2] dt (step) sample values: [-3.581553   -2.946997   -2.2054815  -0.05953487  0.04797877]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6484644   0.20363046  0.05245996  0.24249028 -0.06555793]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.07434019  0.09025238  0.6147379  -0.05032375 -0.38340825]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.07214418  0.2814145   0.6386637   0.05709812 -0.268418  ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.03737272  0.16037616  0.4179743   0.02936389 -0.11630432]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03737272  0.16037616  0.4179743   0.02936389 -0.11630432]
  [FlaxMamba2] B (step) sample values: [-0.2784179  -0.02352233 -0.04885778  0.17345814  0.01200002]
  [FlaxMamba2] C (step) sample values: [-0.07158734 -0.20918185  0.03072079 -0.04016998 -0.21545842]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.25934154 -0.12614636 -0.10356269 -0.23775288 -0.43051487]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00636833 0.00382538 0.0178639  0.5579426  0.7456369 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9983498  0.99951756 0.99815166 0.8757694  0.7254176 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03737272  0.16037616  0.4179743   0.02936389 -0.11630432]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.62639213e-05 -5.59835325e-06 -1.16282345e-05  4.12833288e-05
  2.85602391e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.62639213e-05 -5.59835325e-06 -1.16282345e-05  4.12833288e-05
  2.85602391e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.18169308  0.01208091  0.01985723 -0.0785183   0.10471386]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [0.38174018 0.3759478  0.34199202 0.19225746 0.49940306]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.26386124 -0.12990174 -0.9763591   0.09963952  0.86624366]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.26386124 -0.12990174 -0.9763591   0.09963952  0.86624366]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.07284387  0.0258821   0.05047711  0.27481937 -0.06976655]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00438108  0.01152584  0.04032611  0.0412697  -0.01222884]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00438108  0.01152584  0.04032611  0.0412697  -0.01222884]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.08242333 -0.15556325 -0.19408935  0.18315159 -0.18651481]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.08242333 -0.15556325 -0.19408935  0.18315159 -0.18651481]
  [Layer 11] Output shape after mixer: (1, 1, 1024)
  [Layer 11] Output sample values after mixer: [ 0.08242333 -0.15556325 -0.19408935  0.18315159 -0.18651481]
  [Layer 11] Residual connection shape: (1, 1, 1024)
  [Layer 11] Residual connection sample values: [-0.4393775  -0.13160433  0.7182216   0.02214181 -3.1752665 ]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.0898077  -0.02142954  0.10694353  0.00513238 -0.5491681 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0898077  -0.02142954  0.10694353  0.00513238 -0.5491681 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.0898077  -0.02142954  0.10694353  0.00513238 -0.5491681 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.89841914 -2.6728392   0.9065321  -0.96779144 -1.1444912 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.89841914 -2.6728392   0.9065321  -0.96779144 -1.1444912 ]
  [FlaxMamba2] xBC (step) sample values: [-0.0515685   2.4704235   1.4103124   0.35054418 -0.1480933 ]
  [FlaxMamba2] dt (step) sample values: [-0.17479195 -0.66919875  1.5198932  -0.07884135  0.1532221 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.28649288 -0.16463476  1.2160035  -0.0515685   1.4184653 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.31442815 -0.11068437 -0.05496839 -0.12090592  0.55522436]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.24722844 -0.94515705 -0.11972669 -0.16512589  0.38859838]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.13881734 -0.2645115  -0.056284   -0.07576176  0.23158336]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.13881734 -0.2645115  -0.056284   -0.07576176  0.23158336]
  [FlaxMamba2] B (step) sample values: [ 0.23956747  0.01111723  0.03702336  0.64454603 -0.06035637]
  [FlaxMamba2] C (step) sample values: [-0.24137527 -0.259958   -0.27608225 -0.27032506 -0.27846137]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.16087165 -0.14748003 -0.27125728 -0.11553253 -0.09015273]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.88230157 0.33453003 2.3651226  1.5082097  0.08090682]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.86767566 0.9518608  0.5264722  0.84008914 0.9927326 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.13881734 -0.2645115  -0.056284   -0.07576176  0.23158336]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.02934192  0.00136162  0.00453458  0.07894319 -0.00739237]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.02934192  0.00136162  0.00453458  0.07894319 -0.00739237]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00115993  0.01282919  0.02011993 -0.03357946 -0.02097012]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.06045685 -0.81611085  0.10774388  0.1750477   0.40449825]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.2857381  -1.2453763   0.01640277  0.05209688  0.7803259 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.2857381  -1.2453763   0.01640277  0.05209688  0.7803259 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.07428633  0.21501747  0.01059149 -0.01388138 -0.21567497]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01911815  0.03233298  0.00311871 -0.00771508 -0.04775481]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01911815  0.03233298  0.00311871 -0.00771508 -0.04775481]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.21509889  0.27090588 -0.26459077 -0.28454095 -0.352701  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.21509889  0.27090588 -0.26459077 -0.28454095 -0.352701  ]
  [Layer 12] Output shape after mixer: (1, 1, 1024)
  [Layer 12] Output sample values after mixer: [ 0.21509889  0.27090588 -0.26459077 -0.28454095 -0.352701  ]
  [Layer 12] Residual connection shape: (1, 1, 1024)
  [Layer 12] Residual connection sample values: [-0.2242786   0.13930155  0.45363083 -0.26239914 -3.5279675 ]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [-0.03659899  0.01856342  0.05754229 -0.0460689  -0.51642525]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.03659899  0.01856342  0.05754229 -0.0460689  -0.51642525]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [-0.03659899  0.01856342  0.05754229 -0.0460689  -0.51642525]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.37360752  0.18070221 -1.4718772  -0.9579223   0.7466472 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.37360752  0.18070221 -1.4718772  -0.9579223   0.7466472 ]
  [FlaxMamba2] xBC (step) sample values: [-0.5399971  1.6373531 -1.8325098 -2.0923162 -1.1986507]
  [FlaxMamba2] dt (step) sample values: [ 0.07354997 -0.46506175  0.31913844  0.02180811  0.59921575]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.8990746  -0.11584947 -0.9277646  -0.5399971   0.36125487]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.28687003  0.23016155  0.01295179 -0.10012604 -0.11417623]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.22479728  0.21150005  0.02083295 -0.11183716 -0.14461751]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.12497915  0.1168916   0.01052498 -0.05279495 -0.0670893 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.12497915  0.1168916   0.01052498 -0.05279495 -0.0670893 ]
  [FlaxMamba2] B (step) sample values: [-0.16701698 -0.00340991  0.0143219   0.3807155  -0.02246362]
  [FlaxMamba2] C (step) sample values: [-0.00241268 -0.27793217 -0.12922162 -0.04870225  0.04376152]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.02338035 -1.090337   -0.5085105  -0.67845345 -0.02513249]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05643191 0.0063084  0.01169687 0.00536976 0.26224372]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9986815  0.99314535 0.9940697  0.9963635  0.99343085]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.12497915  0.1168916   0.01052498 -0.05279495 -0.0670893 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.1779395e-03 -2.4049470e-05  1.0100968e-04  2.6851150e-03
 -1.5843172e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.1779395e-03 -2.4049470e-05  1.0100968e-04  2.6851150e-03
 -1.5843172e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.07942563  0.09287471 -0.2744062   0.02257013 -0.06381328]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.20875385 -0.13895367 -0.09960818 -0.00346993  0.14044197]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.22318935 -0.15245503 -0.10082384  0.00262806  0.148191  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.22318935 -0.15245503 -0.10082384  0.00262806  0.148191  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0493916  -0.01501564  0.02770003 -0.00069808  0.07506779]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02306133 -0.00463868  0.02898987 -0.00172523  0.04027137]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02306133 -0.00463868  0.02898987 -0.00172523  0.04027137]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.40993753 -0.11309065 -0.02605263  0.13307764 -0.06833553]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.40993753 -0.11309065 -0.02605263  0.13307764 -0.06833553]
  [Layer 13] Output shape after mixer: (1, 1, 1024)
  [Layer 13] Output sample values after mixer: [ 0.40993753 -0.11309065 -0.02605263  0.13307764 -0.06833553]
  [Layer 13] Residual connection shape: (1, 1, 1024)
  [Layer 13] Residual connection sample values: [ 0.18565893  0.0262109   0.4275782  -0.1293215  -3.596303  ]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.02564907  0.00312611  0.04987308 -0.02021627 -0.4654317 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.02564907  0.00312611  0.04987308 -0.02021627 -0.4654317 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.02564907  0.00312611  0.04987308 -0.02021627 -0.4654317 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.691706   -0.6926914  -0.98692113 -1.386655   -0.4205693 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.691706   -0.6926914  -0.98692113 -1.386655   -0.4205693 ]
  [FlaxMamba2] xBC (step) sample values: [-0.99306136 -1.0763199  -1.0219646  -1.9949417  -0.2225107 ]
  [FlaxMamba2] dt (step) sample values: [ 1.097618   -0.18060799  1.8325644   0.7780824   1.0242112 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.4262729   0.50619423 -0.86091554 -0.99306136 -1.0928919 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.21441418 -0.3686582  -0.4950999   0.55822444  0.06430864]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.28484875 -0.41806617 -0.68687236  0.510617    0.05052995]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.16257302 -0.16596374 -0.22991623  0.3191107   0.02590316]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.16257302 -0.16596374 -0.22991623  0.3191107   0.02590316]
  [FlaxMamba2] B (step) sample values: [-0.05220974  0.05710535  0.01214031 -0.00165507 -0.11460741]
  [FlaxMamba2] C (step) sample values: [-0.20670322 -0.00299329  0.06247263 -0.14241786 -0.20464619]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-7.2744994  -0.03854768 -2.202407   -0.01377147 -5.3377523 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0603433  0.05004672 0.07130423 0.1056259  0.04470808]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.64470184 0.9980727  0.8546691  0.9985464  0.7876979 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.16257302 -0.16596374 -0.22991623  0.3191107   0.02590316]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.12187660e-04  5.60214510e-04  1.19098804e-04 -1.62365850e-05
 -1.12432090e-03]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.12187660e-04  5.60214510e-04  1.19098804e-04 -1.62365850e-05
 -1.12432090e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00118863  0.00160469  0.00072484  0.00025137 -0.00172526]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.02524726 -0.02676651 -0.03758106  0.0428656   0.00043428]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.153192   -0.15737973 -0.2185248   0.29400527  0.02082003]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.153192   -0.15737973 -0.2185248   0.29400527  0.02082003]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.03535522  0.03634957  0.05855797 -0.08151326 -0.00347081]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.10896447  0.07805834  0.08627519 -0.17389967 -0.00941195]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.10896447  0.07805834  0.08627519 -0.17389967 -0.00941195]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.7104857   0.03259405 -0.89888686  0.34056035 -0.06813506]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.7104857   0.03259405 -0.89888686  0.34056035 -0.06813506]
  [Layer 14] Output shape after mixer: (1, 1, 1024)
  [Layer 14] Output sample values after mixer: [ 0.7104857   0.03259405 -0.89888686  0.34056035 -0.06813506]
  [Layer 14] Residual connection shape: (1, 1, 1024)
  [Layer 14] Residual connection sample values: [ 0.8961446   0.05880495 -0.47130865  0.21123885 -3.664438  ]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.14698523  0.00793442 -0.0638408   0.04107068 -0.5610023 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.14698523  0.00793442 -0.0638408   0.04107068 -0.5610023 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.14698523  0.00793442 -0.0638408   0.04107068 -0.5610023 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.6142627   1.4565552   0.86787915 -2.1492019  -3.3599277 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.6142627   1.4565552   0.86787915 -2.1492019  -3.3599277 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.0986822   0.11754213  1.3798525   1.0572677  -0.64319223]
  [FlaxMamba2] dt (step) sample values: [ 1.6336753 -1.2635546  0.1794467  0.9809231  1.133832 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.15227515  1.0156238  -0.43446398  1.0986822  -0.82988805]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.1127278  -0.01399203  0.42759264  0.19940688  0.08319276]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.44890943 -0.03817721  1.752788    0.6420338   0.06970399]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.17490414 -0.01872428  1.4939084   0.420669    0.03606616]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.17490414 -0.01872428  1.4939084   0.420669    0.03606616]
  [FlaxMamba2] B (step) sample values: [-0.04566995  0.05484503  0.09554835 -0.08945671 -0.04549283]
  [FlaxMamba2] C (step) sample values: [-0.04950763  0.0064218   0.18751605 -0.03240718 -0.0477309 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.4414158  -0.05923919 -0.7389757  -0.00508607 -0.00871955]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.2837655  0.15034194 0.02614232 0.12421593 0.38189828]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.5001789  0.9911334  0.98086685 0.9993684  0.99667555]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.17490414 -0.01872428  1.4939084   0.420669    0.03606616]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00226668 -0.00272206 -0.00474223  0.00443989  0.00225789]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00226668 -0.00272206 -0.00474223  0.00443989  0.00225789]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00464112 -0.00401481 -0.00476279  0.00533816  0.00458883]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00670192 -0.0027657   0.06201231  0.00933849  0.00487127]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.319046   -0.03620354  2.7298362   0.7605698   0.06927828]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.319046   -0.03620354  2.7298362   0.7605698   0.06927828]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.08549277 -0.04276629  1.668615   -0.17066365 -0.00781445]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.10324541 -0.03769619  0.43228528 -0.11617161 -0.00962905]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.10324541 -0.03769619  0.43228528 -0.11617161 -0.00962905]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.3189873   0.567534    0.07875588 -0.02953586 -0.00118682]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.3189873   0.567534    0.07875588 -0.02953586 -0.00118682]
  [Layer 15] Output shape after mixer: (1, 1, 1024)
  [Layer 15] Output sample values after mixer: [-0.3189873   0.567534    0.07875588 -0.02953586 -0.00118682]
  [Layer 15] Residual connection shape: (1, 1, 1024)
  [Layer 15] Residual connection sample values: [ 0.5771573   0.62633896 -0.39255276  0.18170299 -3.6656249 ]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.06455482  0.05789357 -0.0338147   0.02578622 -0.38760287]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.06455482  0.05789357 -0.0338147   0.02578622 -0.38760287]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.06455482  0.05789357 -0.0338147   0.02578622 -0.38760287]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.6552696  -0.573482   -4.733617   -0.34935445 -1.9253008 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.6552696  -0.573482   -4.733617   -0.34935445 -1.9253008 ]
  [FlaxMamba2] xBC (step) sample values: [-1.1815553  -0.12278488  0.01360874 -0.03989239 -1.4959792 ]
  [FlaxMamba2] dt (step) sample values: [1.2812138  2.751407   0.45882478 4.026557   2.3068602 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.18268262  0.42665908 -2.4088502  -1.1815553   0.22115201]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.24066381  0.0228976  -0.07829492 -0.31543684  0.08392081]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.24248724  0.03170192  0.05842383 -0.35361433  0.09145102]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.10661521  0.01610219  0.03006501 -0.14586811  0.04781488]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.10661521  0.01610219  0.03006501 -0.14586811  0.04781488]
  [FlaxMamba2] B (step) sample values: [-0.02687033 -0.08478078  0.18741241 -0.00040477  0.01788511]
  [FlaxMamba2] C (step) sample values: [ 0.01061798  0.0719836   0.3269999  -0.20080194 -0.17683767]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.1348554e-03 -3.0370306e-03 -2.7156286e+00 -4.1511287e-03
 -4.2925543e-01]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.2625516  0.7286386  0.0370993  0.9304179  0.01124502]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9997021  0.99778956 0.9041609  0.9961452  0.99518466]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.10661521  0.01610219  0.03006501 -0.14586811  0.04781488]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 7.5215410e-04  2.3731829e-03 -5.2460469e-03  1.1330442e-05
 -5.0063984e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 7.5215410e-04  2.3731829e-03 -5.2460469e-03  1.1330442e-05
 -5.0063984e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0374292   0.09689457  0.02647981  0.00138874 -0.00094513]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0574298   0.00915867  0.21832192  0.06906883 -0.00560895]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.082243    0.00541111  0.2113247   0.10301758 -0.01673719]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.082243    0.00541111  0.2113247   0.10301758 -0.01673719]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03547112 -0.00111849 -0.00872081 -0.01488312  0.00410122]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03298593 -0.00059216 -0.01858574 -0.00552151  0.00451465]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03298593 -0.00059216 -0.01858574 -0.00552151  0.00451465]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.02088835  0.9178532  -0.23986615  0.29325703  0.09112512]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.02088835  0.9178532  -0.23986615  0.29325703  0.09112512]
  [Layer 16] Output shape after mixer: (1, 1, 1024)
  [Layer 16] Output sample values after mixer: [-0.02088835  0.9178532  -0.23986615  0.29325703  0.09112512]
  [Layer 16] Residual connection shape: (1, 1, 1024)
  [Layer 16] Residual connection sample values: [ 0.556269    1.5441921  -0.63241893  0.47496003 -3.5744998 ]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.08976967  0.21442276 -0.08774237  0.08784336 -0.53138256]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.08976967  0.21442276 -0.08774237  0.08784336 -0.53138256]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.08976967  0.21442276 -0.08774237  0.08784336 -0.53138256]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-5.268261  -3.2111714 -1.9811993 -0.8284778 -2.6949334]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-5.268261  -3.2111714 -1.9811993 -0.8284778 -2.6949334]
  [FlaxMamba2] xBC (step) sample values: [ 0.84292513 -0.7234983  -1.3936592   1.1031542  -2.7000756 ]
  [FlaxMamba2] dt (step) sample values: [1.3824829 1.609739  1.3495427 2.2467096 1.1581699]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.16899     0.6221373   0.20830995  0.84292513  0.9229756 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00524624 -0.09594806 -0.40951046  0.23993927 -0.6740969 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.10027798 -0.07382282 -0.5239514   0.2743631  -0.57888204]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.04762717 -0.03554957 -0.19487257  0.15588316 -0.20792857]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04762717 -0.03554957 -0.19487257  0.15588316 -0.20792857]
  [FlaxMamba2] B (step) sample values: [ 0.01129162  0.01430668 -0.22819799  0.02139662 -0.21752456]
  [FlaxMamba2] C (step) sample values: [-0.01056715  0.10920658 -0.23376232 -0.12385693  0.28423333]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.3863302  -0.87734115 -1.4026718  -0.6827737  -0.39046   ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.46735376 0.3596163  0.42901802 1.3072932  0.7867374 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.5231397  0.7294196  0.5478403  0.40959543 0.7355112 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04762717 -0.03554957 -0.19487257  0.15588316 -0.20792857]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00025134 -0.00031845  0.0050794  -0.00047626  0.00484182]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00025134 -0.00031845  0.0050794  -0.00047626  0.00484182]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00036436 -0.00939147  0.01833145  0.0053738   0.01261844]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0407245   0.01152251 -0.10965119  0.05599866 -0.13614218]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.16616774 -0.08211003 -0.62291795  0.46657285 -0.6837966 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.16616774 -0.08211003 -0.62291795  0.46657285 -0.6837966 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00448751  0.01021652  0.14956486 -0.117497    0.11659858]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00251517  0.00584362  0.08999283 -0.08703787  0.07963779]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00251517  0.00584362  0.08999283 -0.08703787  0.07963779]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.52036726  0.41044256  0.01644396 -0.13997397 -0.292683  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.52036726  0.41044256  0.01644396 -0.13997397 -0.292683  ]
  [Layer 17] Output shape after mixer: (1, 1, 1024)
  [Layer 17] Output sample values after mixer: [ 0.52036726  0.41044256  0.01644396 -0.13997397 -0.292683  ]
  [Layer 17] Residual connection shape: (1, 1, 1024)
  [Layer 17] Residual connection sample values: [ 1.0766363   1.9546347  -0.61597496  0.33498606 -3.8671827 ]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.11700507  0.18366739 -0.05702845  0.04424194 -0.37193528]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.11700507  0.18366739 -0.05702845  0.04424194 -0.37193528]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.11700507  0.18366739 -0.05702845  0.04424194 -0.37193528]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.4520969  -0.38703403 -1.6063673  -0.755148   -1.7062008 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.4520969  -0.38703403 -1.6063673  -0.755148   -1.7062008 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.02091626 -0.74323505  0.6477305  -1.0505335   1.3369397 ]
  [FlaxMamba2] dt (step) sample values: [0.7969344 4.2725387 4.7471733 2.6975071 2.205913 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6630224  -0.8443349  -0.31026247  0.02091626  1.6619896 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.02488285  0.8439307  -0.13177362 -0.05913835  0.13234904]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03423649  0.4459815  -0.12052789 -0.02859025  0.08010295]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.01741125  0.2719075  -0.05663659 -0.01409079  0.04165474]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01741125  0.2719075  -0.05663659 -0.01409079  0.04165474]
  [FlaxMamba2] B (step) sample values: [-0.01624872  0.07406147 -0.14332233 -0.09715976  0.05855437]
  [FlaxMamba2] C (step) sample values: [ 0.02469398  0.17288499 -0.20407388 -0.00368382  0.02317647]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.3194940e-03 -6.5335674e+00 -1.4897179e+01 -1.3796333e-03
 -2.0873186e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.27173087 5.3884463  6.195503   1.0011922  0.8474477 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.9936992e-01 5.1324611e-16 0.0000000e+00 9.9861968e-01 9.9823266e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01741125  0.2719075  -0.05663659 -0.01409079  0.04165474]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.6875542e-05  3.5039769e-04 -6.7808293e-04 -4.5967972e-04
  2.7703089e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.6875542e-05  3.5039769e-04 -6.7808293e-04 -4.5967972e-04
  2.7703089e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00412652 -0.00090751  0.09390306 -0.05786701  0.01723938]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0296794  -0.11813035  0.03956037  0.01817048  0.03441456]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03105783 -0.13965699  0.04404423  0.01928604  0.0311168 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03105783 -0.13965699  0.04404423  0.01928604  0.0311168 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00546007  0.02186034 -0.01182207 -0.00465606 -0.00815789]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00774417  0.00759171 -0.00369736 -0.0033908  -0.00279187]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00774417  0.00759171 -0.00369736 -0.0033908  -0.00279187]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.77679616 -0.6511268  -0.1478743   0.34892344 -0.05035752]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.77679616 -0.6511268  -0.1478743   0.34892344 -0.05035752]
  [Layer 18] Output shape after mixer: (1, 1, 1024)
  [Layer 18] Output sample values after mixer: [-0.77679616 -0.6511268  -0.1478743   0.34892344 -0.05035752]
  [Layer 18] Residual connection shape: (1, 1, 1024)
  [Layer 18] Residual connection sample values: [ 0.29984015  1.3035078  -0.76384926  0.68390954 -3.9175403 ]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.03961688  0.14302975 -0.08472396  0.11175073 -0.45953384]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.03961688  0.14302975 -0.08472396  0.11175073 -0.45953384]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.03961688  0.14302975 -0.08472396  0.11175073 -0.45953384]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.4875027  -1.3737622  -1.5545119  -0.2656803  -0.09791068]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.4875027  -1.3737622  -1.5545119  -0.2656803  -0.09791068]
  [FlaxMamba2] xBC (step) sample values: [-0.31026298  0.42843395  1.8721241   0.9324954   0.38413355]
  [FlaxMamba2] dt (step) sample values: [-0.48645     0.75589216  0.8356216  -0.37652427 -0.8867231 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.6270058  -0.65265405 -1.3605541  -0.31026298  1.8048857 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.22303954 -0.07509363  0.4516093  -0.29971007  0.11349655]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.27446166 -0.07459248  0.43781537 -0.50735164  0.11230446]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.11851586 -0.03590588  0.2660772  -0.19067013  0.05930199]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.11851586 -0.03590588  0.2660772  -0.19067013  0.05930199]
  [FlaxMamba2] B (step) sample values: [-0.02117148 -0.15095553  0.07021046  0.23632668 -0.10487612]
  [FlaxMamba2] C (step) sample values: [-0.23111922 -0.12598401 -0.02707564  0.0254257  -0.11153995]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17394373 -1.5063176  -1.5724528  -0.19826236 -0.07681109]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.95586693 0.5283274  0.62063026 1.1538107  0.16685252]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.84682006 0.4512071  0.37684858 0.7955216  0.98726565]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.11851586 -0.03590588  0.2660772  -0.19067013  0.05930199]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00239842  0.01710106 -0.00795382 -0.02677236  0.01188093]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00239842  0.01710106 -0.00795382 -0.02677236  0.01188093]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00873549  0.00941624  0.06455812 -0.09570388 -0.15484962]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.23983133  0.03728662  0.2008556  -0.38570118 -0.07068904]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.4202931  -0.01738655  0.6060061  -0.6760309   0.01960893]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.4202931  -0.01738655  0.6060061  -0.6760309   0.01960893]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.12693553  0.00482507 -0.16432594  0.07794414 -0.000913  ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.035956    0.00236295 -0.09582119  0.01871601 -0.00081113]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.035956    0.00236295 -0.09582119  0.01871601 -0.00081113]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.0991422   0.65498286 -0.33737278 -0.4458229  -0.2020584 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.0991422   0.65498286 -0.33737278 -0.4458229  -0.2020584 ]
  [Layer 19] Output shape after mixer: (1, 1, 1024)
  [Layer 19] Output sample values after mixer: [ 1.0991422   0.65498286 -0.33737278 -0.4458229  -0.2020584 ]
  [Layer 19] Residual connection shape: (1, 1, 1024)
  [Layer 19] Residual connection sample values: [ 1.3989823   1.9584906  -1.101222    0.23808664 -4.119599  ]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.11098062  0.14220476 -0.08001685  0.02311226 -0.31923592]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.11098062  0.14220476 -0.08001685  0.02311226 -0.31923592]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.11098062  0.14220476 -0.08001685  0.02311226 -0.31923592]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.1828153  -0.6185461   0.42601946 -0.1997567  -0.11064814]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.1828153  -0.6185461   0.42601946 -0.1997567  -0.11064814]
  [FlaxMamba2] xBC (step) sample values: [ 0.35838518 -0.0170107  -0.73911446 -0.05619362 -0.579944  ]
  [FlaxMamba2] dt (step) sample values: [-0.10999519 -0.32038462  0.10680352  1.2532377   2.673719  ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.03154976  0.03043384  0.19904317  0.35838518 -1.0853176 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.08031316  0.04553742 -0.27999845  0.03213168 -0.15812734]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.06580968  0.00735993 -0.45956388  0.01108981 -0.20463613]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.03398718  0.0036935  -0.17789225  0.00557565 -0.09188545]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03398718  0.0036935  -0.17789225  0.00557565 -0.09188545]
  [FlaxMamba2] B (step) sample values: [ 0.00524991 -0.0125844  -0.03819736  0.03025044  0.04334467]
  [FlaxMamba2] C (step) sample values: [-0.2254468  -0.18094161 -0.2186203  -0.10250541 -0.23497637]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-3.08577806e-01 -2.93056536e+00 -5.29621363e+00 -1.23260975e+01
 -8.15932546e-03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00635517 0.01912204 0.06592045 0.24490848 0.48519686]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99804085 0.9455029  0.7053023  0.04886148 0.9960489 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03398718  0.0036935  -0.17789225  0.00557565 -0.09188545]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.1339504e-06 -2.7181563e-06 -8.2504084e-06  6.5339200e-06
  9.3621966e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.1339504e-06 -2.7181563e-06 -8.2504084e-06  6.5339200e-06
  9.3621966e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.0777879e-04 -2.3495164e-04 -1.7849159e-04  1.0047160e-04
 -4.2837517e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00161647  0.00085964 -0.00100987  0.0022447  -0.00011675]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02957016  0.00389746 -0.14732222  0.00683054 -0.07569046]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02957016  0.00389746 -0.14732222  0.00683054 -0.07569046]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0082035  -0.00084404 -0.03796624 -0.00061431  0.00395607]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.05956655 -0.00527771 -0.16342798 -0.00434227  0.01827272]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.05956655 -0.00527771 -0.16342798 -0.00434227  0.01827272]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.24532025  0.0379951   0.21057378 -0.01240519  0.2453749 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.24532025  0.0379951   0.21057378 -0.01240519  0.2453749 ]
  [Layer 20] Output shape after mixer: (1, 1, 1024)
  [Layer 20] Output sample values after mixer: [ 0.24532025  0.0379951   0.21057378 -0.01240519  0.2453749 ]
  [Layer 20] Residual connection shape: (1, 1, 1024)
  [Layer 20] Residual connection sample values: [ 1.6443025   1.9964857  -0.89064825  0.22568145 -3.874224  ]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.17741916  0.19491822 -0.08909014  0.02879757 -0.4018706 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.17741916  0.19491822 -0.08909014  0.02879757 -0.4018706 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.17741916  0.19491822 -0.08909014  0.02879757 -0.4018706 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.3367059  -0.91748446 -1.315368    0.3483889  -1.4190533 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.3367059  -0.91748446 -1.315368    0.3483889  -1.4190533 ]
  [FlaxMamba2] xBC (step) sample values: [-0.5207106   2.136661    1.1764143  -0.73894143 -0.23708932]
  [FlaxMamba2] dt (step) sample values: [-0.33209547 -0.02950728 -1.391122   -2.3782697  -0.27858558]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.2194853  -0.00947738 -1.2506956  -0.5207106  -0.58118755]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.2889806   0.60135895 -0.05093485  0.20546475 -0.07070339]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.6464025   0.5038858  -0.07660013  0.10744229 -0.12468899]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.22223362  0.31410834 -0.03683389  0.05660434 -0.05846269]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.22223362  0.31410834 -0.03683389  0.05660434 -0.05846269]
  [FlaxMamba2] B (step) sample values: [-0.09467072 -0.25464785 -0.07751666  0.04247903 -0.03705768]
  [FlaxMamba2] C (step) sample values: [-0.01468714 -0.11884255 -0.12267326 -0.04499041  0.01118518]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.32275575 -0.3764196  -0.15946394 -0.10539922 -0.37568513]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.57433635 0.5656018  0.26934212 0.05014667 0.44598874]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.83079654 0.80823404 0.95795894 0.9947285  0.84573317]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.22223362  0.31410834 -0.03683389  0.05660434 -0.05846269]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01208347  0.03250245  0.00989398 -0.00542189  0.00472992]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01208347  0.03250245  0.00989398 -0.00542189  0.00472992]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.12288085  0.14340274  0.0660824   0.10354656  0.01672223]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.22751187  0.11673713 -0.03256923 -0.02049263  0.02842848]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.69720185  0.780604   -0.11041752  0.09914044 -0.0951322 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.69720185  0.780604   -0.11041752  0.09914044 -0.0951322 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.09779998 -0.20445187  0.03073126  0.02024794  0.0262989 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07222109 -0.19077735  0.03242264  0.01498029  0.01677897]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.07222109 -0.19077735  0.03242264  0.01498029  0.01677897]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.7341432  -0.17527787  0.13363974  0.7260388   0.29569954]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.7341432  -0.17527787  0.13363974  0.7260388   0.29569954]
  [Layer 21] Output shape after mixer: (1, 1, 1024)
  [Layer 21] Output sample values after mixer: [-0.7341432  -0.17527787  0.13363974  0.7260388   0.29569954]
  [Layer 21] Residual connection shape: (1, 1, 1024)
  [Layer 21] Residual connection sample values: [ 0.9101593   1.8212079  -0.7570085   0.95172024 -3.5785244 ]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.09503669  0.17589033 -0.07318571  0.11739364 -0.3620173 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.09503669  0.17589033 -0.07318571  0.11739364 -0.3620173 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.09503669  0.17589033 -0.07318571  0.11739364 -0.3620173 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.37899268 -0.32038733  0.12691191 -3.5731595   0.4102063 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.37899268 -0.32038733  0.12691191 -3.5731595   0.4102063 ]
  [FlaxMamba2] xBC (step) sample values: [-0.9930385   0.83213276 -1.2858076  -0.778198   -0.83247197]
  [FlaxMamba2] dt (step) sample values: [-1.6985124  -3.5827034  -0.89266384 -1.1733671  -0.45073387]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6606246  -1.1091923   0.13990876 -0.9930385  -0.77949256]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00801528 -0.13665248 -0.04720702 -0.177589   -0.07522774]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01620162 -0.07213832 -0.03457275 -0.19594532 -0.07461739]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.00816643 -0.03476874 -0.01698758 -0.08840462 -0.0359174 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00816643 -0.03476874 -0.01698758 -0.08840462 -0.0359174 ]
  [FlaxMamba2] B (step) sample values: [-0.27670008  0.09161052  0.31316432  0.05352338 -0.03930534]
  [FlaxMamba2] C (step) sample values: [-0.26706815  0.06178398 -0.2177201  -0.08969772 -0.14343311]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.07090003 -0.07021102 -0.0699373  -0.08945116 -0.38969815]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11279344 0.03148549 0.04895515 0.11376075 0.51165175]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99203485 0.9977918  0.9965821  0.98987556 0.81923056]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00816643 -0.03476874 -0.01698758 -0.08840462 -0.0359174 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.5487391e-04  8.4384264e-05  2.8846186e-04  4.9301445e-05
 -3.6204921e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.5487391e-04  8.4384264e-05  2.8846186e-04  4.9301445e-05
 -3.6204921e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.0140359  0.01089639 0.00235316 0.018752   0.04053747]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00530308  0.07847174 -0.04940715  0.0007398  -0.01490973]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01938203  0.13841313 -0.02012051  0.15314957  0.04701196]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01938203  0.13841313 -0.02012051  0.15314957  0.04701196]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00298505 -0.01865102 -0.00135768 -0.01493975  0.01159269]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.001962   -0.00530946 -0.00089237 -0.01458778  0.00727044]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.001962   -0.00530946 -0.00089237 -0.01458778  0.00727044]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.08384786  0.27147847  0.26404205  0.19465436 -0.09955515]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.08384786  0.27147847  0.26404205  0.19465436 -0.09955515]
  [Layer 22] Output shape after mixer: (1, 1, 1024)
  [Layer 22] Output sample values after mixer: [-0.08384786  0.27147847  0.26404205  0.19465436 -0.09955515]
  [Layer 22] Residual connection shape: (1, 1, 1024)
  [Layer 22] Residual connection sample values: [ 0.8263114   2.0926864  -0.49296644  1.1463746  -3.6780796 ]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.07248187  0.16583021 -0.04110485  0.1236164  -0.30023897]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.07248187  0.16583021 -0.04110485  0.1236164  -0.30023897]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.07248187  0.16583021 -0.04110485  0.1236164  -0.30023897]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.06289538 -0.27213067 -1.132507   -1.2714249  -1.1457819 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.06289538 -0.27213067 -1.132507   -1.2714249  -1.1457819 ]
  [FlaxMamba2] xBC (step) sample values: [-1.1756982   0.9538659   1.6967304   0.19217543 -0.3389153 ]
  [FlaxMamba2] dt (step) sample values: [-0.97334236 -0.7359833  -0.4909478  -1.0398433  -0.931074  ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.11811411 -0.728753   -0.32199144 -1.1756982  -0.23992074]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.12816244  0.20341185  0.1683229  -0.02813303 -0.06568008]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.16185385  0.1958473   0.12636124 -0.01179086 -0.07014709]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.07439202  0.10748215  0.06716711 -0.00586068 -0.0338439 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07439202  0.10748215  0.06716711 -0.00586068 -0.0338439 ]
  [FlaxMamba2] B (step) sample values: [0.6081223  0.09850786 0.05662532 0.600619   0.00665299]
  [FlaxMamba2] C (step) sample values: [ 0.07416518 -0.09109716  0.09561574  0.11661605  0.0901985 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.12322418 -0.22553998 -0.24196908 -0.09559295 -0.2396176 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02779291 0.10866158 0.13266505 0.02694672 0.07266303]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9965811  0.9757903  0.96840894 0.9974274  0.9827393 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07439202  0.10748215  0.06716711 -0.00586068 -0.0338439 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.25733600e-03 -2.03671996e-04 -1.17076866e-04 -1.24182249e-03
 -1.37555235e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.25733600e-03 -2.03671996e-04 -1.17076866e-04 -1.24182249e-03
 -1.37555235e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.02169633  0.01020277 -0.00194556  0.06436571 -0.01124987]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.05226154  0.04797246  0.23654318 -0.04393651  0.01880623]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.05573418  0.04295518  0.23340781 -0.04366293  0.02038607]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.05573418  0.04295518  0.23340781 -0.04366293  0.02038607]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00169761 -0.00505432 -0.06441835  0.01215834 -0.00563536]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00112112 -0.01011811 -0.21197309  0.04013539 -0.01035779]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00112112 -0.01011811 -0.21197309  0.04013539 -0.01035779]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.25771865  0.17002407  0.13955654  0.3492377   0.02961438]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.25771865  0.17002407  0.13955654  0.3492377   0.02961438]
  [Layer 23] Output shape after mixer: (1, 1, 1024)
  [Layer 23] Output sample values after mixer: [-0.25771865  0.17002407  0.13955654  0.3492377   0.02961438]
  [Layer 23] Residual connection shape: (1, 1, 1024)
  [Layer 23] Residual connection sample values: [ 0.5685928  2.2627106 -0.3534099  1.4956123 -3.6484652]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.06215261  0.2195625  -0.03726481  0.18762432 -0.36742896]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.06215261  0.2195625  -0.03726481  0.18762432 -0.36742896]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.06215261  0.2195625  -0.03726481  0.18762432 -0.36742896]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.2517479   0.38649717 -0.2198085  -0.32187656 -0.92460454]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.2517479   0.38649717 -0.2198085  -0.32187656 -0.92460454]
  [FlaxMamba2] xBC (step) sample values: [-0.5894746 -1.8711895 -1.6108735 -0.6265451  1.3585703]
  [FlaxMamba2] dt (step) sample values: [-1.4693841 -1.2501168 -1.6293933 -1.434079  -1.532523 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.7084974   0.37178186 -0.33407882 -0.5894746  -0.09366113]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.26072788 -0.21888301 -0.19886833 -0.15361738 -0.339647  ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.387681   -0.12153193 -0.2010389  -0.23271894 -0.3327958 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.23095101 -0.057078   -0.09044918 -0.10288072 -0.13896239]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.23095101 -0.057078   -0.09044918 -0.10288072 -0.13896239]
  [FlaxMamba2] B (step) sample values: [-0.25165874 -0.05982837  0.01656413  0.03651698 -0.00473573]
  [FlaxMamba2] C (step) sample values: [ 0.0418304  -0.2197073  -0.23987482 -0.18366164 -0.2613392 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6296152  -0.19671947 -0.14336194 -0.14017779 -0.22378482]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.23821007 0.2808225  0.14463535 0.4162519  0.12030867]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.8607246  0.94625497 0.9794783  0.9433204  0.97343594]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.23095101 -0.057078   -0.09044918 -0.10288072 -0.13896239]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01384497 -0.00329145  0.00091127  0.00200898 -0.00026054]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01384497 -0.00329145  0.00091127  0.00200898 -0.00026054]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.02624962  0.00154735 -0.00074096  0.00792825  0.00028621]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.07021243 -0.01921342 -0.04809714 -0.04709544 -0.00948441]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 1.2013735 -0.2987723 -0.4911027 -0.5509887 -0.6900999]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 1.2013735 -0.2987723 -0.4911027 -0.5509887 -0.6900999]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.13228667 -0.06875813  0.04806604  0.07452589  0.18122488]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03152158 -0.05115241  0.0314408   0.03620788  0.08162676]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03152158 -0.05115241  0.0314408   0.03620788  0.08162676]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.2536465  -0.21429326  0.13708913 -0.3473702  -0.38125116]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.2536465  -0.21429326  0.13708913 -0.3473702  -0.38125116]
  [Layer 24] Output shape after mixer: (1, 1, 1024)
  [Layer 24] Output sample values after mixer: [ 0.2536465  -0.21429326  0.13708913 -0.3473702  -0.38125116]
  [Layer 24] Residual connection shape: (1, 1, 1024)
  [Layer 24] Residual connection sample values: [ 0.8222393   2.0484173  -0.21632075  1.148242   -4.0297165 ]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.06176487  0.14281899 -0.01514422  0.09875561 -0.2836525 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.06176487  0.14281899 -0.01514422  0.09875561 -0.2836525 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.06176487  0.14281899 -0.01514422  0.09875561 -0.2836525 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.9888069  -0.6089323  -0.8792247  -0.37286833 -0.49273494]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.9888069  -0.6089323  -0.8792247  -0.37286833 -0.49273494]
  [FlaxMamba2] xBC (step) sample values: [ 0.21291003 -0.6214704  -0.82039106 -0.6297067  -0.55296963]
  [FlaxMamba2] dt (step) sample values: [-1.507901   -0.78910214 -0.9887472  -1.1888996  -1.1773717 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5787873   1.1918046   0.9602928   0.21291003 -0.15982583]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.08988083  0.05451496  0.18366835 -0.17778601 -0.16760232]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0705632   0.05786236  0.28632948 -0.28288853 -0.20623757]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.03652588  0.02976796  0.16352198 -0.12157015 -0.09252283]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03652588  0.02976796  0.16352198 -0.12157015 -0.09252283]
  [FlaxMamba2] B (step) sample values: [ 0.00905805 -0.04685593 -0.02952454  0.01075109  0.05725921]
  [FlaxMamba2] C (step) sample values: [-0.27615696 -0.2625692  -0.2720577  -0.27245456 -0.17468491]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.16260907 -0.3326761  -0.32944313 -0.2015813  -0.1541056 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.16126232 0.1761564  0.14170724 0.15468565 0.19373198]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9741181  0.9430811  0.9543885  0.9692994  0.97058606]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03652588  0.02976796  0.16352198 -0.12157015 -0.09252283]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.3354172e-05 -2.7599308e-04 -1.7390684e-04  6.3326581e-05
  3.3727093e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.3354172e-05 -2.7599308e-04 -1.7390684e-04  6.3326581e-05
  3.3727093e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00409923  0.01412605  0.01522726  0.0058421  -0.01527049]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-7.1442332e-03  5.8469032e-05 -1.7725524e-05 -5.1719900e-02
 -1.5470972e-02]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02641725  0.02741049  0.15023299 -0.16342355 -0.10048476]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02641725  0.02741049  0.15023299 -0.16342355 -0.10048476]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0070828  -0.00588033 -0.03874665  0.02485242  0.01877754]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02420576 -0.01574961 -0.08666699  0.03118228  0.03628658]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02420576 -0.01574961 -0.08666699  0.03118228  0.03628658]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.309194   -0.24642633 -0.29059795 -0.44486713 -0.1093898 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.309194   -0.24642633 -0.29059795 -0.44486713 -0.1093898 ]
  [Layer 25] Output shape after mixer: (1, 1, 1024)
  [Layer 25] Output sample values after mixer: [-0.309194   -0.24642633 -0.29059795 -0.44486713 -0.1093898 ]
  [Layer 25] Residual connection shape: (1, 1, 1024)
  [Layer 25] Residual connection sample values: [ 0.5130453   1.801991   -0.50691867  0.70337486 -4.1391063 ]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.04732203  0.1548362  -0.04580173  0.0779326  -0.36520723]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.04732203  0.1548362  -0.04580173  0.0779326  -0.36520723]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.04732203  0.1548362  -0.04580173  0.0779326  -0.36520723]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.47564918  0.67699635 -0.5941883   1.9158493   0.77771705]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.47564918  0.67699635 -0.5941883   1.9158493   0.77771705]
  [FlaxMamba2] xBC (step) sample values: [-1.2692802  -0.27796316 -1.2236371   0.92606765 -0.3524369 ]
  [FlaxMamba2] dt (step) sample values: [-0.30024454 -0.86080766 -1.8844197  -1.7144319  -0.98310286]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.5481895  -0.24176234  0.60414135 -1.2692802  -0.5525676 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.28122994 -0.10686655  0.2807603   0.25847182 -0.09777534]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.37223336 -0.16079111  0.25549173  0.19517836 -0.3655976 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.15187176 -0.073946    0.14397669  0.10708272 -0.14975068]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.15187176 -0.073946    0.14397669  0.10708272 -0.14975068]
  [FlaxMamba2] B (step) sample values: [ 0.37251002 -0.09396493 -0.05441192 -0.15798256  0.0163761 ]
  [FlaxMamba2] C (step) sample values: [ 0.21164224 -0.20407984 -0.10998484 -0.17388588 -0.2530977 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.329765   -0.06343037 -0.22886811 -0.12639298 -0.0584348 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.4406806  0.08491817 0.46215993 0.42443526 0.23388839]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.86474466 0.9946281  0.8996282  0.9477679  0.98642576]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.15187176 -0.073946    0.14397669  0.10708272 -0.14975068]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.02493095  0.00628878  0.00364162  0.01057329 -0.001096  ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.02493095  0.00628878  0.00364162  0.01057329 -0.001096  ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0477267   0.00608291 -0.00663727 -0.01213428 -0.00738717]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.2617975  -0.35651103 -0.00069015  0.09568656 -0.45702112]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.87431234 -0.6547431   0.57998306  0.5275625  -1.0609815 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.87431234 -0.6547431   0.57998306  0.5275625  -1.0609815 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.15939312 -0.2939106  -0.12257221  0.8810282  -0.56537825]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07395273 -0.09512856 -0.05241158  0.4138247  -0.19554617]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.07395273 -0.09512856 -0.05241158  0.4138247  -0.19554617]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.32323956 -0.07623991  0.09796555  0.46697786 -0.52856183]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.32323956 -0.07623991  0.09796555  0.46697786 -0.52856183]
  [Layer 26] Output shape after mixer: (1, 1, 1024)
  [Layer 26] Output sample values after mixer: [ 0.32323956 -0.07623991  0.09796555  0.46697786 -0.52856183]
  [Layer 26] Residual connection shape: (1, 1, 1024)
  [Layer 26] Residual connection sample values: [ 0.8362849   1.725751   -0.40895313  1.1703527  -4.6676683 ]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.06607702  0.12980585 -0.03117668  0.10688249 -0.37139717]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.06607702  0.12980585 -0.03117668  0.10688249 -0.37139717]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.06607702  0.12980585 -0.03117668  0.10688249 -0.37139717]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.42709354 -0.09988379 -0.03897983  0.44172552 -0.8398316 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.42709354 -0.09988379 -0.03897983  0.44172552 -0.8398316 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.21975689 -0.9293901   0.5376209  -0.83652866  0.02154018]
  [FlaxMamba2] dt (step) sample values: [-1.0249424  -1.5835836  -0.9572845  -0.3223267   0.29033896]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5523377   0.589558   -0.33014047  0.21975689  0.19299132]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.05693094 -0.27235767  0.11828957  0.541098   -0.00672277]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.07360879 -0.324146    0.06323586  0.3409027  -0.00486596]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.03545045 -0.13603295  0.03261729  0.19922686 -0.00242706]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03545045 -0.13603295  0.03261729  0.19922686 -0.00242706]
  [FlaxMamba2] B (step) sample values: [-0.0295068   0.17991291  0.02024597  0.0304339  -0.14501745]
  [FlaxMamba2] C (step) sample values: [-0.23125438  0.12047226  0.04978229 -0.08486246 -0.18597995]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.562595   -0.03025642 -0.75594616 -1.1612954  -0.04055573]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02825606 0.00931494 0.00358516 0.05635814 0.04215676]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.98422897 0.9997182  0.9972935  0.93664736 0.9982918 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03545045 -0.13603295  0.03261729  0.19922686 -0.00242706]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.9556661e-05 -1.8021693e-04 -2.0280186e-05 -3.0485324e-05
  1.4526250e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.9556661e-05 -1.8021693e-04 -2.0280186e-05 -3.0485324e-05
  1.4526250e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0040217  -0.00629362 -0.00552878 -0.02110596  0.00133035]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01544044 -0.01265938  0.00046871 -0.00217162  0.00512456]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-8.5939392e-02 -2.8318292e-01  6.5333463e-02  3.9402324e-01
  2.9795617e-04]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-8.5939392e-02 -2.8318292e-01  6.5333463e-02  3.9402324e-01
  2.9795617e-04]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 1.4491558e-02  1.3436966e-02 -1.2485294e-03  1.0593911e-01
 -7.5462835e-05]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02321068  0.01693726 -0.0022701   0.04956197 -0.00017524]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02321068  0.01693726 -0.0022701   0.04956197 -0.00017524]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.07680314  0.20094511  0.32718667 -0.32055113  0.3876314 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.07680314  0.20094511  0.32718667 -0.32055113  0.3876314 ]
  [Layer 27] Output shape after mixer: (1, 1, 1024)
  [Layer 27] Output sample values after mixer: [ 0.07680314  0.20094511  0.32718667 -0.32055113  0.3876314 ]
  [Layer 27] Residual connection shape: (1, 1, 1024)
  [Layer 27] Residual connection sample values: [ 0.913088    1.9266962  -0.08176646  0.84980154 -4.280037  ]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.0612656   0.12440917 -0.00539617  0.06665906 -0.27813637]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.0612656   0.12440917 -0.00539617  0.06665906 -0.27813637]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.0612656   0.12440917 -0.00539617  0.06665906 -0.27813637]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.2131789  -0.48743853 -0.3849483  -0.72294647 -0.30551904]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.2131789  -0.48743853 -0.3849483  -0.72294647 -0.30551904]
  [FlaxMamba2] xBC (step) sample values: [-0.01669765 -0.32844287  1.0231165  -0.9953973   0.15542567]
  [FlaxMamba2] dt (step) sample values: [-0.9874643  -0.87712604 -0.76740795 -0.5950155  -0.5480185 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.6444194  -0.02011488 -0.50437963 -0.01669765  1.050475  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06009555 -0.12127368  0.27667305  0.27044827  0.03440518]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.06783414 -0.21069019  0.14752266  0.18036038 -0.03120761]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.03276714 -0.09428837  0.07919221  0.09829068 -0.01536035]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03276714 -0.09428837  0.07919221  0.09829068 -0.01536035]
  [FlaxMamba2] B (step) sample values: [-0.08392585 -0.06706283 -0.03529177 -0.08800621  0.5396421 ]
  [FlaxMamba2] C (step) sample values: [-0.02560274  0.01703607  0.04216978 -0.11729009 -0.06620472]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.54422176 -0.18426022 -0.10643356 -0.11241624 -0.25234625]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0707879  0.24332362 0.5260829  0.54975826 0.30497313]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.96220833 0.95615536 0.94554585 0.94006926 0.925928  ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03276714 -0.09428837  0.07919221  0.09829068 -0.01536035]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.9466746e-04  1.5555340e-04  8.1859871e-05  2.0413194e-04
 -1.2517092e-03]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.9466746e-04  1.5555340e-04  8.1859871e-05  2.0413194e-04
 -1.2517092e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0025705   0.00046984 -0.00306507  0.0008574  -0.00769738]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00371618 -0.01244771  0.00049686  0.01186025 -0.0002908 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.06484898 -0.18835905  0.14824368  0.1952386  -0.0289482 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.06484898 -0.18835905  0.14824368  0.1952386  -0.0289482 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01802715  0.03493476 -0.02310803 -0.04611903  0.0037518 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04180516  0.07612529 -0.04806986 -0.11084335  0.01049222]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04180516  0.07612529 -0.04806986 -0.11084335  0.01049222]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.7570908  -0.20382212  0.7357882  -0.28481978  0.0178639 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.7570908  -0.20382212  0.7357882  -0.28481978  0.0178639 ]
  [Layer 28] Output shape after mixer: (1, 1, 1024)
  [Layer 28] Output sample values after mixer: [ 0.7570908  -0.20382212  0.7357882  -0.28481978  0.0178639 ]
  [Layer 28] Residual connection shape: (1, 1, 1024)
  [Layer 28] Residual connection sample values: [ 1.6701789   1.722874    0.65402174  0.56498176 -4.262173  ]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.1370154   0.13953534  0.05407017  0.05727437 -0.3512046 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.1370154   0.13953534  0.05407017  0.05727437 -0.3512046 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.1370154   0.13953534  0.05407017  0.05727437 -0.3512046 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.8265479  -1.2818892  -0.11407749  0.27872705 -0.6845571 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.8265479  -1.2818892  -0.11407749  0.27872705 -0.6845571 ]
  [FlaxMamba2] xBC (step) sample values: [-0.4953557   0.9410761  -0.64293534 -0.6740134  -0.89531684]
  [FlaxMamba2] dt (step) sample values: [-0.10196523  0.06834216  0.48080143  0.21294418 -0.24207951]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.51662797 -0.25573054  0.26955572 -0.4953557   0.49783996]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.07645206 -0.25823474  0.09754939  0.12115728  0.13101645]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.06245975 -0.3338573  -0.04075627  0.4878565   1.6310165 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.03025489 -0.13931945 -0.01996292  0.30227655  1.3640336 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03025489 -0.13931945 -0.01996292  0.30227655  1.3640336 ]
  [FlaxMamba2] B (step) sample values: [ 0.06609114 -0.10149975  0.0126353  -0.04172571 -0.00974819]
  [FlaxMamba2] C (step) sample values: [-0.06218898 -0.16297488 -0.17202237 -0.16343163 -0.06402455]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.6542169  -0.13693057 -1.458904   -0.36823887 -0.12178858]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.07538064 0.05898707 0.14881167 0.12623772 0.23548338]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.951881   0.9919554  0.8048479  0.9545783  0.97172815]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03025489 -0.13931945 -0.01996292  0.30227655  1.3640336 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.5072961e-04  2.3148363e-04 -2.8816472e-05  9.5161020e-05
  2.2232045e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.5072961e-04  2.3148363e-04 -2.8816472e-05  9.5161020e-05
  2.2232045e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00052373  0.00181719 -0.00129974 -0.00148436  0.0021017 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00023637 -0.00606693 -0.00541174  0.01153174  0.07813323]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05109334 -0.24025606 -0.03896843  0.51964366  2.3710065 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05109334 -0.24025606 -0.03896843  0.51964366  2.3710065 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02937698  0.06690248  0.00209607  0.08244716 -0.5441325 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.07865366  0.13985378  0.00327366  0.15810706 -0.16165526]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.07865366  0.13985378  0.00327366  0.15810706 -0.16165526]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.10560331 -0.04601988  0.2508615   0.05017065 -0.17194426]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.10560331 -0.04601988  0.2508615   0.05017065 -0.17194426]
  [Layer 29] Output shape after mixer: (1, 1, 1024)
  [Layer 29] Output sample values after mixer: [ 0.10560331 -0.04601988  0.2508615   0.05017065 -0.17194426]
  [Layer 29] Residual connection shape: (1, 1, 1024)
  [Layer 29] Residual connection sample values: [ 1.7757822   1.6768541   0.90488327  0.6151524  -4.4341173 ]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.13404171  0.12081748  0.06646407  0.05301941 -0.32528722]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.13404171  0.12081748  0.06646407  0.05301941 -0.32528722]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.13404171  0.12081748  0.06646407  0.05301941 -0.32528722]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.17543922 -0.75153494 -0.15331908 -2.0277781   1.4158003 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.17543922 -0.75153494 -0.15331908 -2.0277781   1.4158003 ]
  [FlaxMamba2] xBC (step) sample values: [-1.4863043  -0.41157708 -0.71051013  0.2246264  -0.4035698 ]
  [FlaxMamba2] dt (step) sample values: [-0.63787687 -0.15825197 -0.6375078  -0.34641066 -0.9813944 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.9774104  -0.46683487  0.1416911  -1.4863043   1.0288047 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00168246  0.20955771  0.24564019  0.14137897  0.6557572 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04449862  0.16774863  0.8208355   0.19081745  0.5632279 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.02175436  0.09089276  0.56999934  0.10448403  0.3588883 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02175436  0.09089276  0.56999934  0.10448403  0.3588883 ]
  [FlaxMamba2] B (step) sample values: [ 0.03747884  0.08869451 -0.03988384 -0.0373885  -0.09410948]
  [FlaxMamba2] C (step) sample values: [-0.07979424  0.02194777 -0.18161364 -0.23803072 -0.19366272]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2037584  -0.36680323 -0.20777717 -0.09522027 -0.4265393 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.31105277 0.2060844  0.25823733 0.07121889 0.10352144]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9385871  0.92719406 0.94775826 0.9932415  0.9568047 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02175436  0.09089276  0.56999934  0.10448403  0.3588883 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00025361 -0.00060017  0.00026988  0.000253    0.00063682]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00025361 -0.00060017  0.00026988  0.000253    0.00063682]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00596465 -0.02220153 -0.00977001 -0.00668876  0.04632677]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.08034038 -0.05210925  0.7674453   0.17287292 -0.13989022]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.08393334 -0.03709735  0.8615867   0.19012955 -0.08061604]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.08393334 -0.03709735  0.8615867   0.19012955 -0.08061604]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00671841  0.00893516 -0.06099546 -0.04484496 -0.09184304]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01145646  0.01682913 -0.06944923 -0.08476252 -0.06364732]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01145646  0.01682913 -0.06944923 -0.08476252 -0.06364732]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.64564496  0.21456647 -0.01514252 -1.4259446  -0.5717484 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.64564496  0.21456647 -0.01514252 -1.4259446  -0.5717484 ]
  [Layer 30] Output shape after mixer: (1, 1, 1024)
  [Layer 30] Output sample values after mixer: [ 0.64564496  0.21456647 -0.01514252 -1.4259446  -0.5717484 ]
  [Layer 30] Residual connection shape: (1, 1, 1024)
  [Layer 30] Residual connection sample values: [ 2.4214272   1.8914206   0.88974077 -0.81079215 -5.0058656 ]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.12122511  0.0960307   0.04474045 -0.04597452 -0.2510543 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.12122511  0.0960307   0.04474045 -0.04597452 -0.2510543 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.12122511  0.0960307   0.04474045 -0.04597452 -0.2510543 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.902158   -0.28498223 -0.05369708 -0.01455293  0.2980807 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.902158   -0.28498223 -0.05369708 -0.01455293  0.2980807 ]
  [FlaxMamba2] xBC (step) sample values: [-0.52536213  0.2242996   0.425134    0.337045   -0.17163657]
  [FlaxMamba2] dt (step) sample values: [1.2074808 1.4749849 2.0784986 1.7713907 0.5815941]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.23523258  0.23937568  0.22414674 -0.52536213 -0.04496231]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.10153908 -0.05421602 -0.10517432 -0.12975226 -0.15762992]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.09863228 -0.01927339 -0.11574866 -0.14791022 -0.21793266]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.05174625 -0.00954383 -0.05452863 -0.0684957  -0.09713944]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05174625 -0.00954383 -0.05452863 -0.0684957  -0.09713944]
  [FlaxMamba2] B (step) sample values: [-0.03669095 -0.00888642 -0.00450854  0.0377205   0.01729571]
  [FlaxMamba2] C (step) sample values: [-0.11211509  0.0624143   0.01688151 -0.15479374 -0.1315704 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-9.5765535e-03 -1.0641767e-02 -2.6350424e+01 -6.4467737e+02
 -1.6546801e-02]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1461496  0.23309161 2.698472   2.8642848  0.10969173]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.9860138e-01 9.9752259e-01 1.3155531e-31 0.0000000e+00 9.9818659e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05174625 -0.00954383 -0.05452863 -0.0684957  -0.09713944]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.7748247e-04 -6.7205270e-05 -3.4096731e-05  2.8526862e-04
  1.3080219e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.7748247e-04 -6.7205270e-05 -3.4096731e-05  2.8526862e-04
  1.3080219e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01613875 -0.01081787  0.00772173  0.01584242  0.00612598]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0228023  -0.0248777  -0.01175636  0.00189386 -0.11845249]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02929585 -0.02368006 -0.00491365  0.01048928 -0.10626261]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02929585 -0.02368006 -0.00491365  0.01048928 -0.10626261]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 7.6277419e-03  2.8966330e-03  1.2838308e-04 -7.5769531e-05
 -1.8180508e-02]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07591815  0.02607275  0.00117    -0.00305645 -0.04783295]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.07591815  0.02607275  0.00117    -0.00305645 -0.04783295]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.3752809   0.21896605  0.03980898  0.02474676 -0.2129928 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.3752809   0.21896605  0.03980898  0.02474676 -0.2129928 ]
  [Layer 31] Output shape after mixer: (1, 1, 1024)
  [Layer 31] Output sample values after mixer: [-0.3752809   0.21896605  0.03980898  0.02474676 -0.2129928 ]
  [Layer 31] Residual connection shape: (1, 1, 1024)
  [Layer 31] Residual connection sample values: [ 2.0461464   2.1103866   0.92954975 -0.7860454  -5.2188582 ]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.17338657  0.17500143  0.07654715 -0.07763396 -0.44870228]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.17338657  0.17500143  0.07654715 -0.07763396 -0.44870228]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.17338657  0.17500143  0.07654715 -0.07763396 -0.44870228]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.0552796 -0.7785151 -0.6716674  1.916063  -1.4841076]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.0552796 -0.7785151 -0.6716674  1.916063  -1.4841076]
  [FlaxMamba2] xBC (step) sample values: [-0.19211957  0.51302737  0.8440639  -1.7478799   1.6376331 ]
  [FlaxMamba2] dt (step) sample values: [-1.5189894  -0.8378387  -0.39673078 -0.82861286 -1.1228166 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.01557062  0.35602915 -1.2513026  -0.19211957 -0.08574536]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.48494765 -0.00657975 -0.04660282  0.24114901 -0.42443413]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.47126052 -0.37449968 -0.04867993  0.21766573 -0.4367327 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.29014665 -0.15259147 -0.02374765  0.12063092 -0.17142624]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.29014665 -0.15259147 -0.02374765  0.12063092 -0.17142624]
  [FlaxMamba2] B (step) sample values: [ 0.03651686  0.08858065  0.14039823 -0.02427324 -0.10136126]
  [FlaxMamba2] C (step) sample values: [-0.23665228 -0.07047939 -0.20066129 -0.26277137 -0.27665275]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.0662153  -0.08112868 -0.58786964 -0.09559295 -0.5447535 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.31830037 0.595003   0.30144027 0.4762008  0.23663844]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9791442 0.9528748 0.8376059 0.9554991 0.8790534]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.29014665 -0.15259147 -0.02374765  0.12063092 -0.17142624]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00337247  0.00818076  0.01296631 -0.00224173 -0.0093611 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00337247  0.00818076  0.01296631 -0.00224173 -0.0093611 ]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.01945567 0.11514314 0.11386232 0.22107169 0.12300899]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.25203255 -0.90466666  0.04481639  0.67208123 -0.23648131]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.24546368 -0.90121204  0.04535403  0.66935015 -0.23260026]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.24546368 -0.90121204  0.04535403  0.66935015 -0.23260026]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.06688553  0.2207537  -0.0103002   1.1179684   0.06379636]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.0143366   0.10276067 -0.00477942  0.32505053  0.02089712]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0143366   0.10276067 -0.00477942  0.32505053  0.02089712]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.12738726  0.43375593 -0.05835366 -0.5370959   0.16639866]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.12738726  0.43375593 -0.05835366 -0.5370959   0.16639866]
  [Layer 32] Output shape after mixer: (1, 1, 1024)
  [Layer 32] Output sample values after mixer: [ 0.12738726  0.43375593 -0.05835366 -0.5370959   0.16639866]
  [Layer 32] Residual connection shape: (1, 1, 1024)
  [Layer 32] Residual connection sample values: [ 2.1735337  2.5441425  0.8711961 -1.3231413 -5.0524597]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.18934116  0.21644804  0.07546778 -0.12105694 -0.4450482 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.18934116  0.21644804  0.07546778 -0.12105694 -0.4450482 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.18934116  0.21644804  0.07546778 -0.12105694 -0.4450482 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.43768442 -0.26695406  2.6218562  -0.9274278   0.5643276 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.43768442 -0.26695406  2.6218562  -0.9274278   0.5643276 ]
  [FlaxMamba2] xBC (step) sample values: [-2.6468818   0.47880173  1.0251514   0.8951552   2.8061922 ]
  [FlaxMamba2] dt (step) sample values: [-1.2742015  -1.1979055  -0.5550318  -0.14947227 -2.0791705 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.29317662  1.7261065   0.5544128  -2.6468818  -0.4517366 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.64080495  0.12361465  0.15233272  0.29930377  0.5561948 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.9110686   0.08702408  0.13896602  0.17637897  0.521832  ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.26127738  0.04540414  0.07430314  0.09594677  0.32748926]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.26127738  0.04540414  0.07430314  0.09594677  0.32748926]
  [FlaxMamba2] B (step) sample values: [-0.26095274 -0.00690265 -0.03217046  0.0382304  -0.12353768]
  [FlaxMamba2] C (step) sample values: [-0.04333521 -0.15560693  0.11364631 -0.13204974  0.01648351]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-13.044406    -1.3849771   -0.1667907   -0.23590268  -5.254998  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00396563 0.00145803 0.03218035 0.04531619 0.00104384]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9495859  0.9979827  0.994647   0.9893667  0.99452966]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.26127738  0.04540414  0.07430314  0.09594677  0.32748926]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.7038067e-04  7.1520330e-06  3.3332744e-05 -3.9611623e-05
  1.2800096e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.7038067e-04  7.1520330e-06  3.3332744e-05 -3.9611623e-05
  1.2800096e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.3331947e-04  1.3883341e-04 -6.6617082e-05 -1.2674110e-04
 -2.9699173e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 1.3098026e-04 -7.3020215e-06  2.9607777e-06 -1.2907987e-04
 -1.1468684e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.2797237   0.04862516  0.0795892   0.10263968  0.3506597 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.2797237   0.04862516  0.0795892   0.10263968  0.3506597 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.04802869 -0.00562914  0.19453499 -0.02698156  0.12614368]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15957521 -0.01813284  0.85522366 -0.0996845   0.5269347 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.15957521 -0.01813284  0.85522366 -0.0996845   0.5269347 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.07915536 -0.52438474  0.550325   -0.88970965 -0.06880986]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.07915536 -0.52438474  0.550325   -0.88970965 -0.06880986]
  [Layer 33] Output shape after mixer: (1, 1, 1024)
  [Layer 33] Output sample values after mixer: [ 0.07915536 -0.52438474  0.550325   -0.88970965 -0.06880986]
  [Layer 33] Residual connection shape: (1, 1, 1024)
  [Layer 33] Residual connection sample values: [ 2.2526891  2.0197577  1.4215211 -2.212851  -5.1212697]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.16621162  0.146797    0.10904663 -0.16561943 -0.38590565]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.16621162  0.146797    0.10904663 -0.16561943 -0.38590565]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.16621162  0.146797    0.10904663 -0.16561943 -0.38590565]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.3931901  -1.4248267  -1.1794415  -0.23328277 -1.2019897 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.3931901  -1.4248267  -1.1794415  -0.23328277 -1.2019897 ]
  [FlaxMamba2] xBC (step) sample values: [-0.55013376 -0.9520018   0.06547806 -0.58508873  1.1019924 ]
  [FlaxMamba2] dt (step) sample values: [ 0.7416018  -0.5876454  -0.8521002  -0.86137784 -0.4628402 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.7558019  -0.56008327  0.06419    -0.55013376 -1.7026213 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.12961057  0.68450916 -0.00439787  0.11581207  0.24983042]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.17297605  0.58728015 -0.03839445  0.03469635  0.17579478]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.07902645  0.37746894 -0.01882873  0.0176491   0.0956035 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07902645  0.37746894 -0.01882873  0.0176491   0.0956035 ]
  [FlaxMamba2] B (step) sample values: [-0.01013297  0.01483325 -0.08024048  0.0360347  -0.06849504]
  [FlaxMamba2] C (step) sample values: [-0.27049595 -0.18865667 -0.03639867 -0.04610911 -0.08392134]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2224774  -0.15365478 -0.8168739  -0.85911244 -2.0730147 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0273179  0.00397737 0.08675898 0.04332702 0.11408457]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99394083 0.99938905 0.9315819  0.96346146 0.7893867 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07902645  0.37746894 -0.01882873  0.0176491   0.0956035 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.1875436e-05 -3.2022566e-05  1.7322610e-04 -7.7793040e-05
  1.4786961e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.1875436e-05 -3.2022566e-05  1.7322610e-04 -7.7793040e-05
  1.4786961e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00304451  0.00732808  0.00362136 -0.00657164  0.01060408]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00151111  0.02027588  0.02163662  0.00199118 -0.00519956]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.15397441  0.7629508  -0.01540914  0.03671601  0.18290152]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.15397441  0.7629508  -0.01540914  0.03671601  0.18290152]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.03614616 -0.21078993  0.00427371 -0.00378533 -0.05081106]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.08705398 -0.28389108  0.00860739 -0.00900992 -0.1289029 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.08705398 -0.28389108  0.00860739 -0.00900992 -0.1289029 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.3671225  -0.8178244   0.3876185   0.4518106   0.10196645]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.3671225  -0.8178244   0.3876185   0.4518106   0.10196645]
  [Layer 34] Output shape after mixer: (1, 1, 1024)
  [Layer 34] Output sample values after mixer: [-0.3671225  -0.8178244   0.3876185   0.4518106   0.10196645]
  [Layer 34] Residual connection shape: (1, 1, 1024)
  [Layer 34] Residual connection sample values: [ 1.8855666  1.2019334  1.8091396 -1.7610404 -5.0193033]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.18042494  0.11410979  0.1705528  -0.17964564 -0.47736055]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.18042494  0.11410979  0.1705528  -0.17964564 -0.47736055]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.18042494  0.11410979  0.1705528  -0.17964564 -0.47736055]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.3031287 -0.5781697  0.6363736 -3.424256   0.2641857]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.3031287 -0.5781697  0.6363736 -3.424256   0.2641857]
  [FlaxMamba2] xBC (step) sample values: [ 0.45207703  1.3669006  -0.9234552   0.36507958 -1.4567021 ]
  [FlaxMamba2] dt (step) sample values: [-2.2162101 -2.9453018 -1.7095358 -2.1817882 -1.6783733]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.0326835  -1.1648918   0.26968104  0.45207703  0.9422297 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.10658833  0.30591822 -0.14589413  0.0558386  -0.3300729 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.15804097  0.2841897  -0.17332943  0.03099729 -0.44231656]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.07278921  0.162151   -0.07917269  0.01573884 -0.17302944]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07278921  0.162151   -0.07917269  0.01573884 -0.17302944]
  [FlaxMamba2] B (step) sample values: [0.18930972 0.13782126 0.28898668 0.0325769  0.05062972]
  [FlaxMamba2] C (step) sample values: [ 0.18756181 -0.07949361 -0.19885851 -0.25152498  0.00885672]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.2053565  -0.14169171 -0.10705902 -0.1460468  -0.2580783 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.41645062 0.3794148  0.22412217 0.7731892  0.2345599 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.918034  0.9476596 0.9762913 0.8932205 0.941261 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07278921  0.162151   -0.07917269  0.01573884 -0.17302944]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00573857 -0.00417779 -0.00876009 -0.00098751 -0.00153474]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00573857 -0.00417779 -0.00876009 -0.00098751 -0.00153474]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.07407541 -0.0219318   0.00437989 -0.01957773 -0.03939353]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.10478299  0.3038354  -0.5472304  -0.05806058 -0.56518054]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.29539174  0.7284504  -0.75455517 -0.01684623 -1.0182823 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.29539174  0.7284504  -0.75455517 -0.01684623 -1.0182823 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03803668 -0.15134832 -0.314005    0.00181975 -0.1521727 ]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02528447 -0.09755844 -0.07000595  0.00174832 -0.08473755]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02528447 -0.09755844 -0.07000595  0.00174832 -0.08473755]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.18580197  0.4972662   1.4230883  -0.4098368   0.96541476]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.18580197  0.4972662   1.4230883  -0.4098368   0.96541476]
  [Layer 35] Output shape after mixer: (1, 1, 1024)
  [Layer 35] Output sample values after mixer: [-0.18580197  0.4972662   1.4230883  -0.4098368   0.96541476]
  [Layer 35] Residual connection shape: (1, 1, 1024)
  [Layer 35] Residual connection sample values: [ 1.6997646  1.6991996  3.2322278 -2.1708772 -4.0538883]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.14067903  0.14379099  0.269079   -0.19177678 -0.3437066 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.14067903  0.14379099  0.269079   -0.19177678 -0.3437066 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.14067903  0.14379099  0.269079   -0.19177678 -0.3437066 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.3570685 -0.8371193 -1.8280531 -0.3070291 -1.2720138]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.3570685 -0.8371193 -1.8280531 -0.3070291 -1.2720138]
  [FlaxMamba2] xBC (step) sample values: [-0.6126697  1.4652989 -0.2721087 -0.4805301 -1.8000637]
  [FlaxMamba2] dt (step) sample values: [-0.8670198   0.12008315  0.04328205  0.16444254  0.7803685 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.9087267  -1.8935751   0.27150157 -0.6126697   1.4494094 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.14683494  0.33925638 -0.07948463 -0.13914575 -0.28747898]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.18711814  0.22170267 -0.1415879  -0.28379905 -0.2996021 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.10228693  0.12308926 -0.06579052 -0.12189811 -0.12752704]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.10228693  0.12308926 -0.06579052 -0.12189811 -0.12752704]
  [FlaxMamba2] B (step) sample values: [-0.05931711  0.07831897  0.19612397  0.0369591  -0.06999825]
  [FlaxMamba2] C (step) sample values: [-6.3977562e-02  9.6804865e-02 -1.5482066e-05  3.1023610e-03
 -4.6788368e-02]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.8654757 -5.63779   -3.8975632 -2.4259677 -3.6937442]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02998525 0.01928995 0.01894518 0.04651913 0.05339483]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9176658  0.8969522  0.92882025 0.89328116 0.8210044 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.10228693  0.12308926 -0.06579052 -0.12189811 -0.12752704]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00018193  0.00024021  0.00060153  0.00011336 -0.00021469]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00018193  0.00024021  0.00060153  0.00011336 -0.00021469]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00407004 -0.00087832 -0.00260765  0.00231649  0.00074071]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00362934  0.00850463 -0.00867284 -0.01105426 -0.00799151]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.31732655  0.3859992  -0.21044156 -0.38489577 -0.39909604]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.31732655  0.3859992  -0.21044156 -0.38489577 -0.39909604]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.08815815 -0.0976303   0.05326932  0.05008696  0.11113229]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.08002181 -0.1892481   0.07133478  0.07152002  0.18057917]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.08002181 -0.1892481   0.07133478  0.07152002  0.18057917]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.4329604   0.80001795 -0.08802795 -1.9097636   0.15837166]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.4329604   0.80001795 -0.08802795 -1.9097636   0.15837166]
  [Layer 36] Output shape after mixer: (1, 1, 1024)
  [Layer 36] Output sample values after mixer: [ 0.4329604   0.80001795 -0.08802795 -1.9097636   0.15837166]
  [Layer 36] Residual connection shape: (1, 1, 1024)
  [Layer 36] Residual connection sample values: [ 2.132725   2.4992175  3.1441998 -4.080641  -3.8955166]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.1653758   0.19899493  0.25578195 -0.32411134 -0.3098664 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.1653758   0.19899493  0.25578195 -0.32411134 -0.3098664 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.1653758   0.19899493  0.25578195 -0.32411134 -0.3098664 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.7061863   0.21312517 -0.36619523  0.4604256  -2.0076914 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.7061863   0.21312517 -0.36619523  0.4604256  -2.0076914 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.8356903  -1.0356817   1.0038563   0.21631227  1.7048728 ]
  [FlaxMamba2] dt (step) sample values: [ 1.4978983   0.63993686 -1.2591742  -0.75176144  1.4292505 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.16051315 -0.06146366  0.5326118   1.8356903  -0.9571513 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.47957247  0.26679036 -0.36413124 -0.06250995  0.12480849]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.55733126  0.20270345 -0.44872597 -0.02762836  0.04119033]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.20296064  0.11158887 -0.17485224 -0.01362336  0.02101926]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.20296064  0.11158887 -0.17485224 -0.01362336  0.02101926]
  [FlaxMamba2] B (step) sample values: [-0.05057001 -0.012173    0.13135684 -0.04794601  0.03097868]
  [FlaxMamba2] C (step) sample values: [-0.26914814 -0.15455891 -0.12363114 -0.26701894 -0.12564933]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.8178532  -31.169907   -39.01954     -0.46187502  -0.64770097]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0028209  0.01366816 0.00095017 0.00034951 0.00689786]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99488515 0.6530933  0.9636036  0.9998386  0.9955422 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.20296064  0.11158887 -0.17485224 -0.01362336  0.02101926]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.8952903e-05  6.9694192e-06 -7.5205877e-05  2.7450582e-05
 -1.7736258e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.8952903e-05  6.9694192e-06 -7.5205877e-05  2.7450582e-05
 -1.7736258e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00037611  0.00036387 -0.0006871   0.00092364 -0.00058627]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00153771  0.00326576  0.00011427 -0.00033044 -0.00021903]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.37328297  0.20765334 -0.3201473  -0.02528316  0.03828012]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.37328297  0.20765334 -0.3201473  -0.02528316  0.03828012]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.17650037  0.02447722  0.0480037  -0.00713728 -0.00909942]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.5113131   0.05127633  0.09458131 -0.0222485  -0.01513625]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.5113131   0.05127633  0.09458131 -0.0222485  -0.01513625]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.3327234   0.9457436  -0.44394308  1.9025099   0.30921277]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.3327234   0.9457436  -0.44394308  1.9025099   0.30921277]
  [Layer 37] Output shape after mixer: (1, 1, 1024)
  [Layer 37] Output sample values after mixer: [-0.3327234   0.9457436  -0.44394308  1.9025099   0.30921277]
  [Layer 37] Residual connection shape: (1, 1, 1024)
  [Layer 37] Residual connection sample values: [ 1.8000016  3.444961   2.7002568 -2.1781309 -3.586304 ]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.13986315  0.26767924  0.20881537 -0.1640059  -0.28051957]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.13986315  0.26767924  0.20881537 -0.1640059  -0.28051957]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.13986315  0.26767924  0.20881537 -0.1640059  -0.28051957]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.9007624  -0.9550195  -0.07034691 -2.6320853   0.8218052 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.9007624  -0.9550195  -0.07034691 -2.6320853   0.8218052 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.01865632 -0.89852947  1.2857221   0.00670218  0.4822723 ]
  [FlaxMamba2] dt (step) sample values: [-2.6056318  -1.8853652  -2.579297   -2.3130078  -0.35401466]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.45082816 -0.22204053  1.8935394   0.01865632 -1.5422729 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.33640987  0.39283437  0.25318342 -0.06120541  0.08063614]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.33879977  0.10352772  0.16309553 -0.10438778  0.17359269]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.14097494  0.05444097  0.0881831  -0.04947216  0.09431109]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.14097494  0.05444097  0.0881831  -0.04947216  0.09431109]
  [FlaxMamba2] B (step) sample values: [ 0.00895793  2.6039279   0.06385462 -0.03947643  0.0720574 ]
  [FlaxMamba2] C (step) sample values: [-0.25497267  0.02539393 -0.19269831 -0.24764267 -0.11868816]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.17041285 -2.0831616  -0.13507122 -0.41240796 -3.531486  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08643563 0.01892806 0.06976036 0.03375832 0.07003449]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9853782  0.96133703 0.9906216  0.9861743  0.78088623]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.14097494  0.05444097  0.0881831  -0.04947216  0.09431109]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00010915 -0.03172953 -0.00077809  0.00048103 -0.00087804]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00010915 -0.03172953 -0.00077809  0.00048103 -0.00087804]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00167327  0.07964011 -0.00778809 -0.00551243 -0.00028506]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.18102778 -0.19984192 -0.05349895 -0.10158973  0.26668504]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.20170328 -0.19185756 -0.04056594 -0.10884536  0.28051677]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.20170328 -0.19185756 -0.04056594 -0.10884536  0.28051677]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [0.04984922 0.05091467 0.00137668 0.01922401 0.16013071]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.07769274 0.05342695 0.00159758 0.04454315 0.25653514]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.07769274 0.05342695 0.00159758 0.04454315 0.25653514]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.607924   1.5166241  4.324457  -1.8826796 -2.9994411]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.607924   1.5166241  4.324457  -1.8826796 -2.9994411]
  [Layer 38] Output shape after mixer: (1, 1, 1024)
  [Layer 38] Output sample values after mixer: [ 2.607924   1.5166241  4.324457  -1.8826796 -2.9994411]
  [Layer 38] Residual connection shape: (1, 1, 1024)
  [Layer 38] Residual connection sample values: [ 4.4079256  4.961585   7.024714  -4.0608106 -6.585745 ]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.22613257  0.27681205  0.3800891  -0.23044457 -0.35459834]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.22613257  0.27681205  0.3800891  -0.23044457 -0.35459834]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.22613257  0.27681205  0.3800891  -0.23044457 -0.35459834]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.08404575 -0.14815035 -0.62282944  0.5668173  -0.89767045]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.08404575 -0.14815035 -0.62282944  0.5668173  -0.89767045]
  [FlaxMamba2] xBC (step) sample values: [ 0.2805031  -0.277252    0.15528648 -0.2442222   1.0678204 ]
  [FlaxMamba2] dt (step) sample values: [3.2569387 1.131406  1.5794648 1.4063164 1.5582426]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.25050467 -0.11333404  0.22376694  0.2805031   0.3018824 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.0528501   0.03057707  0.03247575 -0.05498901  0.3273563 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.11730322 -0.03015291  0.04773454  0.48260865  0.3239536 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.06208768 -0.01484917  0.02443681  0.29842767  0.18798621]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06208768 -0.01484917  0.02443681  0.29842767  0.18798621]
  [FlaxMamba2] B (step) sample values: [-0.0176671  -0.02918761 -0.27609104  0.08275223 -0.01991711]
  [FlaxMamba2] C (step) sample values: [-0.19220756 -0.18034047  0.00287813 -0.06265723 -0.2719788 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.7351256e+02 -2.3790452e+00 -2.6078771e-03 -1.4978828e+00
 -6.3306607e-02]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [2.2004867 0.6726391 0.9018159 0.4376499 0.041689 ]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.         0.20184831 0.9976509  0.51915735 0.9973643 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06208768 -0.01484917  0.02443681  0.29842767  0.18798621]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00241373 -0.0039877  -0.03772042  0.01130587 -0.00272114]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00241373 -0.0039877  -0.03772042  0.01130587 -0.00272114]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00241373 -0.0039877  -0.03772042  0.01130587 -0.00272114]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01195208 -0.00285852  0.00470417  0.05744832  0.03618797]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.29289028 -0.07004897  0.11527735  1.4077922   0.8867996 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.29289028 -0.07004897  0.11527735  1.4077922   0.8867996 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01282501  0.00480522 -0.02506747  0.5091218  -0.23048101]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02317668  0.00822671 -0.04060782  0.8047627  -0.4394789 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02317668  0.00822671 -0.04060782  0.8047627  -0.4394789 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.43080783 -1.848423   -2.2631524  -2.443113   -0.08699276]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.43080783 -1.848423   -2.2631524  -2.443113   -0.08699276]
  [Layer 39] Output shape after mixer: (1, 1, 1024)
  [Layer 39] Output sample values after mixer: [ 0.43080783 -1.848423   -2.2631524  -2.443113   -0.08699276]
  [Layer 39] Residual connection shape: (1, 1, 1024)
  [Layer 39] Residual connection sample values: [ 4.8387337  3.113162   4.7615614 -6.5039234 -6.6727376]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.31534085  0.21649145  0.3243395  -0.40575314 -0.45020103]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.31534085  0.21649145  0.3243395  -0.40575314 -0.45020103]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.31534085  0.21649145  0.3243395  -0.40575314 -0.45020103]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.1099288   1.6673621   1.8229978   0.3744159   0.74950594]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-2.1099288   1.6673621   1.8229978   0.3744159   0.74950594]
  [FlaxMamba2] xBC (step) sample values: [-1.4361931   0.8096871   0.27372754  0.94187176  0.32024395]
  [FlaxMamba2] dt (step) sample values: [ 1.2693648   0.06024304  0.09533171 -4.2111917   0.13748741]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.0063157  -3.3809352  -0.48685253 -1.4361931   0.3283075 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.21845363 -0.14553757  0.04843062 -0.10859956  0.04884826]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.1128452  -0.19403    -0.02322465 -0.12015046  0.05038081]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.05960274 -0.08763251 -0.01147749 -0.05647054  0.02582483]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05960274 -0.08763251 -0.01147749 -0.05647054  0.02582483]
  [FlaxMamba2] B (step) sample values: [-0.04910551 -0.27840045  0.02932664 -0.04481677 -0.02298772]
  [FlaxMamba2] C (step) sample values: [-0.16892369 -0.24123943 -0.15185519 -0.21033596 -0.2480835 ]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-0.52670574 -0.63007647 -0.38779998 -2.7909086  -0.42841786]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [6.2192697e-02 1.3753181e-02 3.0434160e-02 9.0261565e-05 1.8447174e-02]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.96777344 0.99137187 0.988267   0.9997481  0.9921281 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05960274 -0.08763251 -0.01147749 -0.05647054  0.02582483]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.82026997e-04 -1.03199005e-03  1.08709595e-04 -1.66129277e-04
 -8.52121448e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.82026997e-04 -1.03199005e-03  1.08709595e-04 -1.66129277e-04
 -8.52121448e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00127839 -0.03160596 -0.00604446 -0.00077233 -0.0006567 ]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 5.8363806e-03 -2.3880799e-03 -1.0248641e-03 -4.6448837e-05
  4.6939943e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.15339035 -0.21933322 -0.02943881 -0.13984627  0.06862656]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.15339035 -0.21933322 -0.02943881 -0.13984627  0.06862656]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.03499728 -0.30764216 -0.04620318 -0.03102504  0.03492871]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.10309578 -1.0729403  -0.16404052 -0.08705275  0.16142167]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.10309578 -1.0729403  -0.16404052 -0.08705275  0.16142167]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 4.9174657 -4.2561707  1.6236126  1.1216094 -1.0270944]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 4.9174657 -4.2561707  1.6236126  1.1216094 -1.0270944]
  [Layer 40] Output shape after mixer: (1, 1, 1024)
  [Layer 40] Output sample values after mixer: [ 4.9174657 -4.2561707  1.6236126  1.1216094 -1.0270944]
  [Layer 40] Residual connection shape: (1, 1, 1024)
  [Layer 40] Residual connection sample values: [ 9.756199  -1.1430087  6.385174  -5.3823137 -7.699832 ]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.38780624 -0.04857754  0.26179034 -0.21140386 -0.30670786]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.38780624 -0.04857754  0.26179034 -0.21140386 -0.30670786]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.38780624 -0.04857754  0.26179034 -0.21140386 -0.30670786]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.57055473 -1.7059288  -0.84927404 -0.12619758  0.5842941 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.57055473 -1.7059288  -0.84927404 -0.12619758  0.5842941 ]
  [FlaxMamba2] xBC (step) sample values: [-0.6208161   0.44387633 -0.9343984   1.9193702  -1.3108    ]
  [FlaxMamba2] dt (step) sample values: [-0.27599624 -1.1411821  -1.7036353   0.3763239   0.11957966]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.5914106  -0.43994457 -0.31086007 -0.6208161  -0.19439152]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.15376553 -0.09512213 -0.20040298 -0.30872107  0.28879723]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.18544278  0.02725336 -0.20034045 -0.40143347  0.2792376 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.08414868  0.01381235 -0.09016958 -0.16096197  0.15898652]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08414868  0.01381235 -0.09016958 -0.16096197  0.15898652]
  [FlaxMamba2] B (step) sample values: [ 0.00683884 -0.10391928  0.02262581 -0.0908814  -0.04686926]
  [FlaxMamba2] C (step) sample values: [-0.15801752 -0.07862118 -0.10003252  0.19111261 -0.24495117]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.0530885  -1.135641   -0.87189615 -1.5713016  -1.7430981 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05433103 0.07183599 0.01944942 0.1789999  0.09184685]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.94439065 0.92165905 0.9831851  0.75482994 0.8520602 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08414868  0.01381235 -0.09016958 -0.16096197  0.15898652]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.12663688e-05  4.75106965e-04 -1.03442595e-04  4.15499293e-04
  2.14280837e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.12663688e-05  4.75106965e-04 -1.03442595e-04  4.15499293e-04
  2.14280837e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.0366689e-05 -7.1666185e-03 -6.1769648e-03  4.1092170e-04
 -4.9521090e-03]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00943031  0.0054757   0.00369599 -0.01188956  0.0040591 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.11706528  0.02314315 -0.11164033 -0.21777676  0.20741948]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.11706528  0.02314315 -0.11164033 -0.21777676  0.20741948]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.04267291 -0.00606787  0.02840464  0.01287553  0.07781319]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.46590766 -0.08844068  0.35742903  0.19692717  1.105119  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.46590766 -0.08844068  0.35742903  0.19692717  1.105119  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.5204694  2.0386672  4.57493    2.4246128  2.6762915]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.5204694  2.0386672  4.57493    2.4246128  2.6762915]
  [Layer 41] Output shape after mixer: (1, 1, 1024)
  [Layer 41] Output sample values after mixer: [-0.5204694  2.0386672  4.57493    2.4246128  2.6762915]
  [Layer 41] Residual connection shape: (1, 1, 1024)
  [Layer 41] Residual connection sample values: [ 9.235729   0.8956585 10.960104  -2.957701  -5.0235405]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.34241208  0.03568269  0.43444243 -0.10950725 -0.19596905]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.34241208  0.03568269  0.43444243 -0.10950725 -0.19596905]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.34241208  0.03568269  0.43444243 -0.10950725 -0.19596905]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.25449586  0.91410726  0.6219011  -1.3000499  -0.11909269]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.25449586  0.91410726  0.6219011  -1.3000499  -0.11909269]
  [FlaxMamba2] xBC (step) sample values: [ 0.98235315  0.27267924  0.41768217 -0.2389685   0.5267703 ]
  [FlaxMamba2] dt (step) sample values: [ 0.16373411 -0.9511022  -1.6497322  -2.2505527   0.38499215]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.09180145 -0.28390524 -0.03868053  0.98235315  2.7927175 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.20409381  0.08259726 -0.10367312  0.04065707  0.12655726]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.22496784  0.04683065 -0.09905352  0.03691676  0.08038417]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.09988438  0.0239635  -0.04707586  0.01879905  0.04180662]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09988438  0.0239635  -0.04707586  0.01879905  0.04180662]
  [FlaxMamba2] B (step) sample values: [ 0.02331928 -0.03020406  0.07003684 -0.00925308 -0.00246272]
  [FlaxMamba2] C (step) sample values: [-0.04980369 -0.12329373 -0.13910152 -0.18467367 -0.27707633]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-2.2458453 -1.7473589 -3.3796544 -1.2264227 -1.3705136]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.12097097 0.05238736 0.02629194 0.00220961 0.11180887]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.7620965  0.91252524 0.91497576 0.9972938  0.85792756]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09988438  0.0239635  -0.04707586  0.01879905  0.04180662]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.8176946e-04  3.6495907e-04 -8.4626296e-04  1.1180596e-04
  2.9757284e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.8176946e-04  3.6495907e-04 -8.4626296e-04  1.1180596e-04
  2.9757284e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-4.0989881e-04  2.5629354e-04 -6.0171331e-04 -6.7281289e-05
 -1.5004771e-06]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00311377  0.01191819 -0.01011355 -0.00541916 -0.00227359]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.13967745  0.0446815  -0.0744765   0.02028324  0.05488515]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.13967745  0.0446815  -0.0744765   0.02028324  0.05488515]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0200232   0.02915585 -0.0301362  -0.00564714 -0.00307383]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.25076675  0.35113338 -0.373659   -0.07093517 -0.026297  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.25076675  0.35113338 -0.373659   -0.07093517 -0.026297  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.2287471  0.5416815 -0.7559185 -4.7617087  1.2821592]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.2287471  0.5416815 -0.7559185 -4.7617087  1.2821592]
  [Layer 42] Output shape after mixer: (1, 1, 1024)
  [Layer 42] Output sample values after mixer: [ 2.2287471  0.5416815 -0.7559185 -4.7617087  1.2821592]
  [Layer 42] Residual connection shape: (1, 1, 1024)
  [Layer 42] Residual connection sample values: [11.464477   1.43734   10.2041855 -7.71941   -3.7413812]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.3899753   0.0535216   0.36365697 -0.2624018  -0.12937757]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.3899753   0.0535216   0.36365697 -0.2624018  -0.12937757]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.3899753   0.0535216   0.36365697 -0.2624018  -0.12937757]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.00170415  0.23450856 -0.31790376 -0.32051718 -0.44902787]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.00170415  0.23450856 -0.31790376 -0.32051718 -0.44902787]
  [FlaxMamba2] xBC (step) sample values: [ 0.22714107  0.4532833   0.43291196 -0.55010635 -0.33174306]
  [FlaxMamba2] dt (step) sample values: [-1.5620917  -0.25929818 -0.9708378  -0.07429055 -0.883286  ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [0.53693    0.31073657 0.05096196 0.22714107 0.6877494 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04613132 -0.06417436 -0.08037488 -0.10534804 -0.05320733]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03153628 -0.1184041  -0.10839002 -0.15316908 -0.06152337]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.01601676 -0.05570125 -0.05126078 -0.07073078 -0.0298157 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01601676 -0.05570125 -0.05126078 -0.07073078 -0.0298157 ]
  [FlaxMamba2] B (step) sample values: [-0.03409522 -0.0141154  -0.18998253 -0.26529118 -0.02618359]
  [FlaxMamba2] C (step) sample values: [-0.23225646 -0.17976938 -0.19354099 -0.23548056 -0.08154973]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-3.7045815 -2.655313  -8.210951  -2.2381823 -4.092597 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01323913 0.0617613  0.02415715 0.33278075 0.00052943]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9521378  0.84874576 0.82008016 0.47481787 0.9978356 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01601676 -0.05570125 -0.05126078 -0.07073078 -0.0298157 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.2298221e-06 -2.9931412e-06 -4.0285413e-05 -5.6254463e-05
 -5.5521787e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.2298221e-06 -2.9931412e-06 -4.0285413e-05 -5.6254463e-05
 -5.5521787e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00171821 -0.00019994 -0.00097362  0.00223763 -0.00182221]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [0.00276361 0.00106303 0.00020447 0.00211314 0.00070994]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02918134 -0.09080955 -0.08434409 -0.11454886 -0.04846751]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02918134 -0.09080955 -0.08434409 -0.11454886 -0.04846751]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 2.48858687e-05 -1.18906191e-02  1.12934075e-02  1.54404324e-02
  8.47879145e-03]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00027829 -0.17815994  0.13544573  0.18648653  0.10584257]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00027829 -0.17815994  0.13544573  0.18648653  0.10584257]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.1524682   1.1603881  -0.02392773 -0.92840654  0.18313907]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.1524682   1.1603881  -0.02392773 -0.92840654  0.18313907]
  [Layer 43] Output shape after mixer: (1, 1, 1024)
  [Layer 43] Output sample values after mixer: [-2.1524682   1.1603881  -0.02392773 -0.92840654  0.18313907]
  [Layer 43] Residual connection shape: (1, 1, 1024)
  [Layer 43] Residual connection sample values: [ 9.312008   2.5977283 10.180258  -8.647817  -3.558242 ]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.29796612  0.08595725  0.33774734 -0.27048442 -0.11525479]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.29796612  0.08595725  0.33774734 -0.27048442 -0.11525479]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.29796612  0.08595725  0.33774734 -0.27048442 -0.11525479]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-1.0920728   0.77969635  0.6706123  -0.14875658  0.09902674]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-1.0920728   0.77969635  0.6706123  -0.14875658  0.09902674]
  [FlaxMamba2] xBC (step) sample values: [-0.2239846  -0.1410906  -0.28001106  0.0048413   1.0230429 ]
  [FlaxMamba2] dt (step) sample values: [-0.57003397 -0.6135251  -0.7260196  -0.48533076 -2.024803  ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.83548874 -0.20393051  0.97556025 -0.2239846  -0.72035784]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.04524149  0.02802812 -0.04980784  0.00557723  0.19028229]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02375712 -0.02903975 -0.07854014 -0.00757585  0.19691223]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.01173747 -0.01430906 -0.03772872 -0.00377358  0.10811852]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01173747 -0.01430906 -0.03772872 -0.00377358  0.10811852]
  [FlaxMamba2] B (step) sample values: [ 0.07431478 -0.26096362 -0.27136827  0.19122967  0.07608613]
  [FlaxMamba2] C (step) sample values: [-0.16148819 -0.27846283 -0.1806122   0.07988958 -0.21615964]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-4.6876054  -0.9752563  -0.82549465 -1.2937802  -0.49527767]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05734837 0.02429477 0.01194656 0.02816268 0.00102734]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.76427585 0.97658485 0.99018663 0.9642195  0.99949133]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01173747 -0.01430906 -0.03772872 -0.00377358  0.10811852]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.0023100e-05  1.7566101e-04  1.8266463e-04 -1.2872138e-04
 -5.1215437e-05]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.0023100e-05  1.7566101e-04  1.8266463e-04 -1.2872138e-04
 -5.1215437e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00074633 -0.00270125 -0.00254903 -0.00028533 -0.00139408]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00209294 -0.00156039 -0.00048931  0.00327119  0.00072414]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01830492 -0.02642727 -0.06605585 -0.00328669  0.18861699]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01830492 -0.02642727 -0.06605585 -0.00328669  0.18861699]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00502213 -0.01412726 -0.02930925  0.00022631  0.00980109]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07028459 -0.18105507 -0.47606018  0.00315952  0.13417341]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.07028459 -0.18105507 -0.47606018  0.00315952  0.13417341]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.4947491e+00  1.7729962e+00  3.0887815e-01  2.6485797e-03
 -4.5147810e+00]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.4947491e+00  1.7729962e+00  3.0887815e-01  2.6485797e-03
 -4.5147810e+00]
  [Layer 44] Output shape after mixer: (1, 1, 1024)
  [Layer 44] Output sample values after mixer: [-1.4947491e+00  1.7729962e+00  3.0887815e-01  2.6485797e-03
 -4.5147810e+00]
  [Layer 44] Residual connection shape: (1, 1, 1024)
  [Layer 44] Residual connection sample values: [ 7.817259   4.3707247 10.489136  -8.645168  -8.073023 ]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.2783554   0.16802578  0.39240345 -0.30888605 -0.29122344]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.2783554   0.16802578  0.39240345 -0.30888605 -0.29122344]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.2783554   0.16802578  0.39240345 -0.30888605 -0.29122344]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.4865295 -1.3700027  0.9082331 -1.543251  -1.5945807]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.4865295 -1.3700027  0.9082331 -1.543251  -1.5945807]
  [FlaxMamba2] xBC (step) sample values: [-0.12933764 -2.3286178  -0.2813569   0.49733177  0.32193393]
  [FlaxMamba2] dt (step) sample values: [-0.258752    1.0301813  -0.66122544  1.1003709   0.8682302 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.88069165 -0.16219962  1.3444906  -0.12933764 -0.7049796 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00868905 -0.2620944  -0.03651413 -0.09822024  0.07311197]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01435006 -0.00403777 -0.05880722 -0.15421999  0.06236215]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.00712355 -0.00201481 -0.02853929 -0.0711758   0.03215302]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00712355 -0.00201481 -0.02853929 -0.0711758   0.03215302]
  [FlaxMamba2] B (step) sample values: [-0.02557793  0.00218484  0.06261588 -0.2729724  -0.11532228]
  [FlaxMamba2] C (step) sample values: [-0.26803985 -0.24723586 -0.15996087 -0.06227502 -0.23448662]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-1.3039274e+00 -3.9384812e-02 -6.8873577e+00 -8.0558503e-01
 -1.9935181e+03]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0017139  0.05109889 0.00399545 0.00188908 0.04497682]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.9977677  0.9979895  0.97285706 0.99847937 0.        ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00712355 -0.00201481 -0.02853929 -0.0711758   0.03215302]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.122823e-07 -2.667489e-08 -7.644807e-07  3.332735e-06  1.407976e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.122823e-07 -2.667489e-08 -7.644807e-07  3.332735e-06  1.407976e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00162343 0.00091933 0.00124717 0.00033573 0.00157522]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-8.5960346e-05  1.4014264e-02 -3.2652572e-03 -4.7053099e-03
  1.3195485e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01857381  0.00878521 -0.07733364 -0.18942879  0.0847667 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01857381  0.00878521 -0.07733364 -0.18942879  0.0847667 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00559633 -0.00243868 -0.05005357  0.05146963 -0.02280819]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03936321 -0.01286912 -0.3153691   0.30715603 -0.16325453]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03936321 -0.01286912 -0.3153691   0.30715603 -0.16325453]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.18069929  0.2021245  -2.4509182   2.2294679  -6.4852767 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.18069929  0.2021245  -2.4509182   2.2294679  -6.4852767 ]
  [Layer 45] Output shape after mixer: (1, 1, 1024)
  [Layer 45] Output sample values after mixer: [-0.18069929  0.2021245  -2.4509182   2.2294679  -6.4852767 ]
  [Layer 45] Residual connection shape: (1, 1, 1024)
  [Layer 45] Residual connection sample values: [  7.6365595   4.5728493   8.038218   -6.4157004 -14.5583   ]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.24505015  0.15781642  0.2718482  -0.20957446 -0.46240398]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.24505015  0.15781642  0.2718482  -0.20957446 -0.46240398]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.24505015  0.15781642  0.2718482  -0.20957446 -0.46240398]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-2.1492298  -0.48782253 -1.1228433  -0.23887473 -0.8254895 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-2.1492298  -0.48782253 -1.1228433  -0.23887473 -0.8254895 ]
  [FlaxMamba2] xBC (step) sample values: [-0.3091506  -0.11315376  3.7932904  -0.57926327 -1.0296721 ]
  [FlaxMamba2] dt (step) sample values: [-1.2999876  -1.4034226   0.02757265 -2.244891   -1.7839624 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.3816338   1.4706861   0.03051866 -0.3091506   0.8630739 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03258451  0.02150867  0.7438836   0.09188385  0.16867678]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.02286593 -0.01581433  0.94676447  0.0963852   0.16342394]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.01156367 -0.00784464  0.6821098   0.05051333  0.088374  ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01156367 -0.00784464  0.6821098   0.05051333  0.088374  ]
  [FlaxMamba2] B (step) sample values: [-0.02011347  0.00597902  0.04251132 -0.14104097 -0.0779105 ]
  [FlaxMamba2] C (step) sample values: [ 0.04612753  0.03116681 -0.05948355 -0.13521285  0.06453603]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.4426116  -0.9829804 -10.158994   -1.363838   -1.7559118]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00240151 0.00344521 0.00112126 0.00139116 0.00183538]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99654156 0.99661916 0.98867375 0.9981045  0.9967824 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01156367 -0.00784464  0.6821098   0.05051333  0.088374  ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.5855656e-07  1.6603903e-07  1.1805510e-06 -3.9167462e-06
 -2.1635958e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.5855656e-07  1.6603903e-07  1.1805510e-06 -3.9167462e-06
 -2.1635958e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.6600501e-03  2.0031691e-04 -3.4264791e-05  6.9823716e-04
 -8.6450583e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00212478  0.00059511 -0.00535887  0.00126662  0.00358173]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01204209 -0.00901551  0.8303066   0.06315144  0.11185037]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01204209 -0.00901551  0.8303066   0.06315144  0.11185037]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00270208  0.00167302 -0.22886601 -0.00664603 -0.02812408]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.05394534  0.03105267 -3.6236095  -0.10417646 -0.44059816]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.05394534  0.03105267 -3.6236095  -0.10417646 -0.44059816]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [-3.40305   -4.1527157 -4.066783  -4.3159275 -1.3870734]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [-3.40305   -4.1527157 -4.066783  -4.3159275 -1.3870734]
  [Layer 46] Output shape after mixer: (1, 1, 1024)
  [Layer 46] Output sample values after mixer: [-3.40305   -4.1527157 -4.066783  -4.3159275 -1.3870734]
  [Layer 46] Residual connection shape: (1, 1, 1024)
  [Layer 46] Residual connection sample values: [  4.2335095   0.4201336   3.9714346 -10.731628  -15.945374 ]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.11234447  0.01162445  0.10763662 -0.26884747 -0.42342362]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.11234447  0.01162445  0.10763662 -0.26884747 -0.42342362]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.11234447  0.01162445  0.10763662 -0.26884747 -0.42342362]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [-0.63184077 -0.09932674 -1.0976391  -0.26126552  1.3548988 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [-0.63184077 -0.09932674 -1.0976391  -0.26126552  1.3548988 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.0950867 -0.2862564 -0.4545417 -0.2868368 -1.081737 ]
  [FlaxMamba2] dt (step) sample values: [ 1.7478974  -0.75593895 -0.47663373 -0.09161759 -1.2192129 ]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.1000143 -1.1328294 -2.0535622  0.0950867 -0.1829248]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.02813898 -0.04761843 -0.08659184  0.05050603 -0.1772525 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01521478 -0.03253512 -0.08770573  0.05730382 -0.17916653]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [ 0.00766526 -0.01600295 -0.04193103  0.02947262 -0.0815795 ]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00766526 -0.01600295 -0.04193103  0.02947262 -0.0815795 ]
  [FlaxMamba2] B (step) sample values: [-0.08976072 -0.01117215  0.01870186 -0.07407241 -0.22828208]
  [FlaxMamba2] C (step) sample values: [-0.2236173  -0.20681106 -0.18792683 -0.26500982 -0.27667212]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [-5.7667141e+01 -2.2024069e+00 -3.8371372e+00 -4.6045512e-02
 -2.0699801e+00]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [0.24080919 0.00208905 0.00806266 0.01619322 0.00120676]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [9.3121383e-07 9.9540961e-01 9.6953613e-01 9.9925464e-01 9.9750513e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00766526 -0.01600295 -0.04193103  0.02947262 -0.0815795 ]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.6568622e-04 -2.0622285e-05  3.4521127e-05 -1.3672771e-04
 -4.2137800e-04]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.6568622e-04 -2.0622285e-05  3.4521127e-05 -1.3672771e-04
 -4.2137800e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.6569263e-04 -2.0621474e-05  3.4508055e-05 -1.3672517e-04
 -4.2139218e-04]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00069029 -0.0014411  -0.00377596  0.00265407 -0.00734639]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01276919 -0.02665851 -0.06985077  0.04909694 -0.13589917]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01276919 -0.02665851 -0.06985077  0.04909694 -0.13589917]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00280038  0.00125825  0.01918173 -0.00558057 -0.14637004]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.0450376   0.02239056  0.31290793 -0.13038722 -2.759607  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0450376   0.02239056  0.31290793 -0.13038722 -2.759607  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.0301356 -1.9014187 -1.7381392 -4.5753    -1.9387522]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.0301356 -1.9014187 -1.7381392 -4.5753    -1.9387522]
  [Layer 47] Output shape after mixer: (1, 1, 1024)
  [Layer 47] Output sample values after mixer: [ 2.0301356 -1.9014187 -1.7381392 -4.5753    -1.9387522]
  [Layer 47] Residual connection shape: (1, 1, 1024)
  [Layer 47] Residual connection sample values: [  6.263645   -1.4812851   2.2332954 -15.306929  -17.884125 ]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.14392686 -0.03672371  0.0547152  -0.34301972 -0.42523748]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.14392686 -0.03672371  0.0547152  -0.34301972 -0.42523748]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 1024)
  [FlaxMamba2] u sample values: [ 0.14392686 -0.03672371  0.0547152  -0.34301972 -0.42523748]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 4384)
  [FlaxMamba2] in_proj output sample values: [ 0.5317066  -0.8538395   0.26093814  0.43498132 -0.18665582]
  [FlaxMamba2] Split shapes (step) -> z: (1, 2048), xBC: (1, 2304), dt: (1, 32)
  [FlaxMamba2] z (step) sample values: [ 0.5317066  -0.8538395   0.26093814  0.43498132 -0.18665582]
  [FlaxMamba2] xBC (step) sample values: [ 0.963097    1.3355925   0.37991858 -0.27772424 -0.12788521]
  [FlaxMamba2] dt (step) sample values: [-1.9276226 -1.942098  -2.5800145 -2.8813498 -1.5207912]
  [FlaxMamba2] conv_state updated shape: (1, 2304, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.9858096  -0.16182798 -1.2684846   0.963097    0.11738551]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 2304)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.14011703  0.20266357  0.03970687 -0.03227374 -0.01896251]
  [FlaxMamba2] Added conv1d bias shape: (1, 2304)
  [FlaxMamba2] xBC after adding bias sample values: [-0.13615738  0.17214599  0.02766769 -0.11235186 -0.1012379 ]
  [FlaxMamba2] xBC after silu shape: (1, 2304)
  [FlaxMamba2] xBC after silu sample values: [-0.06345113  0.09346332  0.01402521 -0.05302351 -0.04805886]
  [FlaxMamba2] Split xBC -> x: (1, 2048), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06345113  0.09346332  0.01402521 -0.05302351 -0.04805886]
  [FlaxMamba2] B (step) sample values: [ 0.16797778  0.14272358 -0.2548712   0.09752554 -0.01129616]
  [FlaxMamba2] C (step) sample values: [-0.10893175 -0.129539   -0.25351     0.05696115 -0.01021391]
  [FlaxMamba2] A shape: (32,)
  [FlaxMamba2] A sample values: [ -1.7303779  -7.389056   -3.3796544  -1.802826  -17.760078 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 32)
  [FlaxMamba2] dt after softplus (step) sample values: [1.6792634e-03 3.0817569e-05 4.8705537e-04 1.0923807e-03 2.1531958e-02]
  [FlaxMamba2] dA shape: (1, 32)
  [FlaxMamba2] dA sample values: [0.99709845 0.9997723  0.99835527 0.99803257 0.6822158 ]
[FlaxMamba2] Before rearrange, x shape: (1, 2048)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 32, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06345113  0.09346332  0.01402521 -0.05302351 -0.04805886]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.78982282e-05 -1.52073635e-05  2.71568224e-05 -1.03914599e-05
  1.20361869e-06]
  [FlaxMamba2] dBx shape: (1, 32, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.78982282e-05 -1.52073635e-05  2.71568224e-05 -1.03914599e-05
  1.20361869e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 32, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-7.6940123e-05  3.8326508e-04  4.4003347e-04 -1.6152070e-04
  1.1317636e-05]
  [FlaxMamba2] y after einsum shape: (1, 32, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00015571  0.00014778 -0.00037817 -0.00107248 -0.00095215]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 32, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.09009375  0.13308494  0.01957053 -0.07649025 -0.06930847]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 2048)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.09009375  0.13308494  0.01957053 -0.07649025 -0.06930847]
[FlaxRMSNorm] x after gated scaling shape: (1, 2048)
[FlaxRMSNorm] x after gated scaling sample values: [-0.03017347 -0.03393406  0.0028846  -0.02019808  0.00586648]
[FlaxRMSNorm] x_normalized shape: (1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.7368117  -0.9281158   0.07470641 -0.46035752  0.18206593]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 2048)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.7368117  -0.9281158   0.07470641 -0.46035752  0.18206593]
  [FlaxMamba2] y after out_proj (step) shape: (1, 1024)
  [FlaxMamba2] y after out_proj (step) sample values: [ -0.9950791 -11.394708    5.0911517   1.8112681  -1.070478 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 1024)
  [FlaxMamba2] y after expand_dims (step) sample values: [ -0.9950791 -11.394708    5.0911517   1.8112681  -1.070478 ]
  [Layer 48] Output shape after mixer: (1, 1, 1024)
  [Layer 48] Output sample values after mixer: [ -0.9950791 -11.394708    5.0911517   1.8112681  -1.070478 ]
  [Layer 48] Residual connection shape: (1, 1, 1024)
  [Layer 48] Residual connection sample values: [  5.268566 -12.875993   7.324447 -13.495661 -18.954603]
[FlaxRMSNorm] x_normalized shape: (1, 1, 1024)
[FlaxRMSNorm] x_normalized sample values: [ 0.29342228 -1.0359671   0.46669528 -0.67881924 -1.0858576 ]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 1, 1024)
[Mamba2LMHeadModel] Final backbone norm output sample values: [ 0.29342228 -1.0359671   0.46669528 -0.67881924 -1.0858576 ]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 1, 50288)
[Mamba2LMHeadModel] Logits sample values: [ -8.683298  -22.491318   -8.27615   -12.619677  -12.3742285]


---
Prompt eval | tokens: 135 | elapsed: 17.31s | tok/s: 7.80
Generation | tokens: 1 | elapsed: 1.21s | tok/s: 0.82
