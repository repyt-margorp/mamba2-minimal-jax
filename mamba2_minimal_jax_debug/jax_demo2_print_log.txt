[Mamba2LMHeadModel] Loading pre-trained model from HuggingFace ID: state-spaces/mamba2-1.3b
[Config] Initialized Mamba2Config with d_model=2048, n_layer=48, d_state=128, d_conv=4, expand=2, headdim=64, chunk_size=64, vocab_size=50288, pad_vocab_size_multiple=16
[Config] Computed d_inner=4096, nheads=64
[FlaxMamba2LMHeadModel] State Dict:

==== PyTorch State Dict ====

backbone.embedding.weight: torch.Size([50288, 2048])
backbone.layers.0.norm.weight: torch.Size([2048])
backbone.layers.0.mixer.dt_bias: torch.Size([64])
backbone.layers.0.mixer.A_log: torch.Size([64])
backbone.layers.0.mixer.D: torch.Size([64])
backbone.layers.0.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.0.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.0.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.0.mixer.norm.weight: torch.Size([4096])
backbone.layers.0.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.1.norm.weight: torch.Size([2048])
backbone.layers.1.mixer.dt_bias: torch.Size([64])
backbone.layers.1.mixer.A_log: torch.Size([64])
backbone.layers.1.mixer.D: torch.Size([64])
backbone.layers.1.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.1.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.1.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.1.mixer.norm.weight: torch.Size([4096])
backbone.layers.1.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.2.norm.weight: torch.Size([2048])
backbone.layers.2.mixer.dt_bias: torch.Size([64])
backbone.layers.2.mixer.A_log: torch.Size([64])
backbone.layers.2.mixer.D: torch.Size([64])
backbone.layers.2.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.2.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.2.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.2.mixer.norm.weight: torch.Size([4096])
backbone.layers.2.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.3.norm.weight: torch.Size([2048])
backbone.layers.3.mixer.dt_bias: torch.Size([64])
backbone.layers.3.mixer.A_log: torch.Size([64])
backbone.layers.3.mixer.D: torch.Size([64])
backbone.layers.3.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.3.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.3.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.3.mixer.norm.weight: torch.Size([4096])
backbone.layers.3.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.4.norm.weight: torch.Size([2048])
backbone.layers.4.mixer.dt_bias: torch.Size([64])
backbone.layers.4.mixer.A_log: torch.Size([64])
backbone.layers.4.mixer.D: torch.Size([64])
backbone.layers.4.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.4.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.4.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.4.mixer.norm.weight: torch.Size([4096])
backbone.layers.4.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.5.norm.weight: torch.Size([2048])
backbone.layers.5.mixer.dt_bias: torch.Size([64])
backbone.layers.5.mixer.A_log: torch.Size([64])
backbone.layers.5.mixer.D: torch.Size([64])
backbone.layers.5.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.5.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.5.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.5.mixer.norm.weight: torch.Size([4096])
backbone.layers.5.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.6.norm.weight: torch.Size([2048])
backbone.layers.6.mixer.dt_bias: torch.Size([64])
backbone.layers.6.mixer.A_log: torch.Size([64])
backbone.layers.6.mixer.D: torch.Size([64])
backbone.layers.6.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.6.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.6.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.6.mixer.norm.weight: torch.Size([4096])
backbone.layers.6.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.7.norm.weight: torch.Size([2048])
backbone.layers.7.mixer.dt_bias: torch.Size([64])
backbone.layers.7.mixer.A_log: torch.Size([64])
backbone.layers.7.mixer.D: torch.Size([64])
backbone.layers.7.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.7.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.7.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.7.mixer.norm.weight: torch.Size([4096])
backbone.layers.7.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.8.norm.weight: torch.Size([2048])
backbone.layers.8.mixer.dt_bias: torch.Size([64])
backbone.layers.8.mixer.A_log: torch.Size([64])
backbone.layers.8.mixer.D: torch.Size([64])
backbone.layers.8.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.8.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.8.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.8.mixer.norm.weight: torch.Size([4096])
backbone.layers.8.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.9.norm.weight: torch.Size([2048])
backbone.layers.9.mixer.dt_bias: torch.Size([64])
backbone.layers.9.mixer.A_log: torch.Size([64])
backbone.layers.9.mixer.D: torch.Size([64])
backbone.layers.9.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.9.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.9.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.9.mixer.norm.weight: torch.Size([4096])
backbone.layers.9.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.10.norm.weight: torch.Size([2048])
backbone.layers.10.mixer.dt_bias: torch.Size([64])
backbone.layers.10.mixer.A_log: torch.Size([64])
backbone.layers.10.mixer.D: torch.Size([64])
backbone.layers.10.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.10.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.10.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.10.mixer.norm.weight: torch.Size([4096])
backbone.layers.10.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.11.norm.weight: torch.Size([2048])
backbone.layers.11.mixer.dt_bias: torch.Size([64])
backbone.layers.11.mixer.A_log: torch.Size([64])
backbone.layers.11.mixer.D: torch.Size([64])
backbone.layers.11.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.11.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.11.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.11.mixer.norm.weight: torch.Size([4096])
backbone.layers.11.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.12.norm.weight: torch.Size([2048])
backbone.layers.12.mixer.dt_bias: torch.Size([64])
backbone.layers.12.mixer.A_log: torch.Size([64])
backbone.layers.12.mixer.D: torch.Size([64])
backbone.layers.12.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.12.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.12.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.12.mixer.norm.weight: torch.Size([4096])
backbone.layers.12.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.13.norm.weight: torch.Size([2048])
backbone.layers.13.mixer.dt_bias: torch.Size([64])
backbone.layers.13.mixer.A_log: torch.Size([64])
backbone.layers.13.mixer.D: torch.Size([64])
backbone.layers.13.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.13.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.13.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.13.mixer.norm.weight: torch.Size([4096])
backbone.layers.13.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.14.norm.weight: torch.Size([2048])
backbone.layers.14.mixer.dt_bias: torch.Size([64])
backbone.layers.14.mixer.A_log: torch.Size([64])
backbone.layers.14.mixer.D: torch.Size([64])
backbone.layers.14.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.14.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.14.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.14.mixer.norm.weight: torch.Size([4096])
backbone.layers.14.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.15.norm.weight: torch.Size([2048])
backbone.layers.15.mixer.dt_bias: torch.Size([64])
backbone.layers.15.mixer.A_log: torch.Size([64])
backbone.layers.15.mixer.D: torch.Size([64])
backbone.layers.15.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.15.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.15.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.15.mixer.norm.weight: torch.Size([4096])
backbone.layers.15.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.16.norm.weight: torch.Size([2048])
backbone.layers.16.mixer.dt_bias: torch.Size([64])
backbone.layers.16.mixer.A_log: torch.Size([64])
backbone.layers.16.mixer.D: torch.Size([64])
backbone.layers.16.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.16.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.16.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.16.mixer.norm.weight: torch.Size([4096])
backbone.layers.16.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.17.norm.weight: torch.Size([2048])
backbone.layers.17.mixer.dt_bias: torch.Size([64])
backbone.layers.17.mixer.A_log: torch.Size([64])
backbone.layers.17.mixer.D: torch.Size([64])
backbone.layers.17.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.17.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.17.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.17.mixer.norm.weight: torch.Size([4096])
backbone.layers.17.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.18.norm.weight: torch.Size([2048])
backbone.layers.18.mixer.dt_bias: torch.Size([64])
backbone.layers.18.mixer.A_log: torch.Size([64])
backbone.layers.18.mixer.D: torch.Size([64])
backbone.layers.18.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.18.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.18.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.18.mixer.norm.weight: torch.Size([4096])
backbone.layers.18.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.19.norm.weight: torch.Size([2048])
backbone.layers.19.mixer.dt_bias: torch.Size([64])
backbone.layers.19.mixer.A_log: torch.Size([64])
backbone.layers.19.mixer.D: torch.Size([64])
backbone.layers.19.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.19.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.19.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.19.mixer.norm.weight: torch.Size([4096])
backbone.layers.19.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.20.norm.weight: torch.Size([2048])
backbone.layers.20.mixer.dt_bias: torch.Size([64])
backbone.layers.20.mixer.A_log: torch.Size([64])
backbone.layers.20.mixer.D: torch.Size([64])
backbone.layers.20.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.20.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.20.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.20.mixer.norm.weight: torch.Size([4096])
backbone.layers.20.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.21.norm.weight: torch.Size([2048])
backbone.layers.21.mixer.dt_bias: torch.Size([64])
backbone.layers.21.mixer.A_log: torch.Size([64])
backbone.layers.21.mixer.D: torch.Size([64])
backbone.layers.21.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.21.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.21.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.21.mixer.norm.weight: torch.Size([4096])
backbone.layers.21.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.22.norm.weight: torch.Size([2048])
backbone.layers.22.mixer.dt_bias: torch.Size([64])
backbone.layers.22.mixer.A_log: torch.Size([64])
backbone.layers.22.mixer.D: torch.Size([64])
backbone.layers.22.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.22.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.22.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.22.mixer.norm.weight: torch.Size([4096])
backbone.layers.22.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.23.norm.weight: torch.Size([2048])
backbone.layers.23.mixer.dt_bias: torch.Size([64])
backbone.layers.23.mixer.A_log: torch.Size([64])
backbone.layers.23.mixer.D: torch.Size([64])
backbone.layers.23.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.23.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.23.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.23.mixer.norm.weight: torch.Size([4096])
backbone.layers.23.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.24.norm.weight: torch.Size([2048])
backbone.layers.24.mixer.dt_bias: torch.Size([64])
backbone.layers.24.mixer.A_log: torch.Size([64])
backbone.layers.24.mixer.D: torch.Size([64])
backbone.layers.24.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.24.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.24.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.24.mixer.norm.weight: torch.Size([4096])
backbone.layers.24.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.25.norm.weight: torch.Size([2048])
backbone.layers.25.mixer.dt_bias: torch.Size([64])
backbone.layers.25.mixer.A_log: torch.Size([64])
backbone.layers.25.mixer.D: torch.Size([64])
backbone.layers.25.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.25.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.25.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.25.mixer.norm.weight: torch.Size([4096])
backbone.layers.25.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.26.norm.weight: torch.Size([2048])
backbone.layers.26.mixer.dt_bias: torch.Size([64])
backbone.layers.26.mixer.A_log: torch.Size([64])
backbone.layers.26.mixer.D: torch.Size([64])
backbone.layers.26.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.26.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.26.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.26.mixer.norm.weight: torch.Size([4096])
backbone.layers.26.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.27.norm.weight: torch.Size([2048])
backbone.layers.27.mixer.dt_bias: torch.Size([64])
backbone.layers.27.mixer.A_log: torch.Size([64])
backbone.layers.27.mixer.D: torch.Size([64])
backbone.layers.27.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.27.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.27.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.27.mixer.norm.weight: torch.Size([4096])
backbone.layers.27.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.28.norm.weight: torch.Size([2048])
backbone.layers.28.mixer.dt_bias: torch.Size([64])
backbone.layers.28.mixer.A_log: torch.Size([64])
backbone.layers.28.mixer.D: torch.Size([64])
backbone.layers.28.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.28.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.28.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.28.mixer.norm.weight: torch.Size([4096])
backbone.layers.28.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.29.norm.weight: torch.Size([2048])
backbone.layers.29.mixer.dt_bias: torch.Size([64])
backbone.layers.29.mixer.A_log: torch.Size([64])
backbone.layers.29.mixer.D: torch.Size([64])
backbone.layers.29.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.29.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.29.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.29.mixer.norm.weight: torch.Size([4096])
backbone.layers.29.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.30.norm.weight: torch.Size([2048])
backbone.layers.30.mixer.dt_bias: torch.Size([64])
backbone.layers.30.mixer.A_log: torch.Size([64])
backbone.layers.30.mixer.D: torch.Size([64])
backbone.layers.30.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.30.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.30.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.30.mixer.norm.weight: torch.Size([4096])
backbone.layers.30.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.31.norm.weight: torch.Size([2048])
backbone.layers.31.mixer.dt_bias: torch.Size([64])
backbone.layers.31.mixer.A_log: torch.Size([64])
backbone.layers.31.mixer.D: torch.Size([64])
backbone.layers.31.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.31.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.31.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.31.mixer.norm.weight: torch.Size([4096])
backbone.layers.31.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.32.norm.weight: torch.Size([2048])
backbone.layers.32.mixer.dt_bias: torch.Size([64])
backbone.layers.32.mixer.A_log: torch.Size([64])
backbone.layers.32.mixer.D: torch.Size([64])
backbone.layers.32.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.32.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.32.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.32.mixer.norm.weight: torch.Size([4096])
backbone.layers.32.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.33.norm.weight: torch.Size([2048])
backbone.layers.33.mixer.dt_bias: torch.Size([64])
backbone.layers.33.mixer.A_log: torch.Size([64])
backbone.layers.33.mixer.D: torch.Size([64])
backbone.layers.33.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.33.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.33.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.33.mixer.norm.weight: torch.Size([4096])
backbone.layers.33.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.34.norm.weight: torch.Size([2048])
backbone.layers.34.mixer.dt_bias: torch.Size([64])
backbone.layers.34.mixer.A_log: torch.Size([64])
backbone.layers.34.mixer.D: torch.Size([64])
backbone.layers.34.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.34.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.34.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.34.mixer.norm.weight: torch.Size([4096])
backbone.layers.34.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.35.norm.weight: torch.Size([2048])
backbone.layers.35.mixer.dt_bias: torch.Size([64])
backbone.layers.35.mixer.A_log: torch.Size([64])
backbone.layers.35.mixer.D: torch.Size([64])
backbone.layers.35.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.35.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.35.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.35.mixer.norm.weight: torch.Size([4096])
backbone.layers.35.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.36.norm.weight: torch.Size([2048])
backbone.layers.36.mixer.dt_bias: torch.Size([64])
backbone.layers.36.mixer.A_log: torch.Size([64])
backbone.layers.36.mixer.D: torch.Size([64])
backbone.layers.36.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.36.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.36.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.36.mixer.norm.weight: torch.Size([4096])
backbone.layers.36.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.37.norm.weight: torch.Size([2048])
backbone.layers.37.mixer.dt_bias: torch.Size([64])
backbone.layers.37.mixer.A_log: torch.Size([64])
backbone.layers.37.mixer.D: torch.Size([64])
backbone.layers.37.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.37.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.37.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.37.mixer.norm.weight: torch.Size([4096])
backbone.layers.37.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.38.norm.weight: torch.Size([2048])
backbone.layers.38.mixer.dt_bias: torch.Size([64])
backbone.layers.38.mixer.A_log: torch.Size([64])
backbone.layers.38.mixer.D: torch.Size([64])
backbone.layers.38.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.38.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.38.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.38.mixer.norm.weight: torch.Size([4096])
backbone.layers.38.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.39.norm.weight: torch.Size([2048])
backbone.layers.39.mixer.dt_bias: torch.Size([64])
backbone.layers.39.mixer.A_log: torch.Size([64])
backbone.layers.39.mixer.D: torch.Size([64])
backbone.layers.39.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.39.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.39.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.39.mixer.norm.weight: torch.Size([4096])
backbone.layers.39.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.40.norm.weight: torch.Size([2048])
backbone.layers.40.mixer.dt_bias: torch.Size([64])
backbone.layers.40.mixer.A_log: torch.Size([64])
backbone.layers.40.mixer.D: torch.Size([64])
backbone.layers.40.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.40.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.40.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.40.mixer.norm.weight: torch.Size([4096])
backbone.layers.40.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.41.norm.weight: torch.Size([2048])
backbone.layers.41.mixer.dt_bias: torch.Size([64])
backbone.layers.41.mixer.A_log: torch.Size([64])
backbone.layers.41.mixer.D: torch.Size([64])
backbone.layers.41.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.41.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.41.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.41.mixer.norm.weight: torch.Size([4096])
backbone.layers.41.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.42.norm.weight: torch.Size([2048])
backbone.layers.42.mixer.dt_bias: torch.Size([64])
backbone.layers.42.mixer.A_log: torch.Size([64])
backbone.layers.42.mixer.D: torch.Size([64])
backbone.layers.42.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.42.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.42.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.42.mixer.norm.weight: torch.Size([4096])
backbone.layers.42.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.43.norm.weight: torch.Size([2048])
backbone.layers.43.mixer.dt_bias: torch.Size([64])
backbone.layers.43.mixer.A_log: torch.Size([64])
backbone.layers.43.mixer.D: torch.Size([64])
backbone.layers.43.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.43.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.43.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.43.mixer.norm.weight: torch.Size([4096])
backbone.layers.43.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.44.norm.weight: torch.Size([2048])
backbone.layers.44.mixer.dt_bias: torch.Size([64])
backbone.layers.44.mixer.A_log: torch.Size([64])
backbone.layers.44.mixer.D: torch.Size([64])
backbone.layers.44.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.44.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.44.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.44.mixer.norm.weight: torch.Size([4096])
backbone.layers.44.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.45.norm.weight: torch.Size([2048])
backbone.layers.45.mixer.dt_bias: torch.Size([64])
backbone.layers.45.mixer.A_log: torch.Size([64])
backbone.layers.45.mixer.D: torch.Size([64])
backbone.layers.45.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.45.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.45.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.45.mixer.norm.weight: torch.Size([4096])
backbone.layers.45.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.46.norm.weight: torch.Size([2048])
backbone.layers.46.mixer.dt_bias: torch.Size([64])
backbone.layers.46.mixer.A_log: torch.Size([64])
backbone.layers.46.mixer.D: torch.Size([64])
backbone.layers.46.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.46.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.46.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.46.mixer.norm.weight: torch.Size([4096])
backbone.layers.46.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.layers.47.norm.weight: torch.Size([2048])
backbone.layers.47.mixer.dt_bias: torch.Size([64])
backbone.layers.47.mixer.A_log: torch.Size([64])
backbone.layers.47.mixer.D: torch.Size([64])
backbone.layers.47.mixer.in_proj.weight: torch.Size([8512, 2048])
backbone.layers.47.mixer.conv1d.weight: torch.Size([4352, 1, 4])
backbone.layers.47.mixer.conv1d.bias: torch.Size([4352])
backbone.layers.47.mixer.norm.weight: torch.Size([4096])
backbone.layers.47.mixer.out_proj.weight: torch.Size([2048, 4096])
backbone.norm_f.weight: torch.Size([2048])
lm_head.weight: torch.Size([50288, 2048])
[FlaxMamba2LMHeadModel] Loaded state dict.
[Config] Initialized Mamba2Config with d_model=2048, n_layer=48, d_state=128, d_conv=4, expand=2, headdim=64, chunk_size=64, vocab_size=50288, pad_vocab_size_multiple=16
[Config] Computed d_inner=4096, nheads=64

Generating text for prompt: 'CUDA is Nvidia's biggest moat for'
CUDA is Nvidia's biggest moat for[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] Allocating InferenceCache for batch size: 1
[InferenceCache] conv_state shape: (1, 4352, 4)
[InferenceCache] conv_state sample values: [0. 0. 0. 0. 0.]
[InferenceCache] ssm_state shape: (1, 64, 64, 128)
[InferenceCache] ssm_state sample values: [0. 0. 0. 0. 0.]
[Mamba2LMHeadModel] Forward pass input_ids shape: (1, 1)
[Mamba2LMHeadModel] input_ids sample values: [18094]
[Mamba2LMHeadModel] Embedding output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Embedding sample values: [ 0.13134766  0.12145996  0.32104492 -0.13684082  0.02581787]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.11281881  0.11804926  0.2848719  -0.12142258  0.02251181]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11281881  0.11804926  0.2848719  -0.12142258  0.02251181]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11281881  0.11804926  0.2848719  -0.12142258  0.02251181]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.02104773  0.25432044 -0.23045464  0.01286237 -0.22715966]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.02104773  0.25432044 -0.23045464  0.01286237 -0.22715966]
  [FlaxMamba2] xBC (step) sample values: [-0.0169386  -0.10158538  0.6093678  -1.017869   -0.13083245]
  [FlaxMamba2] dt (step) sample values: [ 0.3649655  -0.07801849  0.31167328  0.01377295  0.32689917]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.         0.        -0.0169386  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00086171 -0.00613518 -0.02095818  0.0222255  -0.00357945]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.22864492  0.20919685  0.2493055   0.07141984 -0.26041538]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.12733546  0.11549953  0.14011109  0.03698457 -0.11334881]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.12733546  0.11549953  0.14011109  0.03698457 -0.11334881]
  [FlaxMamba2] B (step) sample values: [ 0.1806902   0.14873119 -0.18677026 -0.2302476   0.1298231 ]
  [FlaxMamba2] C (step) sample values: [-0.26409975  0.06475529 -0.2774184  -0.26935944  0.02603373]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.617978  -2.5226073 -3.0473056 -3.307819  -3.9089987]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0130771  0.01255955 0.01235457 0.0247765  0.01009092]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9663438  0.96881384 0.96305174 0.92131233 0.9613224 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.12733546  0.11549953  0.14011109  0.03698457 -0.11334881]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00030088  0.00024766 -0.00031101 -0.0003834   0.00021618]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00030088  0.00024766 -0.00031101 -0.0003834   0.00021618]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00030088  0.00024766 -0.00031101 -0.0003834   0.00021618]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00455821 -0.00413452 -0.00501554 -0.00132393  0.00405753]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.04400468  0.03991441  0.0484197   0.01278116 -0.03917117]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.04400468  0.03991441  0.0484197   0.01278116 -0.03917117]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 4.6797277e-04  5.7174745e-03 -4.9392176e-03  8.2726590e-05
  3.9458936e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00535662  0.07048873 -0.04823523  0.00156312  0.04600364]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00535662  0.07048873 -0.04823523  0.00156312  0.04600364]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.6313456   1.4855664  -0.63700813 -0.4046006  -0.9591908 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.6313456   1.4855664  -0.63700813 -0.4046006  -0.9591908 ]
  [Layer 1] Output shape after mixer: (1, 1, 2048)
  [Layer 1] Output sample values after mixer: [-0.6313456   1.4855664  -0.63700813 -0.4046006  -0.9591908 ]
  [Layer 1] Residual connection shape: (1, 1, 2048)
  [Layer 1] Residual connection sample values: [-0.49999797  1.6070263  -0.3159632  -0.54144144 -0.9333729 ]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.190525    0.48359454 -0.11095526 -0.19920272 -0.33546326]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.190525    0.48359454 -0.11095526 -0.19920272 -0.33546326]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.190525    0.48359454 -0.11095526 -0.19920272 -0.33546326]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.2765273  -0.48473486 -2.5632565   5.780587   -1.575061  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.2765273  -0.48473486 -2.5632565   5.780587   -1.575061  ]
  [FlaxMamba2] xBC (step) sample values: [-0.7521976 -1.8367425  2.678395   7.637466  -1.1381221]
  [FlaxMamba2] dt (step) sample values: [1.578406   0.37100583 0.7771787  0.99110955 3.162895  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.         0.        -0.7521976  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01800839 -0.06373218  0.10446133  0.40508777  0.06213685]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01180728 -0.2182732   0.09394802  1.4587986   0.04900667]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00586879 -0.09727286  0.04917895  1.1835946   0.02510363]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00586879 -0.09727286  0.04917895  1.1835946   0.02510363]
  [FlaxMamba2] B (step) sample values: [ 0.02391037  0.04982227  0.05421464 -0.26440445  0.4466887 ]
  [FlaxMamba2] C (step) sample values: [ 0.03028024 -0.18466265  0.0406334  -0.27838042 -0.27566147]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-19.851534   -18.68525    -13.564036    -2.4188707   -0.46617994]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02919139 0.00909572 0.04535474 0.01958946 0.3015818 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.56018186 0.84370214 0.54053634 0.95372075 0.8688443 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00586879 -0.09727286  0.04917895  1.1835946   0.02510363]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.096277e-06 -8.535453e-06 -9.287945e-06  4.529725e-05 -7.652583e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.096277e-06 -8.535453e-06 -9.287945e-06  4.529725e-05 -7.652583e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-4.096277e-06 -8.535453e-06 -9.287945e-06  4.529725e-05 -7.652583e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00036122 -0.00598707  0.00302692  0.0728493   0.00154511]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00441272 -0.07313909  0.03697746  0.88994026  0.01887532]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00441272 -0.07313909  0.03697746  0.88994026  0.01887532]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-4.4041714e-03  1.3512394e-02 -6.7808442e-03  5.1285458e+00
 -5.0985427e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00618076  0.00897101 -0.0100798   3.0865488  -0.00768361]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00618076  0.00897101 -0.0100798   3.0865488  -0.00768361]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.4322732   0.25129414  0.47383454  0.01999495  0.02426901]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.4322732   0.25129414  0.47383454  0.01999495  0.02426901]
  [Layer 2] Output shape after mixer: (1, 1, 2048)
  [Layer 2] Output sample values after mixer: [-0.4322732   0.25129414  0.47383454  0.01999495  0.02426901]
  [Layer 2] Residual connection shape: (1, 1, 2048)
  [Layer 2] Residual connection sample values: [-0.9322712   1.8583205   0.15787134 -0.52144647 -0.90910393]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.35705805  0.5564937   0.05416837 -0.1840854  -0.34518158]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.35705805  0.5564937   0.05416837 -0.1840854  -0.34518158]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.35705805  0.5564937   0.05416837 -0.1840854  -0.34518158]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.577738    0.38603693 -0.6934293  -2.5354214   0.8673707 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.577738    0.38603693 -0.6934293  -2.5354214   0.8673707 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.1962808  -0.31835338 -1.6561257   1.3048233   0.16524546]
  [FlaxMamba2] dt (step) sample values: [2.169814   0.96542126 2.166459   1.8739185  2.1385067 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.        0.        0.        1.1962808 0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.02920607  0.00480668  0.21591091  0.14805093 -0.00591027]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.02765731 -0.01449569  0.33956814  0.1357142  -0.02220665]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01401987 -0.00719531  0.19833687  0.07245463 -0.01098005]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01401987 -0.00719531  0.19833687  0.07245463 -0.01098005]
  [FlaxMamba2] B (step) sample values: [ 0.34746298 -0.02615551 -0.07315056  0.00736795 -0.08975994]
  [FlaxMamba2] C (step) sample values: [ 0.4414606   0.0353583  -0.19883011 -0.09239326  0.6227215 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6505536 -3.9938898 -6.780579  -0.9418818 -6.0307717]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.07112592 0.0526632  0.11307824 0.04197916 0.1706181 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.95478296 0.81031597 0.46452683 0.96123207 0.35737887]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01401987 -0.00719531  0.19833687  0.07245463 -0.01098005]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.4648192e-04 -2.6081665e-05 -7.2944022e-05  7.3471447e-06
 -8.9506502e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.4648192e-04 -2.6081665e-05 -7.2944022e-05  7.3471447e-06
 -8.9506502e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 3.4648192e-04 -2.6081665e-05 -7.2944022e-05  7.3471447e-06
 -8.9506502e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00025139 -0.00012902  0.00355632  0.00129916 -0.00019688]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00663425 -0.00340485  0.09385366  0.03428577 -0.00519579]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00663425 -0.00340485  0.09385366  0.03428577 -0.00519579]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00179109 -0.0007825  -0.02168955 -0.00638162 -0.0031736 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00225025 -0.00107197 -0.02394619 -0.01079312 -0.00309306]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00225025 -0.00107197 -0.02394619 -0.01079312 -0.00309306]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.00363281 -0.04324479 -0.11222319  0.28328857  0.10776237]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.00363281 -0.04324479 -0.11222319  0.28328857  0.10776237]
  [Layer 3] Output shape after mixer: (1, 1, 2048)
  [Layer 3] Output sample values after mixer: [ 0.00363281 -0.04324479 -0.11222319  0.28328857  0.10776237]
  [Layer 3] Residual connection shape: (1, 1, 2048)
  [Layer 3] Residual connection sample values: [-0.9286384   1.8150756   0.04564815 -0.2381579  -0.80134153]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.39728442  0.5880717   0.01725122 -0.09309469 -0.34390086]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.39728442  0.5880717   0.01725122 -0.09309469 -0.34390086]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.39728442  0.5880717   0.01725122 -0.09309469 -0.34390086]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-2.217106   -0.21603793  1.2661867  -0.57571304  0.76797956]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-2.217106   -0.21603793  1.2661867  -0.57571304  0.76797956]
  [FlaxMamba2] xBC (step) sample values: [ 0.08970526 -0.04839333  0.16869333 -0.7693172  -1.0675108 ]
  [FlaxMamba2] dt (step) sample values: [1.471403   2.7259429  2.9746137  0.9246873  0.87704265]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         0.         0.08970526 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01512243 -0.0019391  -0.02720262  0.02218642  0.00068821]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.05866907 -0.03709535 -0.07542039  0.00636306  0.29365695]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02847427 -0.0182037  -0.03628881  0.00319165  0.16823347]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02847427 -0.0182037  -0.03628881  0.00319165  0.16823347]
  [FlaxMamba2] B (step) sample values: [ 0.32156697  0.731184   -0.03843723 -0.01887431  0.43499708]
  [FlaxMamba2] C (step) sample values: [ 0.73869956  0.39170054  0.05192597 -0.27329198  0.14562817]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.7127254  -1.2862217  -1.4869522 -27.028044   -4.0726624]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.026471   0.03616946 0.03682176 0.00814901 0.08878102]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9556748  0.9545436  0.9467197  0.8023167  0.69657826]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02847427 -0.0182037  -0.03628881  0.00319165  0.16823347]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.4237868e-04 -5.5112445e-04  2.8971774e-05  1.4226371e-05
 -3.2787578e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.4237868e-04 -5.5112445e-04  2.8971774e-05  1.4226371e-05
 -3.2787578e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.4237868e-04 -5.5112445e-04  2.8971774e-05  1.4226371e-05
 -3.2787578e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00153973 -0.00098436 -0.0019623   0.00017259  0.00909714]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01756725 -0.0112308  -0.02238844  0.0019691   0.10379191]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01756725 -0.0112308  -0.02238844  0.0019691   0.10379191]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00382571  0.0010826  -0.02211393 -0.00040802  0.05444865]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00486962  0.00088541 -0.02767462 -0.00043029  0.03426438]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00486962  0.00088541 -0.02767462 -0.00043029  0.03426438]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.02183226  0.03113241  0.28941754  0.02689401 -0.06457645]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.02183226  0.03113241  0.28941754  0.02689401 -0.06457645]
  [Layer 4] Output shape after mixer: (1, 1, 2048)
  [Layer 4] Output sample values after mixer: [-0.02183226  0.03113241  0.28941754  0.02689401 -0.06457645]
  [Layer 4] Residual connection shape: (1, 1, 2048)
  [Layer 4] Residual connection sample values: [-0.9504707  1.8462081  0.3350657 -0.2112639 -0.865918 ]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.36314237  0.5829151   0.11957038 -0.07731169 -0.34139445]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.36314237  0.5829151   0.11957038 -0.07731169 -0.34139445]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.36314237  0.5829151   0.11957038 -0.07731169 -0.34139445]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.2839986  1.0911975 -1.4122695 -0.9904265 -1.357141 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.2839986  1.0911975 -1.4122695 -0.9904265 -1.357141 ]
  [FlaxMamba2] xBC (step) sample values: [-1.0174327 -1.6878211  0.659706   2.3108723 -3.1647103]
  [FlaxMamba2] dt (step) sample values: [1.2633859 1.9133738 2.4118748 1.8899534 0.7363591]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.         0.        -1.0174327  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.07774815 -0.08416442 -0.0952676   0.08914009 -0.37897715]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.12932286 -0.12148742 -0.16478664  0.06301705 -0.38484034]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06048615 -0.05705844 -0.07561998  0.03250098 -0.15584494]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06048615 -0.05705844 -0.07561998  0.03250098 -0.15584494]
  [FlaxMamba2] B (step) sample values: [ 1.6076508e-03 -1.4576510e-02 -1.6665019e-02 -7.4723503e-05
 -1.7178023e-02]
  [FlaxMamba2] C (step) sample values: [-0.06670374  0.23470692 -0.01786041  0.08230036 -0.02999778]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.5762966   -1.0443833   -0.83880144  -5.6764617  -20.401838  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01370017 0.07883752 0.3943738  0.08855071 0.00710552]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.97863597 0.9209619  0.7183479  0.60492265 0.865052  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06048615 -0.05705844 -0.07561998  0.03250098 -0.15584494]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.3322126e-06  1.2079122e-05  1.3809808e-05  6.1921156e-08
  1.4234919e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.3322126e-06  1.2079122e-05  1.3809808e-05  6.1921156e-08
  1.4234919e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.3322126e-06  1.2079122e-05  1.3809808e-05  6.1921156e-08
  1.4234919e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0002476  -0.00023357 -0.00030955  0.00013304 -0.00063795]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03276063 -0.03090411 -0.04095745  0.01760325 -0.08440906]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03276063 -0.03090411 -0.04095745  0.01760325 -0.08440906]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00530816 -0.0252449   0.01133007 -0.00472181  0.02345002]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00837046 -0.04060003  0.01735597 -0.00757071  0.03332654]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00837046 -0.04060003  0.01735597 -0.00757071  0.03332654]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.01797954  0.2527534   0.21153979 -0.31935534  0.2176971 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.01797954  0.2527534   0.21153979 -0.31935534  0.2176971 ]
  [Layer 5] Output shape after mixer: (1, 1, 2048)
  [Layer 5] Output sample values after mixer: [ 0.01797954  0.2527534   0.21153979 -0.31935534  0.2176971 ]
  [Layer 5] Residual connection shape: (1, 1, 2048)
  [Layer 5] Residual connection sample values: [-0.9324911   2.0989616   0.54660547 -0.53061926 -0.6482209 ]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.32748002  0.57051075  0.17037246 -0.17096461 -0.23092678]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.32748002  0.57051075  0.17037246 -0.17096461 -0.23092678]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.32748002  0.57051075  0.17037246 -0.17096461 -0.23092678]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.19142501  0.30531216  0.88333535  0.7735607  -0.54686403]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.19142501  0.30531216  0.88333535  0.7735607  -0.54686403]
  [FlaxMamba2] xBC (step) sample values: [-0.418163   -0.33481085 -0.14504567  0.14163923 -0.88404834]
  [FlaxMamba2] dt (step) sample values: [2.630289  1.8493961 1.0915235 1.4615952 1.9447525]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.        0.        0.       -0.418163  0.      ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04841645 -0.0419331  -0.05085097 -0.01158426 -0.29417917]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.08277924 -0.11425976 -0.11301528  0.05051901 -0.22447702]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.04310174 -0.05386961 -0.05331792  0.02589741 -0.09969366]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04310174 -0.05386961 -0.05331792  0.02589741 -0.09969366]
  [FlaxMamba2] B (step) sample values: [ 0.1147214  -0.25790444 -0.23780608 -0.11639833 -0.0192111 ]
  [FlaxMamba2] C (step) sample values: [ 0.02048932  0.3593543  -0.2644786  -0.12191307  0.47025836]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.98658675 -8.774721   -3.3045902  -2.9912853  -3.3435438 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.12386854 0.08422513 0.2317419  0.25778905 0.19121946]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8849651  0.47756642 0.46495622 0.4624945  0.5276349 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04310174 -0.05386961 -0.05331792  0.02589741 -0.09969366]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00061249 -0.00137694 -0.00126963 -0.00062144 -0.00010257]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00061249 -0.00137694 -0.00126963 -0.00062144 -0.00010257]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00061249 -0.00137694 -0.00126963 -0.00062144 -0.00010257]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00443824 -0.00554703 -0.00549022  0.00266669 -0.01026559]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01377205 -0.01721264 -0.01703637  0.00827485 -0.03185453]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01377205 -0.01721264 -0.01703637  0.00827485 -0.03185453]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00144394 -0.00302565 -0.01064724  0.00438021  0.00638607]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00256651 -0.00251944 -0.00842813  0.00450826  0.0046396 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00256651 -0.00251944 -0.00842813  0.00450826  0.0046396 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.2512676   0.05380289 -0.50763553 -0.4927335   0.14517485]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.2512676   0.05380289 -0.50763553 -0.4927335   0.14517485]
  [Layer 6] Output shape after mixer: (1, 1, 2048)
  [Layer 6] Output sample values after mixer: [-0.2512676   0.05380289 -0.50763553 -0.4927335   0.14517485]
  [Layer 6] Residual connection shape: (1, 1, 2048)
  [Layer 6] Residual connection sample values: [-1.1837587   2.1527646   0.03896993 -1.0233527  -0.50304604]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.34819594  0.5259452   0.01062635 -0.27561066 -0.1484376 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.34819594  0.5259452   0.01062635 -0.27561066 -0.1484376 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.34819594  0.5259452   0.01062635 -0.27561066 -0.1484376 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.63862914 -1.9114705  -1.5534803  -0.6682331  -0.23639557]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.63862914 -1.9114705  -1.5534803  -0.6682331  -0.23639557]
  [FlaxMamba2] xBC (step) sample values: [-1.3216721   0.5518218  -2.507424    1.4773663  -0.60656536]
  [FlaxMamba2] dt (step) sample values: [ 1.55964    0.8937135  2.0647106  1.2797494 -0.1017556]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.         0.        -1.3216721  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.19537902 -0.1728485   0.03892981  0.1944093   0.04494448]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.12726378 -0.1482208   0.03817974  0.20083325  0.04135104]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.06767546 -0.06862808  0.01945425  0.11046637  0.02110293]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06767546 -0.06862808  0.01945425  0.11046637  0.02110293]
  [FlaxMamba2] B (step) sample values: [ 4.6378456e-02 -1.2214395e-02 -8.7535263e-05 -2.0138423e-03
 -5.8411332e-03]
  [FlaxMamba2] C (step) sample values: [ 0.16970892  0.16661194 -0.07822861  0.03515238 -0.0617158 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.29588825 -1.1836219  -0.3113019  -0.1314279  -1.5015444 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08046563 0.01459793 0.01972952 0.05295818 0.00097004]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9764724 0.98287   0.993877  0.993064  0.9985445]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06767546 -0.06862808  0.01945425  0.11046637  0.02110293]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.5255611e-04 -6.6514076e-05 -4.7667751e-07 -1.0966476e-05
 -3.1808173e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.5255611e-04 -6.6514076e-05 -4.7667751e-07 -1.0966476e-05
 -3.1808173e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.5255611e-04 -6.6514076e-05 -4.7667751e-07 -1.0966476e-05
 -3.1808173e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00052658 -0.00053399  0.00015137  0.00085953  0.0001642 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00068142 -0.00069101  0.00019588  0.00111228  0.00021248]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00068142 -0.00069101  0.00019588  0.00111228  0.00021248]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 2.8479763e-04  1.7014625e-04 -5.3126281e-05 -2.5188611e-04
 -2.2160373e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00322714  0.0010738  -0.00079115 -0.00264569 -0.00031778]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00322714  0.0010738  -0.00079115 -0.00264569 -0.00031778]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.0855503   0.3369998  -0.17986831  0.38275748 -0.11257255]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.0855503   0.3369998  -0.17986831  0.38275748 -0.11257255]
  [Layer 7] Output shape after mixer: (1, 1, 2048)
  [Layer 7] Output sample values after mixer: [-0.0855503   0.3369998  -0.17986831  0.38275748 -0.11257255]
  [Layer 7] Residual connection shape: (1, 1, 2048)
  [Layer 7] Residual connection sample values: [-1.269309    2.4897645  -0.14089838 -0.64059526 -0.6156186 ]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.46094134  0.70764506 -0.04767771 -0.21566553 -0.22249937]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.46094134  0.70764506 -0.04767771 -0.21566553 -0.22249937]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.46094134  0.70764506 -0.04767771 -0.21566553 -0.22249937]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.68830913 -2.4727025   2.2092304  -3.1674368  -1.4833287 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.68830913 -2.4727025   2.2092304  -3.1674368  -1.4833287 ]
  [FlaxMamba2] xBC (step) sample values: [-0.79613364 -1.7792941  -1.4090115   0.5470349   1.327098  ]
  [FlaxMamba2] dt (step) sample values: [-0.88972145  0.08037224  2.7458007   1.2030127  -0.6977741 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.         -0.79613364  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03379583  0.03950307  0.17887841 -0.00261264  0.24024491]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.4290948   0.00848195 -0.13581885 -0.05418735  0.18412308]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.25988445  0.00425896 -0.06330481 -0.02635978  0.10051301]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.25988445  0.00425896 -0.06330481 -0.02635978  0.10051301]
  [FlaxMamba2] B (step) sample values: [ 0.01952137 -0.00358095 -0.00227191 -0.01393804 -0.05204137]
  [FlaxMamba2] C (step) sample values: [ 0.08440231 -0.10059719 -0.10173407 -0.21210748 -0.1061235 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.6542776 -0.9827404 -0.5549556 -3.9396574 -1.8081155]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00414627 0.05867011 0.16075991 0.07799714 0.00481077]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9849626  0.9439732  0.91464925 0.7354431  0.9913393 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.25988445  0.00425896 -0.06330481 -0.02635978  0.10051301]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.1035292e-05 -3.8586636e-06 -2.4481049e-06 -1.5018960e-05
 -5.6077293e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.1035292e-05 -3.8586636e-06 -2.4481049e-06 -1.5018960e-05
 -5.6077293e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.1035292e-05 -3.8586636e-06 -2.4481049e-06 -1.5018960e-05
 -5.6077293e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 1.6741110e-03  2.7435170e-05 -4.0779376e-04 -1.6980314e-04
  6.4747973e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.22044486  0.00361263 -0.05369778 -0.02235947  0.08525933]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.22044486  0.00361263 -0.05369778 -0.02235947  0.08525933]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.05074133 -0.00069493 -0.10689527  0.0028619  -0.02338704]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.05476413 -0.00095554 -0.09991343  0.00419127 -0.04086059]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.05476413 -0.00095554 -0.09991343  0.00419127 -0.04086059]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.12154201  1.0795718   0.12342073  0.19936545 -0.19047558]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.12154201  1.0795718   0.12342073  0.19936545 -0.19047558]
  [Layer 8] Output shape after mixer: (1, 1, 2048)
  [Layer 8] Output sample values after mixer: [-0.12154201  1.0795718   0.12342073  0.19936545 -0.19047558]
  [Layer 8] Residual connection shape: (1, 1, 2048)
  [Layer 8] Residual connection sample values: [-1.390851    3.5693364  -0.01747765 -0.44122982 -0.80609417]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.42488948  0.8909167  -0.00490847 -0.11899824 -0.2430892 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.42488948  0.8909167  -0.00490847 -0.11899824 -0.2430892 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.42488948  0.8909167  -0.00490847 -0.11899824 -0.2430892 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-2.2698925  -0.5456877  -0.69814414 -2.6758118  -1.8424138 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-2.2698925  -0.5456877  -0.69814414 -2.6758118  -1.8424138 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.0603741   0.19383869 -0.02431168 -0.7922087  -0.65687823]
  [FlaxMamba2] dt (step) sample values: [1.5118777 1.9850658 1.5091677 2.1539638 1.5746564]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.        0.        0.        1.0603741 0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.05530333  0.028418    0.00125758 -0.02093667 -0.03905025]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04795241  0.00307315 -0.08541235 -0.09485024 -0.01401058]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02340146  0.00153894 -0.04088346 -0.04517766 -0.00695622]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02340146  0.00153894 -0.04088346 -0.04517766 -0.00695622]
  [FlaxMamba2] B (step) sample values: [-0.18351592 -0.25482982  0.999145    0.48987332  0.02326046]
  [FlaxMamba2] C (step) sample values: [-0.25736502 -0.23634622 -0.21873757 -0.2612611  -0.18614765]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-5.234511  -1.2161361 -1.4887683 -0.9523448 -3.9666808]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04502386 0.24520391 0.02154606 0.77519435 0.07375696]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7900351  0.7421519  0.9684319  0.47794852 0.7463428 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02340146  0.00153894 -0.04088346 -0.04517766 -0.00695622]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.9335677e-04  2.6849480e-04 -1.0527231e-03 -5.1614229e-04
 -2.4507779e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.9335677e-04  2.6849480e-04 -1.0527231e-03 -5.1614229e-04
 -2.4507779e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.9335677e-04  2.6849480e-04 -1.0527231e-03 -5.1614229e-04
 -2.4507779e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.6280860e-04  1.0706693e-05 -2.8443476e-04 -3.1431013e-04
 -4.8395792e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0318847   0.00209682 -0.0557041  -0.06155498 -0.00947791]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0318847   0.00209682 -0.0557041  -0.06155498 -0.00947791]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00677771 -0.00041977  0.01292002  0.0106099   0.00238824]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00689534 -0.00063636  0.01309468  0.00847957  0.00278006]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00689534 -0.00063636  0.01309468  0.00847957  0.00278006]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.21808931 -0.07043874  0.19788411 -0.20939201 -0.10900407]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.21808931 -0.07043874  0.19788411 -0.20939201 -0.10900407]
  [Layer 9] Output shape after mixer: (1, 1, 2048)
  [Layer 9] Output sample values after mixer: [-0.21808931 -0.07043874  0.19788411 -0.20939201 -0.10900407]
  [Layer 9] Residual connection shape: (1, 1, 2048)
  [Layer 9] Residual connection sample values: [-1.6089404   3.4988978   0.18040647 -0.65062183 -0.91509825]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.38977432  0.70846397  0.0394514  -0.14086689 -0.21665807]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.38977432  0.70846397  0.0394514  -0.14086689 -0.21665807]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.38977432  0.70846397  0.0394514  -0.14086689 -0.21665807]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.034892   -0.09586937 -1.8079673  -1.1463017  -0.2065878 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.034892   -0.09586937 -1.8079673  -1.1463017  -0.2065878 ]
  [FlaxMamba2] xBC (step) sample values: [-0.8272672   0.37696424  1.3248214   1.5313897   0.8131274 ]
  [FlaxMamba2] dt (step) sample values: [ 1.0159551  -0.13247357  0.37166342 -1.0672512   1.0443556 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.         0.        -0.8272672  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.13531959 -0.09382691  0.1825834  -0.2746108   0.14839178]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.17368019 -0.18092409  0.07876261 -0.36042622  0.08882147]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07931779 -0.08230091  0.04093139 -0.14808342  0.04638176]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07931779 -0.08230091  0.04093139 -0.14808342  0.04638176]
  [FlaxMamba2] B (step) sample values: [ 0.00302014 -0.15819404 -0.01182344 -0.01854888 -0.01404551]
  [FlaxMamba2] C (step) sample values: [-0.15362105  0.13073123 -0.13164099 -0.1995371  -0.15750435]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.7154508  -1.4067873  -0.35344088 -2.010216   -0.4652703 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00121244 0.00311741 0.13441244 0.00062845 0.02138084]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9955054  0.99562407 0.9536039  0.99873745 0.99010146]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07931779 -0.08230091  0.04093139 -0.14808342  0.04638176]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.9044133e-07  1.5213219e-05  1.1370379e-06  1.7838103e-06
  1.3507295e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.9044133e-07  1.5213219e-05  1.1370379e-06  1.7838103e-06
  1.3507295e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.9044133e-07  1.5213219e-05  1.1370379e-06  1.7838103e-06
  1.3507295e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.0395424e-04 -1.0786392e-04  5.3644813e-05 -1.9407870e-04
  6.0788119e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01753171 -0.01819107  0.00904712 -0.03273106  0.01025182]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01753171 -0.01819107  0.00904712 -0.03273106  0.01025182]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00475606  0.00083022 -0.00230442  0.00904844 -0.00094995]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.05713391  0.00485995 -0.02167729  0.09687198 -0.00941185]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.05713391  0.00485995 -0.02167729  0.09687198 -0.00941185]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.08761428  0.17685264 -0.1758201  -0.3122465  -0.08311828]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.08761428  0.17685264 -0.1758201  -0.3122465  -0.08311828]
  [Layer 10] Output shape after mixer: (1, 1, 2048)
  [Layer 10] Output sample values after mixer: [-0.08761428  0.17685264 -0.1758201  -0.3122465  -0.08311828]
  [Layer 10] Residual connection shape: (1, 1, 2048)
  [Layer 10] Residual connection sample values: [-1.6965547   3.6757505   0.00458637 -0.96286833 -0.9982165 ]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.42364082  0.7467658   0.001023   -0.2095343  -0.23827411]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.42364082  0.7467658   0.001023   -0.2095343  -0.23827411]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.42364082  0.7467658   0.001023   -0.2095343  -0.23827411]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.82045186 -2.3795598  -1.4822559  -1.0285275   2.1130638 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.82045186 -2.3795598  -1.4822559  -1.0285275   2.1130638 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.1211524   0.31199944 -1.8119339   1.1294295  -0.12901035]
  [FlaxMamba2] dt (step) sample values: [2.5325396 4.2837186 1.3756646 4.6233964 2.6659987]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.        0.        0.        1.1211524 0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.29725868 -0.04947354  0.42931685 -0.10781419 -0.02829976]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.3114646  -0.40713957  0.5258745  -0.0956682  -0.00513691]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.13167393 -0.16269223  0.33052287 -0.04554774 -0.00256186]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.13167393 -0.16269223  0.33052287 -0.04554774 -0.00256186]
  [FlaxMamba2] B (step) sample values: [-0.2694352  -0.04634157 -0.2528892   0.13491936  0.17988124]
  [FlaxMamba2] C (step) sample values: [-0.10991132 -0.0635642  -0.26636073 -0.27459875  0.05177917]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.31160602 -0.09015273 -1.5786072  -0.20961139 -0.6694042 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.20164865 1.1991208  0.40822765 1.6953158  0.10227346]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9390985  0.89753425 0.5249611  0.70092285 0.93382865]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.13167393 -0.16269223  0.33052287 -0.04554774 -0.00256186]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00715401  0.00123046  0.00671468 -0.00358236 -0.00477618]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00715401  0.00123046  0.00671468 -0.00358236 -0.00477618]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00715401  0.00123046  0.00671468 -0.00358236 -0.00477618]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01725401 -0.02131852  0.04331036 -0.00596839 -0.0003357 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.06556222 -0.08100665  0.16457178 -0.02267883 -0.00127558]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.06556222 -0.08100665  0.16457178 -0.02267883 -0.00127558]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01644207  0.0163354  -0.04514964  0.00614331 -0.00240474]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.0167648   0.01632504 -0.03200186  0.01419085 -0.00182434]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0167648   0.01632504 -0.03200186  0.01419085 -0.00182434]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.04018486  0.28026238  0.08973928 -0.3123667   0.2970721 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.04018486  0.28026238  0.08973928 -0.3123667   0.2970721 ]
  [Layer 11] Output shape after mixer: (1, 1, 2048)
  [Layer 11] Output sample values after mixer: [ 0.04018486  0.28026238  0.08973928 -0.3123667   0.2970721 ]
  [Layer 11] Residual connection shape: (1, 1, 2048)
  [Layer 11] Residual connection sample values: [-1.6563698   3.956013    0.09432565 -1.275235   -0.7011444 ]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.31757823  0.6293871   0.01579782 -0.21213353 -0.12879041]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.31757823  0.6293871   0.01579782 -0.21213353 -0.12879041]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.31757823  0.6293871   0.01579782 -0.21213353 -0.12879041]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.3563466 -1.5877341 -1.9369824 -0.6410356  1.5931226]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.3563466 -1.5877341 -1.9369824 -0.6410356  1.5931226]
  [FlaxMamba2] xBC (step) sample values: [ 0.23113912 -0.24670576  0.226569   -0.5970436   0.08347471]
  [FlaxMamba2] dt (step) sample values: [1.683083  1.6706955 1.2673268 1.2082499 2.1427426]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         0.         0.23113912 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.03769554  0.06173667  0.01714756 -0.06792537  0.01501974]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00530373  0.07463035 -0.01773404 -0.09763423  0.02763876]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00264483  0.03870695 -0.0087884  -0.0464359   0.01401034]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00264483  0.03870695 -0.0087884  -0.0464359   0.01401034]
  [FlaxMamba2] B (step) sample values: [ 0.07772732 -0.21643169 -0.14545907 -0.03874897 -0.13924918]
  [FlaxMamba2] C (step) sample values: [-0.1994727  -0.23814256 -0.16544157 -0.2759121  -0.22426672]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2411823 -0.7693517 -1.9974962 -1.2367963 -1.0181218]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.20929435 0.31557813 0.09264656 0.28192842 0.52398634]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.77122706 0.78443575 0.83105344 0.70561326 0.58655906]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00264483  0.03870695 -0.0087884  -0.0464359   0.01401034]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.3025808e-05  1.1980535e-04  8.0518592e-05  2.1449418e-05
  7.7081117e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.3025808e-05  1.1980535e-04  8.0518592e-05  2.1449418e-05
  7.7081117e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-4.3025808e-05  1.1980535e-04  8.0518592e-05  2.1449418e-05
  7.7081117e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-3.2293170e-05  4.7260881e-04 -1.0730584e-04 -5.6697894e-04
  1.7106535e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00193608  0.02833443 -0.00643332 -0.0339922   0.01025591]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00193608  0.02833443 -0.00643332 -0.0339922   0.01025591]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00028414 -0.00763452  0.00156986  0.0075179   0.01357854]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00086686 -0.01534193  0.00238429  0.01305994  0.03391675]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00086686 -0.01534193  0.00238429  0.01305994  0.03391675]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.47140536 -0.00504842 -0.05654343  0.2836621   0.42802024]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.47140536 -0.00504842 -0.05654343  0.2836621   0.42802024]
  [Layer 12] Output shape after mixer: (1, 1, 2048)
  [Layer 12] Output sample values after mixer: [-0.47140536 -0.00504842 -0.05654343  0.2836621   0.42802024]
  [Layer 12] Residual connection shape: (1, 1, 2048)
  [Layer 12] Residual connection sample values: [-2.1277752   3.9509645   0.03778221 -0.991573   -0.27312416]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.3733516   0.5999597   0.00611737 -0.1510968  -0.04864698]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.3733516   0.5999597   0.00611737 -0.1510968  -0.04864698]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.3733516   0.5999597   0.00611737 -0.1510968  -0.04864698]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.4875563   0.9681462  -0.75436616  0.54447466  1.0623842 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.4875563   0.9681462  -0.75436616  0.54447466  1.0623842 ]
  [FlaxMamba2] xBC (step) sample values: [-0.4691228  -2.0080276   1.0430385   0.45113954  2.003202  ]
  [FlaxMamba2] dt (step) sample values: [2.509325  2.1077428 2.7671525 1.1372916 5.058186 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.         0.        -0.4691228  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00541163 -0.21975057  0.00969254  0.01220505  0.38464803]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.2592368  -0.3296749  -0.01078475  0.01140015  0.36069173]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.11291094 -0.13790952 -0.0053633   0.00573257  0.21252242]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.11291094 -0.13790952 -0.0053633   0.00573257  0.21252242]
  [FlaxMamba2] B (step) sample values: [ 0.34638917 -0.1738921   0.00723312  0.5274186  -0.02362696]
  [FlaxMamba2] C (step) sample values: [-0.21591367  0.1103408  -0.00489046  0.4370204  -0.03563666]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3103099 -1.7870504 -0.8605819 -1.881061  -0.5251649]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11215202 0.07759102 0.4835757  0.138903   1.3330245 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.86333376 0.87052476 0.6595771  0.7700614  0.49655667]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.11291094 -0.13790952 -0.0053633   0.00573257  0.21252242]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.3863920e-03  2.2020286e-03 -9.1594316e-05 -6.6788024e-03
  2.9919270e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.3863920e-03  2.2020286e-03 -9.1594316e-05 -6.6788024e-03
  2.9919270e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-4.3863920e-03  2.2020286e-03 -9.1594316e-05 -6.6788024e-03
  2.9919270e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00914828 -0.01117372 -0.00043455  0.00046446  0.01721902]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01400914 -0.01711077 -0.00066544  0.00071125  0.02636819]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01400914 -0.01711077 -0.00066544  0.00071125  0.02636819]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00384046 -0.01200601  0.00016057  0.00024508  0.02081785]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.017862   -0.01841915  0.00101007  0.00175489  0.0568753 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.017862   -0.01841915  0.00101007  0.00175489  0.0568753 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.09497932  0.74131155 -0.00921451 -0.07780446 -0.27390912]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.09497932  0.74131155 -0.00921451 -0.07780446 -0.27390912]
  [Layer 13] Output shape after mixer: (1, 1, 2048)
  [Layer 13] Output sample values after mixer: [ 0.09497932  0.74131155 -0.00921451 -0.07780446 -0.27390912]
  [Layer 13] Residual connection shape: (1, 1, 2048)
  [Layer 13] Residual connection sample values: [-2.032796    4.692276    0.02856771 -1.0693774  -0.5470333 ]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.29255372  0.59312874  0.00380662 -0.13399117 -0.0768555 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.29255372  0.59312874  0.00380662 -0.13399117 -0.0768555 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.29255372  0.59312874  0.00380662 -0.13399117 -0.0768555 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.8322865  -0.7871562  -0.16428617 -0.81906295 -1.0852811 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.8322865  -0.7871562  -0.16428617 -0.81906295 -1.0852811 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.2844488  -1.8294587   1.8725047   0.14875439 -0.40307224]
  [FlaxMamba2] dt (step) sample values: [ 0.1398455   0.41330382  1.358473   -0.05241724  0.96734715]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.        0.        0.        0.2844488 0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06312597  0.43592572 -0.31337938  0.03217685  0.06061829]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.02357519  0.39466596 -0.37423143 -0.03062832  0.09717834]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01192653  0.23577559 -0.1525064  -0.01507966  0.05094822]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01192653  0.23577559 -0.1525064  -0.01507966  0.05094822]
  [FlaxMamba2] B (step) sample values: [-0.04166316 -0.08273358  0.06537971 -0.00820697 -0.01556248]
  [FlaxMamba2] C (step) sample values: [ 0.01212175 -0.18377702 -0.0082233  -0.10207873  0.30453923]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.318424  -0.7620611 -2.6670074 -5.1836414 -2.8487349]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0453275  0.01813629 0.2847786  0.01570104 0.03614165]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8222232 0.9862741 0.4678972 0.9218354 0.9021649]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01192653  0.23577559 -0.1525064  -0.01507966  0.05094822]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.2523105e-05 -4.4725777e-05  3.5344274e-05 -4.4366875e-06
 -8.4130770e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.2523105e-05 -4.4725777e-05  3.5344274e-05 -4.4366875e-06
 -8.4130770e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.2523105e-05 -4.4725777e-05  3.5344274e-05 -4.4366875e-06
 -8.4130770e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00063764  0.01260557 -0.00815365 -0.00080622  0.00272391]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00545863  0.1079116  -0.06980032 -0.00690177  0.02331838]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00545863  0.1079116  -0.06980032 -0.00690177  0.02331838]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00862187 -0.02656853  0.00526369  0.0017296  -0.00639022]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.03637746 -0.06523993  0.01875593  0.00866421 -0.03710852]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03637746 -0.06523993  0.01875593  0.00866421 -0.03710852]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.23503694 -0.09923203 -0.30719212  0.03740161  0.11510411]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.23503694 -0.09923203 -0.30719212  0.03740161  0.11510411]
  [Layer 14] Output shape after mixer: (1, 1, 2048)
  [Layer 14] Output sample values after mixer: [ 0.23503694 -0.09923203 -0.30719212  0.03740161  0.11510411]
  [Layer 14] Residual connection shape: (1, 1, 2048)
  [Layer 14] Residual connection sample values: [-1.7977589   4.593044   -0.27862442 -1.0319759  -0.4319292 ]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.24799073  0.53865725 -0.03532775 -0.12251481 -0.05709096]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.24799073  0.53865725 -0.03532775 -0.12251481 -0.05709096]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.24799073  0.53865725 -0.03532775 -0.12251481 -0.05709096]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.5150351   0.61123925 -1.324634    0.39416546 -0.35289785]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.5150351   0.61123925 -1.324634    0.39416546 -0.35289785]
  [FlaxMamba2] xBC (step) sample values: [-0.4773197  -0.16748792  0.0426883  -0.87003607  0.57472086]
  [FlaxMamba2] dt (step) sample values: [1.494858   1.821708   0.92271286 2.0499039  2.1456609 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.         0.        -0.4773197  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01449381  0.0365562  -0.00595093  0.10370974  0.00528804]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02295126  0.02970119 -0.0307312   0.08596377 -0.02005681]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01134395  0.01507112 -0.01512952  0.04482819 -0.00992784]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01134395  0.01507112 -0.01512952  0.04482819 -0.00992784]
  [FlaxMamba2] B (step) sample values: [ 1.9718234e-03 -4.7071301e-03 -3.2332710e-03  2.6264452e-05
  6.3979573e-04]
  [FlaxMamba2] C (step) sample values: [-0.01204957 -0.00351351  0.01466274  0.00092575 -0.05920628]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.27823287 -0.68077636 -2.7209377  -0.11263601 -3.8483953 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00860389 0.09418693 0.03763734 0.04362417 0.1825204 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99760896 0.9378922  0.9026604  0.9950984  0.49538964]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01134395  0.01507112 -0.01512952  0.04482819 -0.00992784]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.9245400e-07  4.5942554e-07  3.1557386e-07 -2.5634641e-09
 -6.2445373e-08]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.9245400e-07  4.5942554e-07  3.1557386e-07 -2.5634641e-09
 -6.2445373e-08]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.9245400e-07  4.5942554e-07  3.1557386e-07 -2.5634641e-09
 -6.2445373e-08]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.7624261e-06  2.3414889e-06 -2.3505620e-06  6.9646244e-06
 -1.5424154e-06]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00193511  0.00257091 -0.00258087  0.00764702 -0.00169354]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00193511  0.00257091 -0.00258087  0.00764702 -0.00169354]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.00037276 0.00101864 0.00071809 0.00180033 0.00024664]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.00512469 0.01829803 0.00994683 0.02900053 0.00291573]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.00512469 0.01829803 0.00994683 0.02900053 0.00291573]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.48756215  0.42145917  0.24551728  0.21227656 -0.24958123]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.48756215  0.42145917  0.24551728  0.21227656 -0.24958123]
  [Layer 15] Output shape after mixer: (1, 1, 2048)
  [Layer 15] Output sample values after mixer: [ 0.48756215  0.42145917  0.24551728  0.21227656 -0.24958123]
  [Layer 15] Residual connection shape: (1, 1, 2048)
  [Layer 15] Residual connection sample values: [-1.3101968   5.014503   -0.03310713 -0.8196993  -0.68151045]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.1820735   0.5825964  -0.00421499 -0.09559095 -0.09097338]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.1820735   0.5825964  -0.00421499 -0.09559095 -0.09097338]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.1820735   0.5825964  -0.00421499 -0.09559095 -0.09097338]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.95807105 -0.37522677 -0.39263067 -0.62169224 -0.13857879]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.95807105 -0.37522677 -0.39263067 -0.62169224 -0.13857879]
  [FlaxMamba2] xBC (step) sample values: [-0.84037113 -0.58506525  0.3558025  -0.8227597  -0.25513852]
  [FlaxMamba2] dt (step) sample values: [1.1447551 5.7737885 1.4952195 0.9678553 1.9997793]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.         -0.84037113  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.18649837 -0.11205656  0.08022061 -0.12172665 -0.065155  ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.22263119 -0.15319425  0.06709042 -0.21413389 -0.10723874]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.09897537 -0.07074144  0.03467007 -0.09564722 -0.05074709]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09897537 -0.07074144  0.03467007 -0.09564722 -0.05074709]
  [FlaxMamba2] B (step) sample values: [-0.12912856  0.19181286  0.08946393 -0.06100235 -0.27823958]
  [FlaxMamba2] C (step) sample values: [-0.2654095  -0.02300591 -0.06896858  0.8679442   0.03651806]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6905513  -0.13480766 -1.3128716  -3.7739606  -1.2635014 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.16945733 3.1608527  0.20125385 0.18283461 0.16077065]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.63385594 0.65304637 0.76780427 0.50157076 0.8161689 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09897537 -0.07074144  0.03467007 -0.09564722 -0.05074709]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00216576 -0.0032171  -0.0015005   0.00102314  0.00466666]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00216576 -0.0032171  -0.0015005   0.00102314  0.00466666]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00216576 -0.0032171  -0.0015005   0.00102314  0.00466666]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01359669 -0.00971807  0.00476278 -0.01313948 -0.00697135]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07729517 -0.05524579  0.02707572 -0.07469603 -0.03963112]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07729517 -0.05524579  0.02707572 -0.07469603 -0.03963112]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02053262  0.00844276 -0.00428509  0.01622526  0.00255605]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.0569037   0.01836645 -0.01117174  0.03768838  0.00609873]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0569037   0.01836645 -0.01117174  0.03768838  0.00609873]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.28624493 -0.02630986  0.08329336 -0.14295033 -0.094205  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.28624493 -0.02630986  0.08329336 -0.14295033 -0.094205  ]
  [Layer 16] Output shape after mixer: (1, 1, 2048)
  [Layer 16] Output sample values after mixer: [ 0.28624493 -0.02630986  0.08329336 -0.14295033 -0.094205  ]
  [Layer 16] Residual connection shape: (1, 1, 2048)
  [Layer 16] Residual connection sample values: [-1.0239518   4.988193    0.05018623 -0.9626496  -0.7757155 ]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.13577697  0.55579257  0.00592793 -0.10516474 -0.09896436]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.13577697  0.55579257  0.00592793 -0.10516474 -0.09896436]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.13577697  0.55579257  0.00592793 -0.10516474 -0.09896436]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.27050212 -0.3250033   0.8381561  -0.61394614  0.28867334]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.27050212 -0.3250033   0.8381561  -0.61394614  0.28867334]
  [FlaxMamba2] xBC (step) sample values: [-0.8958114  0.4549761  1.0844564  0.5615414 -0.6711602]
  [FlaxMamba2] dt (step) sample values: [ 0.3277421  -0.03421176  0.24973911  1.8275818   1.7170478 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.         0.        -0.8958114  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.15374887 -0.07708824 -0.24569717 -0.06039038  0.11617495]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.18554819 -0.10328758 -0.2600557  -0.06579199  0.12880923]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.08419167 -0.04897908 -0.11321525 -0.03181424  0.06854684]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08419167 -0.04897908 -0.11321525 -0.03181424  0.06854684]
  [FlaxMamba2] B (step) sample values: [-0.01762471 -0.0343891  -0.05870134  0.0021298   0.00577978]
  [FlaxMamba2] C (step) sample values: [-0.0170315  -0.09461041 -0.09115329  0.6627997   0.08450887]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.1570504  -11.466768   -14.214988    -0.12863436 -14.242779  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00071243 0.0099181  0.02764436 0.12897393 0.03871261]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.999176   0.89250016 0.6750529  0.9835464  0.576157  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08419167 -0.04897908 -0.11321525 -0.03181424  0.06854684]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0571375e-06  2.0626735e-06  3.5209318e-06 -1.2774652e-07
 -3.4667360e-07]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0571375e-06  2.0626735e-06  3.5209318e-06 -1.2774652e-07
 -3.4667360e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.0571375e-06  2.0626735e-06  3.5209318e-06 -1.2774652e-07
 -3.4667360e-07]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.80364932e-05 -1.04928495e-05 -2.42542574e-05 -6.81560459e-06
  1.46848815e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05431789 -0.0315998  -0.073043   -0.02052557  0.04422432]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05431789 -0.0315998  -0.073043   -0.02052557  0.04422432]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00833417  0.00430784 -0.04273726  0.00442517  0.00729817]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.03471522  0.0219164  -0.16503072  0.02080918  0.0344532 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03471522  0.0219164  -0.16503072  0.02080918  0.0344532 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.4465564   0.6149488  -0.03338832  0.16831341 -0.32008025]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.4465564   0.6149488  -0.03338832  0.16831341 -0.32008025]
  [Layer 17] Output shape after mixer: (1, 1, 2048)
  [Layer 17] Output sample values after mixer: [-0.4465564   0.6149488  -0.03338832  0.16831341 -0.32008025]
  [Layer 17] Residual connection shape: (1, 1, 2048)
  [Layer 17] Residual connection sample values: [-1.4705081   5.603142    0.01679791 -0.7943362  -1.0957958 ]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.15788434  0.5086818   0.00161276 -0.07157259 -0.11308913]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.15788434  0.5086818   0.00161276 -0.07157259 -0.11308913]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.15788434  0.5086818   0.00161276 -0.07157259 -0.11308913]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.89574134 -0.7129869  -0.6764141  -1.2306077  -0.08312937]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.89574134 -0.7129869  -0.6764141  -1.2306077  -0.08312937]
  [FlaxMamba2] xBC (step) sample values: [-0.1965181   0.9587282   0.86773723  0.17008096  0.6424564 ]
  [FlaxMamba2] dt (step) sample values: [1.8414607 1.5255574 1.6395876 1.8616211 1.1882095]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.         0.        -0.1965181  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03480808 -0.59452385  0.05629911  0.01872718  0.15402642]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04481784 -0.8599047   0.33608428  0.00489508  0.11194268]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02190685 -0.25570062  0.19601746  0.00245353  0.05910086]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02190685 -0.25570062  0.19601746  0.00245353  0.05910086]
  [FlaxMamba2] B (step) sample values: [ 0.0955043  -0.01537689 -0.19330294  0.06941851  0.08358333]
  [FlaxMamba2] C (step) sample values: [-0.27794433 -0.01766993 -0.19988504 -0.13120563  0.11491685]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3010656 -1.4685526 -1.2082934 -1.2128745 -2.5874777]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.49038678 0.22941935 0.33126634 0.40224725 0.13418455]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.5283347  0.71396995 0.6701411  0.61392933 0.7066643 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02190685 -0.25570062  0.19601746  0.00245353  0.05910086]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00102599  0.00016519  0.00207662 -0.00074575 -0.00089792]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00102599  0.00016519  0.00207662 -0.00074575 -0.00089792]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00102599  0.00016519  0.00207662 -0.00074575 -0.00089792]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00652207 -0.07612678  0.058358    0.00073046  0.01759542]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01075532 -0.12553796  0.09623609  0.00120458  0.02901597]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01075532 -0.12553796  0.09623609  0.00120458  0.02901597]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00684083  0.02944233 -0.02194121 -0.00033513 -0.00115594]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.02640802  0.04667782 -0.06327236 -0.00124342 -0.0067502 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02640802  0.04667782 -0.06327236 -0.00124342 -0.0067502 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.19702806  0.07484674 -0.15224384 -0.2431348  -0.39359105]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.19702806  0.07484674 -0.15224384 -0.2431348  -0.39359105]
  [Layer 18] Output shape after mixer: (1, 1, 2048)
  [Layer 18] Output sample values after mixer: [-0.19702806  0.07484674 -0.15224384 -0.2431348  -0.39359105]
  [Layer 18] Residual connection shape: (1, 1, 2048)
  [Layer 18] Residual connection sample values: [-1.6675361   5.6779885  -0.13544592 -1.037471   -1.4893868 ]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.16551724  0.4865342  -0.01254917 -0.08853003 -0.14751692]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.16551724  0.4865342  -0.01254917 -0.08853003 -0.14751692]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.16551724  0.4865342  -0.01254917 -0.08853003 -0.14751692]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.58889234 -0.7423012   1.1570306   0.4401602  -0.20827247]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.58889234 -0.7423012   1.1570306   0.4401602  -0.20827247]
  [FlaxMamba2] xBC (step) sample values: [-0.26901987 -0.37973344  0.57214713  1.4270583   0.22059946]
  [FlaxMamba2] dt (step) sample values: [1.1574651 1.5224695 1.4076127 1.0998038 1.5426985]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.         -0.26901987  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.04229707 -0.0538172   0.1139126   0.2855162  -0.04432455]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.0779416  -0.07815497  0.10891153  0.24291366 -0.07728353]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03745285 -0.03755121  0.05741827  0.13613647 -0.03714932]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03745285 -0.03755121  0.05741827  0.13613647 -0.03714932]
  [FlaxMamba2] B (step) sample values: [-0.02655338 -0.10968361  0.14671181  0.18021159 -0.02374081]
  [FlaxMamba2] C (step) sample values: [-0.24177624 -0.04797389  0.16383487 -0.14424388 -0.21883498]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9436172 -1.8178532 -2.0862153 -1.0006425 -0.9649832]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.16391245 0.12565456 0.09124423 0.14664684 0.299786  ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7271787  0.7957887  0.8266655  0.8635175  0.74879616]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03745285 -0.03755121  0.05741827  0.13613647 -0.03714932]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00016301  0.00067335 -0.00090066 -0.00110632  0.00014574]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00016301  0.00067335 -0.00090066 -0.00110632  0.00014574]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00016301  0.00067335 -0.00090066 -0.00110632  0.00014574]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0020341  -0.00203944  0.00311844  0.00739371 -0.00201762]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00624701 -0.00626341  0.00957717  0.0227071  -0.00619638]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00624701 -0.00626341  0.00957717  0.0227071  -0.00619638]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.00131293 0.00149942 0.00843041 0.00607979 0.00057831]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.01998105 0.02398039 0.17296623 0.0912558  0.01234866]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.01998105 0.02398039 0.17296623 0.0912558  0.01234866]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.13290273  0.10705168  0.22494148  0.42674166 -0.18072012]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.13290273  0.10705168  0.22494148  0.42674166 -0.18072012]
  [Layer 19] Output shape after mixer: (1, 1, 2048)
  [Layer 19] Output sample values after mixer: [ 0.13290273  0.10705168  0.22494148  0.42674166 -0.18072012]
  [Layer 19] Residual connection shape: (1, 1, 2048)
  [Layer 19] Residual connection sample values: [-1.5346334   5.7850404   0.08949555 -0.6107294  -1.6701069 ]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.15829532  0.51152724  0.00847324 -0.05348483 -0.16704565]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.15829532  0.51152724  0.00847324 -0.05348483 -0.16704565]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.15829532  0.51152724  0.00847324 -0.05348483 -0.16704565]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.4421578  -0.601773   -1.1675231   0.21734089 -0.8812898 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.4421578  -0.601773   -1.1675231   0.21734089 -0.8812898 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.5821599  -0.34626317 -0.35728398  0.7589901  -0.52156496]
  [FlaxMamba2] dt (step) sample values: [2.148776  1.4676919 3.012857  2.1176574 2.3227384]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.        0.        0.        0.5821599 0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00245839 -0.03311733  0.0093606   0.00699509 -0.00040613]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.03602428 -0.02458767  0.07588892 -0.01180374 -0.02785669]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01768774 -0.0121427   0.03938355 -0.00586704 -0.01373436]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01768774 -0.0121427   0.03938355 -0.00586704 -0.01373436]
  [FlaxMamba2] B (step) sample values: [-0.00321717 -0.00835929  0.04264062 -0.00819706  0.20757133]
  [FlaxMamba2] C (step) sample values: [ 0.08193165 -0.26191193  0.09741897 -0.13504238  0.68415624]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.6215758 -5.0388985 -1.2056414 -1.6434968 -1.3345234]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.22666657 0.04835247 0.16449234 0.3305905  0.27229446]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6924238  0.7837672  0.8201084  0.5808142  0.69531983]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01768774 -0.0121427   0.03938355 -0.00586704 -0.01373436]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.28983365e-05  3.35142031e-05 -1.70955551e-04  3.28638125e-05
 -8.32198770e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.28983365e-05  3.35142031e-05 -1.70955551e-04  3.28638125e-05
 -8.32198770e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.28983365e-05  3.35142031e-05 -1.70955551e-04  3.28638125e-05
 -8.32198770e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00312936 -0.00214832  0.00696783 -0.00103801 -0.00242992]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00327027 -0.00224506  0.0072816  -0.00108475 -0.00253934]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00327027 -0.00224506  0.0072816  -0.00108475 -0.00253934]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00056571  0.00047818 -0.00201742 -0.00013064  0.0006555 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00515431  0.00466686 -0.02643238 -0.0012951   0.00580597]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00515431  0.00466686 -0.02643238 -0.0012951   0.00580597]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.35955375  0.20107608 -0.59889823 -0.23381466 -0.07164821]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.35955375  0.20107608 -0.59889823 -0.23381466 -0.07164821]
  [Layer 20] Output shape after mixer: (1, 1, 2048)
  [Layer 20] Output sample values after mixer: [ 0.35955375  0.20107608 -0.59889823 -0.23381466 -0.07164821]
  [Layer 20] Residual connection shape: (1, 1, 2048)
  [Layer 20] Residual connection sample values: [-1.1750796   5.9861164  -0.5094027  -0.84454405 -1.7417551 ]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.09174155  0.4241578  -0.0342403  -0.05473603 -0.12715185]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09174155  0.4241578  -0.0342403  -0.05473603 -0.12715185]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09174155  0.4241578  -0.0342403  -0.05473603 -0.12715185]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.05342992 -0.5279178  -0.20027521 -0.20181502 -1.5348688 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.05342992 -0.5279178  -0.20027521 -0.20181502 -1.5348688 ]
  [FlaxMamba2] xBC (step) sample values: [-0.53410375  0.4050171  -1.1389555   0.36177924 -0.35829857]
  [FlaxMamba2] dt (step) sample values: [-0.12762934  1.1301656   0.08525672  0.1582119   0.92705816]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.         -0.53410375  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.08358411  0.07490245  0.14834784 -0.06107675  0.05025452]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.05230359  0.04481212  0.16320227 -0.06615792  0.07814759]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02683556  0.02290801  0.08824515 -0.03198515  0.04059978]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02683556  0.02290801  0.08824515 -0.03198515  0.04059978]
  [FlaxMamba2] B (step) sample values: [-7.9015372e-03  7.4757938e-04 -5.8761216e-03 -6.0098907e-03
 -6.6295062e-05]
  [FlaxMamba2] C (step) sample values: [-0.01017173 -0.10517606 -0.01678262  0.02229653 -0.09782854]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.2091806  -0.04342505 -3.8147197  -6.662431   -0.02279418]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05150922 0.01307158 0.03273094 0.02824382 0.01971129]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.84763736 0.9994325  0.88262105 0.8284718  0.9995508 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02683556  0.02290801  0.08824515 -0.03198515  0.04059978]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0922126e-05  1.0333630e-06 -8.1224371e-06 -8.3073437e-06
 -9.1638249e-08]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0922126e-05  1.0333630e-06 -8.1224371e-06 -8.3073437e-06
 -9.1638249e-08]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.0922126e-05  1.0333630e-06 -8.1224371e-06 -8.3073437e-06
 -9.1638249e-08]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-5.5301007e-05 -4.7207359e-05 -1.8184996e-04  6.5912936e-05
 -8.3665429e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00465519  0.00397388  0.01530798 -0.0055485   0.00704289]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00465519  0.00397388  0.01530798 -0.0055485   0.00704289]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00012768 -0.00077832 -0.00137991  0.00050358 -0.00191641]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00455828 -0.02551473 -0.06012491  0.01850421 -0.06329805]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00455828 -0.02551473 -0.06012491  0.01850421 -0.06329805]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.00544226 -0.18082593 -0.01675279 -0.08362912 -0.319612  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.00544226 -0.18082593 -0.01675279 -0.08362912 -0.319612  ]
  [Layer 21] Output shape after mixer: (1, 1, 2048)
  [Layer 21] Output sample values after mixer: [-0.00544226 -0.18082593 -0.01675279 -0.08362912 -0.319612  ]
  [Layer 21] Residual connection shape: (1, 1, 2048)
  [Layer 21] Residual connection sample values: [-1.1805218  5.8052907 -0.5261555 -0.9281732 -2.061367 ]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.13693768  0.5671672  -0.05447392 -0.08857211 -0.22417691]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.13693768  0.5671672  -0.05447392 -0.08857211 -0.22417691]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.13693768  0.5671672  -0.05447392 -0.08857211 -0.22417691]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.54258084 -0.7487756   0.10221721  0.46109587 -2.1855934 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.54258084 -0.7487756   0.10221721  0.46109587 -2.1855934 ]
  [FlaxMamba2] xBC (step) sample values: [-0.8759526   0.73010164  0.1279792  -1.6652493   0.20586088]
  [FlaxMamba2] dt (step) sample values: [1.787843   1.2745715  1.0884987  0.59461665 1.7740438 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.         0.        -0.8759526  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [0.04047218 0.16140309 0.01937185 0.27605087 0.0605621 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00719628  0.08266774  0.3387078   0.23506576 -0.00511173]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00358519  0.04304139  0.19776356  0.1312836  -0.00254933]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00358519  0.04304139  0.19776356  0.1312836  -0.00254933]
  [FlaxMamba2] B (step) sample values: [ 0.0152194   0.00726612 -0.00191201 -0.24723493  0.07828372]
  [FlaxMamba2] C (step) sample values: [ 0.14248057 -0.03377641 -0.08378499 -0.02253228 -0.11547992]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.1489344 -3.5005836 -2.8320918 -5.5395546 -1.7185895]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00792908 0.13796557 0.17476763 0.08182163 0.01674245]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.967638   0.61695445 0.60959655 0.6355558  0.9716366 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00358519  0.04304139  0.19776356  0.1312836  -0.00254933]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.3264632e-07 -2.0655607e-07  5.4353293e-08  7.0282190e-06
 -2.2253939e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.3264632e-07 -2.0655607e-07  5.4353293e-08  7.0282190e-06
 -2.2253939e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-4.3264632e-07 -2.0655607e-07  5.4353293e-08  7.0282190e-06
 -2.2253939e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-7.4676805e-06  8.9651890e-05  4.1192613e-04  2.7345348e-04
 -5.3100598e-06]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00087579  0.01051415  0.04830968  0.03206996 -0.00062275]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00087579  0.01051415  0.04830968  0.03206996 -0.00062275]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00017467 -0.00252784  0.00259512  0.00906868  0.00013754]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00056912 -0.02318684  0.01357569  0.11671645  0.00116237]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00056912 -0.02318684  0.01357569  0.11671645  0.00116237]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.23592843  0.2368209   0.65783125 -0.28725785 -1.41338   ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.23592843  0.2368209   0.65783125 -0.28725785 -1.41338   ]
  [Layer 22] Output shape after mixer: (1, 1, 2048)
  [Layer 22] Output sample values after mixer: [-0.23592843  0.2368209   0.65783125 -0.28725785 -1.41338   ]
  [Layer 22] Residual connection shape: (1, 1, 2048)
  [Layer 22] Residual connection sample values: [-1.4164503   6.0421114   0.13167578 -1.215431   -3.4747472 ]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.10568336  0.38786712  0.00899407 -0.07843399 -0.25123355]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.10568336  0.38786712  0.00899407 -0.07843399 -0.25123355]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.10568336  0.38786712  0.00899407 -0.07843399 -0.25123355]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.15188053 -0.19708331  0.2312324   0.5385538  -0.22339691]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.15188053 -0.19708331  0.2312324   0.5385538  -0.22339691]
  [FlaxMamba2] xBC (step) sample values: [-0.23471718 -0.44079065  0.24223137 -0.7064501  -0.7379434 ]
  [FlaxMamba2] dt (step) sample values: [0.41237006 0.34728047 1.4912554  0.04646656 2.2121687 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.         -0.23471718  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.09117066  0.242564    0.07894992 -0.14211789  0.29330367]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.11354005  0.20945242  0.06759738 -0.14427891  0.24392623]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.05355064  0.11565387  0.03494061 -0.06694437  0.1367648 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05355064  0.11565387  0.03494061 -0.06694437  0.1367648 ]
  [FlaxMamba2] B (step) sample values: [-0.01788555 -0.01363974  0.02940955  0.00074888  0.08490748]
  [FlaxMamba2] C (step) sample values: [-0.08895854 -0.01857405  0.04112567 -0.02661394  0.0310429 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.08112868 -3.7998476  -0.08256738 -0.48783726 -1.4532163 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01784109 0.06043798 0.04532073 0.00152533 0.00943202]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99855363 0.7948077  0.996265   0.9992562  0.9863867 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05355064  0.11565387  0.03494061 -0.06694437  0.1367648 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.7087881e-05  1.3031431e-05 -2.8097931e-05 -7.1547964e-07
 -8.1120750e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.7087881e-05  1.3031431e-05 -2.8097931e-05 -7.1547964e-07
 -8.1120750e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.7087881e-05  1.3031431e-05 -2.8097931e-05 -7.1547964e-07
 -8.1120750e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00015652  0.00033803  0.00010212 -0.00019566  0.00039974]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00098589 -0.00212923 -0.00064327  0.00123247 -0.00251789]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00098589 -0.00212923 -0.00064327  0.00123247 -0.00251789]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-6.9193899e-05  1.8920876e-04 -8.2932915e-05  4.1914324e-04
  2.4995988e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00733026  0.00254291 -0.00195753  0.0158722   0.02773458]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00733026  0.00254291 -0.00195753  0.0158722   0.02773458]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.29180574 -0.00554318 -0.6293884  -0.30523697  0.00860005]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.29180574 -0.00554318 -0.6293884  -0.30523697  0.00860005]
  [Layer 23] Output shape after mixer: (1, 1, 2048)
  [Layer 23] Output sample values after mixer: [-0.29180574 -0.00554318 -0.6293884  -0.30523697  0.00860005]
  [Layer 23] Residual connection shape: (1, 1, 2048)
  [Layer 23] Residual connection sample values: [-1.708256   6.036568  -0.4977126 -1.5206679 -3.4661472]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.09886358  0.33333457 -0.02655838 -0.07827789 -0.19452655]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09886358  0.33333457 -0.02655838 -0.07827789 -0.19452655]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09886358  0.33333457 -0.02655838 -0.07827789 -0.19452655]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.5561572   0.0113372   0.8382821  -0.3428742  -0.12403212]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.5561572   0.0113372   0.8382821  -0.3428742  -0.12403212]
  [FlaxMamba2] xBC (step) sample values: [ 0.47222868  0.37858182  0.18879066 -0.23049438 -0.18610612]
  [FlaxMamba2] dt (step) sample values: [ 2.490238   -0.21352196 -0.0756091   1.6389478   0.5808007 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         0.         0.47222868 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.0941921   0.01714525  0.02588036 -0.04178273 -0.0875553 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.09753758  0.01713613  0.02192071 -0.04340016 -0.09228934]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04639228  0.00864147  0.01108048 -0.02122926 -0.04401685]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04639228  0.00864147  0.01108048 -0.02122926 -0.04401685]
  [FlaxMamba2] B (step) sample values: [-0.00776219  0.00525507 -0.00282225 -0.00223405 -0.03831996]
  [FlaxMamba2] C (step) sample values: [-0.11032782 -0.27261296 -0.26563713 -0.21870361  0.23471549]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.07415762 -3.4496791  -3.2884939  -0.16087165 -2.6944954 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06448039 0.02354702 0.04245079 0.02338686 0.03828784]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9952297  0.92198193 0.86970675 0.9962448  0.9019769 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04639228  0.00864147  0.01108048 -0.02122926 -0.04401685]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.32197635e-05 -1.57199902e-05  8.44246733e-06  6.68291659e-06
  1.14630035e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.32197635e-05 -1.57199902e-05  8.44246733e-06  6.68291659e-06
  1.14630035e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.32197635e-05 -1.57199902e-05  8.44246733e-06  6.68291659e-06
  1.14630035e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00086945  0.00016195  0.00020766 -0.00039786 -0.00082493]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00062248  0.00011595  0.00014867 -0.00028485 -0.00059061]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00062248  0.00011595  0.00014867 -0.00028485 -0.00059061]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-2.2002956e-04  6.6099409e-07  8.7005690e-05  4.0542800e-05
  3.4358516e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-7.1137878e-03  3.0274148e-05  3.5986465e-03  6.1174780e-03
  3.0670161e-03]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-7.1137878e-03  3.0274148e-05  3.5986465e-03  6.1174780e-03
  3.0670161e-03]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.0349753  -0.05928016  0.4390625   0.9228503  -0.50870925]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.0349753  -0.05928016  0.4390625   0.9228503  -0.50870925]
  [Layer 24] Output shape after mixer: (1, 1, 2048)
  [Layer 24] Output sample values after mixer: [ 1.0349753  -0.05928016  0.4390625   0.9228503  -0.50870925]
  [Layer 24] Residual connection shape: (1, 1, 2048)
  [Layer 24] Residual connection sample values: [-0.6732807   5.9772882  -0.05865011 -0.5978176  -3.9748564 ]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.04088249  0.33173704 -0.00336298 -0.03204889 -0.23878878]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04088249  0.33173704 -0.00336298 -0.03204889 -0.23878878]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04088249  0.33173704 -0.00336298 -0.03204889 -0.23878878]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.1117124  -0.40818173 -0.3936453  -0.3096228  -0.40991488]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.1117124  -0.40818173 -0.3936453  -0.3096228  -0.40991488]
  [FlaxMamba2] xBC (step) sample values: [-0.66385597  0.27833366 -0.12744772  0.05045757 -0.21859553]
  [FlaxMamba2] dt (step) sample values: [ 1.3594058  -0.06593143  1.6910492   2.341458   -0.5599    ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.         -0.66385597  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01131481 -0.01658042 -0.0053907  -0.00388656 -0.01071364]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01386875 -0.04479393 -0.01680428  0.05693497 -0.01647764]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00688629 -0.02189542 -0.00833154  0.02927766 -0.00817095]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00688629 -0.02189542 -0.00833154  0.02927766 -0.00817095]
  [FlaxMamba2] B (step) sample values: [-0.00718191  0.07453417  0.02961813  0.01217762 -0.00115916]
  [FlaxMamba2] C (step) sample values: [-0.00742314 -0.04216798 -0.04250409  0.02845706 -0.08669257]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -0.37022203  -1.5044799   -5.7209826   -0.81757224 -14.66622   ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.45272356 0.0059778  0.13454159 0.07084242 0.01876899]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.84568506 0.99104685 0.46314734 0.9437266  0.759367  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00688629 -0.02189542 -0.00833154  0.02927766 -0.00817095]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.2390223e-05 -2.3236658e-04 -9.2337024e-05 -3.7964768e-05
  3.6137778e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.2390223e-05 -2.3236658e-04 -9.2337024e-05 -3.7964768e-05
  3.6137778e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.2390223e-05 -2.3236658e-04 -9.2337024e-05 -3.7964768e-05
  3.6137778e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00010784 -0.00034288 -0.00013047  0.00045849 -0.00012796]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00017978 -0.00057162 -0.00021751  0.00076435 -0.00021332]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00017978 -0.00057162 -0.00021751  0.00076435 -0.00021332]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 9.48149045e-06  9.31781033e-05  3.44920045e-05 -1.00156045e-04
  3.48835456e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00030837  0.00207017  0.0012371  -0.00214284  0.00163425]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00030837  0.00207017  0.0012371  -0.00214284  0.00163425]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.1504492   0.49371806 -0.71965015 -0.3079024   0.1051138 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.1504492   0.49371806 -0.71965015 -0.3079024   0.1051138 ]
  [Layer 25] Output shape after mixer: (1, 1, 2048)
  [Layer 25] Output sample values after mixer: [ 1.1504492   0.49371806 -0.71965015 -0.3079024   0.1051138 ]
  [Layer 25] Residual connection shape: (1, 1, 2048)
  [Layer 25] Residual connection sample values: [ 0.47716844  6.4710064  -0.7783003  -0.90572    -3.8697426 ]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03453819  0.43340117 -0.05248387 -0.05991451 -0.2738933 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03453819  0.43340117 -0.05248387 -0.05991451 -0.2738933 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03453819  0.43340117 -0.05248387 -0.05991451 -0.2738933 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.26677346  0.27309617 -0.04477062 -0.21542041 -0.21352534]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.26677346  0.27309617 -0.04477062 -0.21542041 -0.21352534]
  [FlaxMamba2] xBC (step) sample values: [ 0.44917983 -0.18353921  0.5785415  -0.39583907 -0.45216775]
  [FlaxMamba2] dt (step) sample values: [0.71365815 1.2583169  1.657566   1.1537013  1.9206446 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         0.         0.44917983 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [0.14596151 0.04021642 0.12125925 0.07479966 0.09333687]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.05746053 -0.01584437  0.18540719  0.04785264  0.10144692]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02955547 -0.00785943  0.10127302  0.02449868  0.05329413]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02955547 -0.00785943  0.10127302  0.02449868  0.05329413]
  [FlaxMamba2] B (step) sample values: [-0.00111681 -0.00088711 -0.01034162  0.00395955  0.00089644]
  [FlaxMamba2] C (step) sample values: [-0.101504   -0.10597358 -0.04855381  0.11292455 -0.048027  ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9594627  -0.39448437 -0.84198165 -1.4275463  -0.14661841]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11269585 0.34118676 0.29169193 0.30737123 0.07253721]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8975132  0.8740717  0.7822356  0.6448183  0.98942107]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02955547 -0.00785943  0.10127302  0.02449868  0.05329413]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.71984288e-06 -2.95477571e-06 -3.44456566e-05  1.31883735e-05
  2.98585428e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.71984288e-06 -2.95477571e-06 -3.44456566e-05  1.31883735e-05
  2.98585428e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.71984288e-06 -2.95477571e-06 -3.44456566e-05  1.31883735e-05
  2.98585428e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00048226 -0.00012824  0.00165249  0.00039975  0.00086961]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00424718 -0.00112941  0.01455313  0.00352051  0.00765847]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00424718 -0.00112941  0.01455313  0.00352051  0.00765847]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00064164 -0.00017515 -0.00031848 -0.00033851 -0.00073068]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00507109 -0.00307402 -0.00475643 -0.00769687 -0.01450464]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00507109 -0.00307402 -0.00475643 -0.00769687 -0.01450464]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.84298915  1.0543933  -0.46304873  1.6036719  -0.26143426]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.84298915  1.0543933  -0.46304873  1.6036719  -0.26143426]
  [Layer 26] Output shape after mixer: (1, 1, 2048)
  [Layer 26] Output sample values after mixer: [-0.84298915  1.0543933  -0.46304873  1.6036719  -0.26143426]
  [Layer 26] Residual connection shape: (1, 1, 2048)
  [Layer 26] Residual connection sample values: [-0.3658207  7.5253997 -1.241349   0.6979519 -4.131177 ]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.0259182   0.48651025 -0.08610167  0.0444584  -0.3044744 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.0259182   0.48651025 -0.08610167  0.0444584  -0.3044744 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.0259182   0.48651025 -0.08610167  0.0444584  -0.3044744 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.10842991 -1.0230902   1.230826   -0.6488058   0.48781136]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.10842991 -1.0230902   1.230826   -0.6488058   0.48781136]
  [FlaxMamba2] xBC (step) sample values: [ 0.71732396  0.03014725 -0.7526085  -0.27422902  0.10708646]
  [FlaxMamba2] dt (step) sample values: [1.2072208  1.1090018  0.38631144 0.8686436  1.9879029 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         0.         0.71732396 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.11181918 -0.00319431 -0.18208863  0.03109848 -0.01318319]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0858182  -0.03969334 -0.1920984  -0.17080581 -0.04296835]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.04474916 -0.01945283 -0.08685202 -0.07812694 -0.02102268]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04474916 -0.01945283 -0.08685202 -0.07812694 -0.02102268]
  [FlaxMamba2] B (step) sample values: [-0.08349092 -0.02791505  0.19157231 -0.02015053  0.14911431]
  [FlaxMamba2] C (step) sample values: [ 1.3005224e-01 -2.4064034e-01  2.1451469e-04 -4.0931866e-02
 -2.5415516e-01]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3661706 -1.3799144 -1.8267511 -2.0408754 -2.3490334]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1348566  0.13627091 0.07083774 0.03943235 0.29027796]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8317386  0.8285797  0.8786199  0.92267656 0.5056692 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04474916 -0.01945283 -0.08685202 -0.07812694 -0.02102268]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00050384 -0.00016846  0.00115609 -0.0001216   0.00089986]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00050384 -0.00016846  0.00115609 -0.0001216   0.00089986]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00050384 -0.00016846  0.00115609 -0.0001216   0.00089986]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00299949 -0.00130391 -0.00582161 -0.00523678 -0.00140913]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00752524 -0.00327128 -0.01460546 -0.01313821 -0.00353528]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00752524 -0.00327128 -0.01460546 -0.01313821 -0.00353528]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00038588  0.00088499 -0.01391337  0.00292599 -0.00106851]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00448784  0.00748324 -0.2031769   0.03844751 -0.00863356]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00448784  0.00748324 -0.2031769   0.03844751 -0.00863356]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.44770703  0.6198191   0.2528701   0.5544514  -0.40784198]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.44770703  0.6198191   0.2528701   0.5544514  -0.40784198]
  [Layer 27] Output shape after mixer: (1, 1, 2048)
  [Layer 27] Output sample values after mixer: [ 0.44770703  0.6198191   0.2528701   0.5544514  -0.40784198]
  [Layer 27] Residual connection shape: (1, 1, 2048)
  [Layer 27] Residual connection sample values: [ 0.08188632  8.145219   -0.9884789   1.2524033  -4.539019  ]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00540677  0.50320727 -0.06169564  0.07598049 -0.29663774]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00540677  0.50320727 -0.06169564  0.07598049 -0.29663774]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00540677  0.50320727 -0.06169564  0.07598049 -0.29663774]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.618633    0.1577042   0.05589008  0.1045026  -0.83850974]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.618633    0.1577042   0.05589008  0.1045026  -0.83850974]
  [FlaxMamba2] xBC (step) sample values: [ 0.56419134 -0.7532583   0.02669824 -0.58194864 -0.8615248 ]
  [FlaxMamba2] dt (step) sample values: [0.5772228  0.5902128  0.97071576 0.28711265 1.1587906 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         0.         0.56419134 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.09834781  0.11420249  0.00549152 -0.09291856  0.14039741]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.15611759  0.10284232 -0.00817273 -0.10429399  0.24507271]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07197797  0.05406297 -0.00406966 -0.04943015  0.13747682]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07197797  0.05406297 -0.00406966 -0.04943015  0.13747682]
  [FlaxMamba2] B (step) sample values: [ 0.00261896 -0.02213489 -0.07889506 -0.02224107  0.25170103]
  [FlaxMamba2] C (step) sample values: [-0.11320113 -0.15625545  0.5164377   0.08456879  0.3845382 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2727895 -3.997792  -2.517685  -2.1714401 -2.8654757]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01806365 0.07803327 0.10673327 0.02275703 0.04778804]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9772711  0.73201025 0.7643567  0.95178556 0.8720265 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07197797  0.05406297 -0.00406966 -0.04943015  0.13747682]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.4051300e-06  2.8779436e-05  1.0257814e-04  2.8917497e-05
 -3.2725779e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.4051300e-06  2.8779436e-05  1.0257814e-04  2.8917497e-05
 -3.2725779e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.4051300e-06  2.8779436e-05  1.0257814e-04  2.8917497e-05
 -3.2725779e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-3.9447902e-04  2.9629486e-04 -2.2304001e-05 -2.7090445e-04
  7.5344869e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01599733  0.01201567 -0.0009045  -0.01098601  0.03055467]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01599733  0.01201567 -0.0009045  -0.01098601  0.03055467]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 4.2826682e-03  1.0220156e-03 -2.5982336e-05 -6.0399988e-04
 -7.7334805e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.11365716  0.01797547 -0.00043292 -0.01162137 -0.14434414]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.11365716  0.01797547 -0.00043292 -0.01162137 -0.14434414]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.85445833 -1.9347574   0.7755557   1.1880028   0.4987734 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.85445833 -1.9347574   0.7755557   1.1880028   0.4987734 ]
  [Layer 28] Output shape after mixer: (1, 1, 2048)
  [Layer 28] Output sample values after mixer: [-0.85445833 -1.9347574   0.7755557   1.1880028   0.4987734 ]
  [Layer 28] Residual connection shape: (1, 1, 2048)
  [Layer 28] Residual connection sample values: [-0.77257204  6.2104616  -0.21292323  2.440406   -4.0402455 ]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.04277164  0.32884088 -0.01128907  0.12460946 -0.22240704]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04277164  0.32884088 -0.01128907  0.12460946 -0.22240704]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04277164  0.32884088 -0.01128907  0.12460946 -0.22240704]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.19434422 -0.46806553 -0.27516347 -0.04354782  0.8224448 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.19434422 -0.46806553 -0.27516347 -0.04354782  0.8224448 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.60593826 -0.30996993  0.7313008  -0.33873042  0.1841037 ]
  [FlaxMamba2] dt (step) sample values: [0.5326586  1.0091014  0.64557886 3.3595881  1.1013967 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         0.         0.60593826 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.03755678  0.08869257 -0.12613867  0.06330521  0.01934977]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.02415194  0.05417719 -0.123291    0.0028804  -0.09374838]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01222179  0.02782221 -0.05785013  0.00144228 -0.04467861]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01222179  0.02782221 -0.05785013  0.00144228 -0.04467861]
  [FlaxMamba2] B (step) sample values: [ 0.01252833  0.03971106 -0.1177711   0.15198465 -0.0713476 ]
  [FlaxMamba2] C (step) sample values: [-0.21959418 -0.21867588 -0.206665   -0.23592722 -0.24010283]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8072329  -2.117      -1.925669   -0.29044876 -2.049864  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03589563 0.1301459  0.11804599 0.04434344 0.17811751]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9371877  0.7591781  0.7966678  0.98720306 0.69411564]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01222179  0.02782221 -0.05785013  0.00144228 -0.04467861]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.4962884e-06  1.7421593e-05 -5.1667223e-05  6.6677007e-05
 -3.1300824e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.4962884e-06  1.7421593e-05 -5.1667223e-05  6.6677007e-05
 -3.1300824e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 5.4962884e-06  1.7421593e-05 -5.1667223e-05  6.6677007e-05
 -3.1300824e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 1.7157508e-04  3.9058086e-04 -8.1212667e-04  2.0247320e-05
 -6.2721857e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01266871  0.02883959 -0.05996557  0.00149502 -0.0463124 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01266871  0.02883959 -0.05996557  0.00149502 -0.0463124 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-1.1117972e-03 -5.1980475e-03  7.1222032e-03 -3.1843658e-05
 -2.6462797e-02]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.0052118  -0.02293109  0.04978226 -0.00019965 -0.1471989 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0052118  -0.02293109  0.04978226 -0.00019965 -0.1471989 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.29705656  1.7180697   0.5314022   0.6777589  -0.04134315]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.29705656  1.7180697   0.5314022   0.6777589  -0.04134315]
  [Layer 29] Output shape after mixer: (1, 1, 2048)
  [Layer 29] Output sample values after mixer: [-0.29705656  1.7180697   0.5314022   0.6777589  -0.04134315]
  [Layer 29] Residual connection shape: (1, 1, 2048)
  [Layer 29] Residual connection sample values: [-1.0696286   7.928531    0.31847894  3.118165   -4.0815887 ]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.06082178  0.44359806  0.01769416  0.16337839 -0.23847723]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.06082178  0.44359806  0.01769416  0.16337839 -0.23847723]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.06082178  0.44359806  0.01769416  0.16337839 -0.23847723]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.1069428  -0.19882002 -0.2069992  -0.20913973 -1.1923547 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.1069428  -0.19882002 -0.2069992  -0.20913973 -1.1923547 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.0781267  -0.564878   -0.15335454  0.60384494 -0.46354902]
  [FlaxMamba2] dt (step) sample values: [1.2444963 1.9703329 2.1996865 2.44787   2.2947545]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.        0.        0.        1.0781267 0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.17648533 -0.07778105 -0.0631614  -0.11270495  0.09342279]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.15320042 -0.06407866 -0.03001931 -0.13084765  0.06607904]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.08245635 -0.03101316 -0.01478438 -0.06114965  0.03413073]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.08245635 -0.03101316 -0.01478438 -0.06114965  0.03413073]
  [FlaxMamba2] B (step) sample values: [ 0.03076732 -0.00150271 -0.05891756  0.2314198  -0.02656916]
  [FlaxMamba2] C (step) sample values: [-0.27821782 -0.2766486  -0.2578229   0.06425945 -0.1752566 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0149885  -0.4675477  -0.42799968 -0.7895216  -0.4174731 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01376219 0.5809239  1.228605   0.50763613 0.7349166 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9861286 0.7621517 0.5910572 0.6697909 0.7357919]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.08245635 -0.03101316 -0.01478438 -0.06114965  0.03413073]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.4914145e-05 -1.7052492e-06 -6.6858476e-05  2.6261061e-04
 -3.0150162e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.4914145e-05 -1.7052492e-06 -6.6858476e-05  2.6261061e-04
 -3.0150162e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 3.4914145e-05 -1.7052492e-06 -6.6858476e-05  2.6261061e-04
 -3.0150162e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 3.7875312e-04 -1.4245514e-04 -6.7910252e-05 -2.8088345e-04
  1.5677528e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.10195871 -0.03834831 -0.01828115 -0.0756126   0.04220324]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.10195871 -0.03834831 -0.01828115 -0.0756126   0.04220324]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00516063  0.00343448  0.00169696  0.00708299 -0.0117167 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.03166479  0.02138834  0.0064157   0.03607892 -0.05303969]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03166479  0.02138834  0.0064157   0.03607892 -0.05303969]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.15398385 -0.9035297  -0.38008454  0.47815192  0.5944591 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.15398385 -0.9035297  -0.38008454  0.47815192  0.5944591 ]
  [Layer 30] Output shape after mixer: (1, 1, 2048)
  [Layer 30] Output sample values after mixer: [ 0.15398385 -0.9035297  -0.38008454  0.47815192  0.5944591 ]
  [Layer 30] Residual connection shape: (1, 1, 2048)
  [Layer 30] Residual connection sample values: [-0.91564476  7.0250015  -0.0616056   3.5963168  -3.4871297 ]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.04983697  0.3751403  -0.00329938  0.1874548  -0.19175293]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04983697  0.3751403  -0.00329938  0.1874548  -0.19175293]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04983697  0.3751403  -0.00329938  0.1874548  -0.19175293]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.22546858 -0.66004276 -0.7082954  -0.22640496  0.651489  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.22546858 -0.66004276 -0.7082954  -0.22640496  0.651489  ]
  [FlaxMamba2] xBC (step) sample values: [ 0.5427158  -0.42150083 -0.25926074 -0.66458935 -1.7701724 ]
  [FlaxMamba2] dt (step) sample values: [1.5813651 1.3919482 0.4356715 0.5483098 2.375802 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.        0.        0.        0.5427158 0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.09785049  0.0601997  -0.01375107  0.11000771  0.3381738 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.09735506  0.04987713 -0.01273636  0.1081099   0.33287138]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.05104516  0.02556037 -0.00632763  0.05697405  0.19388354]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05104516  0.02556037 -0.00632763  0.05697405  0.19388354]
  [FlaxMamba2] B (step) sample values: [-0.01387446  0.05104713 -0.05945669 -0.06071439 -0.00275269]
  [FlaxMamba2] C (step) sample values: [ 0.4892448  -0.1319434  -0.24368435  0.00192269 -0.13298708]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.9477868 -3.5383902 -4.705952  -2.462968  -0.9027082]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1511205  0.08838887 0.02430362 0.10127994 0.37597746]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6405225 0.7314296 0.8919264 0.7792298 0.712199 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05104516  0.02556037 -0.00632763  0.05697405  0.19388354]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0702718e-04  3.9377605e-04 -4.5864712e-04 -4.6834897e-04
 -2.1234166e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0702718e-04  3.9377605e-04 -4.5864712e-04 -4.6834897e-04
 -2.1234166e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.0702718e-04  3.9377605e-04 -4.5864712e-04 -4.6834897e-04
 -2.1234166e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00384155  0.00192362 -0.0004762   0.00428774  0.01459125]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03896146  0.01950957 -0.00482972  0.04348682  0.14798631]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03896146  0.01950957 -0.00482972  0.04348682  0.14798631]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00389922 -0.00438763  0.0011288  -0.00436791  0.06337567]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.03192392 -0.03138117  0.00718909 -0.02960895  0.50909793]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03192392 -0.03138117  0.00718909 -0.02960895  0.50909793]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.4110687  -0.0719313   0.49204347  0.01648022  1.1903651 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.4110687  -0.0719313   0.49204347  0.01648022  1.1903651 ]
  [Layer 31] Output shape after mixer: (1, 1, 2048)
  [Layer 31] Output sample values after mixer: [-0.4110687  -0.0719313   0.49204347  0.01648022  1.1903651 ]
  [Layer 31] Residual connection shape: (1, 1, 2048)
  [Layer 31] Residual connection sample values: [-1.3267134   6.95307     0.43043786  3.612797   -2.2967646 ]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.07279351  0.38313964  0.02365518  0.18596286 -0.13103415]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.07279351  0.38313964  0.02365518  0.18596286 -0.13103415]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.07279351  0.38313964  0.02365518  0.18596286 -0.13103415]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.43609038  0.5782122  -1.2938626  -1.491947   -0.27452078]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.43609038  0.5782122  -1.2938626  -1.491947   -0.27452078]
  [FlaxMamba2] xBC (step) sample values: [ 0.04304145  0.23182982  0.12744991  0.43357188 -0.05070113]
  [FlaxMamba2] dt (step) sample values: [2.5414557 2.250183  1.1002264 1.3499737 1.7211394]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         0.         0.04304145 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00022313  0.01451766 -0.0003537  -0.08611102 -0.0052824 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03739354 -0.03751481 -0.01619232 -0.07362933 -0.01225567]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.0190463  -0.0184056  -0.00803061 -0.03545995 -0.00609028]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0190463  -0.0184056  -0.00803061 -0.03545995 -0.00609028]
  [FlaxMamba2] B (step) sample values: [ 0.01525217  0.03125109  0.03732255 -0.00093486 -0.02696902]
  [FlaxMamba2] C (step) sample values: [-0.23156473 -0.0720053  -0.25262827 -0.27550837 -0.16837816]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6970906 -2.0892735 -1.7966746 -1.3893797 -1.0395182]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.70911777 0.05048382 0.31237814 0.3428434  0.6740206 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.60998595 0.89989746 0.57050014 0.6210525  0.4962593 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0190463  -0.0184056  -0.00803061 -0.03545995 -0.00609028]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.05996897e-04  4.22079407e-04  5.04081079e-04 -1.26262885e-05
 -3.64245469e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.05996897e-04  4.22079407e-04  5.04081079e-04 -1.26262885e-05
 -3.64245469e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.05996897e-04  4.22079407e-04  5.04081079e-04 -1.26262885e-05
 -3.64245469e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0076124  -0.00735632 -0.00320966 -0.01417258 -0.00243416]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01218114 -0.01177138 -0.00513601 -0.02267857 -0.00389507]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01218114 -0.01177138 -0.00513601 -0.02267857 -0.00389507]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00208591 -0.00436053  0.00143007  0.00621315  0.00046171]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00851076 -0.01431179  0.00911547  0.03241593  0.00197008]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00851076 -0.01431179  0.00911547  0.03241593  0.00197008]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.6334457   1.056772   -0.4315873  -0.20533492 -0.42752326]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.6334457   1.056772   -0.4315873  -0.20533492 -0.42752326]
  [Layer 32] Output shape after mixer: (1, 1, 2048)
  [Layer 32] Output sample values after mixer: [ 0.6334457   1.056772   -0.4315873  -0.20533492 -0.42752326]
  [Layer 32] Residual connection shape: (1, 1, 2048)
  [Layer 32] Residual connection sample values: [-6.9326776e-01  8.0098419e+00 -1.1494458e-03  3.4074621e+00
 -2.7242880e+00]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-3.4233902e-02  4.0987557e-01 -5.7818936e-05  1.6643132e-01
 -1.3933617e-01]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-3.4233902e-02  4.0987557e-01 -5.7818936e-05  1.6643132e-01
 -1.3933617e-01]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-3.4233902e-02  4.0987557e-01 -5.7818936e-05  1.6643132e-01
 -1.3933617e-01]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.6731577  -0.03297114 -0.9011766  -0.38061926 -0.6849349 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.6731577  -0.03297114 -0.9011766  -0.38061926 -0.6849349 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.5178368   1.0433941  -0.09410062 -0.47593254  0.6631021 ]
  [FlaxMamba2] dt (step) sample values: [0.00717539 0.2159782  0.901769   1.7969229  0.901548  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.        0.        0.        0.5178368 0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.07465396  0.08539987  0.0178736  -0.07872175 -0.10336687]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.06150851  0.03602243  0.04469856 -0.07992815 -0.1045561 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.03169978  0.01833559  0.02284868 -0.0383678  -0.04954755]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03169978  0.01833559  0.02284868 -0.0383678  -0.04954755]
  [FlaxMamba2] B (step) sample values: [ 0.38020605 -0.0554262  -0.06543758 -0.01132377  0.19391021]
  [FlaxMamba2] C (step) sample values: [-0.00565225 -0.22423032 -0.24775879 -0.230816   -0.0293982 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9790505  -9.693779   -6.1677613  -0.11351943 -2.090294  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01184025 0.01237867 0.03162121 0.04803692 0.00705834]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.97683996 0.88692385 0.82280827 0.99456173 0.9853543 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03169978  0.01833559  0.02284868 -0.0383678  -0.04954755]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.4270401e-04 -2.0803303e-05 -2.4560906e-05 -4.2501883e-06
  7.2780967e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.4270401e-04 -2.0803303e-05 -2.4560906e-05 -4.2501883e-06
  7.2780967e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.4270401e-04 -2.0803303e-05 -2.4560906e-05 -4.2501883e-06
  7.2780967e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00022073  0.00012767  0.0001591  -0.00026716 -0.00034501]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03322881  0.01922     0.02395078 -0.04021845 -0.05193745]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03322881  0.01922     0.02395078 -0.04021845 -0.05193745]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00755577 -0.00031163 -0.00623362  0.00621467  0.01192293]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.05571467 -0.0013695  -0.03451876  0.03361146  0.0729793 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.05571467 -0.0013695  -0.03451876  0.03361146  0.0729793 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.4342264  -0.1670462   0.6451089  -0.10112962 -0.30586442]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.4342264  -0.1670462   0.6451089  -0.10112962 -0.30586442]
  [Layer 33] Output shape after mixer: (1, 1, 2048)
  [Layer 33] Output sample values after mixer: [ 0.4342264  -0.1670462   0.6451089  -0.10112962 -0.30586442]
  [Layer 33] Residual connection shape: (1, 1, 2048)
  [Layer 33] Residual connection sample values: [-0.25904137  7.842796    0.6439594   3.3063326  -3.0301523 ]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00956935  0.30698255  0.02377369  0.12314682 -0.11740023]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00956935  0.30698255  0.02377369  0.12314682 -0.11740023]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00956935  0.30698255  0.02377369  0.12314682 -0.11740023]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.2012211   0.02026768  0.05105197 -0.5415954   0.12677643]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.2012211   0.02026768  0.05105197 -0.5415954   0.12677643]
  [FlaxMamba2] xBC (step) sample values: [ 0.04098805  0.07387628  0.32796127 -1.219758    0.8717552 ]
  [FlaxMamba2] dt (step) sample values: [ 0.54337204 -0.10055647  2.9273593   4.045144    3.5851161 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         0.         0.04098805 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00916627 -0.01109226  0.05232488  0.2925811   0.17484055]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04105714  0.01493923  0.04038487  0.25306085  0.16630326]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02010721  0.00752541  0.02060012  0.14245547  0.09004993]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02010721  0.00752541  0.02060012  0.14245547  0.09004993]
  [FlaxMamba2] B (step) sample values: [ 0.668366   -0.02431049  0.00085502  0.00759668  0.02535659]
  [FlaxMamba2] C (step) sample values: [ 0.0209302  -0.24243517 -0.27788237 -0.11375106 -0.13089485]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.5610816  -2.4810736  -2.893596   -0.01585086 -0.02613366]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08831108 0.02938143 0.1622039  0.6030011  0.2398312 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.79758096 0.92969614 0.6254071  0.99048746 0.99375194]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02010721  0.00752541  0.02060012  0.14245547  0.09004993]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.1868104e-03  4.3167878e-05 -1.5182508e-06 -1.3489343e-05
 -4.5025434e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.1868104e-03  4.3167878e-05 -1.5182508e-06 -1.3489343e-05
 -4.5025434e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.1868104e-03  4.3167878e-05 -1.5182508e-06 -1.3489343e-05
 -4.5025434e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00038721  0.00014492  0.0003967   0.0027433   0.00173411]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01277211  0.00478014  0.0130852   0.09048778  0.05719975]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01277211  0.00478014  0.0130852   0.09048778  0.05719975]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 1.1561576e-03  4.8932081e-05  3.4253680e-04 -1.8025866e-02
  3.8553153e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.0206139   0.00084847  0.00679057 -0.40182266  0.08162329]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0206139   0.00084847  0.00679057 -0.40182266  0.08162329]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.76847565  2.0799046   0.8128072   0.8905876  -0.57419986]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.76847565  2.0799046   0.8128072   0.8905876  -0.57419986]
  [Layer 34] Output shape after mixer: (1, 1, 2048)
  [Layer 34] Output sample values after mixer: [ 0.76847565  2.0799046   0.8128072   0.8905876  -0.57419986]
  [Layer 34] Residual connection shape: (1, 1, 2048)
  [Layer 34] Residual connection sample values: [ 0.5094343  9.922701   1.4567666  4.1969204 -3.6043522]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0246545   0.47931054  0.06923655  0.18709841 -0.17262378]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0246545   0.47931054  0.06923655  0.18709841 -0.17262378]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0246545   0.47931054  0.06923655  0.18709841 -0.17262378]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.0341603  -0.6863982   0.66199166 -0.0942015  -0.29479784]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.0341603  -0.6863982   0.66199166 -0.0942015  -0.29479784]
  [FlaxMamba2] xBC (step) sample values: [-0.7414792   0.1216074   0.13026927  0.6639229   0.6928821 ]
  [FlaxMamba2] dt (step) sample values: [3.9161375 1.228412  2.9108582 1.4928291 1.1019344]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.         0.        -0.7414792  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12563148 -0.02839782 -0.0197821   0.13218485  0.12577096]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.03037438  0.01273987 -0.05597595  0.08723246  0.08429757]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01495656  0.00641051 -0.02720485  0.0455174   0.04392425]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01495656  0.00641051 -0.02720485  0.0455174   0.04392425]
  [FlaxMamba2] B (step) sample values: [ 0.00663198  0.1012474  -0.27823496  0.24323446 -0.06265584]
  [FlaxMamba2] C (step) sample values: [-0.19349144  0.21550593 -0.09473752 -0.2599159  -0.12497696]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.709799  -2.7746034 -0.4452666 -1.139112  -3.5906036]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.37760344 0.05689342 1.4207214  0.26725456 0.07600664]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.76489055 0.8539722  0.531209   0.73754156 0.7611615 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01495656  0.00641051 -0.02720485  0.0455174   0.04392425]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.7455091e-05 -5.7180959e-04  1.5713728e-03 -1.3737024e-03
  3.5385805e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.7455091e-05 -5.7180959e-04  1.5713728e-03 -1.3737024e-03
  3.5385805e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.7455091e-05 -5.7180959e-04  1.5713728e-03 -1.3737024e-03
  3.5385805e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00165028  0.00070732 -0.00300173  0.0050223   0.00484652]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01176582  0.00504294 -0.02140115  0.03580701  0.03455374]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01176582  0.00504294 -0.02140115  0.03580701  0.03455374]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00319134 -0.00115902 -0.00934633 -0.00160716 -0.00434784]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.04363429 -0.00843053 -0.04803584 -0.00954802 -0.03468329]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04363429 -0.00843053 -0.04803584 -0.00954802 -0.03468329]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 4.56661    3.5074356 -3.6412227  1.9854087 -3.2651424]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 4.56661    3.5074356 -3.6412227  1.9854087 -3.2651424]
  [Layer 35] Output shape after mixer: (1, 1, 2048)
  [Layer 35] Output sample values after mixer: [ 4.56661    3.5074356 -3.6412227  1.9854087 -3.2651424]
  [Layer 35] Residual connection shape: (1, 1, 2048)
  [Layer 35] Residual connection sample values: [ 5.076044  13.430137  -2.184456   6.182329  -6.8694944]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.20699202  0.55446863 -0.08845778  0.24871787 -0.2868153 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.20699202  0.55446863 -0.08845778  0.24871787 -0.2868153 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.20699202  0.55446863 -0.08845778  0.24871787 -0.2868153 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.1620393   0.49602547 -0.9137177  -1.5618149  -0.26037917]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.1620393   0.49602547 -0.9137177  -1.5618149  -0.26037917]
  [FlaxMamba2] xBC (step) sample values: [ 0.00556935 -0.31734365 -1.1995654   0.52950764 -0.46099508]
  [FlaxMamba2] dt (step) sample values: [1.757753  3.561447  1.7037917 1.4916271 1.6518646]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         0.         0.00556935 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.0009885  -0.05403984 -0.18831068  0.09352998  0.08396053]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.03718235 -0.0541736  -0.21679884  0.06859712  0.05609798]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01824558 -0.02635328 -0.09669479  0.03547449  0.02883553]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01824558 -0.02635328 -0.09669479  0.03547449  0.02883553]
  [FlaxMamba2] B (step) sample values: [ 0.10589316  0.33565813 -0.09357644  0.03719975  0.03505974]
  [FlaxMamba2] C (step) sample values: [ 0.6697914  -0.27743313 -0.17069745 -0.13044906 -0.2628673 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6566098 -1.1305923 -1.6058172 -2.4414158 -2.882315 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.22540064 0.12222973 0.11310211 0.1533418  0.19744238]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.54946977 0.87093145 0.8339171  0.68772167 0.5660397 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01824558 -0.02635328 -0.09669479  0.03547449  0.02883553]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00043549 -0.00138042  0.00038484 -0.00015299 -0.00014419]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00043549 -0.00138042  0.00038484 -0.00015299 -0.00014419]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00043549 -0.00138042  0.00038484 -0.00015299 -0.00014419]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00072527 -0.00104756 -0.00384367  0.00141013  0.00114623]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02163082 -0.0312428  -0.1146353   0.04205634  0.0341856 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02163082 -0.0312428  -0.1146353   0.04205634  0.0341856 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00161084 -0.00963191  0.02998197 -0.01138875 -0.00387444]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01336393 -0.11656881  0.24509908 -0.10478648 -0.03086093]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01336393 -0.11656881  0.24509908 -0.10478648 -0.03086093]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 4.8307467  2.5593843 -0.6668069  1.771335   0.9278186]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 4.8307467  2.5593843 -0.6668069  1.771335   0.9278186]
  [Layer 36] Output shape after mixer: (1, 1, 2048)
  [Layer 36] Output sample values after mixer: [ 4.8307467  2.5593843 -0.6668069  1.771335   0.9278186]
  [Layer 36] Residual connection shape: (1, 1, 2048)
  [Layer 36] Residual connection sample values: [ 9.906791  15.989521  -2.851263   7.9536643 -5.9416757]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.42796552  0.706702   -0.12169593  0.3324135  -0.2586535 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.42796552  0.706702   -0.12169593  0.3324135  -0.2586535 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.42796552  0.706702   -0.12169593  0.3324135  -0.2586535 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.7707826   1.905331    1.2174512  -3.9409022  -0.88778186]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.7707826   1.905331    1.2174512  -3.9409022  -0.88778186]
  [FlaxMamba2] xBC (step) sample values: [-0.05946744 -0.27784273  0.29697207 -0.60113955  1.6487015 ]
  [FlaxMamba2] dt (step) sample values: [ 2.230766   -1.0984952   2.4162166   1.7603997  -0.22992015]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.         -0.05946744  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01136792  0.04395559  0.02486851 -0.27092373  0.23325746]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00101459  0.0155132   0.02986958 -0.42180264  0.24799745]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00050704  0.00781677  0.01515782 -0.1670699   0.13929608]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00050704  0.00781677  0.01515782 -0.1670699   0.13929608]
  [FlaxMamba2] B (step) sample values: [ 0.02272036  0.01117461 -0.00028389 -0.00845756  0.01818017]
  [FlaxMamba2] C (step) sample values: [-0.26777214  0.08548848 -0.14657737 -0.04925691 -0.14704174]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.06064401 -3.2470093  -0.81907064 -0.24529998 -1.975189  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08410868 0.00326294 0.10041215 0.00724951 0.00928016]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9949123  0.9894611  0.9210466  0.99822325 0.9818369 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00050704  0.00781677  0.01515782 -0.1670699   0.13929608]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.6893439e-07 -4.7655337e-07  1.2106987e-08  3.6068190e-07
 -7.7531303e-07]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.6893439e-07 -4.7655337e-07  1.2106987e-08  3.6068190e-07
 -7.7531303e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-9.6893439e-07 -4.7655337e-07  1.2106987e-08  3.6068190e-07
 -7.7531303e-07]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-4.1484727e-05  6.3955365e-04  1.2401857e-03 -1.3669358e-02
  1.1396955e-02]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 5.5004621e-05 -8.4798469e-04 -1.6443629e-03  1.8124212e-02
 -1.5111229e-02]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 5.5004621e-05 -8.4798469e-04 -1.6443629e-03  1.8124212e-02
 -1.5111229e-02]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 8.3234700e-05 -1.4064491e-03 -1.5447199e-03 -1.3613977e-03
  3.9115204e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00037838 -0.00580289 -0.01256018 -0.02044994  0.01313206]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00037838 -0.00580289 -0.01256018 -0.02044994  0.01313206]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.7881549  -0.7337414   1.3830129   0.07041323  2.7819004 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.7881549  -0.7337414   1.3830129   0.07041323  2.7819004 ]
  [Layer 37] Output shape after mixer: (1, 1, 2048)
  [Layer 37] Output sample values after mixer: [ 0.7881549  -0.7337414   1.3830129   0.07041323  2.7819004 ]
  [Layer 37] Residual connection shape: (1, 1, 2048)
  [Layer 37] Residual connection sample values: [10.694945  15.255779  -1.4682502  8.024077  -3.1597753]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.38178784  0.5404979  -0.05177195  0.27605903 -0.11141679]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.38178784  0.5404979  -0.05177195  0.27605903 -0.11141679]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.38178784  0.5404979  -0.05177195  0.27605903 -0.11141679]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.78037995  0.24116366 -0.51042336 -0.31445536  0.99570656]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.78037995  0.24116366 -0.51042336 -0.31445536  0.99570656]
  [FlaxMamba2] xBC (step) sample values: [-0.07999338 -0.26914316 -0.9586879  -0.44183105  0.86105   ]
  [FlaxMamba2] dt (step) sample values: [2.213007   0.42852676 2.1894066  0.05360927 1.1827998 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.         -0.07999338  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [0.01328992 0.04701463 0.1600934  0.08117136 0.165441  ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [0.04138135 0.00984422 0.1343213  0.06956705 0.14418551]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [0.02111872 0.00494634 0.07166444 0.03599293 0.07728113]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [0.02111872 0.00494634 0.07166444 0.03599293 0.07728113]
  [FlaxMamba2] B (step) sample values: [-0.27669904 -0.2423837  -0.0359485   0.03339336 -0.27743453]
  [FlaxMamba2] C (step) sample values: [-0.06785648 -0.26959518 -0.2707413  -0.25911897 -0.27311316]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0881431 -1.3535548 -1.1764196 -1.6451025 -1.1940706]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.3970416  0.045658   0.9679806  0.04437216 0.07311659]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.64918464 0.94007033 0.3202186  0.9296039  0.9163963 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [0.02111872 0.00494634 0.07166444 0.03599293 0.07728113]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00232012 -0.00203239 -0.00030143  0.00028    -0.00232629]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00232012 -0.00203239 -0.00030143  0.00028    -0.00232629]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00232012 -0.00203239 -0.00030143  0.00028    -0.00232629]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [0.00160539 0.00037601 0.00544773 0.00273608 0.0058747 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [0.01870783 0.00438167 0.06348331 0.03188401 0.0684588 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [0.01870783 0.00438167 0.06348331 0.03188401 0.0684588 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00458763  0.00059175 -0.01215432 -0.00423129  0.04977492]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.05601643  0.00698864 -0.15058637 -0.04782339  0.50607693]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.05601643  0.00698864 -0.15058637 -0.04782339  0.50607693]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.0504503  -2.5763462  -1.6838461   0.49022588  1.9246906 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.0504503  -2.5763462  -1.6838461   0.49022588  1.9246906 ]
  [Layer 38] Output shape after mixer: (1, 1, 2048)
  [Layer 38] Output sample values after mixer: [ 3.0504503  -2.5763462  -1.6838461   0.49022588  1.9246906 ]
  [Layer 38] Residual connection shape: (1, 1, 2048)
  [Layer 38] Residual connection sample values: [13.745396  12.679433  -3.1520963  8.514303  -1.2350847]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.39511627  0.3682221  -0.09075522  0.24554129 -0.0359256 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.39511627  0.3682221  -0.09075522  0.24554129 -0.0359256 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.39511627  0.3682221  -0.09075522  0.24554129 -0.0359256 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.97121596  0.54431015  1.2666883   0.79193354 -0.99372286]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.97121596  0.54431015  1.2666883   0.79193354 -0.99372286]
  [FlaxMamba2] xBC (step) sample values: [ 0.6528985   0.7972386  -0.6485368  -0.48091593  1.1783004 ]
  [FlaxMamba2] dt (step) sample values: [ 2.6912625  0.6992919  2.1859667  0.9112562 -1.2878714]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.        0.        0.        0.6528985 0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.09691462 -0.1289479  -0.11297144 -0.08565141  0.20856147]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.08257899 -0.04374282 -0.1353103  -0.0815735   0.18758063]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.04299335 -0.02139313 -0.06308491 -0.03912412  0.10256124]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04299335 -0.02139313 -0.06308491 -0.03912412  0.10256124]
  [FlaxMamba2] B (step) sample values: [-0.03701805 -0.12886824  0.00101968 -0.01678958  0.02252362]
  [FlaxMamba2] C (step) sample values: [ 0.21769293 -0.1544778   0.15351497 -0.22789541 -0.25125718]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.69420344 -0.9242845  -1.3151171  -3.1532621  -2.1087465 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06913934 0.01512971 0.07644018 0.06678309 0.00715539]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.95313686 0.9861132  0.90436    0.81011057 0.98502433]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04299335 -0.02139313 -0.06308491 -0.03912412  0.10256124]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.1003731e-04 -3.8306491e-04  3.0310284e-06 -4.9907569e-05
  6.6952161e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.1003731e-04 -3.8306491e-04  3.0310284e-06 -4.9907569e-05
  6.6952161e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.1003731e-04 -3.8306491e-04  3.0310284e-06 -4.9907569e-05
  6.6952161e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00078024 -0.00038824 -0.00114486 -0.00071002  0.00186127]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03761939 -0.01871909 -0.0551996  -0.03423379  0.08974159]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03761939 -0.01871909 -0.0551996  -0.03423379  0.08974159]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02650222 -0.00644774 -0.0545504  -0.01865897 -0.02409395]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.3862965  -0.10095663 -0.873113   -0.24148743 -0.3555675 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.3862965  -0.10095663 -0.873113   -0.24148743 -0.3555675 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.745112   -4.1037755  -1.3299845   0.03099894  0.47623783]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.745112   -4.1037755  -1.3299845   0.03099894  0.47623783]
  [Layer 39] Output shape after mixer: (1, 1, 2048)
  [Layer 39] Output sample values after mixer: [ 2.745112   -4.1037755  -1.3299845   0.03099894  0.47623783]
  [Layer 39] Residual connection shape: (1, 1, 2048)
  [Layer 39] Residual connection sample values: [16.490507   8.575657  -4.482081   8.545302  -0.7588468]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.41582042  0.21793379 -0.11693582  0.21752372 -0.01908141]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.41582042  0.21793379 -0.11693582  0.21752372 -0.01908141]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.41582042  0.21793379 -0.11693582  0.21752372 -0.01908141]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.328648   -1.4895386  -0.61976856 -0.19373555  0.8404339 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.328648   -1.4895386  -0.61976856 -0.19373555  0.8404339 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.08408351 -1.2375964   0.13547218  0.42823815  0.5072554 ]
  [FlaxMamba2] dt (step) sample values: [1.3133079 1.7606597 2.1521735 0.8590739 0.7890093]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         0.         0.08408351 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01686392  0.2096904   0.02690591 -0.07464894  0.09715377]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0012084   0.19105943  0.03266229 -0.08452138  0.09238921]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00060457  0.10462798  0.01659783 -0.04047578  0.04832703]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00060457  0.10462798  0.01659783 -0.04047578  0.04832703]
  [FlaxMamba2] B (step) sample values: [-0.03915553  0.09087412 -0.00498073 -0.08142147  0.05205237]
  [FlaxMamba2] C (step) sample values: [-0.10231273 -0.14553653 -0.03851454  0.08102214  0.04869184]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9809841  -1.4352343  -0.79658854 -1.6062093  -1.8464803 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1976731  0.07618801 0.03847485 0.08501034 0.12576263]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6759831  0.89641875 0.96981627 0.87236756 0.7927731 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00060457  0.10462798  0.01659783 -0.04047578  0.04832703]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.6793316e-06  1.0860027e-05 -5.9522904e-07 -9.7303764e-06
  6.2205854e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.6793316e-06  1.0860027e-05 -5.9522904e-07 -9.7303764e-06
  6.2205854e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-4.6793316e-06  1.0860027e-05 -5.9522904e-07 -9.7303764e-06
  6.2205854e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 2.7462835e-05  4.7528045e-03  7.5396895e-04 -1.8386432e-03
  2.1952915e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.0005212   0.09020039  0.01430908 -0.03489441  0.04166301]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.0005212   0.09020039  0.01430908 -0.03489441  0.04166301]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-7.1697228e-05 -2.4720469e-02 -3.1024406e-03  3.0537371e-03
  2.4459962e-02]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00135711 -0.47071096 -0.05816849  0.06784327  0.45699322]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00135711 -0.47071096 -0.05816849  0.06784327  0.45699322]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.70970327 -2.049616    0.32341877  0.8814025   1.219598  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.70970327 -2.049616    0.32341877  0.8814025   1.219598  ]
  [Layer 40] Output shape after mixer: (1, 1, 2048)
  [Layer 40] Output sample values after mixer: [-0.70970327 -2.049616    0.32341877  0.8814025   1.219598  ]
  [Layer 40] Residual connection shape: (1, 1, 2048)
  [Layer 40] Residual connection sample values: [15.780804    6.526041   -4.1586623   9.426704    0.46075124]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.37766787  0.15746419 -0.10165007  0.22560088  0.01108107]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.37766787  0.15746419 -0.10165007  0.22560088  0.01108107]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.37766787  0.15746419 -0.10165007  0.22560088  0.01108107]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.9396475 -0.8824578 -0.5269345 -1.3531764 -0.6953033]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.9396475 -0.8824578 -0.5269345 -1.3531764 -0.6953033]
  [FlaxMamba2] xBC (step) sample values: [-0.4675433   0.16617247 -0.564502   -0.01048386  0.9848798 ]
  [FlaxMamba2] dt (step) sample values: [0.51613086 0.82776505 4.132032   0.47621167 2.1337316 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.         0.        -0.4675433  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.07984535  0.02421996 -0.09578342 -0.00172513  0.30200416]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.06649391  0.01022002 -0.09368534 -0.00846188  0.2864173 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.03435191  0.00513612 -0.04465004 -0.00421304  0.16357832]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03435191  0.00513612 -0.04465004 -0.00421304  0.16357832]
  [FlaxMamba2] B (step) sample values: [-0.13946678  0.1526313  -0.04498132 -0.14893527  0.14081202]
  [FlaxMamba2] C (step) sample values: [ 0.08556679 -0.03862505 -0.11361425 -0.10586488 -0.23337986]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8258594 -1.8636904 -1.2829287 -1.4542811 -4.4079003]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0617636  0.07044134 0.3718281  0.06568871 0.05268072]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.89335465 0.8769714  0.62062454 0.9088912  0.7927785 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03435191  0.00513612 -0.04465004 -0.00421304  0.16357832]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.9590630e-04  3.2383742e-04 -9.5436742e-05 -3.1599560e-04
  2.9876051e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.9590630e-04  3.2383742e-04 -9.5436742e-05 -3.1599560e-04
  2.9876051e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.9590630e-04  3.2383742e-04 -9.5436742e-05 -3.1599560e-04
  2.9876051e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 2.8431122e-04  4.2508753e-05 -3.6954292e-04 -3.4868928e-05
  1.3538440e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03376652  0.0050486  -0.04388916 -0.00414125  0.16079079]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03376652  0.0050486  -0.04388916 -0.00414125  0.16079079]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00891484 -0.00130389  0.00858538  0.00115076 -0.03721258]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.16873619 -0.02466554  0.15984084  0.02250623 -0.567211  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.16873619 -0.02466554  0.15984084  0.02250623 -0.567211  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.5776422 -1.7664473 -2.578046   4.963457   1.7960118]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.5776422 -1.7664473 -2.578046   4.963457   1.7960118]
  [Layer 41] Output shape after mixer: (1, 1, 2048)
  [Layer 41] Output sample values after mixer: [ 3.5776422 -1.7664473 -2.578046   4.963457   1.7960118]
  [Layer 41] Residual connection shape: (1, 1, 2048)
  [Layer 41] Residual connection sample values: [19.358446   4.759594  -6.7367086 14.3901615  2.256763 ]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.45814234  0.11484484 -0.16107391  0.33810765  0.05316178]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.45814234  0.11484484 -0.16107391  0.33810765  0.05316178]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.45814234  0.11484484 -0.16107391  0.33810765  0.05316178]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.72536707  1.2558191  -0.12183699 -0.70858693  0.55972075]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.72536707  1.2558191  -0.12183699 -0.70858693  0.55972075]
  [FlaxMamba2] xBC (step) sample values: [ 0.41710472 -0.82718277 -0.8988698   0.7358938   0.75610995]
  [FlaxMamba2] dt (step) sample values: [-0.10795719  1.8776262   2.8467515  -0.23819806  0.36497605]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         0.         0.41710472 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06415429  0.12823756 -0.12969533 -0.06283663  0.12635675]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.05482354  0.11502345 -0.11964741 -0.05930994  0.10641351]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02816299  0.06081568 -0.05624909 -0.02877581  0.05603505]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02816299  0.06081568 -0.05624909 -0.02877581  0.05603505]
  [FlaxMamba2] B (step) sample values: [-0.00314506 -0.02181406  0.07551832  0.02796542  0.39857072]
  [FlaxMamba2] C (step) sample values: [-0.09708216 -0.16904949 -0.15951198 -0.24790135 -0.23339513]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.06612   -1.4514434 -0.7269863 -1.9455162 -0.6256312]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01918736 0.7610744  0.05782865 0.02139458 0.01624903]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.97975177 0.3313247  0.95883083 0.95923084 0.98988557]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02816299  0.06081568 -0.05624909 -0.02877581  0.05603505]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.6995089e-06 -1.1787734e-05  4.0808085e-05  1.5111769e-05
  2.1537699e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.6995089e-06 -1.1787734e-05  4.0808085e-05  1.5111769e-05
  2.1537699e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.6995089e-06 -1.1787734e-05  4.0808085e-05  1.5111769e-05
  2.1537699e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-9.1824222e-06 -1.9828738e-05  1.8339768e-05  9.3822746e-06
 -1.8270035e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.0282518   0.06100746 -0.05642647 -0.02886656  0.05621175]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.0282518   0.06100746 -0.05642647 -0.02886656  0.05621175]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00668504  0.05962935  0.00322827  0.00674816  0.0200226 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.1464527   1.2841902   0.07072344  0.12236091  0.3981679 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.1464527   1.2841902   0.07072344  0.12236091  0.3981679 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.1236622 -2.7113163 -2.009319   4.7687936 -3.9223068]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.1236622 -2.7113163 -2.009319   4.7687936 -3.9223068]
  [Layer 42] Output shape after mixer: (1, 1, 2048)
  [Layer 42] Output sample values after mixer: [ 1.1236622 -2.7113163 -2.009319   4.7687936 -3.9223068]
  [Layer 42] Residual connection shape: (1, 1, 2048)
  [Layer 42] Residual connection sample values: [20.48211    2.0482776 -8.746028  19.158955  -1.6655438]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.45301536  0.0475015  -0.19404045  0.43096963 -0.03653356]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.45301536  0.0475015  -0.19404045  0.43096963 -0.03653356]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.45301536  0.0475015  -0.19404045  0.43096963 -0.03653356]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.46567184 -1.3375056  -0.03542309 -0.37161264  1.2399577 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.46567184 -1.3375056  -0.03542309 -0.37161264  1.2399577 ]
  [FlaxMamba2] xBC (step) sample values: [-0.13625398 -0.7891028  -1.1674261  -1.7443739   0.2650782 ]
  [FlaxMamba2] dt (step) sample values: [1.8783942  0.55626714 2.2584777  1.5374392  0.89570135]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.         -0.13625398  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01857858 -0.02754924 -0.20392905  0.31195164 -0.04248629]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02214913 -0.07323406 -0.19145499  0.31785297 -0.05130587]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01095193 -0.03527682 -0.08659162  0.1839736  -0.02499501]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01095193 -0.03527682 -0.08659162  0.1839736  -0.02499501]
  [FlaxMamba2] B (step) sample values: [-0.00961768 -0.10006989  0.88785344  0.0138737   0.0301331 ]
  [FlaxMamba2] C (step) sample values: [-0.24188928 -0.0701139  -0.27610263 -0.18420573  0.20228627]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9761645 -1.478265  -1.0588893 -1.0815219 -5.9141264]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02618575 0.02583827 0.07545822 0.03171029 0.12637019]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9747623  0.9625245  0.9232069  0.96628606 0.47361085]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01095193 -0.03527682 -0.08659162  0.1839736  -0.02499501]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.7582000e-06  2.8698483e-05 -2.5462252e-04 -3.9787615e-06
 -8.6417022e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.7582000e-06  2.8698483e-05 -2.5462252e-04 -3.9787615e-06
 -8.6417022e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.7582000e-06  2.8698483e-05 -2.5462252e-04 -3.9787615e-06
 -8.6417022e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0001019  -0.00032824 -0.00080571  0.00171182 -0.00023257]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00961219 -0.03096146 -0.07599901  0.16146839 -0.02193741]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00961219 -0.03096146 -0.07599901  0.16146839 -0.02193741]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00274995  0.00861022  0.00132222 -0.02449059 -0.02109627]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.07276785  0.17476726  0.02518981 -0.51440847 -0.51102936]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.07276785  0.17476726  0.02518981 -0.51440847 -0.51102936]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.1739299 -1.8795774  1.6223588  1.031953   2.442195 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.1739299 -1.8795774  1.6223588  1.031953   2.442195 ]
  [Layer 43] Output shape after mixer: (1, 1, 2048)
  [Layer 43] Output sample values after mixer: [-0.1739299 -1.8795774  1.6223588  1.031953   2.442195 ]
  [Layer 43] Residual connection shape: (1, 1, 2048)
  [Layer 43] Residual connection sample values: [20.30818     0.16870022 -7.123669   20.190908    0.77665114]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.42292598  0.00365203 -0.14974119  0.4182983   0.01615726]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.42292598  0.00365203 -0.14974119  0.4182983   0.01615726]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.42292598  0.00365203 -0.14974119  0.4182983   0.01615726]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.6640226 -2.179173  -0.6712847 -1.3083944 -0.5235971]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.6640226 -2.179173  -0.6712847 -1.3083944 -0.5235971]
  [FlaxMamba2] xBC (step) sample values: [-0.40551603 -0.1717163  -0.89933795 -0.4415023   0.68697816]
  [FlaxMamba2] dt (step) sample values: [-0.26602775  0.96735996  0.11554185 -0.6019843  -0.6112077 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.         -0.40551603  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.06791601  0.02169511 -0.14063133 -0.05869092 -0.07949894]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.07402334  0.08211992 -0.15909447 -0.06524076 -0.13198918]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03564244  0.04274493 -0.07323278 -0.03155667 -0.06164561]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03564244  0.04274493 -0.07323278 -0.03155667 -0.06164561]
  [FlaxMamba2] B (step) sample values: [-0.26553795  0.07501743  0.06507403 -0.07355463  0.12318332]
  [FlaxMamba2] C (step) sample values: [-0.27673173  0.09323527  0.04622552 -0.07259211 -0.12539631]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.74823433 -0.64391696 -1.1771379  -1.350584   -1.0269372 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01682317 0.03917212 0.01248913 0.00541828 0.02030741]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9874912  0.9750919  0.9854061  0.99270886 0.97936153]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03564244  0.04274493 -0.07323278 -0.03155667 -0.06164561]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.5922156e-04 -4.4981862e-05 -3.9019615e-05  4.4104738e-05
 -7.3863041e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.5922156e-04 -4.4981862e-05 -3.9019615e-05  4.4104738e-05
 -7.3863041e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.5922156e-04 -4.4981862e-05 -3.9019615e-05  4.4104738e-05
 -7.3863041e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-7.2245464e-05  8.6641878e-05 -1.4843921e-04 -6.3963802e-05
 -1.2495249e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03355355  0.0402398  -0.06894086 -0.02970723 -0.05803277]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03355355  0.0402398  -0.06894086 -0.02970723 -0.05803277]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00889002 -0.00891245  0.01565197  0.00826955  0.01130386]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.18150653 -0.14528567  0.34432638  0.15778884  0.2346563 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.18150653 -0.14528567  0.34432638  0.15778884  0.2346563 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.3493843  2.6279502 -0.9062797  4.1922135  2.682842 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.3493843  2.6279502 -0.9062797  4.1922135  2.682842 ]
  [Layer 44] Output shape after mixer: (1, 1, 2048)
  [Layer 44] Output sample values after mixer: [-2.3493843  2.6279502 -0.9062797  4.1922135  2.682842 ]
  [Layer 44] Residual connection shape: (1, 1, 2048)
  [Layer 44] Residual connection sample values: [17.958796   2.7966504 -8.029949  24.383121   3.4594932]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.36242837  0.05799051 -0.16271302  0.4840649   0.0694611 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.36242837  0.05799051 -0.16271302  0.4840649   0.0694611 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.36242837  0.05799051 -0.16271302  0.4840649   0.0694611 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.8057664   0.09476542 -1.1501381  -0.5395552  -1.0616763 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.8057664   0.09476542 -1.1501381  -0.5395552  -1.0616763 ]
  [FlaxMamba2] xBC (step) sample values: [-1.170736   -0.84485096 -0.04010078  0.6605028  -0.34053364]
  [FlaxMamba2] dt (step) sample values: [ 0.49521035  0.11306095 -0.4963532   0.18138266 -0.19242811]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.        0.        0.       -1.170736  0.      ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.17363821  0.15057158 -0.00614337  0.11320141  0.05541154]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.17821585  0.20278716 -0.00859431  0.10661724  0.0529091 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.08118866  0.11163915 -0.00427869  0.05614774  0.02715423]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08118866  0.11163915 -0.00427869  0.05614774  0.02715423]
  [FlaxMamba2] B (step) sample values: [-0.11002207  0.13002352 -0.04072694 -0.12474113 -0.05560043]
  [FlaxMamba2] C (step) sample values: [-0.06288473 -0.03665417 -0.08067673 -0.11513851  0.23459218]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.250236  -4.181475  -1.0937363 -2.677446  -2.3148744]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01179147 0.02525104 0.01186772 0.01509545 0.00457968]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9738153  0.89979655 0.9871037  0.96038866 0.9894546 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08118866  0.11163915 -0.00427869  0.05614774  0.02715423]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0532783e-04 -1.2447589e-04  3.8989274e-05  1.1941888e-04
  5.3228163e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0532783e-04 -1.2447589e-04  3.8989274e-05  1.1941888e-04
  5.3228163e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.0532783e-04 -1.2447589e-04  3.8989274e-05  1.1941888e-04
  5.3228163e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-3.3007373e-04  4.5387057e-04 -1.7395088e-05  2.2826949e-04
  1.1039594e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.09141036  0.12569459 -0.00481738  0.06321678  0.03057296]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.09141036  0.12569459 -0.00481738  0.06321678  0.03057296]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0227443   0.00623774  0.00133233 -0.01256202 -0.00834151]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.50587493  0.10060588  0.02723202 -0.23505278 -0.16739589]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.50587493  0.10060588  0.02723202 -0.23505278 -0.16739589]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.4525747   1.735138   -2.413138   -0.16916075 -0.9308723 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.4525747   1.735138   -2.413138   -0.16916075 -0.9308723 ]
  [Layer 45] Output shape after mixer: (1, 1, 2048)
  [Layer 45] Output sample values after mixer: [-1.4525747   1.735138   -2.413138   -0.16916075 -0.9308723 ]
  [Layer 45] Residual connection shape: (1, 1, 2048)
  [Layer 45] Residual connection sample values: [ 16.506222    4.5317883 -10.443087   24.21396     2.5286207]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.38256928  0.10947385 -0.24654353  0.56738085  0.05821022]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.38256928  0.10947385 -0.24654353  0.56738085  0.05821022]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.38256928  0.10947385 -0.24654353  0.56738085  0.05821022]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.5692959  -0.23848256 -0.17467463  0.6354928  -0.34738427]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.5692959  -0.23848256 -0.17467463  0.6354928  -0.34738427]
  [FlaxMamba2] xBC (step) sample values: [ 1.1877637  -1.5028533  -0.03620502 -1.1121358  -0.10258873]
  [FlaxMamba2] dt (step) sample values: [0.40294972 3.0712783  1.4172002  1.1248188  1.0187671 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.        0.        0.        1.1877637 0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.17862852 -0.23115174 -0.00611225  0.16481113  0.01669321]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.18176611 -0.23495118 -0.02721515  0.14897251  0.03700266]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.08264599 -0.10373821 -0.01342242  0.08002422  0.01884359]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08264599 -0.10373821 -0.01342242  0.08002422  0.01884359]
  [FlaxMamba2] B (step) sample values: [ 0.02894456 -0.27678666 -0.03911783  0.00379269  0.00281811]
  [FlaxMamba2] C (step) sample values: [ 0.00300918 -0.27475485 -0.14804591  0.05983309 -0.09768069]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8673339  -0.9793274  -1.6584101  -0.94076145 -0.4381494 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00451617 0.11588112 0.02587804 0.03151206 0.02423548]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99160224 0.8927171  0.9579915  0.9707898  0.9894374 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08264599 -0.10373821 -0.01342242  0.08002422  0.01884359]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.08033692e-05  1.03308834e-04  1.46004786e-05 -1.41559713e-06
 -1.05184324e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.08033692e-05  1.03308834e-04  1.46004786e-05 -1.41559713e-06
 -1.05184324e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.08033692e-05  1.03308834e-04  1.46004786e-05 -1.41559713e-06
 -1.05184324e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-6.8142013e-05 -8.5532680e-05 -1.1066862e-05  6.5980348e-05
  1.5536629e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.06605724 -0.08291582 -0.01072827  0.06396171  0.01506129]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.06605724 -0.08291582 -0.01072827  0.06396171  0.01506129]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.08580042  0.00871361  0.00085535  0.02657246 -0.00216616]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-1.744736    0.16916257  0.01500037  0.4313249  -0.04293986]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-1.744736    0.16916257  0.01500037  0.4313249  -0.04293986]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.5500813  1.7849538 -1.554303  -1.8209012  0.8098907]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.5500813  1.7849538 -1.554303  -1.8209012  0.8098907]
  [Layer 46] Output shape after mixer: (1, 1, 2048)
  [Layer 46] Output sample values after mixer: [-1.5500813  1.7849538 -1.554303  -1.8209012  0.8098907]
  [Layer 46] Residual connection shape: (1, 1, 2048)
  [Layer 46] Residual connection sample values: [ 14.9561405   6.316742  -11.99739    22.393059    3.3385115]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.2927499   0.12481966 -0.22779724  0.43039536  0.06111965]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.2927499   0.12481966 -0.22779724  0.43039536  0.06111965]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.2927499   0.12481966 -0.22779724  0.43039536  0.06111965]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.11686802 -0.40396777 -2.0413384  -0.3240234  -0.437082  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.11686802 -0.40396777 -2.0413384  -0.3240234  -0.437082  ]
  [FlaxMamba2] xBC (step) sample values: [-1.2364329   0.00295007 -0.41627976 -0.8275009  -1.4597157 ]
  [FlaxMamba2] dt (step) sample values: [-2.0961223   0.92572796  3.0168161   1.1729206   2.6657267 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.         0.        -1.2364329  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 1.7100568e-01 -1.1064572e-04 -3.9661419e-02  1.2091291e-01
 -1.9885775e-01]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.18811078 -0.02501299 -0.25914383  0.11753309 -0.19368121]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.10287581 -0.01235009 -0.11287636  0.06221608 -0.08749171]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.10287581 -0.01235009 -0.11287636  0.06221608 -0.08749171]
  [FlaxMamba2] B (step) sample values: [-0.2226427  -0.0208065  -0.2735006  -0.27635375 -0.0550799 ]
  [FlaxMamba2] C (step) sample values: [ 0.6741336  -0.1164445   0.05368286 -0.27719128 -0.21828286]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -3.552239  -11.244981   -2.6866128  -3.193549   -3.1997924]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00277647 0.03789385 0.05150491 0.01176832 0.15533593]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9901858  0.6530408  0.8707732  0.96311474 0.608327  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.10287581 -0.01235009 -0.11287636  0.06221608 -0.08749171]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.3593892e-05 -5.9430022e-06 -7.8120531e-05 -7.8935482e-05
 -1.5732585e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.3593892e-05 -5.9430022e-06 -7.8120531e-05 -7.8935482e-05
 -1.5732585e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-6.3593892e-05 -5.9430022e-06 -7.8120531e-05 -7.8935482e-05
 -1.5732585e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 2.1195551e-04 -2.5444946e-05 -2.3255967e-04  1.2818408e-04
 -1.8025958e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.14565973 -0.01748624 -0.15981932  0.08809047 -0.1238777 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.14565973 -0.01748624 -0.15981932  0.08809047 -0.1238777 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00801469  0.00282809  0.03749554 -0.01197953  0.02124836]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.15816444  0.03345065  0.72578406 -0.24222645  0.41205934]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.15816444  0.03345065  0.72578406 -0.24222645  0.41205934]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.5138719  2.6309621  2.8900244  4.499352   2.3945916]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.5138719  2.6309621  2.8900244  4.499352   2.3945916]
  [Layer 47] Output shape after mixer: (1, 1, 2048)
  [Layer 47] Output sample values after mixer: [-1.5138719  2.6309621  2.8900244  4.499352   2.3945916]
  [Layer 47] Residual connection shape: (1, 1, 2048)
  [Layer 47] Residual connection sample values: [13.442268  8.947704 -9.107366 26.89241   5.733103]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.23993373  0.1491316  -0.14838074  0.45202243  0.09092402]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.23993373  0.1491316  -0.14838074  0.45202243  0.09092402]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.23993373  0.1491316  -0.14838074  0.45202243  0.09092402]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.16615613 -1.0028305  -1.1274594   1.0820135  -0.92201173]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.16615613 -1.0028305  -1.1274594   1.0820135  -0.92201173]
  [FlaxMamba2] xBC (step) sample values: [-0.8172884  -0.9233066   1.0846369   0.9239202   0.14228687]
  [FlaxMamba2] dt (step) sample values: [ 1.4683129  -0.20739284  0.8566456   2.8699372  -0.300535  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.         0.        -0.8172884  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.13518381 -0.1022828   0.1547779   0.16804701 -0.02146809]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.13001108  0.1176879   0.06890143  0.10176283 -0.02391331]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.06922532  0.06230257  0.0356371   0.0534681  -0.0118137 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06922532  0.06230257  0.0356371   0.0534681  -0.0118137 ]
  [FlaxMamba2] B (step) sample values: [ 0.01720179 -0.035407   -0.04907176  0.04255736 -0.00296419]
  [FlaxMamba2] C (step) sample values: [-0.03665464 -0.17310758 -0.03625779 -0.24959053 -0.0462532 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-54.81184   -78.514336  -47.25076    -2.330753   -4.2266355]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1275759  0.0071722  0.00954216 0.01913849 0.00557178]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [9.1859058e-04 5.6942958e-01 6.3707095e-01 9.5637316e-01 9.7672528e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06922532  0.06230257  0.0356371   0.0534681  -0.0118137 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.5191731e-04 -3.1269633e-04 -4.3337641e-04  3.7584460e-04
 -2.6178212e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.5191731e-04 -3.1269633e-04 -4.3337641e-04  3.7584460e-04
 -2.6178212e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.5191731e-04 -3.1269633e-04 -4.3337641e-04  3.7584460e-04
 -2.6178212e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00205635  0.0018507   0.0010586   0.00158828 -0.00035093]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.05717553  0.0514578   0.02943388  0.04416111 -0.00975733]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.05717553  0.0514578   0.02943388  0.04416111 -0.00975733]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00435631 -0.0138496  -0.00811818  0.03568786  0.0025599 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.11169078 -0.29100826 -0.17652878  0.8892313   0.07100896]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.11169078 -0.29100826 -0.17652878  0.8892313   0.07100896]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ -4.5850906  -2.3204567   4.3623977   8.127495  -14.185144 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ -4.5850906  -2.3204567   4.3623977   8.127495  -14.185144 ]
  [Layer 48] Output shape after mixer: (1, 1, 2048)
  [Layer 48] Output sample values after mixer: [ -4.5850906  -2.3204567   4.3623977   8.127495  -14.185144 ]
  [Layer 48] Residual connection shape: (1, 1, 2048)
  [Layer 48] Residual connection sample values: [ 8.857178  6.627248 -4.744968 35.019905 -8.452042]
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.1408142   0.11653544 -0.07682541  0.5782275  -0.13307777]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Final backbone norm output sample values: [ 0.1408142   0.11653544 -0.07682541  0.5782275  -0.13307777]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 1, 50288)
[Mamba2LMHeadModel] Logits sample values: [12.996195  3.846253 13.209717 14.027428 13.484014]
[Mamba2LMHeadModel] Forward pass input_ids shape: (1, 1)
[Mamba2LMHeadModel] input_ids sample values: [4877]
[Mamba2LMHeadModel] Embedding output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Embedding sample values: [-0.2244873  -0.31347656 -0.05944824 -0.03198242  0.12426758]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.20243663 -0.31986988 -0.05538102 -0.02979431  0.11375906]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.20243663 -0.31986988 -0.05538102 -0.02979431  0.11375906]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.20243663 -0.31986988 -0.05538102 -0.02979431  0.11375906]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.495584    0.82274413  0.32711235 -0.23628998  0.09473319]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.495584    0.82274413  0.32711235 -0.23628998  0.09473319]
  [FlaxMamba2] xBC (step) sample values: [ 0.3529671   0.7994356  -0.43689245 -0.78081095  0.98794615]
  [FlaxMamba2] dt (step) sample values: [ 0.33071047  0.10618532  0.21092334 -0.03980783  0.29304904]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.        -0.0169386  0.3529671  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02077057  0.06484849  0.12727423 -0.15441792  0.00090107]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.20701264  0.2801805   0.3975379  -0.10522358 -0.25593486]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.11418177  0.15958816  0.2377658  -0.04984634 -0.11168057]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.11418177  0.15958816  0.2377658  -0.04984634 -0.11168057]
  [FlaxMamba2] B (step) sample values: [ 0.21488573  0.0366119  -0.19490644 -0.22308393  0.1899683 ]
  [FlaxMamba2] C (step) sample values: [-0.2760084   0.03248113 -0.24968651 -0.2782183  -0.08545532]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.617978  -2.5226073 -3.0473056 -3.307819  -3.9089987]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0126395  0.01508079 0.01117709 0.02349896 0.00975669]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9674516  0.96267164 0.9665135  0.92521393 0.96257925]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.11418177  0.15958816  0.2377658  -0.04984634 -0.11168057]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.1012317e-04  5.2838310e-05 -2.8128905e-04 -3.2195481e-04
  2.7416233e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.1012317e-04  5.2838310e-05 -2.8128905e-04 -3.2195481e-04
  2.7416233e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00060121  0.00029244 -0.00058217 -0.00069288  0.0004833 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01714548 -0.0173701  -0.02250518 -0.00228553  0.01558811]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02640089  0.04349326  0.06817337 -0.02129581 -0.02700436]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02640089  0.04349326  0.06817337 -0.02129581 -0.02700436]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00495327  0.02486326  0.01295777  0.00222012 -0.00133965]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.0331097   0.17900547  0.07389738  0.02449713 -0.00912073]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0331097   0.17900547  0.07389738  0.02449713 -0.00912073]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.20110872 -0.13397448 -0.20777334 -0.23139071  0.12609445]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.20110872 -0.13397448 -0.20777334 -0.23139071  0.12609445]
  [Layer 1] Output shape after mixer: (1, 1, 2048)
  [Layer 1] Output sample values after mixer: [ 0.20110872 -0.13397448 -0.20777334 -0.23139071  0.12609445]
  [Layer 1] Residual connection shape: (1, 1, 2048)
  [Layer 1] Residual connection sample values: [-0.02337858 -0.44745106 -0.26722157 -0.26337314  0.25036204]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01962355 -0.2966058  -0.20670864 -0.21344744  0.19821383]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.01962355 -0.2966058  -0.20670864 -0.21344744  0.19821383]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.01962355 -0.2966058  -0.20670864 -0.21344744  0.19821383]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.0410051   0.4315769   1.801861   -0.56038064 -1.5663803 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.0410051   0.4315769   1.801861   -0.56038064 -1.5663803 ]
  [FlaxMamba2] xBC (step) sample values: [-1.1875107   0.77200377 -0.02115425  4.342798   -1.2403921 ]
  [FlaxMamba2] dt (step) sample values: [ 1.264835    1.6325269   1.2251644   0.37070897 -0.17795882]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.        -0.7521976 -1.1875107  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.08891699 -0.0766303  -0.40559226 -3.2658145  -0.10719365]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.11873266 -0.23117131 -0.41610557 -2.2121036  -0.12032384]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.05584611 -0.1022848  -0.16538075 -0.21826568 -0.05654683]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05584611 -0.1022848  -0.16538075 -0.21826568 -0.05654683]
  [FlaxMamba2] B (step) sample values: [ 0.0225589   0.06243568 -0.08077255 -0.00220644 -0.09313034]
  [FlaxMamba2] C (step) sample values: [-0.19118598 -0.20446964  0.13858071 -0.10952639 -0.21525863]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-19.851534   -18.68525    -13.564036    -2.4188707   -0.46617994]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02141745 0.03175207 0.07010581 0.01058149 0.01238599]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6536591  0.5525036  0.38638625 0.97472954 0.99424255]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05584611 -0.1022848  -0.16538075 -0.21826568 -0.05654683]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.6982279e-05 -7.4678144e-05  9.6610536e-05  2.6390844e-06
  1.1139145e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.6982279e-05 -7.4678144e-05  9.6610536e-05  2.6390844e-06
  1.1139145e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.9659848e-05 -8.0257421e-05  9.0539383e-05  3.2248041e-05
  6.1369647e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00043758 -0.00232398 -0.00012464  0.01952062  0.00010323]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03899078 -0.07293598 -0.11429475 -0.13115844 -0.0389337 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03899078 -0.07293598 -0.11429475 -0.13115844 -0.0389337 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0299975  -0.01908323 -0.17677662  0.02671378  0.01053412]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.04500969 -0.0135458  -0.28095478  0.01718928  0.01697311]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.04500969 -0.0135458  -0.28095478  0.01718928  0.01697311]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.02202738  0.20232822  0.44752657 -0.00622833  0.24422513]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.02202738  0.20232822  0.44752657 -0.00622833  0.24422513]
  [Layer 2] Output shape after mixer: (1, 1, 2048)
  [Layer 2] Output sample values after mixer: [ 0.02202738  0.20232822  0.44752657 -0.00622833  0.24422513]
  [Layer 2] Residual connection shape: (1, 1, 2048)
  [Layer 2] Residual connection sample values: [-0.0013512  -0.24512284  0.180305   -0.26960146  0.49458718]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00085742 -0.12161922  0.10250121 -0.15769236  0.3111399 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00085742 -0.12161922  0.10250121 -0.15769236  0.3111399 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00085742 -0.12161922  0.10250121 -0.15769236  0.3111399 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.5669281  -0.5291733  -0.509475   -0.59154594  2.3980052 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.5669281  -0.5291733  -0.509475   -0.59154594  2.3980052 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.46637878 -0.39116743 -0.4663108  -0.60954505  0.61378324]
  [FlaxMamba2] dt (step) sample values: [0.9836709  1.6770355  1.6273106  2.2437809  0.96555346]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         1.1962808  0.46637878 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.21788149  0.05611512 -0.09921919 -0.32974404 -0.02281591]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.21943025  0.03681275  0.02443804 -0.34208077 -0.03911229]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.09772579  0.01874513  0.01236832 -0.14206755 -0.01917375]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09772579  0.01874513  0.01236832 -0.14206755 -0.01917375]
  [FlaxMamba2] B (step) sample values: [ 0.42514113 -0.04121524  0.06068782 -0.10819437  0.12690291]
  [FlaxMamba2] C (step) sample values: [ 0.43674037 -0.07244448 -0.2677305   0.37477234  0.05323087]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6505536 -3.9938898 -6.780579  -0.9418818 -6.0307717]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02226309 0.10450854 0.06749583 0.06021024 0.05597353]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.98562104 0.65876025 0.6327621  0.94486713 0.7135066 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09772579  0.01874513  0.01236832 -0.14206755 -0.01917375]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.2497020e-04  8.9671099e-05 -1.3203717e-04  2.3539612e-04
 -2.7609986e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.2497020e-04  8.9671099e-05 -1.3203717e-04  2.3539612e-04
 -2.7609986e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-5.8347033e-04  6.3964457e-05 -2.0393233e-04  2.4263762e-04
 -3.6431936e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-3.1318187e-04  2.4013738e-05  1.6409662e-03 -3.8582082e-05
 -1.7132229e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04480505  0.00855816  0.00727192 -0.06471804 -0.00890061]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04480505  0.00855816  0.00727192 -0.06471804 -0.00890061]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00919388 -0.00167885 -0.0013905   0.01363972 -0.01956524]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01633238 -0.00325199 -0.00217067  0.03261817 -0.02696246]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01633238 -0.00325199 -0.00217067  0.03261817 -0.02696246]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.11400676 -0.5201163  -0.10401907 -1.007246   -0.8933392 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.11400676 -0.5201163  -0.10401907 -1.007246   -0.8933392 ]
  [Layer 3] Output shape after mixer: (1, 1, 2048)
  [Layer 3] Output sample values after mixer: [ 0.11400676 -0.5201163  -0.10401907 -1.007246   -0.8933392 ]
  [Layer 3] Residual connection shape: (1, 1, 2048)
  [Layer 3] Residual connection sample values: [ 0.11265557 -0.7652392   0.07628594 -1.2768475  -0.39875203]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05963741 -0.306792    0.03567405 -0.6176041  -0.21175309]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05963741 -0.306792    0.03567405 -0.6176041  -0.21175309]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05963741 -0.306792    0.03567405 -0.6176041  -0.21175309]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-2.0228343 -1.7052726 -2.4147925 -0.8269521 -0.742552 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-2.0228343 -1.7052726 -2.4147925 -0.8269521 -0.742552 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.68919337 -2.370526    0.34136805  0.24393304 -2.048021  ]
  [FlaxMamba2] dt (step) sample values: [0.52515596 1.8797954  1.9146117  1.769073   0.37885356]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         0.08970526 0.68919337 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.1140784  -0.08757812 -0.04965719 -0.14020032  0.15352403]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04028689 -0.12273437 -0.09787497 -0.15602368  0.4464928 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02054915 -0.05760597 -0.04654452 -0.07193831  0.27227357]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02054915 -0.05760597 -0.04654452 -0.07193831  0.27227357]
  [FlaxMamba2] B (step) sample values: [ 0.46146914  0.3401905   1.6040102   0.37906003 -0.01101817]
  [FlaxMamba2] C (step) sample values: [ 0.7388052   0.84883857 -0.17918761 -0.26927692 -0.0982441 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.7127254  -1.2862217  -1.4869522 -27.028044   -4.0726624]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01035929 0.01567955 0.01291116 0.0188576  0.05487936]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9824139  0.98003465 0.9809848  0.60068536 0.7997108 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02054915 -0.05760597 -0.04654452 -0.07193831  0.27227357]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.8235039e-05  7.2417904e-05  3.4145295e-04  8.0692233e-05
 -2.3454875e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.8235039e-05  7.2417904e-05  3.4145295e-04  8.0692233e-05
 -2.3454875e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.3988113e-04 -4.6901440e-04  3.6991521e-04  9.4668416e-05
 -3.2445521e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00063172 -0.00221639 -0.00266861 -0.00171332  0.01381904]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01093492 -0.03464147 -0.02886746 -0.04220576  0.16707562]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01093492 -0.03464147 -0.02886746 -0.04220576  0.16707562]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00258414  0.00908415  0.00571973  0.01062037 -0.04000344]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00431937  0.00975611  0.00939963  0.01470747 -0.03305771]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00431937  0.00975611  0.00939963  0.01470747 -0.03305771]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.45195478 -0.22654755 -0.01349592  0.24108128 -0.29506385]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.45195478 -0.22654755 -0.01349592  0.24108128 -0.29506385]
  [Layer 4] Output shape after mixer: (1, 1, 2048)
  [Layer 4] Output sample values after mixer: [-0.45195478 -0.22654755 -0.01349592  0.24108128 -0.29506385]
  [Layer 4] Residual connection shape: (1, 1, 2048)
  [Layer 4] Residual connection sample values: [-0.3392992  -0.9917867   0.06279001 -1.0357662  -0.6938159 ]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.15201893 -0.3672143   0.02627609 -0.44448614 -0.320775  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.15201893 -0.3672143   0.02627609 -0.44448614 -0.320775  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.15201893 -0.3672143   0.02627609 -0.44448614 -0.320775  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.67641026 -1.3195866   0.24655649  0.5980333  -2.0331442 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.67641026 -1.3195866   0.24655649  0.5980333  -2.0331442 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.35433516 -1.7479976   1.7798991   2.0269883  -0.13125622]
  [FlaxMamba2] dt (step) sample values: [ 1.6473123  1.9371678  0.5975798  1.2805582 -0.906369 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.         -1.0174327   0.35433516  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.17748106  0.14482783 -0.322344   -0.33732748 -0.40145576]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.12590635  0.10750483 -0.39186305 -0.36345053 -0.40731895]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.06691105  0.05663896 -0.15802619 -0.14905998 -0.1627464 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06691105  0.05663896 -0.15802619 -0.14905998 -0.1627464 ]
  [FlaxMamba2] B (step) sample values: [-0.0778101   0.12386975 -0.01193028  0.02570542 -0.05142903]
  [FlaxMamba2] C (step) sample values: [-0.01231872 -0.09341576 -0.06417652  0.02612543  0.0395547 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.5762966   -1.0443833   -0.83880144  -5.6764617  -20.401838  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02004844 0.08066128 0.07583106 0.04911307 0.00137852]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.96889186 0.9192094  0.9383735  0.7567     0.9722675 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06691105  0.05663896 -0.15802619 -0.14905998 -0.1627464 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0437932e-04  1.6616662e-04 -1.6004022e-05  3.4482851e-05
 -6.8990114e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0437932e-04  1.6616662e-04 -1.6004022e-05  3.4482851e-05
 -6.8990114e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.0567009e-04  1.7786998e-04 -2.6238113e-06  3.4542845e-05
 -5.5198016e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00062152  0.00049883 -0.00248506 -0.00186064 -0.0029223 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03658812  0.03094389 -0.08742866 -0.08198464 -0.09040314]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03658812  0.03094389 -0.08742866 -0.08198464 -0.09040314]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00834183 -0.00861118 -0.01210006 -0.03163417  0.02127822]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.01384681 -0.01457801 -0.01951132 -0.05339092  0.03183208]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01384681 -0.01457801 -0.01951132 -0.05339092  0.03183208]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.22013597  0.10582971 -0.29820895  0.03151568  0.22963974]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.22013597  0.10582971 -0.29820895  0.03151568  0.22963974]
  [Layer 5] Output shape after mixer: (1, 1, 2048)
  [Layer 5] Output sample values after mixer: [-0.22013597  0.10582971 -0.29820895  0.03151568  0.22963974]
  [Layer 5] Residual connection shape: (1, 1, 2048)
  [Layer 5] Residual connection sample values: [-0.5594352  -0.885957   -0.23541895 -1.0042505  -0.46417615]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.2252572  -0.27609643 -0.08413092 -0.3709831  -0.18959324]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.2252572  -0.27609643 -0.08413092 -0.3709831  -0.18959324]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.2252572  -0.27609643 -0.08413092 -0.3709831  -0.18959324]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.3056207  -1.0691999   0.5325821  -0.41313103 -0.07746309]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.3056207  -1.0691999   0.5325821  -0.41313103 -0.07746309]
  [FlaxMamba2] xBC (step) sample values: [-2.9152837  -1.9622945   0.37294507  0.2617569   0.03107561]
  [FlaxMamba2] dt (step) sample values: [3.1570935  1.2468929  0.72666496 0.43299466 1.6726042 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.        -0.418163  -2.9152837  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.34810868 -0.2797088   0.08007538 -0.03131548 -0.2957091 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.38247147 -0.35203546  0.01791108  0.03078779 -0.22600695]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.22736746 -0.14535154  0.00903574  0.01563085 -0.10028777]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.22736746 -0.14535154  0.00903574  0.01563085 -0.10028777]
  [FlaxMamba2] B (step) sample values: [ 0.2872251  -0.07843813 -0.23917717 -0.03708016 -0.02181362]
  [FlaxMamba2] C (step) sample values: [ 0.35773084  0.011015   -0.26372066  0.14382511  0.39438364]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.98658675 -8.774721   -3.3045902  -2.9912853  -3.3435438 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.20156722 0.04698433 0.16641924 0.09996349 0.1488665 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.81966174 0.6621426  0.5769802  0.7415451  0.60790193]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.22736746 -0.14535154  0.00903574  0.01563085 -0.10028777]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01316348 -0.00359481 -0.01096145 -0.00169938 -0.00099971]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01316348 -0.00359481 -0.01096145 -0.00169938 -0.00099971]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01366551 -0.00472343 -0.01200212 -0.00220875 -0.00108378]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.06808396 -0.04569415 -0.00183095  0.00657124 -0.03668196]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.11732103 -0.07717044  0.00012576  0.00995615 -0.05839957]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.11732103 -0.07717044  0.00012576  0.00995615 -0.05839957]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-3.2660440e-02  2.1086026e-02  4.2201653e-05 -1.6377160e-03
  2.1743421e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-5.6458313e-02  1.7076215e-02  3.2488908e-05 -1.6393204e-03
  1.5363332e-03]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-5.6458313e-02  1.7076215e-02  3.2488908e-05 -1.6393204e-03
  1.5363332e-03]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.0763485   0.43129197 -0.21669044 -0.10331443 -0.14852671]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.0763485   0.43129197 -0.21669044 -0.10331443 -0.14852671]
  [Layer 6] Output shape after mixer: (1, 1, 2048)
  [Layer 6] Output sample values after mixer: [-0.0763485   0.43129197 -0.21669044 -0.10331443 -0.14852671]
  [Layer 6] Residual connection shape: (1, 1, 2048)
  [Layer 6] Residual connection sample values: [-0.6357837  -0.45466504 -0.4521094  -1.1075649  -0.61270285]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.19821426 -0.11773363 -0.13066614 -0.31615847 -0.1916245 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.19821426 -0.11773363 -0.13066614 -0.31615847 -0.1916245 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.19821426 -0.11773363 -0.13066614 -0.31615847 -0.1916245 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.5859144  -1.610726   -0.6984709  -0.65212023 -0.09706575]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.5859144  -1.610726   -0.6984709  -0.65212023 -0.09706575]
  [FlaxMamba2] xBC (step) sample values: [-3.4444342   0.82987714 -1.9052855  -0.92719895 -0.39828825]
  [FlaxMamba2] dt (step) sample values: [1.1603751  0.878957   0.54542524 0.77092505 0.8111879 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.        -1.3216721 -3.4444342  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.34074515 -0.47859845  0.52818877  0.25165802  0.1548677 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.27262992 -0.45397076  0.5274387   0.25808197  0.15127425]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.15478247 -0.17633     0.3316986   0.14560075  0.08134721]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.15478247 -0.17633     0.3316986   0.14560075  0.08134721]
  [FlaxMamba2] B (step) sample values: [ 0.11307215  0.15652332 -0.06155079  0.01684676 -0.07679957]
  [FlaxMamba2] C (step) sample values: [-0.01324065  0.06344995  0.01070338  0.00368744  0.1729944 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.29588825 -1.1836219  -0.3113019  -0.1314279  -1.5015444 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0546856  0.01438562 0.00435156 0.03217353 0.00241524]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.98394936 0.983117   0.99864626 0.9957804  0.99638   ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.15478247 -0.17633     0.3316986   0.14560075  0.08134721]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00095708  0.00132487 -0.00052099  0.0001426  -0.00065006]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00095708  0.00132487 -0.00052099  0.0001426  -0.00065006]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00120559  0.00125943 -0.00052146  0.00013181 -0.00068136]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00437544 -0.00492946  0.00855961  0.0044204   0.00220545]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00472959 -0.00533291  0.00931856  0.00475354  0.00239157]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00472959 -0.00533291  0.00931856  0.00475354  0.00239157]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00622591  0.00143011 -0.00216189 -0.00106174 -0.00011044]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.06032046  0.00771699 -0.02752721 -0.00953533 -0.00135413]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.06032046  0.00771699 -0.02752721 -0.00953533 -0.00135413]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.19352512  0.11231031 -0.10147201  0.05713896  0.17036174]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.19352512  0.11231031 -0.10147201  0.05713896  0.17036174]
  [Layer 7] Output shape after mixer: (1, 1, 2048)
  [Layer 7] Output sample values after mixer: [ 0.19352512  0.11231031 -0.10147201  0.05713896  0.17036174]
  [Layer 7] Residual connection shape: (1, 1, 2048)
  [Layer 7] Residual connection sample values: [-0.44225854 -0.3423547  -0.5535814  -1.050426   -0.4423411 ]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.17637737 -0.10686166 -0.20572135 -0.3883747  -0.17557502]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.17637737 -0.10686166 -0.20572135 -0.3883747  -0.17557502]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.17637737 -0.10686166 -0.20572135 -0.3883747  -0.17557502]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.3633547 -1.9520727  1.2215171 -2.9449048 -2.1291325]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.3633547 -1.9520727  1.2215171 -2.9449048 -2.1291325]
  [FlaxMamba2] xBC (step) sample values: [-1.7796566  -1.8804672  -0.9776625  -0.15429538  0.77254057]
  [FlaxMamba2] dt (step) sample values: [-0.2010249  -0.8826126   0.91775817  0.64682275 -1.0651897 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.         -0.79613364 -1.7796566   0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.1283174  -0.01007985  0.16328996  0.10544281  0.07533702]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.3345732  -0.04110096 -0.1514073   0.05386811  0.01921519]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.19501327 -0.02012822 -0.06998353  0.02765932  0.0096999 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.19501327 -0.02012822 -0.06998353  0.02765932  0.0096999 ]
  [FlaxMamba2] B (step) sample values: [-0.04967077 -0.02722028 -0.07976981 -0.03602301  0.16878574]
  [FlaxMamba2] C (step) sample values: [-0.10148201 -0.06292914 -0.08253761 -0.15879072 -0.24504484]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.6542776 -0.9827404 -0.5549556 -3.9396574 -1.8081155]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00823883 0.02280545 0.02764573 0.04546379 0.00333402]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.97034174 0.97783744 0.98477495 0.8360125  0.9939898 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.19501327 -0.02012822 -0.06998353  0.02765932  0.0096999 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.9805082e-05 -4.3734301e-05 -1.2816463e-04 -5.7877485e-05
  2.7118481e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.9805082e-05 -4.3734301e-05 -1.2816463e-04 -5.7877485e-05
  2.7118481e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-5.9393660e-05 -4.7478523e-05 -1.3054012e-04 -7.2451010e-05
  2.1677067e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00438244 -0.00034847 -0.0014726   0.00041033  0.00051065]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.1685446  -0.0172924  -0.06038474  0.02369395  0.00867602]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.1685446  -0.0172924  -0.06038474  0.02369395  0.00867602]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.04680642  0.0041968  -0.05696785 -0.00348728 -0.00196357]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.04244914  0.00484905 -0.04474293 -0.00429147 -0.00288273]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.04244914  0.00484905 -0.04474293 -0.00429147 -0.00288273]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.24940526  1.2371216   0.06032861 -0.31676242 -0.5707343 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.24940526  1.2371216   0.06032861 -0.31676242 -0.5707343 ]
  [Layer 8] Output shape after mixer: (1, 1, 2048)
  [Layer 8] Output sample values after mixer: [ 0.24940526  1.2371216   0.06032861 -0.31676242 -0.5707343 ]
  [Layer 8] Residual connection shape: (1, 1, 2048)
  [Layer 8] Residual connection sample values: [-0.19285327  0.89476687 -0.4932528  -1.3671885  -1.0130754 ]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.05682969  0.21543308 -0.13362426 -0.35567796 -0.29469618]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.05682969  0.21543308 -0.13362426 -0.35567796 -0.29469618]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.05682969  0.21543308 -0.13362426 -0.35567796 -0.29469618]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.10836294 -0.7368246  -0.01387978 -1.8426387  -2.524089  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.10836294 -0.7368246  -0.01387978 -1.8426387  -2.524089  ]
  [FlaxMamba2] xBC (step) sample values: [-0.53071535 -1.0925357   0.2974334  -0.46452907 -0.9535693 ]
  [FlaxMamba2] dt (step) sample values: [0.8732484  0.76372284 0.66765946 0.35150167 1.872256  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          1.0603741  -0.53071535  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.18084894 -0.1597476  -0.01671497  0.1447725  -0.15643856]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.17349802 -0.18509245 -0.1033849   0.07085893 -0.13139889]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07924244 -0.08400579 -0.04902272  0.03668419 -0.06138922]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07924244 -0.08400579 -0.04902272  0.03668419 -0.06138922]
  [FlaxMamba2] B (step) sample values: [-0.10184558 -0.25186482  0.459204    0.45589027  0.350615  ]
  [FlaxMamba2] C (step) sample values: [-0.2767695  -0.27413225 -0.24462868 -0.22673108 -0.02226911]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-5.234511  -1.2161361 -1.4887683 -0.9523448 -3.9666808]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02402567 0.07874557 0.00934462 0.17654768 0.0981039 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.88182414 0.9086772  0.98618436 0.84524035 0.6776347 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07924244 -0.08400579 -0.04902272  0.03668419 -0.06138922]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0001939   0.00047951 -0.00087426 -0.00086795 -0.00066752]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0001939   0.00047951 -0.00087426 -0.00086795 -0.00066752]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00036441  0.00071628 -0.00180257 -0.00132309 -0.00068913]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-2.1753288e-03 -1.8631283e-03 -1.7897092e-03  6.5348118e-05
 -1.4973850e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.10959258 -0.11573735 -0.06824256  0.04979267 -0.08471368]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.10959258 -0.11573735 -0.06824256  0.04979267 -0.08471368]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0062593   0.02760443  0.00047031 -0.01254584  0.01586294]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00552652  0.03631799  0.00041368 -0.00870194  0.01602557]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00552652  0.03631799  0.00041368 -0.00870194  0.01602557]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.50545925 -0.44381994 -0.95394284 -0.74592936 -0.01644657]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.50545925 -0.44381994 -0.95394284 -0.74592936 -0.01644657]
  [Layer 9] Output shape after mixer: (1, 1, 2048)
  [Layer 9] Output sample values after mixer: [ 0.50545925 -0.44381994 -0.95394284 -0.74592936 -0.01644657]
  [Layer 9] Residual connection shape: (1, 1, 2048)
  [Layer 9] Residual connection sample values: [ 0.31260598  0.45094693 -1.4471956  -2.1131177  -1.029522  ]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07082106  0.08538937 -0.29595754 -0.4278542  -0.22794738]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07082106  0.08538937 -0.29595754 -0.4278542  -0.22794738]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07082106  0.08538937 -0.29595754 -0.4278542  -0.22794738]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.4908432  0.2465753 -0.6028521 -1.8120552 -0.5970262]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.4908432  0.2465753 -0.6028521 -1.8120552 -0.5970262]
  [FlaxMamba2] xBC (step) sample values: [-0.9168027  1.0273219  1.1715724 -1.4075916  3.8065534]
  [FlaxMamba2] dt (step) sample values: [ 0.4032971   0.37695998 -0.27985027  1.2744257   0.6318509 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.        -0.8272672 -0.9168027  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.14645922 -0.29166347  0.23484412  0.19703098  0.71740764]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.18481982 -0.37876064  0.13102332  0.11121555  0.65783733]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.08389455 -0.15393811  0.06979731  0.05869682  0.43336642]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08389455 -0.15393811  0.06979731  0.05869682  0.43336642]
  [FlaxMamba2] B (step) sample values: [ 0.004514   -0.07939293 -0.01671953 -0.18965437 -0.07227873]
  [FlaxMamba2] C (step) sample values: [-0.21074699  0.07781681 -0.09847754 -0.1007916  -0.09326357]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.7154508  -1.4067873  -0.35344088 -2.010216   -0.4652703 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00065721 0.0051831  0.0723116  0.00651582 0.01420493]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99756116 0.99273497 0.97476596 0.9869872  0.9934127 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08389455 -0.15393811  0.06979731  0.05869682  0.43336642]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.4888715e-07  4.3774639e-06  9.2185991e-07  1.0456914e-05
  3.9852102e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.4888715e-07  4.3774639e-06  9.2185991e-07  1.0456914e-05
  3.9852102e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-5.38620156e-07  1.95535795e-05  2.05612469e-06  1.22363745e-05
  5.33264574e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-2.3527302e-04 -3.6584047e-04  1.6964148e-04 -4.7411548e-05
  8.3691801e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01866864 -0.03418922  0.01550555  0.01284949  0.09605647]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01866864 -0.03418922  0.01550555  0.01284949  0.09605647]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00511539 -0.00473216 -0.00330615 -0.00326884 -0.02036002]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.0629769  -0.02838935 -0.03187287 -0.03586522 -0.2067312 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0629769  -0.02838935 -0.03187287 -0.03586522 -0.2067312 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.78362936  0.27994907 -1.0415821   0.11012808 -0.43979016]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.78362936  0.27994907 -1.0415821   0.11012808 -0.43979016]
  [Layer 10] Output shape after mixer: (1, 1, 2048)
  [Layer 10] Output sample values after mixer: [-0.78362936  0.27994907 -1.0415821   0.11012808 -0.43979016]
  [Layer 10] Residual connection shape: (1, 1, 2048)
  [Layer 10] Residual connection sample values: [-0.47102338  0.730896   -2.4887776  -2.0029895  -1.4693121 ]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.1052353   0.13285656 -0.49668467 -0.38999218 -0.31380165]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.1052353   0.13285656 -0.49668467 -0.38999218 -0.31380165]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.1052353   0.13285656 -0.49668467 -0.38999218 -0.31380165]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.1317214  -4.285673   -1.9334137   0.23064351  2.7392626 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.1317214  -4.285673   -1.9334137   0.23064351  2.7392626 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.1445943   0.79782724 -1.8810369  -0.29672307 -2.104451  ]
  [FlaxMamba2] dt (step) sample values: [4.048667  5.6712103 2.1225786 1.4658827 4.073942 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.        0.        1.1211524 1.1445943 0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.38032055 -0.15322816  0.5077872   0.00695506 -0.46442646]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.39452648 -0.5108942   0.60434484  0.01910106 -0.44126362]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.15884745 -0.1915771   0.39079943  0.00964174 -0.17272821]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.15884745 -0.1915771   0.39079943  0.00964174 -0.17272821]
  [FlaxMamba2] B (step) sample values: [-0.27833322  0.41832164 -0.2740877  -0.14418563  0.37888262]
  [FlaxMamba2] C (step) sample values: [-0.14854193 -0.19044092 -0.27791074 -0.25710475  0.14458841]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.31160602 -0.09015273 -1.5786072  -0.20961139 -0.6694042 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.70189357 2.3301907  0.724644   0.17327666 0.36476278]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8035513  0.81052506 0.31856513 0.9643309  0.78335154]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.15884745 -0.1915771   0.39079943  0.00964174 -0.17272821]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.03103249 -0.04664036  0.03055914  0.01607583 -0.04224314]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.03103249 -0.04664036  0.03055914  0.01607583 -0.04224314]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0367811  -0.04565162  0.03595472  0.01319722 -0.04608105]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.09321644 -0.11289214  0.23012604 -0.0008002  -0.08440005]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.15149401 -0.18317749  0.3735016   0.00273714 -0.14777015]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.15149401 -0.18317749  0.3735016   0.00273714 -0.14777015]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 4.1806739e-02  1.0658839e-02 -9.1258287e-02  3.5189293e-04
 -3.8021266e-01]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.04301432  0.01074878 -0.06527069  0.00082024 -0.291064  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04301432  0.01074878 -0.06527069  0.00082024 -0.291064  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.18324511 -0.61986405 -0.32117787  0.33889493  0.03442692]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.18324511 -0.61986405 -0.32117787  0.33889493  0.03442692]
  [Layer 11] Output shape after mixer: (1, 1, 2048)
  [Layer 11] Output sample values after mixer: [-0.18324511 -0.61986405 -0.32117787  0.33889493  0.03442692]
  [Layer 11] Residual connection shape: (1, 1, 2048)
  [Layer 11] Residual connection sample values: [-0.6542685   0.11103195 -2.8099556  -1.6640946  -1.4348851 ]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.11826212  0.01665346 -0.44367322 -0.26097167 -0.24847887]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.11826212  0.01665346 -0.44367322 -0.26097167 -0.24847887]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.11826212  0.01665346 -0.44367322 -0.26097167 -0.24847887]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.4995869  -0.48839033 -2.2682576  -0.2708057  -0.06586231]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.4995869  -0.48839033 -2.2682576  -0.2708057  -0.06586231]
  [FlaxMamba2] xBC (step) sample values: [ 0.6048336  -0.3054818   3.0457501  -0.28202996 -2.954504  ]
  [FlaxMamba2] dt (step) sample values: [1.7674356 1.1602671 1.0997628 1.1503961 1.7072995]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         0.23113912 0.6048336  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.10121626  0.08234389  0.2804625   0.02159066 -0.53231186]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.05821699  0.09523757  0.24558091 -0.0081182  -0.51969284]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02995556  0.04988462  0.13779265 -0.00404263 -0.19380598]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02995556  0.04988462  0.13779265 -0.00404263 -0.19380598]
  [FlaxMamba2] B (step) sample values: [ 0.08748039 -0.19393174  0.12502967 -0.1038271  -0.10597159]
  [FlaxMamba2] C (step) sample values: [-0.19428955 -0.2770462  -0.11709149 -0.27803278 -0.27259994]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2411823 -0.7693517 -1.9974962 -1.2367963 -1.0181218]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.2257783  0.20107746 0.07890138 0.26802245 0.36852694]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7556084  0.85667276 0.85418695 0.7178539  0.6871482 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02995556  0.04988462  0.13779265 -0.00404263 -0.19380598]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00059166 -0.00131162  0.00084562 -0.00070222 -0.00071672]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00059166 -0.00131162  0.00084562 -0.00070222 -0.00071672]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00055915 -0.0012211   0.00090646 -0.00068601 -0.00065848]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00292841  0.00573093  0.01353734 -0.00132244 -0.01900765]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02449086  0.04163861  0.11272247 -0.00423238 -0.158512  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02449086  0.04163861  0.11272247 -0.00423238 -0.158512  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00670205 -0.00773319 -0.02397959  0.00049595  0.00504815]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.02463221 -0.01872105 -0.04387447  0.0010379   0.01519029]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02463221 -0.01872105 -0.04387447  0.0010379   0.01519029]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.6670076   0.09329101  0.06189298 -0.06817906 -0.78751165]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.6670076   0.09329101  0.06189298 -0.06817906 -0.78751165]
  [Layer 12] Output shape after mixer: (1, 1, 2048)
  [Layer 12] Output sample values after mixer: [-0.6670076   0.09329101  0.06189298 -0.06817906 -0.78751165]
  [Layer 12] Residual connection shape: (1, 1, 2048)
  [Layer 12] Residual connection sample values: [-1.3212762   0.20432296 -2.7480626  -1.7322736  -2.2223969 ]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.21820648  0.02920236 -0.41877973 -0.24844417 -0.3725625 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.21820648  0.02920236 -0.41877973 -0.24844417 -0.3725625 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.21820648  0.02920236 -0.41877973 -0.24844417 -0.3725625 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.5319467  -0.91586393 -0.7952264  -0.3862122  -0.0443722 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.5319467  -0.91586393 -0.7952264  -0.3862122  -0.0443722 ]
  [FlaxMamba2] xBC (step) sample values: [-0.9623956  -0.4451873   0.917343   -0.47415227  0.35613707]
  [FlaxMamba2] dt (step) sample values: [1.3287092 1.1433989 1.2625092 1.0215564 1.9151491]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.        -0.4691228 -0.9623956  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.07531249  0.80479026 -0.23199059 -0.07301996  0.71688175]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.33996093  0.69486594 -0.25246787 -0.07382486  0.69292545]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.1413622   0.4635093  -0.11038304 -0.03555052  0.46191615]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.1413622   0.4635093  -0.11038304 -0.03555052  0.46191615]
  [FlaxMamba2] B (step) sample values: [-0.07886554  0.21784253  0.0907347   0.53314245  0.01877728]
  [FlaxMamba2] C (step) sample values: [-0.17027763  0.02164212 -0.09450807  0.46425894 -0.1462285 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3103099 -1.7870504 -0.8605819 -1.881061  -0.5251649]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03579782 0.03029457 0.12937221 0.12462819 0.11377552]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.95417684 0.94730145 0.89463866 0.791019   0.94199914]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.1413622   0.4635093  -0.11038304 -0.03555052  0.46191615]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.9909582e-04 -1.1023832e-03 -4.5915923e-04 -2.6979456e-03
 -9.5021649e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.9909582e-04 -1.1023832e-03 -4.5915923e-04 -2.6979456e-03
 -9.5021649e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0037863   0.00099874 -0.00054656 -0.0090707   0.00019046]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01886222  0.00681606 -0.00576095 -0.00104749  0.04469329]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02494792  0.0267703  -0.01051298 -0.00257795  0.06457895]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02494792  0.0267703  -0.01051298 -0.00257795  0.06457895]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00679184 -0.00700726  0.00260042  0.00040286 -0.00140097]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.03319295 -0.01129618  0.01718877  0.00303121 -0.00402188]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03319295 -0.01129618  0.01718877  0.00303121 -0.00402188]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.02906578  0.7358214  -0.17073189 -0.40610543 -0.67706984]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.02906578  0.7358214  -0.17073189 -0.40610543 -0.67706984]
  [Layer 13] Output shape after mixer: (1, 1, 2048)
  [Layer 13] Output sample values after mixer: [-0.02906578  0.7358214  -0.17073189 -0.40610543 -0.67706984]
  [Layer 13] Residual connection shape: (1, 1, 2048)
  [Layer 13] Residual connection sample values: [-1.3503419  0.9401444 -2.9187944 -2.138379  -2.8994668]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.17955738  0.10980135 -0.3593478  -0.24755833 -0.37638044]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.17955738  0.10980135 -0.3593478  -0.24755833 -0.37638044]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.17955738  0.10980135 -0.3593478  -0.24755833 -0.37638044]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.57322305  0.09123658  0.79990906  0.47663286 -0.36575833]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.57322305  0.09123658  0.79990906  0.47663286 -0.36575833]
  [FlaxMamba2] xBC (step) sample values: [-0.18248388 -0.12691973  0.96128464 -0.36617434 -0.19288483]
  [FlaxMamba2] dt (step) sample values: [-0.92216694  1.1249026   0.90507644  0.68971     0.3750616 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.2844488  -0.18248388  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02864838  0.37884918 -0.39905655 -0.07272407  0.02525018]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.06819917  0.3375894  -0.4599086  -0.13552925  0.06181024]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03293725  0.1970188  -0.1779881  -0.0631796   0.03185994]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03293725  0.1970188  -0.1779881  -0.0631796   0.03185994]
  [FlaxMamba2] B (step) sample values: [-0.05946941 -0.05483452  0.04242875  0.00609583  0.02470401]
  [FlaxMamba2] C (step) sample values: [-0.19329062 -0.11711646 -0.12202689 -0.08136175  0.15805736]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.318424  -0.7620611 -2.6670074 -5.1836414 -2.8487349]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01590586 0.03660688 0.19009587 0.03269826 0.02014979]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9336177  0.9724888  0.60230756 0.8440901  0.944215  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03293725  0.1970188  -0.1779881  -0.0631796   0.03185994]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.11557378e-05  2.87275434e-05 -2.22282215e-05 -3.19357673e-06
 -1.29423115e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.11557378e-05  2.87275434e-05 -2.22282215e-05 -3.19357673e-06
 -1.29423115e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.0127767e-05 -1.3029236e-05  1.0769818e-05 -7.3357469e-06
 -2.0796910e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00049018  0.00660913 -0.00524643 -0.0013947   0.00122227]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01380419  0.08624875 -0.07719339 -0.02693338  0.0141008 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01380419  0.08624875 -0.07719339 -0.02693338  0.0141008 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00506034  0.00411388 -0.04260313 -0.00792002 -0.00211233]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.03094161  0.01463964 -0.21999975 -0.05749654 -0.01777677]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03094161  0.01463964 -0.21999975 -0.05749654 -0.01777677]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.07116144 -0.6301261  -0.42235154  0.41726246 -0.08868207]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.07116144 -0.6301261  -0.42235154  0.41726246 -0.08868207]
  [Layer 14] Output shape after mixer: (1, 1, 2048)
  [Layer 14] Output sample values after mixer: [-0.07116144 -0.6301261  -0.42235154  0.41726246 -0.08868207]
  [Layer 14] Residual connection shape: (1, 1, 2048)
  [Layer 14] Residual connection sample values: [-1.4215033  0.3100183 -3.341146  -1.7211167 -2.988149 ]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.17362398  0.03219268 -0.3751027  -0.18092027 -0.3497155 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.17362398  0.03219268 -0.3751027  -0.18092027 -0.3497155 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.17362398  0.03219268 -0.3751027  -0.18092027 -0.3497155 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.46267465  1.8816404  -0.8662838   1.8837183   1.0921215 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.46267465  1.8816404  -0.8662838   1.8837183   1.0921215 ]
  [FlaxMamba2] xBC (step) sample values: [-1.2982016   0.13877016 -0.12357808 -0.35995057  0.0927297 ]
  [FlaxMamba2] dt (step) sample values: [0.3515202  0.10732432 0.26699498 0.61343545 0.8065673 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.        -0.4773197 -1.2982016  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.0644694  -0.02897077  0.01046868  0.13169457 -0.12325338]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.10191447 -0.03582578 -0.01431159  0.1139486  -0.14859822]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04836284 -0.01759205 -0.00710459  0.06021687 -0.06878889]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04836284 -0.01759205 -0.00710459  0.06021687 -0.06878889]
  [FlaxMamba2] B (step) sample values: [-0.01339383  0.00830989  0.00099172 -0.01112941 -0.07718296]
  [FlaxMamba2] C (step) sample values: [ 0.07384589  0.03145519  0.06066508 -0.06652483 -0.01273621]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.27823287 -0.68077636 -2.7209377  -0.11263601 -3.8483953 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00275056 0.01762879 0.01971311 0.01054611 0.05114849]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.999235   0.9880705  0.947775   0.99881285 0.8213224 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04836284 -0.01759205 -0.00710459  0.06021687 -0.06878889]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.78171558e-06 -1.10542362e-06 -1.31923898e-07  1.48049071e-06
  1.02672675e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.78171558e-06 -1.10542362e-06 -1.31923898e-07  1.48049071e-06
  1.02672675e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.5894088e-06 -6.4634958e-07  1.8340855e-07  1.4779292e-06
  1.0204870e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-5.1212078e-06  1.8617676e-07 -2.1892799e-06  9.6535787e-06
 -6.6216321e-06]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00824759 -0.00299802 -0.00121302  0.0102724  -0.0117303 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00824759 -0.00299802 -0.00121302  0.0102724  -0.0117303 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0014743  -0.00489543  0.00031107  0.0167968  -0.00959257]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.02592724 -0.11248792  0.00551187  0.34610915 -0.14506295]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02592724 -0.11248792  0.00551187  0.34610915 -0.14506295]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.4282031  -0.18588689  0.75693816 -0.2521894  -0.53413516]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.4282031  -0.18588689  0.75693816 -0.2521894  -0.53413516]
  [Layer 15] Output shape after mixer: (1, 1, 2048)
  [Layer 15] Output sample values after mixer: [-0.4282031  -0.18588689  0.75693816 -0.2521894  -0.53413516]
  [Layer 15] Residual connection shape: (1, 1, 2048)
  [Layer 15] Residual connection sample values: [-1.8497064   0.12413141 -2.5842078  -1.9733061  -3.522284  ]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.23186801  0.01300916 -0.29677665 -0.20757951 -0.4241251 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.23186801  0.01300916 -0.29677665 -0.20757951 -0.4241251 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.23186801  0.01300916 -0.29677665 -0.20757951 -0.4241251 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.0266877   0.43578205 -1.0550362  -0.02024784 -0.50773597]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.0266877   0.43578205 -1.0550362  -0.02024784 -0.50773597]
  [FlaxMamba2] xBC (step) sample values: [ 0.84651667 -1.1856759  -0.19420229 -1.0777107   0.09819612]
  [FlaxMamba2] dt (step) sample values: [0.85499877 2.6947176  0.74061686 0.61230993 0.971144  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.         -0.84037113  0.84651667  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12277244 -0.2854042  -0.03305767 -0.24546865  0.01390324]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.08663963 -0.3265419  -0.04618786 -0.33787587 -0.0281805 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.04519525 -0.13684791 -0.02256069 -0.14066635 -0.01389173]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04519525 -0.13684791 -0.02256069 -0.14066635 -0.01389173]
  [FlaxMamba2] B (step) sample values: [-0.07334419 -0.02691552  0.18468769  0.02208259  0.34493425]
  [FlaxMamba2] C (step) sample values: [-0.27622935 -0.11423249 -0.25861594  0.55731905 -0.13271321]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6905513  -0.13480766 -1.3128716  -3.7739606  -1.2635014 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1294563  0.71256596 0.09968562 0.1315455  0.06048589]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7058809 0.9084101 0.8773279 0.6086892 0.9264233]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04519525 -0.13684791 -0.02256069 -0.14066635 -0.01389173]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00042912 -0.00015748  0.00108057  0.0001292   0.00201814]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00042912 -0.00015748  0.00108057  0.0001292   0.00201814]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.0996438e-03 -2.4283703e-03  2.1399581e-05  8.5141440e-04
  5.3122528e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-2.9971360e-03 -3.0924618e-02 -9.5174481e-05 -3.4263726e-02
 -7.8435410e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02608958 -0.11899708 -0.01461476 -0.12479365 -0.01678397]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02608958 -0.11899708 -0.01461476 -0.12479365 -0.01678397]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00706415 -0.03149022  0.00398213  0.00125061  0.00320186]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.02385345 -0.08346636  0.01264943  0.00353943  0.00930823]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02385345 -0.08346636  0.01264943  0.00353943  0.00930823]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.23033798 -0.28409266 -0.3618903  -0.76314086  0.30304375]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.23033798 -0.28409266 -0.3618903  -0.76314086  0.30304375]
  [Layer 16] Output shape after mixer: (1, 1, 2048)
  [Layer 16] Output sample values after mixer: [-0.23033798 -0.28409266 -0.3618903  -0.76314086  0.30304375]
  [Layer 16] Residual connection shape: (1, 1, 2048)
  [Layer 16] Residual connection sample values: [-2.0800443  -0.15996125 -2.946098   -2.7364469  -3.2192402 ]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.24737306 -0.01598518 -0.31210366 -0.26811567 -0.368352  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.24737306 -0.01598518 -0.31210366 -0.26811567 -0.368352  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.24737306 -0.01598518 -0.31210366 -0.26811567 -0.368352  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.09289935 -0.46238172 -0.9266977  -0.8556516   0.70725507]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.09289935 -0.46238172 -0.9266977  -0.8556516   0.70725507]
  [FlaxMamba2] xBC (step) sample values: [-0.6821835   0.00948185  0.7617663  -0.5602857  -0.12189546]
  [FlaxMamba2] dt (step) sample values: [2.3543422  0.29650316 0.46503556 1.8022809  1.5648063 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.        -0.8958114 -0.6821835  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.14298649 -0.00821569 -0.19074027  0.09949879  0.02064545]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.17478581 -0.03441504 -0.2050988   0.09409718  0.03327973]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07977477 -0.01691145 -0.09206972  0.04926053  0.01691672]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07977477 -0.01691145 -0.09206972  0.04926053  0.01691672]
  [FlaxMamba2] B (step) sample values: [-0.02331803 -0.02398666 -0.08495553  0.39976314  0.01024934]
  [FlaxMamba2] C (step) sample values: [ 0.33005616 -0.20594214 -0.06036441 -0.04433041 -0.08487576]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.1570504  -11.466768   -14.214988    -0.12863436 -14.242779  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00539343 0.01377895 0.03417303 0.12594625 0.0333357 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99377894 0.85384977 0.61522377 0.9839295  0.6220138 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07977477 -0.01691145 -0.09206972  0.04926053  0.01691672]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0032804e-05  1.0320487e-05  3.6552919e-05 -1.7200186e-04
 -4.4098761e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0032804e-05  1.0320487e-05  3.6552919e-05 -1.7200186e-04
 -4.4098761e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.10833653e-05  1.23703285e-05  4.00519493e-05 -1.72128814e-04
 -4.75439310e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.4505262e-04 -3.5219324e-05 -1.6971225e-04  7.7537465e-05
  3.8037531e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0515962  -0.01094234 -0.05955055  0.03184837  0.01094856]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0515962  -0.01094234 -0.05955055  0.03184837  0.01094856]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00228538  0.00195511  0.0156503  -0.00812761  0.0051865 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01427536  0.01491597  0.09062556 -0.05731359  0.0367164 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01427536  0.01491597  0.09062556 -0.05731359  0.0367164 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.29706874  0.16369441  0.6524365   0.2036901   0.06425759]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.29706874  0.16369441  0.6524365   0.2036901   0.06425759]
  [Layer 17] Output shape after mixer: (1, 1, 2048)
  [Layer 17] Output sample values after mixer: [-0.29706874  0.16369441  0.6524365   0.2036901   0.06425759]
  [Layer 17] Residual connection shape: (1, 1, 2048)
  [Layer 17] Residual connection sample values: [-2.377113    0.00373316 -2.2936616  -2.5327568  -3.1549826 ]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.23977277  0.0003184  -0.20688185 -0.2143948  -0.30589092]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.23977277  0.0003184  -0.20688185 -0.2143948  -0.30589092]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.23977277  0.0003184  -0.20688185 -0.2143948  -0.30589092]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.6878856   1.1553067   0.07725339  0.10645902 -1.3700621 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.6878856   1.1553067   0.07725339  0.10645902 -1.3700621 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.4484295   0.07849614  0.4522742  -1.1219442   2.3912475 ]
  [FlaxMamba2] dt (step) sample values: [0.9056345  0.66172683 0.83829683 0.8170151  0.6545496 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.        -0.1965181  0.4484295  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.0440918  -0.29608297  0.17138909 -0.07598978  0.5379031 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03408204 -0.56146383  0.45117426 -0.08982187  0.49581933]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01733139 -0.20392862  0.27563062 -0.0428953   0.30813998]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01733139 -0.20392862  0.27563062 -0.0428953   0.30813998]
  [FlaxMamba2] B (step) sample values: [ 0.16515377 -0.06387942 -0.08449885  0.12513101  0.08063578]
  [FlaxMamba2] C (step) sample values: [-0.2556995  -0.11701508 -0.22227716  0.18225317  0.00238306]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3010656 -1.4685526 -1.2082934 -1.2128745 -2.5874777]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.2217675  0.1031912  0.16232091 0.16060387 0.08085821]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7493613  0.85938203 0.8219043  0.82300556 0.8112177 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01733139 -0.20392862  0.27563062 -0.0428953   0.30813998]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00063477 -0.00024552 -0.00032477  0.00048095  0.00030993]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00063477 -0.00024552 -0.00032477  0.00048095  0.00030993]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.3405946e-04 -1.2173504e-04  1.2313642e-03 -7.7891105e-05
 -3.6294074e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00394604 -0.13297515  0.12746319 -0.00832068  0.08658008]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00059695 -0.17238198  0.1807256  -0.01660969  0.14612454]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00059695 -0.17238198  0.1807256  -0.01660969  0.14612454]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 1.3735775e-04 -1.5145245e-01  7.2503453e-03 -9.3114312e-04
 -4.0562425e-02]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00064534 -0.29222772  0.02544596 -0.0042047  -0.2882782 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00064534 -0.29222772  0.02544596 -0.0042047  -0.2882782 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.32279885 -0.4485647  -0.03836109  0.62304527 -0.41626862]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.32279885 -0.4485647  -0.03836109  0.62304527 -0.41626862]
  [Layer 18] Output shape after mixer: (1, 1, 2048)
  [Layer 18] Output sample values after mixer: [-0.32279885 -0.4485647  -0.03836109  0.62304527 -0.41626862]
  [Layer 18] Residual connection shape: (1, 1, 2048)
  [Layer 18] Residual connection sample values: [-2.699912   -0.44483155 -2.3320227  -1.9097116  -3.5712512 ]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.2552233  -0.03630089 -0.20577125 -0.15519765 -0.33686623]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.2552233  -0.03630089 -0.20577125 -0.15519765 -0.33686623]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.2552233  -0.03630089 -0.20577125 -0.15519765 -0.33686623]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.01088809 -1.170463   -1.1435851  -1.214526    0.28250578]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.01088809 -1.170463   -1.1435851  -1.214526    0.28250578]
  [FlaxMamba2] xBC (step) sample values: [-0.9309372  -0.36081186 -0.59660625  0.3199867  -0.26176468]
  [FlaxMamba2] dt (step) sample values: [0.73642856 1.4340478  1.3370638  1.2879857  0.9831278 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.         -0.26901987 -0.9309372   0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.19208041 -0.10333037 -0.0907407   0.21975687  0.0498945 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.22772494 -0.12766814 -0.09574176  0.17715433  0.01693552]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.10095354 -0.05976481 -0.04558101  0.09640262  0.00853946]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.10095354 -0.05976481 -0.04558101  0.09640262  0.00853946]
  [FlaxMamba2] B (step) sample values: [ 0.02748639 -0.25163972  0.22726989  0.1991887  -0.0154582 ]
  [FlaxMamba2] C (step) sample values: [-0.2439723  -0.01327611  0.22081468  0.07727778 -0.23174083]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9436172 -1.8178532 -2.0862153 -1.0006425 -0.9649832]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11056248 0.1156117  0.08528627 0.17449763 0.18212429]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.80662924 0.81045043 0.8370048  0.8397847  0.8388303 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.10095354 -0.05976481 -0.04558101  0.09640262  0.00853946]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00030679  0.00280872 -0.00253671 -0.00222328  0.00017254]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00030679  0.00280872 -0.00253671 -0.00222328  0.00017254]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0001753   0.00335186 -0.00326321 -0.00311567  0.0002901 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00567274 -0.00431056  0.00204118  0.01163209 -0.00201662]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01702856 -0.01103324 -0.00308603  0.022476   -0.00105606]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01702856 -0.01103324 -0.00308603  0.022476   -0.00105606]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-9.3208939e-05  3.0576638e-03  8.5286115e-04 -6.2484741e-03
 -1.7010295e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00160491  0.0553272   0.01979732 -0.10611121 -0.00410945]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00160491  0.0553272   0.01979732 -0.10611121 -0.00410945]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.5525114   0.21393277 -0.06422402  0.18458696  0.08747328]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.5525114   0.21393277 -0.06422402  0.18458696  0.08747328]
  [Layer 19] Output shape after mixer: (1, 1, 2048)
  [Layer 19] Output sample values after mixer: [-0.5525114   0.21393277 -0.06422402  0.18458696  0.08747328]
  [Layer 19] Residual connection shape: (1, 1, 2048)
  [Layer 19] Residual connection sample values: [-3.2524235  -0.23089878 -2.3962467  -1.7251246  -3.4837778 ]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.31121758 -0.0189399  -0.21046178 -0.14015089 -0.3232473 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.31121758 -0.0189399  -0.21046178 -0.14015089 -0.3232473 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.31121758 -0.0189399  -0.21046178 -0.14015089 -0.3232473 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.31156117  0.14748599 -0.5565212   1.1445376  -0.3856427 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.31156117  0.14748599 -0.5565212   1.1445376  -0.3856427 ]
  [FlaxMamba2] xBC (step) sample values: [-0.54123527  0.76478493  0.05060173  0.03656475  0.01052419]
  [FlaxMamba2] dt (step) sample values: [1.4495754 1.021421  2.1616075 1.1970053 1.3363578]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.5821599  -0.54123527  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.12273979  0.0087285  -0.0762978  -0.18209118 -0.12834568]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.16122246  0.01725817 -0.00976948 -0.20089    -0.15579624]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.0741271   0.00870354 -0.00486088 -0.09038959 -0.07184225]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0741271   0.00870354 -0.00486088 -0.09038959 -0.07184225]
  [FlaxMamba2] B (step) sample values: [ 0.19809544  0.03074653  0.3701981  -0.02192352  0.20797957]
  [FlaxMamba2] C (step) sample values: [ 0.10828678 -0.2677654  -0.01998482 -0.05069877  0.6887175 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.6215758 -5.0388985 -1.2056414 -1.6434968 -1.3345234]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1190605  0.03121417 0.07355155 0.14499506 0.11039166]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.82442784 0.8544605  0.9151413  0.7879671  0.86301756]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0741271   0.00870354 -0.00486088 -0.09038959 -0.07184225]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00174831 -0.00027136 -0.00326722  0.00019349 -0.00183555]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00174831 -0.00027136 -0.00326722  0.00019349 -0.00183555]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00173768 -0.00024373 -0.00340816  0.00022058 -0.00252163]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01040061 -0.00074507  0.00492426 -0.01051123 -0.00960875]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01099117 -0.00067573  0.00488554 -0.01123136 -0.01018111]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01099117 -0.00067573  0.00488554 -0.01123136 -0.01018111]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 1.4476187e-03 -5.3498610e-05 -9.9064014e-04 -9.7504519e-03
  1.5892232e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01678397 -0.00066442 -0.01651645 -0.12300157  0.01791206]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01678397 -0.00066442 -0.01651645 -0.12300157  0.01791206]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.26969004 -0.39257187 -0.41757497  0.9659163  -0.13339914]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.26969004 -0.39257187 -0.41757497  0.9659163  -0.13339914]
  [Layer 20] Output shape after mixer: (1, 1, 2048)
  [Layer 20] Output sample values after mixer: [-0.26969004 -0.39257187 -0.41757497  0.9659163  -0.13339914]
  [Layer 20] Residual connection shape: (1, 1, 2048)
  [Layer 20] Residual connection sample values: [-3.5221136  -0.62347066 -2.8138216  -0.7592083  -3.617177  ]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.24873856 -0.03996127 -0.17108573 -0.04450951 -0.23886155]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.24873856 -0.03996127 -0.17108573 -0.04450951 -0.23886155]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.24873856 -0.03996127 -0.17108573 -0.04450951 -0.23886155]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.18119979 -0.8425044  -1.2692194  -0.2704834  -0.5938357 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.18119979 -0.8425044  -1.2692194  -0.2704834  -0.5938357 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.12420539  0.980571   -0.39880243 -0.17113823  0.15382835]
  [FlaxMamba2] dt (step) sample values: [-0.1621989   0.8696357   0.6456242   0.33923712  0.9333857 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.         -0.53410375  0.12420539  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02997508  0.19534743  0.06352679  0.01853048 -0.01337497]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.06125559  0.1652571   0.07838122  0.01344931  0.01451809]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02969003  0.08944052  0.04072573  0.00676987  0.00731174]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02969003  0.08944052  0.04072573  0.00676987  0.00731174]
  [FlaxMamba2] B (step) sample values: [ 0.01234459 -0.0782618  -0.00221053  0.0212493  -0.06566536]
  [FlaxMamba2] C (step) sample values: [-0.07139962 -0.14875725 -0.01215873 -0.03473524 -0.00973111]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.2091806  -0.04342505 -3.8147197  -6.662431   -0.02279418]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04980184 0.01008859 0.0566361  0.03375505 0.01983518]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.85229456 0.999562   0.80569434 0.79860353 0.99954796]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02969003  0.08944052  0.04072573  0.00676987  0.00731174]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.82529329e-05  1.15719304e-04  3.26853524e-06 -3.14195931e-05
  9.70939800e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.82529329e-05  1.15719304e-04  3.26853524e-06 -3.14195931e-05
  9.70939800e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.7561802e-05  1.1660004e-04 -3.6541737e-06 -3.8499897e-05
  9.7015880e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-3.4027663e-04  8.9788518e-04  3.1344648e-04  1.0929964e-04
  2.5924945e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00555182  0.01659754  0.00746211  0.00129763  0.00130937]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00555182  0.01659754  0.00746211  0.00129763  0.00130937]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00054844 -0.00420914 -0.00207786 -0.0001519  -0.00027662]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.02421186 -0.17063305 -0.11195817 -0.00690249 -0.01129844]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02421186 -0.17063305 -0.11195817 -0.00690249 -0.01129844]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.13766727 -0.11692772  0.48226932  0.18626241 -0.4073677 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.13766727 -0.11692772  0.48226932  0.18626241 -0.4073677 ]
  [Layer 21] Output shape after mixer: (1, 1, 2048)
  [Layer 21] Output sample values after mixer: [-0.13766727 -0.11692772  0.48226932  0.18626241 -0.4073677 ]
  [Layer 21] Residual connection shape: (1, 1, 2048)
  [Layer 21] Residual connection sample values: [-3.6597807 -0.7403984 -2.3315523 -0.5729459 -4.0245447]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.38437256 -0.06549393 -0.21855868 -0.04950282 -0.39627865]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.38437256 -0.06549393 -0.21855868 -0.04950282 -0.39627865]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.38437256 -0.06549393 -0.21855868 -0.04950282 -0.39627865]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.8714392  -0.89780134  0.02707697  1.6399035  -1.5157115 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.8714392  -0.89780134  0.02707697  1.6399035  -1.5157115 ]
  [FlaxMamba2] xBC (step) sample values: [-0.95520175 -0.04072989  0.92039865 -0.03266447 -0.26139352]
  [FlaxMamba2] dt (step) sample values: [1.4293728  1.2890077  0.37126473 0.12620568 0.98279935]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.         -0.8759526  -0.95520175  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.3591979   0.02604378  0.13974972  0.0467564  -0.06209794]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.40686637 -0.05269157  0.45908564  0.00577129 -0.12777176]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.16260974 -0.02565185  0.28132638  0.00289397 -0.05981002]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.16260974 -0.02565185  0.28132638  0.00289397 -0.05981002]
  [FlaxMamba2] B (step) sample values: [ 0.02583142  0.01490157  0.05603192 -0.13904278  0.07879236]
  [FlaxMamba2] C (step) sample values: [-0.00195802 -0.0161914  -0.04027597 -0.00752023 -0.06672192]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.1489344 -3.5005836 -2.8320918 -5.5395546 -1.7185895]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00554701 0.13983773 0.0891204  0.05199817 0.00762378]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9772486  0.6129244  0.7769361  0.74972653 0.9869833 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.16260974 -0.02565185  0.28132638  0.00289397 -0.05981002]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.3299897e-05 -1.3441186e-05 -5.0540686e-05  1.2541634e-04
 -7.1070564e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.3299897e-05 -1.3441186e-05 -5.0540686e-05  1.2541634e-04
 -7.1070564e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.3722700e-05 -1.3643043e-05 -5.0487568e-05  1.3228465e-04
 -7.3245326e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-2.84585898e-04  4.89737758e-05  9.04704328e-04  2.87525967e-04
 -1.07323496e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03966819 -0.00616383  0.06904113  0.00098844 -0.01459313]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03966819 -0.00616383  0.06904113  0.00098844 -0.01459313]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02437229  0.00160208  0.00094737  0.00135758  0.00398349]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.10208721  0.01889187  0.00637122  0.02246219  0.04327953]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.10208721  0.01889187  0.00637122  0.02246219  0.04327953]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-5.9923929e-01  6.0277467e-05 -9.5257008e-01 -5.7094067e-02
 -4.7839177e-01]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-5.9923929e-01  6.0277467e-05 -9.5257008e-01 -5.7094067e-02
 -4.7839177e-01]
  [Layer 22] Output shape after mixer: (1, 1, 2048)
  [Layer 22] Output sample values after mixer: [-5.9923929e-01  6.0277467e-05 -9.5257008e-01 -5.7094067e-02
 -4.7839177e-01]
  [Layer 22] Residual connection shape: (1, 1, 2048)
  [Layer 22] Residual connection sample values: [-4.25902    -0.74033815 -3.2841225  -0.63003993 -4.5029364 ]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.29496318 -0.04411408 -0.20821998 -0.0377394  -0.302206  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.29496318 -0.04411408 -0.20821998 -0.0377394  -0.302206  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.29496318 -0.04411408 -0.20821998 -0.0377394  -0.302206  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.11090312  0.08372773 -0.02552509  0.75129575 -0.3074921 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.11090312  0.08372773 -0.02552509  0.75129575 -0.3074921 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.12287944 -0.24573228 -0.1611215  -0.7128412  -0.5767838 ]
  [FlaxMamba2] dt (step) sample values: [0.10739883 0.46492574 2.0394096  0.06687162 1.7264328 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.         -0.23471718  0.12287944  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.05921923  0.2778145  -0.04274132 -0.13174011  0.20107618]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03684985  0.24470294 -0.05409386 -0.13390113  0.15169874]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01876436  0.1372471  -0.02631557 -0.06247487  0.08159149]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01876436  0.1372471  -0.02631557 -0.06247487  0.08159149]
  [FlaxMamba2] B (step) sample values: [-0.05784853 -0.034965    0.05776798 -0.00597897  0.0122662 ]
  [FlaxMamba2] C (step) sample values: [-0.04566366 -0.0769347   0.01002322  0.05430967  0.01452322]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.08112868 -3.7998476  -0.08256738 -0.48783726 -1.4532163 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01318221 0.0677332  0.07715671 0.00155675 0.00581352]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9989311 0.7730776 0.9936496 0.9992409 0.9915873]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01876436  0.1372471  -0.02631557 -0.06247487  0.08159149]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.4309172e-05 -8.6487980e-06  1.4289249e-05 -1.4789343e-06
  3.0341173e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.4309172e-05 -8.6487980e-06  1.4289249e-05 -1.4789343e-06
  3.0341173e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.7604447e-06  4.3687041e-06 -1.3778649e-05 -2.1936492e-06
 -7.7999925e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-3.2294804e-05  8.2600850e-04 -3.8792925e-05 -4.0593653e-04
  6.3344470e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0004326  -0.00210191  0.0005226   0.00092685 -0.00110716]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0004326  -0.00210191  0.0005226   0.00092685 -0.00110716]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 2.2659411e-05 -9.1675531e-05 -6.5846066e-06  4.7313480e-04
  1.4425485e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00284147 -0.00145843 -0.00018397  0.02120811  0.01894629]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00284147 -0.00145843 -0.00018397  0.02120811  0.01894629]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.10062327 -0.00858999 -0.8314458  -0.05772099  0.16972989]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.10062327 -0.00858999 -0.8314458  -0.05772099  0.16972989]
  [Layer 23] Output shape after mixer: (1, 1, 2048)
  [Layer 23] Output sample values after mixer: [-0.10062327 -0.00858999 -0.8314458  -0.05772099  0.16972989]
  [Layer 23] Residual connection shape: (1, 1, 2048)
  [Layer 23] Residual connection sample values: [-4.359643  -0.7489281 -4.115568  -0.6877609 -4.3332067]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.22931382 -0.03758602 -0.19959454 -0.03217645 -0.22102286]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.22931382 -0.03758602 -0.19959454 -0.03217645 -0.22102286]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.22931382 -0.03758602 -0.19959454 -0.03217645 -0.22102286]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.2874075  -0.6417336   0.3172335   0.05030865 -0.1741985 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.2874075  -0.6417336   0.3172335   0.05030865 -0.1741985 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.75474715  0.32101682 -0.6941765  -0.4602284  -0.09109055]
  [FlaxMamba2] dt (step) sample values: [ 2.3091738   0.13249491 -0.1596393   2.2999883   0.21078128]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         0.47222868 0.75474715 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.14186126 -0.06481051 -0.09772643 -0.07778275 -0.043171  ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.14520675 -0.06481963 -0.10168609 -0.07940018 -0.04790504]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06734136 -0.03135979 -0.04826026 -0.03812482 -0.0233789 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06734136 -0.03135979 -0.04826026 -0.03812482 -0.0233789 ]
  [FlaxMamba2] B (step) sample values: [ 0.02820068 -0.10529684 -0.03471935 -0.00875846 -0.04420477]
  [FlaxMamba2] C (step) sample values: [-0.10221533 -0.21452741 -0.15341295 -0.2426438   0.16689828]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.07415762 -3.4496791  -3.2884939  -0.16087165 -2.6944954 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05408443 0.03312227 0.03909539 0.04481048 0.02660202]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99599725 0.89202493 0.87935644 0.99281716 0.93082964]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06734136 -0.03135979 -0.04826026 -0.03812482 -0.0233789 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.02710255e-04  3.83503619e-04  1.26452011e-04  3.18993661e-05
  1.60999029e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.02710255e-04  3.83503619e-04  1.26452011e-04  3.18993661e-05
  1.60999029e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-7.9583435e-05  3.6784654e-04  1.3486069e-04  3.8555532e-05
  2.7517023e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00145892 -0.00045764 -0.00072054 -0.00078904 -0.00071113]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00110042 -0.00029069 -0.00046362 -0.00058608 -0.00058667]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00110042 -0.00029069 -0.00046362 -0.00058608 -0.00058667]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-1.8070434e-04  6.4331893e-05 -8.5104846e-05 -1.5113142e-05
  4.6659196e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00695722  0.00350871 -0.00419173 -0.00271557  0.00495982]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00695722  0.00350871 -0.00419173 -0.00271557  0.00495982]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.38463444 -0.30588683  1.071501   -0.19499016  0.4712011 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.38463444 -0.30588683  1.071501   -0.19499016  0.4712011 ]
  [Layer 24] Output shape after mixer: (1, 1, 2048)
  [Layer 24] Output sample values after mixer: [ 0.38463444 -0.30588683  1.071501   -0.19499016  0.4712011 ]
  [Layer 24] Residual connection shape: (1, 1, 2048)
  [Layer 24] Residual connection sample values: [-3.9750085  -1.0548149  -3.0440671  -0.88275105 -3.8620055 ]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.22061616 -0.05350866 -0.1595391  -0.04325543 -0.21206227]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.22061616 -0.05350866 -0.1595391  -0.04325543 -0.21206227]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.22061616 -0.05350866 -0.1595391  -0.04325543 -0.21206227]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.8225964   0.00168246  0.6482699  -0.22786207 -0.05400614]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.8225964   0.00168246  0.6482699  -0.22786207 -0.05400614]
  [FlaxMamba2] xBC (step) sample values: [ 0.2826066  -0.0770786  -0.8423776  -0.20079072 -0.70845366]
  [FlaxMamba2] dt (step) sample values: [ 1.1300392   0.5154072   1.7292299   0.2584511  -0.38610792]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.         -0.66385597  0.2826066   0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.13488133  0.10631657 -0.01644785  0.02725522  0.02398267]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.1323274   0.07810307 -0.02786143  0.08807676  0.01821866]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.07053495  0.04057579 -0.01373666  0.0459765   0.00919231]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.07053495  0.04057579 -0.01373666  0.0459765   0.00919231]
  [FlaxMamba2] B (step) sample values: [ 0.00329894  0.0096241  -0.05100612  0.0262965   0.01771631]
  [FlaxMamba2] C (step) sample values: [-0.01518696 -0.02978415  0.02207885  0.0160837  -0.00858754]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -0.37022203  -1.5044799   -5.7209826   -0.81757224 -14.66622   ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.3751638  0.01066581 0.13942888 0.0091023  0.02229206]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8703204  0.98408157 0.45037705 0.99258584 0.7211268 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.07053495  0.04057579 -0.01373666  0.0459765   0.00919231]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.7297078e-05  2.5467452e-04 -1.3497320e-03  6.9586223e-04
  4.6881195e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.7297078e-05  2.5467452e-04 -1.3497320e-03  6.9586223e-04
  4.6881195e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.06783744e-04  5.24411444e-05 -1.43009482e-03  6.62820705e-04
  4.71957086e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.7258312e-03 -1.5728999e-03  2.3229339e-05 -3.2720753e-05
 -4.6018721e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00098896 -0.00114901 -0.00012028  0.00044759 -0.00036416]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00098896 -0.00114901 -0.00012028  0.00044759 -0.00036416]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 2.4829560e-04 -9.6739257e-07 -5.1197465e-05 -4.5209534e-05
  9.5678743e-06]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 1.04265185e-02 -2.77502822e-05 -2.37085484e-03 -1.24886143e-03
  5.78743289e-04]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 1.04265185e-02 -2.77502822e-05 -2.37085484e-03 -1.24886143e-03
  5.78743289e-04]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.13775556 -0.20619489 -1.3868755  -0.49967602 -0.8897318 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.13775556 -0.20619489 -1.3868755  -0.49967602 -0.8897318 ]
  [Layer 25] Output shape after mixer: (1, 1, 2048)
  [Layer 25] Output sample values after mixer: [-0.13775556 -0.20619489 -1.3868755  -0.49967602 -0.8897318 ]
  [Layer 25] Residual connection shape: (1, 1, 2048)
  [Layer 25] Residual connection sample values: [-4.112764  -1.2610098 -4.4309425 -1.3824271 -4.751737 ]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.2802181  -0.07950073 -0.28126082 -0.08608247 -0.31658196]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.2802181  -0.07950073 -0.28126082 -0.08608247 -0.31658196]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.2802181  -0.07950073 -0.28126082 -0.08608247 -0.31658196]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.3696799  -0.58936566  0.7226467  -0.799645   -0.6556964 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.3696799  -0.58936566  0.7226467  -0.799645   -0.6556964 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.8613749 -1.5216963 -0.8404008 -0.0938724 -1.4583507]
  [FlaxMamba2] dt (step) sample values: [0.82025784 1.7348435  1.0865185  0.17590296 2.272036  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         0.44917983 0.8613749  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12100303  0.3567516  -0.11671454  0.04113764  0.32460287]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03250206  0.3006908  -0.05256659  0.01419062  0.33271292]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.0165151   0.17278035 -0.02559264  0.00714565  0.19377844]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0165151   0.17278035 -0.02559264  0.00714565  0.19377844]
  [FlaxMamba2] B (step) sample values: [-0.00574894  0.02644092 -0.0274173   0.00922347 -0.00718241]
  [FlaxMamba2] C (step) sample values: [-0.10708746  0.03623611  0.04427848  0.052332    0.21645476]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9594627  -0.39448437 -0.84198165 -1.4275463  -0.14661841]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.12461336 0.5037062  0.17507671 0.12694253 0.10157153]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8873091  0.81979233 0.8629389  0.83425486 0.9852181 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0165151   0.17278035 -0.02559264  0.00714565  0.19377844]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.1831341e-05  5.4415472e-05 -5.6424866e-05  1.8981922e-05
 -1.4781421e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.1831341e-05  5.4415472e-05 -5.6424866e-05  1.8981922e-05
 -1.4781421e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.5131991e-05  5.1793671e-05 -8.6988810e-05  3.0684085e-05
 -1.2132045e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [0.00079727 0.00335972 0.00107511 0.00052894 0.00474379]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00290104  0.02536931 -0.00218501  0.00143919  0.02942821]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00290104  0.02536931 -0.00218501  0.00143919  0.02942821]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00316818 -0.00533451 -0.00106296 -0.00035688 -0.00659357]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.02876888 -0.1075716  -0.01823937 -0.00932317 -0.15038489]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02876888 -0.1075716  -0.01823937 -0.00932317 -0.15038489]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.8553948   1.7674707  -0.61035514  0.92869014 -0.7876332 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.8553948   1.7674707  -0.61035514  0.92869014 -0.7876332 ]
  [Layer 26] Output shape after mixer: (1, 1, 2048)
  [Layer 26] Output sample values after mixer: [-0.8553948   1.7674707  -0.61035514  0.92869014 -0.7876332 ]
  [Layer 26] Residual connection shape: (1, 1, 2048)
  [Layer 26] Residual connection sample values: [-4.9681587   0.5064609  -5.041298   -0.45373696 -5.5393705 ]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.3306636   0.03075833 -0.32848415 -0.02715107 -0.3835234 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.3306636   0.03075833 -0.32848415 -0.02715107 -0.3835234 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.3306636   0.03075833 -0.32848415 -0.02715107 -0.3835234 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.252605    0.21580772  0.48073372 -0.6115676   0.43486384]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.252605    0.21580772  0.48073372 -0.6115676   0.43486384]
  [FlaxMamba2] xBC (step) sample values: [-0.17093506 -0.02798202 -1.0623922  -0.53445953  0.88349396]
  [FlaxMamba2] dt (step) sample values: [0.699513  0.7897288 0.5270856 1.4411186 1.3539056]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.71732396 -0.17093506  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.07037486 -0.0053521  -0.23021236  0.12997015 -0.08055555]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04437388 -0.04185112 -0.24022213 -0.07193415 -0.11034071]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02267912 -0.02048774 -0.10575338 -0.034674   -0.05212967]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02267912 -0.02048774 -0.10575338 -0.034674   -0.05212967]
  [FlaxMamba2] B (step) sample values: [ 0.49513006 -0.04168513  0.27244255  0.10428686  0.1348066 ]
  [FlaxMamba2] C (step) sample values: [ 0.0109383  -0.19856003  0.21945442  0.06272644 -0.19559968]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3661706 -1.3799144 -1.8267511 -2.0408754 -2.3490334]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08332417 0.10083062 0.08112235 0.06886929 0.16437887]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.89240515 0.87010825 0.86226696 0.86887705 0.6796812 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02267912 -0.02048774 -0.10575338 -0.034674   -0.05212967]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.3565672e-04 -7.8773177e-05  5.1483989e-04  1.9707288e-04
  2.5474661e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.3565672e-04 -7.8773177e-05  5.1483989e-04  1.9707288e-04
  2.5474661e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 4.8602343e-04 -2.2910733e-04  1.5465362e-03  8.8553898e-05
  1.0577891e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00494635 -0.00278861 -0.01330819 -0.00834019 -0.00481482]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00724002 -0.00486066 -0.02400364 -0.01184697 -0.010087  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00724002 -0.00486066 -0.02400364 -0.01184697 -0.010087  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00079955 -0.00058086 -0.00713041  0.00254816 -0.00266274]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.01018867 -0.00538165 -0.11409009  0.03668709 -0.02357379]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01018867 -0.00538165 -0.11409009  0.03668709 -0.02357379]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.23247747  0.72021526  0.17906702 -0.28721148  0.32735625]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.23247747  0.72021526  0.17906702 -0.28721148  0.32735625]
  [Layer 27] Output shape after mixer: (1, 1, 2048)
  [Layer 27] Output sample values after mixer: [-0.23247747  0.72021526  0.17906702 -0.28721148  0.32735625]
  [Layer 27] Residual connection shape: (1, 1, 2048)
  [Layer 27] Residual connection sample values: [-5.2006364   1.2266762  -4.862231   -0.74094844 -5.212014  ]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.317389    0.0700459  -0.28049895 -0.04154842 -0.31483176]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.317389    0.0700459  -0.28049895 -0.04154842 -0.31483176]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.317389    0.0700459  -0.28049895 -0.04154842 -0.31483176]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.72900444  1.4702504   1.0250825  -0.16296639 -0.23646596]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.72900444  1.4702504   1.0250825  -0.16296639 -0.23646596]
  [FlaxMamba2] xBC (step) sample values: [-1.2130473  -1.6029711   0.5962848  -0.9703121  -0.14609265]
  [FlaxMamba2] dt (step) sample values: [ 0.991751   -0.08062394  0.22249292  0.37994164  0.831318  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.56419134 -1.2130473   0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.24726696  0.29029113  0.12367797 -0.16976596 -0.00233922]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.18949719  0.27893096  0.11001372 -0.18114139  0.10233607]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.10369913  0.15879096  0.05802957 -0.08239     0.05378392]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.10369913  0.15879096  0.05802957 -0.08239     0.05378392]
  [FlaxMamba2] B (step) sample values: [ 0.01561126 -0.08454143 -0.04718465  0.13989086  0.20057718]
  [FlaxMamba2] C (step) sample values: [-0.15370944 -0.12613569  0.36635667 -0.05615161  0.4669811 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2727895 -3.997792  -2.517685  -2.1714401 -2.8654757]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02721683 0.04065702 0.05192885 0.02494331 0.03467109]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.96595186 0.8499835  0.87744546 0.9472778  0.9054265 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.10369913  0.15879096  0.05802957 -0.08239     0.05378392]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.4060635e-05 -2.3860652e-04 -1.3317214e-04  3.9482265e-04
  5.6610140e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.4060635e-05 -2.3860652e-04 -1.3317214e-04  3.9482265e-04
  5.6610140e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 4.0771443e-05 -2.1080696e-04 -3.4086603e-05  4.2275555e-04
  2.4998613e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0005178   0.00231559  0.00062538 -0.00139963  0.00188884]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02299694  0.03673713  0.0132046  -0.01925953  0.01354773]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02299694  0.03673713  0.0132046  -0.01925953  0.01354773]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00545551  0.04391755  0.00996183  0.00144174 -0.00141328]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.16635665  0.8875306   0.19071555  0.03187341 -0.03030926]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.16635665  0.8875306   0.19071555  0.03187341 -0.03030926]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.88841295 -0.4180742  -0.62947786  0.04290368  0.08014026]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.88841295 -0.4180742  -0.62947786  0.04290368  0.08014026]
  [Layer 28] Output shape after mixer: (1, 1, 2048)
  [Layer 28] Output sample values after mixer: [-0.88841295 -0.4180742  -0.62947786  0.04290368  0.08014026]
  [Layer 28] Residual connection shape: (1, 1, 2048)
  [Layer 28] Residual connection sample values: [-6.0890493   0.80860204 -5.4917088  -0.6980448  -5.131874  ]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.3269414   0.0415241  -0.282388   -0.03456811 -0.27398086]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.3269414   0.0415241  -0.282388   -0.03456811 -0.27398086]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.3269414   0.0415241  -0.282388   -0.03456811 -0.27398086]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.05230602 -0.33632267 -0.47550866  0.65504724  1.5292714 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.05230602 -0.33632267 -0.47550866  0.65504724  1.5292714 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.7516267  -0.29000187  0.2918104  -0.48635632  0.3321949 ]
  [FlaxMamba2] dt (step) sample values: [0.883042   1.2481878  0.42440414 6.346906   0.53879595]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         0.60593826 0.7516267  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02316423  0.09235818 -0.05888063  0.09743326  0.03806645]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.03656907  0.0578428  -0.05603296  0.03700846 -0.0750317 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01795025  0.02975762 -0.02723176  0.0188466  -0.03610907]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01795025  0.02975762 -0.02723176  0.0188466  -0.03610907]
  [FlaxMamba2] B (step) sample values: [ 0.02001546 -0.03335814 -0.07374064 -0.02336441  0.05947497]
  [FlaxMamba2] C (step) sample values: [-0.27408403 -0.26093668 -0.11464965 -0.16555932 -0.22239685]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8072329  -2.117      -1.925669   -0.29044876 -2.049864  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05058234 0.162574   0.09570487 0.6414474  0.10532976]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.91263974 0.708809   0.83168966 0.8300182  0.80580646]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01795025  0.02975762 -0.02723176  0.0188466  -0.03610907]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.8173352e-05  3.0288045e-05  6.6953966e-05  2.1214077e-05
 -5.4001226e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.8173352e-05  3.0288045e-05  6.6953966e-05  2.1214077e-05
 -5.4001226e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.31572215e-05  4.61876843e-05  1.98004054e-05  8.20661662e-05
 -8.25676034e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00013646  0.00052476 -0.00068133  0.0002319  -0.00070456]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01849111  0.03095279 -0.0285266   0.01950309 -0.03762713]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01849111  0.03095279 -0.0285266   0.01950309 -0.03762713]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00047095 -0.00433793  0.00519951  0.00840812 -0.04729383]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00261204 -0.02264158  0.0429994   0.06237268 -0.3112527 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00261204 -0.02264158  0.0429994   0.06237268 -0.3112527 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.04459383  0.7947473   0.20065767 -0.2288425  -0.9421429 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.04459383  0.7947473   0.20065767 -0.2288425  -0.9421429 ]
  [Layer 29] Output shape after mixer: (1, 1, 2048)
  [Layer 29] Output sample values after mixer: [ 0.04459383  0.7947473   0.20065767 -0.2288425  -0.9421429 ]
  [Layer 29] Residual connection shape: (1, 1, 2048)
  [Layer 29] Residual connection sample values: [-6.0444555  1.6033493 -5.291051  -0.9268873 -6.074017 ]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.3293821   0.08596897 -0.2817136  -0.04654136 -0.34010288]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.3293821   0.08596897 -0.2817136  -0.04654136 -0.34010288]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.3293821   0.08596897 -0.2817136  -0.04654136 -0.34010288]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.26621175 -0.9326171   0.05132528 -0.90960455 -1.5755095 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.26621175 -0.9326171   0.05132528 -0.90960455 -1.5755095 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.15517214 -0.524763   -0.25230235 -0.6699854  -1.0974941 ]
  [FlaxMamba2] dt (step) sample values: [1.0580263 1.389688  0.8657272 1.541381  1.490052 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         1.0781267  0.15517214 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.02521616 -0.0723632  -0.10400436  0.11465644  0.23329617]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.00193125 -0.05866081 -0.07086227  0.09651374  0.20595242]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00096656 -0.02847038 -0.03417629  0.05058379  0.11354298]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00096656 -0.02847038 -0.03417629  0.05058379  0.11354298]
  [FlaxMamba2] B (step) sample values: [ 0.1466817  -0.02384811  0.00681597  0.33495373  0.03492246]
  [FlaxMamba2] C (step) sample values: [-0.24865016 -0.27822304 -0.15876074  0.114212   -0.03816916]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0149885  -0.4675477  -0.42799968 -0.7895216  -0.4174731 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01143434 0.36515802 0.4926046  0.23676983 0.39566562]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9884614  0.8430502  0.80990803 0.82949775 0.8477413 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00096656 -0.02847038 -0.03417629  0.05058379  0.11354298]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.6211173e-06 -2.6356796e-07  7.5329694e-08  3.7018885e-06
  3.8596093e-07]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.6211173e-06 -2.6356796e-07  7.5329694e-08  3.7018885e-06
  3.8596093e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 3.6132398e-05 -1.9491411e-06 -6.6011693e-05  2.6328233e-04
 -2.9416311e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 8.4807340e-04 -6.1141176e-04 -5.0584337e-04 -9.5174124e-05
  1.5282342e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.0020388  -0.03568475 -0.04260844  0.06222022  0.14140457]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.0020388  -0.03568475 -0.04260844  0.06222022  0.14140457]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00023547  0.00939813 -0.0011215  -0.01624756 -0.03819243]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00145387  0.0588953  -0.00426673 -0.08328137 -0.17397848]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00145387  0.0588953  -0.00426673 -0.08328137 -0.17397848]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.81620234  0.7287573  -1.2303354  -0.3286396  -0.02189172]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.81620234  0.7287573  -1.2303354  -0.3286396  -0.02189172]
  [Layer 30] Output shape after mixer: (1, 1, 2048)
  [Layer 30] Output sample values after mixer: [ 0.81620234  0.7287573  -1.2303354  -0.3286396  -0.02189172]
  [Layer 30] Residual connection shape: (1, 1, 2048)
  [Layer 30] Residual connection sample values: [-5.2282534  2.3321066 -6.521386  -1.2555269 -6.0959086]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.27263024  0.1193132  -0.3346142  -0.06269854 -0.32114792]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.27263024  0.1193132  -0.3346142  -0.06269854 -0.32114792]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.27263024  0.1193132  -0.3346142  -0.06269854 -0.32114792]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.20580916 -0.33013237 -1.0259497   0.33338356  0.8695623 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.20580916 -0.33013237 -1.0259497   0.33338356  0.8695623 ]
  [FlaxMamba2] xBC (step) sample values: [-0.30198482 -0.1925232  -0.01247124 -1.0584831  -1.438087  ]
  [FlaxMamba2] dt (step) sample values: [0.07134341 1.0101591  1.7043074  0.24483289 1.1793332 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.5427158  -0.30198482  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.05319675  0.02960616 -0.03169237  0.1804862   0.26369157]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.05369219  0.01928359 -0.03067766  0.17858839  0.25838915]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02612555  0.00973476 -0.01510357  0.09724653  0.14579356]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02612555  0.00973476 -0.01510357  0.09724653  0.14579356]
  [FlaxMamba2] B (step) sample values: [ 0.31021354  0.12388707  0.02160921 -0.22257207 -0.00510393]
  [FlaxMamba2] C (step) sample values: [ 0.45277375 -0.14296813 -0.14457479 -0.04187371 -0.13206822]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.9477868 -3.5383902 -4.705952  -2.462968  -0.9027082]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0354036  0.06117469 0.08386532 0.07574463 0.12923336]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9008989  0.8053648  0.67390496 0.8298116  0.8898877 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02612555  0.00973476 -0.01510357  0.09724653  0.14579356]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.8692847e-04 -1.1458793e-04 -1.9987196e-05  2.0586549e-04
  4.7208241e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.8692847e-04 -1.1458793e-04 -1.9987196e-05  2.0586549e-04
  4.7208241e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.8334914e-04  2.4016449e-04 -4.3318188e-04 -2.1606956e-04
 -1.4409011e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00383269  0.00245954 -0.00090949  0.00727145  0.02036037]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01414212  0.00915721 -0.01130099  0.07417865  0.12066873]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01414212  0.00915721 -0.01130099  0.07417865  0.12066873]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00160452 -0.00126428  0.00305938  0.01440723  0.07393869]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.01527144 -0.01051186  0.02265089  0.11353413  0.6904735 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01527144 -0.01051186  0.02265089  0.11353413  0.6904735 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.6330237  -0.24602443 -1.0585105  -0.0295124   1.2691383 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.6330237  -0.24602443 -1.0585105  -0.0295124   1.2691383 ]
  [Layer 31] Output shape after mixer: (1, 1, 2048)
  [Layer 31] Output sample values after mixer: [-0.6330237  -0.24602443 -1.0585105  -0.0295124   1.2691383 ]
  [Layer 31] Residual connection shape: (1, 1, 2048)
  [Layer 31] Residual connection sample values: [-5.861277   2.0860822 -7.579897  -1.2850393 -4.8267703]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.30459794  0.10887573 -0.3945466  -0.06264959 -0.26082173]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.30459794  0.10887573 -0.3945466  -0.06264959 -0.26082173]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.30459794  0.10887573 -0.3945466  -0.06264959 -0.26082173]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.5074071  0.9433927 -1.9416349 -1.4726063 -0.1372086]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.5074071  0.9433927 -1.9416349 -1.4726063 -0.1372086]
  [FlaxMamba2] xBC (step) sample values: [-0.19561742  0.977304    0.02685747  0.03063011 -0.61474544]
  [FlaxMamba2] dt (step) sample values: [1.414497   2.1416864  0.25956607 0.5506506  0.54730844]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.04304145 -0.19561742  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01278326 -0.0124912  -0.00810239 -0.03683355 -0.05176931]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.02438715 -0.06452367 -0.02394101 -0.02435186 -0.05874258]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01234225 -0.03122137 -0.01182722 -0.01202768 -0.02850887]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01234225 -0.03122137 -0.01182722 -0.01202768 -0.02850887]
  [FlaxMamba2] B (step) sample values: [ 0.0518536   0.04700699  0.06737022 -0.02591067 -0.0504706 ]
  [FlaxMamba2] C (step) sample values: [-0.2780705   0.41736203 -0.14094193 -0.23128772 -0.05858795]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6970906 -2.0892735 -1.7966746 -1.3893797 -1.0395182]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.28851905 0.04540915 0.14685966 0.16879436 0.2604127 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8178111  0.9094892  0.7680818  0.79095083 0.7628425 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01234225 -0.03122137 -0.01182722 -0.01202768 -0.02850887]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.8464934e-04  1.6739070e-04  2.3990362e-04 -9.2267233e-05
 -1.7972451e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.8464934e-04  1.6739070e-04  2.3990362e-04 -9.2267233e-05
 -1.7972451e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00035312  0.00051257  0.00065215 -0.00010259 -0.00047761]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01333705 -0.01552887 -0.0065298  -0.02333196 -0.00762609]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01629765 -0.02301812 -0.00936686 -0.02621711 -0.01446468]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01629765 -0.02301812 -0.00936686 -0.02621711 -0.01446468]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00310771 -0.01563021  0.0022819   0.0072021   0.00092437]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.01332952 -0.05392881  0.01529046  0.03950093  0.0041463 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01332952 -0.05392881  0.01529046  0.03950093  0.0041463 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.00209058 -0.75033516  0.35273314 -0.00207008 -0.40030262]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.00209058 -0.75033516  0.35273314 -0.00207008 -0.40030262]
  [Layer 32] Output shape after mixer: (1, 1, 2048)
  [Layer 32] Output sample values after mixer: [ 0.00209058 -0.75033516  0.35273314 -0.00207008 -0.40030262]
  [Layer 32] Residual connection shape: (1, 1, 2048)
  [Layer 32] Residual connection sample values: [-5.8591866  1.335747  -7.227164  -1.2871094 -5.2270727]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.2852842   0.06739649 -0.35845488 -0.06198755 -0.26360548]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.2852842   0.06739649 -0.35845488 -0.06198755 -0.26360548]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.2852842   0.06739649 -0.35845488 -0.06198755 -0.26360548]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.7896565  -1.4533248  -0.10764553 -0.6406452  -0.5485217 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.7896565  -1.4533248  -0.10764553 -0.6406452  -0.5485217 ]
  [FlaxMamba2] xBC (step) sample values: [-0.07010851  0.39136913 -0.48139885  0.42137426  0.585018  ]
  [FlaxMamba2] dt (step) sample values: [-0.57100624  0.71126086  2.3265479   0.782818    1.19765   ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.5178368  -0.07010851  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00024605  0.16092868  0.09475442  0.0597629  -0.10370083]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01339149  0.11155124  0.12157937  0.0585565  -0.10489006]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00665091  0.05888332  0.06448053  0.03013522 -0.04969707]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00665091  0.05888332  0.06448053  0.03013522 -0.04969707]
  [FlaxMamba2] B (step) sample values: [-0.27777925 -0.03637001 -0.07748976 -0.01050685  0.00817838]
  [FlaxMamba2] C (step) sample values: [-0.0075084  -0.2183952  -0.2484365  -0.17726485 -0.03589939]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9790505  -9.693779   -6.1677613  -0.11351943 -2.090294  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00665866 0.0202331  0.12535235 0.01769214 0.0094792 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9869086  0.8219011  0.46155992 0.9979936  0.9803807 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00665091  0.05888332  0.06448053  0.03013522 -0.04969707]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.2301775e-05  1.6106881e-06  3.4317234e-06  4.6530812e-07
 -3.6218924e-07]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.2301775e-05  1.6106881e-06  3.4317234e-06  4.6530812e-07
 -3.6218924e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.5313760e-04 -1.8920271e-05 -2.0807647e-05 -3.7292391e-06
  7.1465976e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 8.0762940e-05  3.5819158e-04  4.0218362e-04  1.1909648e-05
 -4.2461450e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00684464  0.06167171  0.06754392  0.03139085 -0.05217275]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00684464  0.06167171  0.06754392  0.03139085 -0.05217275]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00168764 -0.01698384 -0.00343992 -0.00694011  0.01048008]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01305729 -0.07831393 -0.01998687 -0.03938373  0.06730734]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01305729 -0.07831393 -0.01998687 -0.03938373  0.06730734]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.3936206 -1.8228205 -1.2653745 -1.0959156  1.1628418]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.3936206 -1.8228205 -1.2653745 -1.0959156  1.1628418]
  [Layer 33] Output shape after mixer: (1, 1, 2048)
  [Layer 33] Output sample values after mixer: [ 1.3936206 -1.8228205 -1.2653745 -1.0959156  1.1628418]
  [Layer 33] Residual connection shape: (1, 1, 2048)
  [Layer 33] Residual connection sample values: [-4.465566   -0.48707354 -8.492538   -2.383025   -4.064231  ]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.17092358 -0.01975374 -0.32485357 -0.09196386 -0.1631529 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.17092358 -0.01975374 -0.32485357 -0.09196386 -0.1631529 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.17092358 -0.01975374 -0.32485357 -0.09196386 -0.1631529 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.1249732   0.14213748 -0.01049734 -1.1783267  -0.26627982]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.1249732   0.14213748 -0.01049734 -1.1783267  -0.26627982]
  [FlaxMamba2] xBC (step) sample values: [ 0.5417618  -0.13738504  0.3570334  -1.1554856   0.8769683 ]
  [FlaxMamba2] dt (step) sample values: [1.0599432 0.6100855 2.0227304 4.0684705 3.8329525]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         0.04098805 0.5417618  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.12234341  0.0190576   0.06643634  0.28556755  0.18279646]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.15423428  0.0450891   0.05449634  0.24604729  0.17425917]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07118184  0.02305272  0.02799045  0.13808256  0.094702  ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07118184  0.02305272  0.02799045  0.13808256  0.094702  ]
  [FlaxMamba2] B (step) sample values: [ 0.29577005 -0.02720938 -0.02187414  0.04912986  0.00565716]
  [FlaxMamba2] C (step) sample values: [-0.01640287 -0.15268193 -0.23144913 -0.04575824 -0.20008291]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.5610816  -2.4810736  -2.893596   -0.01585086 -0.02613366]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.14389811 0.05891692 0.06884138 0.6136315  0.29807523]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6917471  0.86400455 0.8193867  0.99032056 0.9922405 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07118184  0.02305272  0.02799045  0.13808256  0.094702  ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.0295528e-03  2.7870387e-04  2.2405537e-04 -5.0323387e-04
 -5.7945952e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.0295528e-03  2.7870387e-04  2.2405537e-04 -5.0323387e-04
 -5.7945952e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.8505255e-03  3.0856513e-04  2.2300513e-04 -5.1256508e-04
 -8.9092166e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00409101  0.00133039  0.00167743  0.00849624  0.00578559]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04793498  0.01552955  0.01891796  0.09354725  0.06411663]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04793498  0.01552955  0.01891796  0.09354725  0.06411663]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-4.0708948e-02  1.1819702e-03 -9.8772936e-05 -2.5942801e-02
 -7.4066045e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.7374574   0.02082347 -0.00198949 -0.5875694  -0.1593226 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.7374574   0.02082347 -0.00198949 -0.5875694  -0.1593226 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.09758667 -1.0872178   2.268286   -0.2190842  -2.1934223 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.09758667 -1.0872178   2.268286   -0.2190842  -2.1934223 ]
  [Layer 34] Output shape after mixer: (1, 1, 2048)
  [Layer 34] Output sample values after mixer: [-0.09758667 -1.0872178   2.268286   -0.2190842  -2.1934223 ]
  [Layer 34] Residual connection shape: (1, 1, 2048)
  [Layer 34] Residual connection sample values: [-4.563153  -1.5742913 -6.2242527 -2.6021092 -6.257653 ]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.18373397 -0.06326865 -0.2461212  -0.09651199 -0.24934535]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.18373397 -0.06326865 -0.2461212  -0.09651199 -0.24934535]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.18373397 -0.06326865 -0.2461212  -0.09651199 -0.24934535]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-2.3064735   0.15586857  1.3442378   0.6154074  -0.2986437 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-2.3064735   0.15586857  1.3442378   0.6154074  -0.2986437 ]
  [FlaxMamba2] xBC (step) sample values: [-0.08924146  0.40323204 -0.01468489  0.07957469 -0.07538919]
  [FlaxMamba2] dt (step) sample values: [4.04699   1.2987617 1.7828717 1.3167349 1.7137305]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.         -0.7414792  -0.08924146  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01166688 -0.09658077  0.00038038  0.0319812   0.00980765]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.14433898 -0.05544308 -0.03581347 -0.0129712  -0.03166573]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06697007 -0.02695325 -0.01758612 -0.00644354 -0.01558221]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06697007 -0.02695325 -0.01758612 -0.00644354 -0.01558221]
  [FlaxMamba2] B (step) sample values: [ 0.05076825  0.1668625  -0.27513754  0.28871438 -0.01964634]
  [FlaxMamba2] C (step) sample values: [-0.27817678  0.42579737 -0.14430879 -0.21528517  0.04206395]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.709799  -2.7746034 -0.4452666 -1.139112  -3.5906036]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.42063102 0.06091614 0.70131534 0.2286529  0.13592821]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.74188316 0.84449357 0.7317822  0.77069604 0.6138134 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06697007 -0.02695325 -0.01758612 -0.00644354 -0.01558221]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00143013 -0.00470047  0.00775054 -0.00813299  0.00055343]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00143013 -0.00470047  0.00775054 -0.00813299  0.00055343]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00145791 -0.00512468  0.00891631 -0.00915212  0.00081595]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01381876 -0.00383828 -0.00685596  0.00518053  0.00335692]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05911253 -0.02206753 -0.01874995  0.00082258 -0.00718177]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05911253 -0.02206753 -0.01874995  0.00082258 -0.00718177]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01235094 -0.00185358 -0.01999177  0.00032863  0.00091344]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.1709884  -0.01365173 -0.10403682  0.00197682  0.00737801]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.1709884  -0.01365173 -0.10403682  0.00197682  0.00737801]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.1086204  4.203251   1.5591735 -3.9359138  1.4323766]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.1086204  4.203251   1.5591735 -3.9359138  1.4323766]
  [Layer 35] Output shape after mixer: (1, 1, 2048)
  [Layer 35] Output sample values after mixer: [ 1.1086204  4.203251   1.5591735 -3.9359138  1.4323766]
  [Layer 35] Residual connection shape: (1, 1, 2048)
  [Layer 35] Residual connection sample values: [-3.4545324  2.6289597 -4.665079  -6.538023  -4.8252764]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.1121456   0.08640627 -0.15038915 -0.20939489 -0.16038528]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.1121456   0.08640627 -0.15038915 -0.20939489 -0.16038528]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.1121456   0.08640627 -0.15038915 -0.20939489 -0.16038528]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.0751555  -0.3804636   0.2815281  -0.5751734   0.05650674]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.0751555  -0.3804636   0.2815281  -0.5751734   0.05650674]
  [FlaxMamba2] xBC (step) sample values: [ 0.05992574 -0.22647047 -1.1112374  -0.11224486  0.08062093]
  [FlaxMamba2] dt (step) sample values: [1.4087306  3.9685385  0.66308945 1.1514399  1.2213962 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         0.00556935 0.05992574 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.0109629  -0.04109531 -0.24659878 -0.00959762 -0.00708644]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04715675 -0.04122907 -0.27508694 -0.03453048 -0.03494899]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02302254 -0.02018963 -0.11874367 -0.01696718 -0.01716917]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02302254 -0.02018963 -0.11874367 -0.01696718 -0.01716917]
  [FlaxMamba2] B (step) sample values: [ 0.08584921  0.34067425  0.00771417 -0.07168727 -0.05506121]
  [FlaxMamba2] C (step) sample values: [ 0.13598819 -0.2776391  -0.25552562 -0.05622233 -0.20251776]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6566098 -1.1305923 -1.6058172 -2.4414158 -2.882315 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.16410388 0.17842898 0.04142518 0.11148313 0.13271849]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.64664364 0.8173152  0.935643   0.76171964 0.682129  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02302254 -0.02018963 -0.11874367 -0.01696718 -0.01716917]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.2434586e-04 -1.2870972e-03 -2.9144823e-05  2.7084080e-04
  2.0802607e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.2434586e-04 -1.2870972e-03 -2.9144823e-05  2.7084080e-04
  2.0802607e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00060595 -0.00217973  0.00021971  0.00017191  0.00011479]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.4224447e-03 -1.4782610e-03 -7.3942961e-03  4.2526797e-05
 -1.1441869e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02780137 -0.02461128 -0.14344923 -0.01939825 -0.01978662]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02780137 -0.02461128 -0.14344923 -0.01939825 -0.01978662]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00100547  0.0038018  -0.02301624  0.00401714 -0.00057483]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01031622  0.05690209 -0.23269382  0.0457104  -0.0056625 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01031622  0.05690209 -0.23269382  0.0457104  -0.0056625 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.0558594   2.2833602  -0.40314254 -1.9949336  -0.7421939 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.0558594   2.2833602  -0.40314254 -1.9949336  -0.7421939 ]
  [Layer 36] Output shape after mixer: (1, 1, 2048)
  [Layer 36] Output sample values after mixer: [-1.0558594   2.2833602  -0.40314254 -1.9949336  -0.7421939 ]
  [Layer 36] Residual connection shape: (1, 1, 2048)
  [Layer 36] Residual connection sample values: [-4.5103917  4.91232   -5.0682216 -8.532957  -5.56747  ]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.15557124  0.17335117 -0.17271641 -0.28474113 -0.1935114 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.15557124  0.17335117 -0.17271641 -0.28474113 -0.1935114 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.15557124  0.17335117 -0.17271641 -0.28474113 -0.1935114 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.6703054   2.1317577   1.9347155  -3.0770035  -0.48707324]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.6703054   2.1317577   1.9347155  -3.0770035  -0.48707324]
  [FlaxMamba2] xBC (step) sample values: [ 0.12987068  0.17452303 -0.94864684  1.4525448   1.5413998 ]
  [FlaxMamba2] dt (step) sample values: [3.2601378  1.4663625  3.184762   2.126194   0.52582234]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.         -0.05946744  0.12987068  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02828537 -0.04214324 -0.08817651  0.7352108   0.25397578]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04066788 -0.07058562 -0.08317544  0.58433187  0.26871577]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01992052 -0.03404775 -0.03985918  0.3751782   0.15230209]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01992052 -0.03404775 -0.03985918  0.3751782   0.15230209]
  [FlaxMamba2] B (step) sample values: [-0.05055464  0.17342396  0.03779047  0.158287    0.02644307]
  [FlaxMamba2] C (step) sample values: [-0.21061073 -0.08367944 -0.23031406  0.07777348 -0.2455    ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.06064401 -3.2470093  -0.81907064 -0.24529998 -1.975189  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.21964225 0.04160593 0.20522149 0.01043467 0.01965675]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9867683  0.873633   0.845277   0.9974437  0.96191823]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01992052 -0.03404775 -0.03985918  0.3751782   0.15230209]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0002212  -0.0007588  -0.00016535 -0.00069257 -0.0001157 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0002212  -0.0007588  -0.00016535 -0.00069257 -0.0001157 ]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00022024 -0.00075927 -0.00016534 -0.00069221 -0.00011646]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0047275  -0.00766148 -0.00867955  0.08052088  0.0426733 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00093661 -0.00118216 -0.00109431  0.00912409  0.01369006]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00093661 -0.00118216 -0.00109431  0.00912409  0.01369006]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00131664 -0.00225283 -0.00184993 -0.00123714 -0.00253775]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00716372 -0.01112495 -0.01800332 -0.02224219 -0.01019735]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00716372 -0.01112495 -0.01800332 -0.02224219 -0.01019735]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.23735182 -1.2370753  -4.371686    3.3406315   1.5101136 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.23735182 -1.2370753  -4.371686    3.3406315   1.5101136 ]
  [Layer 37] Output shape after mixer: (1, 1, 2048)
  [Layer 37] Output sample values after mixer: [ 0.23735182 -1.2370753  -4.371686    3.3406315   1.5101136 ]
  [Layer 37] Residual connection shape: (1, 1, 2048)
  [Layer 37] Residual connection sample values: [-4.27304    3.6752448 -9.439907  -5.1923256 -4.0573564]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.12034485  0.10272896 -0.26260877 -0.14093402 -0.11287159]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.12034485  0.10272896 -0.26260877 -0.14093402 -0.11287159]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.12034485  0.10272896 -0.26260877 -0.14093402 -0.11287159]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.07316285  0.03089133  1.076338   -0.482965    0.07346761]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.07316285  0.03089133  1.076338   -0.482965    0.07346761]
  [FlaxMamba2] xBC (step) sample values: [ 0.3685623   0.36048767  0.15752935 -0.6740674  -0.4716566 ]
  [FlaxMamba2] dt (step) sample values: [2.350056   2.773594   0.30786577 1.0601977  2.4461808 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.         -0.07999338  0.3685623   0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.05924373 -0.05028092  0.03811738  0.14031382 -0.07338565]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.0311523  -0.08745133  0.01234528  0.12870951 -0.09464114]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01533355 -0.04181495  0.00621074  0.06849058 -0.04508301]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01533355 -0.04181495  0.00621074  0.06849058 -0.04508301]
  [FlaxMamba2] B (step) sample values: [-0.2679129  -0.2711002  -0.06510238 -0.09324577 -0.26346096]
  [FlaxMamba2] C (step) sample values: [-0.14945449 -0.23987898 -0.22070976  0.2502861  -0.2784566 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0881431 -1.3535548 -1.1764196 -1.6451025 -1.1940706]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.44405216 0.39705467 0.22213386 0.11702479 0.23770103]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6168112  0.5842447  0.77003247 0.82487965 0.75289327]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01533355 -0.04181495  0.00621074  0.06849058 -0.04508301]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00182419 0.00184589 0.00044328 0.0006349  0.00179388]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00182419 0.00184589 0.00044328 0.0006349  0.00179388]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00039311 0.00059229 0.00025735 0.00080761 0.000359  ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00053364 -0.00574894  0.00675874  0.0130128  -0.00033017]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01295111 -0.03961167  0.01178834  0.0684781  -0.03683947]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01295111 -0.03961167  0.01178834  0.0684781  -0.03683947]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00049109 -0.00062128  0.0094629  -0.0126189  -0.00140294]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00685656 -0.00838984  0.13405839 -0.16308108 -0.01631024]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00685656 -0.00838984  0.13405839 -0.16308108 -0.01631024]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.1506954   0.6917453  -2.055118   -0.606195    0.40834013]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.1506954   0.6917453  -2.055118   -0.606195    0.40834013]
  [Layer 38] Output shape after mixer: (1, 1, 2048)
  [Layer 38] Output sample values after mixer: [-0.1506954   0.6917453  -2.055118   -0.606195    0.40834013]
  [Layer 38] Residual connection shape: (1, 1, 2048)
  [Layer 38] Residual connection sample values: [ -4.423735    4.36699   -11.495026   -5.7985206  -3.6490161]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.09909737  0.09883199 -0.25792143 -0.13031606 -0.08271579]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09909737  0.09883199 -0.25792143 -0.13031606 -0.08271579]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09909737  0.09883199 -0.25792143 -0.13031606 -0.08271579]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.098362    0.46250433  0.6946872  -0.96149564  0.30129102]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.098362    0.46250433  0.6946872  -0.96149564  0.30129102]
  [FlaxMamba2] xBC (step) sample values: [-0.13210464  0.37305754 -0.05290841  0.10138153  0.44700086]
  [FlaxMamba2] dt (step) sample values: [ 3.7428358   2.5710459   2.352536    1.2442434  -0.85811293]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.6528985  -0.13210464  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00968669 -0.0579339  -0.01471846 -0.00577835  0.10412942]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02402232  0.02727118 -0.03705733 -0.00170043  0.08314858]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.0118669   0.01382151 -0.01818539 -0.00084949  0.04330172]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0118669   0.01382151 -0.01818539 -0.00084949  0.04330172]
  [FlaxMamba2] B (step) sample values: [ 0.12492363 -0.06383945  0.00526126  0.03106757  0.09507617]
  [FlaxMamba2] C (step) sample values: [-0.1195956  -0.01491499  0.1823969  -0.03553727 -0.24865589]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.69420344 -0.9242845  -1.3151171  -3.1532621  -2.1087465 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.18638705 0.09447896 0.08969015 0.09198885 0.01097601]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.87863076 0.9163788  0.8887378  0.74821496 0.97712016]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0118669   0.01382151 -0.01818539 -0.00084949  0.04330172]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.7631063e-04  1.4120241e-04 -1.1637056e-05 -6.8716377e-05
 -2.1029294e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.7631063e-04  1.4120241e-04 -1.1637056e-05 -6.8716377e-05
 -2.1029294e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.72992799e-04 -1.95370201e-04 -8.97390055e-06 -1.12566704e-04
 -1.51466709e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00016804  0.00032221 -0.00207136 -0.00075003  0.0040717 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0100002   0.01216526 -0.01765364 -0.00147792  0.04117509]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0100002   0.01216526 -0.01765364 -0.00147792  0.04117509]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00823736  0.00345246 -0.00818003  0.00039302  0.00713027]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.14816777  0.06670869 -0.1615677   0.006277    0.12985145]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.14816777  0.06670869 -0.1615677   0.006277    0.12985145]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.8785825 -0.6116527 -2.4528775 -1.5952327 -2.0388312]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.8785825 -0.6116527 -2.4528775 -1.5952327 -2.0388312]
  [Layer 39] Output shape after mixer: (1, 1, 2048)
  [Layer 39] Output sample values after mixer: [ 2.8785825 -0.6116527 -2.4528775 -1.5952327 -2.0388312]
  [Layer 39] Residual connection shape: (1, 1, 2048)
  [Layer 39] Residual connection sample values: [ -1.5451527   3.7553375 -13.947903   -7.393753   -5.687847 ]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.0306423   0.07505581 -0.28619033 -0.14802064 -0.11248183]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.0306423   0.07505581 -0.28619033 -0.14802064 -0.11248183]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.0306423   0.07505581 -0.28619033 -0.14802064 -0.11248183]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.39302227 -1.5871624  -1.031628   -0.82154274  0.31688055]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.39302227 -1.5871624  -1.031628   -0.82154274  0.31688055]
  [FlaxMamba2] xBC (step) sample values: [-0.00908942 -0.8358764   0.36580944 -0.38494223 -0.30157125]
  [FlaxMamba2] dt (step) sample values: [0.43133467 1.7291275  2.9752645  1.3272713  1.1497842 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.08408351 -0.00908942  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00039791  0.21130832  0.07535871  0.06262895 -0.04381177]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01525761  0.19267733  0.08111509  0.05275652 -0.04857633]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00757061  0.10559119  0.04220156  0.02707391 -0.02369836]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00757061  0.10559119  0.04220156  0.02707391 -0.02369836]
  [FlaxMamba2] B (step) sample values: [-0.05918441  0.04779943 -0.07866322  0.11663356 -0.08891086]
  [FlaxMamba2] C (step) sample values: [-0.20609339 -0.0906044  -0.01671506  0.5522474   0.03526373]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9809841  -1.4352343  -0.79658854 -1.6062093  -1.8464803 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08661604 0.07390836 0.08556753 0.13252638 0.17582853]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.84232867 0.8993565  0.93410903 0.80826515 0.7227702 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00757061  0.10559119  0.04220156  0.02707391 -0.02369836]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.8809350e-05 -3.1343807e-05  5.1582309e-05 -7.6480828e-05
  5.8302052e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.8809350e-05 -3.1343807e-05  5.1582309e-05 -7.6480828e-05
  5.8302052e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 3.4867815e-05 -2.2196095e-05  5.1080930e-05 -8.4677005e-05
  6.3541826e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00013393  0.00866077  0.00194627 -0.00182299  0.00237062]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00631669  0.09489499  0.03641144  0.02028773 -0.01698336]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00631669  0.09489499  0.03641144  0.02028773 -0.01698336]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00148214 -0.02557173 -0.00987039 -0.00509078 -0.00311366]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.03306635 -0.5739107  -0.21812496 -0.13330482 -0.06856636]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03306635 -0.5739107  -0.21812496 -0.13330482 -0.06856636]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-3.3487391  1.4033217 -2.366832  -3.5382743  4.4549413]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-3.3487391  1.4033217 -2.366832  -3.5382743  4.4549413]
  [Layer 40] Output shape after mixer: (1, 1, 2048)
  [Layer 40] Output sample values after mixer: [-3.3487391  1.4033217 -2.366832  -3.5382743  4.4549413]
  [Layer 40] Residual connection shape: (1, 1, 2048)
  [Layer 40] Residual connection sample values: [ -4.893892    5.158659  -16.314735  -10.932028   -1.2329059]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.0918096   0.09757119 -0.3125985  -0.20508528 -0.0232433 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.0918096   0.09757119 -0.3125985  -0.20508528 -0.0232433 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.0918096   0.09757119 -0.3125985  -0.20508528 -0.0232433 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.09949334  0.05403374 -0.40986535 -0.56715685  0.31678194]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.09949334  0.05403374 -0.40986535 -0.56715685  0.31678194]
  [FlaxMamba2] xBC (step) sample values: [ 1.0878199  -0.5384447   0.33221215  0.01638941 -0.33133516]
  [FlaxMamba2] dt (step) sample values: [1.10412   0.837475  3.0384135 1.170861  2.4448555]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.        -0.4675433  1.0878199  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.1734176  -0.07050239  0.04170863  0.00224001 -0.1245036 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.18676904 -0.08450233  0.04380671 -0.00449674 -0.14009045]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.08468911 -0.04046707  0.02238304 -0.00224332 -0.0651469 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08468911 -0.04046707  0.02238304 -0.00224332 -0.0651469 ]
  [FlaxMamba2] B (step) sample values: [-0.01905056  0.11837684  0.12311863 -0.22838111  0.15957989]
  [FlaxMamba2] C (step) sample values: [ 0.05341643 -0.01146832 -0.10925132 -0.05824814 -0.04937316]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8258594 -1.8636904 -1.2829287 -1.4542811 -4.4079003]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10858778 0.07110479 0.14052641 0.12750684 0.07123612]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8201517  0.87588775 0.83503187 0.83074635 0.73051775]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08468911 -0.04046707  0.02238304 -0.00224332 -0.0651469 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00017519 -0.00108862 -0.00113222  0.00210024 -0.00146753]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00017519 -0.00108862 -0.00113222  0.00210024 -0.00146753]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-6.7495246e-05 -8.2302158e-04 -1.2104965e-03  1.8410746e-03
 -1.2225001e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.8704588e-03 -9.3428552e-04  3.6654947e-04 -6.7953122e-05
 -9.4605499e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.08441547 -0.04037683  0.02218291 -0.00225447 -0.0644436 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.08441547 -0.04037683  0.02218291 -0.00225447 -0.0644436 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00399065 -0.00112032 -0.0036272   0.00046273 -0.01181064]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.09379911 -0.02631791 -0.08386105  0.01123849 -0.223557  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.09379911 -0.02631791 -0.08386105  0.01123849 -0.223557  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.8309097  -1.9239506  -1.950837   -0.59627116  0.74628556]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.8309097  -1.9239506  -1.950837   -0.59627116  0.74628556]
  [Layer 41] Output shape after mixer: (1, 1, 2048)
  [Layer 41] Output sample values after mixer: [ 1.8309097  -1.9239506  -1.950837   -0.59627116  0.74628556]
  [Layer 41] Residual connection shape: (1, 1, 2048)
  [Layer 41] Residual connection sample values: [ -3.062982    3.2347083 -18.265572  -11.528299   -0.4866203]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.05818276  0.06264647 -0.35053438 -0.2174075  -0.00920076]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.05818276  0.06264647 -0.35053438 -0.2174075  -0.00920076]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.05818276  0.06264647 -0.35053438 -0.2174075  -0.00920076]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.09482021  0.6330342  -0.53976744 -0.7525321   0.915251  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.09482021  0.6330342  -0.53976744 -0.7525321   0.915251  ]
  [FlaxMamba2] xBC (step) sample values: [-0.01793338  0.37336898  0.22116451 -1.0091364   1.248794  ]
  [FlaxMamba2] dt (step) sample values: [ 1.6858479  0.9237795  3.1531754 -0.0138327  3.6420124]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.          0.41710472 -0.01793338  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00147409 -0.04973575  0.02329775  0.01740286  0.21980748]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00785666 -0.06294987  0.03334566  0.02092955  0.19986424]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.0039129  -0.03048459  0.01695079  0.01057428  0.10988544]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0039129  -0.03048459  0.01695079  0.01057428  0.10988544]
  [FlaxMamba2] B (step) sample values: [-5.1189851e-05 -6.0563635e-02 -7.7193221e-03 -8.5272394e-02
  3.9912832e-01]
  [FlaxMamba2] C (step) sample values: [ 0.03915371 -0.10139634 -0.04952696 -0.13763538 -0.26719642]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.06612   -1.4514434 -0.7269863 -1.9455162 -0.6256312]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11017524 0.3642358  0.07777517 0.02670464 0.3605163 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8891761  0.58938974 0.9450273  0.94937223 0.798077  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0039129  -0.03048459  0.01695079  0.01057428  0.10988544]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.2068164e-08  2.6109241e-05  3.3278327e-06  3.6761292e-05
 -1.7206592e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.2068164e-08  2.6109241e-05  3.3278327e-06  3.6761292e-05
 -1.7206592e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.4890944e-06  1.5627869e-05  3.9613406e-05  5.0198316e-05
  1.9442145e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 5.5003751e-05 -2.4383095e-04  4.0478946e-05  5.2017647e-05
  2.0458247e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00387151 -0.03083449  0.01705025  0.01066309  0.11231361]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00387151 -0.03083449  0.01705025  0.01066309  0.11231361]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00019224 -0.01274955 -0.00338899 -0.00256995  0.07340328]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00502463 -0.32758352 -0.0885771  -0.0555955   1.7414826 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00502463 -0.32758352 -0.0885771  -0.0555955   1.7414826 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.2858256  3.3838236 -2.084529   1.8428496  2.2103145]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.2858256  3.3838236 -2.084529   1.8428496  2.2103145]
  [Layer 42] Output shape after mixer: (1, 1, 2048)
  [Layer 42] Output sample values after mixer: [ 1.2858256  3.3838236 -2.084529   1.8428496  2.2103145]
  [Layer 42] Residual connection shape: (1, 1, 2048)
  [Layer 42] Residual connection sample values: [ -1.7771565   6.618532  -20.350101   -9.68545     1.7236942]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03225661  0.12596074 -0.37051255 -0.17879261  0.03102781]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03225661  0.12596074 -0.37051255 -0.17879261  0.03102781]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03225661  0.12596074 -0.37051255 -0.17879261  0.03102781]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.6990504  -0.78765875  0.8436947  -0.1010436   0.28291118]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.6990504  -0.78765875  0.8436947  -0.1010436   0.28291118]
  [FlaxMamba2] xBC (step) sample values: [ 0.5833921   0.22891739 -1.849056    0.63087934  0.33759275]
  [FlaxMamba2] dt (step) sample values: [3.4509737 1.5917476 2.1882744 1.9437789 1.7737204]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.         -0.13625398  0.5833921   0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.0772621  -0.10018213 -0.3647884  -0.09767696 -0.05612208]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.07369154 -0.14586695 -0.35231435 -0.09177562 -0.06494166]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.03820277 -0.06762359 -0.14544287 -0.04378359 -0.03141685]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03820277 -0.06762359 -0.14544287 -0.04378359 -0.03141685]
  [FlaxMamba2] B (step) sample values: [ 0.02547013 -0.05978079  0.84400165  0.04306766 -0.02596142]
  [FlaxMamba2] C (step) sample values: [-0.11726175 -0.03152981 -0.2720086  -0.16421473  0.0247298 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9761645 -1.478265  -1.0588893 -1.0815219 -5.9141264]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.12031984 0.07112995 0.07051855 0.04723649 0.28074107]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8891832 0.9001905 0.9280485 0.9501957 0.1900747]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03820277 -0.06762359 -0.14544287 -0.04378359 -0.03141685]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00011707 -0.00027479  0.0038795   0.00019796 -0.00011933]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00011707 -0.00027479  0.0038795   0.00019796 -0.00011933]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00011953 -0.00024927  0.00365309  0.00019442 -0.00012702]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00105812 -0.00208082 -0.00451613 -0.00056094 -0.00099944]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03423213 -0.06080291 -0.13081391 -0.03858116 -0.02828079]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03423213 -0.06080291 -0.13081391 -0.03858116 -0.02828079]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0079453   0.01497445 -0.07717333  0.0018508  -0.00456262]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.25068367  0.36240748 -1.7530266   0.04635198 -0.13178173]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.25068367  0.36240748 -1.7530266   0.04635198 -0.13178173]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.24867442 -3.9992974   0.7117323   0.10620125  5.7374415 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.24867442 -3.9992974   0.7117323   0.10620125  5.7374415 ]
  [Layer 43] Output shape after mixer: (1, 1, 2048)
  [Layer 43] Output sample values after mixer: [-0.24867442 -3.9992974   0.7117323   0.10620125  5.7374415 ]
  [Layer 43] Residual connection shape: (1, 1, 2048)
  [Layer 43] Residual connection sample values: [ -2.025831    2.6192348 -19.638369   -9.579248    7.461136 ]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03543116  0.04761914 -0.34668237 -0.16666733  0.13035733]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03543116  0.04761914 -0.34668237 -0.16666733  0.13035733]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03543116  0.04761914 -0.34668237 -0.16666733  0.13035733]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.1593506  -2.2980509  -0.523969    0.01534312 -0.25391635]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.1593506  -2.2980509  -0.523969    0.01534312 -0.25391635]
  [FlaxMamba2] xBC (step) sample values: [ 0.41412812 -0.24874759 -0.33757815 -0.34199885 -1.4363581 ]
  [FlaxMamba2] dt (step) sample values: [1.044328  2.4738734 2.2509062 1.62691   2.6139405]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.         -0.40551603  0.41412812  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06247767  0.03197475 -0.06870625 -0.07723417  0.1654913 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.05637034  0.09239955 -0.08716939 -0.08378401  0.11300106]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02897936  0.04833268 -0.04168627 -0.04013809  0.05968945]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02897936  0.04833268 -0.04168627 -0.04013809  0.05968945]
  [FlaxMamba2] B (step) sample values: [-0.27474478  0.1567468   0.03489241 -0.03844716  0.04195242]
  [FlaxMamba2] C (step) sample values: [-0.27753845  0.16294396 -0.00489769  0.09136847  0.02837385]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.74823433 -0.64391696 -1.1771379  -1.350584   -1.0269372 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06100044 0.16569327 0.10104118 0.04923792 0.41614276]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.95538336 0.8988018  0.8878616  0.935663   0.6522336 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02897936  0.04833268 -0.04168627 -0.04013809  0.05968945]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.8568114e-04  2.7708977e-04  6.1681196e-05 -6.7965120e-05
  7.4161544e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.8568114e-04  2.7708977e-04  6.1681196e-05 -6.7965120e-05
  7.4161544e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.3356351e-04  2.3411485e-04  2.4402507e-05 -2.5828187e-05
  3.5940247e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00016138  0.00046344 -0.00046885 -0.00037737  0.00035478]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02738362  0.04586553 -0.03962753 -0.03808175  0.05642503]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02738362  0.04586553 -0.03962753 -0.03808175  0.05642503]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00758077 -0.00962151  0.00772249 -0.00029439 -0.00625899]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.17890042 -0.18129161  0.19636658 -0.00649266 -0.15018222]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.17890042 -0.18129161  0.19636658 -0.00649266 -0.15018222]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.3963523   1.9598098  -1.8159876   0.4550924   0.03885573]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.3963523   1.9598098  -1.8159876   0.4550924   0.03885573]
  [Layer 44] Output shape after mixer: (1, 1, 2048)
  [Layer 44] Output sample values after mixer: [-0.3963523   1.9598098  -1.8159876   0.4550924   0.03885573]
  [Layer 44] Residual connection shape: (1, 1, 2048)
  [Layer 44] Residual connection sample values: [ -2.4221833   4.5790443 -21.454357   -9.124156    7.4999914]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.04164517  0.08089213 -0.3703716  -0.1543191   0.1282929 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04164517  0.08089213 -0.3703716  -0.1543191   0.1282929 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04164517  0.08089213 -0.3703716  -0.1543191   0.1282929 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.1521587  -0.23394215 -0.8561076   0.21516234 -0.4043186 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.1521587  -0.23394215 -0.8561076   0.21516234 -0.4043186 ]
  [FlaxMamba2] xBC (step) sample values: [-0.6202787   0.55071837 -0.65884566  0.7582804  -1.8227283 ]
  [FlaxMamba2] dt (step) sample values: [2.5011547 1.5760498 2.2223225 1.6459197 2.1655817]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.        -1.170736  -0.6202787  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.10922674 -0.08639354 -0.10144615  0.13993688  0.30317736]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.11380438 -0.03417796 -0.10389709  0.13335271  0.30067492]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.05366782 -0.01679698 -0.04925232  0.07111552  0.17277005]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05366782 -0.01679698 -0.04925232  0.07111552  0.17277005]
  [FlaxMamba2] B (step) sample values: [-0.11070719  0.01033802  0.04515282 -0.20489095 -0.02998488]
  [FlaxMamba2] C (step) sample values: [-0.03051342  0.06109919  0.00357746  0.03790275  0.22630557]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.250236  -4.181475  -1.0937363 -2.677446  -2.3148744]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08449379 0.10475989 0.16635235 0.06371753 0.04737755]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.82685083 0.64529294 0.8336467  0.8431586  0.89612705]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05366782 -0.01679698 -0.04925232  0.07111552  0.17277005]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.0201255e-04 -4.6878766e-05 -2.0474989e-04  9.2909799e-04
  1.3596934e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.0201255e-04 -4.6878766e-05 -2.0474989e-04  9.2909799e-04
  1.3596934e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0005891  -0.0001498  -0.00017251  0.00102784  0.00017998]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.001603   -0.00018091 -0.00130672  0.00200375  0.00461223]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.06180944 -0.01902435 -0.05655971  0.08178364  0.19843173]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.06180944 -0.01902435 -0.05655971  0.08178364  0.19843173]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01709819  0.00196618  0.01443694  0.00974128 -0.03211394]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.43267018  0.03607915  0.33572236  0.2073759  -0.7332125 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.43267018  0.03607915  0.33572236  0.2073759  -0.7332125 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.0836034 -2.6105924  0.8310383  4.4536963  0.8380248]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.0836034 -2.6105924  0.8310383  4.4536963  0.8380248]
  [Layer 45] Output shape after mixer: (1, 1, 2048)
  [Layer 45] Output sample values after mixer: [ 3.0836034 -2.6105924  0.8310383  4.4536963  0.8380248]
  [Layer 45] Residual connection shape: (1, 1, 2048)
  [Layer 45] Residual connection sample values: [  0.6614201   1.968452  -20.62332    -4.6704597   8.3380165]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01309107  0.040607   -0.41577527 -0.09345528  0.1639131 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01309107  0.040607   -0.41577527 -0.09345528  0.1639131 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01309107  0.040607   -0.41577527 -0.09345528  0.1639131 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.14533705 -0.69081223 -1.4320992  -0.51202506 -1.1300201 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.14533705 -0.69081223 -1.4320992  -0.51202506 -1.1300201 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.08927929  0.87362844  0.41459987 -0.08580378  0.35355967]
  [FlaxMamba2] dt (step) sample values: [2.2106018 3.3777196 1.0171415 2.321135  1.3012874]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.         1.1877637  0.08927929 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.04989193  0.10148747  0.07007613  0.0027288  -0.05745389]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.05302951  0.09768803  0.04897323 -0.01310983 -0.03714444]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02581189  0.05122786  0.02508609 -0.00651195 -0.01822734]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02581189  0.05122786  0.02508609 -0.00651195 -0.01822734]
  [FlaxMamba2] B (step) sample values: [ 0.04949996 -0.2774239  -0.02713269 -0.07614519 -0.0470173 ]
  [FlaxMamba2] C (step) sample values: [ 0.02934012 -0.23338602 -0.11001864  0.07525729  0.21813391]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8673339  -0.9793274  -1.6584101  -0.94076145 -0.4381494 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02721954 0.15436658 0.01741933 0.10065841 0.0320221 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.95044214 0.85969687 0.9715249  0.90964985 0.98606753]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02581189  0.05122786  0.02508609 -0.00651195 -0.01822734]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.4778062e-05  1.9491462e-04  1.9063094e-05  5.3498683e-05
  3.3033783e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.4778062e-05  1.9491462e-04  1.9063094e-05  5.3498683e-05
  3.3033783e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-4.5046039e-05  2.9310369e-04  3.2940006e-05  5.2153238e-05
  3.2034066e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-3.8513177e-04  3.2743445e-04  2.2133460e-04  6.7439301e-05
 -1.4598563e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02099476  0.04123057  0.02025145 -0.00513206 -0.01469969]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02099476  0.04123057  0.02025145 -0.00513206 -0.01469969]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00163633 -0.00950898 -0.00559078  0.00098466  0.00405569]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.03540207 -0.1964072  -0.10431506  0.01700507  0.08553654]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03540207 -0.1964072  -0.10431506  0.01700507  0.08553654]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.1708399  -0.44417718 -0.46867245 -2.7214584  -0.5671939 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.1708399  -0.44417718 -0.46867245 -2.7214584  -0.5671939 ]
  [Layer 46] Output shape after mixer: (1, 1, 2048)
  [Layer 46] Output sample values after mixer: [-1.1708399  -0.44417718 -0.46867245 -2.7214584  -0.5671939 ]
  [Layer 46] Residual connection shape: (1, 1, 2048)
  [Layer 46] Residual connection sample values: [ -0.5094198   1.5242748 -21.091991   -7.391918    7.7708225]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00864626  0.02611731 -0.3472598  -0.12319315  0.12335883]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00864626  0.02611731 -0.3472598  -0.12319315  0.12335883]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00864626  0.02611731 -0.3472598  -0.12319315  0.12335883]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.25911027 -0.44514266 -1.4603376  -0.28543216  0.9010199 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.25911027 -0.44514266 -1.4603376  -0.28543216  0.9010199 ]
  [FlaxMamba2] xBC (step) sample values: [-1.6534126  -0.2784253   0.09432931  1.8201396   0.4215621 ]
  [FlaxMamba2] dt (step) sample values: [ 0.7542592  -0.83531183  4.1660457   3.033391    1.9944804 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         0.        -1.2364329 -1.6534126  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.22820465  0.01022226  0.0094514  -0.24941455  0.05678193]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.24530976 -0.01468009 -0.21003103 -0.25279438  0.06195848]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.1376241  -0.00728617 -0.09402761 -0.11050547  0.03193865]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.1376241  -0.00728617 -0.09402761 -0.11050547  0.03193865]
  [FlaxMamba2] B (step) sample values: [-0.17901832 -0.05170799 -0.27835566 -0.27828     0.03518205]
  [FlaxMamba2] C (step) sample values: [ 0.68077093  0.00330054  0.07641555 -0.26803628 -0.15671545]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -3.552239  -11.244981   -2.6866128  -3.193549   -3.1997924]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04696385 0.0066157  0.15426128 0.07332381 0.08239593]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.84634614 0.92830634 0.66071    0.7912327  0.7682425 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.1376241  -0.00728617 -0.09402761 -0.11050547  0.03193865]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00115706 -0.00033421 -0.00179911 -0.00179862  0.00022739]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00115706 -0.00033421 -0.00179911 -0.00179862  0.00022739]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00121088 -0.00033924 -0.00186523 -0.00186543  0.00021408]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00489793 -0.0002681  -0.00340062 -0.00374829  0.00099479]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.1994735  -0.01056943 -0.13633865 -0.15998304  0.04615025]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.1994735  -0.01056943 -0.13633865 -0.15998304  0.04615025]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.02917228 0.00183734 0.03751365 0.01959558 0.02957162]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.56887794 0.02147473 0.71753615 0.39153138 0.56667763]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.56887794 0.02147473 0.71753615 0.39153138 0.56667763]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.8469324 -0.5374894 -3.5919504 -1.3614984  1.0079277]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.8469324 -0.5374894 -3.5919504 -1.3614984  1.0079277]
  [Layer 47] Output shape after mixer: (1, 1, 2048)
  [Layer 47] Output sample values after mixer: [-2.8469324 -0.5374894 -3.5919504 -1.3614984  1.0079277]
  [Layer 47] Residual connection shape: (1, 1, 2048)
  [Layer 47] Residual connection sample values: [ -3.3563523   0.9867854 -24.68394    -8.753416    8.77875  ]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.05330404  0.01463371 -0.35782695 -0.13091266  0.12387835]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.05330404  0.01463371 -0.35782695 -0.13091266  0.12387835]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.05330404  0.01463371 -0.35782695 -0.13091266  0.12387835]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.2260105  -2.1739278  -0.6323254   0.14643025 -0.9919598 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.2260105  -2.1739278  -0.6323254   0.14643025 -0.9919598 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.44788995 -0.43445674  0.5672499   0.55338556  0.11378188]
  [FlaxMamba2] dt (step) sample values: [ 0.5445069   0.4729792   2.2597592   3.499216   -0.25853556]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.         -0.8172884   0.44788995  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.06326491 -0.04279257  0.07937232  0.12168647 -0.0179782 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.06843764  0.17717814 -0.00650414  0.05540229 -0.02042342]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03304835  0.09641663 -0.00324149  0.0284683  -0.01010744]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03304835  0.09641663 -0.00324149  0.0284683  -0.01010744]
  [FlaxMamba2] B (step) sample values: [ 0.0376013  -0.00830527  0.05074609 -0.0203238  -0.08114561]
  [FlaxMamba2] C (step) sample values: [-0.09015703 -0.15432517 -0.11798912 -0.2332855  -0.04939097]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-54.81184   -78.514336  -47.25076    -2.330753   -4.2266355]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05261231 0.01411315 0.03826046 0.03561283 0.00581008]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.05592311 0.3301908  0.1640087  0.9203468  0.975742  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03304835  0.09641663 -0.00324149  0.0284683  -0.01010744]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.5379274e-05  1.4440797e-05 -8.8234781e-05  3.5338020e-05
  1.4109196e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.5379274e-05  1.4440797e-05 -8.8234781e-05  3.5338020e-05
  1.4109196e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-5.6883586e-05 -3.0461542e-06 -1.1247054e-04  5.6356417e-05
  1.3962800e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-2.1323099e-04  1.0311310e-03  2.3737082e-05  3.5874260e-04
 -1.1627082e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02652728  0.07780081 -0.00255723  0.02302602 -0.0081641 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02652728  0.07780081 -0.00255723  0.02302602 -0.0081641 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0026604  -0.01727128  0.00056107  0.00180906  0.00219084]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.06918384 -0.3680885   0.01237475  0.04572016  0.0616396 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.06918384 -0.3680885   0.01237475  0.04572016  0.0616396 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [  2.2315378   7.6592317 -10.299695    5.3565702  -4.302747 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [  2.2315378   7.6592317 -10.299695    5.3565702  -4.302747 ]
  [Layer 48] Output shape after mixer: (1, 1, 2048)
  [Layer 48] Output sample values after mixer: [  2.2315378   7.6592317 -10.299695    5.3565702  -4.302747 ]
  [Layer 48] Residual connection shape: (1, 1, 2048)
  [Layer 48] Residual connection sample values: [ -1.1248145   8.646017  -34.983635   -3.3968458   4.4760036]
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01610438  0.13691558 -0.51009196 -0.05050933  0.06346676]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Final backbone norm output sample values: [-0.01610438  0.13691558 -0.51009196 -0.05050933  0.06346676]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 1, 50288)
[Mamba2LMHeadModel] Logits sample values: [ 7.9573092 -4.5016813  9.70119   10.97678   10.339343 ]
[Mamba2LMHeadModel] Forward pass input_ids shape: (1, 1)
[Mamba2LMHeadModel] input_ids sample values: [310]
[Mamba2LMHeadModel] Embedding output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Embedding sample values: [-0.03851318 -0.12561035 -0.0894165   0.09130859 -0.15368652]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.05309858 -0.19596112 -0.12735495  0.13004984 -0.21509989]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.05309858 -0.19596112 -0.12735495  0.13004984 -0.21509989]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.05309858 -0.19596112 -0.12735495  0.13004984 -0.21509989]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.48343682 -0.5036417  -0.518748   -0.04261003  1.2740912 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.48343682 -0.5036417  -0.518748   -0.04261003  1.2740912 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.5844494 -0.6217285  1.1698194 -0.1750948 -1.4416884]
  [FlaxMamba2] dt (step) sample values: [ 0.53681153  0.24962041  0.29905614 -0.05738416  0.44922805]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.        -0.0169386  0.3529671  0.5844494  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.02890362 -0.1671017  -0.11681539 -0.12950955  0.15724975]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.2566868   0.04823034  0.15344828 -0.08031522 -0.09958619]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.14472559  0.0246966   0.08259922 -0.03854584 -0.04731579]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.14472559  0.0246966   0.08259922 -0.03854584 -0.04731579]
  [FlaxMamba2] B (step) sample values: [ 0.31985396 -0.0742612  -0.22455263 -0.27195582  0.07521286]
  [FlaxMamba2] C (step) sample values: [-0.25581995  0.24814785 -0.27546877 -0.18825987 -0.09921893]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.617978  -2.5226073 -3.0473056 -3.307819  -3.9089987]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01551006 0.01738662 0.01220061 0.02309423 0.01139656]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.96020836 0.9570883  0.96350366 0.9264534  0.95642865]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.14472559  0.0246966   0.08259922 -0.03854584 -0.04731579]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00071798 -0.00016669 -0.00050405 -0.00061046  0.00016883]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00071798 -0.00016669 -0.00050405 -0.00061046  0.00016883]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00129527  0.00011411 -0.00106306 -0.00127577  0.0006329 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.05689416  0.05032839  0.06924635  0.00236174 -0.04621447]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.11208926  0.05974711  0.10074785 -0.01233878 -0.06425965]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.11208926  0.05974711  0.10074785 -0.01233878 -0.06425965]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02066955 -0.01133489 -0.01950158  0.00025728 -0.06397875]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00772024 -0.00455997 -0.00621449  0.00015863 -0.02433953]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00772024 -0.00455997 -0.00621449  0.00015863 -0.02433953]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.03236596 -0.04828102  0.04082512 -0.09153426 -0.02094851]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.03236596 -0.04828102  0.04082512 -0.09153426 -0.02094851]
  [Layer 1] Output shape after mixer: (1, 1, 2048)
  [Layer 1] Output sample values after mixer: [-0.03236596 -0.04828102  0.04082512 -0.09153426 -0.02094851]
  [Layer 1] Residual connection shape: (1, 1, 2048)
  [Layer 1] Residual connection sample values: [-0.07087914 -0.17389137 -0.04859138 -0.00022566 -0.17463504]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.15134911 -0.29323387 -0.09561993 -0.00046525 -0.35172147]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.15134911 -0.29323387 -0.09561993 -0.00046525 -0.35172147]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.15134911 -0.29323387 -0.09561993 -0.00046525 -0.35172147]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.5182976  -0.57546383 -0.839815    0.2669373  -1.8387761 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.5182976  -0.57546383 -0.839815    0.2669373  -1.8387761 ]
  [FlaxMamba2] xBC (step) sample values: [-0.78967863  0.7915649  -0.61823124  4.1924934   0.3936548 ]
  [FlaxMamba2] dt (step) sample values: [1.342068   0.56351304 0.8604699  1.963134   3.7998395 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -0.7521976  -1.1875107  -0.78967863  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.17034137  0.48819175 -0.0331451  -3.1715274  -0.21403055]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.20015705  0.33365074 -0.0436584  -2.1178164  -0.22716074]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.09009612  0.19440073 -0.02135276 -0.22740518 -0.10073506]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09009612  0.19440073 -0.02135276 -0.22740518 -0.10073506]
  [FlaxMamba2] B (step) sample values: [ 0.20088652 -0.07049278 -0.01097077 -0.24501196  0.27124223]
  [FlaxMamba2] C (step) sample values: [-0.13844174  0.08181505 -0.04659897  0.5093748  -0.22991663]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-19.851534   -18.68525    -13.564036    -2.4188707   -0.46617994]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02311741 0.011016   0.04919877 0.05096982 0.51013535]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6319683 0.813966  0.5130747 0.8840078 0.7883486]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09009612  0.19440073 -0.02135276 -0.22740518 -0.10073506]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.1840420e-04  1.4682158e-04  2.2849803e-05  5.1030819e-04
 -5.6494027e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.1840420e-04  1.4682158e-04  2.2849803e-05  5.1030819e-04
 -5.6494027e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-4.3714829e-04  9.6101430e-05  8.0067824e-05  5.3068792e-04
 -5.2615663e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01993355 -0.00286497 -0.0154512   0.13652846 -0.01635838]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.08213113  0.13133898 -0.03019201 -0.02046002 -0.08590053]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.08213113  0.13133898 -0.03019201 -0.02046002 -0.08590053]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02241004 -0.02720737  0.00764662 -0.0030931   0.02167038]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.0038614  -0.00221779  0.0013956  -0.00022856  0.00400969]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0038614  -0.00221779  0.0013956  -0.00022856  0.00400969]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.16602592 -0.11112975 -0.04539208 -0.25294545  0.1586396 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.16602592 -0.11112975 -0.04539208 -0.25294545  0.1586396 ]
  [Layer 2] Output shape after mixer: (1, 1, 2048)
  [Layer 2] Output sample values after mixer: [-0.16602592 -0.11112975 -0.04539208 -0.25294545  0.1586396 ]
  [Layer 2] Residual connection shape: (1, 1, 2048)
  [Layer 2] Residual connection sample values: [-0.23690507 -0.28502113 -0.09398346 -0.25317112 -0.01599544]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.38834828 -0.36531475 -0.13802074 -0.38253772 -0.02599446]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.38834828 -0.36531475 -0.13802074 -0.38253772 -0.02599446]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.38834828 -0.36531475 -0.13802074 -0.38253772 -0.02599446]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.50938195 -1.3992943   1.9070835  -0.6199916  -1.3832409 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.50938195 -1.3992943   1.9070835  -0.6199916  -1.3832409 ]
  [FlaxMamba2] xBC (step) sample values: [-0.13996676 -1.194446   -2.170272    0.39384714  0.51809186]
  [FlaxMamba2] dt (step) sample values: [ 2.868263   -0.22950946  1.1637537   2.4528358  -0.20847373]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          1.1962808   0.46637878 -0.13996676  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.20553428  0.09567998  0.19411796  0.07403554  0.00468899]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.20708305  0.07637762  0.3177752   0.06169881 -0.01160739]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.09285883  0.03964649  0.18392254  0.03180079 -0.00577002]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09285883  0.03964649  0.18392254  0.03180079 -0.00577002]
  [FlaxMamba2] B (step) sample values: [ 0.57563317 -0.0480219  -0.11149029 -0.04173365  0.15325907]
  [FlaxMamba2] C (step) sample values: [ 0.44263354 -0.05395955 -0.20371667  0.72784287  1.054123  ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6505536 -3.9938898 -6.780579  -0.9418818 -6.0307717]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.13820994 0.01623718 0.04298609 0.07370529 0.01763942]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9140107 0.9372085 0.747164  0.9329332 0.8990835]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09285883  0.03964649  0.18392254  0.03180079 -0.00577002]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00738768  0.00061631  0.00143087  0.00053561 -0.00196693]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00738768  0.00061631  0.00143087  0.00053561 -0.00196693]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00792098  0.00067478  0.00124447  0.00075738 -0.00229992]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.05011772  0.01862152  0.17729653  0.03263215 -0.00943017]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0923938   0.03667148  0.26103142  0.04711018 -0.0120571 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0923938   0.03667148  0.26103142  0.04711018 -0.0120571 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02939891 -0.01015652  0.43343765 -0.01021644  0.00334373]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00521089 -0.00196296  0.06751195 -0.00243772  0.00045976]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00521089 -0.00196296  0.06751195 -0.00243772  0.00045976]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.0670248  -0.1126639   0.13139574  0.00541921  0.10550313]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.0670248  -0.1126639   0.13139574  0.00541921  0.10550313]
  [Layer 3] Output shape after mixer: (1, 1, 2048)
  [Layer 3] Output sample values after mixer: [ 0.0670248  -0.1126639   0.13139574  0.00541921  0.10550313]
  [Layer 3] Residual connection shape: (1, 1, 2048)
  [Layer 3] Residual connection sample values: [-0.16988027 -0.39768502  0.03741229 -0.2477519   0.08950769]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.27463028 -0.48688388  0.05342709 -0.36595485  0.14515318]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.27463028 -0.48688388  0.05342709 -0.36595485  0.14515318]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.27463028 -0.48688388  0.05342709 -0.36595485  0.14515318]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.17332105  0.8437817  -0.97341686  0.1999026  -1.351276  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.17332105  0.8437817  -0.97341686  0.1999026  -1.351276  ]
  [FlaxMamba2] xBC (step) sample values: [ 0.01396449  1.6211092  -0.42454308  1.0611044   0.54874563]
  [FlaxMamba2] dt (step) sample values: [ 1.6789068   2.982744    2.538041    0.08528123 -0.8586319 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.08970526 0.68919337 0.01396449 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-1.5140082e-02  4.2946750e-01  8.0937177e-02 -1.3400614e-04
  3.1223843e-01]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.08893158  0.39431125  0.0327194  -0.01595737  0.6052072 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04248989  0.23553003  0.01662732 -0.00791503  0.3914763 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04248989  0.23553003  0.01662732 -0.00791503  0.3914763 ]
  [FlaxMamba2] B (step) sample values: [ 0.53792655  0.59615666  1.139507    0.03655158 -0.16068536]
  [FlaxMamba2] C (step) sample values: [ 0.73823017 -0.04813769  0.1808487  -0.22480157 -0.13456151]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.7127254  -1.2862217  -1.4869522 -27.028044   -4.0726624]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03247712 0.0465165  0.02395039 0.00352825 0.0162337 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.94589436 0.94192415 0.9650136  0.90904397 0.93602383]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04248989  0.23553003  0.01662732 -0.00791503  0.3914763 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.4231130e-04 -8.2266587e-04 -1.5724618e-03 -5.0439321e-05
  2.2173763e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.4231130e-04 -8.2266587e-04 -1.5724618e-03 -5.0439321e-05
  2.2173763e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-8.7462406e-04 -1.2663039e-03 -1.2225611e-03  3.9107003e-05
 -8.5162726e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00789278  0.0237934  -0.0053531  -0.00467782  0.08668649]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03180937  0.15636788  0.00400604 -0.009133    0.30703956]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03180937  0.15636788  0.00400604 -0.009133    0.30703956]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00299491  0.09226076 -0.00106926 -0.00100379 -0.08532811]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00115651  0.02289132 -0.00040596 -0.00032115 -0.0162903 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00115651  0.02289132 -0.00040596 -0.00032115 -0.0162903 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.19587916 -0.05656035 -0.28645068  0.1158287   0.09151901]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.19587916 -0.05656035 -0.28645068  0.1158287   0.09151901]
  [Layer 4] Output shape after mixer: (1, 1, 2048)
  [Layer 4] Output sample values after mixer: [-0.19587916 -0.05656035 -0.28645068  0.1158287   0.09151901]
  [Layer 4] Residual connection shape: (1, 1, 2048)
  [Layer 4] Residual connection sample values: [-0.36575943 -0.45424536 -0.2490384  -0.1319232   0.1810267 ]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.48687258 -0.4996855  -0.30962893 -0.16819869  0.24865882]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.48687258 -0.4996855  -0.30962893 -0.16819869  0.24865882]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.48687258 -0.4996855  -0.30962893 -0.16819869  0.24865882]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.00229131 -0.09851946  1.6382284  -1.1853033   0.29549843]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.00229131 -0.09851946  1.6382284  -1.1853033   0.29549843]
  [FlaxMamba2] xBC (step) sample values: [ 0.26593763  1.1387584   0.47066626 -0.49580455 -0.80625963]
  [FlaxMamba2] dt (step) sample values: [ 2.5118015   1.421604    1.2140213  -0.22101837  0.40006238]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -1.0174327   0.35433516  0.26593763  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.0324592   0.38414973 -0.26385644 -0.5033439  -0.24264114]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.08403391  0.34682673 -0.33337548 -0.5294669  -0.24850433]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04025257  0.2031877  -0.13915743 -0.19624227 -0.10889252]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04025257  0.2031877  -0.13915743 -0.19624227 -0.10889252]
  [FlaxMamba2] B (step) sample values: [ 0.02047762 -0.05355126 -0.0524374  -0.02964526  0.07475027]
  [FlaxMamba2] C (step) sample values: [ 0.15215935  0.09744623 -0.13953888  0.05090117  0.05589727]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.5762966   -1.0443833   -0.83880144  -5.6764617  -20.401838  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04695146 0.04894631 0.13621369 0.01115206 0.00508141]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.92866296 0.95016587 0.89202935 0.9386578  0.9015227 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04025257  0.2031877  -0.13915743 -0.19624227 -0.10889252]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.8700986e-05  1.0120743e-04  9.9102319e-05  5.6027082e-05
 -1.4127178e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.8700986e-05  1.0120743e-04  9.9102319e-05  5.6027082e-05
 -1.4127178e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.3683288e-04  2.6638870e-04  9.6665681e-05  8.8105742e-05
 -1.9253214e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00067374  0.00922892 -0.01044498 -0.01145925 -0.01014768]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02231065  0.11844812 -0.08524607 -0.11694507 -0.06868052]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02231065  0.11844812 -0.08524607 -0.11694507 -0.06868052]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-2.55895993e-05 -5.54753747e-03 -1.16930194e-01  3.24498601e-02
 -1.16359619e-02]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-1.3878930e-05 -3.0685985e-03 -6.1607003e-02  1.7894855e-02
 -5.6876955e-03]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-1.3878930e-05 -3.0685985e-03 -6.1607003e-02  1.7894855e-02
 -5.6876955e-03]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.11397199 -0.06236401  0.15274367  0.19981138 -0.07934622]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.11397199 -0.06236401  0.15274367  0.19981138 -0.07934622]
  [Layer 5] Output shape after mixer: (1, 1, 2048)
  [Layer 5] Output sample values after mixer: [ 0.11397199 -0.06236401  0.15274367  0.19981138 -0.07934622]
  [Layer 5] Residual connection shape: (1, 1, 2048)
  [Layer 5] Residual connection sample values: [-0.25178742 -0.5166094  -0.09629473  0.06788819  0.10168048]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.24043226 -0.38180378 -0.0816106   0.05947522  0.09849348]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.24043226 -0.38180378 -0.0816106   0.05947522  0.09849348]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.24043226 -0.38180378 -0.0816106   0.05947522  0.09849348]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 2.0074308  -0.93708676 -0.03234323  0.7891027  -0.174219  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 2.0074308  -0.93708676 -0.03234323  0.7891027  -0.174219  ]
  [FlaxMamba2] xBC (step) sample values: [ 0.32843578 -0.8687187  -0.03600156 -0.6302511  -0.37863916]
  [FlaxMamba2] dt (step) sample values: [3.9418864  2.3603985  0.95914394 0.88513255 2.147925  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -0.418163   -2.9152837   0.32843578  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.03343139 -0.33360916  0.09977186  0.02839199 -0.20070878]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.06779418 -0.40593582  0.03760756  0.09049526 -0.13100663]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.03504566 -0.16232848  0.01915732  0.04729358 -0.06121876]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03504566 -0.16232848  0.01915732  0.04729358 -0.06121876]
  [FlaxMamba2] B (step) sample values: [ 1.0088327   0.05243751 -0.2374961  -0.0587411   0.23350044]
  [FlaxMamba2] C (step) sample values: [-0.27248782  0.01657666 -0.27824435  0.3437216   0.512103  ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.98658675 -8.774721   -3.3045902  -2.9912853  -3.3435438 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.39844283 0.13669829 0.2057597  0.15291886 0.2296806 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6749623  0.30134806 0.50664157 0.6329119  0.46396455]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03504566 -0.16232848  0.01915732  0.04729358 -0.06121876]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01408703  0.00073222 -0.00331632 -0.00082024  0.00326053]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01408703  0.00073222 -0.00331632 -0.00082024  0.00326053]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.02331074 -0.00245592 -0.0114173  -0.00231107  0.00252901]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.12572557 -0.13855007  0.00504798  0.02912576 -0.0835375 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.1333148  -0.17370276  0.00919655  0.03936733 -0.0967946 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.1333148  -0.17370276  0.00919655  0.03936733 -0.0967946 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 2.3592733e-01  4.5819279e-02 -1.4631823e-04  2.1361399e-02
  7.6990980e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 1.4638992e-01  1.3319017e-02 -4.0432551e-05  7.6750643e-03
  1.9526504e-03]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 1.4638992e-01  1.3319017e-02 -4.0432551e-05  7.6750643e-03
  1.9526504e-03]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.09838203  0.00695166  0.29151478 -0.22108065 -0.01543111]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.09838203  0.00695166  0.29151478 -0.22108065 -0.01543111]
  [Layer 6] Output shape after mixer: (1, 1, 2048)
  [Layer 6] Output sample values after mixer: [ 0.09838203  0.00695166  0.29151478 -0.22108065 -0.01543111]
  [Layer 6] Residual connection shape: (1, 1, 2048)
  [Layer 6] Residual connection sample values: [-0.1534054  -0.5096577   0.19522005 -0.15319246  0.08624937]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.09204248 -0.25398594  0.10858407 -0.08415796  0.05191338]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09204248 -0.25398594  0.10858407 -0.08415796  0.05191338]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09204248 -0.25398594  0.10858407 -0.08415796  0.05191338]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.17033267  0.21853985 -0.36014682  0.3558202   0.5546744 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.17033267  0.21853985 -0.36014682  0.3558202   0.5546744 ]
  [FlaxMamba2] xBC (step) sample values: [-2.4927015  -0.02863535  0.5035551  -0.44608933  1.0861928 ]
  [FlaxMamba2] dt (step) sample values: [1.9383963 1.2033302 2.9432552 2.2203958 1.6152642]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.        -1.3216721 -3.4444342 -2.4927015  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.08981484 -0.35859382  0.4188398  -0.20998974  0.04595897]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.15793008 -0.33396614  0.41808975 -0.20356579  0.04236553]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07274248 -0.13935603  0.252119   -0.09145878  0.02163141]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07274248 -0.13935603  0.252119   -0.09145878  0.02163141]
  [FlaxMamba2] B (step) sample values: [ 0.00434068  0.06746563 -0.00159242 -0.00873211  0.21483253]
  [FlaxMamba2] C (step) sample values: [ 0.50825804  0.02475629  0.00998396 -0.0982255   0.07738218]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.29588825 -1.1836219  -0.3113019  -0.1314279  -1.5015444 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11544688 0.01984329 0.0468534  0.13042809 0.00538914]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9664175  0.97678673 0.9855203  0.9830042  0.9919406 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07274248 -0.13935603  0.252119   -0.09145878  0.02163141]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.64525295e-05 -5.66569099e-04  1.33729845e-05  7.33313645e-05
 -1.80414063e-03]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.64525295e-05 -5.66569099e-04  1.33729845e-05  7.33313645e-05
 -1.80414063e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00112865  0.00065056 -0.00049057  0.00020071 -0.00246262]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00033689 -0.00246353  0.00331473  0.00061298  0.00060157]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00017045 -0.00278239  0.00389159  0.00040372  0.00065106]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00017045 -0.00278239  0.00389159  0.00040372  0.00065106]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-1.3283544e-05 -3.3712122e-04 -5.7592749e-04  8.4471118e-05
  2.2939565e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-8.6962347e-05 -1.2291962e-03 -4.9551027e-03  5.1260064e-04
  1.9005077e-03]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-8.6962347e-05 -1.2291962e-03 -4.9551027e-03  5.1260064e-04
  1.9005077e-03]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.04487422 -0.07932065  0.06738542  0.11183529  0.21064557]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.04487422 -0.07932065  0.06738542  0.11183529  0.21064557]
  [Layer 7] Output shape after mixer: (1, 1, 2048)
  [Layer 7] Output sample values after mixer: [-0.04487422 -0.07932065  0.06738542  0.11183529  0.21064557]
  [Layer 7] Residual connection shape: (1, 1, 2048)
  [Layer 7] Residual connection sample values: [-0.19827962 -0.58897835  0.2626055  -0.04135717  0.29689494]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.13442431 -0.31252015  0.16589555 -0.02599377  0.20032784]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.13442431 -0.31252015  0.16589555 -0.02599377  0.20032784]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.13442431 -0.31252015  0.16589555 -0.02599377  0.20032784]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.20464042 -1.1784253  -0.46262586 -1.9745654  -0.8002748 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.20464042 -1.1784253  -0.46262586 -1.9745654  -0.8002748 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.17718412  0.04583632  0.7950478  -0.8358018  -1.2213192 ]
  [FlaxMamba2] dt (step) sample values: [2.141526  0.5265425 1.9964926 1.1715556 1.7912239]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -0.79613364 -1.7796566   0.17718412  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.13163994 -0.36899477 -0.06398702 -0.01510745 -0.26631194]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.33125067 -0.4000159  -0.37868428 -0.06668215 -0.32243377]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.19280896 -0.16052978 -0.15391405 -0.03222986 -0.13544886]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.19280896 -0.16052978 -0.15391405 -0.03222986 -0.13544886]
  [FlaxMamba2] B (step) sample values: [-0.03032424 -0.01347657  0.00775791 -0.12471605 -0.04153303]
  [FlaxMamba2] C (step) sample values: [-0.0231282   0.13129406  0.05618545  0.18180312  0.05894309]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.6542776 -0.9827404 -0.5549556 -3.9396574 -1.8081155]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08259503 0.09020954 0.07921696 0.07567085 0.05648006]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7394673 0.9151635 0.9569904 0.7422143 0.902919 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.19280896 -0.16052978 -0.15391405 -0.03222986 -0.13544886]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00048292 -0.00021462  0.00012355 -0.00198611 -0.00066142]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00048292 -0.00021462  0.00012355 -0.00198611 -0.00066142]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-5.2683498e-04 -2.4972402e-04  2.7014990e-05 -2.0396861e-03
 -5.0112116e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.04384499 -0.03467701 -0.03384421 -0.00692856 -0.02864459]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.20615159 -0.16981098 -0.16340905 -0.03405965 -0.14266545]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.20615159 -0.16981098 -0.16340905 -0.03405965 -0.14266545]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01894269  0.04709288  0.02920799  0.0081981   0.03538939]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.01151295  0.03646486  0.01537368  0.00676105  0.03481875]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01151295  0.03646486  0.01537368  0.00676105  0.03481875]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.17309003 -0.10633576 -0.28689864  0.27172655 -0.21579424]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.17309003 -0.10633576 -0.28689864  0.27172655 -0.21579424]
  [Layer 8] Output shape after mixer: (1, 1, 2048)
  [Layer 8] Output sample values after mixer: [-0.17309003 -0.10633576 -0.28689864  0.27172655 -0.21579424]
  [Layer 8] Residual connection shape: (1, 1, 2048)
  [Layer 8] Residual connection sample values: [-0.37136966 -0.6953141  -0.02429315  0.23036939  0.0811007 ]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.19531177 -0.298784   -0.01174555  0.1069614   0.04210475]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.19531177 -0.298784   -0.01174555  0.1069614   0.04210475]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.19531177 -0.298784   -0.01174555  0.1069614   0.04210475]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.47244817 -1.4163914  -1.4801772   0.44132385 -0.06153865]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.47244817 -1.4163914  -1.4801772   0.44132385 -0.06153865]
  [FlaxMamba2] xBC (step) sample values: [-0.58628625 -0.22637303 -0.05101024 -0.6486658   1.2222046 ]
  [FlaxMamba2] dt (step) sample values: [2.921105  2.3658032 3.8818753 0.7840643 2.6391585]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          1.0603741  -0.53071535 -0.58628625  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12030254 -0.03642269  0.0161      0.18673733 -0.08905588]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.12765346 -0.06176754 -0.07056992  0.11282375 -0.06401621]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.06789506 -0.02993027 -0.03404045  0.0595908  -0.03098394]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06789506 -0.02993027 -0.03404045  0.0595908  -0.03098394]
  [FlaxMamba2] B (step) sample values: [ 0.5962101  -0.18944025  0.25580794  0.14359847 -0.14037272]
  [FlaxMamba2] C (step) sample values: [-0.26181096 -0.24299942 -0.2516529   0.48986372 -0.11221016]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-5.234511  -1.2161361 -1.4887683 -0.9523448 -3.9666808]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.17267907 0.34120542 0.20995241 0.26051077 0.20043531]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.404991   0.66037184 0.73156404 0.780285   0.45155284]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06789506 -0.02993027 -0.03404045  0.0595908  -0.03098394]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00699    -0.00222101  0.00299911  0.00168356 -0.00164574]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00699    -0.00222101  0.00299911  0.00168356 -0.00164574]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00713758 -0.00193092  0.00226908  0.00114771 -0.00192483]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00956714 -0.0066949  -0.00821863  0.00950055 -0.00675434]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.10160244 -0.04726693 -0.05436223  0.09027899 -0.04875468]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.10160244 -0.04726693 -0.05436223  0.09027899 -0.04875468]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01843449  0.01307021  0.0149184   0.02424699  0.001454  ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.01050909  0.01110281  0.00847258  0.0108588   0.00094842]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01050909  0.01110281  0.00847258  0.0108588   0.00094842]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.10399546 -0.09128764 -0.24493353 -0.0346985  -0.11781321]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.10399546 -0.09128764 -0.24493353 -0.0346985  -0.11781321]
  [Layer 9] Output shape after mixer: (1, 1, 2048)
  [Layer 9] Output sample values after mixer: [ 0.10399546 -0.09128764 -0.24493353 -0.0346985  -0.11781321]
  [Layer 9] Residual connection shape: (1, 1, 2048)
  [Layer 9] Residual connection sample values: [-0.2673742  -0.7866017  -0.26922667  0.19567089 -0.03671251]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.09327034 -0.22934654 -0.08477721  0.06100385 -0.01251619]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09327034 -0.22934654 -0.08477721  0.06100385 -0.01251619]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09327034 -0.22934654 -0.08477721  0.06100385 -0.01251619]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.00771683 -0.20893815  0.39512274 -0.09361836 -0.0259745 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.00771683 -0.20893815  0.39512274 -0.09361836 -0.0259745 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.4215516   0.95135295  0.5588973  -0.00720918  1.3180661 ]
  [FlaxMamba2] dt (step) sample values: [3.026073  1.3796667 0.1110423 1.7815567 1.4398818]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.        -0.8272672 -0.9168027  0.4215516  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.07821795 -0.34869432  0.1512225   0.03951928  0.35545462]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03985735 -0.4357915   0.0474017  -0.04629615  0.2958843 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02032578 -0.17115459  0.02426247 -0.02261234  0.16967075]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02032578 -0.17115459  0.02426247 -0.02261234  0.16967075]
  [FlaxMamba2] B (step) sample values: [-3.0097616e-04  4.8785046e-01  2.1404035e-01  2.2804989e-03
  5.2433826e-02]
  [FlaxMamba2] C (step) sample values: [-0.25992963  0.23339017 -0.08598611  0.1457733   0.04494294]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.7154508  -1.4067873  -0.35344088 -2.010216   -0.4652703 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00901463 0.01406462 0.10513274 0.01079649 0.03159166]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9670613  0.98040855 0.9635237  0.9785305  0.98540884]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02032578 -0.17115459  0.02426247 -0.02261234  0.16967075]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.5147670e-08  8.9388530e-05  3.9218477e-05  4.1785435e-07
  9.6074164e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.5147670e-08  8.9388530e-05  3.9218477e-05  4.1785435e-07
  9.6074164e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-5.7602637e-07  1.0829804e-04  4.1206877e-05  1.2251178e-05
  1.4764411e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00026003 -0.0031684   0.00049596 -0.00045613  0.00328722]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00472602 -0.0407746   0.00582692 -0.00542452  0.04056739]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00472602 -0.0407746   0.00582692 -0.00542452  0.04056739]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 1.8305293e-05  3.8162919e-03  1.3756891e-03  2.4204049e-04
 -5.2001671e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00025379  0.02578312  0.0149354   0.00299066 -0.00594625]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00025379  0.02578312  0.0149354   0.00299066 -0.00594625]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.61810845  0.25409755  0.10591076  0.3245151   0.08954523]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.61810845  0.25409755  0.10591076  0.3245151   0.08954523]
  [Layer 10] Output shape after mixer: (1, 1, 2048)
  [Layer 10] Output sample values after mixer: [-0.61810845  0.25409755  0.10591076  0.3245151   0.08954523]
  [Layer 10] Residual connection shape: (1, 1, 2048)
  [Layer 10] Residual connection sample values: [-0.88548267 -0.5325042  -0.16331592  0.520186    0.05283272]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.35944906 -0.17586878 -0.05921905  0.18402389  0.02050135]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.35944906 -0.17586878 -0.05921905  0.18402389  0.02050135]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.35944906 -0.17586878 -0.05921905  0.18402389  0.02050135]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.53788733 -0.617641   -0.51159346 -1.0837489  -0.10041171]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.53788733 -0.617641   -0.51159346 -1.0837489  -0.10041171]
  [FlaxMamba2] xBC (step) sample values: [ 0.5201296   1.2709973  -0.80832714  0.8163674   0.4551454 ]
  [FlaxMamba2] dt (step) sample values: [3.7763953 3.9929838 2.579405  2.880906  3.3685422]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.        1.1211524 1.1445943 0.5201296 0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.22556259 -0.27178195  0.26591486 -0.06985522  0.05410281]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.23976852 -0.62944794  0.36247247 -0.05770922  0.07726565]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.10558049 -0.21881859  0.21372785 -0.02802226  0.04012458]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.10558049 -0.21881859  0.21372785 -0.02802226  0.04012458]
  [FlaxMamba2] B (step) sample values: [-0.11211445 -0.2677061  -0.25361353  0.02977858  0.21814097]
  [FlaxMamba2] C (step) sample values: [-0.04444047 -0.09195876 -0.27822804 -0.10127762 -0.10903169]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.31160602 -0.09015273 -1.5786072  -0.20961139 -0.6694042 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.5738169  1.0052544  0.9858572  0.5759599  0.19672231]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.83626914 0.91335887 0.21091898 0.88627523 0.8766155 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.10558049 -0.21881859  0.21372785 -0.02802226  0.04012458]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00679233  0.01621867  0.01536489 -0.0018041  -0.01321582]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00679233  0.01621867  0.01536489 -0.0018041  -0.01321582]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.03755122 -0.02195837  0.04543272  0.00923233 -0.05175199]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.10575145 -0.16537003  0.24235225 -0.01521247 -0.03189692]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.14448656 -0.24564967  0.32076418 -0.02549321 -0.01717611]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.14448656 -0.24564967  0.32076418 -0.02549321 -0.01717611]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02865282  0.05315143 -0.06150829  0.00698434  0.00081908]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.02406107  0.04374666 -0.03590545  0.01328732  0.00051177]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02406107  0.04374666 -0.03590545  0.01328732  0.00051177]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [0.7791986  0.18305543 0.20050716 0.14802074 0.17712569]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [0.7791986  0.18305543 0.20050716 0.14802074 0.17712569]
  [Layer 11] Output shape after mixer: (1, 1, 2048)
  [Layer 11] Output sample values after mixer: [0.7791986  0.18305543 0.20050716 0.14802074 0.17712569]
  [Layer 11] Residual connection shape: (1, 1, 2048)
  [Layer 11] Residual connection sample values: [-0.10628408 -0.34944877  0.03719124  0.66820675  0.22995842]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03220288 -0.08785708  0.00984331  0.17565602  0.06675111]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03220288 -0.08785708  0.00984331  0.17565602  0.06675111]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03220288 -0.08785708  0.00984331  0.17565602  0.06675111]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.01981246 -1.3677199  -1.1946315   0.92022264 -0.580459  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.01981246 -1.3677199  -1.1946315   0.92022264 -0.580459  ]
  [FlaxMamba2] xBC (step) sample values: [-1.6992308   0.16052778  0.99696094 -0.09774464  0.45241103]
  [FlaxMamba2] dt (step) sample values: [2.0694842 1.9019723 1.9940474 1.4985021 1.6398098]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.23113912  0.6048336  -1.6992308   0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.27021298 -0.03301901  0.75107896  0.03548038  0.10566779]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.31321225 -0.02012534  0.7161974   0.00577152  0.11828681]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.1322792  -0.00996141  0.4811193   0.00289409  0.06263728]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.1322792  -0.00996141  0.4811193   0.00289409  0.06263728]
  [FlaxMamba2] B (step) sample values: [ 0.38971287 -0.19609012  1.1569518  -0.12837382  0.04765065]
  [FlaxMamba2] C (step) sample values: [-0.26439896 -0.27723613 -0.14022467 -0.21435216 -0.032887  ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2411823 -0.7693517 -1.9974962 -1.2367963 -1.0181218]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.29462102 0.38362995 0.18296859 0.36141747 0.34820485]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6937259  0.7444227  0.69386417 0.639544   0.70151365]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.1322792  -0.00996141  0.4811193   0.00289409  0.06263728]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01518798  0.00764207 -0.045089    0.00500301 -0.00185705]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.01518798  0.00764207 -0.045089    0.00500301 -0.00185705]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.01480009  0.00679496 -0.04446016  0.00452711 -0.00231385]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00265017  0.01632657  0.06845938 -0.00644388 -0.04164231]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.09786664  0.0091562   0.41477597 -0.00436067  0.0034449 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.09786664  0.0091562   0.41477597 -0.00436067  0.0034449 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00097909 -0.00254205 -0.11517089 -0.0028695  -0.00071752]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.0025872  -0.00442452 -0.15150374 -0.00431752 -0.00155231]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0025872  -0.00442452 -0.15150374 -0.00431752 -0.00155231]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.652906    0.02060693 -0.52237886 -0.46993867 -0.5292066 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.652906    0.02060693 -0.52237886 -0.46993867 -0.5292066 ]
  [Layer 12] Output shape after mixer: (1, 1, 2048)
  [Layer 12] Output sample values after mixer: [-0.652906    0.02060693 -0.52237886 -0.46993867 -0.5292066 ]
  [Layer 12] Residual connection shape: (1, 1, 2048)
  [Layer 12] Residual connection sample values: [-0.7591901  -0.32884184 -0.48518762  0.19826809 -0.29924816]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.16986637 -0.06367525 -0.10017321  0.03852547 -0.06796603]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.16986637 -0.06367525 -0.10017321  0.03852547 -0.06796603]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.16986637 -0.06367525 -0.10017321  0.03852547 -0.06796603]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.1641797   0.85744935 -0.2815415   1.2532897   0.9978117 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.1641797   0.85744935 -0.2815415   1.2532897   0.9978117 ]
  [FlaxMamba2] xBC (step) sample values: [-2.3017192  -1.4892592   0.1823135   0.92386127 -0.20467223]
  [FlaxMamba2] dt (step) sample values: [3.051414  2.9125147 2.4141428 2.2781246 2.6341367]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.        -0.4691228 -0.9623956 -2.3017192  0.       ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.16876419  0.2008961  -0.2202375   0.08436048  0.19422293]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.4334126   0.09097178 -0.24071479  0.08355558  0.17026663]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.17046627  0.04755343 -0.10594103  0.04352216  0.09236354]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.17046627  0.04755343 -0.10594103  0.04352216  0.09236354]
  [FlaxMamba2] B (step) sample values: [ 0.03158462 -0.20813835  0.13632043  0.58993673  0.0306637 ]
  [FlaxMamba2] C (step) sample values: [-0.0128302   0.14410579 -0.16426948  0.47705504 -0.21930815]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3103099 -1.7870504 -0.8605819 -1.881061  -0.5251649]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.18572125 0.16586764 0.36248994 0.38275337 0.2209891 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7839952  0.74347967 0.73201644 0.4867608  0.8904256 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.17046627  0.04755343 -0.10594103  0.04352216  0.09236354]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00099994  0.0065895  -0.0043158  -0.01867693 -0.00097079]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00099994  0.0065895  -0.0043158  -0.01867693 -0.00097079]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00396838  0.0073725  -0.00474429 -0.02578832 -0.00082147]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.06181561  0.01031604 -0.02781042  0.00746526  0.08320322]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.06915425  0.01236323 -0.03237122  0.00933891  0.0871795 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.06915425  0.01236323 -0.03237122  0.00933891  0.0871795 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.01915354 0.00744315 0.00391964 0.00910445 0.06355641]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.07571314 0.00970517 0.02095616 0.05540832 0.14757842]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.07571314 0.00970517 0.02095616 0.05540832 0.14757842]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.2031514   0.370013    0.01438868 -0.1506146   0.19812375]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.2031514   0.370013    0.01438868 -0.1506146   0.19812375]
  [Layer 13] Output shape after mixer: (1, 1, 2048)
  [Layer 13] Output sample values after mixer: [ 0.2031514   0.370013    0.01438868 -0.1506146   0.19812375]
  [Layer 13] Residual connection shape: (1, 1, 2048)
  [Layer 13] Residual connection sample values: [-0.5560387   0.04117116 -0.47079894  0.04765348 -0.10112441]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.09323904  0.00606372 -0.07309374  0.00695698 -0.01655382]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09323904  0.00606372 -0.07309374  0.00695698 -0.01655382]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09323904  0.00606372 -0.07309374  0.00695698 -0.01655382]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 2.028775   -0.9910106  -0.29028496 -0.05840927  0.19904763]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 2.028775   -0.9910106  -0.29028496 -0.05840927  0.19904763]
  [FlaxMamba2] xBC (step) sample values: [-0.03884755  0.13899966  0.8996553  -0.67333853  0.36959958]
  [FlaxMamba2] dt (step) sample values: [0.4617377 1.6349826 1.3077778 1.0111933 1.6312625]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.2844488  -0.18248388 -0.03884755  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01267244  0.14370477 -0.3306105  -0.15960221 -0.05944759]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.05222322  0.10244501 -0.39146256 -0.22240739 -0.02288754]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02542995  0.05384396 -0.15790239 -0.09888815 -0.01131281]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02542995  0.05384396 -0.15790239 -0.09888815 -0.01131281]
  [FlaxMamba2] B (step) sample values: [-0.04260812 -0.01284334  0.01538188 -0.0005423   0.13630654]
  [FlaxMamba2] C (step) sample values: [-0.10476968 -0.15894227 -0.18342063 -0.15125851  0.7712007 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.318424  -0.7620611 -2.6670074 -5.1836414 -2.8487349]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06201568 0.06024395 0.27245286 0.04482221 0.06904546]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7650531  0.9551283  0.48353392 0.7926748  0.82144344]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02542995  0.05384396 -0.15790239 -0.09888815 -0.01131281]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 6.7195368e-05  2.0254662e-05 -2.4258085e-05  8.5523970e-07
 -2.1496299e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 6.7195368e-05  2.0254662e-05 -2.4258085e-05  8.5523970e-07
 -2.1496299e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 7.4943644e-05  1.0286604e-05 -1.6018603e-05 -4.7569961e-06
 -2.3087373e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00143513  0.00491574 -0.00999069 -0.00564202 -0.00021289]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01171451  0.02668073 -0.07381853 -0.04561493 -0.00478579]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01171451  0.02668073 -0.07381853 -0.04561493 -0.00478579]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02100414 -0.00715788  0.00916995  0.00129327 -0.00052355]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.14829545 -0.02941185  0.05467729  0.01084089 -0.00508752]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.14829545 -0.02941185  0.05467729  0.01084089 -0.00508752]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.72915304  0.01249876  0.15063155  0.4868032  -0.45554054]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.72915304  0.01249876  0.15063155  0.4868032  -0.45554054]
  [Layer 14] Output shape after mixer: (1, 1, 2048)
  [Layer 14] Output sample values after mixer: [ 0.72915304  0.01249876  0.15063155  0.4868032  -0.45554054]
  [Layer 14] Residual connection shape: (1, 1, 2048)
  [Layer 14] Residual connection sample values: [ 0.17311436  0.05366992 -0.3201674   0.5344567  -0.55666494]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02487204  0.00655567 -0.04228129  0.06608544 -0.07663425]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.02487204  0.00655567 -0.04228129  0.06608544 -0.07663425]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.02487204  0.00655567 -0.04228129  0.06608544 -0.07663425]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.912513    0.71555495 -0.29906762 -0.68103474 -0.8008543 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.912513    0.71555495 -0.29906762 -0.68103474 -0.8008543 ]
  [FlaxMamba2] xBC (step) sample values: [-0.51498413 -0.05656574 -0.09067793  0.52516115 -0.13741726]
  [FlaxMamba2] dt (step) sample values: [ 0.5628625   0.02717335 -0.5530079   2.3118067   0.9867561 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -0.4773197  -1.2982016  -0.51498413  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.2667335   0.01142565  0.03205725  0.00326003 -0.0335134 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.30417857  0.00457064  0.00727698 -0.01448594 -0.05885825]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.12913483  0.00229054  0.00365173 -0.00719051 -0.0285633 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.12913483  0.00229054  0.00365173 -0.00719051 -0.0285633 ]
  [FlaxMamba2] B (step) sample values: [ 0.04094425  0.02457434  0.0230988  -0.07146775 -0.05295458]
  [FlaxMamba2] C (step) sample values: [ 8.6899832e-02 -9.5903299e-05  2.3527401e-02  9.5661126e-02
  6.9818594e-02]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.27823287 -0.68077636 -2.7209377  -0.11263601 -3.8483953 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00339677 0.01628196 0.00873017 0.0563235  0.06094535]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9990553  0.98897684 0.97652566 0.993676   0.79093313]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.12913483  0.00229054  0.00365173 -0.00719051 -0.0285633 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.7959841e-05 -1.0779319e-05 -1.0132089e-05  3.1348711e-05
  2.3228069e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.7959841e-05 -1.0779319e-05 -1.0132089e-05  3.1348711e-05
  2.3228069e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.6371934e-05 -1.1425058e-05 -9.9488543e-06  3.2825243e-05
  3.3423297e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-2.4381394e-05  3.7952348e-06 -4.8212214e-06  1.7627637e-05
 -1.1980286e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0220328   0.00039417  0.00061754 -0.00120785 -0.00488002]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0220328   0.00039417  0.00061754 -0.00120785 -0.00488002]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-3.6714908e-02  1.8943372e-04 -7.8636949e-05  2.7641442e-04
  1.2109225e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.9298511   0.00626862 -0.00200661  0.00820252  0.0263717 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.9298511   0.00626862 -0.00200661  0.00820252  0.0263717 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.29536718  0.13651837 -0.73344547  0.39815903 -0.21944699]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.29536718  0.13651837 -0.73344547  0.39815903 -0.21944699]
  [Layer 15] Output shape after mixer: (1, 1, 2048)
  [Layer 15] Output sample values after mixer: [-0.29536718  0.13651837 -0.73344547  0.39815903 -0.21944699]
  [Layer 15] Residual connection shape: (1, 1, 2048)
  [Layer 15] Residual connection sample values: [-0.12225282  0.19018829 -1.0536128   0.9326157  -0.77611196]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.0181695   0.02363184 -0.14345953  0.11631581 -0.11080007]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.0181695   0.02363184 -0.14345953  0.11631581 -0.11080007]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.0181695   0.02363184 -0.14345953  0.11631581 -0.11080007]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.4957217  -0.33164904 -0.66913545  0.21596463  0.27336028]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.4957217  -0.33164904 -0.66913545  0.21596463  0.27336028]
  [FlaxMamba2] xBC (step) sample values: [ 0.28637996 -0.577416   -0.67042285 -0.13433003 -0.966224  ]
  [FlaxMamba2] dt (step) sample values: [1.3481332 2.3459897 1.6634729 1.3945241 2.0550144]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -0.84037113  0.84651667  0.28637996  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12278894 -0.23149785 -0.15901223 -0.15848938 -0.2437535 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.08665612 -0.27263555 -0.17214242 -0.2508966  -0.28583723]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.04520421 -0.11784949 -0.07868119 -0.10979306 -0.12263082]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04520421 -0.11784949 -0.07868119 -0.10979306 -0.12263082]
  [FlaxMamba2] B (step) sample values: [ 0.04221068 -0.15235615  0.04667849 -0.01297125 -0.20098084]
  [FlaxMamba2] C (step) sample values: [-0.2740237  -0.07961839  0.0189269   0.89890474 -0.1471347 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6905513  -0.13480766 -1.3128716  -3.7739606  -1.2635014 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.20400935 0.55000174 0.23411119 0.26801944 0.16916916]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.5775862  0.92853755 0.7353873  0.36367497 0.8075539 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04520421 -0.11784949 -0.07868119 -0.10979306 -0.12263082]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00038927 -0.00140504  0.00043047 -0.00011962 -0.00185346]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00038927 -0.00140504  0.00043047 -0.00011962 -0.00185346]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00102441 -0.00280763  0.00044283  0.00037214  0.00121482]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00597928 -0.04157055 -0.01587693 -0.04204535 -0.03072022]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03507177 -0.11741602 -0.06651449 -0.11270587 -0.10964286]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03507177 -0.11741602 -0.06651449 -0.11270587 -0.10964286]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00960312  0.01627105  0.01507417 -0.01347933 -0.01702163]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.03855813  0.05128181  0.0569379  -0.0453619  -0.05884079]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03855813  0.05128181  0.0569379  -0.0453619  -0.05884079]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.1311679  -0.63187426 -0.46093267  0.06964146  0.54477423]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.1311679  -0.63187426 -0.46093267  0.06964146  0.54477423]
  [Layer 16] Output shape after mixer: (1, 1, 2048)
  [Layer 16] Output sample values after mixer: [ 1.1311679  -0.63187426 -0.46093267  0.06964146  0.54477423]
  [Layer 16] Residual connection shape: (1, 1, 2048)
  [Layer 16] Residual connection sample values: [ 1.0089151  -0.44168597 -1.5145454   1.0022571  -0.23133773]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13534124 -0.04978655 -0.18097964  0.1107669  -0.02985739]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13534124 -0.04978655 -0.18097964  0.1107669  -0.02985739]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13534124 -0.04978655 -0.18097964  0.1107669  -0.02985739]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.5495418  -0.28247082  0.11763681 -1.285451    0.0644023 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.5495418  -0.28247082  0.11763681 -1.285451    0.0644023 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.16870886 -0.37608033  0.4940663  -1.7230572   0.23365298]
  [FlaxMamba2] dt (step) sample values: [ 0.7777929  -0.35020697 -0.46074775  1.9189801   0.9747996 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -0.8958114  -0.6821835   0.16870886  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00194437  0.06057859 -0.12779275  0.14858638 -0.04076171]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.03374369  0.03437925 -0.14215127  0.14318477 -0.02812743]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01658721  0.01748508 -0.06603238  0.07670911 -0.01386594]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01658721  0.01748508 -0.06603238  0.07670911 -0.01386594]
  [FlaxMamba2] B (step) sample values: [ 0.04220103 -0.03836209 -0.13791221  0.18631446  0.0967984 ]
  [FlaxMamba2] C (step) sample values: [-0.00420291 -0.19961245 -0.1392738   0.6470297   0.00613214]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.1570504  -11.466768   -14.214988    -0.12863436 -14.242779  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00111714 0.00724062 0.01368008 0.14048803 0.01861586]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99870825 0.9203267  0.8232773  0.9820907  0.76709735]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01658721  0.01748508 -0.06603238  0.07670911 -0.01386594]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.8199429e-07  7.1085799e-07  2.5555437e-06 -3.4524480e-06
 -1.7936956e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.8199429e-07  7.1085799e-07  2.5555437e-06 -3.4524480e-06
 -1.7936956e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.0287054e-05  1.3065207e-05  4.2555759e-05 -1.7535890e-04
 -6.5419472e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-2.5316799e-04 -5.2203090e-05 -3.1134344e-04  1.6370334e-04
  5.7100013e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01095118  0.01122489 -0.04289927  0.04963763 -0.00888581]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01095118  0.01122489 -0.04289927  0.04963763 -0.00888581]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00220246 -0.00136292 -0.00267151 -0.01382206 -0.00029534]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01902491 -0.01437929 -0.02139301 -0.13478914 -0.00289135]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01902491 -0.01437929 -0.02139301 -0.13478914 -0.00289135]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.3120222  -0.36837807 -0.841107    0.36495927 -0.43978256]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.3120222  -0.36837807 -0.841107    0.36495927 -0.43978256]
  [Layer 17] Output shape after mixer: (1, 1, 2048)
  [Layer 17] Output sample values after mixer: [-0.3120222  -0.36837807 -0.841107    0.36495927 -0.43978256]
  [Layer 17] Residual connection shape: (1, 1, 2048)
  [Layer 17] Residual connection sample values: [ 0.69689286 -0.8100641  -2.3556523   1.3672163  -0.6711203 ]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07600378 -0.07470188 -0.22973299  0.12513451 -0.07035406]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07600378 -0.07470188 -0.22973299  0.12513451 -0.07035406]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07600378 -0.07470188 -0.22973299  0.12513451 -0.07035406]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.45308757 -1.2438822  -0.35503495 -1.0437666  -0.1651197 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.45308757 -1.2438822  -0.35503495 -1.0437666  -0.1651197 ]
  [FlaxMamba2] xBC (step) sample values: [-0.58373916  0.01675333  0.40035084 -0.6535345   0.01880687]
  [FlaxMamba2] dt (step) sample values: [1.396531  1.6150444 1.2907606 1.9755652 1.9114847]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -0.1965181   0.4484295  -0.58373916  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01581749 -0.00151908  0.09282086 -0.38199663 -0.14732713]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02582726 -0.26689994  0.372606   -0.39582872 -0.18941087]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01274688 -0.11574606  0.22061574 -0.15924782 -0.08576304]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01274688 -0.11574606  0.22061574 -0.15924782 -0.08576304]
  [FlaxMamba2] B (step) sample values: [ 0.1275621  -0.05779447 -0.06484251  0.25108883  0.07257365]
  [FlaxMamba2] C (step) sample values: [-0.27732432  0.0538619  -0.26225966  0.05034401  0.19711635]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3010656 -1.4685526 -1.2082934 -1.2128745 -2.5874777]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.34049043 0.24842867 0.24457423 0.44143957 0.25927675]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.64210695 0.69431424 0.74414647 0.5854287  0.5112622 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01274688 -0.11574606  0.22061574 -0.15924782 -0.08576304]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00055364  0.00025084  0.00028143 -0.00108977 -0.00031498]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00055364  0.00025084  0.00028143 -0.00108977 -0.00031498]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00063972  0.00017267  0.0010721  -0.00113979 -0.00054803]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00482993 -0.13301763  0.1588084  -0.04695136  0.05785429]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00729311 -0.15538421  0.20143983 -0.07772414  0.04128159]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00729311 -0.15538421  0.20143983 -0.07772414  0.04128159]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00128419  0.04324844 -0.02947708  0.02112711 -0.00312746]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00913997  0.12641501 -0.15672117  0.14452454 -0.03367151]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00913997  0.12641501 -0.15672117  0.14452454 -0.03367151]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.1299236   0.3443418  -0.19177355  0.55383366 -0.04953995]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.1299236   0.3443418  -0.19177355  0.55383366 -0.04953995]
  [Layer 18] Output shape after mixer: (1, 1, 2048)
  [Layer 18] Output sample values after mixer: [-0.1299236   0.3443418  -0.19177355  0.55383366 -0.04953995]
  [Layer 18] Residual connection shape: (1, 1, 2048)
  [Layer 18] Residual connection sample values: [ 0.5669693  -0.46572226 -2.547426    1.9210501  -0.7206602 ]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04808749 -0.03409969 -0.2016765   0.1400741  -0.06099152]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.04808749 -0.03409969 -0.2016765   0.1400741  -0.06099152]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.04808749 -0.03409969 -0.2016765   0.1400741  -0.06099152]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.52102584  0.2720326   0.06288275  1.1644709   0.07473232]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.52102584  0.2720326   0.06288275  1.1644709   0.07473232]
  [FlaxMamba2] xBC (step) sample values: [-0.13948123 -0.20575929 -0.3274226   0.81541586  0.17552733]
  [FlaxMamba2] dt (step) sample values: [1.4925215 2.2219393 2.384824  2.2396855 1.518267 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -0.26901987 -0.9309372  -0.13948123  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.19326068 -0.09198909 -0.10041813  0.21285956 -0.03012577]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.22890522 -0.11632685 -0.1054192   0.17025702 -0.06308476]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.10141011 -0.05478425 -0.04993387  0.09235791 -0.03054779]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.10141011 -0.05478425 -0.04993387  0.09235791 -0.03054779]
  [FlaxMamba2] B (step) sample values: [ 0.14246166 -0.17722851 -0.09466113  0.1147476   0.01879863]
  [FlaxMamba2] C (step) sample values: [-0.12981692 -0.03238757 -0.00433292  0.10704039 -0.18849877]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9436172 -1.8178532 -2.0862153 -1.0006425 -0.9649832]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.2223455  0.2386068  0.22621405 0.40132242 0.29351476]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.64910907 0.6480729  0.6237964  0.6692616  0.7533413 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.10141011 -0.05478425 -0.04993387  0.09235791 -0.03054779]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00321224  0.00399616  0.00213443 -0.00258734 -0.00042387]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00321224  0.00399616  0.00213443 -0.00258734 -0.00042387]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.3260291e-03  6.1718863e-03  1.6245991e-05 -4.6097459e-03
 -2.3556572e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01143971 -0.00680354 -0.00330673  0.01352351 -0.00336808]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02284689 -0.01296598 -0.00892357  0.02391245 -0.00680426]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02284689 -0.01296598 -0.00892357  0.02391245 -0.00680426]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00443551 -0.00200199 -0.00028939  0.02122217 -0.00026375]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.12617409 -0.05984746 -0.01109795  0.5954034  -0.01052665]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.12617409 -0.05984746 -0.01109795  0.5954034  -0.01052665]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.8516029 -0.2958623 -1.7036198  0.3808604 -0.8233425]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.8516029 -0.2958623 -1.7036198  0.3808604 -0.8233425]
  [Layer 19] Output shape after mixer: (1, 1, 2048)
  [Layer 19] Output sample values after mixer: [ 0.8516029 -0.2958623 -1.7036198  0.3808604 -0.8233425]
  [Layer 19] Residual connection shape: (1, 1, 2048)
  [Layer 19] Residual connection sample values: [ 1.4185722 -0.7615845 -4.2510457  2.3019104 -1.5440028]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.12387885 -0.05701154 -0.3407424   0.17066815 -0.13074385]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12387885 -0.05701154 -0.3407424   0.17066815 -0.13074385]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12387885 -0.05701154 -0.3407424   0.17066815 -0.13074385]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.39663327 -0.62346685 -0.8584671   0.5120874  -0.7068277 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.39663327 -0.62346685 -0.8584671   0.5120874  -0.7068277 ]
  [FlaxMamba2] xBC (step) sample values: [-1.2217442   0.2839764  -0.18318777 -0.5207651   0.6880342 ]
  [FlaxMamba2] dt (step) sample values: [1.383821  1.8944504 2.419806  1.0937395 1.3856355]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.5821599  -0.54123527 -1.2217442   0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.09060682  0.18012033  0.01189034 -0.0186578  -0.00253674]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.05212416  0.18865     0.07841866 -0.03745663 -0.02998731]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02674116  0.10319591  0.04074591 -0.01837761 -0.01476886]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02674116  0.10319591  0.04074591 -0.01837761 -0.01476886]
  [FlaxMamba2] B (step) sample values: [-0.10952058  0.00366268  0.17254478 -0.21189982  0.22700463]
  [FlaxMamba2] C (step) sample values: [ 0.17903265 -0.19552398  0.01691651 -0.00499452  0.69456863]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.6215758 -5.0388985 -1.2056414 -1.6434968 -1.3345234]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11189163 0.07316688 0.09422665 0.131664   0.11565711]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.83406764 0.69164634 0.89261174 0.80542165 0.8569745 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02674116  0.10319591  0.04074591 -0.01837761 -0.01476886]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.2769778e-04  1.0959145e-05  5.1627320e-04 -6.3402788e-04
  6.7922316e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.2769778e-04  1.0959145e-05  5.1627320e-04 -6.3402788e-04
  6.7922316e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00177704 -0.00019233 -0.00232637 -0.00045005 -0.00142399]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00754556  0.0057235   0.00697403 -0.01041484 -0.00941686]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00733251  0.00654565  0.00729865 -0.01056126 -0.00953452]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00733251  0.00654565  0.00729865 -0.01056126 -0.00953452]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0011695  -0.00142424 -0.00186503 -0.00338178  0.00222598]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.02091014 -0.02727711 -0.04795174 -0.06578822  0.03869001]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02091014 -0.02727711 -0.04795174 -0.06578822  0.03869001]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.18163209 -1.428804    0.18850619  0.93404263 -0.58710605]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.18163209 -1.428804    0.18850619  0.93404263 -0.58710605]
  [Layer 20] Output shape after mixer: (1, 1, 2048)
  [Layer 20] Output sample values after mixer: [ 0.18163209 -1.428804    0.18850619  0.93404263 -0.58710605]
  [Layer 20] Residual connection shape: (1, 1, 2048)
  [Layer 20] Residual connection sample values: [ 1.6002042 -2.1903887 -4.0625396  3.235953  -2.1311088]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0907646  -0.11275759 -0.19838837  0.1523686  -0.11302733]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0907646  -0.11275759 -0.19838837  0.1523686  -0.11302733]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0907646  -0.11275759 -0.19838837  0.1523686  -0.11302733]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.47134617 -0.337472   -0.4071868   0.16385196 -1.0740962 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.47134617 -0.337472   -0.4071868   0.16385196 -1.0740962 ]
  [FlaxMamba2] xBC (step) sample values: [-0.43140212  0.13110547 -0.29250142 -0.4351154   0.39543194]
  [FlaxMamba2] dt (step) sample values: [0.6804263 2.0218115 1.2528515 1.3971815 1.1162549]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -0.53410375  0.12420539 -0.43140212  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06780681  0.0650725   0.04389175  0.07551892 -0.05567873]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03652629  0.03498217  0.05874618  0.07043774 -0.02778566]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01859665  0.01779699  0.03023562  0.03645873 -0.01369983]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01859665  0.01779699  0.03023562  0.03645873 -0.01369983]
  [FlaxMamba2] B (step) sample values: [-0.06250141 -0.13367006  0.03303385 -0.02391455 -0.02485512]
  [FlaxMamba2] C (step) sample values: [-0.0162997  -0.08943675 -0.04747682 -0.00766597  0.00857919]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.2091806  -0.04342505 -3.8147197  -6.662431   -0.02279418]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11206996 0.03158851 0.10160501 0.09429979 0.02376829]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.69791865 0.9986292  0.6786874  0.5335162  0.9994584 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01859665  0.01779699  0.03023562  0.03645873 -0.01369983]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.3026081e-04 -2.7858524e-04  6.8846712e-05 -4.9840939e-05
 -5.1801198e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.3026081e-04 -2.7858524e-04  6.8846712e-05 -4.9840939e-05
 -5.1801198e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.4949671e-04 -1.9720790e-04  6.6296394e-05 -7.6710734e-05
  1.5907997e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00021514  0.00088983  0.00083124  0.00086116 -0.000288  ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00347945  0.00401377  0.00613856  0.00726082 -0.00269276]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00347945  0.00401377  0.00613856  0.00726082 -0.00269276]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00063026 -0.00056406 -0.00099878  0.00064348  0.00073645]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.06017175 -0.04945064 -0.11638231  0.06323358  0.06505153]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.06017175 -0.04945064 -0.11638231  0.06323358  0.06505153]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [1.0338221  0.3633729  0.9031727  0.70786655 0.3019628 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [1.0338221  0.3633729  0.9031727  0.70786655 0.3019628 ]
  [Layer 21] Output shape after mixer: (1, 1, 2048)
  [Layer 21] Output sample values after mixer: [1.0338221  0.3633729  0.9031727  0.70786655 0.3019628 ]
  [Layer 21] Residual connection shape: (1, 1, 2048)
  [Layer 21] Residual connection sample values: [ 2.6340263 -1.8270158 -3.1593668  3.9438195 -1.8291459]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.21557379 -0.12593786 -0.23078176  0.26552898 -0.14034948]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.21557379 -0.12593786 -0.23078176  0.26552898 -0.14034948]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.21557379 -0.12593786 -0.23078176  0.26552898 -0.14034948]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.18586136  0.23226015  0.05081716 -0.1821517   0.04097696]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.18586136  0.23226015  0.05081716 -0.1821517   0.04097696]
  [FlaxMamba2] xBC (step) sample values: [-0.03855772  0.9738134  -1.0977613  -0.62986076  0.04908377]
  [FlaxMamba2] dt (step) sample values: [3.2423692 1.9755571 1.1508888 1.3691972 1.5263171]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -0.8759526  -0.95520175 -0.03855772  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.42921886  0.22580239 -0.16302451  0.12039346  0.00107386]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.47688732  0.14706704  0.15631142  0.07940836 -0.06459997]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.18264182  0.07893098  0.08425162  0.04127977 -0.03125706]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.18264182  0.07893098  0.08425162  0.04127977 -0.03125706]
  [FlaxMamba2] B (step) sample values: [-0.02392575  0.02183259 -0.0058268   0.06578715 -0.02708187]
  [FlaxMamba2] C (step) sample values: [ 0.04664336 -0.02310759 -0.08481539 -0.00153972 -0.04911758]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.1489344 -3.5005836 -2.8320918 -5.5395546 -1.7185895]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03352269 0.26097894 0.1850375  0.16973591 0.01309264]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.87015545 0.40108633 0.59212166 0.39052576 0.97775036]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.18264182  0.07893098  0.08425162  0.04127977 -0.03125706]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.4648885e-04 -1.3367321e-04  3.5675435e-05 -4.0279134e-04
  1.6581264e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.4648885e-04 -1.3367321e-04  3.5675435e-05 -4.0279134e-04
  1.6581264e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.2584642e-04 -1.4554478e-04 -8.2565966e-06 -2.8768313e-04
  1.0207782e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00271002  0.00113526  0.00185764  0.00081509 -0.00050507]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04694533  0.02025211  0.02226313  0.01081293 -0.00807543]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04694533  0.02025211  0.02226313  0.01081293 -0.00807543]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00476692  0.00262378  0.00058004 -0.00089535 -0.00016884]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.03788592  0.05870624  0.00740169 -0.0281091  -0.00348069]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03788592  0.05870624  0.00740169 -0.0281091  -0.00348069]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.3545122  -0.29965308 -1.9862818  -1.4245694   0.6907594 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.3545122  -0.29965308 -1.9862818  -1.4245694   0.6907594 ]
  [Layer 22] Output shape after mixer: (1, 1, 2048)
  [Layer 22] Output sample values after mixer: [ 0.3545122  -0.29965308 -1.9862818  -1.4245694   0.6907594 ]
  [Layer 22] Residual connection shape: (1, 1, 2048)
  [Layer 22] Residual connection sample values: [ 2.9885385 -2.126669  -5.1456485  2.5192502 -1.1383865]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.1582046  -0.09686104 -0.24937062  0.1153454  -0.05839815]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1582046  -0.09686104 -0.24937062  0.1153454  -0.05839815]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1582046  -0.09686104 -0.24937062  0.1153454  -0.05839815]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.16440928  0.05915176  0.22626208  0.93353504 -0.35318998]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.16440928  0.05915176  0.22626208  0.93353504 -0.35318998]
  [FlaxMamba2] xBC (step) sample values: [-0.2821976   0.23103666 -0.14615464 -0.0115468  -0.01049865]
  [FlaxMamba2] dt (step) sample values: [1.9847512  0.48850474 1.7770793  1.962367   1.9769841 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -0.23471718  0.12287944 -0.2821976   0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.11140934 -0.03512314 -0.05676229  0.01611868 -0.05061431]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.13377872 -0.06823471 -0.06811483  0.01395765 -0.09999175]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06242183 -0.03295381 -0.03289796  0.00702753 -0.04749838]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06242183 -0.03295381 -0.03289796  0.00702753 -0.04749838]
  [FlaxMamba2] B (step) sample values: [-0.03247626 -0.05325296  0.07404356 -0.01040857 -0.00209905]
  [FlaxMamba2] C (step) sample values: [-0.03588195 -0.03234872  0.17625958 -0.04517214  0.01085992]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.08112868 -3.7998476  -0.08256738 -0.48783726 -1.4532163 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08317472 0.06929451 0.05987434 0.01031614 0.00746266]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99327487 0.76850474 0.99506855 0.99498004 0.9892137 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06242183 -0.03295381 -0.03289796  0.00702753 -0.04749838]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.6861412e-04  2.7648502e-04 -3.8442816e-04  5.4040447e-05
  1.0898113e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.6861412e-04  2.7648502e-04 -3.8442816e-04  5.4040447e-05
  1.0898113e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.7135601e-04  2.8082434e-04 -3.9811415e-04  5.1861549e-05
 -6.6577253e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.4376394e-03  6.9998401e-05 -7.6556869e-04 -2.4148845e-04
 -4.3375237e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-1.05984276e-04  7.73007399e-04 -6.37512421e-05 -3.91407870e-04
  5.79538115e-04]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-1.05984276e-04  7.73007399e-04 -6.37512421e-05 -3.91407870e-04
  5.79538115e-04]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 7.9978081e-06  2.3538350e-05 -8.0247100e-06 -2.6227609e-04
 -8.4455736e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.002096    0.00078259 -0.00046857 -0.02456978 -0.02318186]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.002096    0.00078259 -0.00046857 -0.02456978 -0.02318186]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.02232404  0.6790654  -1.9082543  -0.4705015  -0.25776428]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.02232404  0.6790654  -1.9082543  -0.4705015  -0.25776428]
  [Layer 23] Output shape after mixer: (1, 1, 2048)
  [Layer 23] Output sample values after mixer: [-0.02232404  0.6790654  -1.9082543  -0.4705015  -0.25776428]
  [Layer 23] Residual connection shape: (1, 1, 2048)
  [Layer 23] Residual connection sample values: [ 2.9662144 -1.4476035 -7.0539026  2.0487487 -1.3961508]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.11550593 -0.05378464 -0.25326246  0.0709597  -0.05272087]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11550593 -0.05378464 -0.25326246  0.0709597  -0.05272087]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11550593 -0.05378464 -0.25326246  0.0709597  -0.05272087]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.35301635 -0.31764022  0.4048613   0.22277264 -0.0869436 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.35301635 -0.31764022  0.4048613   0.22277264 -0.0869436 ]
  [FlaxMamba2] xBC (step) sample values: [-1.2937313e-01  2.4059033e-01 -3.2199201e-05  1.8659765e-02
  2.4709043e-01]
  [FlaxMamba2] dt (step) sample values: [1.0846852 1.2064093 1.1676557 2.5763726 1.9354088]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.47222868  0.75474715 -0.12937313  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.0461244  -0.06628881  0.00822604  0.0191063   0.11985076]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04277891 -0.06629793  0.00426639  0.01748887  0.11511672]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02184689 -0.03205052  0.00213774  0.0088209   0.06086767]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02184689 -0.03205052  0.00213774  0.0088209   0.06086767]
  [FlaxMamba2] B (step) sample values: [-0.01338754 -0.03541505  0.10808034 -0.02321056 -0.02081258]
  [FlaxMamba2] C (step) sample values: [-0.02088284 -0.12981264 -0.26312602 -0.20137979  0.47109336]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.07415762 -3.4496791  -3.2884939  -0.16087165 -2.6944954 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0162016  0.09400577 0.14005907 0.05866478 0.14084978]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99879926 0.7230407  0.63091546 0.9906069  0.6841904 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02184689 -0.03205052  0.00213774  0.0088209   0.06086767]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.7385834e-06 -1.2535321e-05  3.8255541e-05 -8.2154866e-06
 -7.3667093e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.7385834e-06 -1.2535321e-05  3.8255541e-05 -8.2154866e-06
 -7.3667093e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-8.4226464e-05  3.5486955e-04  1.7295430e-04  3.0293751e-05
  2.6747311e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0013155  -0.00043077 -0.0003936  -0.00069414 -0.00054083]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0014318  -0.00026014 -0.00040498 -0.0007411  -0.00086486]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0014318  -0.00026014 -0.00040498 -0.0007411  -0.00086486]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-2.9687554e-04  3.4808541e-05 -9.8353798e-05 -9.1704809e-05
  3.5963807e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.02400543  0.00398727 -0.01017415 -0.03460717  0.00802902]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02400543  0.00398727 -0.01017415 -0.03460717  0.00802902]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.5546558  -0.52583754 -0.4577714  -0.49281776 -0.9916482 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.5546558  -0.52583754 -0.4577714  -0.49281776 -0.9916482 ]
  [Layer 24] Output shape after mixer: (1, 1, 2048)
  [Layer 24] Output sample values after mixer: [ 0.5546558  -0.52583754 -0.4577714  -0.49281776 -0.9916482 ]
  [Layer 24] Residual connection shape: (1, 1, 2048)
  [Layer 24] Residual connection sample values: [ 3.5208702 -1.973441  -7.511674   1.555931  -2.387799 ]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13490386 -0.06911097 -0.2717845   0.05263417 -0.09051559]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13490386 -0.06911097 -0.2717845   0.05263417 -0.09051559]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13490386 -0.06911097 -0.2717845   0.05263417 -0.09051559]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.06534896 -0.64292705  1.0865705   0.3422105  -0.17022695]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.06534896 -0.64292705  1.0865705   0.3422105  -0.17022695]
  [FlaxMamba2] xBC (step) sample values: [ 0.30831322  0.18001933 -0.7194122   0.03530153 -0.41121727]
  [FlaxMamba2] dt (step) sample values: [1.975682   0.02906135 2.873606   2.9823544  1.5729371 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -0.66385597  0.2826066   0.30831322  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02584357 -0.0102184   0.09852568 -0.04620164  0.18630148]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02839751 -0.0384319   0.08711211  0.01461989  0.18053748]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01399716 -0.01884674  0.04545198  0.00736338  0.09839512]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01399716 -0.01884674  0.04545198  0.00736338  0.09839512]
  [FlaxMamba2] B (step) sample values: [ 0.0390449  -0.11391434  0.06935028  0.00653784  0.04020176]
  [FlaxMamba2] C (step) sample values: [ 0.12880625  0.04254828  0.14781505  0.06609524 -0.00800423]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -0.37022203  -1.5044799   -5.7209826   -0.81757224 -14.66622   ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.72292256 0.00657154 0.38517362 0.13045743 0.14831915]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7651818  0.99016196 0.11040813 0.8988327  0.1135762 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01399716 -0.01884674  0.04545198  0.00736338  0.09839512]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.9509006e-04  1.1526837e-03 -7.0174609e-04 -6.6155539e-05
 -4.0679617e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.9509006e-04  1.1526837e-03 -7.0174609e-04 -6.6155539e-05
 -4.0679617e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.1338108e-04  1.1928107e-03 -1.7960286e-03  4.4102277e-04
 -4.5663211e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00262067 -0.00310767  0.00681932  0.0007376   0.01446154]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00276689 -0.00330456  0.00729415  0.00081452  0.01548946]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00276689 -0.00330456  0.00729415  0.00081452  0.01548946]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 8.7453896e-05  7.3210342e-04  5.9262593e-03  1.6298542e-04
 -1.2064220e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00739404  0.04228337  0.5525475   0.00906495 -0.14692721]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00739404  0.04228337  0.5525475   0.00906495 -0.14692721]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.940414   -0.12739605 -2.4801214   0.4868779  -1.6695288 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.940414   -0.12739605 -2.4801214   0.4868779  -1.6695288 ]
  [Layer 25] Output shape after mixer: (1, 1, 2048)
  [Layer 25] Output sample values after mixer: [-0.940414   -0.12739605 -2.4801214   0.4868779  -1.6695288 ]
  [Layer 25] Residual connection shape: (1, 1, 2048)
  [Layer 25] Residual connection sample values: [ 2.5804563 -2.100837  -9.991796   2.0428088 -4.0573277]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.11168621 -0.08413675 -0.4029001   0.0808055  -0.1717175 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11168621 -0.08413675 -0.4029001   0.0808055  -0.1717175 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11168621 -0.08413675 -0.4029001   0.0808055  -0.1717175 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.19825408  0.42589745 -0.8888654  -0.3101165   0.04640009]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.19825408  0.42589745 -0.8888654  -0.3101165   0.04640009]
  [FlaxMamba2] xBC (step) sample values: [-0.5563709  -0.50656563  0.274083    0.49582407 -1.0500044 ]
  [FlaxMamba2] dt (step) sample values: [1.9145888  2.082739   0.9099135  0.92234355 3.4771419 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.44917983  0.8613749  -0.5563709   0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.52715766  0.3100462  -0.02034492 -0.08364748  0.2919343 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.61565864  0.2539854   0.04380303 -0.1105945   0.30004436]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.21595424  0.14303371  0.02238111 -0.05224258  0.1723615 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.21595424  0.14303371  0.02238111 -0.05224258  0.1723615 ]
  [FlaxMamba2] B (step) sample values: [-0.03149268  0.07254717  0.08093763 -0.00969936  0.04501152]
  [FlaxMamba2] C (step) sample values: [-0.22586483 -0.04317217  0.08627069  0.01616726 -0.07397451]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9594627  -0.39448437 -0.84198165 -1.4275463  -0.14661841]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.33391923 0.65612686 0.14873213 0.25116453 0.3051051 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.72587097 0.77195287 0.8822942  0.6986894  0.9562518 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.21595424  0.14303371  0.02238111 -0.05224258  0.1723615 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00227098 -0.00523147 -0.00583652  0.00069943 -0.00324584]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00227098 -0.00523147 -0.00583652  0.00069943 -0.00324584]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00225999 -0.00519387 -0.00589966  0.00072171 -0.00325464]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01404248  0.01144632  0.00232057 -0.00317496  0.01431308]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04155176  0.02966664  0.00517158 -0.00982987  0.03626931]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04155176  0.02966664  0.00517158 -0.00982987  0.03626931]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00371194  0.0076428  -0.00133926  0.00128974  0.00086097]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.06625237  0.30293068 -0.04516966  0.06622697  0.03859743]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.06625237  0.30293068 -0.04516966  0.06622697  0.03859743]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.34788355 -1.413095   -0.842986   -0.02280419 -0.11403655]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.34788355 -1.413095   -0.842986   -0.02280419 -0.11403655]
  [Layer 26] Output shape after mixer: (1, 1, 2048)
  [Layer 26] Output sample values after mixer: [-0.34788355 -1.413095   -0.842986   -0.02280419 -0.11403655]
  [Layer 26] Residual connection shape: (1, 1, 2048)
  [Layer 26] Residual connection sample values: [  2.2325728  -3.513932  -10.834782    2.0200045  -4.1713643]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.09977296 -0.14329351 -0.47403294  0.08116175 -0.19392146]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09977296 -0.14329351 -0.47403294  0.08116175 -0.19392146]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09977296 -0.14329351 -0.47403294  0.08116175 -0.19392146]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.03494003 -0.6724767  -0.21019305  0.38366342 -0.0667736 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.03494003 -0.6724767  -0.21019305  0.38366342 -0.0667736 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.2306327  -0.94579154 -0.2548258   1.664465    0.09825613]
  [FlaxMamba2] dt (step) sample values: [1.8430458 1.1611893 1.5319742 2.2598064 2.0135784]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.71732396 -0.17093506  0.2306327   0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.02443448  0.10813038  0.0007906  -0.05366887  0.22202797]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00156649  0.07163136 -0.00921917 -0.25557315  0.19224282]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00078263  0.03709789 -0.00458833 -0.11154547  0.10533239]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00078263  0.03709789 -0.00458833 -0.11154547  0.10533239]
  [FlaxMamba2] B (step) sample values: [ 0.06436615 -0.00498197  0.0189954   0.00062643  0.0086398 ]
  [FlaxMamba2] C (step) sample values: [ 0.03343332 -0.22667326 -0.14037992 -0.23801818 -0.23378953]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3661706 -1.3799144 -1.8267511 -2.0408754 -2.3490334]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.24110866 0.14307263 0.20768894 0.1498549  0.29680914]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.71935844 0.8208392  0.68427455 0.736508   0.49797046]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00078263  0.03709789 -0.00458833 -0.11154547  0.10533239]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.2145860e-05  9.4009499e-07 -3.5844221e-06 -1.1820783e-07
 -1.6303256e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.2145860e-05  9.4009499e-07 -3.5844221e-06 -1.1820783e-07
 -1.6303256e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 3.3747920e-04 -1.6387019e-04  1.1089295e-03  6.3583786e-05
  7.5929915e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00346588  0.00106994 -0.00956875 -0.01501979  0.00530662]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00338673  0.00482187 -0.0100328  -0.02630104  0.0159595 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00338673  0.00482187 -0.0100328  -0.02630104  0.0159595 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-5.8132639e-05 -1.0958106e-03  9.4400329e-04 -6.0015353e-03
 -5.1505340e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00143139 -0.01961751  0.02918572 -0.16696022 -0.00881083]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00143139 -0.01961751  0.02918572 -0.16696022 -0.00881083]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.7509185   0.2399968  -0.06088199  0.928516    0.05889598]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.7509185   0.2399968  -0.06088199  0.928516    0.05889598]
  [Layer 27] Output shape after mixer: (1, 1, 2048)
  [Layer 27] Output sample values after mixer: [ 0.7509185   0.2399968  -0.06088199  0.928516    0.05889598]
  [Layer 27] Residual connection shape: (1, 1, 2048)
  [Layer 27] Residual connection sample values: [  2.9834914  -3.273935  -10.895663    2.9485204  -4.1124682]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.12123697 -0.12447945 -0.41852772  0.11008941 -0.16540568]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12123697 -0.12447945 -0.41852772  0.11008941 -0.16540568]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12123697 -0.12447945 -0.41852772  0.11008941 -0.16540568]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.3593784   1.5041736   0.8450601   1.1040821  -0.23411547]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.3593784   1.5041736   0.8450601   1.1040821  -0.23411547]
  [FlaxMamba2] xBC (step) sample values: [-0.68640137 -2.533607    0.23444223 -0.89170355 -0.52604085]
  [FlaxMamba2] dt (step) sample values: [1.419851   0.59112835 1.2033626  1.5696127  1.9636952 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.56419134 -1.2130473  -0.68640137  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.05391996  0.51092947  0.07171717 -0.17083097  0.06965115]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00384981  0.4995693   0.05805292 -0.18220639  0.17432645]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.0019212   0.310911    0.02986876 -0.08282629  0.09474147]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0019212   0.310911    0.02986876 -0.08282629  0.09474147]
  [FlaxMamba2] B (step) sample values: [ 0.06699933  0.01106434 -0.13950674  0.08757871  0.40396982]
  [FlaxMamba2] C (step) sample values: [-0.06357873 -0.13427196  0.45559984 -0.1272812   0.5132058 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2727895 -3.997792  -2.517685  -2.1714401 -2.8654757]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04146179 0.07810202 0.13290475 0.07972988 0.10388425]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9485961 0.731809  0.7156155 0.8410294 0.7425406]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0019212   0.310911    0.02986876 -0.08282629  0.09474147]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.3369272e-06 -8.8134584e-07  1.1112608e-05 -6.9762073e-06
 -3.2178792e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.3369272e-06 -8.8134584e-07  1.1112608e-05 -6.9762073e-06
 -3.2178792e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 3.3338707e-05 -2.0085201e-04 -2.1221809e-05  3.9404805e-04
  2.0495708e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00043541  0.00677624  0.0009804  -0.00240743  0.00292686]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 1.8948631e-05  7.4173242e-02  7.4551306e-03 -2.0361910e-02
  2.3464220e-02]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 1.8948631e-05  7.4173242e-02  7.4551306e-03 -2.0361910e-02
  2.3464220e-02]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-2.7995477e-06  9.1285683e-02  4.4070613e-03 -1.6883940e-02
 -2.4266103e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-1.5701658e-04  3.3931322e+00  1.5518470e-01 -6.8654567e-01
 -9.5719285e-02]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-1.5701658e-04  3.3931322e+00  1.5518470e-01 -6.8654567e-01
 -9.5719285e-02]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.15974833 -1.4753989  -3.6092107   2.4461985  -1.6055086 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.15974833 -1.4753989  -3.6092107   2.4461985  -1.6055086 ]
  [Layer 28] Output shape after mixer: (1, 1, 2048)
  [Layer 28] Output sample values after mixer: [ 0.15974833 -1.4753989  -3.6092107   2.4461985  -1.6055086 ]
  [Layer 28] Residual connection shape: (1, 1, 2048)
  [Layer 28] Residual connection sample values: [  3.1432397  -4.749334  -14.504874    5.394719   -5.7179766]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.10933925 -0.15800698 -0.48320436  0.17307702 -0.197772  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10933925 -0.15800698 -0.48320436  0.17307702 -0.197772  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10933925 -0.15800698 -0.48320436  0.17307702 -0.197772  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.30709732 -0.7980032   0.38074493 -0.5069937   0.17679165]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.30709732 -0.7980032   0.38074493 -0.5069937   0.17679165]
  [FlaxMamba2] xBC (step) sample values: [ 0.8002835   0.17185909  0.6837026  -1.1741261  -0.8644168 ]
  [FlaxMamba2] dt (step) sample values: [2.468934  1.3236173 1.5211015 2.9144611 1.736842 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.60593826 0.7516267  0.8002835  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.04885538 -0.03721646 -0.12134431  0.23122713 -0.08450739]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.06226023 -0.07173184 -0.11849664  0.17080233 -0.19760554]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03016134 -0.03458011 -0.05574206  0.09267684 -0.08907243]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03016134 -0.03458011 -0.05574206  0.09267684 -0.08907243]
  [FlaxMamba2] B (step) sample values: [ 0.03898215 -0.01669215 -0.02403287 -0.03156798  0.02235328]
  [FlaxMamba2] C (step) sample values: [-0.24496865 -0.27608576 -0.21188405 -0.27417186 -0.27289608]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8072329  -2.117      -1.925669   -0.29044876 -2.049864  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.22584432 0.17426117 0.2629228  0.02863811 0.3133999 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.66487694 0.691487   0.6027202  0.9917166  0.52601415]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03016134 -0.03458011 -0.05574206  0.09267684 -0.08907243]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00026554  0.0001137   0.00016371  0.00021503 -0.00015227]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00026554  0.0001137   0.00016371  0.00021503 -0.00015227]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00027429  0.00014441  0.00017687  0.0002696  -0.00020716]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00434702 -0.004666   -0.00804645  0.01315771 -0.01278304]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03518787 -0.04002517 -0.06504432  0.10792246 -0.10386218]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03518787 -0.04002517 -0.06504432  0.10792246 -0.10386218]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00622622  0.00991593 -0.01471189 -0.02056767 -0.00999044]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.05623064  0.0842761  -0.19811411 -0.24844332 -0.10706313]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.05623064  0.0842761  -0.19811411 -0.24844332 -0.10706313]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.4030354   0.5272414  -2.5584795  -1.9143243  -0.14887665]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.4030354   0.5272414  -2.5584795  -1.9143243  -0.14887665]
  [Layer 29] Output shape after mixer: (1, 1, 2048)
  [Layer 29] Output sample values after mixer: [-2.4030354   0.5272414  -2.5584795  -1.9143243  -0.14887665]
  [Layer 29] Residual connection shape: (1, 1, 2048)
  [Layer 29] Residual connection sample values: [  0.74020433  -4.2220926  -17.063354     3.4803948   -5.866853  ]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02513172 -0.14104868 -0.5660542   0.10888509 -0.20467615]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.02513172 -0.14104868 -0.5660542   0.10888509 -0.20467615]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.02513172 -0.14104868 -0.5660542   0.10888509 -0.20467615]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.96198684 -0.22036347 -1.2325379   0.2802675   0.11739133]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.96198684 -0.22036347 -1.2325379   0.2802675   0.11739133]
  [FlaxMamba2] xBC (step) sample values: [ 0.6973957  -0.6956271  -0.8760819  -0.04166809 -0.38258025]
  [FlaxMamba2] dt (step) sample values: [1.6463517 2.6562738 1.8556587 2.3757017 2.2897162]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         1.0781267  0.15517214 0.6973957  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.11114656 -0.09567627 -0.36196056  0.0167359   0.11129148]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.08786165 -0.08197387 -0.32881847 -0.0014068   0.08394773]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.0458595  -0.03930795 -0.13761978 -0.00070291  0.04373464]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0458595  -0.03930795 -0.13761978 -0.00070291  0.04373464]
  [FlaxMamba2] B (step) sample values: [ 0.10324574 -0.08460096 -0.01509999  0.25189292 -0.00998001]
  [FlaxMamba2] C (step) sample values: [-0.26192    -0.26928788 -0.22693178 -0.12207215  0.26757324]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0149885  -0.4675477  -0.42799968 -0.7895216  -0.4174731 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02049954 0.9415946  0.9980737  0.4795279  0.7322976 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.97940814 0.6438816  0.65234923 0.6848211  0.7365968 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0458595  -0.03930795 -0.13761978 -0.00070291  0.04373464]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.7061173e-05 -7.9533238e-05 -1.4195481e-05  2.3680419e-04
 -9.3821927e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.7061173e-05 -7.9533238e-05 -1.4195481e-05  2.3680419e-04
 -9.3821927e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.3244954e-04 -8.1442246e-05 -7.8847872e-05  4.9466506e-04
 -3.8192768e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 5.6285306e-04 -4.9793383e-04 -1.2433156e-03  5.1105886e-05
  8.8877400e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.05705828 -0.04892234 -0.17078042 -0.00081482  0.05476652]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.05705828 -0.04892234 -0.17078042 -0.00081482  0.05476652]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01517583  0.00479882  0.04751625 -0.00013008  0.00340302]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.18691356  0.05998821  0.3606036  -0.00133004  0.03092254]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.18691356  0.05998821  0.3606036  -0.00133004  0.03092254]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.04179897  0.53875405 -3.69707    -2.411664   -0.15755342]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.04179897  0.53875405 -3.69707    -2.411664   -0.15755342]
  [Layer 30] Output shape after mixer: (1, 1, 2048)
  [Layer 30] Output sample values after mixer: [ 0.04179897  0.53875405 -3.69707    -2.411664   -0.15755342]
  [Layer 30] Residual connection shape: (1, 1, 2048)
  [Layer 30] Residual connection sample values: [  0.7820033  -3.6833386 -20.760424    1.0687308  -6.0244064]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02476906 -0.11446305 -0.6470297   0.03241778 -0.19278112]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.02476906 -0.11446305 -0.6470297   0.03241778 -0.19278112]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.02476906 -0.11446305 -0.6470297   0.03241778 -0.19278112]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.35937637  0.51593846 -2.0327506   0.5458701   0.00769552]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.35937637  0.51593846 -2.0327506   0.5458701   0.00769552]
  [FlaxMamba2] xBC (step) sample values: [ 1.1247746  -0.76230335  0.80373716 -0.4311443  -0.62828   ]
  [FlaxMamba2] dt (step) sample values: [1.3651797 2.112201  2.3954058 1.215852  1.657018 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.5427158  -0.30198482  1.1247746   0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [0.19797668 0.10890888 0.04445231 0.07748863 0.10067839]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [0.19748124 0.09858631 0.04546702 0.07559082 0.09537596]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [0.10845877 0.05172101 0.02325023 0.03922322 0.0499604 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [0.10845877 0.05172101 0.02325023 0.03922322 0.0499604 ]
  [FlaxMamba2] B (step) sample values: [ 0.40941355  0.18364581  0.07260733 -0.2762924  -0.07884905]
  [FlaxMamba2] C (step) sample values: [-0.07356274 -0.17383236 -0.18996821 -0.12986578 -0.11208434]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.9477868 -3.5383902 -4.705952  -2.462968  -0.9027082]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.12347409 0.17387265 0.16093338 0.18878707 0.2008415 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6949084  0.540517   0.46890983 0.62814987 0.834184  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [0.10845877 0.05172101 0.02325023 0.03922322 0.0499604 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0054828   0.00245936  0.00097235 -0.00370007 -0.00105593]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0054828   0.00245936  0.00097235 -0.00370007 -0.00105593]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00521641  0.00262625  0.00067132 -0.00385021 -0.00106595]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [0.01115984 0.00559157 0.00150179 0.00684387 0.01454188]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [0.08578125 0.04117647 0.01749833 0.03383009 0.04891546]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [0.08578125 0.04117647 0.01749833 0.03383009 0.04891546]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01267362  0.01330327 -0.00411922  0.01169277  0.00018894]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.20798668  0.19071874 -0.05258568  0.15887778  0.00304226]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.20798668  0.19071874 -0.05258568  0.15887778  0.00304226]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.6008592  -2.5035079  -1.5857402  -0.2399377   0.70962554]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.6008592  -2.5035079  -1.5857402  -0.2399377   0.70962554]
  [Layer 31] Output shape after mixer: (1, 1, 2048)
  [Layer 31] Output sample values after mixer: [-0.6008592  -2.5035079  -1.5857402  -0.2399377   0.70962554]
  [Layer 31] Residual connection shape: (1, 1, 2048)
  [Layer 31] Residual connection sample values: [  0.18114406  -6.1868467  -22.346165     0.82879317  -5.3147807 ]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00555664 -0.19059968 -0.68658006  0.0238507  -0.16952185]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00555664 -0.19059968 -0.68658006  0.0238507  -0.16952185]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00555664 -0.19059968 -0.68658006  0.0238507  -0.16952185]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.14415662  0.02759056 -1.4149808  -2.0371532  -0.6696934 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.14415662  0.02759056 -1.4149808  -2.0371532  -0.6696934 ]
  [FlaxMamba2] xBC (step) sample values: [-0.927233   -0.02829227  0.7857852  -0.03565662  0.5693412 ]
  [FlaxMamba2] dt (step) sample values: [1.5474104 3.898985  1.8875964 1.5221939 1.7109827]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.04304145 -0.19561742 -0.927233    0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04697725 -0.31154802  0.02126908  0.01522995  0.21184081]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.08414766 -0.3635805   0.00543045  0.02771164  0.20486754]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.043843   -0.14910185  0.0027226   0.01404779  0.1128899 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.043843   -0.14910185  0.0027226   0.01404779  0.1128899 ]
  [FlaxMamba2] B (step) sample values: [ 0.00281148  0.05268545  0.01823365 -0.10352464  0.03017429]
  [FlaxMamba2] C (step) sample values: [-0.07838667 -0.25074586 -0.19591564 -0.27843937 -0.23110318]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6970906 -2.0892735 -1.7966746 -1.3893797 -1.0395182]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.32352602 0.23846063 0.59100395 0.3959571  0.66905314]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7980955  0.6076176  0.34581828 0.57687205 0.4988285 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.043843   -0.14910185  0.0027226   0.01404779  0.1128899 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.9879051e-05  7.4730889e-04  2.5863244e-04 -1.4684298e-03
  4.2800268e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.9879051e-05  7.4730889e-04  2.5863244e-04 -1.4684298e-03
  4.2800268e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 3.2169928e-04  1.1563902e-03  7.7910780e-04 -1.5503089e-03
  4.6825473e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00883106 -0.02019265 -0.00166855 -0.00614965  0.00984992]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01934794 -0.0559586  -0.00101546 -0.00277992  0.03692948]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01934794 -0.0559586  -0.00101546 -0.00277992  0.03692948]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00149491 -0.00078261  0.00028083  0.00065328 -0.00837321]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01409297 -0.00593494  0.00413606  0.00787519 -0.08255072]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01409297 -0.00593494  0.00413606  0.00787519 -0.08255072]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.10515248 -2.167972   -0.37174198 -2.460023    2.8200672 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.10515248 -2.167972   -0.37174198 -2.460023    2.8200672 ]
  [Layer 32] Output shape after mixer: (1, 1, 2048)
  [Layer 32] Output sample values after mixer: [ 0.10515248 -2.167972   -0.37174198 -2.460023    2.8200672 ]
  [Layer 32] Residual connection shape: (1, 1, 2048)
  [Layer 32] Residual connection sample values: [  0.28629655  -8.354818   -22.717907    -1.6312298   -2.4947135 ]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00735413 -0.22239481 -0.59444195 -0.04144563 -0.06637295]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00735413 -0.22239481 -0.59444195 -0.04144563 -0.06637295]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00735413 -0.22239481 -0.59444195 -0.04144563 -0.06637295]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.7503335   0.15748127 -0.97070646  0.22481647  0.30619362]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.7503335   0.15748127 -0.97070646  0.22481647  0.30619362]
  [FlaxMamba2] xBC (step) sample values: [-0.30283353 -1.5782133  -0.09564092 -0.7929955   0.9015643 ]
  [FlaxMamba2] dt (step) sample values: [-0.95948744  2.6922014   2.8782647   2.3548782  -0.61030906]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.5178368  -0.07010851 -0.30283353  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.0407776  -0.07581089  0.03591194 -0.12594464 -0.15447906]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.05392304 -0.12518834  0.06273689 -0.12715104 -0.15566829]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02623478 -0.05868125  0.0323521  -0.05953911 -0.0717882 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02623478 -0.05868125  0.0323521  -0.05953911 -0.0717882 ]
  [FlaxMamba2] B (step) sample values: [-0.23415945 -0.05792652 -0.00938119 -0.02161815  0.01084478]
  [FlaxMamba2] C (step) sample values: [ 0.00475788 -0.12102123 -0.17335586 -0.09763023 -0.02649715]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9790505  -9.693779   -6.1677613  -0.11351943 -2.090294  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00451998 0.13817376 0.20853321 0.08247687 0.00156065]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99109465 0.26199603 0.27632347 0.990681   0.9967431 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02623478 -0.05868125  0.0323521  -0.05953911 -0.0717882 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.7766768e-05  6.8689615e-06  1.1124272e-06  2.5634929e-06
 -1.2859807e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.7766768e-05  6.8689615e-06  1.1124272e-06  2.5634929e-06
 -1.2859807e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.7954063e-04 -1.1882818e-05 -1.9509922e-05 -1.1325360e-06
  6.9543566e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 6.0502098e-05  2.6161375e-04  4.2284944e-04 -9.2120681e-05
 -5.1228428e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02725702 -0.0608415   0.03411017 -0.06208849 -0.07526329]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02725702 -0.0608415   0.03411017 -0.06208849 -0.07526329]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00655991 -0.00516714 -0.0090969  -0.0077605  -0.01327298]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.11141903 -0.05230502 -0.11603239 -0.09667841 -0.1871354 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.11141903 -0.05230502 -0.11603239 -0.09667841 -0.1871354 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.4679332 -0.3447386 -1.2998856 -1.6553415 -0.956429 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.4679332 -0.3447386 -1.2998856 -1.6553415 -0.956429 ]
  [Layer 33] Output shape after mixer: (1, 1, 2048)
  [Layer 33] Output sample values after mixer: [ 2.4679332 -0.3447386 -1.2998856 -1.6553415 -0.956429 ]
  [Layer 33] Residual connection shape: (1, 1, 2048)
  [Layer 33] Residual connection sample values: [  2.7542298  -8.699557  -24.017792   -3.2865713  -3.4511425]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05675749 -0.18995444 -0.49463037 -0.06828561 -0.07458936]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05675749 -0.18995444 -0.49463037 -0.06828561 -0.07458936]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05675749 -0.18995444 -0.49463037 -0.06828561 -0.07458936]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.7765959   0.72855455  0.49542192 -0.76333994 -1.4690542 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.7765959   0.72855455  0.49542192 -0.76333994 -1.4690542 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.34320295 -0.36762506 -0.6552266  -0.6366468   0.41734788]
  [FlaxMamba2] dt (step) sample values: [1.204798  1.6474711 2.4522412 1.5477519 1.4382646]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.04098805 0.5417618  0.34320295 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.09279595  0.05728532 -0.09070282  0.16249117  0.08839262]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.12468681  0.08331681 -0.10264283  0.12297091  0.07985532]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.05846173  0.04339283 -0.04868983  0.06526116  0.04152103]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05846173  0.04339283 -0.04868983  0.06526116  0.04152103]
  [FlaxMamba2] B (step) sample values: [ 0.13617131  0.01262364 -0.01286907  0.08552751 -0.034999  ]
  [FlaxMamba2] C (step) sample values: [-0.04216566 -0.19886735 -0.26866728  0.01183021 -0.2596383 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.5610816  -2.4810736  -2.893596   -0.01585086 -0.02613366]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.16457346 0.15807046 0.10391039 0.06589125 0.03117962]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6560711  0.6755795  0.74031854 0.9989561  0.9991855 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05846173  0.04339283 -0.04868983  0.06526116  0.04152103]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00131014 -0.00012146  0.00012382 -0.00082288  0.00033673]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00131014 -0.00012146  0.00012382 -0.00082288  0.00033673]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.8363566e-03  8.0985476e-05  2.7012374e-04 -1.1591606e-03
  2.7828329e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-3.1883519e-03  1.5160829e-03 -8.9799876e-05  5.7272417e-03
  3.8287356e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03919746  0.0282436  -0.03007997  0.0459244   0.02940333]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03919746  0.0282436  -0.03007997  0.0459244   0.02940333]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02085016  0.01387894 -0.00926002 -0.01114504 -0.00808121]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.62784326  0.40644112 -0.31003413 -0.41958374 -0.28895462]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.62784326  0.40644112 -0.31003413 -0.41958374 -0.28895462]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.0321772   0.42316017 -2.1026676   2.2797754   0.39096588]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.0321772   0.42316017 -2.1026676   2.2797754   0.39096588]
  [Layer 34] Output shape after mixer: (1, 1, 2048)
  [Layer 34] Output sample values after mixer: [ 2.0321772   0.42316017 -2.1026676   2.2797754   0.39096588]
  [Layer 34] Residual connection shape: (1, 1, 2048)
  [Layer 34] Residual connection sample values: [  4.786407   -8.276397  -26.120459   -1.0067959  -3.0601766]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.10620259 -0.18329298 -0.5691722  -0.02057777 -0.06719506]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10620259 -0.18329298 -0.5691722  -0.02057777 -0.06719506]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10620259 -0.18329298 -0.5691722  -0.02057777 -0.06719506]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-2.0850878  -2.2524734   0.41663867  1.5731044  -0.51278126]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-2.0850878  -2.2524734   0.41663867  1.5731044  -0.51278126]
  [FlaxMamba2] xBC (step) sample values: [-0.38777608  0.97738266  0.4450224  -1.4413723   0.5678955 ]
  [FlaxMamba2] dt (step) sample values: [4.2743835 2.7505538 2.358137  2.197777  2.093315 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -0.7414792  -0.08924146 -0.38777608  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.0626349  -0.23563117 -0.06820992 -0.28160137  0.10671772]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.09337096 -0.19449347 -0.10440376 -0.32655376  0.06524433]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04450753 -0.08781951 -0.04947932 -0.13685195  0.033686  ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04450753 -0.08781951 -0.04947932 -0.13685195  0.033686  ]
  [FlaxMamba2] B (step) sample values: [ 0.19824405  0.10877439 -0.26174912  0.25287178  0.02728884]
  [FlaxMamba2] C (step) sample values: [-0.27710035  0.39500806 -0.17182045 -0.22340004 -0.04790094]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.709799  -2.7746034 -0.4452666 -1.139112  -3.5906036]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.5046687  0.23763451 1.0320308  0.4824382  0.19294795]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.69892395 0.51719177 0.6315811  0.5772089  0.5001738 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04450753 -0.08781951 -0.04947932 -0.13685195  0.033686  ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00445287 -0.00244324  0.00587929 -0.00567989 -0.00061295]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00445287 -0.00244324  0.00587929 -0.00567989 -0.00061295]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-5.4718400e-03 -6.0250042e-03  1.2111118e-02 -1.2076531e-02
 -4.2660977e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01800785 -0.01629179 -0.01290396 -0.01632242  0.00755835]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04810956 -0.07568663 -0.04636823 -0.10887929  0.03034115]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04810956 -0.07568663 -0.04636823 -0.10887929  0.03034115]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01109003  0.01621904 -0.01164303 -0.14185725 -0.00582726]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.23168111  0.18025722 -0.09143084 -1.287682   -0.07102532]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.23168111  0.18025722 -0.09143084 -1.287682   -0.07102532]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.4403484  1.5609688 -3.2796314  0.9426596  2.2003522]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.4403484  1.5609688 -3.2796314  0.9426596  2.2003522]
  [Layer 35] Output shape after mixer: (1, 1, 2048)
  [Layer 35] Output sample values after mixer: [ 2.4403484  1.5609688 -3.2796314  0.9426596  2.2003522]
  [Layer 35] Residual connection shape: (1, 1, 2048)
  [Layer 35] Residual connection sample values: [  7.226755    -6.715428   -29.40009     -0.06413627  -0.8598244 ]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13233618 -0.12450227 -0.5346239  -0.00115869 -0.01612109]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13233618 -0.12450227 -0.5346239  -0.00115869 -0.01612109]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13233618 -0.12450227 -0.5346239  -0.00115869 -0.01612109]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.5490445  -0.37365934  0.01401755 -1.4788489  -0.39004567]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.5490445  -0.37365934  0.01401755 -1.4788489  -0.39004567]
  [FlaxMamba2] xBC (step) sample values: [ 0.46189055  2.262598    0.5857619  -0.22124107  1.3922912 ]
  [FlaxMamba2] dt (step) sample values: [1.406766   2.7812717  2.024553   0.7608954  0.40115604]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         0.00556935 0.05992574 0.46189055 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.08562414  0.383168    0.02109551 -0.03748631 -0.2539827 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.12181799  0.38303426 -0.00739264 -0.06241917 -0.28184524]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.05720367  0.22775398 -0.00368266 -0.03023587 -0.12119387]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05720367  0.22775398 -0.00368266 -0.03023587 -0.12119387]
  [FlaxMamba2] B (step) sample values: [ 0.10479095  0.32536492  0.05260218 -0.11592435 -0.08290716]
  [FlaxMamba2] C (step) sample values: [-0.12982082 -0.27844477 -0.27810326 -0.07877406 -0.09169983]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6566098 -1.1305923 -1.6058172 -2.4414158 -2.882315 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.16380681 0.05788073 0.15274814 0.07678061 0.06061971]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.64715415 0.9366557  0.7824811  0.82906777 0.8396878 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05720367  0.22775398 -0.00368266 -0.03023587 -0.12119387]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00098193 -0.00304878 -0.0004929   0.00108625  0.00077687]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00098193 -0.00304878 -0.0004929   0.00108625  0.00077687]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00137407 -0.00445941 -0.00035072  0.00119751  0.00085116]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00087967  0.00046027 -0.00311523  0.00018462 -0.00037961]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.06642288  0.2614178  -0.00733477 -0.03445924 -0.13924195]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.06642288  0.2614178  -0.00733477 -0.03445924 -0.13924195]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 1.3350838e-02 -3.9820436e-02 -5.1768060e-05  9.4582457e-03
  2.1925580e-02]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 1.8893023e-01 -8.2203019e-01 -7.2186370e-04  1.4844027e-01
  2.9789513e-01]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 1.8893023e-01 -8.2203019e-01 -7.2186370e-04  1.4844027e-01
  2.9789513e-01]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.3598049  2.323808  -1.3410107 -4.3448806 -2.3040571]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.3598049  2.323808  -1.3410107 -4.3448806 -2.3040571]
  [Layer 36] Output shape after mixer: (1, 1, 2048)
  [Layer 36] Output sample values after mixer: [-1.3598049  2.323808  -1.3410107 -4.3448806 -2.3040571]
  [Layer 36] Residual connection shape: (1, 1, 2048)
  [Layer 36] Residual connection sample values: [  5.86695    -4.3916197 -30.7411     -4.4090166  -3.1638815]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.11534144 -0.08833296 -0.5971114  -0.08385913 -0.06267969]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11534144 -0.08833296 -0.5971114  -0.08385913 -0.06267969]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11534144 -0.08833296 -0.5971114  -0.08385913 -0.06267969]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.10231334  1.4374162   2.523859   -3.0027728  -0.29566583]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.10231334  1.4374162   2.523859   -3.0027728  -0.29566583]
  [FlaxMamba2] xBC (step) sample values: [-0.68881214  0.31732222 -0.48795542  0.02916471  0.35789576]
  [FlaxMamba2] dt (step) sample values: [2.0275297 1.0069598 3.0481632 2.986903  2.294319 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -0.05946744  0.12987068 -0.68881214  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.1382353  -0.04568943 -0.01551131 -0.16149373  0.10565688]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.1258528  -0.07413182 -0.01051024 -0.31237262  0.12039687]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.06688091 -0.03569266 -0.0052275  -0.13198858  0.06381792]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06688091 -0.03569266 -0.0052275  -0.13198858  0.06381792]
  [FlaxMamba2] B (step) sample values: [-0.01915741  0.07273412 -0.13998492  0.288076   -0.05571106]
  [FlaxMamba2] C (step) sample values: [-0.16697064 -0.07399304 -0.22555272 -0.24009791 -0.27836534]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.06064401 -3.2470093  -0.81907064 -0.24529998 -1.975189  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06916137 0.02648147 0.18124755 0.02450282 0.11008099]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99581456 0.9176075  0.8620392  0.99400747 0.8045833 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06688091 -0.03569266 -0.0052275  -0.13198858  0.06381792]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-8.8614048e-05  3.3643717e-04 -6.4751081e-04  1.3325174e-03
 -2.5769573e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-8.8614048e-05  3.3643717e-04 -6.4751081e-04  1.3325174e-03
 -2.5769573e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0001307  -0.00041965 -0.00081215  0.0006432  -0.00037367]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00080161 -0.00731594 -0.00595037  0.04338014  0.03750725]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01192589 -0.00052359 -0.00495557  0.0684977   0.02536264]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01192589 -0.00052359 -0.00495557  0.0684977   0.02536264]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00064127 -0.00060815 -0.01157909 -0.00972896 -0.00319915]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00475054 -0.00408896 -0.15342627 -0.2381513  -0.01750253]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00475054 -0.00408896 -0.15342627 -0.2381513  -0.01750253]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.0185208  -0.17663956 -4.21559     0.28208038 -0.24008964]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.0185208  -0.17663956 -4.21559     0.28208038 -0.24008964]
  [Layer 37] Output shape after mixer: (1, 1, 2048)
  [Layer 37] Output sample values after mixer: [ 1.0185208  -0.17663956 -4.21559     0.28208038 -0.24008964]
  [Layer 37] Residual connection shape: (1, 1, 2048)
  [Layer 37] Residual connection sample values: [  6.885471   -4.5682592 -34.95669    -4.1269364  -3.4039712]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.11198768 -0.07374006 -0.56158805 -0.06468859 -0.05468566]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11198768 -0.07374006 -0.56158805 -0.06468859 -0.05468566]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11198768 -0.07374006 -0.56158805 -0.06468859 -0.05468566]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.22838545  0.34483635  0.8757431  -0.62970823 -1.2009319 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.22838545  0.34483635  0.8757431  -0.62970823 -1.2009319 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.9851128   1.5083833  -0.32678878 -1.09922     1.1871128 ]
  [FlaxMamba2] dt (step) sample values: [1.8259346 2.1809387 1.5606112 1.0097822 1.9488187]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -0.07999338  0.3685623   0.9851128   0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.17257747 -0.2834688   0.03832771  0.22786087  0.22673473]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.14448604 -0.32063922  0.01255561  0.21625656  0.20547923]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06703302 -0.1348352   0.00631722  0.11977465  0.11325806]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06703302 -0.1348352   0.00631722  0.11977465  0.11325806]
  [FlaxMamba2] B (step) sample values: [-0.24094427 -0.23398054 -0.02074525  0.00489974 -0.23405151]
  [FlaxMamba2] C (step) sample values: [-0.14942834 -0.17659777 -0.20647815  0.13136892 -0.27220482]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0881431 -1.3535548 -1.1764196 -1.6451025 -1.1940706]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.28591335 0.23860998 0.62624305 0.11158029 0.15115783]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7326299 0.7239944 0.4786792 0.8323011 0.8348584]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06703302 -0.1348352   0.00631722  0.11977465  0.11325806]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.6178498e-03  4.4843857e-03  3.9759584e-04 -9.3906667e-05
  4.4857459e-03]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.6178498e-03  4.4843857e-03  3.9759584e-04 -9.3906667e-05
  4.4857459e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00490586 0.00491832 0.00058614 0.00049777 0.00474876]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00765292 -0.01857153  0.00553465  0.02157488  0.0136678 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.06193785 -0.12776428  0.01065048  0.11857124  0.10538688]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.06193785 -0.12776428  0.01065048  0.11857124  0.10538688]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00626868 -0.02578987  0.00658436 -0.02595191 -0.0292751 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.11333546 -0.4509879   0.12079003 -0.43430972 -0.44072422]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.11333546 -0.4509879   0.12079003 -0.43430972 -0.44072422]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.9961158   0.6041363  -4.165827   -1.206333   -0.15742569]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.9961158   0.6041363  -4.165827   -1.206333   -0.15742569]
  [Layer 38] Output shape after mixer: (1, 1, 2048)
  [Layer 38] Output sample values after mixer: [-0.9961158   0.6041363  -4.165827   -1.206333   -0.15742569]
  [Layer 38] Residual connection shape: (1, 1, 2048)
  [Layer 38] Residual connection sample values: [  5.889355   -3.964123  -39.12252    -5.3332696  -3.5613968]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07513727 -0.05109485 -0.49994117 -0.06826356 -0.04597775]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07513727 -0.05109485 -0.49994117 -0.06826356 -0.04597775]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07513727 -0.05109485 -0.49994117 -0.06826356 -0.04597775]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.1663979   0.23638038  0.11894739 -0.74426466 -0.7475976 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.1663979   0.23638038  0.11894739 -0.74426466 -0.7475976 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.5098075   0.4084825   0.33679393 -0.38691482 -0.4210029 ]
  [FlaxMamba2] dt (step) sample values: [3.4327793  2.6102903  1.8484408  1.6321331  0.19352505]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.6528985  -0.13210464  0.5098075   0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.08120843 -0.06532621  0.05542314 -0.06782585 -0.0574659 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0668728   0.01987887  0.03308427 -0.06374793 -0.07844674]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.03455397  0.01003823  0.01681575 -0.03085836 -0.03768568]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03455397  0.01003823  0.01681575 -0.03085836 -0.03768568]
  [FlaxMamba2] B (step) sample values: [ 0.01746345  0.01386264  0.02535167 -0.00164849  0.11316731]
  [FlaxMamba2] C (step) sample values: [ 0.07953048  0.0677261  -0.05193948 -0.05034893 -0.2131787 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.69420344 -0.9242845  -1.3151171  -3.1532621  -2.1087465 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.13999355 0.09808082 0.05513323 0.13279068 0.03110137]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.90738904 0.9133331  0.93005955 0.65788585 0.9365195 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03455397  0.01003823  0.01681575 -0.03085836 -0.03768568]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.4476553e-05  6.7058194e-05  1.2263449e-04 -7.9742731e-06
  5.4742803e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.4476553e-05  6.7058194e-05  1.2263449e-04 -7.9742731e-06
  5.4742803e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00025397 -0.00011022  0.00011449 -0.00011012  0.00040999]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00184887  0.00076483 -0.00110489 -0.00219607  0.00193511]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03145669  0.00936615  0.01330381 -0.02863727 -0.03035613]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03145669  0.00936615  0.01330381 -0.02863727 -0.03035613]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.02797665 0.00123722 0.00083823 0.00686456 0.00729266]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.69565696 0.03304713 0.02288736 0.15155841 0.18359496]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.69565696 0.03304713 0.02288736 0.15155841 0.18359496]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.7365619 -3.0170684  0.7121592  1.9232032 -1.2753372]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.7365619 -3.0170684  0.7121592  1.9232032 -1.2753372]
  [Layer 39] Output shape after mixer: (1, 1, 2048)
  [Layer 39] Output sample values after mixer: [-1.7365619 -3.0170684  0.7121592  1.9232032 -1.2753372]
  [Layer 39] Residual connection shape: (1, 1, 2048)
  [Layer 39] Residual connection sample values: [  4.1527934  -6.9811916 -38.410362   -3.4100664  -4.836734 ]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04561021 -0.07727458 -0.43648186 -0.03780872 -0.05297347]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.04561021 -0.07727458 -0.43648186 -0.03780872 -0.05297347]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.04561021 -0.07727458 -0.43648186 -0.03780872 -0.05297347]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.07674243 -0.66462636 -0.4174826   0.52233213 -0.11844517]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.07674243 -0.66462636 -0.4174826   0.52233213 -0.11844517]
  [FlaxMamba2] xBC (step) sample values: [-0.5224164  -0.7779392  -0.32858637  0.18117194 -0.46024343]
  [FlaxMamba2] dt (step) sample values: [0.7438009 1.6829299 3.223916  1.4531258 1.6818027]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.08408351 -0.00908942 -0.5224164   0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.10516217  0.17835958 -0.05722528 -0.02921713 -0.09365338]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.12081769  0.1597286  -0.0514689  -0.03908956 -0.09841794]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.05676405  0.08622909 -0.02507233 -0.01916283 -0.0467894 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05676405  0.08622909 -0.02507233 -0.01916283 -0.0467894 ]
  [FlaxMamba2] B (step) sample values: [-0.00204603 -0.20766978 -0.08458323  0.03861983 -0.07399005]
  [FlaxMamba2] C (step) sample values: [-0.14115015 -0.12618323 -0.06722423  0.00829021 -0.06763317]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9809841  -1.4352343  -0.79658854 -1.6062093  -1.8464803 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11659516 0.07068679 0.10845432 0.14903599 0.28311047]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7937608  0.90352446 0.9172332  0.78711337 0.59288317]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05676405  0.08622909 -0.02507233 -0.01916283 -0.0467894 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.3541489e-05  1.3744446e-03  5.5980682e-04 -2.5560200e-04
  4.8969680e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.3541489e-05  1.3744446e-03  5.5980682e-04 -2.5560200e-04
  4.8969680e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 4.1218194e-05  1.3568262e-03  6.0035288e-04 -3.2281529e-04
  5.4013380e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.6610825e-03  4.7136843e-03 -2.0404657e-05 -6.0885801e-04
 -1.1026837e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04801915  0.07513525 -0.02049648 -0.01625876 -0.03931465]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04801915  0.07513525 -0.02049648 -0.01625876 -0.03931465]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00191322 -0.01696361  0.00339812 -0.00533067  0.00219059]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.06051793 -0.5397889   0.10647093 -0.19790855  0.06839472]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.06051793 -0.5397889   0.10647093 -0.19790855  0.06839472]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.8300792  -0.04008804  0.05076179 -3.013229    0.58137196]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.8300792  -0.04008804  0.05076179 -3.013229    0.58137196]
  [Layer 40] Output shape after mixer: (1, 1, 2048)
  [Layer 40] Output sample values after mixer: [ 1.8300792  -0.04008804  0.05076179 -3.013229    0.58137196]
  [Layer 40] Residual connection shape: (1, 1, 2048)
  [Layer 40] Residual connection sample values: [  5.9828725  -7.02128   -38.3596     -6.423295   -4.255362 ]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0624418  -0.07388104 -0.408896   -0.06703838 -0.04463097]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0624418  -0.07388104 -0.408896   -0.06703838 -0.04463097]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0624418  -0.07388104 -0.408896   -0.06703838 -0.04463097]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.3076187   0.06124765 -0.4712554  -0.556367   -0.73671675]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.3076187   0.06124765 -0.4712554  -0.556367   -0.73671675]
  [FlaxMamba2] xBC (step) sample values: [ 0.30033192 -0.39496836  0.8357913   0.33320925 -0.23909909]
  [FlaxMamba2] dt (step) sample values: [1.8383079  0.98139155 2.479784   1.2427899  2.214932  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -0.4675433   1.0878199   0.30033192  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.07619701 -0.08284765  0.14621788  0.05553738 -0.0646925 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.08954845 -0.09684759  0.14831597  0.04880062 -0.08027935]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04277083 -0.04608076  0.07964732  0.02499557 -0.03852935]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04277083 -0.04608076  0.07964732  0.02499557 -0.03852935]
  [FlaxMamba2] B (step) sample values: [ 0.01980199 -0.08618861  0.00670161 -0.25833982  0.15599266]
  [FlaxMamba2] C (step) sample values: [ 0.03931008  0.01908855 -0.0571643  -0.0196643  -0.23558362]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8258594 -1.8636904 -1.2829287 -1.4542811 -4.4079003]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.2143178  0.08167271 0.08277919 0.13639525 0.05701215]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.67616767 0.85880566 0.89924496 0.820077   0.77778596]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04277083 -0.04608076  0.07964732  0.02499557 -0.03852935]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.8151590e-04  7.9005223e-04 -6.1430641e-05  2.3680849e-03
 -1.4299145e-03]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.8151590e-04  7.9005223e-04 -6.1430641e-05  2.3680849e-03
 -1.4299145e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00022715  0.00023355 -0.00087993  0.00361296 -0.00225653]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00272907 -0.00271556  0.00443087  0.00135269 -0.00229786]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04441705 -0.04762967  0.08206173  0.02571544 -0.03985175]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04441705 -0.04762967  0.08206173  0.02571544 -0.03985175]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00578918 -0.00150326 -0.0148624  -0.00521339  0.00950432]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.1814526  -0.0470906  -0.4582146  -0.16884601  0.2398984 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.1814526  -0.0470906  -0.4582146  -0.16884601  0.2398984 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-4.3279696  -0.76444566  0.02710503 -2.0435388  -2.732756  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-4.3279696  -0.76444566  0.02710503 -2.0435388  -2.732756  ]
  [Layer 41] Output shape after mixer: (1, 1, 2048)
  [Layer 41] Output sample values after mixer: [-4.3279696  -0.76444566  0.02710503 -2.0435388  -2.732756  ]
  [Layer 41] Residual connection shape: (1, 1, 2048)
  [Layer 41] Residual connection sample values: [  1.6549029  -7.7857256 -38.332497   -8.466834   -6.988118 ]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0173574  -0.08325743 -0.40618774 -0.08816428 -0.07295518]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0173574  -0.08325743 -0.40618774 -0.08816428 -0.07295518]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0173574  -0.08325743 -0.40618774 -0.08816428 -0.07295518]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.25281757  0.05133875 -0.3699614  -0.2494207   0.62105703]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.25281757  0.05133875 -0.3699614  -0.2494207   0.62105703]
  [FlaxMamba2] xBC (step) sample values: [-0.22297688 -0.35297105  0.18080106  0.3812619  -0.6103692 ]
  [FlaxMamba2] dt (step) sample values: [2.1224322 1.0743742 4.0317125 1.0926783 2.174065 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.          0.41710472 -0.01793338 -0.22297688  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03263839  0.05611414  0.02468165  0.05695702 -0.08231359]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04196914  0.04290003  0.03472956  0.06048371 -0.10225683]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02054428  0.02191005  0.01766629  0.03115615 -0.04851658]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02054428  0.02191005  0.01766629  0.03115615 -0.04851658]
  [FlaxMamba2] B (step) sample values: [ 0.02783758  0.05321284  0.01915446 -0.08024766  0.3848432 ]
  [FlaxMamba2] C (step) sample values: [-0.05798848 -0.04705218 -0.09130646 -0.2120533  -0.27823442]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.06612   -1.4514434 -0.7269863 -1.9455162 -0.6256312]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1657118  0.4126588  0.17790148 0.0786606  0.09531815]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8380574  0.5493877  0.87868226 0.8580993  0.9421093 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02054428  0.02191005  0.01766629  0.03115615 -0.04851658]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.4771101e-05 -1.8115938e-04 -6.5210028e-05  2.7319751e-04
 -1.3101717e-03]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.4771101e-05 -1.8115938e-04 -6.5210028e-05  2.7319751e-04
 -1.3101717e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-9.6019045e-05 -1.6806234e-04 -3.2011721e-05  3.1526657e-04
 -1.2938781e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00034709  0.00080362  0.0001348   0.00051382 -0.0017837 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02096286  0.0227899   0.01786255  0.03177837 -0.05046908]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02096286  0.0227899   0.01786255  0.03177837 -0.05046908]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00231669  0.00060002 -0.00269989 -0.0034714  -0.0203881 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.0829777   0.0211267  -0.09670267 -0.10291101 -0.66286045]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0829777   0.0211267  -0.09670267 -0.10291101 -0.66286045]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.0562665 -1.4490223 -2.7650023  6.6263275 -1.814857 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.0562665 -1.4490223 -2.7650023  6.6263275 -1.814857 ]
  [Layer 42] Output shape after mixer: (1, 1, 2048)
  [Layer 42] Output sample values after mixer: [ 3.0562665 -1.4490223 -2.7650023  6.6263275 -1.814857 ]
  [Layer 42] Residual connection shape: (1, 1, 2048)
  [Layer 42] Residual connection sample values: [  4.7111692  -9.234748  -41.0975     -1.8405066  -8.802975 ]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04693868 -0.09647339 -0.4107341  -0.01864989 -0.086982  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.04693868 -0.09647339 -0.4107341  -0.01864989 -0.086982  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.04693868 -0.09647339 -0.4107341  -0.01864989 -0.086982  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.4094284 -1.2981203  0.6232271  1.1878463  1.4753201]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.4094284 -1.2981203  0.6232271  1.1878463  1.4753201]
  [FlaxMamba2] xBC (step) sample values: [ 0.57381314  0.55972975 -0.7279529   0.4804604  -0.6244439 ]
  [FlaxMamba2] dt (step) sample values: [2.8920643  0.8678333  1.6545322  1.7843931  0.87765753]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -0.13625398  0.5833921   0.57381314  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.08726568  0.05207237 -0.20003167 -0.08670173  0.09721565]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.08369512  0.00638755 -0.18755761 -0.08080039  0.08839607]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.04359776  0.00320398 -0.08501003 -0.03876891  0.04615023]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04359776  0.00320398 -0.08501003 -0.03876891  0.04615023]
  [FlaxMamba2] B (step) sample values: [ 0.01932495 -0.1268018   0.886731   -0.04013385  0.02907213]
  [FlaxMamba2] C (step) sample values: [-0.09031975 -0.05349853 -0.2760168  -0.22534095 -0.10570158]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9761645 -1.478265  -1.0588893 -1.0815219 -5.9141264]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.07056384 0.03511958 0.04195301 0.04041561 0.12424512]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9334369  0.9494086  0.9565487  0.95723116 0.47960073]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04359776  0.00320398 -0.08501003 -0.03876891  0.04615023]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.9451744e-05 -3.9009625e-04  2.7279616e-03 -1.2346877e-04
  8.9438225e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.9451744e-05 -3.9009625e-04  2.7279616e-03 -1.2346877e-04
  8.9438225e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.7102293e-04 -6.2277145e-04  6.1378907e-03  5.8014513e-05
 -2.9124159e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00154745 -0.00209571 -0.00574836 -0.00044842 -0.00046588]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.0394063   0.00068652 -0.07956825 -0.03411405  0.03960945]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.0394063   0.00068652 -0.07956825 -0.03411405  0.03960945]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00643828 -0.00019114 -0.03228012 -0.03105445  0.0475595 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.27687013 -0.00630516 -0.9994174  -1.060044    1.8722707 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.27687013 -0.00630516 -0.9994174  -1.060044    1.8722707 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.8201941  -0.47772974 -0.7413904  -0.1574595   6.694693  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.8201941  -0.47772974 -0.7413904  -0.1574595   6.694693  ]
  [Layer 43] Output shape after mixer: (1, 1, 2048)
  [Layer 43] Output sample values after mixer: [ 0.8201941  -0.47772974 -0.7413904  -0.1574595   6.694693  ]
  [Layer 43] Residual connection shape: (1, 1, 2048)
  [Layer 43] Residual connection sample values: [  5.5313635  -9.712478  -41.83889    -1.997966   -2.1082816]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05260235 -0.09601252 -0.40160325 -0.01890157 -0.02002857]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05260235 -0.09601252 -0.40160325 -0.01890157 -0.02002857]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05260235 -0.09601252 -0.40160325 -0.01890157 -0.02002857]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.79969877 -2.429355   -0.6495915  -0.35462263 -0.17642131]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.79969877 -2.429355   -0.6495915  -0.35462263 -0.17642131]
  [FlaxMamba2] xBC (step) sample values: [-0.21585748 -0.09480459  0.40994382 -0.93639374 -1.1030066 ]
  [FlaxMamba2] dt (step) sample values: [1.683464  2.5233936 1.8059121 2.42585   2.2084227]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -0.40551603  0.41412812 -0.21585748  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02901902  0.01278373  0.05272521 -0.15249999  0.12867762]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.03512635  0.07320853  0.03426208 -0.15904982  0.07618739]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01725474  0.03794354  0.01742448 -0.07321399  0.03954412]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01725474  0.03794354  0.01742448 -0.07321399  0.03954412]
  [FlaxMamba2] B (step) sample values: [-0.27831286 -0.09821988  0.02950694  0.05285589  0.08564319]
  [FlaxMamba2] C (step) sample values: [-0.27690336 -0.08918721 -0.03972324  0.17148496 -0.0680807 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.74823433 -0.64391696 -1.1771379  -1.350584   -1.0269372 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11260027 0.17341518 0.06591342 0.10634417 0.29568753]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9192002  0.89434385 0.9253445  0.866211   0.73811734]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01725474  0.03794354  0.01742448 -0.07321399  0.03954412]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.40730834e-04  1.90830266e-04 -5.73286998e-05 -1.02693106e-04
 -1.66395155e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.40730834e-04  1.90830266e-04 -5.73286998e-05 -1.02693106e-04
 -1.66395155e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.3411919e-04  4.0602867e-04 -3.4897908e-05 -1.2643437e-04
 -1.6309152e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.3634750e-04  2.2935905e-04  8.6903412e-05 -4.4085665e-04
  1.7972622e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01634487  0.03587225  0.01645488 -0.06921563  0.03732615]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01634487  0.03587225  0.01645488 -0.06921563  0.03732615]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00405318 -0.0070555  -0.00366718  0.01011914 -0.00300288]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.13902552 -0.19322497 -0.13553245  0.32437515 -0.10472542]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.13902552 -0.19322497 -0.13553245  0.32437515 -0.10472542]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-7.708858  -1.9643945 -2.9015384  0.9674147 -0.3499673]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-7.708858  -1.9643945 -2.9015384  0.9674147 -0.3499673]
  [Layer 44] Output shape after mixer: (1, 1, 2048)
  [Layer 44] Output sample values after mixer: [-7.708858  -1.9643945 -2.9015384  0.9674147 -0.3499673]
  [Layer 44] Residual connection shape: (1, 1, 2048)
  [Layer 44] Residual connection sample values: [ -2.1774945 -11.676872  -44.74043    -1.0305514  -2.4582489]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.0203323  -0.11202879 -0.41946334 -0.00946604 -0.02283702]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.0203323  -0.11202879 -0.41946334 -0.00946604 -0.02283702]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.0203323  -0.11202879 -0.41946334 -0.00946604 -0.02283702]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.5326977  -0.20820518  0.15844427  0.04301372  0.09037482]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.5326977  -0.20820518  0.15844427  0.04301372  0.09037482]
  [FlaxMamba2] xBC (step) sample values: [-0.13488795  0.53698236 -0.7736668  -0.23347619 -1.6419717 ]
  [FlaxMamba2] dt (step) sample values: [2.4978218 1.7008963 1.370198  1.5356839 3.3148394]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -1.170736   -0.6202787  -0.13488795  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03200184 -0.09907662 -0.12695599 -0.02644099  0.30352655]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.03657948 -0.04686105 -0.12940693 -0.03302515  0.3010241 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01795526 -0.02288163 -0.06052276 -0.01623994  0.1729964 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01795526 -0.02288163 -0.06052276 -0.01623994  0.1729964 ]
  [FlaxMamba2] B (step) sample values: [ 0.03440122 -0.00433535  0.01007922 -0.1834284  -0.02088522]
  [FlaxMamba2] C (step) sample values: [ 0.00485731 -0.04957353  0.05868839  0.05890666  0.11629906]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.250236  -4.181475  -1.0937363 -2.677446  -2.3148744]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08422417 0.11789874 0.07435886 0.05725348 0.14246686]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.82735264 0.610797   0.9218904  0.85787827 0.71907264]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01795526 -0.02288163 -0.06052276 -0.01623994  0.1729964 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.2023832e-05  6.5562062e-06 -1.5242476e-05  2.7739274e-04
  3.1584023e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.2023832e-05  6.5562062e-06 -1.5242476e-05  2.7739274e-04
  3.1584023e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00043537 -0.00011738 -0.00015797  0.00112778  0.00018049]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00195163 -0.00093077 -0.00319933  0.00106199  0.00985891]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02209448 -0.02660019 -0.07109589 -0.01715654  0.20393234]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02209448 -0.02660019 -0.07109589 -0.01715654  0.20393234]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00435346  0.00248191 -0.00607765 -0.00037692  0.0096313 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.15251629  0.06305117 -0.19566603 -0.0111087   0.30443606]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.15251629  0.06305117 -0.19566603 -0.0111087   0.30443606]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.2676332  2.7661216 -3.799963   4.5555167  5.6728535]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.2676332  2.7661216 -3.799963   4.5555167  5.6728535]
  [Layer 45] Output shape after mixer: (1, 1, 2048)
  [Layer 45] Output sample values after mixer: [ 1.2676332  2.7661216 -3.799963   4.5555167  5.6728535]
  [Layer 45] Residual connection shape: (1, 1, 2048)
  [Layer 45] Residual connection sample values: [ -0.9098613  -8.91075   -48.54039     3.5249653   3.2146046]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00969868 -0.09899879 -0.5270391   0.03798731  0.03403439]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00969868 -0.09899879 -0.5270391   0.03798731  0.03403439]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00969868 -0.09899879 -0.5270391   0.03798731  0.03403439]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.03198992 -0.87027514 -0.0592129   2.2203991  -0.7932969 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.03198992 -0.87027514 -0.0592129   2.2203991  -0.7932969 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.26237017 -0.99083877 -0.21033174 -1.4521501  -1.0862546 ]
  [FlaxMamba2] dt (step) sample values: [2.1809323 2.4666765 1.3942981 1.1841285 1.0548632]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.         1.1877637  0.08927929 0.26237017 0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.0503592  -0.13764632 -0.03650932  0.21317062  0.17653129]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.05349679 -0.14144576 -0.05761222  0.197332    0.19684073]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02603309 -0.06572948 -0.02797655  0.10836951  0.10807578]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02603309 -0.06572948 -0.02797655  0.10836951  0.10807578]
  [FlaxMamba2] B (step) sample values: [ 0.04701268 -0.2784275   0.11092415  0.015564    0.06678627]
  [FlaxMamba2] C (step) sample values: [-0.02185451 -0.268778    0.03894119  0.20674737  0.37325832]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8673339  -0.9793274  -1.6584101  -0.94076145 -0.4381494 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02643424 0.06496223 0.02529946 0.03340575 0.02511517]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.95183694 0.9383622  0.9589111  0.96906185 0.9890561 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02603309 -0.06572948 -0.02797655  0.10836951  0.10807578]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.2352480e-05  1.9160406e-04 -7.6334116e-05 -1.0710599e-05
 -4.5959969e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.2352480e-05  1.9160406e-04 -7.6334116e-05 -1.0710599e-05
 -4.5959969e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-7.5228963e-05  4.7059095e-04 -4.4980599e-05  3.8930779e-05
 -1.5468760e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-2.6914143e-04 -2.7918650e-04 -9.5866148e-05  6.6059909e-04
  5.9726957e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02105539 -0.05276121 -0.02243388  0.08718877  0.08689091]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02105539 -0.05276121 -0.02243388  0.08718877  0.08689091]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00034217  0.01355449  0.00064453  0.17463453 -0.02146911]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.0105995   0.40086415  0.01721897  4.3182774  -0.6483235 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0105995   0.40086415  0.01721897  4.3182774  -0.6483235 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-3.7224483  7.4744616  2.982913  -4.8271017  1.2825284]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-3.7224483  7.4744616  2.982913  -4.8271017  1.2825284]
  [Layer 46] Output shape after mixer: (1, 1, 2048)
  [Layer 46] Output sample values after mixer: [-3.7224483  7.4744616  2.982913  -4.8271017  1.2825284]
  [Layer 46] Residual connection shape: (1, 1, 2048)
  [Layer 46] Residual connection sample values: [ -4.63231    -1.4362888 -45.557476   -1.3021364   4.4971333]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.04202619 -0.01315458 -0.4009282  -0.01159994  0.03816005]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04202619 -0.01315458 -0.4009282  -0.01159994  0.03816005]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04202619 -0.01315458 -0.4009282  -0.01159994  0.03816005]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.0928084   0.3458911  -0.75594795 -0.14863396  0.45411223]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.0928084   0.3458911  -0.75594795 -0.14863396  0.45411223]
  [FlaxMamba2] xBC (step) sample values: [-0.02679448  1.6558968   0.45990935  0.02244723 -0.3834784 ]
  [FlaxMamba2] dt (step) sample values: [ 1.341731  -0.7119092  1.6401038  1.7138256  2.6445262]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -1.2364329  -1.6534126  -0.02679448  0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00156696 -0.04133087  0.04380382 -0.03644926 -0.050363  ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01867207 -0.06623321 -0.1756786  -0.03982908 -0.04518646]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00942319 -0.0320203  -0.08014335 -0.01951801 -0.02208286]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00942319 -0.0320203  -0.08014335 -0.01951801 -0.02208286]
  [FlaxMamba2] B (step) sample values: [-0.21947019  0.00202005 -0.25909644 -0.26895177  0.09129152]
  [FlaxMamba2] C (step) sample values: [ 0.66259897 -0.04475405  0.0059136  -0.25660437 -0.13263841]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -3.552239  -11.244981   -2.6866128  -3.193549   -3.1997924]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08298377 0.00748137 0.01325261 0.02012826 0.1523133 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.74469674 0.9193137  0.9650218  0.9377418  0.6142391 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00942319 -0.0320203  -0.08014335 -0.01951801 -0.02208286]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.7161954e-04  1.5796236e-06 -2.0260616e-04 -2.1031275e-04
  7.1387403e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.7161954e-04  1.5796236e-06 -2.0260616e-04 -2.1031275e-04
  7.1387403e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00107336 -0.00025105 -0.00159164 -0.00159949  0.00023081]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00196375 -0.00097989 -0.00340004 -0.00185191 -0.00025968]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01528644 -0.04625081 -0.11670823 -0.02944684 -0.03148085]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01528644 -0.04625081 -0.11670823 -0.02944684 -0.03148085]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00067646 -0.00936861  0.02819035  0.00202606 -0.00874357]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.02031868 -0.16866174  0.8305358   0.0623541  -0.25807938]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02031868 -0.16866174  0.8305358   0.0623541  -0.25807938]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-18.596167    20.190405    11.227093    -0.13844685  -1.4214337 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-18.596167    20.190405    11.227093    -0.13844685  -1.4214337 ]
  [Layer 47] Output shape after mixer: (1, 1, 2048)
  [Layer 47] Output sample values after mixer: [-18.596167    20.190405    11.227093    -0.13844685  -1.4214337 ]
  [Layer 47] Residual connection shape: (1, 1, 2048)
  [Layer 47] Residual connection sample values: [-23.228477   18.754116  -34.330383   -1.4405832   3.0756996]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.19356504  0.14592916 -0.26112646 -0.01130462  0.022773  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.19356504  0.14592916 -0.26112646 -0.01130462  0.022773  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.19356504  0.14592916 -0.26112646 -0.01130462  0.022773  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.5147915  -2.190253    1.8731016   0.15495868 -0.10402948]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.5147915  -2.190253    1.8731016   0.15495868 -0.10402948]
  [FlaxMamba2] xBC (step) sample values: [ 0.7010987  -0.03854591  0.60855997 -0.24847168  0.81587833]
  [FlaxMamba2] dt (step) sample values: [1.1997752  1.4052829  2.4957898  1.4459312  0.64571685]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.         -0.8172884   0.44788995  0.7010987   0.        ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.11851766 -0.00111336  0.08594134 -0.02391047 -0.12387159]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-1.2369039e-01  2.1885735e-01  6.4872205e-05 -9.0194650e-02
 -1.2631682e-01]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-5.8025233e-02  1.2135574e-01  3.2437154e-05 -4.3064933e-02
 -5.9174716e-02]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-5.8025233e-02  1.2135574e-01  3.2437154e-05 -4.3064933e-02
 -5.9174716e-02]
  [FlaxMamba2] B (step) sample values: [-0.00834511  0.0474011   0.0263027  -0.00709259 -0.05222272]
  [FlaxMamba2] C (step) sample values: [-0.02519079 -0.15044647 -0.11295307 -0.15288605  0.03090479]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-54.81184   -78.514336  -47.25076    -2.330753   -4.2266355]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.09896341 0.03547003 0.0482039  0.00464114 0.01429056]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.00440786 0.06173488 0.10252269 0.98924094 0.94138694]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-5.8025233e-02  1.2135574e-01  3.2437154e-05 -4.3064933e-02
 -5.9174716e-02]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.7920734e-05 -2.7219488e-04 -1.5103997e-04  4.0728311e-05
  2.9988243e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.7920734e-05 -2.7219488e-04 -1.5103997e-04  4.0728311e-05
  2.9988243e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 4.7670001e-05 -2.7220830e-04 -1.5153573e-04  4.0976724e-05
  3.0049789e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.0968464e-03  2.2952238e-03  6.2886897e-07 -8.1272388e-04
 -1.1182092e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-4.7298197e-02  9.8922141e-02  2.6456259e-05 -3.5102259e-02
 -4.8234813e-02]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-4.7298197e-02  9.8922141e-02  2.6456259e-05 -3.5102259e-02
 -4.8234813e-02]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 9.1081457e-03 -2.1802776e-02  4.2955329e-05 -2.9299997e-03
  2.3785378e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.39721322 -0.7792473   0.0015888  -0.12418166  0.1122265 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.39721322 -0.7792473   0.0015888  -0.12418166  0.1122265 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-24.775236  52.348747  29.807518 -18.675045  -8.080952]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-24.775236  52.348747  29.807518 -18.675045  -8.080952]
  [Layer 48] Output shape after mixer: (1, 1, 2048)
  [Layer 48] Output sample values after mixer: [-24.775236  52.348747  29.807518 -18.675045  -8.080952]
  [Layer 48] Residual connection shape: (1, 1, 2048)
  [Layer 48] Residual connection sample values: [-48.003716   71.10286    -4.5228653 -20.115627   -5.005252 ]
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.37704536  0.6177027  -0.03617869 -0.1640911  -0.03893476]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Final backbone norm output sample values: [-0.37704536  0.6177027  -0.03617869 -0.1640911  -0.03893476]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 1, 50288)
[Mamba2LMHeadModel] Logits sample values: [-37.394543 -61.20654  -34.939053 -36.035328 -38.52063 ]
[Mamba2LMHeadModel] Forward pass input_ids shape: (1, 1)
[Mamba2LMHeadModel] input_ids sample values: [427]
[Mamba2LMHeadModel] Embedding output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Embedding sample values: [-0.0949707  -0.27734375  0.09222412 -0.16210938 -0.10552979]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.10813846 -0.35733855  0.10848251 -0.19068797 -0.1219822 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.10813846 -0.35733855  0.10848251 -0.19068797 -0.1219822 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.10813846 -0.35733855  0.10848251 -0.19068797 -0.1219822 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.705221   -0.9587838  -0.96071655 -0.16085956 -0.11107612]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.705221   -0.9587838  -0.96071655 -0.16085956 -0.11107612]
  [FlaxMamba2] xBC (step) sample values: [-0.20654811 -0.28244972 -0.14498167  0.96199197 -1.4595945 ]
  [FlaxMamba2] dt (step) sample values: [ 0.3259896   0.14568175  0.11409319 -0.13041079  0.14163877]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.0169386   0.3529671   0.5844494  -0.20654811 -0.10158538]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.10773279  0.07780211  0.21772934 -0.05137569 -0.3231815 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.33551598  0.29313415  0.487993   -0.00218136 -0.58001745]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.19563967  0.16789648  0.30237684 -0.00108949 -0.20818482]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.19563967  0.16789648  0.30237684 -0.00108949 -0.20818482]
  [FlaxMamba2] B (step) sample values: [ 0.12617971  0.0319434  -0.27344814 -0.27577272  0.04240393]
  [FlaxMamba2] C (step) sample values: [-0.26303026  0.11232875 -0.27446613  0.06146641  0.02835706]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.617978  -2.5226073 -3.0473056 -3.307819  -3.9089987]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01258035 0.01568361 0.01015078 0.02148519 0.00839156]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.96760136 0.9612088  0.969541   0.9313975  0.96772957]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.19563967  0.16789648  0.30237684 -0.00108949 -0.20818482]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.10555362e-04  7.86195669e-05 -6.73014612e-04 -6.78735902e-04
  1.04365165e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.10555362e-04  7.86195669e-05 -6.73014612e-04 -6.78735902e-04
  1.04365165e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00156386  0.00018903 -0.00170163 -0.00191317  0.00071676]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.04767451  0.04059926  0.05891885  0.00114357 -0.03948862]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.12228711  0.10463122  0.17423862  0.00072806 -0.11888567]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.12228711  0.10463122  0.17423862  0.00072806 -0.11888567]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 1.7645839e-01 -2.7800502e-02 -4.6323717e-02 -5.3858101e-05
  6.2363567e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 1.4000246e-01 -2.3756977e-02 -3.1356871e-02 -7.0537630e-05
  5.0396565e-03]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 1.4000246e-01 -2.3756977e-02 -3.1356871e-02 -7.0537630e-05
  5.0396565e-03]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.08237293  0.19012088 -0.1309602   0.00630929 -0.09239803]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.08237293  0.19012088 -0.1309602   0.00630929 -0.09239803]
  [Layer 1] Output shape after mixer: (1, 1, 2048)
  [Layer 1] Output sample values after mixer: [ 0.08237293  0.19012088 -0.1309602   0.00630929 -0.09239803]
  [Layer 1] Residual connection shape: (1, 1, 2048)
  [Layer 1] Residual connection sample values: [-0.01259777 -0.08722287 -0.03873608 -0.15580009 -0.19792782]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01789058 -0.09782183 -0.05069604 -0.21362814 -0.2651207 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.01789058 -0.09782183 -0.05069604 -0.21362814 -0.2651207 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.01789058 -0.09782183 -0.05069604 -0.21362814 -0.2651207 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.33190286 -0.88344216 -1.4300544   0.25094804 -1.196344  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.33190286 -0.88344216 -1.4300544   0.25094804 -1.196344  ]
  [FlaxMamba2] xBC (step) sample values: [-0.82048094  0.43783474  1.0185773   5.709165    1.5279797 ]
  [FlaxMamba2] dt (step) sample values: [1.3992603 0.9554255 0.9752747 1.0252961 2.3132346]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.7521976  -1.1875107  -0.78967863 -0.82048094 -1.8367425 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.1097449   0.4574681   0.12723872 -2.7716994  -0.02310536]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.13956058  0.30292708  0.11672541 -1.7179885  -0.03623555]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06491889  0.17423092  0.06176505 -0.26135835 -0.01778956]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06491889  0.17423092  0.06176505 -0.26135835 -0.01778956]
  [FlaxMamba2] B (step) sample values: [-0.1171554  -0.0704395   0.0126017  -0.20785634  0.5558759 ]
  [FlaxMamba2] C (step) sample values: [-0.11840855 -0.10861468  0.09501967 -0.0153501  -0.2784391 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-19.851534   -18.68525    -13.564036    -2.4188707   -0.46617994]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02446158 0.01625879 0.05502218 0.02026388 0.14019604]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.615328   0.73800874 0.4741067  0.9521662  0.93673337]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06491889  0.17423092  0.06176505 -0.26135835 -0.01778956]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.86044927e-04  1.11859226e-04 -2.00117265e-05  3.30079696e-04
 -8.82741122e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.86044927e-04  1.11859226e-04 -2.00117265e-05  3.30079696e-04
 -8.82741122e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-8.2944665e-05  1.7099312e-04  2.9256249e-05  6.5662683e-04
 -1.2065000e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02948208  0.05169811  0.00222603 -0.03327702 -0.02015939]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07429864  0.1719779   0.04486534 -0.21370497 -0.03244036]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07429864  0.1719779   0.04486534 -0.21370497 -0.03244036]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01435756 -0.04443494 -0.01238865 -0.03016139  0.00900878]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00189942 -0.00278098 -0.00173602 -0.00171117  0.00127982]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00189942 -0.00278098 -0.00173602 -0.00171117  0.00127982]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.05201787 -0.00681088 -0.10727406 -0.13041298  0.04202047]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.05201787 -0.00681088 -0.10727406 -0.13041298  0.04202047]
  [Layer 2] Output shape after mixer: (1, 1, 2048)
  [Layer 2] Output sample values after mixer: [ 0.05201787 -0.00681088 -0.10727406 -0.13041298  0.04202047]
  [Layer 2] Residual connection shape: (1, 1, 2048)
  [Layer 2] Residual connection sample values: [ 0.0394201  -0.09403375 -0.14601013 -0.28621307 -0.15590735]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0459078  -0.08562402 -0.15233427 -0.30723542 -0.18000014]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0459078  -0.08562402 -0.15233427 -0.30723542 -0.18000014]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0459078  -0.08562402 -0.15233427 -0.30723542 -0.18000014]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.22444545  0.0996487  -2.293113   -0.9686552   0.2904513 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.22444545  0.0996487  -2.293113   -0.9686552   0.2904513 ]
  [FlaxMamba2] xBC (step) sample values: [ 2.6808503  -1.8550179  -0.96784717  0.1200408  -1.226104  ]
  [FlaxMamba2] dt (step) sample values: [1.8484286 0.8521481 1.765995  2.2822342 1.8723335]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.1962808   0.46637878 -0.13996676  2.6808503  -0.31835338]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01647658  0.24215573 -0.12443942 -0.06177711  0.1446498 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01802535  0.22285336 -0.00078219 -0.07411384  0.12835342]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00893145  0.12379145 -0.00039094 -0.03568433  0.06828971]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00893145  0.12379145 -0.00039094 -0.03568433  0.06828971]
  [FlaxMamba2] B (step) sample values: [ 0.5193623  -0.00899583  0.00602875  0.10714541  0.24752301]
  [FlaxMamba2] C (step) sample values: [ 0.4892742   0.00945596 -0.24444509 -0.15150546 -0.05505927]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6505536 -3.9938898 -6.780579  -0.9418818 -6.0307717]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05207524 0.04715411 0.07715841 0.06249834 0.13327302]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9666897  0.8283427  0.5926337  0.94283307 0.44765198]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00893145  0.12379145 -0.00039094 -0.03568433  0.06828971]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.41559188e-04  4.18402578e-06 -2.80401423e-06 -4.98341142e-05
 -1.15124756e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.41559188e-04  4.18402578e-06 -2.80401423e-06 -4.98341142e-05
 -1.15124756e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00789869  0.00065648  0.00120021  0.00068232 -0.00233843]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.03707753  0.02265099  0.08366338  0.00831501  0.00060217]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04114378  0.07900985  0.08348539 -0.00793109  0.03169261]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04114378  0.07900985  0.08348539 -0.00793109  0.03169261]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00513326  0.00413259 -0.01755421  0.00211383  0.00526633]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00173001  0.00151867 -0.00519888  0.00095902  0.00137685]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00173001  0.00151867 -0.00519888  0.00095902  0.00137685]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.07826523 -0.05481149  0.04925555  0.04148574 -0.04706745]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.07826523 -0.05481149  0.04925555  0.04148574 -0.04706745]
  [Layer 3] Output shape after mixer: (1, 1, 2048)
  [Layer 3] Output sample values after mixer: [-0.07826523 -0.05481149  0.04925555  0.04148574 -0.04706745]
  [Layer 3] Residual connection shape: (1, 1, 2048)
  [Layer 3] Residual connection sample values: [-0.03884513 -0.14884523 -0.09675458 -0.24472733 -0.2029748 ]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.04262993 -0.12370683 -0.09379753 -0.24539492 -0.22345027]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04262993 -0.12370683 -0.09379753 -0.24539492 -0.22345027]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04262993 -0.12370683 -0.09379753 -0.24539492 -0.22345027]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.7255334   1.0837384  -0.9418669  -0.20955211  0.1774819 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.7255334   1.0837384  -0.9418669  -0.20955211  0.1774819 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.00505049 -0.23636058 -1.1375272   0.32396922 -0.9646319 ]
  [FlaxMamba2] dt (step) sample values: [1.5815364 3.0326111 2.7071893 1.7088817 1.5060954]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.08970526  0.68919337  0.01396449  0.00505049 -0.04839333]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01006992 -0.17663802  0.17403077  0.18265016 -0.0363729 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.08386142 -0.21179427  0.12581299  0.1668268   0.25659585]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04017356 -0.09472466  0.06685852  0.09035511  0.14466856]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04017356 -0.09472466  0.06685852  0.09035511  0.14466856]
  [FlaxMamba2] B (step) sample values: [0.38003647 0.29248503 0.2654057  0.01041955 0.07520562]
  [FlaxMamba2] C (step) sample values: [ 0.7388454  -0.21709634 -0.20674935 -0.27365023  0.15187605]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.7127254  -1.2862217  -1.4869522 -27.028044   -4.0726624]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02950789 0.04883779 0.02830243 0.01776575 0.16054855]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9507169  0.93911606 0.9587889  0.61867607 0.52003455]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04017356 -0.09472466  0.06685852  0.09035511  0.14466856]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.5050919e-04 -3.4672249e-04 -3.1462169e-04 -1.2351712e-05
 -8.9151508e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.5050919e-04 -3.4672249e-04 -3.1462169e-04 -1.2351712e-05
 -8.9151508e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.2820291e-03 -1.5506190e-03 -1.4769313e-03  2.4827976e-05
 -1.7011716e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00827468  0.01074714  0.00454383  0.0057886   0.0618092 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03088746 -0.04257121  0.04217696  0.05664743  0.14323984]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03088746 -0.04257121  0.04217696  0.05664743  0.14323984]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00805642 -0.0344729  -0.01114381 -0.00531568  0.0138363 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00422913 -0.01162723 -0.00575142 -0.00231187  0.00359088]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00422913 -0.01162723 -0.00575142 -0.00231187  0.00359088]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.07042957 -0.04052508  0.05374474 -0.09048121  0.0376696 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.07042957 -0.04052508  0.05374474 -0.09048121  0.0376696 ]
  [Layer 4] Output shape after mixer: (1, 1, 2048)
  [Layer 4] Output sample values after mixer: [-0.07042957 -0.04052508  0.05374474 -0.09048121  0.0376696 ]
  [Layer 4] Residual connection shape: (1, 1, 2048)
  [Layer 4] Residual connection sample values: [-0.1092747  -0.1893703  -0.04300984 -0.33520854 -0.1653052 ]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.10151767 -0.14538524 -0.03732032 -0.29827628 -0.15847106]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.10151767 -0.14538524 -0.03732032 -0.29827628 -0.15847106]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.10151767 -0.14538524 -0.03732032 -0.29827628 -0.15847106]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.18086517 -1.5683684  -0.78703266 -0.75958914 -1.4285908 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.18086517 -1.5683684  -0.78703266 -0.75958914 -1.4285908 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.27706146 -0.13449931  0.8284772  -1.5104661  -0.6138016 ]
  [FlaxMamba2] dt (step) sample values: [ 3.198675    1.9427048   1.201386    0.75070417 -0.09447806]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.0174327   0.35433516  0.26593763  0.27706146 -1.6878211 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01812211 -0.03969896 -0.22674008 -0.10574479 -0.23077315]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.06969682 -0.07702196 -0.2962591  -0.13186784 -0.23663634]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03363449 -0.03702862 -0.12634628 -0.06159293 -0.10438395]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03363449 -0.03702862 -0.12634628 -0.06159293 -0.10438395]
  [FlaxMamba2] B (step) sample values: [ 0.03414004  0.10062894 -0.11987372 -0.0347502   0.13297185]
  [FlaxMamba2] C (step) sample values: [-0.00755954 -0.03720228 -0.07936235 -0.12914236 -0.08060441]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.5762966   -1.0443833   -0.83880144  -5.6764617  -20.401838  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.09124828 0.08109147 0.1346135  0.02920357 0.00310197]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.86603117 0.91879654 0.89322746 0.84723854 0.93867505]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03363449 -0.03702862 -0.12634628 -0.06159293 -0.10438395]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00010478 -0.00030884  0.0003679   0.00010665 -0.0004081 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00010478 -0.00030884  0.0003679   0.00010665 -0.0004081 ]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.2328038e-04 -7.8138313e-05  4.5161869e-04  1.8295379e-04
 -5.7484140e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00153151  0.00828843 -0.01116271 -0.01167556 -0.00969146]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01961101 -0.01161551 -0.07907744 -0.04478352 -0.06580082]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01961101 -0.01161551 -0.07907744 -0.04478352 -0.06580082]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.00161353 0.00314157 0.01946797 0.01084245 0.0181724 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.00109287 0.00217014 0.01280926 0.00746694 0.01109293]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.00109287 0.00217014 0.01280926 0.00746694 0.01109293]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.12159026 -0.09792802  0.05859618  0.00106148 -0.14600962]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.12159026 -0.09792802  0.05859618  0.00106148 -0.14600962]
  [Layer 5] Output shape after mixer: (1, 1, 2048)
  [Layer 5] Output sample values after mixer: [ 0.12159026 -0.09792802  0.05859618  0.00106148 -0.14600962]
  [Layer 5] Residual connection shape: (1, 1, 2048)
  [Layer 5] Residual connection sample values: [ 0.01231556 -0.28729832  0.01558634 -0.33414707 -0.31131482]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00976863 -0.17637275  0.01097258 -0.24316442 -0.25048986]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00976863 -0.17637275  0.01097258 -0.24316442 -0.25048986]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00976863 -0.17637275  0.01097258 -0.24316442 -0.25048986]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.628786   -0.44839036  0.41567668  0.41660586 -0.73593813]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.628786   -0.44839036  0.41567668  0.41660586 -0.73593813]
  [FlaxMamba2] xBC (step) sample values: [-0.38086557 -1.1709539   0.16299962  0.92994004 -0.56774133]
  [FlaxMamba2] dt (step) sample values: [1.68725   2.52292   1.8790812 1.7953942 1.6099693]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.418163   -2.9152837   0.32843578 -0.38086557 -0.33481085]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01881315 -0.4030484   0.07548211 -0.04328822 -0.3628113 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.05317594 -0.47537506  0.0133178   0.01881506 -0.29310915]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02729473 -0.18223259  0.00670324  0.00949603 -0.12522879]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02729473 -0.18223259  0.00670324  0.00949603 -0.12522879]
  [FlaxMamba2] B (step) sample values: [ 0.08768351  0.05714596 -0.25308183 -0.15731247  0.22203651]
  [FlaxMamba2] C (step) sample values: [-0.24516463 -0.06503671 -0.27812546  0.1462572   0.32331908]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.98658675 -8.774721   -3.3045902  -2.9912853  -3.3435438 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05007947 0.15899527 0.45313174 0.34401023 0.14043336]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.95179296 0.24779853 0.22370777 0.35735244 0.6252867 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02729473 -0.18223259  0.00670324  0.00949603 -0.12522879]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.1985508e-04  7.8113131e-05 -3.4593896e-04 -2.1503128e-04
  3.0350292e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.1985508e-04  7.8113131e-05 -3.4593896e-04 -2.1503128e-04
  3.0350292e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.02230685 -0.00225941 -0.01121284 -0.00241469  0.0027106 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.09463358 -0.14564382  0.0096968   0.03171276 -0.07833794]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.10054433 -0.1851068   0.01114841  0.03376915 -0.10545659]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.10054433 -0.1851068   0.01114841  0.03376915 -0.10545659]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.13690823 0.03234876 0.00279183 0.00847863 0.02513718]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.1064754  0.01178605 0.00096696 0.00381825 0.00799076]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.1064754  0.01178605 0.00096696 0.00381825 0.00799076]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.20526978  0.1034238   0.10596856 -0.0523105   0.12378453]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.20526978  0.1034238   0.10596856 -0.0523105   0.12378453]
  [Layer 6] Output shape after mixer: (1, 1, 2048)
  [Layer 6] Output sample values after mixer: [ 0.20526978  0.1034238   0.10596856 -0.0523105   0.12378453]
  [Layer 6] Residual connection shape: (1, 1, 2048)
  [Layer 6] Residual connection sample values: [ 0.21758536 -0.18387452  0.1215549  -0.38645756 -0.1875303 ]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.12141649 -0.08522224  0.06288028 -0.19745128 -0.10497722]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12141649 -0.08522224  0.06288028 -0.19745128 -0.10497722]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12141649 -0.08522224  0.06288028 -0.19745128 -0.10497722]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.6581326  -1.1101466  -0.28528035 -0.8716239   0.02730371]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.6581326  -1.1101466  -0.28528035 -0.8716239   0.02730371]
  [FlaxMamba2] xBC (step) sample values: [-1.8322127  -1.0545921  -0.20118637  0.25002965  0.15534723]
  [FlaxMamba2] dt (step) sample values: [1.6009028 1.4044969 1.9202138 1.5140734 1.3457711]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.3216721 -3.4444342 -2.4927015 -1.8322127  0.5518218]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.09189647  0.26704392 -0.05968377 -0.12310497 -0.18863045]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.16001171  0.2916716  -0.06043383 -0.11668102 -0.19222389]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07361854  0.16695438 -0.02930413 -0.05494075 -0.08690278]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07361854  0.16695438 -0.02930413 -0.05494075 -0.08690278]
  [FlaxMamba2] B (step) sample values: [ 0.2815297   0.02509216 -0.00133606 -0.09831258  0.12251865]
  [FlaxMamba2] C (step) sample values: [ 0.09329307 -0.048421    0.00156456 -0.02194664 -0.00667361]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.29588825 -1.1836219  -0.3113019  -0.1314279  -1.5015444 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08371724 0.02421181 0.01709762 0.06648624 0.00411866]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9755333  0.9717491  0.9946916  0.9912999  0.99383473]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07361854  0.16695438 -0.02930413 -0.05494075 -0.08690278]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.7351073e-03 -1.5464654e-04  8.2342995e-06  6.0591433e-04
 -7.5509975e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.7351073e-03 -1.5464654e-04  8.2342995e-06  6.0591433e-04
 -7.5509975e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00063407  0.00048    -0.00047034  0.00080172 -0.00315746]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00253289 -0.00185307  0.00623274 -0.00251418 -0.00046555]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00270133 -0.00147107  0.00616569 -0.00263988 -0.00066438]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00270133 -0.00147107  0.00616569 -0.00263988 -0.00066438]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-1.1713104e-03  4.0475541e-04 -7.5487059e-04  6.7859888e-04
 -9.1938919e-06]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-7.8908214e-03  1.5186605e-03 -6.6832891e-03  4.2375708e-03
 -7.8382072e-05]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-7.8908214e-03  1.5186605e-03 -6.6832891e-03  4.2375708e-03
 -7.8382072e-05]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.09637725 -0.03113229  0.11228348  0.18504106 -0.00231816]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.09637725 -0.03113229  0.11228348  0.18504106 -0.00231816]
  [Layer 7] Output shape after mixer: (1, 1, 2048)
  [Layer 7] Output sample values after mixer: [-0.09637725 -0.03113229  0.11228348  0.18504106 -0.00231816]
  [Layer 7] Residual connection shape: (1, 1, 2048)
  [Layer 7] Residual connection sample values: [ 0.12120811 -0.21500681  0.23383838 -0.2014165  -0.18984845]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.08081279 -0.11219657  0.1452765  -0.12449796 -0.12597787]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.08081279 -0.11219657  0.1452765  -0.12449796 -0.12597787]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.08081279 -0.11219657  0.1452765  -0.12449796 -0.12597787]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.7222127  -1.631776   -0.73862624 -1.6736006  -0.84242755]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.7222127  -1.631776   -0.73862624 -1.6736006  -0.84242755]
  [FlaxMamba2] xBC (step) sample values: [-0.3310088   0.70608675 -1.5253941   0.18653703  0.2840051 ]
  [FlaxMamba2] dt (step) sample values: [1.0784283  0.85997456 1.4388647  1.5245904  0.66611207]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.79613364 -1.7796566   0.17718412 -0.3310088  -1.7792941 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.06113036 -0.40850163  0.18125315 -0.16349721  0.10440984]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.40176028 -0.43952274 -0.13344412 -0.21507192  0.04828802]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.24069881 -0.17222907 -0.06227682 -0.09601634  0.02472683]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.24069881 -0.17222907 -0.06227682 -0.09601634  0.02472683]
  [FlaxMamba2] B (step) sample values: [0.00560616 0.02145449 0.08270919 0.15753858 0.01377259]
  [FlaxMamba2] C (step) sample values: [ 0.07077448 -0.02797553  0.01899588 -0.0314556  -0.04419495]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.6542776 -0.9827404 -0.5549556 -3.9396574 -1.8081155]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02930463 0.12377733 0.04612167 0.10605984 0.0186863 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8984473  0.8854662  0.9747293  0.65846795 0.96677744]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.24069881 -0.17222907 -0.06227682 -0.09601634  0.02472683]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [3.9543556e-05 1.5133117e-04 5.8339670e-04 1.1112124e-03 9.7146207e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [3.9543556e-05 1.5133117e-04 5.8339670e-04 1.1112124e-03 9.7146207e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-4.3378992e-04 -7.3032686e-05  6.0766825e-04 -7.2133797e-04
 -3.5308473e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.04027913 -0.02988896 -0.02418826 -0.00883331 -0.01601227]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.2428994  -0.17487139 -0.0766129  -0.08965986  0.00480277]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.2428994  -0.17487139 -0.0766129  -0.08965986  0.00480277]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.05734748  0.04667976  0.01829526  0.02370036 -0.00121794]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.03663906  0.03799555  0.01012277  0.02054666 -0.00125965]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03663906  0.03799555  0.01012277  0.02054666 -0.00125965]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.20951822  0.09910124  0.07034472  0.01458175  0.08149128]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.20951822  0.09910124  0.07034472  0.01458175  0.08149128]
  [Layer 8] Output shape after mixer: (1, 1, 2048)
  [Layer 8] Output sample values after mixer: [-0.20951822  0.09910124  0.07034472  0.01458175  0.08149128]
  [Layer 8] Residual connection shape: (1, 1, 2048)
  [Layer 8] Residual connection sample values: [-0.08831012 -0.11590558  0.3041831  -0.18683475 -0.10835717]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.04382957 -0.04700189  0.13879037 -0.08186433 -0.05308831]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04382957 -0.04700189  0.13879037 -0.08186433 -0.05308831]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04382957 -0.04700189  0.13879037 -0.08186433 -0.05308831]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.5578929  -0.67447174  0.19751018 -0.9624849  -1.489592  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.5578929  -0.67447174  0.19751018 -0.9624849  -1.489592  ]
  [FlaxMamba2] xBC (step) sample values: [ 0.01195776  0.60611063  0.37966594 -0.6187397   0.66868776]
  [FlaxMamba2] dt (step) sample values: [3.231522  2.508299  3.0387728 2.870494  2.454076 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.0603741  -0.53071535 -0.58628625  0.01195776  0.19383869]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [0.12755923 0.09250889 0.00944712 0.20547381 0.20068912]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.13491015  0.06716404 -0.0772228   0.13156024  0.2257288 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.07199837  0.03470935 -0.0371213   0.07010091  0.12554894]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.07199837  0.03470935 -0.0371213   0.07010091  0.12554894]
  [FlaxMamba2] B (step) sample values: [-0.11055778 -0.26101503  0.42945546  0.49976298 -0.12663877]
  [FlaxMamba2] C (step) sample values: [-0.26749092 -0.25031412 -0.2161287  -0.278194   -0.14098495]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-5.234511  -1.2161361 -1.4887683 -0.9523448 -3.9666808]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.22880104 0.38452655 0.09580416 1.2230213  0.16926633]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.30189937 0.6264811  0.86707467 0.31200442 0.51097965]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.07199837  0.03470935 -0.0371213   0.07010091  0.12554894]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00182125 -0.00429978  0.00707455  0.00823275 -0.00208616]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00182125 -0.00429978  0.00707455  0.00823275 -0.00208616]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00033358 -0.00488272  0.00775958  0.00857924 -0.00266726]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.02634662  0.01039612 -0.0141208   0.02557379  0.04095674]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.12394417  0.05744645 -0.06444065  0.12059923  0.21114486]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.12394417  0.05744645 -0.06444065  0.12059923  0.21114486]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.03358816 -0.01307663 -0.00699027 -0.0320809  -0.05786627]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.01997795 -0.01158983 -0.00414208 -0.01498999 -0.03938161]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01997795 -0.01158983 -0.00414208 -0.01498999 -0.03938161]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.17677997 -0.2778182   0.09085358 -0.32044095 -0.03477613]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.17677997 -0.2778182   0.09085358 -0.32044095 -0.03477613]
  [Layer 9] Output shape after mixer: (1, 1, 2048)
  [Layer 9] Output sample values after mixer: [ 0.17677997 -0.2778182   0.09085358 -0.32044095 -0.03477613]
  [Layer 9] Residual connection shape: (1, 1, 2048)
  [Layer 9] Residual connection sample values: [ 0.08846986 -0.3937238   0.39503667 -0.5072757  -0.1431333 ]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03423629 -0.12734918  0.13799573 -0.17544554 -0.05413347]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03423629 -0.12734918  0.13799573 -0.17544554 -0.05413347]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03423629 -0.12734918  0.13799573 -0.17544554 -0.05413347]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.11623018 -0.86093575  0.39968553 -0.8616078  -0.33705887]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.11623018 -0.86093575  0.39968553 -0.8616078  -0.33705887]
  [FlaxMamba2] xBC (step) sample values: [ 0.1810347  -0.4587038   1.9811215   0.14617874  0.84928244]
  [FlaxMamba2] dt (step) sample values: [0.8309352  0.3852541  0.98841196 0.77809685 1.0867513 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.8272672  -0.9168027   0.4215516   0.1810347   0.37696424]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.0380994  -0.02144054  0.31399167 -0.02351286  0.23868018]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00026119 -0.10853771  0.21017087 -0.10932828  0.17910987]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00013058 -0.05132664  0.11608791 -0.05167894  0.09755365]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00013058 -0.05132664  0.11608791 -0.05167894  0.09755365]
  [FlaxMamba2] B (step) sample values: [-0.01993934 -0.11505155  0.15267558  0.23648189  0.06477804]
  [FlaxMamba2] C (step) sample values: [-0.25649643 -0.08053429 -0.09207355  0.04381704 -0.10863612]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.7154508  -1.4067873  -0.35344088 -2.010216   -0.4652703 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00100775 0.00522616 0.23630898 0.00397164 0.02229654]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9962628  0.9926749  0.9198715  0.99204797 0.9896797 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00013058 -0.05132664  0.11608791 -0.05167894  0.09755365]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.6238229e-09  1.5139658e-08 -2.0090615e-08 -3.1118706e-08
 -8.5241565e-09]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.6238229e-09  1.5139658e-08 -2.0090615e-08 -3.1118706e-08
 -8.5241565e-09]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-5.71249814e-07  1.07908447e-04  4.10327884e-05  1.21742751e-05
  1.47007095e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00016268 -0.00254924  0.00050454 -0.00039165  0.00276818]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00013399 -0.01382676  0.02601145 -0.01174658  0.02420274]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00013399 -0.01382676  0.02601145 -0.01174658  0.02420274]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-7.3347583e-06  3.5371871e-03  6.2234118e-03  3.0059558e-03
 -3.3978978e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-8.8113986e-05  2.0706672e-02  5.8544174e-02  3.2182470e-02
 -3.3666246e-02]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-8.8113986e-05  2.0706672e-02  5.8544174e-02  3.2182470e-02
 -3.3666246e-02]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.29593736  0.02867035 -0.09018627  0.03615354 -0.04535481]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.29593736  0.02867035 -0.09018627  0.03615354 -0.04535481]
  [Layer 10] Output shape after mixer: (1, 1, 2048)
  [Layer 10] Output sample values after mixer: [-0.29593736  0.02867035 -0.09018627  0.03615354 -0.04535481]
  [Layer 10] Residual connection shape: (1, 1, 2048)
  [Layer 10] Residual connection sample values: [-0.2074675  -0.36505345  0.3048504  -0.47112218 -0.1884881 ]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.07949277 -0.11380006  0.10433741 -0.15731472 -0.06903728]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.07949277 -0.11380006  0.10433741 -0.15731472 -0.06903728]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.07949277 -0.11380006  0.10433741 -0.15731472 -0.06903728]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.07744735 -0.62844163  0.57009983 -0.79485726  0.24202858]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.07744735 -0.62844163  0.57009983 -0.79485726  0.24202858]
  [FlaxMamba2] xBC (step) sample values: [-0.33429423  0.25403488 -0.04776681 -0.13193479 -0.7100799 ]
  [FlaxMamba2] dt (step) sample values: [1.895821  2.1974044 2.6210246 3.815806  2.507126 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.1211524   1.1445943   0.5201296  -0.33429423  0.31199944]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04557735 -0.1511525   0.04719888 -0.0026803  -0.14773041]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03137141 -0.5088185   0.1437565   0.0094657  -0.12456757]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01593173 -0.19104636  0.07703585  0.00475525 -0.05840952]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01593173 -0.19104636  0.07703585  0.00475525 -0.05840952]
  [FlaxMamba2] B (step) sample values: [-0.2405081  -0.27114907 -0.2515029   0.04986942  0.07451355]
  [FlaxMamba2] C (step) sample values: [ 0.02664139 -0.09878268 -0.27844784 -0.15864548  0.04987782]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.31160602 -0.09015273 -1.5786072  -0.20961139 -0.6694042 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11171478 0.2528313  1.0121495  1.0931528  0.08788977]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.96578795 0.9774644  0.20234393 0.79521936 0.94286346]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01593173 -0.19104636  0.07703585  0.00475525 -0.05840952]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.2805861e-04 -4.8259372e-04 -4.4762727e-04  8.8758068e-05
  1.3261994e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.2805861e-04 -4.8259372e-04 -4.4762727e-04  8.8758068e-05
  1.3261994e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.03583846 -0.02168973  0.04343074  0.00900523 -0.04984882]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.06219716 -0.11727746  0.15284035 -0.0072409  -0.02844122]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05635217 -0.18736808  0.18110307 -0.0054963  -0.04987037]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05635217 -0.18736808  0.18110307 -0.0054963  -0.04987037]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00226662  0.04096095  0.06595264  0.00135924 -0.00676181]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.0021483   0.03805112  0.04345366  0.00291861 -0.0047684 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0021483   0.03805112  0.04345366  0.00291861 -0.0047684 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.39720532  0.57063925 -0.05181036 -0.06716708 -0.06715944]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.39720532  0.57063925 -0.05181036 -0.06716708 -0.06715944]
  [Layer 11] Output shape after mixer: (1, 1, 2048)
  [Layer 11] Output sample values after mixer: [ 0.39720532  0.57063925 -0.05181036 -0.06716708 -0.06715944]
  [Layer 11] Residual connection shape: (1, 1, 2048)
  [Layer 11] Residual connection sample values: [ 0.18973783  0.20558581  0.25304005 -0.53828925 -0.25564754]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05485994  0.04932433  0.0639094  -0.13503388 -0.07081506]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05485994  0.04932433  0.0639094  -0.13503388 -0.07081506]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05485994  0.04932433  0.0639094  -0.13503388 -0.07081506]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.68986964 -0.8917514  -0.09692846  0.27708924 -0.4298594 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.68986964 -0.8917514  -0.09692846  0.27708924 -0.4298594 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.20059147  0.16004978 -0.11646807 -0.7052202  -0.12583853]
  [FlaxMamba2] dt (step) sample values: [2.7035568 2.6392894 2.5117364 1.6977359 2.5694888]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.23113912  0.6048336  -1.6992308   0.20059147 -0.24670576]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.0135485  -0.04446331  0.2653643  -0.05445364 -0.00481192]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02945077 -0.03156964  0.2304827  -0.0841625   0.0078071 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01450856 -0.01553568  0.12846345 -0.04031146  0.00391879]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01450856 -0.01553568  0.12846345 -0.04031146  0.00391879]
  [FlaxMamba2] B (step) sample values: [ 0.06109362 -0.22212262 -0.02754944 -0.08748882 -0.0580725 ]
  [FlaxMamba2] C (step) sample values: [-0.2694898  -0.2639123  -0.10008411 -0.06549338 -0.13225196]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2411823 -0.7693517 -1.9974962 -1.2367963 -1.0181218]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.498304   0.6818023  0.29037774 0.42614698 0.7204417 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.53875947 0.5918242  0.55988246 0.5903398  0.4802265 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01450856 -0.01553568  0.12846345 -0.04031146  0.00391879]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00044169  0.00160587  0.00019917  0.00063252  0.00041985]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00044169  0.00160587  0.00019917  0.00063252  0.00041985]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00841537  0.00526673 -0.02375416  0.00307154 -0.00082677]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0034744  -0.000288    0.01459164 -0.01062027 -0.00941339]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00696907 -0.0114708   0.10706148 -0.03963704 -0.0065926 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00696907 -0.0114708   0.10706148 -0.03963704 -0.0065926 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00320166  0.0029741  -0.00493738 -0.00624749  0.00111701]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00990553  0.00606085 -0.00760455 -0.01100602  0.00282941]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00990553  0.00606085 -0.00760455 -0.01100602  0.00282941]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.31405404 -0.12600552  0.02926723 -0.06064601  0.04568953]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.31405404 -0.12600552  0.02926723 -0.06064601  0.04568953]
  [Layer 12] Output shape after mixer: (1, 1, 2048)
  [Layer 12] Output sample values after mixer: [-0.31405404 -0.12600552  0.02926723 -0.06064601  0.04568953]
  [Layer 12] Residual connection shape: (1, 1, 2048)
  [Layer 12] Residual connection sample values: [-0.12431622  0.07958029  0.28230727 -0.59893525 -0.20995802]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03224357  0.01786272  0.0675651  -0.1349067  -0.05527788]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03224357  0.01786272  0.0675651  -0.1349067  -0.05527788]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03224357  0.01786272  0.0675651  -0.1349067  -0.05527788]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [0.45386142 0.16194625 0.36010265 0.24216081 0.29800063]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [0.45386142 0.16194625 0.36010265 0.24216081 0.29800063]
  [FlaxMamba2] xBC (step) sample values: [ 0.5842428   0.10605752 -0.50917596  0.3485038   0.8638003 ]
  [FlaxMamba2] dt (step) sample values: [2.6210334 2.3746529 2.9334192 1.7857643 2.9589193]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.4691228 -0.9623956 -2.3017192  0.5842428 -2.0080276]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.47372693  0.7015961  -0.03831623 -0.10499442  0.1966742 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.73837537  0.59167176 -0.05879353 -0.10579932  0.1727179 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.23876071  0.3808879  -0.02853284 -0.0501039   0.09379833]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.23876071  0.3808879  -0.02853284 -0.0501039   0.09379833]
  [FlaxMamba2] B (step) sample values: [-0.01374209  0.34511366 -0.10063528  0.5046241  -0.06043454]
  [FlaxMamba2] C (step) sample values: [ 0.05465524  0.10164287 -0.09133203  0.42092502 -0.14733556]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3103099 -1.7870504 -0.8605819 -1.881061  -0.5251649]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.12461268 0.10017347 0.55063325 0.25076202 0.2943175 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8493523  0.8360933  0.6225913  0.62394154 0.8567876 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.23876071  0.3808879  -0.02853284 -0.0501039   0.09379833]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00040886 -0.01026803  0.00299416 -0.01501389  0.00179809]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00040886 -0.01026803  0.00299416 -0.01501389  0.00179809]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00296169 -0.00400618 -0.00103542 -0.03691725  0.00110037]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.06432517  0.0691564  -0.01662458 -0.00521498  0.04994228]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0746039   0.08555376 -0.01785293 -0.00737197  0.05398033]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0746039   0.08555376 -0.01785293 -0.00737197  0.05398033]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02070722  0.00748728 -0.00378703 -0.00100015  0.00923272]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.08552948  0.010201   -0.02115614 -0.00636004  0.02240088]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.08552948  0.010201   -0.02115614 -0.00636004  0.02240088]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.00708226  0.08052985  0.24346831  0.07145891 -0.02854051]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.00708226  0.08052985  0.24346831  0.07145891 -0.02854051]
  [Layer 13] Output shape after mixer: (1, 1, 2048)
  [Layer 13] Output sample values after mixer: [ 0.00708226  0.08052985  0.24346831  0.07145891 -0.02854051]
  [Layer 13] Residual connection shape: (1, 1, 2048)
  [Layer 13] Residual connection sample values: [-0.11723396  0.16011015  0.52577555 -0.5274763  -0.23849852]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02544433  0.03052179  0.10565495 -0.09967215 -0.05053271]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02544433  0.03052179  0.10565495 -0.09967215 -0.05053271]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02544433  0.03052179  0.10565495 -0.09967215 -0.05053271]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [0.49128473 0.20665222 0.03753056 0.11930773 0.570927  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [0.49128473 0.20665222 0.03753056 0.11930773 0.570927  ]
  [FlaxMamba2] xBC (step) sample values: [-0.5885432  -0.65424633 -0.29613572  0.39384866  1.1031699 ]
  [FlaxMamba2] dt (step) sample values: [1.7723223  2.4033916  1.4290034  0.99000025 2.2067506 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.2844488  -0.18248388 -0.03884755 -0.5885432  -1.8294587 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.13228545  0.21000919 -0.12684678  0.05288477 -0.1652124 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.17183623  0.16874942 -0.18769883 -0.0099204  -0.12865233]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.0785543   0.09147695 -0.08506747 -0.0049356  -0.060194  ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0785543   0.09147695 -0.08506747 -0.0049356  -0.060194  ]
  [FlaxMamba2] B (step) sample values: [-0.02406811  0.01146925 -0.04220259 -0.08322114 -0.04042681]
  [FlaxMamba2] C (step) sample values: [ 0.14939855  0.00109986 -0.0865877  -0.11752792  0.07760967]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.318424  -0.7620611 -2.6670074 -5.1836414 -2.8487349]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.2128961  0.12566197 0.3027265  0.04390262 0.11964802]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.39876795 0.90868014 0.44602787 0.79646236 0.71116877]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0785543   0.09147695 -0.08506747 -0.0049356  -0.060194  ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00040251 -0.00019181  0.00070579  0.00139178  0.00067609]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00040251 -0.00019181  0.00070579  0.00139178  0.00067609]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0004324  -0.00018771  0.0006994   0.00138989  0.00058403]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02115777  0.0257163  -0.02461576 -0.00224609 -0.01596785]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05291126  0.06269343 -0.05900203 -0.00424118 -0.04029968]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05291126  0.06269343 -0.05900203 -0.00424118 -0.04029968]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01612722  0.00714483 -0.00112796 -0.00026808 -0.0147017 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.07563451  0.01950147 -0.00446759 -0.0014927  -0.09489754]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.07563451  0.01950147 -0.00446759 -0.0014927  -0.09489754]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.36111167  0.21712254  0.4390874  -0.02872389 -0.3744816 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.36111167  0.21712254  0.4390874  -0.02872389 -0.3744816 ]
  [Layer 14] Output shape after mixer: (1, 1, 2048)
  [Layer 14] Output sample values after mixer: [ 0.36111167  0.21712254  0.4390874  -0.02872389 -0.3744816 ]
  [Layer 14] Residual connection shape: (1, 1, 2048)
  [Layer 14] Residual connection sample values: [ 0.24387771  0.37723267  0.96486294 -0.5562002  -0.6129801 ]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04691859  0.06170069  0.17062058 -0.09209139 -0.11299781]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.04691859  0.06170069  0.17062058 -0.09209139 -0.11299781]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.04691859  0.06170069  0.17062058 -0.09209139 -0.11299781]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.00892754  0.22436637 -0.12735546 -1.7344311  -1.0560403 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.00892754  0.22436637 -0.12735546 -1.7344311  -1.0560403 ]
  [FlaxMamba2] xBC (step) sample values: [-0.6377079  -0.42234656 -0.12974997  0.67845714 -0.46840858]
  [FlaxMamba2] dt (step) sample values: [1.1816298 1.823362  3.4312406 1.0897498 1.9025073]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.4773197  -1.2982016  -0.51498413 -0.6377079  -0.16748792]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.09041259  0.09255365  0.03291588 -0.10778616  0.02251607]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.12785766  0.08569864  0.0081356  -0.12553214 -0.00282878]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.0598475   0.04468426  0.00408435 -0.05883165 -0.00141239]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0598475   0.04468426  0.00408435 -0.05883165 -0.00141239]
  [FlaxMamba2] B (step) sample values: [0.10487251 0.00458258 0.03339076 0.06937374 0.06294141]
  [FlaxMamba2] C (step) sample values: [ 0.01437954 -0.00304339 -0.02451857  0.03632306 -0.01701778]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.27823287 -0.68077636 -2.7209377  -0.11263601 -3.8483953 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00629742 0.09433571 0.38611665 0.01692639 0.14584544]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9982494  0.93779725 0.34972808 0.9980953  0.57048357]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0598475   0.04468426  0.00408435 -0.05883165 -0.00141239]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.9524890e-05 -1.7271043e-06 -1.2584482e-05 -2.6145930e-05
 -2.3721681e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.9524890e-05 -1.7271043e-06 -1.2584482e-05 -2.6145930e-05
 -2.3721681e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-5.5868164e-05 -1.3132161e-05 -2.2515920e-05  6.6218508e-06
  9.6431068e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.9331394e-05  1.8243712e-05 -2.9461016e-06 -6.6065782e-06
 -3.2921193e-07]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01021913  0.00763377  0.00069315 -0.01003327 -0.00024104]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01021913  0.00763377  0.00069315 -0.01003327 -0.00024104]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-4.5819455e-05  9.5205149e-04 -4.1331292e-05  2.6106804e-03
  6.5691034e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00078534  0.02132115 -0.00071376  0.05242949  0.0009682 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00078534  0.02132115 -0.00071376  0.05242949  0.0009682 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.33552778 -0.03967446 -0.23768891 -0.11937726  0.5462581 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.33552778 -0.03967446 -0.23768891 -0.11937726  0.5462581 ]
  [Layer 15] Output shape after mixer: (1, 1, 2048)
  [Layer 15] Output sample values after mixer: [ 0.33552778 -0.03967446 -0.23768891 -0.11937726  0.5462581 ]
  [Layer 15] Residual connection shape: (1, 1, 2048)
  [Layer 15] Residual connection sample values: [ 0.5794055   0.3375582   0.72717404 -0.67557746 -0.06672204]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.09878025  0.04811338  0.11357695 -0.09665285 -0.01092668]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09878025  0.04811338  0.11357695 -0.09665285 -0.01092668]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09878025  0.04811338  0.11357695 -0.09665285 -0.01092668]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.35299093  0.08748085 -0.45683953 -0.28561282 -0.39875698]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.35299093  0.08748085 -0.45683953 -0.28561282 -0.39875698]
  [FlaxMamba2] xBC (step) sample values: [ 0.00926928 -0.89864707  0.083941   -0.32610378  0.15544651]
  [FlaxMamba2] dt (step) sample values: [2.0651395 3.657227  2.5680811 1.6444247 2.586964 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.84037113  0.84651667  0.28637996  0.00926928 -0.58506525]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.03189742 -0.2359955  -0.00062509 -0.11256139 -0.0027506 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00423539 -0.2771332  -0.01375528 -0.20496862 -0.04483434]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00211321 -0.11948785 -0.00683034 -0.09201789 -0.02191472]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00211321 -0.11948785 -0.00683034 -0.09201789 -0.02191472]
  [FlaxMamba2] B (step) sample values: [-0.15964389 -0.0264664   0.20165136 -0.04690615 -0.27845553]
  [FlaxMamba2] C (step) sample values: [-0.24317555  0.02647077 -0.08120464  0.94080824 -0.17607926]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6905513  -0.13480766 -1.3128716  -3.7739606  -1.2635014 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.38086376 1.313976   0.5018676  0.3326327  0.27289256]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.35889214 0.83766747 0.51742655 0.28497815 0.70836186]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00211321 -0.11948785 -0.00683034 -0.09201789 -0.02191472]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.2848875e-04  2.1301381e-05 -1.6229831e-04  3.7752230e-05
  2.2411383e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.2848875e-04  2.1301381e-05 -1.6229831e-04  3.7752230e-05
  2.2411383e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 4.9614126e-04 -9.8633638e-04 -3.3690303e-06  1.7131152e-04
  6.6010386e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00071519 -0.05989418 -0.00634776 -0.04838217 -0.01566704]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00064483 -0.13679406 -0.01074363 -0.10760296 -0.0297709 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00064483 -0.13679406 -0.01074363 -0.10760296 -0.0297709 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 9.39288075e-05 -6.24498166e-03  1.90305151e-03  1.31867705e-02
  4.76766611e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00034851 -0.0181881   0.00664243  0.04100811  0.01522971]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00034851 -0.0181881   0.00664243  0.04100811  0.01522971]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.45221817  0.50286657 -0.01417883 -0.26271716  0.23734558]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.45221817  0.50286657 -0.01417883 -0.26271716  0.23734558]
  [Layer 16] Output shape after mixer: (1, 1, 2048)
  [Layer 16] Output sample values after mixer: [ 0.45221817  0.50286657 -0.01417883 -0.26271716  0.23734558]
  [Layer 16] Residual connection shape: (1, 1, 2048)
  [Layer 16] Residual connection sample values: [ 1.0316236   0.8404248   0.71299523 -0.93829465  0.17062354]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.16119531  0.11034505  0.09924065 -0.12078854  0.02565074]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.16119531  0.11034505  0.09924065 -0.12078854  0.02565074]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.16119531  0.11034505  0.09924065 -0.12078854  0.02565074]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.20708087 -0.4847318  -0.05839533 -0.3547271   0.2677504 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.20708087 -0.4847318  -0.05839533 -0.3547271   0.2677504 ]
  [FlaxMamba2] xBC (step) sample values: [-0.6556686  -0.44531885  0.73583424 -0.69367534 -0.1398422 ]
  [FlaxMamba2] dt (step) sample values: [1.7917513 1.6513186 1.344496  2.436489  2.0756266]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.8958114  -0.6821835   0.16870886 -0.6556686   0.4549761 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.12612897  0.07745415 -0.17531118 -0.04763961  0.02578343]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.15792829  0.05125481 -0.1896697  -0.05304122  0.03841771]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07274173  0.02628402 -0.08586806 -0.02581743  0.01957779]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07274173  0.02628402 -0.08586806 -0.02581743  0.01957779]
  [FlaxMamba2] B (step) sample values: [ 0.30967692 -0.1914448  -0.15873833  0.28081667 -0.05223412]
  [FlaxMamba2] C (step) sample values: [-9.8166086e-02 -3.0166909e-02  2.5600599e-04  3.8369313e-01
 -9.6287377e-02]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.1570504  -11.466768   -14.214988    -0.12863436 -14.242779  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00307637 0.05238132 0.08044242 0.2256029  0.05495741]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9964468  0.54845804 0.31870544 0.97139674 0.45714885]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07274173  0.02628402 -0.08586806 -0.02581743  0.01957779]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.9299582e-05  4.2841566e-05  3.5522506e-05 -6.2841224e-05
  1.1688966e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.9299582e-05  4.2841566e-05  3.5522506e-05 -6.2841224e-05
  1.1688966e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-5.9049082e-05  5.5860350e-05  7.7927056e-05 -2.3757704e-04
  5.1702636e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.7687361e-04 -6.7889428e-06 -2.1636112e-04  6.6664252e-05
  4.1042222e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04709202  0.01694523 -0.05559741 -0.01658442  0.01266784]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04709202  0.01694523 -0.05559741 -0.01658442  0.01266784]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00437287 -0.0031306   0.00157593  0.00242516  0.0019216 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.03410659 -0.02982305  0.01139487  0.02135405  0.01698608]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03410659 -0.02982305  0.01139487  0.02135405  0.01698608]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.16354407  0.9135015  -0.18442526 -0.16609666 -0.7033977 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.16354407  0.9135015  -0.18442526 -0.16609666 -0.7033977 ]
  [Layer 17] Output shape after mixer: (1, 1, 2048)
  [Layer 17] Output sample values after mixer: [ 0.16354407  0.9135015  -0.18442526 -0.16609666 -0.7033977 ]
  [Layer 17] Residual connection shape: (1, 1, 2048)
  [Layer 17] Residual connection sample values: [ 1.1951677   1.7539263   0.52856994 -1.1043913  -0.53277415]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13393843  0.16619985  0.05296901 -0.1038652  -0.05739038]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13393843  0.16619985  0.05296901 -0.1038652  -0.05739038]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13393843  0.16619985  0.05296901 -0.1038652  -0.05739038]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.24679652 -0.75683856 -0.42701307 -0.13675746  0.3383417 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.24679652 -0.75683856 -0.42701307 -0.13675746  0.3383417 ]
  [FlaxMamba2] xBC (step) sample values: [-0.37656048  0.8191319   0.19542383 -0.23302893 -0.61945033]
  [FlaxMamba2] dt (step) sample values: [1.6728481 1.9657781 1.4065751 2.1899586 2.5162675]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.1965181   0.4484295  -0.58373916 -0.37656048  0.9587282 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.17583634 -0.48319834  0.0554675  -0.24175785 -0.23661426]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.1858461  -0.7485792   0.33525264 -0.25558996 -0.278698  ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.08431312 -0.24039195  0.19546466 -0.11155176 -0.12005557]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08431312 -0.24039195  0.19546466 -0.11155176 -0.12005557]
  [FlaxMamba2] B (step) sample values: [ 0.02946037 -0.10886468 -0.12217287  0.01889977  0.07749025]
  [FlaxMamba2] C (step) sample values: [-0.27530554  0.10525688 -0.14689234 -0.08944616  0.08999285]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3010656 -1.4685526 -1.2082934 -1.2128745 -2.5874777]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.42835912 0.33681795 0.27086583 0.52332914 0.43302774]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.5727401  0.60979354 0.720878   0.5300772  0.3261331 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08431312 -0.24039195  0.19546466 -0.11155176 -0.12005557]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.001064    0.00393179  0.00441243 -0.00068259 -0.00279866]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.001064    0.00393179  0.00441243 -0.00068259 -0.00279866]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0014304   0.00403068  0.00502646 -0.00133539 -0.00311254]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02386062 -0.11098946  0.11469512 -0.05350329 -0.01554476]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04015315 -0.1574424   0.15246639 -0.07505937 -0.03874411]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04015315 -0.1574424   0.15246639 -0.07505937 -0.03874411]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00556316  0.03805124 -0.0257061   0.00478206 -0.00765272]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.04491752  0.12617534 -0.15504473  0.03711025 -0.09346835]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.04491752  0.12617534 -0.15504473  0.03711025 -0.09346835]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.4931739   1.1576737   0.36097533 -0.25995404 -0.21124874]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.4931739   1.1576737   0.36097533 -0.25995404 -0.21124874]
  [Layer 18] Output shape after mixer: (1, 1, 2048)
  [Layer 18] Output sample values after mixer: [ 0.4931739   1.1576737   0.36097533 -0.25995404 -0.21124874]
  [Layer 18] Residual connection shape: (1, 1, 2048)
  [Layer 18] Residual connection sample values: [ 1.6883416   2.9116      0.88954526 -1.3643453  -0.7440229 ]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.1736459   0.25851566  0.08539913 -0.12063549 -0.07635842]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1736459   0.25851566  0.08539913 -0.12063549 -0.07635842]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1736459   0.25851566  0.08539913 -0.12063549 -0.07635842]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.05580354 -0.13600253 -0.08246277  0.5889882   0.46887538]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.05580354 -0.13600253 -0.08246277  0.5889882   0.46887538]
  [FlaxMamba2] xBC (step) sample values: [ 0.76022786 -0.34830368 -0.47779346 -0.37142506  0.23239931]
  [FlaxMamba2] dt (step) sample values: [1.904967  2.4070268 2.2864397 1.9047216 1.8008244]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.26901987 -0.9309372  -0.13948123  0.76022786 -0.37973344]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04766431 -0.09120949 -0.11056487  0.02633245 -0.04901614]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01201978 -0.11554726 -0.11556594 -0.01627009 -0.08197512]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00604601 -0.05443954 -0.05444781 -0.00806887 -0.03930852]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00604601 -0.05443954 -0.05444781 -0.00806887 -0.03930852]
  [FlaxMamba2] B (step) sample values: [ 0.08610496 -0.12708095 -0.16227496  0.05177576  0.03365244]
  [FlaxMamba2] C (step) sample values: [-0.16711287 -0.01114899  0.02765129 -0.18049458 -0.19759324]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9436172 -1.8178532 -2.0862153 -1.0006425 -0.9649832]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.31926835 0.28086197 0.20706208 0.30250606 0.37329924]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.5376565  0.6001559  0.6492249  0.73882043 0.69751763]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00604601 -0.05443954 -0.05444781 -0.00806887 -0.03930852]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.6620838e-04 -2.4530431e-04 -3.1323929e-04  9.9942743e-05
  6.4959291e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.6620838e-04 -2.4530431e-04 -3.1323929e-04  9.9942743e-05
  6.4959291e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.6220527e-03  3.0730504e-03 -3.0450453e-04 -2.3785171e-03
 -6.1694147e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00369542 -0.00756285 -0.00664308  0.00387314 -0.00490394]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00301533 -0.01368652 -0.01276767  0.00296551 -0.00932559]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00301533 -0.01368652 -0.01276767  0.00296551 -0.00932559]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-8.6479908e-05  8.6750911e-04  5.0473562e-04  1.1233265e-03
 -2.6896244e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00225456  0.02376717  0.0177397   0.02888336 -0.09838243]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00225456  0.02376717  0.0177397   0.02888336 -0.09838243]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.17043172  0.25316063 -0.9304862  -0.6207551   0.40394068]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.17043172  0.25316063 -0.9304862  -0.6207551   0.40394068]
  [Layer 19] Output shape after mixer: (1, 1, 2048)
  [Layer 19] Output sample values after mixer: [ 0.17043172  0.25316063 -0.9304862  -0.6207551   0.40394068]
  [Layer 19] Residual connection shape: (1, 1, 2048)
  [Layer 19] Residual connection sample values: [ 1.8587734   3.1647608  -0.04094094 -1.9851004  -0.34008223]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.20047535  0.29260004 -0.004053   -0.18177551 -0.03556689]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.20047535  0.29260004 -0.004053   -0.18177551 -0.03556689]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.20047535  0.29260004 -0.004053   -0.18177551 -0.03556689]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.61844945  0.3244683  -1.2018034  -0.01835568 -0.06516313]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.61844945  0.3244683  -1.2018034  -0.01835568 -0.06516313]
  [FlaxMamba2] xBC (step) sample values: [-0.17979228  0.9004154  -0.5054531   0.5243026   0.16266367]
  [FlaxMamba2] dt (step) sample values: [1.9815456 2.1068113 2.627631  2.1147645 1.9390417]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5821599  -0.54123527 -1.2217442  -0.17979228 -0.34626317]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.26278943  0.12321302 -0.01979399  0.15055712  0.17869814]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [0.22430676 0.13174269 0.04673433 0.13175829 0.15124758]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [0.12467929 0.07020411 0.02391309 0.07021294 0.08133187]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [0.12467929 0.07020411 0.02391309 0.07021294 0.08133187]
  [FlaxMamba2] B (step) sample values: [-0.14353503 -0.10471093  0.2514865   0.19483918  0.13704441]
  [FlaxMamba2] C (step) sample values: [ 0.11117005 -0.20878564  0.04612633  0.02181597  0.7025791 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.6215758 -5.0388985 -1.2056414 -1.6434968 -1.3345234]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.19493611 0.08972183 0.11478597 0.32977694 0.19329512]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7289839  0.636291   0.8707584  0.58159125 0.77262855]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [0.12467929 0.07020411 0.02391309 0.07021294 0.08133187]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00348855 -0.00254495  0.00611225  0.00473547  0.0033308 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00348855 -0.00254495  0.00611225  0.00473547  0.0033308 ]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00478398 -0.00268515  0.00441637  0.00440739  0.00229273]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [6.4779259e-03 9.0700071e-03 6.1698174e-03 2.2581142e-05 1.6973289e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [0.00747124 0.00962932 0.00636033 0.00058196 0.00234529]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [0.00747124 0.00962932 0.00636033 0.00058196 0.00234529]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-1.6178238e-03  1.8134469e-03 -1.7669150e-03 -5.2921391e-06
 -7.3924552e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-2.3881633e-02  2.8674416e-02 -3.7506681e-02 -8.4998115e-05
 -1.0608195e-03]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-2.3881633e-02  2.8674416e-02 -3.7506681e-02 -8.4998115e-05
 -1.0608195e-03]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.30318773 -0.3818197   0.28366593  0.47999993 -0.21195945]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.30318773 -0.3818197   0.28366593  0.47999993 -0.21195945]
  [Layer 20] Output shape after mixer: (1, 1, 2048)
  [Layer 20] Output sample values after mixer: [ 0.30318773 -0.3818197   0.28366593  0.47999993 -0.21195945]
  [Layer 20] Residual connection shape: (1, 1, 2048)
  [Layer 20] Residual connection sample values: [ 2.161961    2.782941    0.24272498 -1.5051005  -0.55204165]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.16604333  0.19398184  0.01604965 -0.09596021 -0.03964443]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.16604333  0.19398184  0.01604965 -0.09596021 -0.03964443]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.16604333  0.19398184  0.01604965 -0.09596021 -0.03964443]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.70097697  0.00579591 -0.24447535 -0.50678015 -0.57359827]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.70097697  0.00579591 -0.24447535 -0.50678015 -0.57359827]
  [FlaxMamba2] xBC (step) sample values: [-0.54034585  0.4850397  -0.19747134  0.00241929  0.03986069]
  [FlaxMamba2] dt (step) sample values: [1.679994  3.015144  1.2144302 1.5898609 2.4939106]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.53410375  0.12420539 -0.43140212 -0.54034585  0.4050171 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.07570378  0.11597366  0.03054414  0.01089368 -0.01282658]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [0.04442327 0.08588333 0.04539857 0.0058125  0.01506648]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [0.02270491 0.04478452 0.02321446 0.0029147  0.00758999]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [0.02270491 0.04478452 0.02321446 0.0029147  0.00758999]
  [FlaxMamba2] B (step) sample values: [-0.02561934 -0.10152251 -0.00874097 -0.01815038  0.00759473]
  [FlaxMamba2] C (step) sample values: [-0.0009528  -0.02045497 -0.05900931  0.00167056 -0.00908479]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.2091806  -0.04342505 -3.8147197  -6.662431   -0.02279418]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.2793157  0.08310634 0.09795677 0.11324161 0.09110542]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.4080463  0.9963976  0.68819875 0.47026247 0.99792546]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [0.02270491 0.04478452 0.02321446 0.0029147  0.00758999]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.62473705e-04 -6.43839303e-04 -5.54338149e-05 -1.15106755e-04
  4.81645548e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.62473705e-04 -6.43839303e-04 -5.54338149e-05 -1.15106755e-04
  4.81645548e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.2347529e-04 -7.2430924e-04 -2.8381815e-05 -1.4640829e-04
  5.4655753e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [6.0134399e-04 1.1163035e-03 6.8970205e-04 2.7477177e-04 9.0072346e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [0.00458678 0.00897741 0.00476458 0.00078639 0.00142236]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [0.00458678 0.00897741 0.00476458 0.00078639 0.00142236]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-1.0661545e-03  2.6091540e-05 -5.1157066e-04 -1.4982637e-04
 -2.9404211e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.07848294  0.00176371 -0.0459623  -0.01135232 -0.02002654]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.07848294  0.00176371 -0.0459623  -0.01135232 -0.02002654]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.24306221  0.4651425   0.19429497 -0.17483672 -0.22205883]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.24306221  0.4651425   0.19429497 -0.17483672 -0.22205883]
  [Layer 21] Output shape after mixer: (1, 1, 2048)
  [Layer 21] Output sample values after mixer: [-0.24306221  0.4651425   0.19429497 -0.17483672 -0.22205883]
  [Layer 21] Residual connection shape: (1, 1, 2048)
  [Layer 21] Residual connection sample values: [ 1.9188988   3.2480836   0.43701994 -1.6799372  -0.7741005 ]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.21493596  0.30642375  0.04369019 -0.15479934 -0.08129071]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.21493596  0.30642375  0.04369019 -0.15479934 -0.08129071]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.21493596  0.30642375  0.04369019 -0.15479934 -0.08129071]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.02116198 -0.9233153  -0.08983825  0.2560418  -0.51440024]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.02116198 -0.9233153  -0.08983825  0.2560418  -0.51440024]
  [FlaxMamba2] xBC (step) sample values: [-0.7527055   0.73178685 -1.2306749   0.3780701   0.16870624]
  [FlaxMamba2] dt (step) sample values: [3.009446  1.9258668 1.8029963 1.868053  2.207259 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.8759526  -0.95520175 -0.03855772 -0.7527055   0.73010164]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.0378375   0.2194573  -0.1897704  -0.04335924  0.04989341]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00983096  0.14072195  0.12956554 -0.08434435 -0.01578042]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00489132  0.07530349  0.06897371 -0.04039473 -0.00782796]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00489132  0.07530349  0.06897371 -0.04039473 -0.00782796]
  [FlaxMamba2] B (step) sample values: [ 0.05998988 -0.08898751 -0.03355191 -0.09961146 -0.00448883]
  [FlaxMamba2] C (step) sample values: [ 0.17643723 -0.07007817 -0.00386865  0.00067195 -0.07624991]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.1489344 -3.5005836 -2.8320918 -5.5395546 -1.7185895]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02664904 0.24978144 0.329434   0.26593575 0.02570449]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.895328   0.41712022 0.3933768  0.22919878 0.95678604]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00489132  0.07530349  0.06897371 -0.04039473 -0.00782796]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.8196172e-06  1.1599428e-05  4.3734553e-06  1.2984248e-05
  5.8511375e-07]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.8196172e-06  1.1599428e-05  4.3734553e-06  1.2984248e-05
  5.8511375e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.04854204e-04 -1.18710894e-04 -3.01890668e-06 -2.44586525e-04
  9.19782397e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00208306  0.00134971  0.00192058  0.00024524 -0.0004531 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00326773  0.019588    0.01862581 -0.00953824 -0.00234901]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00326773  0.019588    0.01862581 -0.00953824 -0.00234901]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-3.4941611e-05 -5.1415102e-03 -7.9909834e-04 -1.3765717e-03
  4.5211139e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00019506 -0.08080335 -0.00716229 -0.03035525  0.00654652]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00019506 -0.08080335 -0.00716229 -0.03035525  0.00654652]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.2907256   0.32997274 -1.1713597   0.13155605 -0.51045305]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.2907256   0.32997274 -1.1713597   0.13155605 -0.51045305]
  [Layer 22] Output shape after mixer: (1, 1, 2048)
  [Layer 22] Output sample values after mixer: [ 0.2907256   0.32997274 -1.1713597   0.13155605 -0.51045305]
  [Layer 22] Residual connection shape: (1, 1, 2048)
  [Layer 22] Residual connection sample values: [ 2.2096243  3.5780563 -0.7343397 -1.5483812 -1.2845535]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.16150025  0.22500436 -0.04913565 -0.09788167 -0.09098214]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.16150025  0.22500436 -0.04913565 -0.09788167 -0.09098214]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.16150025  0.22500436 -0.04913565 -0.09788167 -0.09098214]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.06109057  0.16355045 -0.40537107  0.16934803 -0.24536988]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.06109057  0.16355045 -0.40537107  0.16934803 -0.24536988]
  [FlaxMamba2] xBC (step) sample values: [-0.30462316 -0.04722341 -0.2987645   0.5105397  -0.4207739 ]
  [FlaxMamba2] dt (step) sample values: [0.9678691  0.90479517 1.261131   0.3896081  1.542644  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.23471718  0.12287944 -0.2821976  -0.30462316 -0.44079065]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.11104923 -0.0362636  -0.09294288  0.11886788  0.13099958]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.13341862 -0.06937517 -0.10429542  0.11670686  0.08162214]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06226576 -0.03348484 -0.04943079  0.06175469  0.04247569]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06226576 -0.03348484 -0.04943079  0.06175469  0.04247569]
  [FlaxMamba2] B (step) sample values: [-0.05158939 -0.04237247  0.111536   -0.03696115  0.01196979]
  [FlaxMamba2] C (step) sample values: [-0.01518332 -0.01628001  0.07445128 -0.01165417  0.00440498]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.08112868 -3.7998476  -0.08256738 -0.48783726 -1.4532163 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03089059 0.10327759 0.03617059 0.00214908 0.00483985]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.997497   0.67540747 0.9970179  0.99895215 0.9929913 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06226576 -0.03348484 -0.04943079  0.06175469  0.04247569]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.9228389e-05  8.1500315e-05 -2.1453129e-04  7.1092058e-05
 -2.3023014e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.9228389e-05  8.1500315e-05 -2.1453129e-04  7.1092058e-05
 -2.3023014e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.7015549e-04  3.6162179e-04 -6.1164901e-04  1.2282380e-04
 -8.9433626e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.27756479e-03  6.05471214e-05 -7.67160382e-04  7.87217650e-05
  1.01206606e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 5.0760806e-05  7.7488465e-04  2.8735463e-04 -1.2387009e-03
 -8.0493418e-04]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 5.0760806e-05  7.7488465e-04  2.8735463e-04 -1.2387009e-03
 -8.0493418e-04]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-1.50315725e-06  6.85366394e-05 -4.65967350e-05 -1.13745715e-04
  8.66981864e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00028993  0.00167707 -0.00200251 -0.00784238  0.01751457]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00028993  0.00167707 -0.00200251 -0.00784238  0.01751457]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.46744537  1.1125276  -0.83093286  0.6542924   0.25692913]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.46744537  1.1125276  -0.83093286  0.6542924   0.25692913]
  [Layer 23] Output shape after mixer: (1, 1, 2048)
  [Layer 23] Output sample values after mixer: [-0.46744537  1.1125276  -0.83093286  0.6542924   0.25692913]
  [Layer 23] Residual connection shape: (1, 1, 2048)
  [Layer 23] Residual connection sample values: [ 1.7421789  4.690584  -1.5652726 -0.8940888 -1.0276244]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.09243032  0.23744088 -0.0765687  -0.04219138 -0.05286943]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09243032  0.23744088 -0.0765687  -0.04219138 -0.05286943]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09243032  0.23744088 -0.0765687  -0.04219138 -0.05286943]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.83767354  0.10542514  1.2170832  -0.31011066 -0.16478835]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.83767354  0.10542514  1.2170832  -0.31011066 -0.16478835]
  [FlaxMamba2] xBC (step) sample values: [-0.7060827   0.54867405  0.1106108   0.12706345 -0.30405343]
  [FlaxMamba2] dt (step) sample values: [2.3511462  1.1591759  0.42287767 1.317823   1.4385636 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.47222868  0.75474715 -0.12937313 -0.7060827   0.37858182]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.15244721 -0.03087172  0.01859866  0.03324125 -0.13892539]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.14910172 -0.03088083  0.01463901  0.03162382 -0.14365943]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.08009842 -0.01520203  0.00737308  0.01606191 -0.06667906]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.08009842 -0.01520203  0.00737308  0.01606191 -0.06667906]
  [FlaxMamba2] B (step) sample values: [ 0.05945723  0.05436646 -0.01607461  0.01489639  0.08521166]
  [FlaxMamba2] C (step) sample values: [-0.12092857 -0.12698355 -0.27098125 -0.13284977  0.08633482]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.07415762 -3.4496791  -3.2884939  -0.16087165 -2.6944954 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05633867 0.08985779 0.06895522 0.01701755 0.08803713]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9958308  0.7334612  0.797113   0.9972661  0.78882116]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.08009842 -0.01520203  0.00737308  0.01606191 -0.06667906]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.6830897e-04  2.4533618e-04 -7.2538911e-05  6.7222005e-05
  3.8452938e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.6830897e-04  2.4533618e-04 -7.2538911e-05  6.7222005e-05
  3.8452938e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [1.8443367e-04 5.9872621e-04 9.9694298e-05 9.7389457e-05 6.5088738e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00080157 -0.00039922 -0.00024092 -0.00064815 -0.00159938]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00122798 -0.00031829 -0.00028017 -0.00073366 -0.0012444 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00122798 -0.00031829 -0.00028017 -0.00073366 -0.0012444 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-7.1797241e-04 -1.7661516e-05 -2.6309153e-04  9.6258511e-05
  9.4102557e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.05008207 -0.00174525 -0.02347756  0.03133664  0.01812332]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.05008207 -0.00174525 -0.02347756  0.03133664  0.01812332]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.941451   -0.03002484  0.77195925  0.28161     0.35165462]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.941451   -0.03002484  0.77195925  0.28161     0.35165462]
  [Layer 24] Output shape after mixer: (1, 1, 2048)
  [Layer 24] Output sample values after mixer: [ 0.941451   -0.03002484  0.77195925  0.28161     0.35165462]
  [Layer 24] Residual connection shape: (1, 1, 2048)
  [Layer 24] Residual connection sample values: [ 2.68363    4.660559  -0.7933133 -0.6124788 -0.6759697]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13809003  0.21919279 -0.03854766 -0.02782492 -0.03441266]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13809003  0.21919279 -0.03854766 -0.02782492 -0.03441266]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13809003  0.21919279 -0.03854766 -0.02782492 -0.03441266]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.0618676   0.02233563  0.70042235  0.22138862 -0.30218142]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.0618676   0.02233563  0.70042235  0.22138862 -0.30218142]
  [FlaxMamba2] xBC (step) sample values: [-0.81913954 -0.11455661 -0.29017028  0.4649616  -0.10418594]
  [FlaxMamba2] dt (step) sample values: [1.9249108  0.24298263 2.016704   2.0353727  1.8681067 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.66385597  0.2826066   0.30831322 -0.81913954  0.27833366]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.08025227  0.07263087  0.11099033 -0.04037415  0.16209155]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.08280621  0.04441737  0.09957676  0.02044738  0.15632755]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03968987  0.02270183  0.05226521  0.01032821  0.08426093]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03968987  0.02270183  0.05226521  0.01032821  0.08426093]
  [FlaxMamba2] B (step) sample values: [-0.01241247  0.10385784  0.06454359 -0.05259392  0.01793586]
  [FlaxMamba2] C (step) sample values: [ 0.01916769  0.05412981 -0.10929435 -0.06378823 -0.07902941]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -0.37022203  -1.5044799   -5.7209826   -0.81757224 -14.66622   ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.6971143  0.00813266 0.18186139 0.05264468 0.1945626 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.77252793 0.9878391  0.3533042  0.9578723  0.05764235]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03968987  0.02270183  0.05226521  0.01032821  0.08426093]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00034343 -0.00287358 -0.00178582  0.00145519 -0.00049626]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00034343 -0.00287358 -0.00178582  0.00145519 -0.00049626]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00010134 -0.0019521  -0.0031733   0.00179589 -0.00053153]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-4.3034796e-03  4.5043082e-05  6.4309696e-03  8.4804319e-04
  1.1556945e-02]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00471811  0.00028221  0.00697698  0.00095594  0.01243721]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00471811  0.00028221  0.00697698  0.00095594  0.01243721]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-1.50462540e-04  3.18682146e-06  3.26577830e-03  1.17482945e-04
 -1.59736595e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-1.0405480e-02  1.5055174e-04  2.4906152e-01  5.3446889e-03
 -1.5912499e-01]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-1.0405480e-02  1.5055174e-04  2.4906152e-01  5.3446889e-03
 -1.5912499e-01]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.34469     0.07779885 -0.44443738 -0.07075029 -0.60799414]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.34469     0.07779885 -0.44443738 -0.07075029 -0.60799414]
  [Layer 25] Output shape after mixer: (1, 1, 2048)
  [Layer 25] Output sample values after mixer: [ 0.34469     0.07779885 -0.44443738 -0.07075029 -0.60799414]
  [Layer 25] Residual connection shape: (1, 1, 2048)
  [Layer 25] Residual connection sample values: [ 3.02832    4.738358  -1.2377508 -0.6832291 -1.2839639]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.18218353  0.26377007 -0.06937313 -0.03756504 -0.07553211]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18218353  0.26377007 -0.06937313 -0.03756504 -0.07553211]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18218353  0.26377007 -0.06937313 -0.03756504 -0.07553211]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.23738748 -0.3786691   0.01417891 -0.39003173 -0.87817323]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.23738748 -0.3786691   0.01417891 -0.39003173 -0.87817323]
  [FlaxMamba2] xBC (step) sample values: [ 0.3082994  -0.35453346 -0.12046839 -0.14515166  0.23318519]
  [FlaxMamba2] dt (step) sample values: [1.9421631 1.8877691 1.5429286 2.2536378 3.018566 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.44917983  0.8613749  -0.5563709   0.3082994  -0.18353921]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.21308623  0.19394198 -0.00917187  0.00203945  0.00082633]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.12458526  0.13788119  0.05497608 -0.02490757  0.00893638]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.06616798  0.07368588  0.02824344 -0.0122987   0.00448815]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06616798  0.07368588  0.02824344 -0.0122987   0.00448815]
  [FlaxMamba2] B (step) sample values: [-0.04840556  0.07510766  0.00816406  0.06546393  0.05512167]
  [FlaxMamba2] C (step) sample values: [-0.16035652 -0.03879418 -0.01446197  0.00267014 -0.04140241]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9594627  -0.39448437 -0.84198165 -1.4275463  -0.14661841]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.34182483 0.56704426 0.26390675 0.73283297 0.20338361]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7203859  0.7995629  0.80075145 0.35128656 0.97062045]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06616798  0.07368588  0.02824344 -0.0122987   0.00448815]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00109483  0.00169877  0.00018465  0.00148065  0.00124673]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00109483  0.00169877  0.00018465  0.00148065  0.00124673]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00053324 -0.00204282 -0.00406538  0.00200056 -0.00109787]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00485314  0.00935063  0.00219452 -0.00218473  0.00812322]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00357566  0.0187371   0.0057923  -0.0037514   0.00869494]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00357566  0.0187371   0.0057923  -0.0037514   0.00869494]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-3.7426865e-04 -2.8838126e-03  4.1355368e-05  5.9069385e-04
 -2.2414988e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.0054644  -0.0935011   0.00114096  0.02481158 -0.08219941]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0054644  -0.0935011   0.00114096  0.02481158 -0.08219941]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.8225869   0.25889558 -1.1799682  -0.66818273 -0.46762106]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.8225869   0.25889558 -1.1799682  -0.66818273 -0.46762106]
  [Layer 26] Output shape after mixer: (1, 1, 2048)
  [Layer 26] Output sample values after mixer: [ 0.8225869   0.25889558 -1.1799682  -0.66818273 -0.46762106]
  [Layer 26] Residual connection shape: (1, 1, 2048)
  [Layer 26] Residual connection sample values: [ 3.8509068  4.9972534 -2.417719  -1.3514118 -1.751585 ]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.23035935  0.27277222 -0.14158908 -0.07268125 -0.108997  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.23035935  0.27277222 -0.14158908 -0.07268125 -0.108997  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.23035935  0.27277222 -0.14158908 -0.07268125 -0.108997  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.476621   -0.56493795  0.3578082  -0.22886698  0.627146  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.476621   -0.56493795  0.3578082  -0.22886698  0.627146  ]
  [FlaxMamba2] xBC (step) sample values: [0.38961276 0.2958978  0.30402353 0.8095077  0.18610391]
  [FlaxMamba2] dt (step) sample values: [1.9152392 1.7045832 1.6175288 2.1777833 2.4298255]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.71732396 -0.17093506  0.2306327   0.38961276  0.03014725]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.08100913  0.23064311  0.13494706 -0.5219809   0.01093749]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.05500816  0.19414409  0.1249373  -0.7238852  -0.01884766]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02826036  0.10646553  0.06636591 -0.23637602 -0.00933503]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02826036  0.10646553  0.06636591 -0.23637602 -0.00933503]
  [FlaxMamba2] B (step) sample values: [-0.05983957 -0.00083884  0.16289468 -0.13283561  0.0304676 ]
  [FlaxMamba2] C (step) sample values: [-0.00529233 -0.25218663 -0.04715265 -0.08614352 -0.09813578]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3661706 -1.3799144 -1.8267511 -2.0408754 -2.3490334]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.25702032 0.23494762 0.22430147 0.13883507 0.42131   ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7038897  0.72310007 0.66382086 0.7532598  0.37169886]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02826036  0.10646553  0.06636591 -0.23637602 -0.00933503]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.3464400e-04 -6.0929151e-06  1.1831835e-03 -9.6484984e-04
  2.2130104e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.3464400e-04 -6.0929151e-06  1.1831835e-03 -9.6484984e-04
  2.2130104e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0001971  -0.00012144  0.00196375 -0.00092009  0.00075576]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00450585  0.01180764  0.00277273 -0.03180484  0.00145469]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00736399  0.02257512  0.0094847  -0.05571093  0.00051059]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00736399  0.02257512  0.0094847  -0.05571093  0.00051059]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00134444 -0.00462196  0.00199723  0.00564883  0.00020873]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.02926617 -0.07315122  0.0545898   0.13893008  0.00315669]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02926617 -0.07315122  0.0545898   0.13893008  0.00315669]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.5878558  -0.04483893 -1.5482738  -0.68429625 -1.8303386 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.5878558  -0.04483893 -1.5482738  -0.68429625 -1.8303386 ]
  [Layer 27] Output shape after mixer: (1, 1, 2048)
  [Layer 27] Output sample values after mixer: [-0.5878558  -0.04483893 -1.5482738  -0.68429625 -1.8303386 ]
  [Layer 27] Residual connection shape: (1, 1, 2048)
  [Layer 27] Residual connection sample values: [ 3.263051   4.9524145 -3.9659927 -2.035708  -3.5819235]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.17517774  0.24876507 -0.20126455 -0.1004157  -0.19033074]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.17517774  0.24876507 -0.20126455 -0.1004157  -0.19033074]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.17517774  0.24876507 -0.20126455 -0.1004157  -0.19033074]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.8247916   0.5722849  -0.5674063  -0.12665433  0.0193753 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.8247916   0.5722849  -0.5674063  -0.12665433  0.0193753 ]
  [FlaxMamba2] xBC (step) sample values: [-0.56316453 -0.7451325  -0.20165586 -1.1506722  -0.91614074]
  [FlaxMamba2] dt (step) sample values: [1.2345377 1.7189698 2.3000102 1.9058504 1.8892652]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.56419134 -1.2130473  -0.68640137 -0.56316453 -0.7532583 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.03983907  0.3503757  -0.02068347 -0.21181947  0.12554494]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.0179307   0.33901554 -0.03434771 -0.2231949   0.23022023]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00888498  0.19796859 -0.01687894 -0.09919491  0.12830223]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00888498  0.19796859 -0.01687894 -0.09919491  0.12830223]
  [FlaxMamba2] B (step) sample values: [ 0.07644436 -0.05041051 -0.13014199  0.02441275  0.23559777]
  [FlaxMamba2] C (step) sample values: [-0.0693167  -0.13608867  0.46761316 -0.00777049  0.35204607]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2727895 -3.997792  -2.517685  -2.1714401 -2.8654757]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03456798 0.223885   0.35458344 0.10989874 0.09678171]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9569561  0.40858895 0.40953642 0.7876996  0.7578077 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00888498  0.19796859 -0.01687894 -0.09919491  0.12830223]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.3478791e-05  1.5482869e-05  3.9971248e-05 -7.4980267e-06
 -7.2360483e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.3478791e-05  1.5482869e-05  3.9971248e-05 -7.4980267e-06
 -7.2360483e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 8.4248859e-06 -1.7672368e-04  1.9662908e-05  3.6958867e-04
  1.2377443e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00029065  0.00577234  0.0005286  -0.00223996  0.00271401]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00163537  0.04868652 -0.00313029 -0.0237427   0.03052643]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00163537  0.04868652 -0.00313029 -0.0237427   0.03052643]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.00041106 0.01781226 0.00064267 0.00140847 0.00029859]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.02117104 0.607995   0.02078131 0.05259274 0.01081593]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.02117104 0.607995   0.02078131 0.05259274 0.01081593]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.18077038  1.4478164  -2.9445174   2.4272377  -0.90282786]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.18077038  1.4478164  -2.9445174   2.4272377  -0.90282786]
  [Layer 28] Output shape after mixer: (1, 1, 2048)
  [Layer 28] Output sample values after mixer: [-0.18077038  1.4478164  -2.9445174   2.4272377  -0.90282786]
  [Layer 28] Residual connection shape: (1, 1, 2048)
  [Layer 28] Residual connection sample values: [ 3.0822806  6.400231  -6.91051    0.3915298 -4.484751 ]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.14378487  0.2855496  -0.3087233   0.01684526 -0.20801908]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14378487  0.2855496  -0.3087233   0.01684526 -0.20801908]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14378487  0.2855496  -0.3087233   0.01684526 -0.20801908]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.50555015  0.17427473  0.3535617  -0.18996362  0.0957093 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.50555015  0.17427473  0.3535617  -0.18996362  0.0957093 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.76493245  0.5886976   0.5918007  -0.93201035  0.263786  ]
  [FlaxMamba2] dt (step) sample values: [1.0795239  1.0070347  0.8309088  1.3512285  0.82167035]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.60593826  0.7516267   0.8002835   0.76493245 -0.30996993]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.06221259 -0.16978745 -0.10577683  0.20106013  0.01437293]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.07561743 -0.20430283 -0.10292916  0.14063533 -0.09872521]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.0363799  -0.09175265 -0.04881832  0.07525411 -0.04692791]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0363799  -0.09175265 -0.04881832  0.07525411 -0.04692791]
  [FlaxMamba2] B (step) sample values: [-0.00826944  0.0293506  -0.04791407  0.09456451 -0.02347011]
  [FlaxMamba2] C (step) sample values: [-0.13826793 -0.15246412 -0.20866802 -0.27779987 -0.2755885 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8072329  -2.117      -1.925669   -0.29044876 -2.049864  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0612344  0.12989393 0.14046435 0.00606676 0.13749176]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.89523876 0.7595832  0.76300716 0.99823946 0.75439477]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0363799  -0.09175265 -0.04881832  0.07525411 -0.04692791]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.8421846e-05 -6.5384360e-05  1.0673821e-04 -2.1066146e-04
  5.2284391e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.8421846e-05 -6.5384360e-05  1.0673821e-04 -2.1066146e-04
  5.2284391e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.2712897e-04  6.3899002e-05  2.6508016e-04  3.0692841e-05
 -1.3317565e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0060298  -0.00846122 -0.0105758   0.01703028 -0.01560747]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0432293  -0.10228097 -0.06049395  0.09397978 -0.06359262]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0432293  -0.10228097 -0.06049395  0.09397978 -0.06359262]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00822251 -0.00968715 -0.01256525 -0.00808107 -0.00318872]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.06464475 -0.07167166 -0.14729854 -0.08497507 -0.02974766]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.06464475 -0.07167166 -0.14729854 -0.08497507 -0.02974766]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.56501967  1.3473723   0.10704605 -0.4373239  -0.40886205]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.56501967  1.3473723   0.10704605 -0.4373239  -0.40886205]
  [Layer 29] Output shape after mixer: (1, 1, 2048)
  [Layer 29] Output sample values after mixer: [-0.56501967  1.3473723   0.10704605 -0.4373239  -0.40886205]
  [Layer 29] Residual connection shape: (1, 1, 2048)
  [Layer 29] Residual connection sample values: [ 2.517261   7.7476034 -6.803464  -0.0457941 -4.8936133]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.11345486  0.34358406 -0.29960427 -0.00190184 -0.22662926]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11345486  0.34358406 -0.29960427 -0.00190184 -0.22662926]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11345486  0.34358406 -0.29960427 -0.00190184 -0.22662926]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.6814102  -0.14116718 -1.5066024   0.37015283 -0.1956457 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.6814102  -0.14116718 -1.5066024   0.37015283 -0.1956457 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.1255277  -0.62038404 -0.15888442  0.08349867  0.57935685]
  [FlaxMamba2] dt (step) sample values: [1.1715662 2.21282   2.2956548 2.6699066 2.1994092]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.0781267   0.15517214  0.6973957   1.1255277  -0.564878  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.18100736 -0.08507331 -0.0677829  -0.0135675  -0.0897734 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.15772244 -0.07137091 -0.03464081 -0.0317102  -0.11711715]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.08506745 -0.03441255 -0.01702044 -0.01560374 -0.05513338]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.08506745 -0.03441255 -0.01702044 -0.01560374 -0.05513338]
  [FlaxMamba2] B (step) sample values: [ 0.32397902 -0.04040515  0.01525955  0.12560746 -0.02716936]
  [FlaxMamba2] C (step) sample values: [-0.2706071  -0.23773198 -0.24483754 -0.10241117 -0.16161913]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0149885  -0.4675477  -0.42799968 -0.7895216  -0.4174731 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0128004  0.69506687 1.2974238  0.6020097  0.6864292 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9870918  0.722544   0.57390183 0.62169874 0.75083774]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.08506745 -0.03441255 -0.01702044 -0.01560374 -0.05513338]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.5278001e-04 -4.3997072e-05  1.6616088e-05  1.3677367e-04
 -2.9584657e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.5278001e-04 -4.3997072e-05  1.6616088e-05  1.3677367e-04
 -2.9584657e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 4.8351986e-04 -1.2438804e-04 -6.1213999e-05  6.2505348e-04
 -6.7284425e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 5.274002e-04 -3.818517e-04 -8.295402e-04 -8.077271e-06  4.427061e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.10532404 -0.0427755  -0.02179743 -0.01923069 -0.06747743]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.10532404 -0.0427755  -0.02179743 -0.01923069 -0.06747743]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02411051  0.00280649  0.00595859 -0.00421044  0.00595717]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.29932883  0.03536297  0.04558117 -0.04339436  0.05456378]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.29932883  0.03536297  0.04558117 -0.04339436  0.05456378]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.490448    0.8562557  -1.6842741   5.54847     0.32612628]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.490448    0.8562557  -1.6842741   5.54847     0.32612628]
  [Layer 30] Output shape after mixer: (1, 1, 2048)
  [Layer 30] Output sample values after mixer: [-2.490448    0.8562557  -1.6842741   5.54847     0.32612628]
  [Layer 30] Residual connection shape: (1, 1, 2048)
  [Layer 30] Residual connection sample values: [ 0.02681303  8.603859   -8.487738    5.502676   -4.5674872 ]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00108076  0.34025204 -0.33663842  0.2124089  -0.18599932]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00108076  0.34025204 -0.33663842  0.2124089  -0.18599932]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00108076  0.34025204 -0.33663842  0.2124089  -0.18599932]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.855201   -0.07673711  0.41133827  0.4040838  -0.7596588 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.855201   -0.07673711  0.41133827  0.4040838  -0.7596588 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.07625837  0.3346107   0.6343512   1.002719   -0.2970771 ]
  [FlaxMamba2] dt (step) sample values: [2.2687387 2.1083148 1.4608866 0.3621108 1.6106291]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5427158  -0.30198482  1.1247746   0.07625837 -0.42150083]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01506105 -0.04501377  0.13164814 -0.16824222  0.03632705]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01456561 -0.05533634  0.13266285 -0.17014003  0.03102462]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00733585 -0.02690284  0.07072484 -0.07785051  0.01575292]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00733585 -0.02690284  0.07072484 -0.07785051  0.01575292]
  [FlaxMamba2] B (step) sample values: [-1.3608016e-02 -5.0023001e-02  2.0195674e-05 -2.6777914e-01
 -3.5800926e-02]
  [FlaxMamba2] C (step) sample values: [ 0.22505446 -0.02603353 -0.15497632 -0.04045746  0.03869034]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.9477868 -3.5383902 -4.705952  -2.462968  -0.9027082]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.28095597 0.17325343 0.06633168 0.08478062 0.19255927]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.43683562 0.54170257 0.73186904 0.8115478  0.8404441 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00733585 -0.02690284  0.07072484 -0.07785051  0.01575292]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.80468012e-05 -1.03099905e-04  4.16242898e-08 -5.51906181e-04
 -7.37874943e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.80468012e-05 -1.03099905e-04  4.16242898e-08 -5.51906181e-04
 -7.37874943e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00225067  0.00104414  0.0002933  -0.00223382 -0.00053943]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00555245 -0.00286416  0.01360899 -0.01159512  0.0092982 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01059963 -0.02137376  0.06226885 -0.06515756  0.02013647]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01059963 -0.02137376  0.06226885 -0.06515756  0.02013647]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00270442  0.00078863  0.01540422 -0.01578874 -0.00487542]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.04140098  0.01054652  0.18343933 -0.20012149 -0.07322972]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.04140098  0.01054652  0.18343933 -0.20012149 -0.07322972]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.60166085  0.15640858 -1.1264141  -0.66062444 -1.0894545 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.60166085  0.15640858 -1.1264141  -0.66062444 -1.0894545 ]
  [Layer 31] Output shape after mixer: (1, 1, 2048)
  [Layer 31] Output sample values after mixer: [ 0.60166085  0.15640858 -1.1264141  -0.66062444 -1.0894545 ]
  [Layer 31] Residual connection shape: (1, 1, 2048)
  [Layer 31] Residual connection sample values: [ 0.6284739  8.760267  -9.614152   4.8420515 -5.656942 ]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02457597  0.3440374  -0.37656042  0.17763145 -0.23001574]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.02457597  0.3440374  -0.37656042  0.17763145 -0.23001574]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.02457597  0.3440374  -0.37656042  0.17763145 -0.23001574]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.45422873 -0.67866117 -1.2467312  -1.0541303  -0.43951184]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.45422873 -0.67866117 -1.2467312  -1.0541303  -0.43951184]
  [FlaxMamba2] xBC (step) sample values: [ 0.49158794 -0.18140157  0.6073349   0.94624287  0.78071475]
  [FlaxMamba2] dt (step) sample values: [1.2999966 2.3253517 1.6373452 2.3869822 2.3728316]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.04304145 -0.19561742 -0.927233    0.49158794  0.23182982]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.2643189   0.0079493  -0.06626346 -0.17919923 -0.01215605]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.30148932 -0.04408317 -0.08210208 -0.16671754 -0.01912932]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.17329805 -0.02155583 -0.0393668  -0.07642613 -0.00947318]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.17329805 -0.02155583 -0.0393668  -0.07642613 -0.00947318]
  [FlaxMamba2] B (step) sample values: [ 0.06426191  0.07941677  0.0150625  -0.09142087 -0.05194385]
  [FlaxMamba2] C (step) sample values: [-0.2760271  -0.19377984 -0.06327427 -0.2777102  -0.20128253]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6970906 -2.0892735 -1.7966746 -1.3893797 -1.0395182]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.26102966 0.05431969 0.4869839  0.76711625 1.0459435 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.83363354 0.8927143  0.4168822  0.34444675 0.33713317]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.17329805 -0.02155583 -0.0393668  -0.07642613 -0.00947318]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00290695  0.00359249  0.00068137 -0.00413551 -0.00234973]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00290695  0.00359249  0.00068137 -0.00413551 -0.00234973]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00317513  0.0045565   0.00133086 -0.0054279  -0.00231069]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0242295  -0.01997879 -0.00561303 -0.01194624  0.00580736]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.06579952 -0.02514951 -0.01505618 -0.03027903  0.00353498]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.06579952 -0.02514951 -0.01505618 -0.03027903  0.00353498]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01160719  0.00574441  0.00419094  0.00824867 -0.00060881]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.11017119  0.04385993  0.06214445  0.10011482 -0.00604321]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.11017119  0.04385993  0.06214445  0.10011482 -0.00604321]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.877139    0.6949955  -1.240113    0.52477026 -3.8034863 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.877139    0.6949955  -1.240113    0.52477026 -3.8034863 ]
  [Layer 32] Output shape after mixer: (1, 1, 2048)
  [Layer 32] Output sample values after mixer: [-1.877139    0.6949955  -1.240113    0.52477026 -3.8034863 ]
  [Layer 32] Residual connection shape: (1, 1, 2048)
  [Layer 32] Residual connection sample values: [ -1.2486651   9.455263  -10.854265    5.366822   -9.460428 ]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.04680965  0.36731255 -0.41449195  0.199001   -0.36732945]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04680965  0.36731255 -0.41449195  0.199001   -0.36732945]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04680965  0.36731255 -0.41449195  0.199001   -0.36732945]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.13975257  0.5406143  -1.7533755   0.93871665  0.18266724]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.13975257  0.5406143  -1.7533755   0.93871665  0.18266724]
  [FlaxMamba2] xBC (step) sample values: [-1.0278451  -0.00706927  0.9949247  -1.4221404   0.7593648 ]
  [FlaxMamba2] dt (step) sample values: [-0.17576659  0.65698004  1.230225    2.0531726  -0.89811116]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5178368  -0.07010851 -0.30283353 -1.0278451   1.0433941 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.15224522 -0.19378944 -0.18131527 -0.24996465 -0.13788101]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.16539067 -0.24316688 -0.15449032 -0.25117105 -0.13907024]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07587236 -0.10687333 -0.07129019 -0.10989619 -0.06470777]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07587236 -0.10687333 -0.07129019 -0.10989619 -0.06470777]
  [FlaxMamba2] B (step) sample values: [ 0.0296969  -0.08516278  0.05706844  0.03712305 -0.00973292]
  [FlaxMamba2] C (step) sample values: [-0.0038275  -0.09590489 -0.15359896 -0.02637219 -0.03236459]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9790505  -9.693779   -6.1677613  -0.11351943 -2.090294  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00987049 0.01917429 0.04365123 0.06164268 0.00117058]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9806554  0.83038044 0.7639672  0.9930268  0.99755615]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07587236 -0.10687333 -0.07129019 -0.10989619 -0.06470777]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.2239929e-05  6.3778185e-05 -4.2738404e-05 -2.7801356e-05
  7.2889593e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.2239929e-05  6.3778185e-05 -4.2738404e-05 -2.7801356e-05
  7.2889593e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.5382755e-04  5.2125237e-05 -6.1870916e-05 -2.8911983e-05
  7.5487231e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-2.8727780e-04 -2.5421422e-04  8.0880629e-05 -6.3447829e-04
 -8.2722591e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.079291   -0.11153836 -0.07415155 -0.11506625 -0.06820558]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.079291   -0.11153836 -0.07415155 -0.11506625 -0.06820558]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00515404 -0.03810642  0.01919315 -0.07764525 -0.00679685]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.06376272 -0.2809627   0.17831579 -0.70455116 -0.06979951]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.06376272 -0.2809627   0.17831579 -0.70455116 -0.06979951]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.1294653   1.6997069  -0.7989934   0.82319564 -1.2768222 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.1294653   1.6997069  -0.7989934   0.82319564 -1.2768222 ]
  [Layer 33] Output shape after mixer: (1, 1, 2048)
  [Layer 33] Output sample values after mixer: [ 3.1294653   1.6997069  -0.7989934   0.82319564 -1.2768222 ]
  [Layer 33] Residual connection shape: (1, 1, 2048)
  [Layer 33] Residual connection sample values: [  1.8808002  11.15497   -11.653258    6.190017  -10.73725  ]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05099361  0.32045773 -0.31575128  0.1692108  -0.30532134]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05099361  0.32045773 -0.31575128  0.1692108  -0.30532134]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05099361  0.32045773 -0.31575128  0.1692108  -0.30532134]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.22668605  0.31152663 -0.6188568  -0.3443297  -1.0278709 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.22668605  0.31152663 -0.6188568  -0.3443297  -1.0278709 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.5365614  -0.23370919 -0.74521023 -0.6893544  -0.07528693]
  [FlaxMamba2] dt (step) sample values: [ 1.112445    0.45906022  1.8457296  -1.3012927  -1.2892919 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.04098805 0.5417618  0.34320295 0.5365614  0.07387628]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.13467073  0.04404896 -0.13247477  0.16889524 -0.01500069]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.1665616   0.07008046 -0.14441477  0.12937498 -0.02353798]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.0763611   0.03626754 -0.06700253  0.06886613 -0.01163049]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0763611   0.03626754 -0.06700253  0.06886613 -0.01163049]
  [FlaxMamba2] B (step) sample values: [ 0.05624826  0.00470373 -0.03544834  0.06328443 -0.03547546]
  [FlaxMamba2] C (step) sample values: [-0.02096725 -0.21149637 -0.24254116 -0.0694345  -0.19240035]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.5610816  -2.4810736  -2.893596   -0.01585086 -0.02613366]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.15109664 0.05086454 0.05799094 0.00393582 0.00206846]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6791109  0.8814397  0.845521   0.9999376  0.99994594]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0763611   0.03626754 -0.06700253  0.06886613 -0.01163049]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.4898713e-04 -5.4271244e-05  4.0899968e-04 -7.3016988e-04
  4.0931258e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.4898713e-04 -5.4271244e-05  4.0899968e-04 -7.3016988e-04
  4.0931258e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.2542986e-03  7.2687544e-07  5.9244363e-04 -1.5173685e-03
  5.9829780e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00298003  0.00128565 -0.00077033  0.00483956  0.00222789]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05001413  0.0236244  -0.04204008  0.04725718 -0.00493583]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05001413  0.0236244  -0.04204008  0.04725718 -0.00493583]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00502898  0.0042484   0.00910695 -0.00674897  0.00133682]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.13185298  0.10832673  0.26548457 -0.22122943  0.04161942]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.13185298  0.10832673  0.26548457 -0.22122943  0.04161942]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.44508    -2.6243212  -3.0755134   1.7114973  -0.67101675]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.44508    -2.6243212  -3.0755134   1.7114973  -0.67101675]
  [Layer 34] Output shape after mixer: (1, 1, 2048)
  [Layer 34] Output sample values after mixer: [ 2.44508    -2.6243212  -3.0755134   1.7114973  -0.67101675]
  [Layer 34] Residual connection shape: (1, 1, 2048)
  [Layer 34] Residual connection sample values: [  4.32588     8.530649  -14.728771    7.9015145 -11.408267 ]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.1299283   0.25573513 -0.43444335  0.21861045 -0.33908945]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1299283   0.25573513 -0.43444335  0.21861045 -0.33908945]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1299283   0.25573513 -0.43444335  0.21861045 -0.33908945]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.5110044  -0.34142026  0.5476016   0.57176244  0.8491435 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.5110044  -0.34142026  0.5476016   0.57176244  0.8491435 ]
  [FlaxMamba2] xBC (step) sample values: [-1.697997   0.5343826 -0.3842083 -0.9529444  0.1064757]
  [FlaxMamba2] dt (step) sample values: [2.2697744  0.73672837 1.8537256  1.6803671  0.5324997 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.7414792  -0.08924146 -0.38777608 -1.697997    0.1216074 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.2846383  -0.14138024  0.05175692 -0.22233973  0.04039681]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.12863243 -0.10024254  0.01556307 -0.26729214 -0.00107658]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.0684471  -0.04761123  0.00784209 -0.11589038 -0.000538  ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0684471  -0.04761123  0.00784209 -0.11589038 -0.000538  ]
  [FlaxMamba2] B (step) sample values: [-0.04507664  0.27097216 -0.278022    0.18762897 -0.03245357]
  [FlaxMamba2] C (step) sample values: [-0.22396705  0.35645822 -0.14601724 -0.24213788 -0.17686792]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.709799  -2.7746034 -0.4452666 -1.139112  -3.5906036]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08473677 0.03517855 0.7376577  0.3144971  0.04371507]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.94162697 0.9070057  0.7200358  0.6989001  0.85473526]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0684471  -0.04761123  0.00784209 -0.11589038 -0.000538  ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00026144  0.00157163 -0.00161252  0.00108825 -0.00018823]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00026144  0.00157163 -0.00161252  0.00108825 -0.00018823]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00541388 -0.00410167  0.00979163 -0.01028334 -0.0002284 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00807334 -0.01458071 -0.00846311 -0.02022918  0.00533445]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03821938 -0.04678154 -0.00315929 -0.09860915  0.00497059]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03821938 -0.04678154 -0.00315929 -0.09860915  0.00497059]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01044056  0.00663587 -0.00109611 -0.03603704  0.00295616]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.22214341  0.07511335 -0.00876664 -0.333164    0.03669679]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.22214341  0.07511335 -0.00876664 -0.333164    0.03669679]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.0566953  6.8862157 -2.801043   2.5567632 -3.5576801]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.0566953  6.8862157 -2.801043   2.5567632 -3.5576801]
  [Layer 35] Output shape after mixer: (1, 1, 2048)
  [Layer 35] Output sample values after mixer: [-1.0566953  6.8862157 -2.801043   2.5567632 -3.5576801]
  [Layer 35] Residual connection shape: (1, 1, 2048)
  [Layer 35] Residual connection sample values: [  3.2691846  15.416864  -17.529814   10.458278  -14.965947 ]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07779901  0.3714489  -0.41426328  0.24553958 -0.36466005]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07779901  0.3714489  -0.41426328  0.24553958 -0.36466005]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07779901  0.3714489  -0.41426328  0.24553958 -0.36466005]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.8205041  -0.709286    0.13026744 -1.6749175  -0.33348235]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.8205041  -0.709286    0.13026744 -1.6749175  -0.33348235]
  [FlaxMamba2] xBC (step) sample values: [-0.54411405  1.0577841  -0.09156713 -0.37806544  0.13738799]
  [FlaxMamba2] dt (step) sample values: [0.49502516 3.2158492  0.6214759  3.6512825  1.475656  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.00556935  0.05992574  0.46189055 -0.54411405 -0.31734365]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06806713  0.19808437  0.01573254 -0.06870397 -0.04714133]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03187329  0.19795062 -0.01275562 -0.09363683 -0.07500388]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.0161906   0.10873956 -0.00633713 -0.04462806 -0.0360962 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0161906   0.10873956 -0.00633713 -0.04462806 -0.0360962 ]
  [FlaxMamba2] B (step) sample values: [ 0.08035603  0.32569405 -0.00257462 -0.11426201 -0.07900714]
  [FlaxMamba2] C (step) sample values: [ 0.7625782  -0.278459   -0.27236307 -0.12181043 -0.1552717 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6566098 -1.1305923 -1.6058172 -2.4414158 -2.882315 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06907759 0.08803222 0.03976983 0.89056873 0.1680686 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.83234173 0.9052641  0.9381334  0.11369357 0.6160503 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0161906   0.10873956 -0.00633713 -0.04462806 -0.0360962 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.9870788e-05  3.6425865e-04 -2.8794786e-06 -1.2779149e-04
 -8.8362176e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.9870788e-05  3.6425865e-04 -2.8794786e-06 -1.2779149e-04
 -8.8362176e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00105383 -0.00334749 -0.00029479  0.00086894  0.00062009]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00210778  0.0054225  -0.00590287 -0.00118592 -0.00317883]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.0164432   0.13001487 -0.01316388 -0.05232016 -0.04453738]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.0164432   0.13001487 -0.01316388 -0.05232016 -0.04453738]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00412383 -0.03040941 -0.00091318  0.01382566  0.00619931]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.05109121 -0.5495939  -0.01114813  0.18996751  0.0737408 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.05109121 -0.5495939  -0.01114813  0.18996751  0.0737408 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.254011   3.4447918 -6.526556   0.8556016 -2.3532255]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.254011   3.4447918 -6.526556   0.8556016 -2.3532255]
  [Layer 36] Output shape after mixer: (1, 1, 2048)
  [Layer 36] Output sample values after mixer: [ 3.254011   3.4447918 -6.526556   0.8556016 -2.3532255]
  [Layer 36] Residual connection shape: (1, 1, 2048)
  [Layer 36] Residual connection sample values: [  6.5231953  18.861656  -24.05637    11.313879  -17.319172 ]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.1569585   0.46433282 -0.5718967   0.26337323 -0.41993806]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1569585   0.46433282 -0.5718967   0.26337323 -0.41993806]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1569585   0.46433282 -0.5718967   0.26337323 -0.41993806]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.20668708  1.5669457   1.455855   -2.830467   -0.26684695]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.20668708  1.5669457   1.455855   -2.830467   -0.26684695]
  [FlaxMamba2] xBC (step) sample values: [-0.07730158 -0.06128275  1.4291443   0.29166314  0.31708318]
  [FlaxMamba2] dt (step) sample values: [ 1.3881737  -0.47147036  1.040805    2.7083356   0.6051014 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.05946744  0.12987068 -0.68881214 -0.07730158 -0.27784273]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02407422  0.02617692  0.1398469   0.09891938  0.06975234]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.03645673 -0.00226546  0.14484797 -0.05195952  0.08449233]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01789613 -0.00113145  0.07766008 -0.02530497  0.04402984]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01789613 -0.00113145  0.07766008 -0.02530497  0.04402984]
  [FlaxMamba2] B (step) sample values: [ 0.10575903  0.18776089 -0.12117318 -0.0144761  -0.0800912 ]
  [FlaxMamba2] C (step) sample values: [-0.12703873  0.06853572 -0.17751348 -0.08237595 -0.23117849]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.06064401 -3.2470093  -0.81907064 -0.24529998 -1.975189  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03708697 0.00609966 0.02634546 0.01860039 0.02126143]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99775344 0.9803892  0.97865236 0.9954477  0.9588742 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01789613 -0.00113145  0.07766008 -0.02530497  0.04402984]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.0193666e-05 -1.2461939e-04  8.0424237e-05  9.6079802e-06
  5.3157586e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.0193666e-05 -1.2461939e-04  8.0424237e-05  9.6079802e-06
  5.3157586e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 6.0216946e-05 -5.4332917e-04 -7.2990602e-04  6.5136625e-04
 -3.1967499e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00295113 -0.00829176 -0.00687086  0.07004614  0.04672989]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00045452 -0.00807644 -0.02164965  0.07486171  0.03835096]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00045452 -0.00807644 -0.02164965  0.07486171  0.03835096]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 5.1809049e-05 -1.0470373e-02 -2.5558490e-02 -1.1802436e-02
 -4.4382242e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00039914 -0.07321078 -0.3521877  -0.30044964 -0.02525164]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00039914 -0.07321078 -0.3521877  -0.30044964 -0.02525164]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.2537327   0.40996882 -6.262334    5.9589667  -2.8882306 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.2537327   0.40996882 -6.262334    5.9589667  -2.8882306 ]
  [Layer 37] Output shape after mixer: (1, 1, 2048)
  [Layer 37] Output sample values after mixer: [ 2.2537327   0.40996882 -6.262334    5.9589667  -2.8882306 ]
  [Layer 37] Residual connection shape: (1, 1, 2048)
  [Layer 37] Residual connection sample values: [  8.776928  19.271626 -30.318703  17.272846 -20.207403]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.17355932  0.37821597 -0.5921981   0.3291794  -0.39469978]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.17355932  0.37821597 -0.5921981   0.3291794  -0.39469978]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.17355932  0.37821597 -0.5921981   0.3291794  -0.39469978]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.396222  -1.8167571 -1.1708789 -1.3578161 -2.033151 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.396222  -1.8167571 -1.1708789 -1.3578161 -2.033151 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.0854717   0.0791994   0.0298008  -2.031166    0.28596717]
  [FlaxMamba2] dt (step) sample values: [1.4805439 0.6469174 3.0007582 0.9998142 0.7870428]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.07999338  0.3685623   0.9851128   1.0854717  -0.26914316]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.20618887 -0.08258153  0.01005047  0.41364977  0.07390377]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.17809744 -0.11975195 -0.01572162  0.40204546  0.05264828]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.08113994 -0.05629512 -0.00779902  0.24089721  0.02701694]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08113994 -0.05629512 -0.00779902  0.24089721  0.02701694]
  [FlaxMamba2] B (step) sample values: [-0.20649739 -0.27463976 -0.021455   -0.03358768 -0.26900774]
  [FlaxMamba2] C (step) sample values: [-0.14154407 -0.2275145  -0.25913846  0.16426301 -0.27675906]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0881431 -1.3535548 -1.1764196 -1.6451025 -1.1940706]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.21051466 0.05649239 1.5422184  0.11053253 0.04980297]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7952728  0.9263848  0.16295259 0.83373696 0.94226545]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08113994 -0.05629512 -0.00779902  0.24089721  0.02701694]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00352721 0.00469116 0.00036648 0.00057372 0.00459496]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00352721 0.00469116 0.00036648 0.00057372 0.00459496]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00742871 0.00860257 0.00083262 0.00096958 0.00837152]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01188707 -0.01617118  0.00262895  0.03619343  0.00774098]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07759612 -0.06176031 -0.00368689  0.23127772  0.02961994]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07759612 -0.06176031 -0.00368689  0.23127772  0.02961994]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01837891  0.01568868  0.00102179 -0.06424966 -0.00697164]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.35856235  0.29604456  0.0202272  -1.160262   -0.1132553 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.35856235  0.29604456  0.0202272  -1.160262   -0.1132553 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.5082533  -2.5770214  -1.9279892   5.249127    0.04702902]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.5082533  -2.5770214  -1.9279892   5.249127    0.04702902]
  [Layer 38] Output shape after mixer: (1, 1, 2048)
  [Layer 38] Output sample values after mixer: [ 1.5082533  -2.5770214  -1.9279892   5.249127    0.04702902]
  [Layer 38] Residual connection shape: (1, 1, 2048)
  [Layer 38] Residual connection sample values: [ 10.285181  16.694605 -32.246693  22.521973 -20.160374]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15354462  0.25179157 -0.48218346  0.33731595 -0.3045516 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15354462  0.25179157 -0.48218346  0.33731595 -0.3045516 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15354462  0.25179157 -0.48218346  0.33731595 -0.3045516 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.38160056 -0.02551022 -0.6329524  -0.10332812  0.04396961]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.38160056 -0.02551022 -0.6329524  -0.10332812  0.04396961]
  [FlaxMamba2] xBC (step) sample values: [-0.19454132  0.04537762 -0.0624183  -0.55391306 -0.24938634]
  [FlaxMamba2] dt (step) sample values: [ 1.1000156  2.4240727  1.5085001 -0.5609231 -1.0415765]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.6528985  -0.13210464  0.5098075  -0.19454132  0.7972386 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01815967 -0.00587315 -0.01051724 -0.12044802 -0.04556914]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.0324953   0.07933193 -0.03285611 -0.11637011 -0.06654998]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01598369  0.04123853 -0.0161582  -0.05480337 -0.03216818]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01598369  0.04123853 -0.0161582  -0.05480337 -0.03216818]
  [FlaxMamba2] B (step) sample values: [ 0.00920994  0.07530688 -0.01212912 -0.06391039  0.0371225 ]
  [FlaxMamba2] C (step) sample values: [ 0.3837051  -0.04852242  0.11738928  0.06082845 -0.11633399]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.69420344 -0.9242845  -1.3151171  -3.1532621  -2.1087465 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01447466 0.08208004 0.03955386 0.01572068 0.00914462]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.990002   0.92694104 0.9493118  0.95163715 0.98090106]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01598369  0.04123853 -0.0161582  -0.05480337 -0.03216818]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.1307987e-06 -1.7422890e-05  2.8061747e-06  1.4786215e-05
 -8.5886068e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.1307987e-06 -1.7422890e-05  2.8061747e-06  1.4786215e-05
 -8.5886068e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.5356462e-04 -1.2653951e-04  1.1615316e-04 -9.4228912e-05
  3.9730113e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00095437  0.00107749 -0.00201906 -0.00204693  0.003565  ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01274137  0.03641301 -0.01586432 -0.04900558 -0.02399852]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01274137  0.03641301 -0.01586432 -0.04900558 -0.02399852]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00288936 -0.00045853  0.00348276  0.00240114 -0.0005392 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.0767372  -0.01308156  0.10156929  0.0566227  -0.01449876]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0767372  -0.01308156  0.10156929  0.0566227  -0.01449876]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.3346276  -3.0120015  -1.6386915  -0.6743995   0.14879495]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.3346276  -3.0120015  -1.6386915  -0.6743995   0.14879495]
  [Layer 39] Output shape after mixer: (1, 1, 2048)
  [Layer 39] Output sample values after mixer: [ 2.3346276  -3.0120015  -1.6386915  -0.6743995   0.14879495]
  [Layer 39] Residual connection shape: (1, 1, 2048)
  [Layer 39] Residual connection sample values: [ 12.619808  13.682604 -33.885384  21.847572 -20.01158 ]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.16222814  0.17726687 -0.45069414  0.2835202  -0.25653067]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.16222814  0.17726687 -0.45069414  0.2835202  -0.25653067]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.16222814  0.17726687 -0.45069414  0.2835202  -0.25653067]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.02514003  1.0765171   0.5407286   0.568869    0.5738011 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.02514003  1.0765171   0.5407286   0.568869    0.5738011 ]
  [FlaxMamba2] xBC (step) sample values: [-0.30313236 -0.24345244  0.619604   -1.1838977  -0.24510981]
  [FlaxMamba2] dt (step) sample values: [-0.2705239   0.24412441  1.8532906   0.4020823   0.42821592]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.08408351 -0.00908942 -0.5224164  -0.30313236 -1.2375964 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.07472258  0.08161651  0.1188066   0.20455319 -0.05944316]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.0903781   0.06298552  0.12456298  0.19468075 -0.06420772]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04314839  0.03248423  0.06615547  0.10678571 -0.03107356]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04314839  0.03248423  0.06615547  0.10678571 -0.03107356]
  [FlaxMamba2] B (step) sample values: [-0.12564352 -0.15023549 -0.01113089  0.00342185 -0.00165863]
  [FlaxMamba2] C (step) sample values: [-0.2314014   0.04530122 -0.03103005  0.1566133   0.02480362]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9809841  -1.4352343  -0.79658854 -1.6062093  -1.8464803 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04387004 0.01722531 0.02867566 0.05466004 0.08931361]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9167634  0.97558075 0.9774162  0.9159482  0.8479651 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04314839  0.03248423  0.06615547  0.10678571 -0.03107356]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.3783334e-04  2.8438400e-04  2.1069898e-05 -6.4772898e-06
  3.1396494e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.3783334e-04  2.8438400e-04  2.1069898e-05 -6.4772898e-06
  3.1396494e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00027562  0.00152827  0.00057145 -0.00030242  0.00049831]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00227195  0.00794653  0.0022165   0.00146837 -0.00146605]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03751038  0.03447575  0.05624435  0.08867812 -0.0268432 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03751038  0.03447575  0.05624435  0.08867812 -0.0268432 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00046558  0.0276807   0.01922042  0.03221003 -0.00985215]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01457919  0.8719729   0.59617764  1.1838442  -0.3045184 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01457919  0.8719729   0.59617764  1.1838442  -0.3045184 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.3951285   0.20797071 -5.9711237  -3.3853886   3.2292936 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.3951285   0.20797071 -5.9711237  -3.3853886   3.2292936 ]
  [Layer 40] Output shape after mixer: (1, 1, 2048)
  [Layer 40] Output sample values after mixer: [-2.3951285   0.20797071 -5.9711237  -3.3853886   3.2292936 ]
  [Layer 40] Residual connection shape: (1, 1, 2048)
  [Layer 40] Residual connection sample values: [ 10.22468   13.890574 -39.856506  18.462183 -16.782286]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.12474812  0.17086598 -0.49665707  0.22525133 -0.20576407]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12474812  0.17086598 -0.49665707  0.22525133 -0.20576407]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12474812  0.17086598 -0.49665707  0.22525133 -0.20576407]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.1374108  -0.28492463 -1.1272266   0.34128654 -0.31646067]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.1374108  -0.28492463 -1.1272266   0.34128654 -0.31646067]
  [FlaxMamba2] xBC (step) sample values: [-0.72513354  0.9139009   0.2173138   0.12311544  0.38051283]
  [FlaxMamba2] dt (step) sample values: [1.1323849  0.5775468  2.3029366  0.04396872 1.0223396 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.4675433   1.0878199   0.30033192 -0.72513354  0.16617247]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [0.10767873 0.11273592 0.0606562  0.03481699 0.11663765]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [0.09432729 0.09873598 0.06275428 0.02808023 0.1010508 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [0.04938641 0.05180321 0.03236134 0.01423723 0.05307605]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [0.04938641 0.05180321 0.03236134 0.01423723 0.05307605]
  [FlaxMamba2] B (step) sample values: [-0.12495316  0.06316412 -0.08451758 -0.25215912  0.00491011]
  [FlaxMamba2] C (step) sample values: [ 0.05010619  0.10177375  0.00312054 -0.02032874 -0.12850943]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8258594 -1.8636904 -1.2829287 -1.4542811 -4.4079003]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11153337 0.05526984 0.06981802 0.04312354 0.01764545]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8157525  0.90212166 0.91432285 0.93921226 0.9251685 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [0.04938641 0.05180321 0.03236134 0.01423723 0.05307605]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.8827113e-04  3.4792273e-04 -4.6554257e-04 -1.3889512e-03
  2.7046017e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.8827113e-04  3.4792273e-04 -4.6554257e-04 -1.3889512e-03
  2.7046017e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00087357  0.00053844 -0.00118335  0.00155833 -0.00181372]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-6.6484895e-04  3.6910445e-05  4.0719546e-03  1.3181519e-03
  4.9946801e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [0.04747123 0.0505286  0.035614   0.01519493 0.05223177]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [0.04747123 0.0505286  0.035614   0.01519493 0.05223177]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0030378  -0.0061798  -0.00982242  0.00303113 -0.00696774]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.10069437 -0.20472723 -0.32025692  0.10381873 -0.18599382]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.10069437 -0.20472723 -0.32025692  0.10381873 -0.18599382]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.7696782 -6.0838804 -1.3039396  2.8408177  5.156938 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.7696782 -6.0838804 -1.3039396  2.8408177  5.156938 ]
  [Layer 41] Output shape after mixer: (1, 1, 2048)
  [Layer 41] Output sample values after mixer: [-0.7696782 -6.0838804 -1.3039396  2.8408177  5.156938 ]
  [Layer 41] Residual connection shape: (1, 1, 2048)
  [Layer 41] Residual connection sample values: [  9.455002   7.806694 -41.160446  21.303001 -11.625347]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.11354229  0.09558173 -0.4993713   0.25397807 -0.13895866]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11354229  0.09558173 -0.4993713   0.25397807 -0.13895866]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11354229  0.09558173 -0.4993713   0.25397807 -0.13895866]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.1302149   0.18813053 -1.1644914   2.1935217  -1.1559206 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.1302149   0.18813053 -1.1644914   2.1935217  -1.1559206 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.6472919  -0.58707714  0.9496852   0.27667922  0.5683299 ]
  [FlaxMamba2] dt (step) sample values: [ 1.4169362   1.8398696   1.1822319  -0.44236714  1.2520511 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.41710472 -0.01793338 -0.22297688  0.6472919  -0.82718277]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.09643815  0.09194022  0.1388218  -0.05596181  0.08934632]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.08710741  0.07872611  0.14886971 -0.05243512  0.06940308]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.04544943  0.04091171  0.07996519 -0.02553036  0.03590526]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04544943  0.04091171  0.07996519 -0.02553036  0.03590526]
  [FlaxMamba2] B (step) sample values: [-0.10434587  0.14519511 -0.07884979  0.02622084  0.39956132]
  [FlaxMamba2] C (step) sample values: [ 0.10813974  0.07939982 -0.18376647 -0.0430331  -0.27662647]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.06612   -1.4514434 -0.7269863 -1.9455162 -0.6256312]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08526945 0.7411339  0.01120556 0.01747783 0.03900455]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9131022  0.34105414 0.9918868  0.96656823 0.9758929 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04544943  0.04091171  0.07996519 -0.02553036  0.03590526]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00040439  0.0005627  -0.00030558  0.00010162  0.00154848]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00040439  0.0005627  -0.00030558  0.00010162  0.00154848]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00049206  0.00040924 -0.00033481  0.00038949  0.00036704]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00098799  0.00109198  0.00283883 -0.0001326   0.0021951 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.04659556  0.04214604  0.08308225 -0.02575179  0.03822529]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.04659556  0.04214604  0.08308225 -0.02575179  0.03822529]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01285617  0.0043363  -0.02301185 -0.05081954 -0.0105784 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.495633    0.16434036 -0.8871567  -1.6216005  -0.37018692]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.495633    0.16434036 -0.8871567  -1.6216005  -0.37018692]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.9619257 -1.960393  -1.9466794  2.5314186  0.1036463]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.9619257 -1.960393  -1.9466794  2.5314186  0.1036463]
  [Layer 42] Output shape after mixer: (1, 1, 2048)
  [Layer 42] Output sample values after mixer: [-1.9619257 -1.960393  -1.9466794  2.5314186  0.1036463]
  [Layer 42] Residual connection shape: (1, 1, 2048)
  [Layer 42] Residual connection sample values: [  7.4930763   5.846301  -43.107124   23.83442   -11.521701 ]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.08346213  0.06827956 -0.48163888  0.27000418 -0.12727514]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.08346213  0.06827956 -0.48163888  0.27000418 -0.12727514]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.08346213  0.06827956 -0.48163888  0.27000418 -0.12727514]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.4977524 -1.4741709 -0.5900253 -0.7060592 -1.314766 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.4977524 -1.4741709 -0.5900253 -0.7060592 -1.314766 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.12404744 -0.37006837  1.3273276   1.1796317   0.24964756]
  [FlaxMamba2] dt (step) sample values: [0.49983123 0.4662875  1.043874   0.8560628  0.35039312]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.13625398  0.5833921   0.57381314  0.12404744 -0.7891028 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.02961628  0.06283065  0.19322136 -0.22140244 -0.03591344]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.02604572  0.01714583  0.20569542 -0.2155011  -0.04473302]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01319245  0.00864641  0.11338823 -0.0961851  -0.02186633]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01319245  0.00864641  0.11338823 -0.0961851  -0.02186633]
  [FlaxMamba2] B (step) sample values: [ 0.05808932 -0.05161358  0.9099183  -0.09837481  0.01527297]
  [FlaxMamba2] C (step) sample values: [-0.23151208 -0.02445841 -0.2714676  -0.14780004 -0.08203975]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9761645 -1.478265  -1.0588893 -1.0815219 -5.9141264]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00666214 0.02364095 0.02299831 0.01616853 0.0751834 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99351776 0.96565604 0.9759415  0.98266536 0.64105237]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01319245  0.00864641  0.11338823 -0.0961851  -0.02186633]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.1054667e-06 -4.5363149e-06  7.9972669e-05 -8.6461569e-06
  1.3423404e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.1054667e-06 -4.5363149e-06  7.9972669e-05 -8.6461569e-06
  1.3423404e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.7501978e-04 -6.2327081e-04  6.1780759e-03  4.8992290e-05
 -2.7593031e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00160064 -0.00272294 -0.00631634 -0.00078815 -0.00110869]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01305652  0.00478531  0.09214623 -0.08431209 -0.02009669]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01305652  0.00478531  0.09214623 -0.08431209 -0.02009669]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00357397 -0.0013143  -0.01938942  0.01967267  0.00559338]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.18260917 -0.05151046 -0.7132505   0.7978637   0.26162001]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.18260917 -0.05151046 -0.7132505   0.7978637   0.26162001]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-6.63581   -4.993592  -2.2756104  1.1065257 -0.749625 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-6.63581   -4.993592  -2.2756104  1.1065257 -0.749625 ]
  [Layer 43] Output shape after mixer: (1, 1, 2048)
  [Layer 43] Output sample values after mixer: [-6.63581   -4.993592  -2.2756104  1.1065257 -0.749625 ]
  [Layer 43] Residual connection shape: (1, 1, 2048)
  [Layer 43] Residual connection sample values: [  0.8572664   0.8527093 -45.382736   24.940945  -12.271326 ]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00909481  0.00940381 -0.48597378  0.26322538 -0.13005222]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00909481  0.00940381 -0.48597378  0.26322538 -0.13005222]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00909481  0.00940381 -0.48597378  0.26322538 -0.13005222]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.5546409  -1.2358572   0.13754687 -0.24958125 -1.0209548 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.5546409  -1.2358572   0.13754687 -0.24958125 -1.0209548 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.30552325  0.5316378   0.1917967  -0.07281218 -0.7710267 ]
  [FlaxMamba2] dt (step) sample values: [1.2746654  1.6081024  1.4131554  1.4390987  0.77490044]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.40551603  0.41412812 -0.21585748  0.30552325 -0.1717163 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04783331 -0.0667049   0.0345947  -0.08092968  0.09064389]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04172598 -0.00628009  0.01613156 -0.08747952  0.03815366]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02129819 -0.00313019  0.00813084 -0.04182781  0.01944071]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02129819 -0.00313019  0.00813084 -0.04182781  0.01944071]
  [FlaxMamba2] B (step) sample values: [-0.2731342  -0.16173552  0.07580239  0.03278488 -0.04461556]
  [FlaxMamba2] C (step) sample values: [-0.27337644 -0.07123201  0.03888745 -0.13226087 -0.10516991]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.74823433 -0.64391696 -1.1771379  -1.350584   -1.0269372 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0762125  0.07308284 0.04497697 0.04097714 0.07885256]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.94457066 0.9540308  0.94843304 0.9461605  0.9222152 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02129819 -0.00313019  0.00813084 -0.04182781  0.01944071]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.4334831e-04 -2.6252726e-04  1.2304158e-04  5.3216048e-05
 -7.2419469e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.4334831e-04 -2.6252726e-04  1.2304158e-04  5.3216048e-05
 -7.2419469e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.2220620e-04  1.2099551e-04  9.0078043e-05 -6.6210152e-05
 -2.2647093e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00091189  0.00086015 -0.00011104 -0.00267274  0.00172484]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02091869 -0.00208024  0.00752679 -0.04196438  0.01998679]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02091869 -0.00208024  0.00752679 -0.04196438  0.01998679]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00423241  0.00057885  0.00055319  0.00458663 -0.00540425]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.17036904  0.01860414  0.02399317  0.17254496 -0.2211845 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.17036904  0.01860414  0.02399317  0.17254496 -0.2211845 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.5642664   0.82158905 -0.26336917  6.7823114   2.6817188 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.5642664   0.82158905 -0.26336917  6.7823114   2.6817188 ]
  [Layer 44] Output shape after mixer: (1, 1, 2048)
  [Layer 44] Output sample values after mixer: [ 1.5642664   0.82158905 -0.26336917  6.7823114   2.6817188 ]
  [Layer 44] Residual connection shape: (1, 1, 2048)
  [Layer 44] Residual connection sample values: [  2.4215329   1.6742983 -45.646107   31.723255   -9.589607 ]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02519177  0.01789678 -0.47680035  0.32464996 -0.09925521]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.02519177  0.01789678 -0.47680035  0.32464996 -0.09925521]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.02519177  0.01789678 -0.47680035  0.32464996 -0.09925521]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.19325726  0.05758003 -0.1437732  -0.3824066   0.6718512 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.19325726  0.05758003 -0.1437732  -0.3824066   0.6718512 ]
  [FlaxMamba2] xBC (step) sample values: [-0.37752372  0.17307422 -0.58557487  0.12169642 -0.4714694 ]
  [FlaxMamba2] dt (step) sample values: [ 1.1664631   0.45340648 -1.2566291   0.51985186  2.4237795 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.170736   -0.6202787  -0.13488795 -0.37752372 -0.84485096]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.06001629 -0.0400156  -0.09987935  0.02093326  0.11523898]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.06459393  0.01219997 -0.10233029  0.01434909  0.11273654]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03125423  0.0061372  -0.04854955  0.00722602  0.05954229]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03125423  0.0061372  -0.04854955  0.00722602  0.05954229]
  [FlaxMamba2] B (step) sample values: [ 0.12642272  0.05205121 -0.01929577 -0.26569232 -0.03175401]
  [FlaxMamba2] C (step) sample values: [ 0.00260945 -0.11155672 -0.21603613 -0.16213226  0.04869734]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.250236  -4.181475  -1.0937363 -2.677446  -2.3148744]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02294356 0.03530971 0.00556614 0.02111208 0.06091718]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9496817  0.86273587 0.9939306  0.9450415  0.86847574]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03125423  0.0061372  -0.04854955  0.00722602  0.05954229]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.0655616e-05 -3.7325048e-05  1.3836676e-05  1.9052353e-04
  2.2770271e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.0655616e-05 -3.7325048e-05  1.3836676e-05  1.9052353e-04
  2.2770271e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00032281 -0.0001488  -0.00013618  0.00126155  0.00019418]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00114477 -0.00023456 -0.0015964   0.00074356  0.00423022]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03620686  0.00665036 -0.05606099  0.00884996  0.07102685]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03620686  0.00665036 -0.05606099  0.00884996  0.07102685]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0031616   0.00019697  0.00374083 -0.00137248  0.03158636]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.13531454  0.00611326  0.14713076 -0.04941742  1.2197379 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.13531454  0.00611326  0.14713076 -0.04941742  1.2197379 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.0919156  3.2667553  1.1742426  3.0258598 -1.7007922]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.0919156  3.2667553  1.1742426  3.0258598 -1.7007922]
  [Layer 45] Output shape after mixer: (1, 1, 2048)
  [Layer 45] Output sample values after mixer: [ 2.0919156  3.2667553  1.1742426  3.0258598 -1.7007922]
  [Layer 45] Residual connection shape: (1, 1, 2048)
  [Layer 45] Residual connection sample values: [  4.5134487   4.9410534 -44.471863   34.749115  -11.2904   ]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05395551  0.06156376 -0.5415205   0.41996917 -0.13405706]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05395551  0.06156376 -0.5415205   0.41996917 -0.13405706]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05395551  0.06156376 -0.5415205   0.41996917 -0.13405706]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.8884397   0.15731975  0.0486597   0.40128705 -0.2429786 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.8884397   0.15731975  0.0486597   0.40128705 -0.2429786 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.3332455   0.709983   -1.719925   -0.80243504  1.5982267 ]
  [FlaxMamba2] dt (step) sample values: [ 0.47514147  2.0444975   0.30682376 -0.6546746   0.17164104]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.1877637   0.08927929  0.26237017  0.3332455  -1.5028533 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.06121618  0.08592926 -0.28918344  0.10422149 -0.2591957 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.06435376  0.08212982 -0.31028634  0.08838287 -0.23888624]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03114189  0.04275029 -0.13126504  0.04614305 -0.10524392]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03114189  0.04275029 -0.13126504  0.04614305 -0.10524392]
  [FlaxMamba2] B (step) sample values: [-0.06081998 -0.27839842  0.0227597   0.14195655 -0.00370743]
  [FlaxMamba2] C (step) sample values: [-0.07549645 -0.26563856 -0.11829951  0.00247908  0.38185903]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8673339  -0.9793274  -1.6584101  -0.94076145 -0.4381494 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00485344 0.04306347 0.00859931 0.00538695 0.01046042]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99097794 0.9587037  0.98584    0.994945   0.99542725]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03114189  0.04275029 -0.13126504  0.04614305 -0.10524392]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.1926531e-06  4.2078609e-05 -3.4400209e-06 -2.1456064e-05
  5.6036032e-07]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.1926531e-06  4.2078609e-05 -3.4400209e-06 -2.1456064e-05
  5.6036032e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-6.5357584e-05  5.0842389e-04 -4.8014805e-05  1.7123479e-05
 -1.4768840e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-4.5183953e-04  4.1818793e-04  7.3735842e-05  2.4041455e-04
 -1.2465240e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02531723  0.03455237 -0.10473549  0.03708356 -0.08415718]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02531723  0.03455237 -0.10473549  0.03708356 -0.08415718]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00655513  0.00293123 -0.00261018  0.00891376  0.00898814]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.27384642  0.11690744 -0.09404022  0.29724827  0.36603746]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.27384642  0.11690744 -0.09404022  0.29724827  0.36603746]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 10.046964   -2.7328742 -10.149131   -3.0738208  -9.059314 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 10.046964   -2.7328742 -10.149131   -3.0738208  -9.059314 ]
  [Layer 46] Output shape after mixer: (1, 1, 2048)
  [Layer 46] Output sample values after mixer: [ 10.046964   -2.7328742 -10.149131   -3.0738208  -9.059314 ]
  [Layer 46] Residual connection shape: (1, 1, 2048)
  [Layer 46] Residual connection sample values: [ 14.560412    2.2081792 -54.620995   31.675295  -20.349712 ]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.14842805  0.02272424 -0.5401153   0.31705892 -0.1940222 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14842805  0.02272424 -0.5401153   0.31705892 -0.1940222 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14842805  0.02272424 -0.5401153   0.31705892 -0.1940222 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.33155844  0.71440995 -1.0864705  -0.54791623  0.40343937]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.33155844  0.71440995 -1.0864705  -0.54791623  0.40343937]
  [FlaxMamba2] xBC (step) sample values: [ 0.22775415  0.9385825   0.51790154 -0.6028805  -0.66901696]
  [FlaxMamba2] dt (step) sample values: [1.3864695  0.12117177 2.45175    0.29933476 2.7337792 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.2364329  -1.6534126  -0.02679448  0.22775415  0.00295007]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03389426 -0.15655482  0.04878166  0.08135808 -0.08919729]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01678916 -0.18145716 -0.17070076  0.07797825 -0.08402074]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00832411 -0.08251942 -0.07808333  0.04050851 -0.04024654]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00832411 -0.08251942 -0.07808333  0.04050851 -0.04024654]
  [FlaxMamba2] B (step) sample values: [-0.14950867  0.13315602  1.1224716  -0.25762248 -0.071942  ]
  [FlaxMamba2] C (step) sample values: [ 0.6723617  -0.06621537  0.01647601 -0.26929715 -0.27357018]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -3.552239  -11.244981   -2.6866128  -3.193549   -3.1997924]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08662073 0.01712713 0.02959601 0.00492956 0.16541667]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7351377 0.8248165 0.923566  0.9843805 0.5890177]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00832411 -0.08251942 -0.07808333  0.04050851 -0.04024654]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0780180e-04 -9.6010874e-05 -8.0934743e-04  1.8575623e-04
  5.1873096e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0780180e-04 -9.6010874e-05 -8.0934743e-04  1.8575623e-04
  5.1873096e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00068127 -0.00028057 -0.00197942 -0.00099009  0.00022155]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00082264 -0.00158846 -0.00247951 -0.00016148 -0.00065506]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01094615 -0.118256   -0.11287522  0.05711022 -0.05755638]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01094615 -0.118256   -0.11287522  0.05711022 -0.05755638]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00211275 -0.05671994  0.03093894 -0.01146362 -0.01392101]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.08062703 -1.2973517   1.1580942  -0.4482439  -0.52205455]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.08062703 -1.2973517   1.1580942  -0.4482439  -0.52205455]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ -0.5121573   1.7264069 -12.583948   11.489599    9.901201 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ -0.5121573   1.7264069 -12.583948   11.489599    9.901201 ]
  [Layer 47] Output shape after mixer: (1, 1, 2048)
  [Layer 47] Output sample values after mixer: [ -0.5121573   1.7264069 -12.583948   11.489599    9.901201 ]
  [Layer 47] Residual connection shape: (1, 1, 2048)
  [Layer 47] Residual connection sample values: [ 14.048255   3.934586 -67.20494   43.164894 -10.448511]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13015062  0.03403785 -0.5683176   0.37658763 -0.0860099 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13015062  0.03403785 -0.5683176   0.37658763 -0.0860099 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13015062  0.03403785 -0.5683176   0.37658763 -0.0860099 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.7047874  -2.8057435  -1.467395   -0.10493637  0.4592559 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.7047874  -2.8057435  -1.467395   -0.10493637  0.4592559 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.03665016 -1.3048716  -1.0994564  -0.59528303  0.28118297]
  [FlaxMamba2] dt (step) sample values: [ 1.6323977   1.7323445   1.2006007   0.61435115 -0.36262766]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.8172884   0.44788995  0.7010987   0.03665016 -0.9233066 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01637845 -0.14359617 -0.15664837 -0.1044001  -0.04692954]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02155118  0.07637453 -0.24252483 -0.17068428 -0.04937476]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01065948  0.03964483 -0.1066295  -0.07807649 -0.02407804]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01065948  0.03964483 -0.1066295  -0.07807649 -0.02407804]
  [FlaxMamba2] B (step) sample values: [-0.02518165 -0.06821525  0.02508888  0.05137098 -0.03449644]
  [FlaxMamba2] C (step) sample values: [-0.0806994  -0.24590214  0.0237325  -0.24407011  0.08081037]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-54.81184   -78.514336  -47.25076    -2.330753   -4.2266355]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.14870834 0.04886233 0.01343315 0.00202322 0.00523721]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [2.8845310e-04 2.1571262e-02 5.3008038e-01 9.9529546e-01 9.7810739e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01065948  0.03964483 -0.1066295  -0.07807649 -0.02407804]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.99167875e-05  1.08131644e-04 -3.97697295e-05 -8.14308878e-05
  5.46821502e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.99167875e-05  1.08131644e-04 -3.97697295e-05 -8.14308878e-05
  5.46821502e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 3.9930539e-05  1.0805312e-04 -3.9813440e-05 -8.1419064e-05
  5.4768829e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00033521  0.00124641 -0.00335131 -0.00245404 -0.00075695]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00882259  0.03281276 -0.08825277 -0.06462079 -0.01992858]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00882259  0.03281276 -0.08825277 -0.06462079 -0.01992858]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00231387 -0.005249    0.0242607   0.0032128  -0.00560888]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.12226249 -0.22730085  1.0872179   0.16498128 -0.32064357]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.12226249 -0.22730085  1.0872179   0.16498128 -0.32064357]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ -9.926883  -10.3885    -23.085766   24.575289  -15.1300535]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ -9.926883  -10.3885    -23.085766   24.575289  -15.1300535]
  [Layer 48] Output shape after mixer: (1, 1, 2048)
  [Layer 48] Output sample values after mixer: [ -9.926883  -10.3885    -23.085766   24.575289  -15.1300535]
  [Layer 48] Residual connection shape: (1, 1, 2048)
  [Layer 48] Residual connection sample values: [  4.121372  -6.453914 -90.29071   67.74018  -25.578564]
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03727411 -0.06455982 -0.8316277   0.63627446 -0.2291049 ]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Final backbone norm output sample values: [ 0.03727411 -0.06455982 -0.8316277   0.63627446 -0.2291049 ]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 1, 50288)
[Mamba2LMHeadModel] Logits sample values: [14.954284   3.9465382 19.82968   15.2382145 16.10891  ]
[Mamba2LMHeadModel] Forward pass input_ids shape: (1, 1)
[Mamba2LMHeadModel] input_ids sample values: [30766]
[Mamba2LMHeadModel] Embedding output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Embedding sample values: [0.00073385 0.14453125 0.13232422 0.02400208 0.21350098]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.00066515 0.14823236 0.12390085 0.02247417 0.19644503]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.00066515 0.14823236 0.12390085 0.02247417 0.19644503]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.00066515 0.14823236 0.12390085 0.02247417 0.19644503]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.13665864  0.10360514 -1.2774827   0.23337285  0.09743422]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.13665864  0.10360514 -1.2774827   0.23337285  0.09743422]
  [FlaxMamba2] xBC (step) sample values: [-0.83976954  0.03642996 -0.8800984  -0.18687129  0.5023417 ]
  [FlaxMamba2] dt (step) sample values: [ 0.33909592  0.13982609 -0.32599682  0.17652747  0.35843202]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.3529671   0.5844494  -0.20654811 -0.83976954  0.7994356 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00809871  0.0537093   0.01100611  0.16621345 -0.28507024]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.23588191  0.26904133  0.2812698   0.21540779 -0.5419062 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.13178688  0.15250811  0.16028371  0.11925937 -0.19928288]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.13178688  0.15250811  0.16028371  0.11925937 -0.19928288]
  [FlaxMamba2] B (step) sample values: [ 0.07886262 -0.01723092 -0.27833673 -0.27138016 -0.01478646]
  [FlaxMamba2] C (step) sample values: [-0.2594845   0.6208612  -0.24858281 -0.27834475  0.13667862]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.617978  -2.5226073 -3.0473056 -3.307819  -3.9089987]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01274526 0.01559275 0.00654868 0.02909256 0.01041251]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9671837  0.9614292  0.98024195 0.9082524  0.9601147 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.13178688  0.15250811  0.16028371  0.11925937 -0.19928288]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.3246224e-04 -2.8942059e-05 -4.6751054e-04 -4.5582588e-04
 -2.4836205e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.3246224e-04 -2.8942059e-05 -4.6751054e-04 -4.5582588e-04
 -2.4836205e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.001645    0.00015389 -0.0021133  -0.00230621  0.00066841]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.03812454  0.03478941  0.04773299  0.00347465 -0.03312929]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.08838511  0.09295259  0.10886161  0.04895751 -0.10913132]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.08838511  0.09295259  0.10886161  0.04895751 -0.10913132]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00562727  0.0050644  -0.03031409  0.00637626 -0.00557537]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.03238265  0.03138972 -0.14883144  0.06056989 -0.03267866]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03238265  0.03138972 -0.14883144  0.06056989 -0.03267866]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.7009845   0.2658811  -0.17146784  0.7315199  -0.3743338 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.7009845   0.2658811  -0.17146784  0.7315199  -0.3743338 ]
  [Layer 1] Output shape after mixer: (1, 1, 2048)
  [Layer 1] Output sample values after mixer: [-1.7009845   0.2658811  -0.17146784  0.7315199  -0.3743338 ]
  [Layer 1] Residual connection shape: (1, 1, 2048)
  [Layer 1] Residual connection sample values: [-1.7002506   0.41041234 -0.03914362  0.75552195 -0.16083282]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.667701    0.12728117 -0.01416634  0.28646806 -0.05957305]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.667701    0.12728117 -0.01416634  0.28646806 -0.05957305]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.667701    0.12728117 -0.01416634  0.28646806 -0.05957305]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.6266539 -2.4733934 -1.3361042 -2.4188867 -1.346387 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.6266539 -2.4733934 -1.3361042 -2.4188867 -1.346387 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.0773478   0.67953277  1.5656859   4.6849284  -1.1343727 ]
  [FlaxMamba2] dt (step) sample values: [3.3646033 0.6352415 0.3222951 0.5349871 0.7651653]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.1875107  -0.78967863 -0.82048094  1.0773478   0.77200377]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.15781707 -0.37246525 -0.08999602 -3.3391004   0.29948705]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.18763274 -0.52700627 -0.10050932 -2.2853894   0.28635687]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.08504059 -0.19563283 -0.04773125 -0.21103343  0.16353954]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08504059 -0.19563283 -0.04773125 -0.21103343  0.16353954]
  [FlaxMamba2] B (step) sample values: [ 0.14236788  0.03744538  0.03139703  0.42792955 -0.12744826]
  [FlaxMamba2] C (step) sample values: [-0.17539889 -0.27583173  0.22251649 -0.04110345 -0.27714697]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-19.851534   -18.68525    -13.564036    -2.4188707   -0.46617994]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.16275129 0.01183037 0.02901611 0.01245901 0.03150343]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.03952339 0.8016739  0.67464036 0.97031283 0.98542106]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08504059 -0.19563283 -0.04773125 -0.21103343  0.16353954]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00197044 -0.00051826 -0.00043455 -0.00592274  0.00176394]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00197044 -0.00051826 -0.00043455 -0.00592274  0.00176394]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00197372 -0.0005115  -0.00043339 -0.00589679  0.00171626]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00310207  0.00856285  0.00196629  0.00786956 -0.00685565]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05560545 -0.1264917  -0.03098483 -0.13781674  0.10604338]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05560545 -0.1264917  -0.03098483 -0.13781674  0.10604338]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0148601   0.02432346  0.00861725  0.02725036 -0.02947766]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01170909  0.00906689  0.00719219  0.00920821 -0.0249423 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01170909  0.00906689  0.00719219  0.00920821 -0.0249423 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.05047004  0.04423813 -0.04812491 -0.01707876  0.04041813]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.05047004  0.04423813 -0.04812491 -0.01707876  0.04041813]
  [Layer 2] Output shape after mixer: (1, 1, 2048)
  [Layer 2] Output sample values after mixer: [-0.05047004  0.04423813 -0.04812491 -0.01707876  0.04041813]
  [Layer 2] Residual connection shape: (1, 1, 2048)
  [Layer 2] Residual connection sample values: [-1.7507206   0.45465046 -0.08726853  0.7384432  -0.12041469]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.74449986  0.15117101 -0.03324691  0.28945294 -0.05076504]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.74449986  0.15117101 -0.03324691  0.28945294 -0.05076504]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.74449986  0.15117101 -0.03324691  0.28945294 -0.05076504]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.26921308  0.05142886 -1.6950325  -1.1255889   0.8789447 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.26921308  0.05142886 -1.6950325  -1.1255889   0.8789447 ]
  [FlaxMamba2] xBC (step) sample values: [-2.0851595 -3.966658   0.9576721  1.8063793  0.9745028]
  [FlaxMamba2] dt (step) sample values: [ 1.0373507  -0.16707756  0.6378414   0.5699712   0.15920763]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.46637878 -0.13996676  2.6808503  -2.0851595  -0.39116743]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.57676613  0.41988257 -0.28377584  0.17174102  0.0742714 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.5783149   0.4005802  -0.16011861  0.1594043   0.05797501]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.20780034  0.23987827 -0.07366347  0.08604116  0.02982754]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.20780034  0.23987827 -0.07366347  0.08604116  0.02982754]
  [FlaxMamba2] B (step) sample values: [ 0.3637028   0.12851365 -0.08237282  0.03730518 -0.20689864]
  [FlaxMamba2] C (step) sample values: [ 0.43211624 -0.16448958 -0.25034642 -0.26603028  0.29856038]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6505536 -3.9938898 -6.780579  -0.9418818 -6.0307717]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02347652 0.01727423 0.02562819 0.01157095 0.0253793 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9848433 0.9333347 0.8404869 0.9891607 0.858081 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.20780034  0.23987827 -0.07366347  0.08604116  0.02982754]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0017743  -0.00062694  0.00040185 -0.00018199  0.00100934]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0017743  -0.00062694  0.00040185 -0.00018199  0.00100934]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-9.5532723e-03  1.9589846e-05  1.5838726e-03  4.8998831e-04
 -1.2936512e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.03013917  0.02104256  0.06878723  0.00623434  0.00252669]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.12474497  0.13025256  0.03525027  0.04540652  0.01610635]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.12474497  0.13025256  0.03525027  0.04540652  0.01610635]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01903818  0.00343548 -0.00926819 -0.0125205   0.0100031 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.01848422  0.00363704 -0.00790759 -0.01636442  0.00753414]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01848422  0.00363704 -0.00790759 -0.01636442  0.00753414]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [0.11551255 0.23871621 0.31932208 0.15747613 0.07402589]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [0.11551255 0.23871621 0.31932208 0.15747613 0.07402589]
  [Layer 3] Output shape after mixer: (1, 1, 2048)
  [Layer 3] Output sample values after mixer: [0.11551255 0.23871621 0.31932208 0.15747613 0.07402589]
  [Layer 3] Residual connection shape: (1, 1, 2048)
  [Layer 3] Residual connection sample values: [-1.6352081   0.69336665  0.23205355  0.8959193  -0.0463888 ]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.72287303  0.23213072  0.09061894  0.36187863 -0.02057135]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.72287303  0.23213072  0.09061894  0.36187863 -0.02057135]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.72287303  0.23213072  0.09061894  0.36187863 -0.02057135]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.4566714   0.06133584 -2.7230818   0.7531533   1.0216829 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.4566714   0.06133584 -2.7230818   0.7531533   1.0216829 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.1195325  -1.7535933  -0.22240059 -2.09141    -3.2473457 ]
  [FlaxMamba2] dt (step) sample values: [0.97467226 1.8255054  1.1226137  1.1702971  0.3268128 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.68919337  0.01396449  0.00505049  1.1195325  -2.370526  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.18494326 -0.05541375 -0.00243827  0.13115126  0.13239095]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.11115175 -0.09057    -0.05065604  0.11532789  0.4253597 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.05866138 -0.04323567 -0.02468665  0.0609854   0.25724268]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05866138 -0.04323567 -0.02468665  0.0609854   0.25724268]
  [FlaxMamba2] B (step) sample values: [ 0.22107606 -0.04706316  0.64175665 -0.07546525 -0.1439123 ]
  [FlaxMamba2] C (step) sample values: [ 0.73574823 -0.25567448 -0.09098084 -0.25526682  0.02423632]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.7127254  -1.2862217  -1.4869522 -27.028044   -4.0726624]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01619135 0.01485712 0.00586863 0.01040593 0.05216775]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.97264963 0.9810719  0.9913116  0.75483805 0.80859137]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05866138 -0.04323567 -0.02468665  0.0609854   0.25724268]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.0997960e-04 -4.4700926e-05  6.0954498e-04 -7.1677423e-05
 -1.3668892e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.0997960e-04 -4.4700926e-05  6.0954498e-04 -7.1677423e-05
 -1.3668892e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.0369855e-03 -1.5529100e-03 -8.2699169e-04 -4.7528501e-05
 -3.0215329e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0041569   0.00516406  0.00257838  0.00655572  0.05585677]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02886225 -0.01917231 -0.01131717  0.040883    0.20065281]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02886225 -0.01917231 -0.01131717  0.040883    0.20065281]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00794512 -0.000606    0.00189913  0.02093385  0.15073915]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00829635 -0.00040658  0.00194973  0.0181105   0.07781876]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00829635 -0.00040658  0.00194973  0.0181105   0.07781876]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.39438468 -0.09959818 -0.35311937 -0.11861673 -0.48493084]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.39438468 -0.09959818 -0.35311937 -0.11861673 -0.48493084]
  [Layer 4] Output shape after mixer: (1, 1, 2048)
  [Layer 4] Output sample values after mixer: [ 0.39438468 -0.09959818 -0.35311937 -0.11861673 -0.48493084]
  [Layer 4] Residual connection shape: (1, 1, 2048)
  [Layer 4] Residual connection sample values: [-1.2408235   0.5937685  -0.12106583  0.7773026  -0.5313196 ]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.4685773   0.18529974 -0.042702    0.28115317 -0.2070468 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.4685773   0.18529974 -0.042702    0.28115317 -0.2070468 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.4685773   0.18529974 -0.042702    0.28115317 -0.2070468 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.28399107  0.38999894 -2.9078727  -0.2995794  -1.4794708 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.28399107  0.38999894 -2.9078727  -0.2995794  -1.4794708 ]
  [FlaxMamba2] xBC (step) sample values: [-0.48543358 -1.6659244   2.5423617  -1.7824112  -0.13167682]
  [FlaxMamba2] dt (step) sample values: [ 1.8226902   1.1300429   0.22945963  0.46903864 -0.8590085 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.35433516  0.26593763  0.27706146 -0.48543358 -1.7479976 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.07790529 -0.08883734 -0.48318833  0.20082042 -0.12594917]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.12948    -0.12616034 -0.5527074   0.17469737 -0.13181236]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06055458 -0.05910633 -0.2018689   0.09495913 -0.06156883]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06055458 -0.05910633 -0.2018689   0.09495913 -0.06156883]
  [FlaxMamba2] B (step) sample values: [ 0.00018448  0.00466069 -0.03310546 -0.06737846 -0.10762556]
  [FlaxMamba2] C (step) sample values: [-0.23291016 -0.12100394 -0.07688077 -0.17340137 -0.07593059]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.5762966   -1.0443833   -0.83880144  -5.6764617  -20.401838  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02384617 0.03679211 0.05308441 0.02211344 0.00144533]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.963109   0.9623038  0.9564495  0.88203275 0.97094315]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06055458 -0.05910633 -0.2018689   0.09495913 -0.06156883]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.6639174e-07 -6.7300116e-06  4.7804115e-05  9.7294156e-05
  1.5541076e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.6639174e-07 -6.7300116e-06  4.7804115e-05  9.7294156e-05
  1.5541076e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.1530973e-04 -8.1985731e-05  4.8276215e-04  2.7349862e-04
 -3.9822419e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00366047  0.00470214 -0.01993497 -0.01409318 -0.01639859]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03621029 -0.0270692  -0.12844527  0.03695006 -0.0494936 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03621029 -0.0270692  -0.12844527  0.03695006 -0.0494936 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00586693 -0.00629493  0.01933464 -0.00471184  0.01358365]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00676287 -0.00740045  0.02165044 -0.00552246  0.01411165]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00676287 -0.00740045  0.02165044 -0.00552246  0.01411165]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.0146231  -0.00641164  0.04702161  0.11486582 -0.15112214]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.0146231  -0.00641164  0.04702161  0.11486582 -0.15112214]
  [Layer 5] Output shape after mixer: (1, 1, 2048)
  [Layer 5] Output sample values after mixer: [ 0.0146231  -0.00641164  0.04702161  0.11486582 -0.15112214]
  [Layer 5] Residual connection shape: (1, 1, 2048)
  [Layer 5] Residual connection sample values: [-1.2262005   0.5873568  -0.07404421  0.89216846 -0.6824418 ]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.4239668   0.15717793 -0.02272201  0.28300905 -0.23935755]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.4239668   0.15717793 -0.02272201  0.28300905 -0.23935755]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.4239668   0.15717793 -0.02272201  0.28300905 -0.23935755]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 2.171434  -0.6908703 -1.5812137 -1.6970332 -1.3067276]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 2.171434  -0.6908703 -1.5812137 -1.6970332 -1.3067276]
  [FlaxMamba2] xBC (step) sample values: [-0.996089    0.23369399 -4.0537515   0.57140934 -1.9870394 ]
  [FlaxMamba2] dt (step) sample values: [3.2990649  0.91026723 0.5632832  0.8148556  1.9022317 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.9152837   0.32843578 -0.38086557 -0.996089   -1.9622945 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.11549431 -0.25441936 -1.3298289  -0.09458031 -0.89275813]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.1498571  -0.32674602 -1.3919932  -0.03247704 -0.823056  ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.08053235 -0.13691722 -0.27713156 -0.01597485 -0.251127  ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.08053235 -0.13691722 -0.27713156 -0.01597485 -0.251127  ]
  [FlaxMamba2] B (step) sample values: [ 0.2227803   0.06413504 -0.20491262  0.02171605  0.13955058]
  [FlaxMamba2] C (step) sample values: [-0.06406988 -0.03862669 -0.27109408  0.2128636   0.14675553]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.98658675 -8.774721   -3.3045902  -2.9912853  -3.3435438 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.22903359 0.03377888 0.14303932 0.14324903 0.18394755]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7977488  0.7434898  0.6233256  0.6514864  0.54062104]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.08053235 -0.13691722 -0.27713156 -0.01597485 -0.251127  ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0041091   0.00118295 -0.00377953  0.00040054  0.00257396]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0041091   0.00118295 -0.00377953  0.00040054  0.00257396]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.02190436 -0.0006195  -0.01272457 -0.00152577  0.00473634]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.08251447 -0.1531476  -0.056615    0.02344639 -0.12196638]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.09995398 -0.1827974  -0.11662862  0.01998699 -0.17634864]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.09995398 -0.1827974  -0.11662862  0.01998699 -0.17634864]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.19483009  0.04216035  0.03146552 -0.0052524   0.04909169]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.22764437  0.02307789  0.01637328 -0.00355368  0.02344556]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.22764437  0.02307789  0.01637328 -0.00355368  0.02344556]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.24518792  0.05872893 -0.7413937  -0.12214125 -0.04319189]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.24518792  0.05872893 -0.7413937  -0.12214125 -0.04319189]
  [Layer 6] Output shape after mixer: (1, 1, 2048)
  [Layer 6] Output sample values after mixer: [ 0.24518792  0.05872893 -0.7413937  -0.12214125 -0.04319189]
  [Layer 6] Residual connection shape: (1, 1, 2048)
  [Layer 6] Residual connection sample values: [-0.9810125   0.64608574 -0.8154379   0.7700272  -0.7256337 ]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.26805314  0.146629   -0.20655288  0.19264711 -0.19890213]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.26805314  0.146629   -0.20655288  0.19264711 -0.19890213]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.26805314  0.146629   -0.20655288  0.19264711 -0.19890213]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.6267874 -3.867514  -1.1258849 -1.0696839  0.4526495]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.6267874 -3.867514  -1.1258849 -1.0696839  0.4526495]
  [FlaxMamba2] xBC (step) sample values: [-2.4475067  -1.2237949  -2.0116818   0.00251264  1.5680952 ]
  [FlaxMamba2] dt (step) sample values: [ 1.0258927   0.9729238   1.3837706   0.9225458  -0.18374187]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-3.4444342  -2.4927015  -1.8322127  -2.4475067   0.82987714]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.10572046  0.77857196  0.06241343  0.03275599 -0.21525055]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03760523  0.80319965  0.06166336  0.03917994 -0.218844  ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01915611  0.5547366   0.03178197  0.01997369 -0.09749639]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01915611  0.5547366   0.03178197  0.01997369 -0.09749639]
  [FlaxMamba2] B (step) sample values: [ 0.10386263 -0.05900603  0.00604746 -0.03938429  0.02038619]
  [FlaxMamba2] C (step) sample values: [ 0.01609486 -0.05525696  0.14661463  0.05454924  0.04592032]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.29588825 -1.1836219  -0.3113019  -0.1314279  -1.5015444 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04796667 0.01579181 0.01003456 0.03734373 0.00089371]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9859075  0.9814821  0.99688107 0.995104   0.99865896]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01915611  0.5547366   0.03178197  0.01997369 -0.09749639]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.5434669e-05 -5.4217970e-05  5.5567402e-06 -3.6188438e-05
  1.8731944e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.5434669e-05 -5.4217970e-05  5.5567402e-06 -3.6188438e-05
  1.8731944e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0005297   0.00041902 -0.00045815  0.00075423 -0.00309424]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00302835 -0.00283349  0.01864545 -0.00397144  0.000538  ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00298452 -0.00156423  0.01871817 -0.00392574  0.00031493]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00298452 -0.00156423  0.01871817 -0.00392574  0.00031493]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-4.0576202e-03  1.2390931e-04 -5.1615946e-03  1.0727664e-03
  8.7137472e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.03282451  0.00055828 -0.05487548  0.00804425  0.00089207]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03282451  0.00055828 -0.05487548  0.00804425  0.00089207]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.5737561  -0.3402606  -0.31063554  0.50209504 -0.349927  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.5737561  -0.3402606  -0.31063554  0.50209504 -0.349927  ]
  [Layer 7] Output shape after mixer: (1, 1, 2048)
  [Layer 7] Output sample values after mixer: [ 0.5737561  -0.3402606  -0.31063554  0.50209504 -0.349927  ]
  [Layer 7] Residual connection shape: (1, 1, 2048)
  [Layer 7] Residual connection sample values: [-0.40725642  0.30582514 -1.1260735   1.2721223  -1.0755607 ]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.13399948  0.07875666 -0.3452495   0.3880456  -0.35221583]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.13399948  0.07875666 -0.3452495   0.3880456  -0.35221583]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.13399948  0.07875666 -0.3452495   0.3880456  -0.35221583]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.585988  -1.2541262 -1.5511304 -2.4626935 -0.0616539]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.585988  -1.2541262 -1.5511304 -2.4626935 -0.0616539]
  [FlaxMamba2] xBC (step) sample values: [ 0.33567595  0.5890006   0.4075384  -1.9049393  -0.7200245 ]
  [FlaxMamba2] dt (step) sample values: [-0.76946765 -0.30563414  0.71569777  0.7006311   0.06583485]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.7796566   0.17718412 -0.3310088   0.33567595 -1.8804672 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02854022 -0.05118218 -0.01281003  0.02877203 -0.1382209 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.4343504  -0.0822033  -0.3275073  -0.02280268 -0.19434273]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.26361248 -0.03941325 -0.13717555 -0.01127135 -0.08775871]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.26361248 -0.03941325 -0.13717555 -0.01127135 -0.08775871]
  [FlaxMamba2] B (step) sample values: [ 0.04115847  0.08081974  0.03055659  0.12576011 -0.03094529]
  [FlaxMamba2] C (step) sample values: [ 0.15007187 -0.0052952  -0.2784233  -0.25698295 -0.15567191]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.6542776 -0.9827404 -0.5549556 -3.9396574 -1.8081155]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00467486 0.04025394 0.02264461 0.04791785 0.01029563]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.98306185 0.96121305 0.9875119  0.8279687  0.98155653]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.26361248 -0.03941325 -0.13717555 -0.01127135 -0.08775871]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.0721701e-05  9.9598321e-05  3.7656464e-05  1.5498065e-04
 -3.8135466e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.0721701e-05  9.9598321e-05  3.7656464e-05  1.5498065e-04
 -3.8135466e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.7572061e-04  2.7802671e-05  6.3503190e-04 -5.5413920e-04
 -3.8523960e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.04726968 -0.03547264 -0.02982188 -0.01009259 -0.0211404 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.26917866 -0.06865072 -0.14529626 -0.01958081 -0.09501567]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.26917866 -0.06865072 -0.14529626 -0.01958081 -0.09501567]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.05639924  0.01911231  0.03942301  0.00378613  0.00283878]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.04316042  0.01863373  0.02612722  0.00393155  0.00351673]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.04316042  0.01863373  0.02612722  0.00393155  0.00351673]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.13250022  0.73092276  0.64205325  0.6679525  -0.02015726]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.13250022  0.73092276  0.64205325  0.6679525  -0.02015726]
  [Layer 8] Output shape after mixer: (1, 1, 2048)
  [Layer 8] Output sample values after mixer: [ 0.13250022  0.73092276  0.64205325  0.6679525  -0.02015726]
  [Layer 8] Residual connection shape: (1, 1, 2048)
  [Layer 8] Residual connection sample values: [-0.2747562   1.0367479  -0.48402023  1.9400747  -1.0957179 ]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.07057782  0.21759461 -0.11430144  0.43996635 -0.2778459 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.07057782  0.21759461 -0.11430144  0.43996635 -0.2778459 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.07057782  0.21759461 -0.11430144  0.43996635 -0.2778459 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-2.2588284  0.5871268  0.6114113 -2.8326628 -1.8947645]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-2.2588284  0.5871268  0.6114113 -2.8326628 -1.8947645]
  [FlaxMamba2] xBC (step) sample values: [-0.02064419 -0.9900185  -1.872725    0.9681686  -1.3562076 ]
  [FlaxMamba2] dt (step) sample values: [0.8703507 1.3305557 0.5893228 0.571297  1.54844  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.53071535 -0.58628625  0.01195776 -0.02064419 -1.0925357 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00403959 -0.13956273  0.14154017  0.25601453  0.05221389]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01139051 -0.16490757  0.05487025  0.18210095  0.07725357]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00572769 -0.07567053  0.02818762  0.09931783  0.04011807]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00572769 -0.07567053  0.02818762  0.09931783  0.04011807]
  [FlaxMamba2] B (step) sample values: [-0.12759024 -0.26742887  0.1559356   0.31201166  0.15232371]
  [FlaxMamba2] C (step) sample values: [-0.2579359  -0.27580827 -0.2784368  -0.16687635  0.09422373]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-5.234511  -1.2161361 -1.4887683 -0.9523448 -3.9666808]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02395699 0.13489294 0.00864357 0.21556073 0.07191543]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.88214123 0.8487011  0.98721415 0.8144126  0.7518146 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00572769 -0.07567053  0.02818762  0.09931783  0.04011807]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.7507708e-05 -3.6696118e-05  2.1397207e-05  4.2813688e-05
  2.0901589e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.7507708e-05 -3.6696118e-05  2.1397207e-05  4.2813688e-05
  2.0901589e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00027676 -0.00434395  0.00686645  0.00761092 -0.002332  ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01910868  0.00320351 -0.00938659  0.0206902   0.02483008]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02687286 -0.09937184  0.0288232   0.1553207   0.07921221]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02687286 -0.09937184  0.0288232   0.1553207   0.07921221]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00574177 -0.03749793  0.01142422 -0.02445555 -0.01961689]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.0045542  -0.044319    0.00902719 -0.01523821 -0.01780327]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0045542  -0.044319    0.00902719 -0.01523821 -0.01780327]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.16992648  0.30181623  0.35922086  0.0190766  -0.12551832]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.16992648  0.30181623  0.35922086  0.0190766  -0.12551832]
  [Layer 9] Output shape after mixer: (1, 1, 2048)
  [Layer 9] Output sample values after mixer: [ 0.16992648  0.30181623  0.35922086  0.0190766  -0.12551832]
  [Layer 9] Residual connection shape: (1, 1, 2048)
  [Layer 9] Residual connection sample values: [-0.10482971  1.3385642  -0.12479937  1.9591513  -1.2212362 ]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02131431  0.22747794 -0.02290531  0.3560097  -0.24267243]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02131431  0.22747794 -0.02290531  0.3560097  -0.24267243]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02131431  0.22747794 -0.02290531  0.3560097  -0.24267243]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.60101724  1.1579175   0.00901852 -2.3266063  -0.45546558]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.60101724  1.1579175   0.00901852 -2.3266063  -0.45546558]
  [FlaxMamba2] xBC (step) sample values: [0.3956909 1.2417812 1.7739414 0.520169  1.7301397]
  [FlaxMamba2] dt (step) sample values: [0.852385   0.17543274 0.5903775  0.9255167  1.0710838 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.9168027  0.4215516  0.1810347  0.3956909  1.0273219]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06599823 -0.3194238   0.35970685 -0.09003625  0.38617408]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.02763764 -0.40652096  0.25588605 -0.17585167  0.32660377]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01400977 -0.16250539  0.14422369 -0.08021475  0.18973485]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01400977 -0.16250539  0.14422369 -0.08021475  0.18973485]
  [FlaxMamba2] B (step) sample values: [-0.03757345  0.09462307  0.07943136  0.02451973 -0.09401915]
  [FlaxMamba2] C (step) sample values: [-0.2783408   0.13518497 -0.22001013 -0.07845452 -0.18775284]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.7154508  -1.4067873  -0.35344088 -2.010216   -0.4652703 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00102959 0.00423909 0.16469702 0.00460104 0.0219537 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9961819  0.99405426 0.94345117 0.9907935  0.9898376 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01400977 -0.16250539  0.14422369 -0.08021475  0.18973485]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.4196920e-07  1.3648676e-06  1.1457386e-06  3.5367887e-07
 -1.3561565e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.4196920e-07  1.3648676e-06  1.1457386e-06  3.5367887e-07
 -1.3561565e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.11103793e-06  1.08861313e-04  4.20218603e-05  1.24814715e-05
  1.32884243e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00029806 -0.00393117  0.00077112 -0.00059555  0.00420336]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.0033763  -0.03963697  0.03246005 -0.01822039  0.04589202]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.0033763  -0.03963697  0.03246005 -0.01822039  0.04589202]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00071857 -0.03492501  0.00014703  0.00377045 -0.00811136]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00877281 -0.20777892  0.00140565  0.04102449 -0.08167534]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00877281 -0.20777892  0.00140565  0.04102449 -0.08167534]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.3699084   0.1650083  -0.19322488  0.07301089  0.17243195]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.3699084   0.1650083  -0.19322488  0.07301089  0.17243195]
  [Layer 10] Output shape after mixer: (1, 1, 2048)
  [Layer 10] Output sample values after mixer: [-0.3699084   0.1650083  -0.19322488  0.07301089  0.17243195]
  [Layer 10] Residual connection shape: (1, 1, 2048)
  [Layer 10] Residual connection sample values: [-0.47473812  1.5035725  -0.31802425  2.0321622  -1.0488043 ]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.09461107  0.24379268 -0.05661399  0.35294294 -0.19980414]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09461107  0.24379268 -0.05661399  0.35294294 -0.19980414]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09461107  0.24379268 -0.05661399  0.35294294 -0.19980414]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.9637814  -4.919079    0.12611105 -0.49982238  2.1171937 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.9637814  -4.919079    0.12611105 -0.49982238  2.1171937 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.5171268   0.00863552 -0.07450074  1.9151405   0.45193526]
  [FlaxMamba2] dt (step) sample values: [3.0216541 4.380296  0.7947215 0.8814736 1.952308 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.1445943   0.5201296  -0.33429423  1.5171268   0.79782724]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.38157004 -0.02358316  0.02151057 -0.17875777  0.10041635]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.39577597 -0.3812492   0.11806819 -0.16661178  0.12357919]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.1592316  -0.15472071  0.06251508 -0.07638203  0.0656027 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.1592316  -0.15472071  0.06251508 -0.07638203  0.0656027 ]
  [FlaxMamba2] B (step) sample values: [-0.25751606  0.88009775 -0.27824453 -0.11848981  0.22914459]
  [FlaxMamba2] C (step) sample values: [-0.10240157 -0.15776527 -0.2739888  -0.21597831  0.05554777]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.31160602 -0.09015273 -1.5786072  -0.20961139 -0.6694042 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.31069    1.2675536  0.24842638 0.10026514 0.0514042 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9077259  0.892014   0.6755909  0.97920257 0.9661751 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.1592316  -0.15472071  0.06251508 -0.07638203  0.0656027 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01273975 -0.0435399   0.01376522  0.00586189 -0.01133616]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01273975 -0.0435399   0.01376522  0.00586189 -0.01133616]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.04527125 -0.06322823  0.05318843  0.01403617 -0.05658523]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.10343572 -0.16774383  0.18342312 -0.02438587 -0.0126657 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.16185422 -0.22450739  0.20635849 -0.05240873  0.01140246]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.16185422 -0.22450739  0.20635849 -0.05240873  0.01140246]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.03911366 0.00800985 0.01383144 0.00989079 0.02154756]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.05218405 0.01047408 0.01282791 0.02989542 0.0213896 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.05218405 0.01047408 0.01282791 0.02989542 0.0213896 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.48432416 -0.28111154 -1.216222    0.89807683 -0.17288092]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.48432416 -0.28111154 -1.216222    0.89807683 -0.17288092]
  [Layer 11] Output shape after mixer: (1, 1, 2048)
  [Layer 11] Output sample values after mixer: [ 0.48432416 -0.28111154 -1.216222    0.89807683 -0.17288092]
  [Layer 11] Residual connection shape: (1, 1, 2048)
  [Layer 11] Residual connection sample values: [ 0.00958604  1.222461   -1.5342463   2.930239   -1.2216852 ]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00148959  0.15762636 -0.2082554   0.39505342 -0.18187334]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00148959  0.15762636 -0.2082554   0.39505342 -0.18187334]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00148959  0.15762636 -0.2082554   0.39505342 -0.18187334]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.76535106 -0.9712209  -2.909348    1.0939605   0.03542349]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.76535106 -0.9712209  -2.909348    1.0939605   0.03542349]
  [FlaxMamba2] xBC (step) sample values: [-0.16735914  1.2600087   2.5615664  -0.9992826  -1.0703144 ]
  [FlaxMamba2] dt (step) sample values: [1.7209681 1.1240432 1.3532093 1.0414699 1.5750887]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.6048336  -1.6992308   0.20059147 -0.16735914 -0.3054818 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02800098 -0.3195146   0.16546655 -0.04352146 -0.18337426]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.07100025 -0.30662093  0.13058496 -0.07323033 -0.17075524]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03424039 -0.1299888   0.06954954 -0.03527509 -0.07810594]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03424039 -0.1299888   0.06954954 -0.03527509 -0.07810594]
  [FlaxMamba2] B (step) sample values: [-0.00485627 -0.14822337  0.0147642  -0.05869567 -0.06644108]
  [FlaxMamba2] C (step) sample values: [-0.2781925  -0.14211667 -0.06253454 -0.2542161  -0.19783513]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2411823 -0.7693517 -1.9974962 -1.2367963 -1.0181218]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.2165595  0.19457623 0.10055037 0.24345912 0.32960472]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.76430386 0.86096835 0.81803596 0.73999685 0.71492493]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03424039 -0.1299888   0.06954954 -0.03527509 -0.07810594]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.6009660e-05  1.0990886e-03 -1.0947778e-04  4.3523326e-04
  4.9266609e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.6009660e-05  1.0990886e-03 -1.0947778e-04  4.3523326e-04
  4.9266609e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00639589  0.00512447 -0.01826487  0.00278282 -0.00013923]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00103157 -0.01703807  0.00702905 -0.01247484 -0.01482374]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02361516 -0.11060588  0.05709181 -0.03786635 -0.07104553]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02361516 -0.11060588  0.05709181 -0.03786635 -0.07104553]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0057382   0.02950228 -0.00858627 -0.03103205 -0.00128063]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.02455627  0.0831608  -0.0182922  -0.07561706 -0.00448691]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02455627  0.0831608  -0.0182922  -0.07561706 -0.00448691]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.09693319  0.11850066  0.11999874  0.89193493  1.0347524 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.09693319  0.11850066  0.11999874  0.89193493  1.0347524 ]
  [Layer 12] Output shape after mixer: (1, 1, 2048)
  [Layer 12] Output sample values after mixer: [-0.09693319  0.11850066  0.11999874  0.89193493  1.0347524 ]
  [Layer 12] Residual connection shape: (1, 1, 2048)
  [Layer 12] Residual connection sample values: [-0.08734716  1.3409617  -1.4142476   3.8221738  -0.1869328 ]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01220147  0.1621088  -0.18229468  0.4636735  -0.02650651]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.01220147  0.1621088  -0.18229468  0.4636735  -0.02650651]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.01220147  0.1621088  -0.18229468  0.4636735  -0.02650651]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.5743639  -1.0203626  -0.3593252   0.28488103  0.04405931]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.5743639  -1.0203626  -0.3593252   0.28488103  0.04405931]
  [FlaxMamba2] xBC (step) sample values: [ 0.80534804  0.13512602 -0.07582822  0.9225315   0.00876094]
  [FlaxMamba2] dt (step) sample values: [1.3551872 1.1130017 1.213114  0.9330655 1.8096819]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.9623956  -2.3017192   0.5842428   0.80534804 -0.4451873 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00247502  0.10328513  0.13036998 -0.03450778  0.2827611 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.26712346 -0.00663918  0.10989268 -0.03531269  0.2588048 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.11582832 -0.00330857  0.05796241 -0.01734463  0.14605454]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.11582832 -0.00330857  0.05796241 -0.01734463  0.14605454]
  [FlaxMamba2] B (step) sample values: [ 0.10801695  0.320395    0.08254346  0.51329064 -0.04945053]
  [FlaxMamba2] C (step) sample values: [-0.13145116  0.19418    -0.04297454  0.456623    0.05601412]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3103099 -1.7870504 -0.8605819 -1.881061  -0.5251649]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03674091 0.02940076 0.12350642 0.11465524 0.10295266]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.95299846 0.94881576 0.8991662  0.80599844 0.9473685 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.11582832 -0.00330857  0.05796241 -0.01734463  0.14605454]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00045968 -0.00136349 -0.00035128 -0.00218438  0.00021044]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00045968 -0.00136349 -0.00035128 -0.00218438  0.00021044]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00328217 -0.00518137 -0.00133802 -0.03736646  0.00125909]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0817581   0.07483181 -0.01966817 -0.00393523  0.06023273]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.08674455  0.07468938 -0.01717287 -0.00468192  0.06652043]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.08674455  0.07468938 -0.01717287 -0.00468192  0.06652043]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01794774 -0.02019242  0.00253689 -0.00076125  0.0014977 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.09129152 -0.03387924  0.01745283 -0.00596139  0.00447493]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.09129152 -0.03387924  0.01745283 -0.00596139  0.00447493]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.18477303 -0.39206395  0.32683855  0.36850232 -0.9137414 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.18477303 -0.39206395  0.32683855  0.36850232 -0.9137414 ]
  [Layer 13] Output shape after mixer: (1, 1, 2048)
  [Layer 13] Output sample values after mixer: [ 0.18477303 -0.39206395  0.32683855  0.36850232 -0.9137414 ]
  [Layer 13] Residual connection shape: (1, 1, 2048)
  [Layer 13] Residual connection sample values: [ 0.09742587  0.9488977  -1.087409    4.190676   -1.1006742 ]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0107418   0.09189159 -0.1110063   0.40227234 -0.11847068]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0107418   0.09189159 -0.1110063   0.40227234 -0.11847068]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0107418   0.09189159 -0.1110063   0.40227234 -0.11847068]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 2.5132518  -1.1180044  -0.406685    0.56962806  0.64036757]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 2.5132518  -1.1180044  -0.406685    0.56962806  0.64036757]
  [FlaxMamba2] xBC (step) sample values: [-0.04662067  1.1026312   0.4296601  -0.23183155 -0.47029406]
  [FlaxMamba2] dt (step) sample values: [-0.47690108  1.7082186   1.108783    0.72791314  0.7560045 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.18248388 -0.03884755 -0.5885432  -0.04662067 -0.12691973]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03677342 -0.14480892 -0.07858644 -0.04690287  0.08206236]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.0763242  -0.18606868 -0.13943848 -0.10970804  0.11862241]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03670646 -0.08440384 -0.06486633 -0.05184807  0.0628249 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03670646 -0.08440384 -0.06486633 -0.05184807  0.0628249 ]
  [FlaxMamba2] B (step) sample values: [-0.07870044  0.01117546 -0.06059164 -0.11587344  0.00106827]
  [FlaxMamba2] C (step) sample values: [-0.17748967  0.02120507 -0.20463994 -0.17941466 -0.10940497]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.318424  -0.7620611 -2.6670074 -5.1836414 -2.8487349]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02471801 0.06467656 0.22846477 0.03395022 0.02935651]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.89875674 0.9519074  0.543722   0.8386299  0.9197725 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03670646 -0.08440384 -0.06486633 -0.05184807  0.0628249 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 7.1405761e-05 -1.0139616e-05  5.4975451e-05  1.0513323e-04
 -9.6924919e-07]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 7.1405761e-05 -1.0139616e-05  5.4975451e-05  1.0513323e-04
 -9.6924919e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00046003 -0.00017884  0.00068357  0.0013543   0.00052393]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00263934  0.00091962 -0.00469316 -0.00197331  0.00045208]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01747696 -0.03319839 -0.03091365 -0.02293152  0.02584738]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01747696 -0.03319839 -0.03091365 -0.02293152  0.02584738]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.04063257  0.00914469  0.00502517 -0.00834268  0.01083874]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.35543704  0.04655562  0.0371241  -0.08664544  0.13049509]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.35543704  0.04655562  0.0371241  -0.08664544  0.13049509]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.5426613   0.15974952  0.4643745   0.46080688 -0.40838087]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.5426613   0.15974952  0.4643745   0.46080688 -0.40838087]
  [Layer 14] Output shape after mixer: (1, 1, 2048)
  [Layer 14] Output sample values after mixer: [ 1.5426613   0.15974952  0.4643745   0.46080688 -0.40838087]
  [Layer 14] Residual connection shape: (1, 1, 2048)
  [Layer 14] Residual connection sample values: [ 1.6400871  1.1086472 -0.6230345  4.651483  -1.509055 ]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15888937  0.09131228 -0.05547954  0.38782373 -0.14008246]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15888937  0.09131228 -0.05547954  0.38782373 -0.14008246]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15888937  0.09131228 -0.05547954  0.38782373 -0.14008246]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.39904663  0.9513896  -0.71408254 -0.13496727  0.2808102 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.39904663  0.9513896  -0.71408254 -0.13496727  0.2808102 ]
  [FlaxMamba2] xBC (step) sample values: [-0.47172862  0.11638839 -0.25648022  1.2165937   0.12284245]
  [FlaxMamba2] dt (step) sample values: [0.5813673  0.8621758  1.5640349  1.2723583  0.06588179]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.2982016  -0.51498413 -0.6377079  -0.47172862  0.13877016]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.11935501 -0.02207986  0.0564989  -0.22578567  0.1050612 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.15680008 -0.02893487  0.03171863 -0.24353164  0.07971635]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07226603 -0.01425814  0.01611081 -0.10701175  0.04144601]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07226603 -0.01425814  0.01611081 -0.10701175  0.04144601]
  [FlaxMamba2] B (step) sample values: [ 0.03765921 -0.00106609 -0.01027418  0.037472    0.0028764 ]
  [FlaxMamba2] C (step) sample values: [ 0.06773836 -0.01907842  0.07151224  0.07171049  0.07324952]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.27823287 -0.68077636 -2.7209377  -0.11263601 -3.8483953 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0034601  0.03713601 0.07030467 0.02028332 0.02471347]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99903774 0.9750356  0.8258892  0.997718   0.9092754 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07226603 -0.01425814  0.01611081 -0.10701175  0.04144601]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.4166080e-06  2.6657369e-07  2.5690385e-06 -9.3697963e-06
 -7.1923887e-07]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.4166080e-06  2.6657369e-07  2.5690385e-06 -9.3697963e-06
 -7.1923887e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-6.5231012e-05 -1.2852951e-05 -1.9925215e-05 -2.7543174e-06
  8.9145888e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-7.2157236e-05  1.3848499e-05  2.9492021e-06 -1.9702549e-05
 -1.3030385e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01238844 -0.00241616  0.00274871 -0.01825769  0.0070506 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01238844 -0.00241616  0.00274871 -0.01825769  0.0070506 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00198505 -0.00165828 -0.00064517  0.00114908  0.00112803]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.04939774 -0.05391851 -0.01617616  0.0335043   0.02413831]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04939774 -0.05391851 -0.01617616  0.0335043   0.02413831]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.98536325 -0.553997    0.8320233   0.4198835   0.7252655 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.98536325 -0.553997    0.8320233   0.4198835   0.7252655 ]
  [Layer 15] Output shape after mixer: (1, 1, 2048)
  [Layer 15] Output sample values after mixer: [-0.98536325 -0.553997    0.8320233   0.4198835   0.7252655 ]
  [Layer 15] Residual connection shape: (1, 1, 2048)
  [Layer 15] Residual connection sample values: [ 0.6547239   0.55465025  0.20898885  5.0713663  -0.7837895 ]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0623614   0.04416788  0.01823665  0.40535417 -0.07171149]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0623614   0.04416788  0.01823665  0.40535417 -0.07171149]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0623614   0.04416788  0.01823665  0.40535417 -0.07171149]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.536155   -0.614478   -0.76444286  0.37557152 -0.80881655]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.536155   -0.614478   -0.76444286  0.37557152 -0.80881655]
  [FlaxMamba2] xBC (step) sample values: [ 0.9898985  -1.3074962  -0.19256471 -0.40026224 -1.0048394 ]
  [FlaxMamba2] dt (step) sample values: [0.61925894 1.3181313  1.0652722  0.18292055 0.92377794]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.84651667  0.28637996  0.00926928  0.9898985  -1.1856759 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.22126673 -0.3442985  -0.03688184 -0.11889343 -0.2545081 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.18513392 -0.3854362  -0.05001203 -0.21130066 -0.29659185]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.10111122 -0.15603092 -0.02438084 -0.09452967 -0.12646405]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.10111122 -0.15603092 -0.02438084 -0.09452967 -0.12646405]
  [FlaxMamba2] B (step) sample values: [-0.14737786  0.48020202  0.19035614  0.07818347  0.6728545 ]
  [FlaxMamba2] C (step) sample values: [-0.2750381  -0.06904376 -0.26930335  0.8683293  -0.16714711]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6905513  -0.13480766 -1.3128716  -3.7739606  -1.2635014 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10362414 0.23296615 0.13542998 0.08756279 0.05776696]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7566866 0.9690824 0.837108  0.7185942 0.9296114]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.10111122 -0.15603092 -0.02438084 -0.09452967 -0.12646405]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00154416  0.00503135  0.00199447  0.00081917  0.00704988]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00154416  0.00503135  0.00199447  0.00081917  0.00704988]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00116874  0.004285    0.00199192  0.0009488   0.00754937]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01645255 -0.07578676 -0.01258486 -0.057391   -0.03523443]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.08152562 -0.17620501 -0.02827586 -0.11822832 -0.11662406]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.08152562 -0.17620501 -0.02827586 -0.11822832 -0.11662406]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01613273  0.03800836  0.0068668  -0.02632241  0.02906632]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.07764801  0.14359723  0.03109148 -0.10618613  0.12044439]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.07764801  0.14359723  0.03109148 -0.10618613  0.12044439]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.56943583  1.4527001  -0.15401785  0.29226485 -0.52673537]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.56943583  1.4527001  -0.15401785  0.29226485 -0.52673537]
  [Layer 16] Output shape after mixer: (1, 1, 2048)
  [Layer 16] Output sample values after mixer: [-0.56943583  1.4527001  -0.15401785  0.29226485 -0.52673537]
  [Layer 16] Residual connection shape: (1, 1, 2048)
  [Layer 16] Residual connection sample values: [ 0.08528805  2.0073504   0.05497099  5.3636312  -1.310525  ]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00733219  0.14500786  0.0042097   0.37989166 -0.10839783]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00733219  0.14500786  0.0042097   0.37989166 -0.10839783]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00733219  0.14500786  0.0042097   0.37989166 -0.10839783]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.55603343 -1.3414352   0.93160844 -0.3019771   0.7215828 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.55603343 -1.3414352   0.93160844 -0.3019771   0.7215828 ]
  [FlaxMamba2] xBC (step) sample values: [-0.9301225   0.31953278  1.3995336   0.40904418 -1.2822585 ]
  [FlaxMamba2] dt (step) sample values: [ 0.75723696  0.41289684  0.31920165  2.1520476  -0.47601637]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6821835   0.16870886 -0.6556686  -0.9301225   0.00948185]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.18408053 -0.04525819 -0.32951224 -0.10055491  0.2222061 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.21587984 -0.07145754 -0.34387076 -0.10595652  0.23484038]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.09633394 -0.03445276 -0.1426615  -0.05017418  0.13114467]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09633394 -0.03445276 -0.1426615  -0.05017418  0.13114467]
  [FlaxMamba2] B (step) sample values: [ 0.21549052 -0.23011887 -0.2531026   0.092544    0.0444867 ]
  [FlaxMamba2] C (step) sample values: [-0.18370084  0.02788305  0.08297621 -0.09604513 -0.25082365]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.1570504  -11.466768   -14.214988    -0.12863436 -14.242779  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00109442 0.01546671 0.02960372 0.17431    0.00439436]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9987345  0.837484   0.6565106  0.97782725 0.93933046]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09633394 -0.03445276 -0.1426615  -0.05017418  0.13114467]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.2719158e-05  2.4261424e-05  2.6684598e-05 -9.7569100e-06
 -4.6902310e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.2719158e-05  2.4261424e-05  2.6684598e-05 -9.7569100e-06
 -4.6902310e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-8.16935135e-05  8.00510825e-05  1.04513034e-04 -2.47033284e-04
  4.73489763e-07]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.9311608e-04 -4.8553436e-05 -2.6057562e-04  2.0233603e-04
  2.4745284e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.06232418 -0.02226904 -0.09227084 -0.03215776  0.08460717]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.06232418 -0.02226904 -0.09227084 -0.03215776  0.08460717]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01263031  0.00619179 -0.06166804  0.00412786  0.04108465]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.13788356  0.08255943 -0.62410665  0.05087334  0.5083181 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.13788356  0.08255943 -0.62410665  0.05087334  0.5083181 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.17977206 -0.82220757 -0.14802562 -0.5331681   0.89911866]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.17977206 -0.82220757 -0.14802562 -0.5331681   0.89911866]
  [Layer 17] Output shape after mixer: (1, 1, 2048)
  [Layer 17] Output sample values after mixer: [-0.17977206 -0.82220757 -0.14802562 -0.5331681   0.89911866]
  [Layer 17] Residual connection shape: (1, 1, 2048)
  [Layer 17] Residual connection sample values: [-0.09448402  1.1851429  -0.09305462  4.8304634  -0.41140628]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00657708  0.06975705 -0.00579236  0.28218505 -0.02752739]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00657708  0.06975705 -0.00579236  0.28218505 -0.02752739]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00657708  0.06975705 -0.00579236  0.28218505 -0.02752739]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.01301092  0.03747506 -0.7439822  -0.03720323 -0.13635704]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.01301092  0.03747506 -0.7439822  -0.03720323 -0.13635704]
  [FlaxMamba2] xBC (step) sample values: [-0.5444347  -0.96895117  0.26658198 -0.5072801   0.3341815 ]
  [FlaxMamba2] dt (step) sample values: [0.8188744 1.2707248 0.7689695 1.0241665 1.3811862]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.4484295  -0.58373916 -0.37656048 -0.5444347   0.07849614]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.17014366  0.39217573  0.03606582 -0.07070245  0.06826128]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.18015343  0.12679487  0.31585097 -0.08453454  0.02617754]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.08198477  0.0674113   0.18266064 -0.04048181  0.01326008]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08198477  0.0674113   0.18266064 -0.04048181  0.01326008]
  [FlaxMamba2] B (step) sample values: [ 0.04453142 -0.07190488 -0.14081211  0.17162432  0.19370776]
  [FlaxMamba2] C (step) sample values: [-0.25920677  0.05616331  0.01602134 -0.0387475   0.24511778]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3010656 -1.4685526 -1.2082934 -1.2128745 -2.5874777]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.20510031 0.18220547 0.15223469 0.19418398 0.16056202]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.76578873 0.7652304  0.83198225 0.7901592  0.66004276]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08198477  0.0674113   0.18266064 -0.04048181  0.01326008]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0007488   0.00120909  0.00236777 -0.00288588 -0.00325722]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0007488   0.00120909  0.00236777 -0.00288588 -0.00325722]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00184418  0.00429574  0.00621698 -0.00390851 -0.00564076]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.04619231 -0.10589312  0.14112598 -0.06055446 -0.02949819]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.06203491 -0.09286667  0.17642301 -0.06837709 -0.02693584]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.06203491 -0.09286667  0.17642301 -0.06837709 -0.02693584]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00040094 -0.00177269 -0.04228188  0.00124827  0.00171143]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00388411 -0.00705272 -0.30597943  0.01162261  0.02507989]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00388411 -0.00705272 -0.30597943  0.01162261  0.02507989]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.1263058   1.018729    0.28716856 -0.56747425  0.490271  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.1263058   1.018729    0.28716856 -0.56747425  0.490271  ]
  [Layer 18] Output shape after mixer: (1, 1, 2048)
  [Layer 18] Output sample values after mixer: [ 2.1263058   1.018729    0.28716856 -0.56747425  0.490271  ]
  [Layer 18] Residual connection shape: (1, 1, 2048)
  [Layer 18] Residual connection sample values: [2.0318217  2.2038717  0.19411394 4.262989   0.07886472]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.12764196 0.11952125 0.01138271 0.23023361 0.00494376]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.12764196 0.11952125 0.01138271 0.23023361 0.00494376]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.12764196 0.11952125 0.01138271 0.23023361 0.00494376]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.60936016 -0.9140951  -0.6363089   0.01683079 -0.6938786 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.60936016 -0.9140951  -0.6363089   0.01683079 -0.6938786 ]
  [FlaxMamba2] xBC (step) sample values: [-1.4179927  -0.27428424  0.28177205  0.67060834 -1.509081  ]
  [FlaxMamba2] dt (step) sample values: [1.2535249 1.4104778 1.3048127 1.0943168 1.3537656]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.9309372  -0.13948123  0.76022786 -1.4179927  -0.36081186]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.10985039 -0.094859    0.04198624  0.10396141  0.29938748]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.14549492 -0.11919677  0.03698517  0.06135887  0.2664285 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06746458 -0.05605061  0.01883452  0.03162037  0.15085605]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06746458 -0.05605061  0.01883452  0.03162037  0.15085605]
  [FlaxMamba2] B (step) sample values: [ 0.01273256 -0.25906843  0.11576077  0.00542019 -0.04465405]
  [FlaxMamba2] C (step) sample values: [-0.12001254 -0.03953591  0.11480896 -0.25146887 -0.24726517]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9436172 -1.8178532 -2.0862153 -1.0006425 -0.9649832]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.17904052 0.1130652  0.08268841 0.14590019 0.25416827]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.70610857 0.81421083 0.8415534  0.8641629  0.7824947 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06746458 -0.05605061  0.01883452  0.03162037  0.15085605]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.5379522e-04  3.1292601e-03 -1.3982621e-03 -6.5469903e-05
  5.3937151e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.5379522e-04  3.1292601e-03 -1.3982621e-03 -6.5469903e-05
  5.3937151e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00129914  0.00529917 -0.00161328 -0.00174496  0.00049581]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00720278 -0.00862484 -0.0023173   0.00473806  0.00843856]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01479157 -0.01492973 -0.00019868  0.0082949   0.02540769]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01479157 -0.01492973 -0.00019868  0.0082949   0.02540769]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 3.1745650e-03  3.9053152e-03  4.3752807e-05  7.0392285e-05
 -5.8737523e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.10515556  0.13594422  0.00195384  0.00229968 -0.2729875 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.10515556  0.13594422  0.00195384  0.00229968 -0.2729875 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.44891402  0.79088175 -1.0026644  -0.06089432  0.17090021]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.44891402  0.79088175 -1.0026644  -0.06089432  0.17090021]
  [Layer 19] Output shape after mixer: (1, 1, 2048)
  [Layer 19] Output sample values after mixer: [-0.44891402  0.79088175 -1.0026644  -0.06089432  0.17090021]
  [Layer 19] Residual connection shape: (1, 1, 2048)
  [Layer 19] Residual connection sample values: [ 1.5829077   2.9947534  -0.8085505   4.2020946   0.24976493]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.09959863  0.1615317  -0.04669707  0.22448224  0.01523901]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09959863  0.1615317  -0.04669707  0.22448224  0.01523901]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09959863  0.1615317  -0.04669707  0.22448224  0.01523901]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.21064852 -0.26789445 -1.7150043  -1.753846    1.5688044 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.21064852 -0.26789445 -1.7150043  -1.753846    1.5688044 ]
  [FlaxMamba2] xBC (step) sample values: [-0.41172123  0.1886424  -1.3415697   0.5550892   1.7114893 ]
  [FlaxMamba2] dt (step) sample values: [1.46112   1.0019801 2.4725473 1.2890351 1.5023966]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.54123527 -1.2217442  -0.17979228 -0.41172123  0.76478493]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.07352074  0.15942498 -0.0734185  -0.11642312  0.04864858]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03503808  0.16795464 -0.00689018 -0.13522196  0.02119802]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01782592  0.09101298 -0.00343322 -0.06304669  0.01071135]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01782592  0.09101298 -0.00343322 -0.06304669  0.01071135]
  [FlaxMamba2] B (step) sample values: [ 0.0465206  -0.02429891  0.18901804  0.21536613  0.16006385]
  [FlaxMamba2] C (step) sample values: [ 0.02819978 -0.26006004 -0.17589428  0.08126597  0.6724993 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.6215758 -5.0388985 -1.2056414 -1.6434968 -1.3345234]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.12036301 0.03062231 0.09908481 0.15792225 0.12909336]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8226884  0.85701257 0.88739884 0.7714027  0.841745  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01782592  0.09101298 -0.00343322 -0.06304669  0.01071135]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.9813740e-05 -5.2135296e-05  4.0555364e-04  4.6208559e-04
  3.4343006e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.9813740e-05 -5.2135296e-05  4.0555364e-04  4.6208559e-04
  3.4343006e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00383591 -0.00226118  0.00403885  0.00408799  0.00222963]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [0.01846028 0.02119975 0.00508157 0.00128326 0.01046896]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [0.0186023  0.02192484 0.00505422 0.00078097 0.0105543 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [0.0186023  0.02192484 0.00505422 0.00078097 0.0105543 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00175367 -0.00254574 -0.00132201 -0.00020212  0.01370331]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.03573016 -0.05555927 -0.03873294 -0.00448058  0.27141362]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03573016 -0.05555927 -0.03873294 -0.00448058  0.27141362]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.40402293 -0.82986856  0.53088415 -0.08650482  1.150849  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.40402293 -0.82986856  0.53088415 -0.08650482  1.150849  ]
  [Layer 20] Output shape after mixer: (1, 1, 2048)
  [Layer 20] Output sample values after mixer: [ 0.40402293 -0.82986856  0.53088415 -0.08650482  1.150849  ]
  [Layer 20] Residual connection shape: (1, 1, 2048)
  [Layer 20] Residual connection sample values: [ 1.9869306   2.1648848  -0.27766633  4.1155896   1.4006139 ]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.09183968  0.09081675 -0.01104965  0.1579181   0.06053448]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09183968  0.09081675 -0.01104965  0.1579181   0.06053448]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09183968  0.09081675 -0.01104965  0.1579181   0.06053448]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.66767305 -1.2574265  -0.13289145 -1.0390522  -0.56269073]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.66767305 -1.2574265  -0.13289145 -1.0390522  -0.56269073]
  [FlaxMamba2] xBC (step) sample values: [ 0.1051529  -0.26555884 -0.69588697 -1.1507136  -0.17388971]
  [FlaxMamba2] dt (step) sample values: [1.1437752 1.9241576 1.2091384 0.9092996 2.5749328]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.12420539 -0.43140212 -0.54034585  0.1051529   0.980571  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02866076 -0.01804039  0.09352753  0.1987981   0.01844139]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.05994128 -0.04813072  0.10838196  0.19371693  0.04633446]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02907267 -0.02348633  0.05712478  0.1062108   0.02370385]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02907267 -0.02348633  0.05712478  0.1062108   0.02370385]
  [FlaxMamba2] B (step) sample values: [-0.01950928 -0.03280563 -0.04115216  0.00016468 -0.01240975]
  [FlaxMamba2] C (step) sample values: [ 0.10390062 -0.0479547  -0.0410946   0.05273822  0.14006558]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.2091806  -0.04342505 -3.8147197  -6.662431   -0.02279418]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1726813  0.02869134 0.09746414 0.05893901 0.09842754]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.5745515  0.99875486 0.68949324 0.6752468  0.9977589 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02907267 -0.02348633  0.05712478  0.1062108   0.02370385]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.7942539e-05  1.6469431e-04  2.0659644e-04 -8.2676877e-07
  6.2300765e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.7942539e-05  1.6469431e-04  2.0659644e-04 -8.2676877e-07
  6.2300765e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.0455529e-05 -2.5145867e-04  1.9028962e-04 -8.4945874e-05
  9.3703311e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00060725 -0.00040306  0.00169714  0.00295704  0.00063141]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00571043 -0.00452566  0.01172435  0.02160041  0.00479219]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00571043 -0.00452566  0.01172435  0.02160041  0.00479219]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00129257  0.00126002 -0.00072735 -0.00586534 -0.00097864]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.11302177  0.10117058 -0.07762264 -0.5278876  -0.07917149]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.11302177  0.10117058 -0.07762264 -0.5278876  -0.07917149]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.85230166  0.35240918  0.3940127  -0.25389248  2.0410857 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.85230166  0.35240918  0.3940127  -0.25389248  2.0410857 ]
  [Layer 21] Output shape after mixer: (1, 1, 2048)
  [Layer 21] Output sample values after mixer: [-0.85230166  0.35240918  0.3940127  -0.25389248  2.0410857 ]
  [Layer 21] Residual connection shape: (1, 1, 2048)
  [Layer 21] Residual connection sample values: [1.134629   2.517294   0.11634636 3.8616972  3.4416995 ]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.07996188 0.14941743 0.00731825 0.2238857  0.22739907]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.07996188 0.14941743 0.00731825 0.2238857  0.22739907]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.07996188 0.14941743 0.00731825 0.2238857  0.22739907]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.1202661   0.56571484 -0.6378291  -1.5065087  -2.2048786 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.1202661   0.56571484 -0.6378291  -1.5065087  -2.2048786 ]
  [FlaxMamba2] xBC (step) sample values: [-0.02076029 -0.04857424  2.053058   -1.8866383  -1.3058943 ]
  [FlaxMamba2] dt (step) sample values: [1.6038085 1.54004   0.8551399 0.6384778 2.136218 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.95520175 -0.03855772 -0.7527055  -0.02076029 -0.04072989]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.3330284   0.04038402  0.30594665  0.30916885 -0.37535903]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.38069686 -0.03835133  0.6252826   0.26818374 -0.44103286]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.15454726 -0.01880801  0.40732098  0.15196551 -0.17266211]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.15454726 -0.01880801  0.40732098  0.15196551 -0.17266211]
  [FlaxMamba2] B (step) sample values: [ 0.02115591 -0.11335657  0.02409341 -0.07608563  0.01124085]
  [FlaxMamba2] C (step) sample values: [-0.17316139  0.08502891 -0.1833994   0.01078895  0.2393485 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.1489344 -3.5005836 -2.8320918 -5.5395546 -1.7185895]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00660065 0.17639968 0.14082474 0.08533801 0.02396272]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9729859  0.53928995 0.67110574 0.6232955  0.9596544 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.15454726 -0.01880801  0.40732098  0.15196551 -0.17266211]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.15814016e-05  1.15636401e-04 -2.45779793e-05  7.76158777e-05
 -1.14669265e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.15814016e-05  1.15636401e-04 -2.45779793e-05  7.76158777e-05
 -1.14669265e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 8.0440266e-05  1.3237150e-07 -2.7515332e-05 -1.6036336e-04
  7.8026605e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00265166  0.00135379  0.00278786  0.00068556 -0.00083941]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04008255 -0.00320145  0.1014398   0.03749116 -0.04265766]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04008255 -0.00320145  0.1014398   0.03749116 -0.04265766]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.03385866 -0.00115508 -0.02236965 -0.01024882  0.0093409 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.21398677 -0.02055156 -0.22698963 -0.25586095  0.15312618]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.21398677 -0.02055156 -0.22698963 -0.25586095  0.15312618]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.4677005   0.8537021  -0.84265375  0.27747646  0.43128493]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.4677005   0.8537021  -0.84265375  0.27747646  0.43128493]
  [Layer 22] Output shape after mixer: (1, 1, 2048)
  [Layer 22] Output sample values after mixer: [-0.4677005   0.8537021  -0.84265375  0.27747646  0.43128493]
  [Layer 22] Residual connection shape: (1, 1, 2048)
  [Layer 22] Residual connection sample values: [ 0.6669285  3.370996  -0.7263074  4.1391735  3.8729844]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03044691  0.13240708 -0.03035494  0.16343549  0.17134005]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03044691  0.13240708 -0.03035494  0.16343549  0.17134005]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03044691  0.13240708 -0.03035494  0.16343549  0.17134005]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.02996924 -0.43288487 -0.4447513   0.00355171 -0.25251213]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.02996924 -0.43288487 -0.4447513   0.00355171 -0.25251213]
  [FlaxMamba2] xBC (step) sample values: [-1.1896893   0.44678605  1.0287627  -1.161728    0.04922815]
  [FlaxMamba2] dt (step) sample values: [ 0.70315546  1.1872895   1.7883128  -0.04166912  1.849913  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.12287944 -0.2821976  -0.30462316 -1.1896893  -0.24573228]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.4398576  -0.23408225  0.31912473 -0.2327053  -0.04409226]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.462227   -0.26719382  0.3077722  -0.23486632 -0.0934697 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.17863117 -0.11585422  0.17738186 -0.10370565 -0.0445523 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.17863117 -0.11585422  0.17738186 -0.10370565 -0.0445523 ]
  [FlaxMamba2] B (step) sample values: [-0.02218557 -0.03020129  0.07601943 -0.0002296  -0.08586314]
  [FlaxMamba2] C (step) sample values: [-0.03087743 -0.06337301  0.0750761  -0.0602673  -0.01119452]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.08112868 -3.7998476  -0.08256738 -0.48783726 -1.4532163 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02379093 0.13480614 0.06053067 0.00139674 0.00657507]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99807173 0.5991503  0.9950146  0.99931884 0.9904905 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.17863117 -0.11585422  0.17738186 -0.10370565 -0.0445523 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.4284260e-05  1.2834946e-04 -3.2306745e-04  9.7575526e-07
  3.6490127e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.4284260e-05  1.2834946e-04 -3.2306745e-04  9.7575526e-07
  3.6490127e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00036392  0.00048927 -0.00093354  0.00012356  0.00027564]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0021556  -0.00080857  0.00044618 -0.00048688 -0.0002912 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00165517  0.00166297 -0.00333794  0.00172549  0.00065924]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00165517  0.00166297 -0.00333794  0.00172549  0.00065924]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 2.5173713e-05 -2.8322599e-04  5.7988020e-04  3.0696563e-06
 -7.2779498e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00519602 -0.00741643  0.026668    0.00022648 -0.01573373]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00519602 -0.00741643  0.026668    0.00022648 -0.01573373]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.8681812   0.81939054 -1.6152616   1.0394963   0.80509025]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.8681812   0.81939054 -1.6152616   1.0394963   0.80509025]
  [Layer 23] Output shape after mixer: (1, 1, 2048)
  [Layer 23] Output sample values after mixer: [ 0.8681812   0.81939054 -1.6152616   1.0394963   0.80509025]
  [Layer 23] Residual connection shape: (1, 1, 2048)
  [Layer 23] Residual connection sample values: [ 1.5351098  4.190387  -2.341569   5.17867    4.678075 ]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05204425  0.13554835 -0.07319473  0.1561611   0.15379739]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05204425  0.13554835 -0.07319473  0.1561611   0.15379739]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05204425  0.13554835 -0.07319473  0.1561611   0.15379739]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.24665861 -1.3405885   0.5351261   0.48249704 -0.0916945 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.24665861 -1.3405885   0.5351261   0.48249704 -0.0916945 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.00151273 -0.00165033  0.7887631  -0.05209164 -0.8201866 ]
  [FlaxMamba2] dt (step) sample values: [ 2.9623606  -0.03515621 -0.16292839  2.7574384   0.85625714]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.75474715 -0.12937313 -0.7060827   0.00151273  0.32101682]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00914697 -0.11873582  0.11024471 -0.00937231 -0.39046365]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01249246 -0.11874494  0.10628505 -0.01098974 -0.3951977 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00620721 -0.05585152  0.055964   -0.00546468 -0.1590539 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00620721 -0.05585152  0.055964   -0.00546468 -0.1590539 ]
  [FlaxMamba2] B (step) sample values: [ 0.00252981  0.07705376 -0.04590409  0.09324302 -0.06289743]
  [FlaxMamba2] C (step) sample values: [-0.24234834 -0.1862534  -0.2782843  -0.24581924  0.0919904 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.07415762 -3.4496791  -3.2884939  -0.16087165 -2.6944954 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1014671  0.02808086 0.03896949 0.06991094 0.05013021]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9925037  0.907674   0.87972057 0.9888163  0.87364984]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00620721 -0.05585152  0.055964   -0.00546468 -0.1590539 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.5933466e-06 -4.8530615e-05  2.8911680e-05 -5.8727066e-05
  3.9614562e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.5933466e-06 -4.8530615e-05  2.8911680e-05 -5.8727066e-05
  3.9614562e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [1.8145776e-04 5.4570736e-04 1.2785864e-04 3.7932328e-05 6.8562268e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00047213 -0.00148262  0.00044133 -0.00044765 -0.00286553]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00043909 -0.00118529  0.0001434  -0.00041855 -0.00201879]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00043909 -0.00118529  0.0001434  -0.00041855 -0.00201879]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 4.7507630e-05  3.2957588e-04  4.8396174e-05 -1.2487383e-04
  8.8315603e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00363865  0.0357591   0.00474198 -0.04463618  0.01867566]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00363865  0.0357591   0.00474198 -0.04463618  0.01867566]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.0288543  -0.41174275  0.6626313  -0.35787317 -0.84310067]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.0288543  -0.41174275  0.6626313  -0.35787317 -0.84310067]
  [Layer 24] Output shape after mixer: (1, 1, 2048)
  [Layer 24] Output sample values after mixer: [ 0.0288543  -0.41174275  0.6626313  -0.35787317 -0.84310067]
  [Layer 24] Residual connection shape: (1, 1, 2048)
  [Layer 24] Residual connection sample values: [ 1.563964   3.778644  -1.6789377  4.820797   3.8349743]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05770577  0.12743157 -0.05849797  0.15704152  0.13999298]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05770577  0.12743157 -0.05849797  0.15704152  0.13999298]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05770577  0.12743157 -0.05849797  0.15704152  0.13999298]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.29114932 -1.3915347   1.6032369   0.25714785 -0.948242  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.29114932 -1.3915347   1.6032369   0.25714785 -0.948242  ]
  [FlaxMamba2] xBC (step) sample values: [-1.5077785 -0.1708531 -1.2169157  0.3980521 -0.5098214]
  [FlaxMamba2] dt (step) sample values: [ 0.65814936  0.43932137  0.58788985  0.6679281  -1.1559252 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.2826066   0.30831322 -0.81913954 -1.5077785  -0.0770786 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12162445 -0.01534618  0.00882029  0.07701356  0.04729947]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.11907052 -0.04355968 -0.00259329  0.13783509  0.04153546]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.06307553 -0.02130555 -0.00129496  0.07365967  0.02119897]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06307553 -0.02130555 -0.00129496  0.07365967  0.02119897]
  [FlaxMamba2] B (step) sample values: [-0.03220298  0.04722559 -0.0244579  -0.08508065  0.0227035 ]
  [FlaxMamba2] C (step) sample values: [-0.00783435 -0.04300231 -0.07703072 -0.0787532  -0.1587467 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -0.37022203  -1.5044799   -5.7209826   -0.81757224 -14.66622   ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.24996653 0.00988825 0.04667965 0.01367695 0.01038521]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9116099  0.9852334  0.76563215 0.9888804  0.8587205 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06307553 -0.02130555 -0.00129496  0.07365967  0.02119897]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00050774  0.0007446  -0.00038562 -0.00134145  0.00035796]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00050774  0.0007446  -0.00038562 -0.00134145  0.00035796]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00041536 -0.00103496 -0.00327843  0.0002957  -0.00012659]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00517722 -0.00014568  0.01074864  0.00267429  0.02040923]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00451828 -0.00036826  0.01073511  0.0034438   0.02063069]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00451828 -0.00036826  0.01073511  0.0034438   0.02063069]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00075283  0.00010206  0.01432758  0.0004994  -0.00546271]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.04946814  0.00458123  1.0382191   0.02158706 -0.517057  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.04946814  0.00458123  1.0382191   0.02158706 -0.517057  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.5485017 -1.2355696 -1.0862012  1.7116976  0.6066814]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.5485017 -1.2355696 -1.0862012  1.7116976  0.6066814]
  [Layer 25] Output shape after mixer: (1, 1, 2048)
  [Layer 25] Output sample values after mixer: [ 1.5485017 -1.2355696 -1.0862012  1.7116976  0.6066814]
  [Layer 25] Residual connection shape: (1, 1, 2048)
  [Layer 25] Residual connection sample values: [ 3.1124659  2.5430746 -2.7651389  6.5324945  4.4416556]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13003917  0.09831481 -0.10763097  0.24943577  0.18146206]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13003917  0.09831481 -0.10763097  0.24943577  0.18146206]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13003917  0.09831481 -0.10763097  0.24943577  0.18146206]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.99152946 -0.2771465  -1.1947713  -0.6371099  -0.9870525 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.99152946 -0.2771465  -1.1947713  -0.6371099  -0.9870525 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.8974074  -0.68180907  0.51936376  0.00288296 -0.81807   ]
  [FlaxMamba2] dt (step) sample values: [1.0867308 1.5278136 0.9663914 0.7631196 2.413763 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.8613749 -0.5563709  0.3082994  0.8974074 -1.5216963]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [0.22635117 0.24989799 0.10005523 0.00307966 0.14475806]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.1378502   0.1938372   0.16420317 -0.02386736  0.1528681 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.07366826  0.10628251  0.08882715 -0.01179127  0.08226486]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.07366826  0.10628251  0.08882715 -0.01179127  0.08226486]
  [FlaxMamba2] B (step) sample values: [-0.03337027  0.0115617   0.02492316  0.01602081 -0.00426875]
  [FlaxMamba2] C (step) sample values: [-0.20920953 -0.02841805  0.08278351 -0.20133509 -0.00469573]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9594627  -0.39448437 -0.84198165 -1.4275463  -0.14661841]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1597639  0.42682496 0.1567299  0.21792541 0.11617043]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.85788304 0.8450362  0.8763728  0.73264164 0.9831115 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.07366826  0.10628251  0.08882715 -0.01179127  0.08226486]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.9275235e-04  1.3607576e-04  2.9333381e-04  1.8855739e-04
 -5.0241149e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.9275235e-04  1.3607576e-04  2.9333381e-04  1.8855739e-04
 -5.0241149e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 6.4703141e-05 -1.6164236e-03 -3.1942846e-03  1.9048044e-03
 -9.9208171e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00404138  0.00963836  0.00288515 -0.0022142   0.00818233]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00534284  0.02317714  0.01420037 -0.00371623  0.01866162]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00534284  0.02317714  0.01420037 -0.00371623  0.01866162]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.003864   -0.0027695  -0.00394306  0.00081897 -0.00500093]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.06080786 -0.09678631 -0.11725642  0.03707856 -0.19767162]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.06080786 -0.09678631 -0.11725642  0.03707856 -0.19767162]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.4286903   0.37642452 -0.2946627   0.26854149 -0.886412  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.4286903   0.37642452 -0.2946627   0.26854149 -0.886412  ]
  [Layer 26] Output shape after mixer: (1, 1, 2048)
  [Layer 26] Output sample values after mixer: [-1.4286903   0.37642452 -0.2946627   0.26854149 -0.886412  ]
  [Layer 26] Residual connection shape: (1, 1, 2048)
  [Layer 26] Residual connection sample values: [ 1.6837755  2.9194992 -3.0598016  6.801036   3.5552435]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07126292  0.11274926 -0.1267809   0.25878927  0.156527  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07126292  0.11274926 -0.1267809   0.25878927  0.156527  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07126292  0.11274926 -0.1267809   0.25878927  0.156527  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.10383253 -1.1099421  -0.5558629  -0.28048587  0.850886  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.10383253 -1.1099421  -0.5558629  -0.28048587  0.850886  ]
  [FlaxMamba2] xBC (step) sample values: [-1.2518519   1.154055   -0.26629296  0.84628266 -0.7504504 ]
  [FlaxMamba2] dt (step) sample values: [0.763966   0.6116041  0.32854465 1.63766    1.1050977 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.17093506  0.2306327   0.38961276 -1.2518519  -0.02798202]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.13677329 -0.21127176 -0.04207616 -0.31770113  0.11396956]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.16277426 -0.24777079 -0.05208593 -0.5196054   0.0841844 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07477785 -0.10861585 -0.02536488 -0.19378398  0.04386291]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07477785 -0.10861585 -0.02536488 -0.19378398  0.04386291]
  [FlaxMamba2] B (step) sample values: [ 0.62648875 -0.06319089  0.20453049 -0.02315343  0.02730222]
  [FlaxMamba2] C (step) sample values: [ 0.03983499 -0.27829868  0.30230856 -0.22291732 -0.26807517]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3661706 -1.3799144 -1.8267511 -2.0408754 -2.3490334]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0886326  0.08505739 0.06699179 0.08321983 0.1304203 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.88595665 0.8892544  0.88481444 0.8437987  0.73612034]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07477785 -0.10861585 -0.02536488 -0.19378398  0.04386291]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00415221  0.00041881 -0.00135558  0.00015346 -0.00018095]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00415221  0.00041881 -0.00135558  0.00015346 -0.00018095]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00432683  0.00031122  0.00038422 -0.00066171  0.00048862]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00183684  0.01359965  0.00848022 -0.06374691 -0.00066811]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00572588  0.00261469  0.00591492 -0.08334541  0.003768  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00572588  0.00261469  0.00591492 -0.08334541  0.003768  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00028185 -0.00071939 -0.00119845  0.01006002  0.00224671]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00566947 -0.01052121 -0.03026978  0.22863454  0.03139811]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00566947 -0.01052121 -0.03026978  0.22863454  0.03139811]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.3504492   0.9300409  -1.8570771  -0.33179116 -1.6720214 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.3504492   0.9300409  -1.8570771  -0.33179116 -1.6720214 ]
  [Layer 27] Output shape after mixer: (1, 1, 2048)
  [Layer 27] Output sample values after mixer: [-1.3504492   0.9300409  -1.8570771  -0.33179116 -1.6720214 ]
  [Layer 27] Residual connection shape: (1, 1, 2048)
  [Layer 27] Residual connection sample values: [ 0.33332634  3.84954    -4.9168787   6.469245    1.8832221 ]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01278134  0.13811252 -0.17822008  0.22792476  0.07147365]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01278134  0.13811252 -0.17822008  0.22792476  0.07147365]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01278134  0.13811252 -0.17822008  0.22792476  0.07147365]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.1662079   0.955592    0.22427835  0.18325542 -2.2622085 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.1662079   0.955592    0.22427835  0.18325542 -2.2622085 ]
  [FlaxMamba2] xBC (step) sample values: [-0.02071643 -1.8382512  -0.14879027 -0.7877557  -1.0150573 ]
  [FlaxMamba2] dt (step) sample values: [ 0.9119204  -0.17152168  0.5380426   0.85078734  1.2493287 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.2130473  -0.68640137 -0.56316453 -0.02071643 -1.6029711 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.06620714  0.4618101  -0.026697   -0.15941764  0.12951949]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.12397692  0.45044994 -0.04036125 -0.17079307  0.23419479]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.0581508   0.2751106  -0.01977342 -0.07812165  0.13074686]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0581508   0.2751106  -0.01977342 -0.07812165  0.13074686]
  [FlaxMamba2] B (step) sample values: [ 0.0107508  -0.02554191 -0.02063549  0.01057915  0.27146286]
  [FlaxMamba2] C (step) sample values: [-0.15564296 -0.09822706  0.2366759  -0.18515995  0.43022373]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2727895 -3.997792  -2.517685  -2.1714401 -2.8654757]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0251546  0.03718922 0.07052936 0.03964873 0.05220034]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9684906  0.86184937 0.8373018  0.9175072  0.8610706 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0581508   0.2751106  -0.01977342 -0.07812165  0.13074686]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.5725847e-05  3.7361700e-05  3.0184785e-05 -1.5474759e-05
 -3.9708512e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.5725847e-05  3.7361700e-05  3.0184785e-05 -1.5474759e-05
 -3.9708512e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-7.5664248e-06 -1.3379354e-04  4.9228125e-05  3.4246838e-04
 -2.7721075e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 2.8912857e-05  1.1196860e-02  5.3629692e-04 -4.2646364e-03
  5.4286500e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01257659  0.07083332 -0.00375004 -0.02119927  0.03377099]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01257659  0.07083332 -0.00375004 -0.02119927  0.03377099]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.003484    0.04888669 -0.00046749 -0.00211993 -0.00720436]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.16078754  1.4952223  -0.01354524 -0.07093056 -0.23383628]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.16078754  1.4952223  -0.01354524 -0.07093056 -0.23383628]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.5927389  1.8164556 -3.6758552  1.1947032 -1.8854523]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.5927389  1.8164556 -3.6758552  1.1947032 -1.8854523]
  [Layer 28] Output shape after mixer: (1, 1, 2048)
  [Layer 28] Output sample values after mixer: [-1.5927389  1.8164556 -3.6758552  1.1947032 -1.8854523]
  [Layer 28] Residual connection shape: (1, 1, 2048)
  [Layer 28] Residual connection sample values: [-1.2594125e+00  5.6659956e+00 -8.5927334e+00  7.6639481e+00
 -2.2301674e-03]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-4.2290673e-02  1.8196917e-01 -2.7632883e-01  2.3735648e-01
 -7.4462543e-05]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-4.2290673e-02  1.8196917e-01 -2.7632883e-01  2.3735648e-01
 -7.4462543e-05]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-4.2290673e-02  1.8196917e-01 -2.7632883e-01  2.3735648e-01
 -7.4462543e-05]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.92847806 -1.1046915  -1.6755158  -0.21304318  0.35264537]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.92847806 -1.1046915  -1.6755158  -0.21304318  0.35264537]
  [FlaxMamba2] xBC (step) sample values: [ 0.21881273 -1.4939541  -0.62433136  0.1141357  -0.4156839 ]
  [FlaxMamba2] dt (step) sample values: [ 1.380407    0.2352617  -0.45261374  3.7259686   0.90235853]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.7516267   0.8002835   0.76493245  0.21881273 -0.29000187]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.09359891  0.40871513  0.1024795   0.00609069 -0.04179096]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.10700376  0.37419975  0.10532717 -0.05433412 -0.1548891 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.05064216  0.2217034   0.05543448 -0.02642919 -0.07145885]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05064216  0.2217034   0.05543448 -0.02642919 -0.07145885]
  [FlaxMamba2] B (step) sample values: [ 0.09205821 -0.05903728  0.11302801  0.00170995  0.00026165]
  [FlaxMamba2] C (step) sample values: [-0.27413255 -0.27805966 -0.17243238 -0.14117868 -0.27641258]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8072329  -2.117      -1.925669   -0.29044876 -2.049864  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08187144 0.06213845 0.04093349 0.06335502 0.14822866]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.86246496 0.87673795 0.92420226 0.9817669  0.7379726 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05064216  0.2217034   0.05543448 -0.02642919 -0.07145885]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.8168678e-04  2.4477721e-04 -4.6863066e-04 -7.0896867e-06
 -1.0848466e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.8168678e-04  2.4477721e-04 -4.6863066e-04 -7.0896867e-06
 -1.0848466e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-5.77577564e-04  2.99887848e-04 -2.40008318e-04  1.93818123e-05
 -1.15944174e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00651946 -0.00388311 -0.00833011  0.01457492 -0.01493838]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05830254  0.22281504  0.04835325 -0.0124497  -0.08800713]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05830254  0.22281504  0.04835325 -0.0124497  -0.08800713]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.03880044 -0.06125532 -0.01277553  0.00118543 -0.01822576]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.32842654 -0.4879417  -0.16124225  0.01342056 -0.18306029]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.32842654 -0.4879417  -0.16124225  0.01342056 -0.18306029]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.72074205  1.2032973   1.8427299   0.8788079  -0.4013383 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.72074205  1.2032973   1.8427299   0.8788079  -0.4013383 ]
  [Layer 29] Output shape after mixer: (1, 1, 2048)
  [Layer 29] Output sample values after mixer: [ 0.72074205  1.2032973   1.8427299   0.8788079  -0.4013383 ]
  [Layer 29] Residual connection shape: (1, 1, 2048)
  [Layer 29] Residual connection sample values: [-0.5386705   6.8692927  -6.7500033   8.542756   -0.40356848]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01822785  0.22871527 -0.22317186  0.26636657 -0.01403205]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.01822785  0.22871527 -0.22317186  0.26636657 -0.01403205]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.01822785  0.22871527 -0.22317186  0.26636657 -0.01403205]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.71021664 -1.4404439  -0.7752038  -0.05881981  0.97449285]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.71021664 -1.4404439  -0.7752038  -0.05881981  0.97449285]
  [FlaxMamba2] xBC (step) sample values: [ 1.1604306   0.40173358 -0.1933204   0.22720005  0.04880706]
  [FlaxMamba2] dt (step) sample values: [1.2284216 1.1472383 0.5850668 1.0444356 1.1558046]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.15517214  0.6973957   1.1255277   1.1604306  -0.524763  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.18744552  0.05572356 -0.08568866 -0.04194034 -0.01110662]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.16416061  0.06942595 -0.05254657 -0.06008304 -0.03845037]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.08880239  0.03591748 -0.02558316 -0.0291393  -0.01885562]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.08880239  0.03591748 -0.02558316 -0.0291393  -0.01885562]
  [FlaxMamba2] B (step) sample values: [ 0.08295804 -0.02252056  0.07447855  0.2457901  -0.00137176]
  [FlaxMamba2] C (step) sample values: [-0.2321656   0.07908112  0.14401971  0.07431384 -0.20884043]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0149885  -0.4675477  -0.42799968 -0.7895216  -0.4174731 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01354422 0.2970268  0.39257857 0.15059869 0.29822642]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.98634684 0.8703375  0.84533393 0.88789576 0.88293695]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.08880239  0.03591748 -0.02558316 -0.0291393  -0.01885562]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.9778510e-05 -2.7086804e-05  8.9579742e-05  2.9562620e-04
 -1.6498919e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.9778510e-05 -2.7086804e-05  8.9579742e-05  2.9562620e-04
 -1.6498919e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 5.7669682e-04 -1.4977655e-04  2.9201507e-05  9.1214571e-04
 -6.8015666e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00168688 -0.00023531 -0.00047569 -0.0004915   0.00010655]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.11108468  0.0440123  -0.03199219 -0.0363889  -0.02312214]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.11108468  0.0440123  -0.03199219 -0.0363889  -0.02312214]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.05289453 -0.01213909  0.00782094  0.00103873 -0.01635881]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.58532655 -0.13633786  0.05332685  0.0095423  -0.13355535]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.58532655 -0.13633786  0.05332685  0.0095423  -0.13355535]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.7552383  -1.2809361  -0.8162445  -0.26098472  1.7387192 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.7552383  -1.2809361  -0.8162445  -0.26098472  1.7387192 ]
  [Layer 30] Output shape after mixer: (1, 1, 2048)
  [Layer 30] Output sample values after mixer: [ 2.7552383  -1.2809361  -0.8162445  -0.26098472  1.7387192 ]
  [Layer 30] Residual connection shape: (1, 1, 2048)
  [Layer 30] Residual connection sample values: [ 2.2165678  5.5883565 -7.566248   8.281772   1.3351507]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07160429  0.17711887 -0.24050584  0.25620955  0.04357502]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07160429  0.17711887 -0.24050584  0.25620955  0.04357502]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07160429  0.17711887 -0.24050584  0.25620955  0.04357502]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.99222267  0.56242007 -0.44072857  1.4573355   1.221019  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.99222267  0.56242007 -0.44072857  1.4573355   1.221019  ]
  [FlaxMamba2] xBC (step) sample values: [ 0.26194924  0.37529522 -0.6760443   0.48937118 -2.2157772 ]
  [FlaxMamba2] dt (step) sample values: [ 1.3559744   1.0785409   1.6521015  -0.04324846  1.2563769 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.30198482  1.1247746   0.07625837  0.26194924 -0.1925232 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04085017 -0.05723546  0.02987016 -0.09371655  0.41120446]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04035474 -0.06755804  0.03088487 -0.09561436  0.40590203]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02058444 -0.03263843  0.01568088 -0.04552339  0.24358378]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02058444 -0.03263843  0.01568088 -0.04552339  0.24358378]
  [FlaxMamba2] B (step) sample values: [ 0.10939858 -0.14275523  0.01527734 -0.05219986 -0.01728206]
  [FlaxMamba2] C (step) sample values: [-0.13182546 -0.17482822 -0.20927379 -0.08426469 -0.16573688]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.9477868 -3.5383902 -4.705952  -2.462968  -0.9027082]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.12240922 0.06536571 0.07976495 0.05731727 0.13889584]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6970931  0.7935098  0.68703496 0.86834115 0.8821595 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02058444 -0.03263843  0.01568088 -0.04552339  0.24358378]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.7565434e-04 -3.5970393e-04  3.8494694e-05 -1.3152929e-04
 -4.3546035e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.7565434e-04 -3.5970393e-04  3.8494694e-05 -1.3152929e-04
 -4.3546035e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00184458  0.00036816  0.00024295 -0.00168871 -0.00041958]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00622328 -0.00761779  0.01871943 -0.02044977  0.02733542]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02038571 -0.03007357  0.02950814 -0.05177061  0.19492505]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02038571 -0.03007357  0.02950814 -0.05177061  0.19492505]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00547091 -0.01077441 -0.00509237 -0.06119706  0.18379934]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.079759   -0.13721891 -0.05775066 -0.7386887   2.6290824 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.079759   -0.13721891 -0.05775066 -0.7386887   2.6290824 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.0675426  1.297381  -3.5198417  1.3079726 -1.2833211]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.0675426  1.297381  -3.5198417  1.3079726 -1.2833211]
  [Layer 31] Output shape after mixer: (1, 1, 2048)
  [Layer 31] Output sample values after mixer: [-2.0675426  1.297381  -3.5198417  1.3079726 -1.2833211]
  [Layer 31] Residual connection shape: (1, 1, 2048)
  [Layer 31] Residual connection sample values: [  0.1490252    6.8857374  -11.08609      9.589745     0.05182958]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00477963  0.22179396 -0.35613367  0.28854162  0.00172848]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00477963  0.22179396 -0.35613367  0.28854162  0.00172848]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00477963  0.22179396 -0.35613367  0.28854162  0.00172848]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.2652713  -0.0347705  -2.8267715  -1.8729157  -0.41833663]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.2652713  -0.0347705  -2.8267715  -1.8729157  -0.41833663]
  [FlaxMamba2] xBC (step) sample values: [ 0.05904174  0.4397621  -1.1832354   0.32975093  0.7497758 ]
  [FlaxMamba2] dt (step) sample values: [1.2270855  1.6523058  0.41542682 0.48629084 0.23196362]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.19561742 -0.927233    0.49158794  0.05904174  0.977304  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.09957103  0.11293527  0.1157423  -0.13306355 -0.14860144]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.06240062  0.0609028   0.09990367 -0.12058187 -0.15557471]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03022717  0.0313784   0.05244495 -0.05666034 -0.07174865]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03022717  0.0313784   0.05244495 -0.05666034 -0.07174865]
  [FlaxMamba2] B (step) sample values: [ 0.01557844 -0.01252637  0.08857168 -0.00716955 -0.05513567]
  [FlaxMamba2] C (step) sample values: [-0.2382842   0.24168733  0.35416582 -0.24340335 -0.11961289]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6970906 -2.0892735 -1.7966746 -1.3893797 -1.0395182]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.24474308 0.02807981 0.16963519 0.15906589 0.1963988 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8431519 0.9430213 0.7372861 0.8017143 0.8153318]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03022717  0.0313784   0.05244495 -0.05666034 -0.07174865]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.1524761e-04  9.2668677e-05 -6.5524358e-04  5.3039570e-05
  4.0788765e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.1524761e-04  9.2668677e-05 -6.5524358e-04  5.3039570e-05
  4.0788765e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00256187  0.00393449  0.00046687 -0.0045235  -0.00154038]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0600206  -0.02322099 -0.0130531  -0.03405354  0.00136572]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.05276983 -0.01569406 -0.00047282 -0.04764499 -0.01584506]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.05276983 -0.01569406 -0.00047282 -0.04764499 -0.01584506]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-6.0762288e-03  2.6810219e-04  7.4706557e-05  1.1886529e-02
  2.6309767e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.0438851   0.00155763  0.00084293  0.10977709  0.019872  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0438851   0.00155763  0.00084293  0.10977709  0.019872  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.3337708  -0.8551315   0.94068897  1.7582753  -3.1265657 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.3337708  -0.8551315   0.94068897  1.7582753  -3.1265657 ]
  [Layer 32] Output shape after mixer: (1, 1, 2048)
  [Layer 32] Output sample values after mixer: [ 1.3337708  -0.8551315   0.94068897  1.7582753  -3.1265657 ]
  [Layer 32] Residual connection shape: (1, 1, 2048)
  [Layer 32] Residual connection sample values: [  1.482796   6.030606 -10.145401  11.34802   -3.074736]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04292328  0.18090276 -0.2991624   0.32492286 -0.0921881 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.04292328  0.18090276 -0.2991624   0.32492286 -0.0921881 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.04292328  0.18090276 -0.2991624   0.32492286 -0.0921881 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.6231017  -1.0491357   0.14899924  0.5629591  -0.8032655 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.6231017  -1.0491357   0.14899924  0.5629591  -0.8032655 ]
  [FlaxMamba2] xBC (step) sample values: [-0.82687455 -1.1368337  -0.20715019 -0.96264654 -0.32566306]
  [FlaxMamba2] dt (step) sample values: [-0.67953837  1.9511951   1.9124204   1.9040282  -0.48232836]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.07010851 -0.30283353 -1.0278451  -0.82687455  0.39136913]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.14155242 -0.10155442  0.0066709  -0.19367622  0.03254468]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.15469787 -0.15093186  0.03349585 -0.19488262  0.03135544]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07137798 -0.06978162  0.01702839 -0.08797643  0.01592349]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07137798 -0.06978162  0.01702839 -0.08797643  0.01592349]
  [FlaxMamba2] B (step) sample values: [ 0.44878188 -0.04494689  0.03218456 -0.02325454  0.02370761]
  [FlaxMamba2] C (step) sample values: [-0.0081819  -0.18545905 -0.24002424 -0.18741891 -0.03913311]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9790505  -9.693779   -6.1677613  -0.11351943 -2.090294  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00597586 0.06824284 0.08458373 0.05332518 0.00177354]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.98824316 0.51606065 0.5935153  0.99396485 0.9962996 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07137798 -0.06978162  0.01702839 -0.08797643  0.01592349]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.9142548e-04  1.9171855e-05 -1.3728149e-05  9.9190975e-06
 -1.0112353e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.9142548e-04  1.9171855e-05 -1.3728149e-05  9.9190975e-06
 -1.0112353e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.9406455e-05  7.0684262e-05 -7.4871656e-05 -1.8652972e-05
  6.4487387e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00037881 -0.00028032  0.00031749 -0.00062645 -0.00047029]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07470266 -0.07294191  0.01804867 -0.0922338   0.01611039]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07470266 -0.07294191  0.01804867 -0.0922338   0.01611039]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01997928  0.01985016  0.00144461 -0.0330826  -0.00400298]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.2757057   0.1632529   0.01497063 -0.33484498 -0.04585376]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.2757057   0.1632529   0.01497063 -0.33484498 -0.04585376]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.9707985   0.65592927 -1.0806359  -0.5541017   1.0351375 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.9707985   0.65592927 -1.0806359  -0.5541017   1.0351375 ]
  [Layer 33] Output shape after mixer: (1, 1, 2048)
  [Layer 33] Output sample values after mixer: [ 2.9707985   0.65592927 -1.0806359  -0.5541017   1.0351375 ]
  [Layer 33] Residual connection shape: (1, 1, 2048)
  [Layer 33] Residual connection sample values: [  4.453594    6.686535  -11.226037   10.793918   -2.0395985]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.10455238  0.16632351 -0.26337492  0.2554851  -0.05021795]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10455238  0.16632351 -0.26337492  0.2554851  -0.05021795]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10455238  0.16632351 -0.26337492  0.2554851  -0.05021795]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.27795503  0.06963104  0.13768561 -0.1849184   0.26381162]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.27795503  0.06963104  0.13768561 -0.1849184   0.26381162]
  [FlaxMamba2] xBC (step) sample values: [-0.66166776 -0.19410421 -1.0543287  -0.8207577  -0.02863644]
  [FlaxMamba2] dt (step) sample values: [1.8722699 1.24128   3.702856  2.9395258 2.6357737]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5417618   0.34320295  0.5365614  -0.66166776 -0.13738504]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12744118  0.03900531 -0.19513243  0.2001393  -0.00836193]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.09555031  0.0650368  -0.20707244  0.16061904 -0.01689923]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.05005589  0.03357548 -0.09285462  0.08674531 -0.00837822]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05005589  0.03357548 -0.09285462  0.08674531 -0.00837822]
  [FlaxMamba2] B (step) sample values: [ 0.47309744 -0.00493808 -0.02231559 -0.00646064 -0.04822944]
  [FlaxMamba2] C (step) sample values: [ 0.00098834 -0.26952878 -0.26659366 -0.23449916 -0.27526197]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.5610816  -2.4810736  -2.893596   -0.01585086 -0.02613366]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.29914942 0.10803162 0.32384372 0.24211383 0.09974501]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.4648009  0.7648815  0.39177293 0.9961696  0.9973967 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05005589  0.03357548 -0.09285462  0.08674531 -0.00837822]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 7.0842514e-03 -7.3943767e-05 -3.3415793e-04 -9.6742922e-05
 -7.2219688e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 7.0842514e-03 -7.3943767e-05 -3.3415793e-04 -9.6742922e-05
 -7.2219688e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 5.5716503e-03 -7.3605916e-05 -5.8789592e-05 -8.0201717e-04
 -4.4410754e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00141856  0.00265869 -0.00589468  0.00744788  0.00062677]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03225014  0.02333928 -0.06308784  0.06087806 -0.00453374]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03225014  0.02333928 -0.06308784  0.06087806 -0.00453374]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00386312  0.00084085 -0.00464167 -0.00510979 -0.00067645]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.10413255  0.02204271 -0.13911626 -0.17220518 -0.02165201]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.10413255  0.02204271 -0.13911626 -0.17220518 -0.02165201]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.60403764 -0.20915425 -3.821064    3.51254    -0.38993344]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.60403764 -0.20915425 -3.821064    3.51254    -0.38993344]
  [Layer 34] Output shape after mixer: (1, 1, 2048)
  [Layer 34] Output sample values after mixer: [ 0.60403764 -0.20915425 -3.821064    3.51254    -0.38993344]
  [Layer 34] Residual connection shape: (1, 1, 2048)
  [Layer 34] Residual connection sample values: [  5.057632    6.4773808 -15.047101   14.3064575  -2.4295318]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.12014066  0.15357526 -0.35102093  0.31304458 -0.05711244]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12014066  0.15357526 -0.35102093  0.31304458 -0.05711244]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12014066  0.15357526 -0.35102093  0.31304458 -0.05711244]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.5090214  -0.9039678   0.39402568  0.45952561 -2.0511308 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.5090214  -0.9039678   0.39402568  0.45952561 -2.0511308 ]
  [FlaxMamba2] xBC (step) sample values: [-0.04688474  0.45092207  0.34937224 -1.4219772  -0.11657994]
  [FlaxMamba2] dt (step) sample values: [4.3219194  1.3012582  0.88798445 1.0997603  1.5316601 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.08924146 -0.38777608 -1.697997   -0.04688474  0.40323204]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00146421 -0.10835019 -0.05042532 -0.31349456 -0.01274853]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.15747006 -0.06721249 -0.08661917 -0.35844696 -0.05422192]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07254861 -0.03247729 -0.04143504 -0.14744198 -0.02637614]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07254861 -0.03247729 -0.04143504 -0.14744198 -0.02637614]
  [FlaxMamba2] B (step) sample values: [ 0.00771382  0.13130084 -0.26576808  0.27635354 -0.05433642]
  [FlaxMamba2] C (step) sample values: [-0.24167381  0.44301924 -0.23904991 -0.18666896 -0.09727776]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.709799  -2.7746034 -0.4452666 -1.139112  -3.5906036]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.5237781  0.06106384 0.3473817  0.18796918 0.11454538]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6895079  0.84414756 0.8566914  0.8072532  0.6627967 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07254861 -0.03247729 -0.04143504 -0.14744198 -0.02637614]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00029312 -0.00498935  0.01009902 -0.01050126  0.00206475]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00029312 -0.00498935  0.01009902 -0.01050126  0.00206475]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00402603 -0.00781748  0.01685043 -0.0175917   0.00190727]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.03002148 -0.02320254 -0.0209522  -0.06233491 -0.00237361]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07908817 -0.04516786 -0.0489759  -0.16205412 -0.02021254]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07908817 -0.04516786 -0.0489759  -0.16205412 -0.02021254]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02161159  0.01176875 -0.01152562 -0.04564157  0.00472371]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.44513094  0.12895589 -0.08923481 -0.4084708   0.05676435]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.44513094  0.12895589 -0.08923481 -0.4084708   0.05676435]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 5.0211406  4.420937   1.5853014  2.7325115 -2.1380503]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 5.0211406  4.420937   1.5853014  2.7325115 -2.1380503]
  [Layer 35] Output shape after mixer: (1, 1, 2048)
  [Layer 35] Output sample values after mixer: [ 5.0211406  4.420937   1.5853014  2.7325115 -2.1380503]
  [Layer 35] Residual connection shape: (1, 1, 2048)
  [Layer 35] Residual connection sample values: [ 10.078773  10.898317 -13.4618    17.038969  -4.567582]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.18890934  0.20681098 -0.25056097  0.31507632 -0.08765596]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18890934  0.20681098 -0.25056097  0.31507632 -0.08765596]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18890934  0.20681098 -0.25056097  0.31507632 -0.08765596]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.17899737 -0.9124203   0.27511683 -0.7344062  -0.50969976]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.17899737 -0.9124203   0.27511683 -0.7344062  -0.50969976]
  [FlaxMamba2] xBC (step) sample values: [-0.4720742   0.5465798  -0.21469629 -0.26977843 -0.26834688]
  [FlaxMamba2] dt (step) sample values: [1.0121611  3.2002764  1.1065545  0.85286653 0.28829727]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.05992574  0.46189055 -0.54411405 -0.4720742  -0.22647047]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.1046793   0.1038941  -0.03855081 -0.05719441  0.0436514 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.06848545  0.10376035 -0.06703897 -0.08212727  0.01578885]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.03541483  0.05456931 -0.03239635 -0.03937836  0.00795675]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03541483  0.05456931 -0.03239635 -0.03937836  0.00795675]
  [FlaxMamba2] B (step) sample values: [ 0.05125561  0.3363636  -0.03941868 -0.03633041 -0.09574056]
  [FlaxMamba2] C (step) sample values: [ 0.07306441 -0.27147222 -0.2596502  -0.09575621 -0.13465641]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6566098 -1.1305923 -1.6058172 -2.4414158 -2.882315 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11328715 0.08672924 0.06381948 0.0838751  0.05432259]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.74010754 0.9065987  0.90259403 0.81483144 0.85506755]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03541483  0.05456931 -0.03239635 -0.03937836  0.00795675]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00020564  0.00134951 -0.00015815 -0.00014576 -0.00038412]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00020564  0.00134951 -0.00015815 -0.00014576 -0.00038412]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-5.7430635e-04 -1.1279982e-03 -3.7632900e-04  4.9735181e-04
  7.4817886e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00033437  0.0031762  -0.00240136 -0.0009063  -0.0011662 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.04024348  0.06570101 -0.03952067 -0.04602551  0.00795053]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.04024348  0.06570101 -0.03952067 -0.04602551  0.00795053]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00328025 -0.01717509 -0.00617954  0.01095939 -0.00152071]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.05061482 -0.3865975  -0.09395678  0.18754514 -0.0225288 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.05061482 -0.3865975  -0.09395678  0.18754514 -0.0225288 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-6.630576    4.972296    4.60603    -4.9824777   0.84294385]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-6.630576    4.972296    4.60603    -4.9824777   0.84294385]
  [Layer 36] Output shape after mixer: (1, 1, 2048)
  [Layer 36] Output sample values after mixer: [-6.630576    4.972296    4.60603    -4.9824777   0.84294385]
  [Layer 36] Residual connection shape: (1, 1, 2048)
  [Layer 36] Residual connection sample values: [ 3.4481964 15.870613  -8.85577   12.056492  -3.7246382]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.06953323  0.32743055 -0.176437    0.23521063 -0.07568645]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.06953323  0.32743055 -0.176437    0.23521063 -0.07568645]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.06953323  0.32743055 -0.176437    0.23521063 -0.07568645]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.0402023   2.491987    6.5921087  -2.8279011  -0.09773264]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.0402023   2.491987    6.5921087  -2.8279011  -0.09773264]
  [FlaxMamba2] xBC (step) sample values: [-0.6521405  -0.22544284  0.6003313   0.97604793  1.9785442 ]
  [FlaxMamba2] dt (step) sample values: [1.6498604  0.96464455 2.8734775  1.3384256  0.9045999 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.12987068 -0.68881214 -0.07730158 -0.6521405   0.17452303]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [0.11074595 0.03962786 0.01995812 0.3519047  0.28871503]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [0.09836344 0.01118547 0.02495919 0.20102578 0.30345502]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [0.05159862 0.00562402 0.01263533 0.11058185 0.1745737 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [0.05159862 0.00562402 0.01263533 0.11058185 0.1745737 ]
  [FlaxMamba2] B (step) sample values: [-0.00668014  0.26909018 -0.04740835  0.06175512 -0.02740445]
  [FlaxMamba2] C (step) sample values: [-0.20203799 -0.02553484 -0.2342082  -0.2757855  -0.27789545]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.06064401 -3.2470093  -0.81907064 -0.24529998 -1.975189  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04791834 0.02539808 0.15431854 0.0047598  0.02858032]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99709827 0.9208411  0.8812642  0.9988331  0.9451123 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [0.05159862 0.00562402 0.01263533 0.11058185 0.1745737 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.65167730e-05  6.65330852e-04 -1.17218086e-04  1.52690787e-04
 -6.77580538e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.65167730e-05  6.65330852e-04 -1.17218086e-04  1.52690787e-04
 -6.77580538e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 4.3525441e-05  1.2357830e-04 -8.4500609e-04  8.0216693e-04
 -3.8650545e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00165044 -0.00813144 -0.00465773  0.05331158  0.04857502]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00816883 -0.0092017  -0.00706225  0.03226774  0.01535347]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00816883 -0.0092017  -0.00706225  0.03226774  0.01535347]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00627851 -0.02117812 -0.04649135 -0.00509494 -0.00071363]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.04717812 -0.14443411 -0.6248569  -0.12650517 -0.00396027]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.04717812 -0.14443411 -0.6248569  -0.12650517 -0.00396027]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.33940676 -1.9782907  -0.03062759  0.06392047 -1.1543901 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.33940676 -1.9782907  -0.03062759  0.06392047 -1.1543901 ]
  [Layer 37] Output shape after mixer: (1, 1, 2048)
  [Layer 37] Output sample values after mixer: [ 0.33940676 -1.9782907  -0.03062759  0.06392047 -1.1543901 ]
  [Layer 37] Residual connection shape: (1, 1, 2048)
  [Layer 37] Residual connection sample values: [ 3.7876031 13.892323  -8.886397  12.120412  -4.8790283]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.06362598  0.23161198 -0.14745069  0.1962234  -0.080957  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.06362598  0.23161198 -0.14745069  0.1962234  -0.080957  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.06362598  0.23161198 -0.14745069  0.1962234  -0.080957  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.17725945 -0.5995256   0.6554459  -1.1954     -1.1023165 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.17725945 -0.5995256   0.6554459  -1.1954     -1.1023165 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.7721357   0.47873154  0.23733956 -0.54501164 -0.34123275]
  [FlaxMamba2] dt (step) sample values: [1.8251271  2.0470018  0.11861364 1.2934941  1.4980893 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.3685623  0.9851128  1.0854717  0.7721357  0.36048767]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.15729642 -0.06846499 -0.04227296  0.17523628 -0.04848328]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.12920499 -0.1056354  -0.06804505  0.16363198 -0.06973878]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06043481 -0.05003058 -0.03286544  0.08849495 -0.03365401]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06043481 -0.05003058 -0.03286544  0.08849495 -0.03365401]
  [FlaxMamba2] B (step) sample values: [-0.20674635 -0.270501   -0.0519049   0.01198158 -0.2691434 ]
  [FlaxMamba2] C (step) sample values: [-0.20373125 -0.21937063 -0.06241836 -0.13925917 -0.27822345]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0881431 -1.3535548 -1.1764196 -1.6451025 -1.1940706]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.2857126  0.21163948 0.18718511 0.14562964 0.09891498]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.73278993 0.7509129  0.8023517  0.7869617  0.888597  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06043481 -0.05003058 -0.03286544  0.08849495 -0.03365401]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00356989  0.00467074  0.00089624 -0.00020689  0.0046473 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00356989  0.00467074  0.00089624 -0.00020689  0.0046473 ]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00901357 0.01097461 0.00150637 0.00050361 0.01078186]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02386906 -0.02906765 -0.00127013  0.05859616  0.00868176]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07281061 -0.0695836  -0.02788535  0.13026148 -0.01857206]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07281061 -0.0695836  -0.02788535  0.13026148 -0.01857206]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00588273  0.01478674 -0.01203081 -0.03617165  0.00510387]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.10258582  0.24940568 -0.21287814 -0.5838708   0.0741116 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.10258582  0.24940568 -0.21287814 -0.5838708   0.0741116 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.6012673 -2.4689355 -3.3280284  1.2166083  0.2747929]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.6012673 -2.4689355 -3.3280284  1.2166083  0.2747929]
  [Layer 38] Output shape after mixer: (1, 1, 2048)
  [Layer 38] Output sample values after mixer: [ 1.6012673 -2.4689355 -3.3280284  1.2166083  0.2747929]
  [Layer 38] Residual connection shape: (1, 1, 2048)
  [Layer 38] Residual connection sample values: [  5.3888702  11.423388  -12.214426   13.33702    -4.6042356]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07162418  0.15339077 -0.16260707  0.1778396  -0.06192402]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07162418  0.15339077 -0.16260707  0.1778396  -0.06192402]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07162418  0.15339077 -0.16260707  0.1778396  -0.06192402]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.22223276 -0.16961849  0.5251397  -0.90170974 -0.2224525 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.22223276 -0.16961849  0.5251397  -0.90170974 -0.2224525 ]
  [FlaxMamba2] xBC (step) sample values: [-0.03167162 -1.564645    0.9642953  -1.1194394  -0.30535728]
  [FlaxMamba2] dt (step) sample values: [ 3.1004546  1.8670032  1.6441015  0.5851918 -0.2605401]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.13210464  0.5098075  -0.19454132 -0.03167162  0.37305754]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00267872  0.25320473  0.16871154 -0.22926795 -0.06028521]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01701435  0.3384098   0.14637268 -0.22519004 -0.08126605]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00843481  0.19756506  0.07853304 -0.09997069 -0.03898289]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00843481  0.19756506  0.07853304 -0.09997069 -0.03898289]
  [FlaxMamba2] B (step) sample values: [ 0.04337925  0.01687775 -0.00058032  0.08981253  0.00824482]
  [FlaxMamba2] C (step) sample values: [ 0.11455835  0.18145856  0.27519664  0.07300152 -0.24805896]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.69420344 -0.9242845  -1.3151171  -3.1532621  -2.1087465 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10235731 0.0478432  0.04517016 0.04864464 0.01986243]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.931409   0.95674276 0.94232595 0.8577957  0.9589802 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00843481  0.19756506  0.07853304 -0.09997069 -0.03898289]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.7452090e-05 -1.4571645e-05  5.0102432e-07 -7.7540906e-05
 -7.1182803e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.7452090e-05 -1.4571645e-05  5.0102432e-07 -7.7540906e-05
 -7.1182803e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00027362 -0.00013243  0.00010869 -0.00016531  0.00036293]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 1.3922377e-03  5.0933533e-03  6.6273853e-05 -4.3526697e-03
  2.2325674e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00583518  0.17437837  0.06735786 -0.09001325 -0.03117019]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00583518  0.17437837  0.06735786 -0.09001325 -0.03117019]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00072014 -0.01353766  0.02222613  0.02343251  0.00308291]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.0191828  -0.38737357  0.6501231   0.5542234   0.08314464]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0191828  -0.38737357  0.6501231   0.5542234   0.08314464]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.3357704  -0.33231488 -1.8551451   0.5551123  -5.331964  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.3357704  -0.33231488 -1.8551451   0.5551123  -5.331964  ]
  [Layer 39] Output shape after mixer: (1, 1, 2048)
  [Layer 39] Output sample values after mixer: [ 1.3357704  -0.33231488 -1.8551451   0.5551123  -5.331964  ]
  [Layer 39] Residual connection shape: (1, 1, 2048)
  [Layer 39] Residual connection sample values: [  6.724641   11.091073  -14.0695715  13.892132   -9.936199 ]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07900948  0.13133155 -0.17103581  0.16477315 -0.1164166 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07900948  0.13133155 -0.17103581  0.16477315 -0.1164166 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07900948  0.13133155 -0.17103581  0.16477315 -0.1164166 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.11646402 -1.032075   -0.28821477 -0.09992608 -0.26568365]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.11646402 -1.032075   -0.28821477 -0.09992608 -0.26568365]
  [FlaxMamba2] xBC (step) sample values: [ 0.02948296 -0.02222425  0.09368293 -0.38621548 -0.25056428]
  [FlaxMamba2] dt (step) sample values: [0.39996386 1.666208   2.6845684  0.45091373 0.7714021 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.00908942 -0.5224164  -0.30313236  0.02948296 -0.8358764 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00117425  0.01506503  0.03014738  0.08026142 -0.0583388 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01682977 -0.00356595  0.03590376  0.07038899 -0.06310336]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00834407 -0.0017798   0.01827412  0.03643264 -0.0305565 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00834407 -0.0017798   0.01827412  0.03643264 -0.0305565 ]
  [FlaxMamba2] B (step) sample values: [-0.01972521  0.0595832  -0.03944496 -0.03916525  0.01474567]
  [FlaxMamba2] C (step) sample values: [-0.2570589   0.05385723  0.06022699  0.9801738   0.16710028]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9809841  -1.4352343  -0.79658854 -1.6062093  -1.8464803 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08405028 0.06955443 0.06466324 0.05731846 0.12369796]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8466209 0.9049941 0.9497942 0.9120455 0.7958012]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00834407 -0.0017798   0.01827412  0.03643264 -0.0305565 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.3833721e-05 -4.1786996e-05  2.7663615e-05  2.7467442e-05
 -1.0341461e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.3833721e-05 -4.1786996e-05  2.7663615e-05  2.7467442e-05
 -1.0341461e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00024718  0.00125208  0.00051147 -0.00022857  0.00041154]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00037177  0.00226953  0.00440487  0.00494162 -0.00026792]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00718621  0.00081601  0.01932897  0.03469542 -0.0252228 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00718621  0.00081601  0.01932897  0.03469542 -0.0252228 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00039413 -0.00022123 -0.0023868  -0.00164695  0.00290814]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01038573 -0.00586441 -0.06230037 -0.05093847  0.07564134]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01038573 -0.00586441 -0.06230037 -0.05093847  0.07564134]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-8.261755    0.1406276  -7.6037107   0.88036543  3.331595  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-8.261755    0.1406276  -7.6037107   0.88036543  3.331595  ]
  [Layer 40] Output shape after mixer: (1, 1, 2048)
  [Layer 40] Output sample values after mixer: [-8.261755    0.1406276  -7.6037107   0.88036543  3.331595  ]
  [Layer 40] Residual connection shape: (1, 1, 2048)
  [Layer 40] Residual connection sample values: [ -1.5371141  11.231701  -21.673283   14.772497   -6.6046042]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.0170387   0.12552407 -0.24537382  0.16375114 -0.07357179]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.0170387   0.12552407 -0.24537382  0.16375114 -0.07357179]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.0170387   0.12552407 -0.24537382  0.16375114 -0.07357179]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.11120956  0.42606422 -0.6806036   0.1296003   0.1188664 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.11120956  0.42606422 -0.6806036   0.1296003   0.1188664 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.3270118   0.278807    1.571199    0.46107137 -1.2298362 ]
  [FlaxMamba2] dt (step) sample values: [0.87946916 1.4045389  2.0266469  0.4564251  2.4552102 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.0878199   0.30033192 -0.72513354  0.3270118  -0.5384447 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.04082201  0.08208498  0.2787376   0.08140591 -0.3844088 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.05417345  0.06808504  0.2808357   0.07466915 -0.39999565]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02635322  0.03520096  0.16000643  0.0387278  -0.16052361]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02635322  0.03520096  0.16000643  0.0387278  -0.16052361]
  [FlaxMamba2] B (step) sample values: [-0.06477867  0.09461308  0.12547483 -0.27762872  0.36938572]
  [FlaxMamba2] C (step) sample values: [ 0.03120882  0.07361092  0.03321765 -0.02213448  0.06716909]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8258594 -1.8636904 -1.2829287 -1.4542811 -4.4079003]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08766649 0.12215405 0.05340442 0.06444232 0.07195153]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.85208696 0.7963971  0.9337803  0.91054016 0.7282177 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02635322  0.03520096  0.16000643  0.0387278  -0.16052361]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00014966 -0.00021858 -0.00028988  0.0006414  -0.00085339]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00014966 -0.00021858 -0.00028988  0.0006414  -0.00085339]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0005947   0.00024022 -0.0012982   0.00196924 -0.00239884]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00107628  0.00188652  0.00771886  0.00197691 -0.00559836]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0267623   0.03619629  0.16367435  0.03972423 -0.16205792]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0267623   0.03619629  0.16367435  0.03972423 -0.16205792]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00157077  0.00932925 -0.03744362  0.00274071 -0.01020339]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.04728255  0.2806655  -1.1086614   0.08524615 -0.24733871]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.04728255  0.2806655  -1.1086614   0.08524615 -0.24733871]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 5.3489795  1.4266294  5.835989  -3.652505   1.5253942]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 5.3489795  1.4266294  5.835989  -3.652505   1.5253942]
  [Layer 41] Output shape after mixer: (1, 1, 2048)
  [Layer 41] Output sample values after mixer: [ 5.3489795  1.4266294  5.835989  -3.652505   1.5253942]
  [Layer 41] Residual connection shape: (1, 1, 2048)
  [Layer 41] Residual connection sample values: [  3.8118653  12.65833   -15.837294   11.119992   -5.0792103]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04076659  0.1380241  -0.17111786  0.11806761 -0.0540688 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.04076659  0.1380241  -0.17111786  0.11806761 -0.0540688 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.04076659  0.1380241  -0.17111786  0.11806761 -0.0540688 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.33046126  0.2972078  -0.6147923   0.0479496   0.7224657 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.33046126  0.2972078  -0.6147923   0.0479496   0.7224657 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.08567549  0.4672822  -0.38563237 -0.5459152   0.21418568]
  [FlaxMamba2] dt (step) sample values: [1.838379   0.7907684  2.217477   0.07090764 2.870759  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.01793338 -0.22297688  0.6472919   0.08567549  0.37336898]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01879598 -0.06437808 -0.04563423  0.02276929  0.04497632]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.00946523 -0.07759219 -0.03558632  0.02629598  0.02503308]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00475501 -0.03729171 -0.01747659  0.01332085  0.0126732 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00475501 -0.03729171 -0.01747659  0.01332085  0.0126732 ]
  [FlaxMamba2] B (step) sample values: [ 0.08239407 -0.06912159 -0.05443859 -0.08662999  0.3745412 ]
  [FlaxMamba2] C (step) sample values: [-0.05981498  0.05171257  0.0086248  -0.11803591 -0.27843043]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.06612   -1.4514434 -0.7269863 -1.9455162 -0.6256312]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.12721936 0.32547408 0.03123704 0.02903228 0.18292822]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.87316465 0.6234996  0.977547   0.9450828  0.8918604 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00475501 -0.03729171 -0.01747659  0.01332085  0.0126732 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.9842634e-05 -4.1813717e-05 -3.2931526e-05 -5.2405067e-05
  2.2657115e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.9842634e-05 -4.1813717e-05 -3.2931526e-05 -5.2405067e-05
  2.2657115e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00037981  0.00031552 -0.00032527  0.00028768  0.00054705]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00096187 -0.00150212  0.0012704   0.00059385  0.00438834]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00573343 -0.03892359 -0.016267    0.01396105  0.01710563]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00573343 -0.03892359 -0.016267    0.01396105  0.01710563]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00079222 -0.00663748  0.00350996  0.00034274  0.00831894]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.03048426 -0.25107875  0.13506186  0.0109158   0.29057035]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03048426 -0.25107875  0.13506186  0.0109158   0.29057035]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.1478596 -2.514259  -1.9779323 -6.376584   0.3138255]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.1478596 -2.514259  -1.9779323 -6.376584   0.3138255]
  [Layer 42] Output shape after mixer: (1, 1, 2048)
  [Layer 42] Output sample values after mixer: [ 3.1478596 -2.514259  -1.9779323 -6.376584   0.3138255]
  [Layer 42] Residual connection shape: (1, 1, 2048)
  [Layer 42] Residual connection sample values: [  6.959725   10.144071  -17.815226    4.743408   -4.7653847]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07100323  0.10851222 -0.18231423  0.04921678 -0.04821495]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07100323  0.10851222 -0.18231423  0.04921678 -0.04821495]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07100323  0.10851222 -0.18231423  0.04921678 -0.04821495]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.313147   -0.6311135  -0.27507722  0.93264747  0.06526291]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.313147   -0.6311135  -0.27507722  0.93264747  0.06526291]
  [FlaxMamba2] xBC (step) sample values: [ 0.9579304   0.03600967 -0.16671145  1.5191884  -0.6055172 ]
  [FlaxMamba2] dt (step) sample values: [2.729432  0.8962525 0.8703002 2.2311935 0.7376736]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.5833921  0.57381314 0.12404744 0.9579304  0.22891739]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.1366067  -0.05010175  0.01105871 -0.2815623   0.09554993]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.13303614 -0.09578656  0.02353277 -0.27566096  0.08673035]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.07093621 -0.04560127  0.01190482 -0.11895263  0.04524454]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.07093621 -0.04560127  0.01190482 -0.11895263  0.04524454]
  [FlaxMamba2] B (step) sample values: [-0.05989062 -0.14352655  0.8818328   0.0349347  -0.00907199]
  [FlaxMamba2] C (step) sample values: [-0.1445828  -0.09174801 -0.27646983 -0.12862736  0.16632313]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9761645 -1.478265  -1.0588893 -1.0815219 -5.9141264]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06028486 0.0361139  0.01936889 0.06248263 0.10886534]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9428501 0.9480141 0.9796994 0.9346564 0.5252697]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.07093621 -0.04560127  0.01190482 -0.11895263  0.04524454]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.5611508e-04 -6.1377406e-04  3.7710520e-03  1.4939404e-04
 -3.8795279e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.5611508e-04 -6.1377406e-04  3.7710520e-03  1.4939404e-04
 -3.8795279e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-9.1097652e-05 -1.2014250e-03  9.5960516e-03  1.9558641e-04
 -6.4811371e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00325608 -0.00315968 -0.00661906 -0.00327162  0.0004017 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.06485473 -0.0427583   0.0037187  -0.10656615  0.03969056]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.06485473 -0.0427583   0.0037187  -0.10656615  0.03969056]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00857747  0.00937088 -0.00044156 -0.07132249  0.00133741]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.3930792   0.32940626 -0.01456851 -2.594426    0.05610612]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.3930792   0.32940626 -0.01456851 -2.594426    0.05610612]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.6873521   2.935168   -0.59397864  2.3998427   6.9038424 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.6873521   2.935168   -0.59397864  2.3998427   6.9038424 ]
  [Layer 43] Output shape after mixer: (1, 1, 2048)
  [Layer 43] Output sample values after mixer: [ 1.6873521   2.935168   -0.59397864  2.3998427   6.9038424 ]
  [Layer 43] Residual connection shape: (1, 1, 2048)
  [Layer 43] Residual connection sample values: [  8.647077   13.079239  -18.409204    7.143251    2.1384578]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.08380865  0.13177314 -0.18009378  0.06887352  0.02070468]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.08380865  0.13177314 -0.18009378  0.06887352  0.02070468]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.08380865  0.13177314 -0.18009378  0.06887352  0.02070468]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.30170515 -3.057313   -0.40983495  0.36918762 -0.78172326]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.30170515 -3.057313   -0.40983495  0.36918762 -0.78172326]
  [FlaxMamba2] xBC (step) sample values: [-0.94895405  1.2354441   0.3703142  -1.0735822  -1.8391985 ]
  [FlaxMamba2] dt (step) sample values: [1.5953283 2.8216252 0.2717336 2.213057  2.1051414]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.41412812 -0.21585748  0.30552325 -0.94895405 -0.24874759]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.15413508 -0.15757002  0.06353011 -0.15613832  0.21604274]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.16024241 -0.09714521  0.04506698 -0.16268815  0.16355251]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.0737155  -0.04621517  0.02304116 -0.07474178  0.08844874]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0737155  -0.04621517  0.02304116 -0.07474178  0.08844874]
  [FlaxMamba2] B (step) sample values: [-0.27774698  0.0843808   0.06254663 -0.02346449  0.14299254]
  [FlaxMamba2] C (step) sample values: [-0.2727229  -0.05919381 -0.00876214  0.0736964   0.12175024]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.74823433 -0.64391696 -1.1771379  -1.350584   -1.0269372 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10357562 0.22726096 0.0145851  0.0868175  0.27024817]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9254281  0.8638663  0.98297787 0.889359   0.7576544 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0737155  -0.04621517  0.02304116 -0.07474178  0.08844874]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00212063 -0.00064426 -0.00047755  0.00017915 -0.00109177]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00212063 -0.00064426 -0.00047755  0.00017915 -0.00109177]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.001915   -0.00053229 -0.00039419  0.00011788 -0.00130135]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00205162 -0.0009552   0.00035945 -0.00377424  0.00377371]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07129748 -0.04436817  0.02200355 -0.07398416  0.08685949]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07129748 -0.04436817  0.02200355 -0.07398416  0.08685949]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00914512  0.00609095 -0.00359768 -0.01614977 -0.02131714]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.33889252  0.18021613 -0.14365026 -0.5592984  -0.8031877 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.33889252  0.18021613 -0.14365026 -0.5592984  -0.8031877 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.7287246   0.13642843 -6.244244   -0.74732685 -4.1280203 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.7287246   0.13642843 -6.244244   -0.74732685 -4.1280203 ]
  [Layer 44] Output shape after mixer: (1, 1, 2048)
  [Layer 44] Output sample values after mixer: [ 1.7287246   0.13642843 -6.244244   -0.74732685 -4.1280203 ]
  [Layer 44] Residual connection shape: (1, 1, 2048)
  [Layer 44] Residual connection sample values: [ 10.375801   13.215668  -24.653448    6.395924   -1.9895625]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.09926601  0.12990977 -0.23682152  0.06019377 -0.01893742]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09926601  0.12990977 -0.23682152  0.06019377 -0.01893742]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09926601  0.12990977 -0.23682152  0.06019377 -0.01893742]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.6336205  -0.0502695   0.10606514 -0.32139343 -0.36323738]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.6336205  -0.0502695   0.10606514 -0.32139343 -0.36323738]
  [FlaxMamba2] xBC (step) sample values: [-0.22580063  0.38722134 -0.5152928  -1.0364221  -2.4787831 ]
  [FlaxMamba2] dt (step) sample values: [2.9282863  1.8903679  0.47067153 1.3110895  2.454482  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6202787  -0.13488795 -0.37752372 -0.22580063  0.55071837]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03965133 -0.07486295 -0.08689697 -0.17519602  0.42236662]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04422897 -0.02264737 -0.08934791 -0.18178019  0.41986418]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02162551 -0.01119547 -0.04267952 -0.08265176  0.25336733]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02162551 -0.01119547 -0.04267952 -0.08265176  0.25336733]
  [FlaxMamba2] B (step) sample values: [-0.14897078 -0.04613086 -0.0262225  -0.16702189 -0.0149792 ]
  [FlaxMamba2] C (step) sample values: [-0.03188546  0.0884832  -0.02264346 -0.11988591  0.13870224]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.250236  -4.181475  -1.0937363 -2.677446  -2.3148744]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.12676108 0.14083414 0.03091644 0.04599675 0.06275812]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.751832   0.55494046 0.96675086 0.8841277  0.8647826 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02162551 -0.01119547 -0.04267952 -0.08265176  0.25336733]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [4.0836967e-04 1.2645729e-04 7.1883034e-05 4.5785267e-04 4.1062092e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [4.0836967e-04 1.2645729e-04 7.1883034e-05 4.5785267e-04 4.1062092e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 6.5106805e-04  1.4583769e-05 -3.0505144e-05  1.4063295e-03
  1.8705291e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00308891 -0.00136877 -0.00538021 -0.0044114   0.02413143]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02734917 -0.01392824 -0.0532596  -0.09713305  0.3083678 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02734917 -0.01392824 -0.0532596  -0.09713305  0.3083678 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00600779  0.00034129 -0.00297414  0.01312202 -0.04594411]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.22631902  0.00932287 -0.10295956  0.4158555  -1.5615857 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.22631902  0.00932287 -0.10295956  0.4158555  -1.5615857 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [6.5237775  2.9164965  0.12893689 2.126642   3.736315  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [6.5237775  2.9164965  0.12893689 2.126642   3.736315  ]
  [Layer 45] Output shape after mixer: (1, 1, 2048)
  [Layer 45] Output sample values after mixer: [6.5237775  2.9164965  0.12893689 2.126642   3.736315  ]
  [Layer 45] Residual connection shape: (1, 1, 2048)
  [Layer 45] Residual connection sample values: [ 16.899578   16.132164  -24.524511    8.522566    1.7467525]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.18673353  0.18578789 -0.27602544  0.09520576  0.01917039]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18673353  0.18578789 -0.27602544  0.09520576  0.01917039]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18673353  0.18578789 -0.27602544  0.09520576  0.01917039]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.77312446 -0.21398643  0.21124831  0.31452647 -0.5727646 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.77312446 -0.21398643  0.21124831  0.31452647 -0.5727646 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.19496793  0.07607359  0.3945552  -0.91097355 -0.19904692]
  [FlaxMamba2] dt (step) sample values: [1.7065909  1.4575299  1.6385065  1.6470479  0.51600975]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.08927929 0.26237017 0.3332455  0.19496793 0.87362844]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.04153749  0.02675908  0.07009575  0.12603194  0.03096049]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04467507  0.02295965  0.04899284  0.11019331  0.05126994]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02183865  0.0116116   0.02509637  0.05812923  0.02629198]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02183865  0.0116116   0.02509637  0.05812923  0.02629198]
  [FlaxMamba2] B (step) sample values: [-0.02985835 -0.27037343  0.01326449 -0.01899363 -0.00312586]
  [FlaxMamba2] C (step) sample values: [-0.03620482 -0.27533957 -0.08012515  0.17316025  0.26179513]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8673339  -0.9793274  -1.6584101  -0.94076145 -0.4381494 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01653183 0.02417227 0.03218601 0.05256238 0.01472916]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9696012  0.9766054  0.948022   0.95175403 0.9935672 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02183865  0.0116116   0.02509637  0.05812923  0.02629198]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0779843e-05  9.7613680e-05 -4.7889157e-06  6.8573245e-06
  1.1285392e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0779843e-05  9.7613680e-05 -4.7889157e-06  6.8573245e-06
  1.1285392e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-5.2590945e-05  5.9058209e-04 -5.1344126e-05  2.3460270e-05
 -1.3191346e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-4.7254225e-04  7.8505116e-05 -3.2195072e-05  6.9163617e-04
  3.0722198e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01790972  0.00934985  0.02000613  0.04710521  0.02130018]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01790972  0.00934985  0.02000613  0.04710521  0.02130018]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00437276 -0.00089374  0.0023355   0.0085634  -0.00439931]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.13545941 -0.02643217  0.06239515  0.21175449 -0.13285191]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.13545941 -0.02643217  0.06239515  0.21175449 -0.13285191]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.9379263  2.6157286 -1.2570837  0.605213   2.633879 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.9379263  2.6157286 -1.2570837  0.605213   2.633879 ]
  [Layer 46] Output shape after mixer: (1, 1, 2048)
  [Layer 46] Output sample values after mixer: [-2.9379263  2.6157286 -1.2570837  0.605213   2.633879 ]
  [Layer 46] Residual connection shape: (1, 1, 2048)
  [Layer 46] Residual connection sample values: [ 13.961652   18.747892  -25.781595    9.127779    4.3806314]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13312063  0.18045698 -0.23845305  0.08545759  0.03906574]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13312063  0.18045698 -0.23845305  0.08545759  0.03906574]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13312063  0.18045698 -0.23845305  0.08545759  0.03906574]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.0473427   1.1790711  -0.52220774 -0.42150044  0.07678349]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.0473427   1.1790711  -0.52220774 -0.42150044  0.07678349]
  [FlaxMamba2] xBC (step) sample values: [ 0.22847776 -0.39338654  0.56006366  0.9942084   0.3629781 ]
  [FlaxMamba2] dt (step) sample values: [ 0.21048081 -0.7095773   2.1893456   1.1201278   1.4547571 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.6534126  -0.02679448  0.22775415  0.22847776 -0.2784253 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03203714 -0.06929187  0.05268943 -0.1350309   0.04884478]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01493204 -0.09419422 -0.16679299 -0.13841072  0.05402132]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00741028 -0.04488061 -0.0764576  -0.06442361  0.02774006]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00741028 -0.04488061 -0.0764576  -0.06442361  0.02774006]
  [FlaxMamba2] B (step) sample values: [-0.15274477 -0.0681017  -0.14582574 -0.27754605  0.14613202]
  [FlaxMamba2] C (step) sample values: [ 0.6733658   0.02414533 -0.05117444 -0.27105746 -0.12674217]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -3.552239  -11.244981   -2.6866128  -3.193549   -3.1997924]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02753273 0.00749877 0.02284259 0.01116651 0.04885071]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9068277  0.9191339  0.94047594 0.96496755 0.8552922 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00741028 -0.04488061 -0.0764576  -0.06442361  0.02774006]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.1163785e-05  1.3894464e-05  2.9752131e-05  5.6626395e-05
 -2.9814619e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.1163785e-05  1.3894464e-05  2.9752131e-05  5.6626395e-05
 -2.9814619e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00058663 -0.00024053 -0.00176524 -0.00084122  0.00017109]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00081301 -0.00268931 -0.00497005 -0.00192946 -0.00027849]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00966379 -0.06614238 -0.11306727 -0.09301279  0.03894093]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00966379 -0.06614238 -0.11306727 -0.09301279  0.03894093]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00023417 -0.05964263  0.02198444  0.01553134  0.00155238]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00685045 -1.0457689   0.63082784  0.46554145  0.04462718]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00685045 -1.0457689   0.63082784  0.46554145  0.04462718]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-7.464368  8.51794   1.268532  2.178452 -5.858176]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-7.464368  8.51794   1.268532  2.178452 -5.858176]
  [Layer 47] Output shape after mixer: (1, 1, 2048)
  [Layer 47] Output sample values after mixer: [-7.464368  8.51794   1.268532  2.178452 -5.858176]
  [Layer 47] Residual connection shape: (1, 1, 2048)
  [Layer 47] Residual connection sample values: [  6.497284   27.265831  -24.513063   11.306231   -1.4775448]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.06019662  0.23588389 -0.20730218  0.09864376 -0.01216329]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.06019662  0.23588389 -0.20730218  0.09864376 -0.01216329]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.06019662  0.23588389 -0.20730218  0.09864376 -0.01216329]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.2495502  -2.2774277  -0.9691697   0.17031918 -0.7544295 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.2495502  -2.2774277  -0.9691697   0.17031918 -0.7544295 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.37658596  0.28610983 -0.30938387 -1.0471148  -0.19048673]
  [FlaxMamba2] dt (step) sample values: [ 0.83763057  1.4227169   0.51628894  0.9364529  -0.10764055]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.44788995  0.7010987   0.03665016  0.37658596 -0.43445674]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.06611726  0.03946506 -0.04198569 -0.20374972  0.02662052]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.07128999  0.25943577 -0.12786216 -0.2700339   0.0241753 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03437497  0.14645086 -0.05984945 -0.11689734  0.01223375]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03437497  0.14645086 -0.05984945 -0.11689734  0.01223375]
  [FlaxMamba2] B (step) sample values: [-0.10476114  0.04501421 -0.04303365 -0.04933577 -0.06860919]
  [FlaxMamba2] C (step) sample values: [-0.13867179 -0.26733607  0.04087261 -0.15973988 -0.01590626]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-54.81184   -78.514336  -47.25076    -2.330753   -4.2266355]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06991863 0.03608272 0.00679873 0.00279102 0.00675321]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.02165825 0.05883545 0.72524524 0.99351597 0.9718602 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03437497  0.14645086 -0.05984945 -0.11689734  0.01223375]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00025179 -0.00010819  0.00010343  0.00011858  0.0001649 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00025179 -0.00010819  0.00010343  0.00011858  0.0001649 ]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00025265 -0.00010585  0.00010257  0.00011681  0.00016609]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00065163  0.00277183 -0.00120136 -0.00224771  0.00021076]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02802197  0.11938021 -0.04885521 -0.09532472  0.00995163]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02802197  0.11938021 -0.04885521 -0.09532472  0.00995163]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00393046 -0.02528746  0.01302315 -0.00880746 -0.00240142]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.14259489 -0.75185716  0.40071464 -0.31053242 -0.09425846]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.14259489 -0.75185716  0.40071464 -0.31053242 -0.09425846]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-15.288472    3.355547    3.7792552  13.410538   -7.3091063]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-15.288472    3.355547    3.7792552  13.410538   -7.3091063]
  [Layer 48] Output shape after mixer: (1, 1, 2048)
  [Layer 48] Output sample values after mixer: [-15.288472    3.355547    3.7792552  13.410538   -7.3091063]
  [Layer 48] Residual connection shape: (1, 1, 2048)
  [Layer 48] Residual connection sample values: [ -8.791188  30.621378 -20.733809  24.716768  -8.786652]
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.07849328  0.3024011  -0.18853174  0.22919719 -0.07769644]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Final backbone norm output sample values: [-0.07849328  0.3024011  -0.18853174  0.22919719 -0.07769644]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 1, 50288)
[Mamba2LMHeadModel] Logits sample values: [  8.909474  -15.075212    9.212229   10.583016    6.8715005]
[Mamba2LMHeadModel] Forward pass input_ids shape: (1, 1)
[Mamba2LMHeadModel] input_ids sample values: [434]
[Mamba2LMHeadModel] Embedding output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Embedding sample values: [-0.00767899 -0.07769775 -0.20996094  0.11254883 -0.11322021]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00843969 -0.09662784 -0.23838888  0.12778753 -0.12632163]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00843969 -0.09662784 -0.23838888  0.12778753 -0.12632163]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00843969 -0.09662784 -0.23838888  0.12778753 -0.12632163]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.32585347 -0.62040913 -0.47813037  0.28615594 -0.26072785]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.32585347 -0.62040913 -0.47813037  0.28615594 -0.26072785]
  [FlaxMamba2] xBC (step) sample values: [ 0.09133587 -0.23571667  0.47919992  0.8171824  -1.3478118 ]
  [FlaxMamba2] dt (step) sample values: [ 0.54894346 -0.18177679  0.21761896 -0.14112407  0.30384326]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5844494  -0.20654811 -0.83976954  0.09133587 -0.6217285 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.14501569 -0.01820013 -0.17942867 -0.04753524  0.05760247]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.08276752  0.1971319   0.09083501  0.0016591  -0.19923347]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.04309539  0.10824986  0.04747884  0.00083024 -0.08972593]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04309539  0.10824986  0.04747884  0.00083024 -0.08972593]
  [FlaxMamba2] B (step) sample values: [ 0.39736313  0.3635397  -0.2781869  -0.27599525 -0.14531256]
  [FlaxMamba2] C (step) sample values: [-0.26960713 -0.24967945 -0.16926126 -0.26838192  0.05466824]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.617978  -2.5226073 -3.0473056 -3.307819  -3.9089987]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0156979  0.01132871 0.01125176 0.02125866 0.00986206]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9597362  0.9718266  0.96629363 0.9320957  0.9621829 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04309539  0.10824986  0.04747884  0.00083024 -0.08972593]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.6881904e-04  2.4593726e-04 -1.8819547e-04 -1.8671280e-04
 -9.8305012e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.6881904e-04  2.4593726e-04 -1.8819547e-04 -1.8671280e-04
 -9.8305012e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00184758  0.00039363 -0.00221641 -0.00240007  0.00054319]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.02366866  0.02521857  0.02866621  0.00252326 -0.02380122]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.04010428  0.06650265  0.04677358  0.00283989 -0.05802068]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.04010428  0.06650265  0.04677358  0.00283989 -0.05802068]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00547881 -0.01442774 -0.00855851  0.00046407  0.0065833 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00461838 -0.01309928 -0.00615514  0.00064575  0.00565229]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00461838 -0.01309928 -0.00615514  0.00064575  0.00565229]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.01036652  0.04804441  0.06383304  0.04656573 -0.08934034]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.01036652  0.04804441  0.06383304  0.04656573 -0.08934034]
  [Layer 1] Output shape after mixer: (1, 1, 2048)
  [Layer 1] Output sample values after mixer: [-0.01036652  0.04804441  0.06383304  0.04656573 -0.08934034]
  [Layer 1] Residual connection shape: (1, 1, 2048)
  [Layer 1] Residual connection sample values: [-0.01804551 -0.02965335 -0.14612791  0.15911455 -0.20256054]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03143784 -0.04079736 -0.23460887  0.26764154 -0.33284688]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03143784 -0.04079736 -0.23460887  0.26764154 -0.33284688]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03143784 -0.04079736 -0.23460887  0.26764154 -0.33284688]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.4158604  -0.49060413  0.0706167   0.02545494 -1.0586898 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.4158604  -0.49060413  0.0706167   0.02545494 -1.0586898 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.12975971  0.9405384  -0.79284996  3.8682632   0.45160115]
  [FlaxMamba2] dt (step) sample values: [2.4628286 1.96971   1.2750975 1.4425377 2.413502 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.78967863 -0.82048094  1.0773478   0.12975971  0.7915649 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.1607237  -0.2755454  -0.27079666 -3.1857455  -0.1970886 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.13090803 -0.4300864  -0.28130996 -2.1320345  -0.21021879]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.06973213 -0.16949952 -0.1210006  -0.22604257 -0.09410192]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06973213 -0.16949952 -0.1210006  -0.22604257 -0.09410192]
  [FlaxMamba2] B (step) sample values: [ 0.24531087 -0.02674534  0.0529779  -0.2578942   0.36580467]
  [FlaxMamba2] C (step) sample values: [-0.24564129 -0.19860312  0.04142151 -0.20250319 -0.24674632]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-19.851534   -18.68525    -13.564036    -2.4188707   -0.46617994]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06927541 0.0442066  0.07356635 0.03059673 0.15389805]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.25278318 0.43779197 0.36866874 0.92866284 0.93076897]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06973213 -0.16949952 -0.1210006  -0.22604257 -0.09410192]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00118503 -0.0001292   0.00025592 -0.00124582  0.0017671 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00118503 -0.0001292   0.00025592 -0.00124582  0.0017671 ]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00068611 -0.0002585   0.00014637 -0.00273643  0.00220094]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00194544 -0.0416831  -0.0192508  -0.05011218  0.00807789]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.04619393 -0.15869659 -0.1027832  -0.20615998 -0.05688509]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.04619393 -0.15869659 -0.1027832  -0.20615998 -0.05688509]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01277417  0.02956637 -0.00375719 -0.00265729  0.0155112 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00438323  0.00479945 -0.00136557 -0.00039102  0.00571543]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00438323  0.00479945 -0.00136557 -0.00039102  0.00571543]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.19462802  0.27354142  0.21125197 -0.25786006  0.1439603 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.19462802  0.27354142  0.21125197 -0.25786006  0.1439603 ]
  [Layer 2] Output shape after mixer: (1, 1, 2048)
  [Layer 2] Output sample values after mixer: [ 0.19462802  0.27354142  0.21125197 -0.25786006  0.1439603 ]
  [Layer 2] Residual connection shape: (1, 1, 2048)
  [Layer 2] Residual connection sample values: [ 0.17658252  0.24388808  0.06512406 -0.09874551 -0.05860025]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.23933728  0.2584618   0.07907698 -0.12336532 -0.07874077]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.23933728  0.2584618   0.07907698 -0.12336532 -0.07874077]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.23933728  0.2584618   0.07907698 -0.12336532 -0.07874077]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.1527457   0.58552516  1.2579054  -0.95631015 -1.4145374 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.1527457   0.58552516  1.2579054  -0.95631015 -1.4145374 ]
  [FlaxMamba2] xBC (step) sample values: [-0.9023777 -0.4886475 -2.4976516  1.3647225 -0.5667416]
  [FlaxMamba2] dt (step) sample values: [3.0301695  0.63625455 1.1280069  2.286851   0.5893873 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.13996676  2.6808503  -2.0851595  -0.9023777  -1.194446  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.13253403  0.749062    0.3550851  -0.22644158 -0.16411225]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.13098526  0.72975963  0.47874233 -0.23877831 -0.18040864]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.06977579  0.4924071   0.29559985 -0.10520273 -0.0820895 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06977579  0.4924071   0.29559985 -0.10520273 -0.0820895 ]
  [FlaxMamba2] B (step) sample values: [ 0.3154777  -0.07880805  0.26476514 -0.10475446  0.21260916]
  [FlaxMamba2] C (step) sample values: [ 0.44907558  0.00826331 -0.07379142  0.10167932  0.28001067]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6505536 -3.9938898 -6.780579  -0.9418818 -6.0307717]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.160643   0.03817007 0.0415075  0.06277866 0.03875995]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9007686  0.8586044  0.7546925  0.94258416 0.7915578 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06977579  0.4924071   0.29559985 -0.10520273 -0.0820895 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00353619 -0.00088336  0.00296775 -0.00117419  0.00238313]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00353619 -0.00088336  0.00296775 -0.00117419  0.00238313]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0050691  -0.00086571  0.00439445 -0.00073283  0.00121785]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02154154  0.09631391  0.10798586  0.00074657  0.00156827]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01022546  0.32049337  0.24256438 -0.04714935 -0.03580483]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01022546  0.32049337  0.24256438 -0.04714935 -0.03580483]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.00895853 0.12053912 0.23758872 0.01251761 0.00990252]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.00229179 0.0336241  0.0534117  0.00431084 0.0019652 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.00229179 0.0336241  0.0534117  0.00431084 0.0019652 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.01423971 -0.08601407  0.06860431  0.08861657  0.11059854]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.01423971 -0.08601407  0.06860431  0.08861657  0.11059854]
  [Layer 3] Output shape after mixer: (1, 1, 2048)
  [Layer 3] Output sample values after mixer: [-0.01423971 -0.08601407  0.06860431  0.08861657  0.11059854]
  [Layer 3] Residual connection shape: (1, 1, 2048)
  [Layer 3] Residual connection sample values: [ 0.16234282  0.15787402  0.13372838 -0.01012894  0.05199829]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.21624288  0.15925758  0.15735266 -0.01232758  0.0694798 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.21624288  0.15925758  0.15735266 -0.01232758  0.0694798 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.21624288  0.15925758  0.15735266 -0.01232758  0.0694798 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.858675    0.4518812  -1.0288539  -0.19285493 -0.615061  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.858675    0.4518812  -1.0288539  -0.19285493 -0.615061  ]
  [FlaxMamba2] xBC (step) sample values: [ 0.6362446   0.2179003   1.2141987  -0.21777962 -0.9601589 ]
  [FlaxMamba2] dt (step) sample values: [ 2.4908788   3.2310524   3.0539565   0.9915276  -0.76993704]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.01396449 0.00505049 1.1195325  0.6362446  1.6211092 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.08083986  0.2622036  -0.21597224 -0.3571175   0.48132795]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.00704835  0.22704735 -0.26419002 -0.37294087  0.7742967 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.0035366   0.12635621 -0.1147467  -0.1520967   0.5299671 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0035366   0.12635621 -0.1147467  -0.1520967   0.5299671 ]
  [FlaxMamba2] B (step) sample values: [ 0.5037562   0.20591041  0.8470955  -0.02684601  0.35249987]
  [FlaxMamba2] C (step) sample values: [ 0.7366499  -0.27439782  0.07082761 -0.27827892 -0.07039031]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.7127254  -1.2862217  -1.4869522 -27.028044   -4.0726624]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.07171629 0.0592458  0.03980259 0.00870986 0.01772606]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8844137  0.9266279  0.9425328  0.79024637 0.93035203]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0035366   0.12635621 -0.1147467  -0.1520967   0.5299671 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.2776851e-04  5.2225390e-05  2.1485020e-04 -6.8089962e-06
  8.9405112e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.2776851e-04  5.2225390e-05  2.1485020e-04 -6.8089962e-06
  8.9405112e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-7.8935578e-04 -1.3211895e-03 -5.1655259e-04 -4.8843856e-05
 -1.7782341e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00497755  0.01084235 -0.00777048 -0.00392645  0.11315533]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00298688  0.08196537 -0.07235878 -0.08953821  0.41146174]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00298688  0.08196537 -0.07235878 -0.08953821  0.41146174]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00074868  0.02263379  0.01960227  0.00780396 -0.08880511]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00031503  0.00611926  0.00810945  0.00272059 -0.01847408]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00031503  0.00611926  0.00810945  0.00272059 -0.01847408]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.06684447 -0.12579705  0.09249283  0.13575864  0.08245438]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.06684447 -0.12579705  0.09249283  0.13575864  0.08245438]
  [Layer 4] Output shape after mixer: (1, 1, 2048)
  [Layer 4] Output sample values after mixer: [-0.06684447 -0.12579705  0.09249283  0.13575864  0.08245438]
  [Layer 4] Residual connection shape: (1, 1, 2048)
  [Layer 4] Residual connection sample values: [0.09549835 0.03207697 0.22622122 0.1256297  0.13445267]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.10717011 0.02974799 0.23711914 0.13503669 0.15570006]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.10717011 0.02974799 0.23711914 0.13503669 0.15570006]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.10717011 0.02974799 0.23711914 0.13503669 0.15570006]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.54000825  0.42843065 -0.6267869  -1.4609305  -0.49403608]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.54000825  0.42843065 -0.6267869  -1.4609305  -0.49403608]
  [FlaxMamba2] xBC (step) sample values: [-0.02045043 -0.17593281  1.5059112  -0.35910463 -2.4785779 ]
  [FlaxMamba2] dt (step) sample values: [ 2.3746104   2.217774    1.1407351  -1.1430293  -0.27572194]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.26593763  0.27706146 -0.48543358 -0.02045043  1.1387584 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.07033822  0.20466648 -0.4991588   0.3916916  -0.35174933]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01876351  0.16734348 -0.56867784  0.36556855 -0.35761252]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00946977  0.09065641 -0.2056009   0.2158272  -0.14717102]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00946977  0.09065641 -0.2056009   0.2158272  -0.14717102]
  [FlaxMamba2] B (step) sample values: [-0.1910819  -0.08542453 -0.05804042 -0.13515893 -0.082872  ]
  [FlaxMamba2] C (step) sample values: [ 0.05140496 -0.0459419  -0.21149936  0.07151551  0.03827821]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.5762966   -1.0443833   -0.83880144  -5.6764617  -20.401838  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04105421 0.10545415 0.12717418 0.00445029 0.00258843]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.93733585 0.8957136  0.89881873 0.9750545  0.94856143]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00946977  0.09065641 -0.2056009   0.2158272  -0.14717102]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.4287658e-05 -3.3210828e-05 -2.2564602e-05 -5.2546264e-05
 -3.2218471e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.4287658e-05 -3.3210828e-05 -2.2564602e-05 -5.2546264e-05
 -3.2218471e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00027611 -0.00011006  0.00042995  0.00020381 -0.00040549]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00718252  0.00165304 -0.03337042 -0.01490292 -0.02762222]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00209225  0.05038345 -0.14388679  0.10111037 -0.10673085]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00209225  0.05038345 -0.14388679  0.10111037 -0.10673085]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00041599  0.01307019  0.03140645 -0.02781847  0.01998126]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00021203  0.00679416  0.01555022 -0.01441661  0.00917849]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00021203  0.00679416  0.01555022 -0.01441661  0.00917849]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.05256791 -0.22203594  0.16984767  0.04374755  0.02912827]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.05256791 -0.22203594  0.16984767  0.04374755  0.02912827]
  [Layer 5] Output shape after mixer: (1, 1, 2048)
  [Layer 5] Output sample values after mixer: [-0.05256791 -0.22203594  0.16984767  0.04374755  0.02912827]
  [Layer 5] Residual connection shape: (1, 1, 2048)
  [Layer 5] Residual connection sample values: [ 0.04293043 -0.18995897  0.39606887  0.16937724  0.16358094]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03670719 -0.12570855  0.3005674   0.1328691   0.14188278]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03670719 -0.12570855  0.3005674   0.1328691   0.14188278]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03670719 -0.12570855  0.3005674   0.1328691   0.14188278]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.2573317   0.2593599  -0.28377372 -0.39328954 -1.2931896 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.2573317   0.2593599  -0.28377372 -0.39328954 -1.2931896 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.45463678  0.7236467  -1.0692732   0.6266857   0.32562336]
  [FlaxMamba2] dt (step) sample values: [ 2.8843162   2.64041    -0.15060459  0.04699767  1.7845415 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.32843578 -0.38086557 -0.996089    0.45463678 -0.8687187 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02821811 -0.01947523 -1.7747467  -0.1125346  -0.65405005]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.00614468 -0.09180188 -1.836911   -0.05043133 -0.5843479 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00308178 -0.04379553 -0.25242287 -0.02457997 -0.20915724]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00308178 -0.04379553 -0.25242287 -0.02457997 -0.20915724]
  [FlaxMamba2] B (step) sample values: [ 0.6518072  -0.04724532 -0.19108897  0.14909391  0.15790743]
  [FlaxMamba2] C (step) sample values: [-0.27843046  0.03153018 -0.26836196 -0.12725908  0.14444928]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.98658675 -8.774721   -3.3045902  -2.9912853  -3.3435438 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1570071  0.17715587 0.07260836 0.06902676 0.16511625]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.85649985 0.21129641 0.7866744  0.81344354 0.57575476]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00308178 -0.04379553 -0.25242287 -0.02457997 -0.20915724]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.1538424e-04 -2.2860178e-05 -9.2460548e-05  7.2140763e-05
  7.6405282e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.1538424e-04 -2.2860178e-05 -9.2460548e-05  7.2140763e-05
  7.6405282e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01907646 -0.00055346 -0.01099105 -0.00123468  0.00413308]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.10065629 -0.14441586 -0.15653712  0.0021681  -0.19127703]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.10132366 -0.15389991 -0.2112     -0.00315477 -0.23657063]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.10132366 -0.15389991 -0.2112     -0.00315477 -0.23657063]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.09918738 -0.02253144  0.02574296  0.00049992  0.06587098]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.06425549 -0.00683807  0.00742698  0.00018753  0.01744214]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.06425549 -0.00683807  0.00742698  0.00018753  0.01744214]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.40886876  0.24505311 -0.01660553 -0.09757254  0.2693134 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.40886876  0.24505311 -0.01660553 -0.09757254  0.2693134 ]
  [Layer 6] Output shape after mixer: (1, 1, 2048)
  [Layer 6] Output sample values after mixer: [ 0.40886876  0.24505311 -0.01660553 -0.09757254  0.2693134 ]
  [Layer 6] Residual connection shape: (1, 1, 2048)
  [Layer 6] Residual connection sample values: [0.45179918 0.05509414 0.37946334 0.0718047  0.43289435]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.2420098  0.02451186 0.18843058 0.03521685 0.23261896]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.2420098  0.02451186 0.18843058 0.03521685 0.23261896]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.2420098  0.02451186 0.18843058 0.03521685 0.23261896]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.78486454 -0.39212894 -0.36463892 -0.55761254 -0.28847754]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.78486454 -0.39212894 -0.36463892 -0.55761254 -0.28847754]
  [FlaxMamba2] xBC (step) sample values: [-1.9761943   0.2975154  -0.49701044 -0.2489161   0.36676735]
  [FlaxMamba2] dt (step) sample values: [1.9124798 1.1361073 2.5378792 2.2193043 1.8857827]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.4927015  -1.8322127  -2.4475067  -1.9761943  -0.02863535]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03653872  0.4665979   0.41137505 -0.02076889 -0.39546478]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.10465395  0.4912256   0.41062498 -0.01434494 -0.39905822]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04959136  0.30475396  0.24688323 -0.00712103 -0.1602373 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04959136  0.30475396  0.24688323 -0.00712103 -0.1602373 ]
  [FlaxMamba2] B (step) sample values: [ 0.01176701 -0.05919779  0.14577474  0.07414388  0.05504772]
  [FlaxMamba2] C (step) sample values: [ 0.2593923   0.00209289  0.01384843  0.01332727 -0.01202816]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.29588825 -1.1836219  -0.3113019  -0.1314279  -1.5015444 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11265355 0.01856512 0.03148099 0.13029468 0.00705735]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.96721655 0.9782656  0.9902478  0.98302144 0.98945904]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04959136  0.30475396  0.24688323 -0.00712103 -0.1602373 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.5738066e-05  3.3071692e-04 -8.1439136e-04 -4.1421538e-04
 -3.0753194e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.5738066e-05  3.3071692e-04 -8.1439136e-04 -4.1421538e-04
 -3.0753194e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00057808  0.000736   -0.00125752  0.00031529 -0.00330033]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00114941  0.00277204  0.00380051 -0.00068601 -0.00167949]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00126288  0.00346933  0.00436539 -0.00070231 -0.00204612]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00126288  0.00346933  0.00436539 -0.00070231 -0.00204612]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00068068 -0.00054853 -0.00065238  0.00014259  0.00025285]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00418988 -0.00188053 -0.00527748  0.00081357  0.00196969]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00418988 -0.00188053 -0.00527748  0.00081357  0.00196969]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.1601763   0.16323821  0.01055795  0.1250659  -0.12377922]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.1601763   0.16323821  0.01055795  0.1250659  -0.12377922]
  [Layer 7] Output shape after mixer: (1, 1, 2048)
  [Layer 7] Output sample values after mixer: [-0.1601763   0.16323821  0.01055795  0.1250659  -0.12377922]
  [Layer 7] Residual connection shape: (1, 1, 2048)
  [Layer 7] Residual connection sample values: [0.29162288 0.21833235 0.3900213  0.1968706  0.3091151 ]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.18624522 0.10913413 0.23210423 0.11656366 0.19648191]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.18624522 0.10913413 0.23210423 0.11656366 0.19648191]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.18624522 0.10913413 0.23210423 0.11656366 0.19648191]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.1306615  -1.3056384  -0.4380895  -0.01147746 -1.052322  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.1306615  -1.3056384  -0.4380895  -0.01147746 -1.052322  ]
  [FlaxMamba2] xBC (step) sample values: [ 0.8000778  -0.83707124  0.5680914  -0.87939346  0.3427338 ]
  [FlaxMamba2] dt (step) sample values: [1.0905395 0.7624335 1.5158215 1.3793987 0.8828527]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.17718412 -0.3310088   0.33567595  0.8000778   0.04583632]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04994509  0.1616573  -0.07452959 -0.35733962  0.0971754 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.51283574  0.13063619 -0.38922685 -0.40891433  0.04105357]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.3207639   0.06957849 -0.15721005 -0.16322735  0.02094807]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.3207639   0.06957849 -0.15721005 -0.16322735  0.02094807]
  [FlaxMamba2] B (step) sample values: [ 0.12072473  0.26578203 -0.13781758 -0.23343502  0.0604436 ]
  [FlaxMamba2] C (step) sample values: [ 0.04073029 -0.06466289  0.15038894 -0.0398631  -0.17053838]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.6542776 -0.9827404 -0.5549556 -3.9396574 -1.8081155]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02965646 0.11289857 0.04972092 0.09236714 0.0231568 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8972929  0.89498353 0.9727843  0.69496423 0.95899427]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.3207639   0.06957849 -0.15721005 -0.16322735  0.02094807]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00114842  0.00252831 -0.00131102 -0.0022206   0.00057498]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00114842  0.00252831 -0.00131102 -0.0022206   0.00057498]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00081129  0.00255326 -0.00074121 -0.00271783  0.00022931]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.04020513 -0.02027044 -0.01915722 -0.01385791 -0.00578759]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.31022418  0.03830073 -0.15149665 -0.1512627   0.0118465 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.31022418  0.03830073 -0.15149665 -0.1512627   0.0118465 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.08559877 -0.01066235  0.02602971  0.00086307 -0.00322603]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.05018287 -0.00796371  0.01321565  0.00068658 -0.00306162]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.05018287 -0.00796371  0.01321565  0.00068658 -0.00306162]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.08939265  0.24034119 -0.09360602  0.08911845  0.10686497]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.08939265  0.24034119 -0.09360602  0.08911845  0.10686497]
  [Layer 8] Output shape after mixer: (1, 1, 2048)
  [Layer 8] Output sample values after mixer: [ 0.08939265  0.24034119 -0.09360602  0.08911845  0.10686497]
  [Layer 8] Residual connection shape: (1, 1, 2048)
  [Layer 8] Residual connection sample values: [0.38101554 0.45867354 0.29641527 0.28598905 0.4159801 ]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.19581614 0.1926033  0.14004701 0.12975842 0.21103907]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.19581614 0.1926033  0.14004701 0.12975842 0.21103907]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.19581614 0.1926033  0.14004701 0.12975842 0.21103907]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.4850812  -0.9329974   0.05334129 -1.1140862  -1.0579436 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.4850812  -0.9329974   0.05334129 -1.1140862  -1.0579436 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.32918003  0.4804765  -1.1206245  -0.27912846 -0.22481301]
  [FlaxMamba2] dt (step) sample values: [ 1.8172071   1.1561186   4.1764083  -0.10030267  1.2064921 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.58628625  0.01195776 -0.02064419  0.32918003 -0.22637303]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01634653  0.06632531 -0.00575998 -0.08933026 -0.20188473]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00899561  0.04098047 -0.09242991 -0.16324383 -0.17684506]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00447757  0.02091002 -0.04408066 -0.07497453 -0.0806243 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00447757  0.02091002 -0.04408066 -0.07497453 -0.0806243 ]
  [FlaxMamba2] B (step) sample values: [ 0.2356677  -0.14095852  0.27098387  0.32698342 -0.19441797]
  [FlaxMamba2] C (step) sample values: [-0.27846038 -0.22318804 -0.2556544   0.3444116   0.0373884 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-5.234511  -1.2161361 -1.4887683 -0.9523448 -3.9666808]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0606218  0.11448679 0.2727972  0.11591329 0.05161425]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.72809374 0.8700266  0.66622233 0.89548534 0.81486136]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00447757  0.02091002 -0.04408066 -0.07497453 -0.0806243 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.396931e-05  3.826158e-05 -7.355548e-05 -8.875592e-05  5.277254e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.396931e-05  3.826158e-05 -7.355548e-05 -8.875592e-05  5.277254e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00013754 -0.00312454  0.00492586  0.00545271 -0.00164514]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.02415866  0.00719797 -0.011971    0.02726059  0.04088834]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01808907  0.03554259 -0.07172462 -0.07437129 -0.0684021 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01808907  0.03554259 -0.07172462 -0.07437129 -0.0684021 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00496069 -0.00936195 -0.00196395  0.02047454  0.0186488 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00269645 -0.00758285 -0.0010635   0.00874287  0.01159855]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00269645 -0.00758285 -0.0010635   0.00874287  0.01159855]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.0563123  -0.07966089 -0.13498102  0.0838068   0.31787413]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.0563123  -0.07966089 -0.13498102  0.0838068   0.31787413]
  [Layer 9] Output shape after mixer: (1, 1, 2048)
  [Layer 9] Output sample values after mixer: [-0.0563123  -0.07966089 -0.13498102  0.0838068   0.31787413]
  [Layer 9] Residual connection shape: (1, 1, 2048)
  [Layer 9] Residual connection sample values: [0.32470325 0.37901264 0.16143425 0.36979586 0.73385423]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.11686653 0.11401722 0.05244888 0.11895223 0.2581352 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.11686653 0.11401722 0.05244888 0.11895223 0.2581352 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.11686653 0.11401722 0.05244888 0.11895223 0.2581352 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.3331299   0.7630004  -0.04787608 -0.96187353 -1.0331744 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.3331299   0.7630004  -0.04787608 -0.96187353 -1.0331744 ]
  [FlaxMamba2] xBC (step) sample values: [-0.5293305   1.1741984  -0.72867     0.16438013 -0.48874348]
  [FlaxMamba2] dt (step) sample values: [1.2597299  0.7833318  0.16539524 1.2764151  1.7874976 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.4215516   0.1810347   0.3956909  -0.5293305   0.95135295]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.09163684 -0.41143575  0.01249564 -0.04945458 -0.02055189]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.12999743 -0.49853292 -0.09132516 -0.13527001 -0.0801222 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06077982 -0.18838838 -0.04357896 -0.06306747 -0.03845707]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06077982 -0.18838838 -0.04357896 -0.06306747 -0.03845707]
  [FlaxMamba2] B (step) sample values: [-0.05896532  0.48335826  0.13064207 -0.06062826 -0.13318132]
  [FlaxMamba2] C (step) sample values: [-0.27141613 -0.04192948 -0.15707946  0.01038256 -0.12526569]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.7154508  -1.4067873  -0.35344088 -2.010216   -0.4652703 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00154688 0.00777163 0.11069154 0.00652876 0.04443584]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99426913 0.9891265  0.9616325  0.98696154 0.9795376 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06077982 -0.18838838 -0.04357896 -0.06306747 -0.03845707]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.5438813e-06 -4.5445035e-05 -1.2282883e-05  5.7002303e-06
  1.2521622e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.5438813e-06 -4.5445035e-05 -1.2282883e-05  5.7002303e-06
  1.2521622e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [4.4392109e-06 6.2792409e-05 2.9498155e-05 1.8110171e-05 2.5733892e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 3.4395594e-05 -2.1304199e-03  3.7491959e-04 -4.4506852e-04
  1.8864560e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01332019 -0.04352323 -0.00920028 -0.01430229 -0.00656336]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01332019 -0.04352323 -0.00920028 -0.01430229 -0.00656336]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0018525  -0.02264818  0.00021497  0.00380385  0.00177983]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01946864 -0.11598542  0.00176906  0.03562693  0.01542695]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01946864 -0.11598542  0.00176906  0.03562693  0.01542695]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.093997   -0.476969    0.04390757 -0.08193307  0.22263998]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.093997   -0.476969    0.04390757 -0.08193307  0.22263998]
  [Layer 10] Output shape after mixer: (1, 1, 2048)
  [Layer 10] Output sample values after mixer: [-0.093997   -0.476969    0.04390757 -0.08193307  0.22263998]
  [Layer 10] Residual connection shape: (1, 1, 2048)
  [Layer 10] Residual connection sample values: [ 0.23070624 -0.09795636  0.20534182  0.28786278  0.9564942 ]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.09783036 -0.03379523  0.0777799   0.10637953  0.38772056]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09783036 -0.03379523  0.0777799   0.10637953  0.38772056]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09783036 -0.03379523  0.0777799   0.10637953  0.38772056]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.5416044  -2.8419724  -0.86732703 -0.46735147  0.41478643]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.5416044  -2.8419724  -0.86732703 -0.46735147  0.41478643]
  [FlaxMamba2] xBC (step) sample values: [-0.08247908  0.01610305 -0.7532327   3.1093123   0.6351623 ]
  [FlaxMamba2] dt (step) sample values: [2.8052855 3.4462583 2.3666937 2.0586686 2.8336687]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5201296  -0.33429423  1.5171268  -0.08247908  1.2709973 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.07845148  0.00687629  0.18033652 -0.33274403  0.14469737]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.09265742 -0.35078973  0.27689415 -0.32059804  0.16786021]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04418389 -0.14494313  0.15749314 -0.13482109  0.09095787]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04418389 -0.14494313  0.15749314 -0.13482109  0.09095787]
  [FlaxMamba2] B (step) sample values: [-0.27038148  0.0915576  -0.26860708 -0.08157466  0.13190189]
  [FlaxMamba2] C (step) sample values: [-0.06229625 -0.1819143  -0.2777809  -0.04416724 -0.0330806 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.31160602 -0.09015273 -1.5786072  -0.20961139 -0.6694042 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.257332   0.69459766 0.8578909  0.2943532  0.1198645 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9229445  0.9393005  0.25813496 0.9401651  0.92289686]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04418389 -0.14494313  0.15749314 -0.13482109  0.09095787]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00307422 -0.001041    0.00305404  0.0009275  -0.00149972]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00307422 -0.001041    0.00305404  0.0009275  -0.00149972]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.04485707 -0.05939715  0.05214401  0.0138821  -0.05372474]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.14939429 -0.2680266   0.2903163  -0.07405595  0.01003534]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.16560437 -0.32120296  0.34809703 -0.12351879  0.04340574]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.16560437 -0.32120296  0.34809703 -0.12351879  0.04340574]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.05670203  0.05029599 -0.08930941  0.02223882  0.01084271]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.03504094  0.03046443 -0.03836663  0.03113531  0.00498552]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03504094  0.03046443 -0.03836663  0.03113531  0.00498552]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.01040848 -0.0104712  -0.29741836 -0.4903548   0.02732765]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.01040848 -0.0104712  -0.29741836 -0.4903548   0.02732765]
  [Layer 11] Output shape after mixer: (1, 1, 2048)
  [Layer 11] Output sample values after mixer: [-0.01040848 -0.0104712  -0.29741836 -0.4903548   0.02732765]
  [Layer 11] Residual connection shape: (1, 1, 2048)
  [Layer 11] Residual connection sample values: [ 0.22029775 -0.10842756 -0.09207654 -0.20249203  0.98382187]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.06815442 -0.02783495 -0.02488325 -0.05435225  0.291597  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.06815442 -0.02783495 -0.02488325 -0.05435225  0.291597  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.06815442 -0.02783495 -0.02488325 -0.05435225  0.291597  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.31371945 -0.09365647 -2.0351923   0.658409   -1.2825977 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.31371945 -0.09365647 -2.0351923   0.658409   -1.2825977 ]
  [FlaxMamba2] xBC (step) sample values: [-0.36496753  0.5146205  -2.2578878   0.03987633  1.090893  ]
  [FlaxMamba2] dt (step) sample values: [1.3870487 1.1415645 1.6603091 0.9571502 1.5183678]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.6992308   0.20059147 -0.16735914 -0.36496753  0.16052778]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.0564005  -0.15855895  0.38480812  0.12060993  0.20447394]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.09939978 -0.14566527  0.34992653  0.09090107  0.21709296]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04723184 -0.0675374   0.20526682  0.04751486  0.12028277]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04723184 -0.0675374   0.20526682  0.04751486  0.12028277]
  [FlaxMamba2] B (step) sample values: [ 0.00351699 -0.19711447  0.64960897 -0.01348449  0.1557237 ]
  [FlaxMamba2] C (step) sample values: [-0.26695204 -0.05785825  0.01187254 -0.12785916 -0.15050802]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2411823 -0.7693517 -1.9974962 -1.2367963 -1.0181218]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1596955  0.19769672 0.13436002 0.22583118 0.31400007]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.82019657 0.8589038  0.7646144  0.75630754 0.7263739 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04723184 -0.0675374   0.20526682  0.04751486  0.12028277]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.6527649e-05  1.4867777e-03 -4.8998133e-03  1.0170966e-04
 -1.1745791e-03]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.6527649e-05  1.4867777e-03 -4.8998133e-03  1.0170966e-04
 -1.1745791e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00527242  0.00568985 -0.0198806   0.00238417 -0.00128878]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01507276 -0.05243774  0.07638727 -0.03915995 -0.05322568]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04907091 -0.10105214  0.22414128 -0.00495806  0.03335559]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04907091 -0.10105214  0.22414128 -0.00495806  0.03335559]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00889483  0.00451066 -0.0527138  -0.00215094 -0.00928829]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.02125618  0.00710009 -0.06271138 -0.00292684 -0.0181728 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02125618  0.00710009 -0.06271138 -0.00292684 -0.0181728 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.00674531 -0.4922252  -0.10975321  0.75084925  0.28427136]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.00674531 -0.4922252  -0.10975321  0.75084925  0.28427136]
  [Layer 12] Output shape after mixer: (1, 1, 2048)
  [Layer 12] Output sample values after mixer: [ 0.00674531 -0.4922252  -0.10975321  0.75084925  0.28427136]
  [Layer 12] Residual connection shape: (1, 1, 2048)
  [Layer 12] Residual connection sample values: [ 0.22704306 -0.60065275 -0.20182975  0.54835725  1.2680932 ]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05560515 -0.12730837 -0.04561178  0.11662958  0.31525466]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05560515 -0.12730837 -0.04561178  0.11662958  0.31525466]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05560515 -0.12730837 -0.04561178  0.11662958  0.31525466]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-2.9577775   0.6112351   1.0225811   1.9443543   0.14681846]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-2.9577775   0.6112351   1.0225811   1.9443543   0.14681846]
  [FlaxMamba2] xBC (step) sample values: [-0.29596958 -0.66589975 -0.91796136  0.76813734 -0.02922563]
  [FlaxMamba2] dt (step) sample values: [2.413738  1.9257176 0.9847899 0.5628352 2.5109007]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.3017192   0.5842428   0.80534804 -0.29596958 -1.4892592 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.14481378 -0.12598927  0.01710911 -0.09559568  0.04043658]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.11983466 -0.23591359 -0.00336818 -0.09640058  0.01648028]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.05633153 -0.10410716 -0.00168126 -0.04587882  0.00830804]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05633153 -0.10410716 -0.00168126 -0.04587882  0.00830804]
  [FlaxMamba2] B (step) sample values: [-0.0895231   0.04501717  0.24024777  0.5401088   0.0136147 ]
  [FlaxMamba2] C (step) sample values: [ 0.0159197   0.47402036 -0.09388921  0.45629284 -0.09174538]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3103099 -1.7870504 -0.8605819 -1.881061  -0.5251649]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10243355 0.06508876 0.09950355 0.08056172 0.19773181]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.87439793 0.8901931  0.9179329  0.8593822  0.9013679 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05633153 -0.10410716 -0.00168126 -0.04587882  0.00830804]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.165697e-04 -2.597598e-04 -1.386287e-03 -3.116557e-03 -7.856007e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.165697e-04 -2.597598e-04 -1.386287e-03 -3.116557e-03 -7.856007e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00235335 -0.00479034 -0.00255625 -0.03578971  0.00102239]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.10959683  0.09395191 -0.01951235 -0.01376643  0.07700086]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.11202192  0.08947006 -0.01958473 -0.01574153  0.07735853]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.11202192  0.08947006 -0.01958473 -0.01574153  0.07735853]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01635812  0.0354495  -0.01472934 -0.02677601  0.00609496]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.04654777  0.03327361 -0.05668808 -0.11730329  0.01018773]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04654777  0.03327361 -0.05668808 -0.11730329  0.01018773]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.34309947 -0.2591795   0.06521608  0.03380509 -0.31245935]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.34309947 -0.2591795   0.06521608  0.03380509 -0.31245935]
  [Layer 13] Output shape after mixer: (1, 1, 2048)
  [Layer 13] Output sample values after mixer: [ 0.34309947 -0.2591795   0.06521608  0.03380509 -0.31245935]
  [Layer 13] Residual connection shape: (1, 1, 2048)
  [Layer 13] Residual connection sample values: [ 0.5701425  -0.8598323  -0.13661367  0.5821623   0.9556339 ]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.10322452 -0.13673094 -0.02290053  0.09176495  0.16890417]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10322452 -0.13673094 -0.02290053  0.09176495  0.16890417]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10322452 -0.13673094 -0.02290053  0.09176495  0.16890417]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 2.1740103   0.0420499  -0.70934016 -0.13389736  0.40634963]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 2.1740103   0.0420499  -0.70934016 -0.13389736  0.40634963]
  [FlaxMamba2] xBC (step) sample values: [-0.787196  -0.5360401  1.0138935 -0.5387056  0.8048387]
  [FlaxMamba2] dt (step) sample values: [-0.13273007  1.344502    1.0031486   1.5864993   1.0119065 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.03884755 -0.5885432  -0.04662067 -0.787196    0.13899966]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.18428911 -0.0331123  -0.2307244  -0.13023612 -0.11815595]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.2238399  -0.07437207 -0.29157645 -0.1930413  -0.08159589]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.09944592 -0.03580387 -0.12468333 -0.08723324 -0.0391344 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09944592 -0.03580387 -0.12468333 -0.08723324 -0.0391344 ]
  [FlaxMamba2] B (step) sample values: [-0.07519978  0.00675862 -0.02537162 -0.07079314  0.02497326]
  [FlaxMamba2] C (step) sample values: [-0.10205614 -0.07652308 -0.18472768 -0.14487407 -0.15782228]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.318424  -0.7620611 -2.6670074 -5.1836414 -2.8487349]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03469822 0.04539542 0.20777734 0.07834154 0.03775781]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8608443  0.96599746 0.57456404 0.66624725 0.89802086]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09944592 -0.03580387 -0.12468333 -0.08723324 -0.0391344 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.5948408e-04 -2.3321278e-05  8.7547225e-05  2.4427858e-04
 -8.6172651e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.5948408e-04 -2.3321278e-05  8.7547225e-05  2.4427858e-04
 -8.6172651e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0006555  -0.00017728  0.00067599  0.00141012  0.00036485]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00790349  0.00444151 -0.01033403 -0.00380069 -0.00405254]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04810186 -0.01003125 -0.06073396 -0.03906242 -0.01987158]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04810186 -0.01003125 -0.06073396 -0.03906242 -0.01987158]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.09389603 -0.00021534  0.01420574  0.00244036 -0.0048466 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.63531256 -0.00084797  0.08117481  0.01960402 -0.04513406]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.63531256 -0.00084797  0.08117481  0.01960402 -0.04513406]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.15766327  0.1259346   0.790387    0.31132576 -0.0821504 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.15766327  0.1259346   0.790387    0.31132576 -0.0821504 ]
  [Layer 14] Output shape after mixer: (1, 1, 2048)
  [Layer 14] Output sample values after mixer: [ 0.15766327  0.1259346   0.790387    0.31132576 -0.0821504 ]
  [Layer 14] Residual connection shape: (1, 1, 2048)
  [Layer 14] Residual connection sample values: [ 0.7278058  -0.7338977   0.6537733   0.89348805  0.8734835 ]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.11470185 -0.09833279  0.09470546  0.12118775  0.13190474]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11470185 -0.09833279  0.09470546  0.12118775  0.13190474]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11470185 -0.09833279  0.09470546  0.12118775  0.13190474]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.45338017  1.0346805  -0.3702633  -0.9944381  -0.44468915]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.45338017  1.0346805  -0.3702633  -0.9944381  -0.44468915]
  [FlaxMamba2] xBC (step) sample values: [0.19674203 0.9232607  0.38997537 0.8499122  0.1674825 ]
  [FlaxMamba2] dt (step) sample values: [ 0.09059855  0.47089595  0.38994646  3.2252748  -0.13439284]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.51498413 -0.6377079  -0.47172862  0.19674203 -0.05656574]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.1064484  -0.20197351 -0.01338803 -0.2570092  -0.01481306]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.14389348 -0.20882852 -0.0381683  -0.27475518 -0.04015791]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06677932 -0.09355138 -0.01871999 -0.11862282 -0.01967584]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06677932 -0.09355138 -0.01871999 -0.11862282 -0.01967584]
  [FlaxMamba2] B (step) sample values: [ 0.06691208 -0.0245161   0.02512187  0.04652145  0.04957717]
  [FlaxMamba2] C (step) sample values: [ 0.02978117 -0.02101126  0.02144243  0.0519933   0.04623541]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.27823287 -0.68077636 -2.7209377  -0.11263601 -3.8483953 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00211954 0.02526134 0.02226366 0.13491665 0.02027326]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99941045 0.98294973 0.94122034 0.9849184  0.92494637]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06677932 -0.09355138 -0.01871999 -0.11862282 -0.01967584]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.4708430e-06  3.4700481e-06 -3.5557903e-06 -6.5847203e-06
 -7.0172323e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.4708430e-06  3.4700481e-06 -3.5557903e-06 -6.5847203e-06
 -7.0172323e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-7.4663403e-05 -9.3753260e-06 -2.3469258e-05 -9.3374138e-06
  1.8921005e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-3.1754913e-05 -6.3178750e-06 -4.4493354e-06 -3.4796030e-05
 -6.6084217e-06]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01141294 -0.01595026 -0.00319489 -0.02025166 -0.00335996]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01141294 -0.01595026 -0.00319489 -0.02025166 -0.00335996]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00201055 -0.01217659  0.00048321  0.00543827  0.00058365]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.04123912 -0.3263351   0.00998607  0.13069843  0.01029424]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04123912 -0.3263351   0.00998607  0.13069843  0.01029424]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.04051431 -0.05941254  0.19416831  0.05919934  0.7606128 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.04051431 -0.05941254  0.19416831  0.05919934  0.7606128 ]
  [Layer 15] Output shape after mixer: (1, 1, 2048)
  [Layer 15] Output sample values after mixer: [-0.04051431 -0.05941254  0.19416831  0.05919934  0.7606128 ]
  [Layer 15] Residual connection shape: (1, 1, 2048)
  [Layer 15] Residual connection sample values: [ 0.6872915  -0.7933102   0.84794164  0.9526874   1.6340963 ]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.10670003 -0.10296658  0.12060182  0.12411549  0.24368726]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10670003 -0.10296658  0.12060182  0.12411549  0.24368726]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10670003 -0.10296658  0.12060182  0.12411549  0.24368726]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-2.065139   -0.8372828  -0.27023205  0.0617102  -0.3969287 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-2.065139   -0.8372828  -0.27023205  0.0617102  -0.3969287 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.8945974   0.5627588   0.44769323  0.9104053  -0.83522   ]
  [FlaxMamba2] dt (step) sample values: [0.9793424 2.2036743 0.8547735 1.1547506 1.0028814]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.28637996  0.00926928  0.9898985   0.8945974  -0.577416  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.27483684 -0.02751276  0.09546809  0.07990421 -0.2589111 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.23870403 -0.06865045  0.0823379  -0.01250301 -0.30099484]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.13352966 -0.03314747  0.04286287 -0.00621243 -0.12801741]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.13352966 -0.03314747  0.04286287 -0.00621243 -0.12801741]
  [FlaxMamba2] B (step) sample values: [-0.0029968  -0.06364615 -0.02184777 -0.1095326   0.23265815]
  [FlaxMamba2] C (step) sample values: [-0.27801558  0.21200192 -0.05242721  0.9371344  -0.12660444]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6905513  -0.13480766 -1.3128716  -3.7739606  -1.2635014 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.14540596 0.49224693 0.1110937  0.21659625 0.06237675]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6762299  0.9357952  0.8642858  0.44156694 0.92421263]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.13352966 -0.03314747  0.04286287 -0.00621243 -0.12801741]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.8185855e-05 -1.2357543e-03 -4.2419651e-04 -2.1266860e-03
  4.5172931e-03]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.8185855e-05 -1.2357543e-03 -4.2419651e-04 -2.1266860e-03
  4.5172931e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00084852  0.00166189  0.0009228  -0.00148508  0.0096224 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.03175033 -0.06740056 -0.00098946 -0.0472806  -0.04499203]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.11768723 -0.08873358  0.02659619 -0.05127879 -0.12738137]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.11768723 -0.08873358  0.02659619 -0.05127879 -0.12738137]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02734973  0.0224451  -0.00311096 -0.00163102  0.02032821]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.09576455  0.0616904  -0.01024732 -0.00478663  0.06128085]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.09576455  0.0616904  -0.01024732 -0.00478663  0.06128085]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.0268866  -0.10547915  1.4017808  -0.18874684  0.04048833]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.0268866  -0.10547915  1.4017808  -0.18874684  0.04048833]
  [Layer 16] Output shape after mixer: (1, 1, 2048)
  [Layer 16] Output sample values after mixer: [ 1.0268866  -0.10547915  1.4017808  -0.18874684  0.04048833]
  [Layer 16] Residual connection shape: (1, 1, 2048)
  [Layer 16] Residual connection sample values: [ 1.7141781 -0.8987894  2.2497225  0.7639406  1.6745846]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.22851919 -0.100681    0.26715758  0.0839038   0.21478482]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.22851919 -0.100681    0.26715758  0.0839038   0.21478482]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.22851919 -0.100681    0.26715758  0.0839038   0.21478482]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.12479355 -0.79262763 -0.42255393  0.10118224 -0.7368084 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.12479355 -0.79262763 -0.42255393  0.10118224 -0.7368084 ]
  [FlaxMamba2] xBC (step) sample values: [-1.2048231  -0.39280137  0.6957623   0.47994056 -0.49157548]
  [FlaxMamba2] dt (step) sample values: [ 0.5075037  -0.47360495  0.48224446  2.1009629   1.119815  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.16870886 -0.6556686  -0.9301225  -1.2048231  -0.37608033]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.23998189  0.06766166 -0.18232304 -0.02790659  0.0836641 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.2717812   0.04146232 -0.19668156 -0.0333082   0.09629838]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.11753719  0.02116088 -0.08870093 -0.01637677  0.05046575]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.11753719  0.02116088 -0.08870093 -0.01637677  0.05046575]
  [FlaxMamba2] B (step) sample values: [-0.01336429 -0.09948451 -0.04532645  0.05369904 -0.01450377]
  [FlaxMamba2] C (step) sample values: [-0.19939269 -0.0460684  -0.12891139  0.13204089 -0.20912284]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.1570504  -11.466768   -14.214988    -0.12863436 -14.242779  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00085267 0.00640275 0.03475602 0.16631162 0.02148999]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9990139 0.9292115 0.6101464 0.9788338 0.7363298]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.11753719  0.02116088 -0.08870093 -0.01637677  0.05046575]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.3393701e-06  9.9703439e-06  4.5426200e-06 -5.3817207e-06
  1.4535692e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.3393701e-06  9.9703439e-06  4.5426200e-06 -5.3817207e-06
  1.4535692e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-8.0273581e-05  8.9942492e-05  1.0895260e-04 -2.5217142e-04
  1.9265922e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-4.0909788e-04 -1.4297892e-05 -4.6122106e-04  7.7335841e-05
  1.5443428e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0762153   0.01363352 -0.05766934 -0.01048494  0.03270258]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0762153   0.01363352 -0.05766934 -0.01048494  0.03270258]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00445924 -0.0033673   0.00964759 -0.00055726 -0.00779978]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.03888229 -0.03586115  0.07798484 -0.00548548 -0.07707812]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03888229 -0.03586115  0.07798484 -0.00548548 -0.07707812]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.23346882 -0.21297309 -1.587926    1.651747   -0.317622  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.23346882 -0.21297309 -1.587926    1.651747   -0.317622  ]
  [Layer 17] Output shape after mixer: (1, 1, 2048)
  [Layer 17] Output sample values after mixer: [-0.23346882 -0.21297309 -1.587926    1.651747   -0.317622  ]
  [Layer 17] Residual connection shape: (1, 1, 2048)
  [Layer 17] Residual connection sample values: [ 1.4807093  -1.1117625   0.66179645  2.4156876   1.3569627 ]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15846244 -0.10060313  0.06333211  0.21695417  0.13958669]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15846244 -0.10060313  0.06333211  0.21695417  0.13958669]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15846244 -0.10060313  0.06333211  0.21695417  0.13958669]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.51551026 -1.5201098  -0.20603617 -0.43145055  0.13411696]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.51551026 -1.5201098  -0.20603617 -0.43145055  0.13411696]
  [FlaxMamba2] xBC (step) sample values: [ 0.08378849 -0.11642445  0.07093048 -0.670264   -0.87059814]
  [FlaxMamba2] dt (step) sample values: [0.661121   0.51922715 1.0993181  0.6866863  1.0504973 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.58373916 -0.37656048 -0.5444347   0.08378849  0.01675333]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03507958  0.34759304  0.03785506 -0.18319207 -0.20809199]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04508934  0.08221218  0.31764022 -0.19702417 -0.2501757 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02203649  0.04279485  0.18383397 -0.08883873 -0.10952199]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02203649  0.04279485  0.18383397 -0.08883873 -0.10952199]
  [FlaxMamba2] B (step) sample values: [ 0.09461707  0.08209211 -0.04385684  0.2478161   0.3129921 ]
  [FlaxMamba2] C (step) sample values: [-0.22218256  0.02520194 -0.06260383  0.09257417 -0.02120857]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3010656 -1.4685526 -1.2082934 -1.2128745 -2.5874777]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.17766517 0.09008402 0.20603926 0.14230761 0.11789782]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7936172  0.87608415 0.7796143  0.8414731  0.73708063]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02203649  0.04279485  0.18383397 -0.08883873 -0.10952199]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00037044 -0.0003214   0.0001717  -0.00097023 -0.0012254 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00037044 -0.0003214   0.0001717  -0.00097023 -0.0012254 ]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00183401  0.00308777  0.00510561 -0.00407209 -0.00570201]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.05467205 -0.09698552  0.17080638 -0.07011142 -0.03717208]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05893035 -0.08871591  0.20633015 -0.08727847 -0.05833592]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05893035 -0.08871591  0.20633015 -0.08727847 -0.05833592]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01902034  0.02419963 -0.01907372  0.01482831 -0.00417385]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.14333275  0.07489408 -0.10737161  0.1073999  -0.04757939]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.14333275  0.07489408 -0.10737161  0.1073999  -0.04757939]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.3809036   0.0726364  -0.10760886 -0.67757183  1.1053935 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.3809036   0.0726364  -0.10760886 -0.67757183  1.1053935 ]
  [Layer 18] Output shape after mixer: (1, 1, 2048)
  [Layer 18] Output sample values after mixer: [ 0.3809036   0.0726364  -0.10760886 -0.67757183  1.1053935 ]
  [Layer 18] Residual connection shape: (1, 1, 2048)
  [Layer 18] Residual connection sample values: [ 1.8616129 -1.0391262  0.5541876  1.7381158  2.462356 ]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.16311234 -0.07859892  0.04532475  0.13092503  0.21528542]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.16311234 -0.07859892  0.04532475  0.13092503  0.21528542]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.16311234 -0.07859892  0.04532475  0.13092503  0.21528542]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.5814971  -0.69315773 -0.17115873 -0.7718045  -0.88256836]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.5814971  -0.69315773 -0.17115873 -0.7718045  -0.88256836]
  [FlaxMamba2] xBC (step) sample values: [-1.0870969  -0.65387625  0.2288989   0.23409799 -0.9000495 ]
  [FlaxMamba2] dt (step) sample values: [0.05803364 0.5927052  0.685737   1.2633377  0.32065505]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.13948123  0.76022786 -1.4179927  -1.0870969  -0.20575929]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.37611353 -0.14304565  0.06760929  0.12093513  0.20305738]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.41175807 -0.16738342  0.06260822  0.07833259  0.1700984 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.16408175 -0.0767037   0.03228374  0.04069951  0.09226517]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.16408175 -0.0767037   0.03228374  0.04069951  0.09226517]
  [FlaxMamba2] B (step) sample values: [ 0.11930744  1.7148471  -0.12496888 -0.08487685  0.03817009]
  [FlaxMamba2] C (step) sample values: [-0.17741117 -0.02873579  0.10128494 -0.12088354 -0.04437068]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9436172 -1.8178532 -2.0862153 -1.0006425 -0.9649832]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05762887 0.05149072 0.04537049 0.17059161 0.09802733]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8940367 0.9106446 0.9096889 0.8430734 0.9097415]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.16408175 -0.0767037   0.03228374  0.04069951  0.09226517]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00112815 -0.01621533  0.00118169  0.00080258 -0.00036093]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00112815 -0.01621533  0.00118169  0.00080258 -0.00036093]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.2896321e-03 -1.1477679e-02 -2.6064098e-04 -7.5747684e-04
  8.2340703e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0095644  -0.01233645 -0.00430347  0.00561763  0.00957593]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02802123 -0.02096451 -0.00067201  0.01019573  0.01995443]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02802123 -0.02096451 -0.00067201  0.01019573  0.01995443]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 5.8429302e-03  4.8438711e-03  5.2600521e-05 -2.4873393e-03
 -5.1538297e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.15630098  0.13616961  0.00189695 -0.06562375 -0.19343731]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.15630098  0.13616961  0.00189695 -0.06562375 -0.19343731]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.40702015  0.3897559  -2.7553885  -0.785848   -1.1183958 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.40702015  0.3897559  -2.7553885  -0.785848   -1.1183958 ]
  [Layer 19] Output shape after mixer: (1, 1, 2048)
  [Layer 19] Output sample values after mixer: [ 0.40702015  0.3897559  -2.7553885  -0.785848   -1.1183958 ]
  [Layer 19] Residual connection shape: (1, 1, 2048)
  [Layer 19] Residual connection sample values: [ 2.2686331  -0.64937025 -2.201201    0.95226777  1.3439603 ]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.20615776 -0.05058558 -0.18360302  0.07347047  0.11842662]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.20615776 -0.05058558 -0.18360302  0.07347047  0.11842662]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.20615776 -0.05058558 -0.18360302  0.07347047  0.11842662]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.07895806 -1.2033354  -0.744833   -0.03042605  1.4469934 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.07895806 -1.2033354  -0.744833   -0.03042605  1.4469934 ]
  [FlaxMamba2] xBC (step) sample values: [-0.9065046   0.89717627 -0.24582675  0.7132099   1.9452676 ]
  [FlaxMamba2] dt (step) sample values: [0.84635425 1.4423696  2.155366   0.38881454 0.5879111 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.2217442  -0.17979228 -0.41172123 -0.9065046   0.2839764 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.09543982  0.08667347 -0.2775487  -0.14461964  0.41241518]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.05695716  0.09520313 -0.21102038 -0.16341847  0.38496462]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02928939  0.04986576 -0.09441891 -0.07504766  0.22908087]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02928939  0.04986576 -0.09441891 -0.07504766  0.22908087]
  [FlaxMamba2] B (step) sample values: [-0.15403621  0.02692835  0.00462125 -0.14487885  0.21605544]
  [FlaxMamba2] C (step) sample values: [-0.02771552 -0.15453507 -0.164829    0.15363494  0.65531886]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.6215758 -5.0388985 -1.2056414 -1.6434968 -1.3345234]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06688033 0.04717151 0.07311024 0.06722736 0.05374751]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8972224 0.7884452 0.9156284 0.8953971 0.9307847]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02928939  0.04986576 -0.09441891 -0.07504766  0.22908087]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.0173903e-04  5.2749507e-05  9.0524836e-06 -2.8380082e-04
  4.2322750e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.0173903e-04  5.2749507e-05  9.0524836e-06 -2.8380082e-04
  4.2322750e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0037434  -0.00197603  0.0036328   0.00338404  0.0024237 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0217328   0.02462824  0.00103792 -0.00087794  0.0239397 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02196615  0.02502552  0.00028569 -0.00147584  0.02576477]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02196615  0.02502552  0.00028569 -0.00147584  0.02576477]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-8.3298358e-04 -6.9528134e-03 -6.8508431e-05  2.2110500e-05
  3.0180654e-02]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-1.3398931e-02 -1.1979847e-01 -1.5846668e-03  3.8697026e-04
  4.7193521e-01]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-1.3398931e-02 -1.1979847e-01 -1.5846668e-03  3.8697026e-04
  4.7193521e-01]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.29039192 -2.0550554  -0.4903512  -1.2251226   2.0094204 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.29039192 -2.0550554  -0.4903512  -1.2251226   2.0094204 ]
  [Layer 20] Output shape after mixer: (1, 1, 2048)
  [Layer 20] Output sample values after mixer: [ 0.29039192 -2.0550554  -0.4903512  -1.2251226   2.0094204 ]
  [Layer 20] Residual connection shape: (1, 1, 2048)
  [Layer 20] Residual connection sample values: [ 2.559025  -2.7044256 -2.6915522 -0.2728548  3.3533807]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15331464 -0.14705087 -0.13883194 -0.01357041  0.18785757]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15331464 -0.14705087 -0.13883194 -0.01357041  0.18785757]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15331464 -0.14705087 -0.13883194 -0.01357041  0.18785757]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.6943596  -0.8687386  -0.40913087 -0.466925    0.06524809]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.6943596  -0.8687386  -0.40913087 -0.466925    0.06524809]
  [FlaxMamba2] xBC (step) sample values: [ 0.65818185 -0.2593016  -0.1442388  -0.4623923   0.32433376]
  [FlaxMamba2] dt (step) sample values: [0.1233221  1.4621593  0.5886948  0.8258488  0.26723036]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.43140212 -0.54034585  0.1051529   0.65818185  0.13110547]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.10379197 -0.04723474  0.026484    0.11401181 -0.04544731]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.13507248 -0.07732508  0.04133843  0.10893063 -0.01755425]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06298202 -0.03716849  0.02109637  0.05742886 -0.00870009]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06298202 -0.03716849  0.02109637  0.05742886 -0.00870009]
  [FlaxMamba2] B (step) sample values: [ 0.09924575 -0.04807041 -0.03623194  0.05149671  0.11922479]
  [FlaxMamba2] C (step) sample values: [ 0.03406501 -0.0512828  -0.02397138  0.02494998  0.02605558]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.2091806  -0.04342505 -3.8147197  -6.662431   -0.02279418]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06572853 0.01817191 0.05358435 0.05434597 0.01023806]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8098269  0.9992112  0.8151287  0.6962293  0.99976665]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06298202 -0.03716849  0.02109637  0.05742886 -0.00870009]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00041085  0.000199    0.00014999 -0.00021318 -0.00049356]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00041085  0.000199    0.00014999 -0.00021318 -0.00049356]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-4.3551292e-04 -4.6401401e-06  3.0409158e-04 -2.8197322e-04
 -4.1767332e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00080979 -0.00030162  0.00112663  0.00197002  0.00023598]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01186513 -0.00682588  0.00482971  0.01205061 -0.00129116]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01186513 -0.00682588  0.00482971  0.01205061 -0.00129116]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 2.7440034e-03  1.7523856e-03 -7.8865560e-04 -2.1682279e-03
 -4.3496537e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.25994554  0.1524401  -0.09118556 -0.21141897 -0.00381236]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.25994554  0.1524401  -0.09118556 -0.21141897 -0.00381236]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.0380644   0.46470279  0.75314873  0.23868336  1.4501084 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.0380644   0.46470279  0.75314873  0.23868336  1.4501084 ]
  [Layer 21] Output shape after mixer: (1, 1, 2048)
  [Layer 21] Output sample values after mixer: [-1.0380644   0.46470279  0.75314873  0.23868336  1.4501084 ]
  [Layer 21] Residual connection shape: (1, 1, 2048)
  [Layer 21] Residual connection sample values: [ 1.5209607  -2.2397227  -1.9384034  -0.03417145  4.803489  ]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.12779316 -0.15849738 -0.14536484 -0.00236196  0.37838423]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12779316 -0.15849738 -0.14536484 -0.00236196  0.37838423]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12779316 -0.15849738 -0.14536484 -0.00236196  0.37838423]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.207878   -0.29396313  0.00806311 -0.48525143 -0.9932977 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.207878   -0.29396313  0.00806311 -0.48525143 -0.9932977 ]
  [FlaxMamba2] xBC (step) sample values: [-0.62286955 -0.21440516  0.11285061 -0.56474507 -0.0942729 ]
  [FlaxMamba2] dt (step) sample values: [1.4963799 2.019691  1.3193738 0.510778  2.488122 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.03855772 -0.7527055  -0.02076029 -0.62286955  0.9738134 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.02729285 -0.02171103  0.02407326  0.13829063 -0.11631452]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02037561 -0.10044638  0.3434092   0.09730552 -0.18198834]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01008402 -0.04770294  0.20090073  0.05101798 -0.08273701]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01008402 -0.04770294  0.20090073  0.05101798 -0.08273701]
  [FlaxMamba2] B (step) sample values: [ 0.02191501  0.08206429 -0.06116939 -0.23239772  0.05027359]
  [FlaxMamba2] C (step) sample values: [-0.08514784  0.07645936 -0.0853283  -0.00539227  0.06642871]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.1489344 -3.5005836 -2.8320918 -5.5395546 -1.7185895]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0059303  0.27129033 0.21556656 0.07548345 0.03389985]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9756958  0.38686693 0.54307693 0.658267   0.9434047 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01008402 -0.04770294  0.20090073  0.05101798 -0.08273701]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.3105449e-06 -4.9075470e-06  3.6580059e-06  1.3897673e-05
 -3.0064230e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.3105449e-06 -4.9075470e-06  3.6580059e-06  1.3897673e-05
 -3.0064230e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 7.7174685e-05 -4.7783928e-06 -2.3188588e-05 -1.4256818e-04
  7.3123803e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00189714  0.00096801  0.00242421  0.00064602 -0.00077407]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00433946 -0.0105855   0.05108178  0.01300243 -0.02081273]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00433946 -0.0105855   0.05108178  0.01300243 -0.02081273]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00049775  0.00132882  0.00020677 -0.00240398  0.00558718]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.0039514   0.02969762  0.00263544 -0.07538453  0.11504663]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0039514   0.02969762  0.00263544 -0.07538453  0.11504663]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.19395125 -1.0199803  -0.96033883  1.2445366   0.79801136]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.19395125 -1.0199803  -0.96033883  1.2445366   0.79801136]
  [Layer 22] Output shape after mixer: (1, 1, 2048)
  [Layer 22] Output sample values after mixer: [ 0.19395125 -1.0199803  -0.96033883  1.2445366   0.79801136]
  [Layer 22] Residual connection shape: (1, 1, 2048)
  [Layer 22] Residual connection sample values: [ 1.7149119 -3.2597032 -2.8987422  1.2103652  5.6015005]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.08801283 -0.14393657 -0.13619423  0.05372659  0.27858496]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.08801283 -0.14393657 -0.13619423  0.05372659  0.27858496]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.08801283 -0.14393657 -0.13619423  0.05372659  0.27858496]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.02969936 -0.5098622  -0.71412617  0.17753819 -0.22167116]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.02969936 -0.5098622  -0.71412617  0.17753819 -0.22167116]
  [FlaxMamba2] xBC (step) sample values: [-0.7503175   0.2686147   0.69915015 -0.6352984  -0.18704341]
  [FlaxMamba2] dt (step) sample values: [1.8290824 0.2588832 0.9524578 1.730561  1.1404209]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.2821976  -0.30462316 -1.1896893  -0.7503175   0.23103666]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.232939   -0.29388976  0.2674377  -0.11329518  0.05739266]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.2553084  -0.32700133  0.25608516 -0.1154562   0.00801522]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.11144654 -0.13700388  0.14434847 -0.05439926  0.00402367]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.11144654 -0.13700388  0.14434847 -0.05439926  0.00402367]
  [FlaxMamba2] B (step) sample values: [ 0.00040014 -0.01394501  0.15637958  0.01810524 -0.04326024]
  [FlaxMamba2] C (step) sample values: [-0.03881923 -0.03851322  0.15230843 -0.06726385 -0.01106809]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.08112868 -3.7998476  -0.08256738 -0.48783726 -1.4532163 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.07160287 0.05546385 0.0266913  0.00819045 0.00323964]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9942078  0.8099731  0.9977986  0.9960124  0.99530315]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.11144654 -0.13700388  0.14434847 -0.05439926  0.00402367]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.1931133e-06  1.1127968e-04 -1.2478924e-03 -1.4447788e-04
  3.4521209e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.1931133e-06  1.1127968e-04 -1.2478924e-03 -1.4447788e-04
  3.4521209e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 3.5861781e-04  5.9771963e-04 -2.1760222e-03 -2.1630869e-05
  6.1925565e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00512156 -0.00453947  0.00428314 -0.00189585 -0.00017013]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00274405 -0.00161674  0.00120373 -0.00073535 -0.00025596]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00274405 -0.00161674  0.00120373 -0.00073535 -0.00025596]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 4.0143233e-05  3.0930454e-04 -2.8254534e-04 -7.1055299e-05
  2.5238291e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00998909  0.00976424 -0.015665   -0.00632023  0.00657768]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00998909  0.00976424 -0.015665   -0.00632023  0.00657768]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.0216994  1.4581174 -1.5123448  0.4470121 -0.7040983]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.0216994  1.4581174 -1.5123448  0.4470121 -0.7040983]
  [Layer 23] Output shape after mixer: (1, 1, 2048)
  [Layer 23] Output sample values after mixer: [ 1.0216994  1.4581174 -1.5123448  0.4470121 -0.7040983]
  [Layer 23] Residual connection shape: (1, 1, 2048)
  [Layer 23] Residual connection sample values: [ 2.7366114 -1.8015858 -4.411087   1.6573772  4.8974023]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.10106999 -0.06348497 -0.15020844  0.05444423  0.1753975 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10106999 -0.06348497 -0.15020844  0.05444423  0.1753975 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10106999 -0.06348497 -0.15020844  0.05444423  0.1753975 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.513804   -1.1628569   0.8319397  -0.11393509 -0.21800748]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.513804   -1.1628569   0.8319397  -0.11393509 -0.21800748]
  [FlaxMamba2] xBC (step) sample values: [-0.5737442  -0.17116855 -0.1470916   0.05783331  0.68818426]
  [FlaxMamba2] dt (step) sample values: [-0.00243836  0.3666376   0.18549104  1.6527475   1.1393889 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.12937313 -0.7060827   0.00151273 -0.5737442   0.24059033]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.10382485 -0.01978439 -0.03158578  0.00916123  0.32604206]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.10047936 -0.01979351 -0.03554544  0.0075438   0.32130802]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.05276158 -0.00979881 -0.01745688  0.00378613  0.18624395]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05276158 -0.00979881 -0.01745688  0.00378613  0.18624395]
  [FlaxMamba2] B (step) sample values: [-0.16760261  0.03197332 -0.08237099 -0.0144461  -0.02567891]
  [FlaxMamba2] C (step) sample values: [-0.08788282 -0.13380882 -0.2109746  -0.25440657  0.24436805]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.07415762 -3.4496791  -3.2884939  -0.16087165 -2.6944954 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00549232 0.04168089 0.054775   0.02370801 0.06600571]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9995928  0.86607337 0.83516395 0.9961933  0.83706623]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05276158 -0.00979881 -0.01745688  0.00378613  0.18624395]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.8568461e-05  9.2653390e-06 -2.3869748e-05 -4.1862399e-06
 -7.4413219e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.8568461e-05  9.2653390e-06 -2.3869748e-05 -4.1862399e-06
 -7.4413219e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [1.3281540e-04 5.5475044e-04 1.0393683e-04 3.3730641e-05 6.7790214e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00020014 -0.0009492  -0.00018272 -0.00024827 -0.00094454]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-8.0742815e-05 -8.9703797e-04 -8.9786787e-05 -2.6842256e-04
 -1.9360301e-03]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-8.0742815e-05 -8.9703797e-04 -8.9786787e-05 -2.6842256e-04
 -1.9360301e-03]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-2.5957686e-05  2.4841915e-04 -5.2046387e-05  1.4421204e-05
  1.8812164e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00240635  0.03262362 -0.00617241  0.00623926  0.04814965]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00240635  0.03262362 -0.00617241  0.00623926  0.04814965]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.99236137  0.07558914 -2.2740455   1.275243    2.5627377 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.99236137  0.07558914 -2.2740455   1.275243    2.5627377 ]
  [Layer 24] Output shape after mixer: (1, 1, 2048)
  [Layer 24] Output sample values after mixer: [ 0.99236137  0.07558914 -2.2740455   1.275243    2.5627377 ]
  [Layer 24] Residual connection shape: (1, 1, 2048)
  [Layer 24] Residual connection sample values: [ 3.7289727 -1.7259966 -6.6851325  2.9326203  7.46014  ]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13124557 -0.0555244  -0.22218724  0.09112854  0.2597728 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13124557 -0.0555244  -0.22218724  0.09112854  0.2597728 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13124557 -0.0555244  -0.22218724  0.09112854  0.2597728 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.39378813 -1.2058535   1.4535522  -0.06504014 -0.88991696]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.39378813 -1.2058535   1.4535522  -0.06504014 -0.88991696]
  [FlaxMamba2] xBC (step) sample values: [-0.5970689  -0.36369836 -0.6930768  -0.12768084 -0.15102921]
  [FlaxMamba2] dt (step) sample values: [ 1.0012605  -0.39425343  0.7800685   1.9447197  -0.83771265]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.30831322 -0.81913954 -1.5077785  -0.5970689   0.18001933]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.31311432 -0.04743507  0.16252711  0.13504183  0.14526422]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.31056038 -0.07564857  0.15111354  0.19586337  0.13950022]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.17920017 -0.03639429  0.08125476  0.10749176  0.07460731]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.17920017 -0.03639429  0.08125476  0.10749176  0.07460731]
  [FlaxMamba2] B (step) sample values: [ 0.09197462 -0.07082672  0.02019932  0.02053773  0.02173861]
  [FlaxMamba2] C (step) sample values: [ 0.07702383  0.00375362  0.06387716 -0.05152059 -0.08957275]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -0.37022203  -1.5044799   -5.7209826   -0.81757224 -14.66622   ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.33663198 0.0043084  0.05629676 0.04819032 0.01424862]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8828248  0.9935391  0.7246455  0.961367   0.81141686]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.17920017 -0.03639429  0.08125476  0.10749176  0.07460731]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00554832 -0.00427259  0.00121851  0.00123893  0.00131137]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00554832 -0.00427259  0.00121851  0.00123893  0.00131137]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00518164 -0.00518627 -0.00167577  0.00149998  0.00119961]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01443647  0.00135979  0.00742876 -0.00254857  0.01795522]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01256439  0.00097958  0.00827762 -0.00142562  0.01873464]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01256439  0.00097958  0.00827762 -0.00142562  0.01873464]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-2.9547433e-03 -2.7219809e-04  9.7524319e-03  4.4854201e-05
 -4.8537473e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.30661795 -0.01929555  1.1160328   0.00306193 -0.72552973]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.30661795 -0.01929555  1.1160328   0.00306193 -0.72552973]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.3755988 -0.9895398 -1.622931   3.131788   1.5897807]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.3755988 -0.9895398 -1.622931   3.131788   1.5897807]
  [Layer 25] Output shape after mixer: (1, 1, 2048)
  [Layer 25] Output sample values after mixer: [ 1.3755988 -0.9895398 -1.622931   3.131788   1.5897807]
  [Layer 25] Residual connection shape: (1, 1, 2048)
  [Layer 25] Residual connection sample values: [ 5.1045713 -2.7155364 -8.3080635  6.0644083  9.049921 ]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.20118389 -0.09903297 -0.3050594   0.21844013  0.3487788 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.20118389 -0.09903297 -0.3050594   0.21844013  0.3487788 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.20118389 -0.09903297 -0.3050594   0.21844013  0.3487788 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.1866136   0.34523642 -0.6373837   0.24929343 -0.9184164 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.1866136   0.34523642 -0.6373837   0.24929343 -0.9184164 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.1812847  -0.00365034  0.0708947   0.4899609  -1.4918346 ]
  [FlaxMamba2] dt (step) sample values: [0.97586083 1.5383282  0.7863444  0.83845097 3.1322083 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.5563709   0.3082994   0.8974074   1.1812847  -0.50656563]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04283583  0.11165261  0.06658509 -0.09468164  0.34378186]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04566514  0.05559182  0.13073304 -0.12162866  0.3518919 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02231134  0.02856833  0.06963322 -0.0571205   0.2065874 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02231134  0.02856833  0.06963322 -0.0571205   0.2065874 ]
  [FlaxMamba2] B (step) sample values: [-0.04651469 -0.00795431  0.04529165 -0.02619468  0.05350076]
  [FlaxMamba2] C (step) sample values: [-0.2075849   0.12536268  0.07607812 -0.15015031  0.14727198]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9594627  -0.39448437 -0.84198165 -1.4275463  -0.14661841]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.14414695 0.43049055 0.1325374  0.23313004 0.22529076]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.87083423 0.8438152  0.8944073  0.7169107  0.96750784]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02231134  0.02856833  0.06963322 -0.0571205   0.2065874 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.4959642e-04  2.5581956e-05 -1.4566297e-04  8.4245003e-05
 -1.7206439e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.4959642e-04  2.5581956e-05 -1.4566297e-04  8.4245003e-05
 -1.7206439e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00020594 -0.00138206 -0.00292736  0.00174301 -0.001036  ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01059898  0.01682471  0.0057719  -0.00554105  0.01751791]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01344111  0.02046388  0.01464211 -0.01281733  0.04383401]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01344111  0.02046388  0.01464211 -0.01281733  0.04383401]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01221939  0.00413622 -0.00322758 -0.00179575 -0.01148479]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.20536676  0.15437405 -0.10250361 -0.08682808 -0.48481345]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.20536676  0.15437405 -0.10250361 -0.08682808 -0.48481345]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.5453985 -1.9318608 -2.1030939 -1.1639935  1.9741619]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.5453985 -1.9318608 -2.1030939 -1.1639935  1.9741619]
  [Layer 26] Output shape after mixer: (1, 1, 2048)
  [Layer 26] Output sample values after mixer: [-1.5453985 -1.9318608 -2.1030939 -1.1639935  1.9741619]
  [Layer 26] Residual connection shape: (1, 1, 2048)
  [Layer 26] Residual connection sample values: [  3.5591729  -4.647397  -10.411158    4.900415   11.024083 ]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.14470868 -0.17241745 -0.4144056   0.17913076  0.46626034]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14470868 -0.17241745 -0.4144056   0.17913076  0.46626034]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14470868 -0.17241745 -0.4144056   0.17913076  0.46626034]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.00202856 -0.23922525 -0.6875061  -0.07827719  1.3765289 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.00202856 -0.23922525 -0.6875061  -0.07827719  1.3765289 ]
  [FlaxMamba2] xBC (step) sample values: [-1.3849553   0.9141894   0.05130057  1.1509459   0.73968273]
  [FlaxMamba2] dt (step) sample values: [1.223325   0.76471627 0.5479833  1.9123437  1.0392025 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.2306327   0.38961276 -1.2518519  -1.3849553  -0.94579154]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.38153    -0.45267564  0.0179409  -0.28963864 -0.28953275]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.40753096 -0.48917466  0.00793113 -0.49154294 -0.3193179 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.16281039 -0.18592943  0.00398129 -0.18655537 -0.13438238]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.16281039 -0.18592943  0.00398129 -0.18655537 -0.13438238]
  [FlaxMamba2] B (step) sample values: [-0.04463396 -0.06449981 -0.10073222  0.15068027 -0.00030315]
  [FlaxMamba2] C (step) sample values: [ 0.07663362 -0.27730763  0.17554651 -0.16646788 -0.18371573]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3661706 -1.3799144 -1.8267511 -2.0408754 -2.3490334]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.13690265 0.0984585  0.08276647 0.1081486  0.12259223]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8294169  0.8729611  0.8596811  0.80194294 0.74978167]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.16281039 -0.18592943  0.00398129 -0.18655537 -0.13438238]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.9485402e-04  1.4376474e-03  2.2452378e-03 -3.3585385e-03
  6.7569199e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.9485402e-04  1.4376474e-03  2.2452378e-03 -3.3585385e-03
  6.7569199e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00259389  0.00169578  0.00256391 -0.00390737  0.00041203]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00481603  0.0060359   0.00656802 -0.07035806 -0.00113316]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02128199 -0.01276823  0.00697067 -0.08922549 -0.01472404]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02128199 -0.01276823  0.00697067 -0.08922549 -0.01472404]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-2.1607771e-05  1.3454307e-03 -1.6034732e-03  3.3555522e-03
 -1.6182687e-02]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00048258  0.02184695 -0.04496551  0.08467118 -0.25109386]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00048258  0.02184695 -0.04496551  0.08467118 -0.25109386]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.6352566  1.3959602 -2.8297217  0.8240464  1.3305006]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.6352566  1.3959602 -2.8297217  0.8240464  1.3305006]
  [Layer 27] Output shape after mixer: (1, 1, 2048)
  [Layer 27] Output sample values after mixer: [ 0.6352566  1.3959602 -2.8297217  0.8240464  1.3305006]
  [Layer 27] Residual connection shape: (1, 1, 2048)
  [Layer 27] Residual connection sample values: [  4.1944294  -3.2514367 -13.240879    5.7244616  12.354584 ]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.14877844 -0.10790952 -0.44396037  0.18656614  0.43374333]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14877844 -0.10790952 -0.44396037  0.18656614  0.43374333]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14877844 -0.10790952 -0.44396037  0.18656614  0.43374333]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.0791484  -1.2097706   0.09188081 -0.4913343  -0.94503796]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.0791484  -1.2097706   0.09188081 -0.4913343  -0.94503796]
  [FlaxMamba2] xBC (step) sample values: [-1.4833286  -1.6980083  -0.22915174 -0.8049293  -1.5064851 ]
  [FlaxMamba2] dt (step) sample values: [0.864221  0.5886334 0.7538716 1.1958603 0.8080761]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.68640137 -0.56316453 -0.02071643 -1.4833286  -2.533607  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.23448396  0.47480515 -0.05391234 -0.15467176  0.19876751]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.17671418  0.46344498 -0.06757659 -0.16604719  0.3034428 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.09614381  0.28447694 -0.03264708 -0.07614647  0.17456578]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.09614381  0.28447694 -0.03264708 -0.07614647  0.17456578]
  [FlaxMamba2] B (step) sample values: [-0.019573   -0.01849981 -0.02732595 -0.02403168  0.2701653 ]
  [FlaxMamba2] C (step) sample values: [-0.07762106  0.04368648  0.2834807  -0.15915164  0.42884406]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2727895 -3.997792  -2.517685  -2.1714401 -2.8654757]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02399685 0.0779148  0.0868008  0.05554108 0.03388791]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9699188  0.732357   0.8036937  0.8863848  0.90746075]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.09614381  0.28447694 -0.03264708 -0.07614647  0.17456578]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.5157823e-05 -4.2681811e-05 -6.3045038e-05 -5.5444667e-05
  6.2331161e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.5157823e-05 -4.2681811e-05 -6.3045038e-05 -5.5444667e-05
  6.2331161e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-5.2496642e-05 -1.7245069e-04 -1.5297755e-05  2.7672187e-04
  3.5443969e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00106129  0.01665885  0.00022879 -0.00578566  0.00815416]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02190264  0.07832567 -0.00684821 -0.02229213  0.04599525]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02190264  0.07832567 -0.00684821 -0.02229213  0.04599525]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00090106 -0.02176942 -0.00032905  0.00415749 -0.01216578]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.04410315 -0.7061575  -0.01011164  0.14753103 -0.4187897 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04410315 -0.7061575  -0.01011164  0.14753103 -0.4187897 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.478107   1.120365  -6.0460196  0.130237   1.981651 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.478107   1.120365  -6.0460196  0.130237   1.981651 ]
  [Layer 28] Output shape after mixer: (1, 1, 2048)
  [Layer 28] Output sample values after mixer: [ 0.478107   1.120365  -6.0460196  0.130237   1.981651 ]
  [Layer 28] Residual connection shape: (1, 1, 2048)
  [Layer 28] Residual connection sample values: [  4.6725364  -2.1310716 -19.2869      5.8546987  14.336235 ]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.14503714 -0.06326587 -0.57333344  0.1676112   0.44247168]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14503714 -0.06326587 -0.57333344  0.1676112   0.44247168]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14503714 -0.06326587 -0.57333344  0.1676112   0.44247168]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.46543095 -1.1625292  -1.6493506  -1.1961342   0.38158694]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.46543095 -1.1625292  -1.6493506  -1.1961342   0.38158694]
  [FlaxMamba2] xBC (step) sample values: [-0.40778008 -0.437087    0.34471923  0.2933702  -1.5487915 ]
  [FlaxMamba2] dt (step) sample values: [1.569932   1.2125931  0.65510446 0.86591876 1.7377601 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.8002835   0.76493245  0.21881273 -0.40778008  0.17185909]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.06909083  0.16373575 -0.04815175 -0.04778269 -0.17018041]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.08249567  0.12922037 -0.04530407 -0.10820749 -0.28327855]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03954742  0.06877886 -0.02213901 -0.05117939 -0.12171068]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03954742  0.06877886 -0.02213901 -0.05117939 -0.12171068]
  [FlaxMamba2] B (step) sample values: [ 0.09541231 -0.05312596  0.1416011  -0.0311372  -0.02971627]
  [FlaxMamba2] C (step) sample values: [-0.2776552  -0.27534726 -0.11688118 -0.23710777 -0.26476085]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8072329  -2.117      -1.925669   -0.29044876 -2.049864  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.09814225 0.15731323 0.11911111 0.00373848 0.313647  ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8374733  0.71674716 0.7950355  0.9989148  0.5257478 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03954742  0.06877886 -0.02213901 -0.05117939 -0.12171068]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00037032  0.0002062  -0.00054959  0.00012085  0.00011534]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00037032  0.0002062  -0.00054959  0.00012085  0.00011534]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-8.5402699e-04  4.5734440e-04 -7.5059303e-04  1.3708370e-04
  1.8236802e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00740808  0.00383984 -0.00715413  0.00726818 -0.01910649]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04784646  0.07416821 -0.02979191 -0.04506423 -0.14355919]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04784646  0.07416821 -0.02979191 -0.04506423 -0.14355919]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0085892  -0.02053894  0.00792077  0.01251429 -0.03255352]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.07850158 -0.17665517  0.10794231  0.1529768  -0.35304543]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.07850158 -0.17665517  0.10794231  0.1529768  -0.35304543]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.5722578   2.4918656   0.860902   -0.17856364  2.172839  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.5722578   2.4918656   0.860902   -0.17856364  2.172839  ]
  [Layer 29] Output shape after mixer: (1, 1, 2048)
  [Layer 29] Output sample values after mixer: [ 1.5722578   2.4918656   0.860902   -0.17856364  2.172839  ]
  [Layer 29] Residual connection shape: (1, 1, 2048)
  [Layer 29] Residual connection sample values: [  6.244794     0.36079407 -18.425997     5.676135    16.509073  ]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.19345601  0.01099751 -0.55772257  0.16202657  0.5255068 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.19345601  0.01099751 -0.55772257  0.16202657  0.5255068 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.19345601  0.01099751 -0.55772257  0.16202657  0.5255068 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.28236306  0.25984806 -0.66789234 -0.6656719   0.920415  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.28236306  0.25984806 -0.66789234 -0.6656719   0.920415  ]
  [FlaxMamba2] xBC (step) sample values: [ 1.0086272  -0.65109116 -0.5821298   0.22593088  0.2721257 ]
  [FlaxMamba2] dt (step) sample values: [1.4564941 1.3813076 0.7306775 1.4399405 1.255606 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.6973957  1.1255277  1.1604306  1.0086272 -0.6956271]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.16005167 -0.08899416 -0.24209349 -0.04632803 -0.05976833]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.13676676 -0.07529177 -0.2089514  -0.06447073 -0.08711208]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.07305239 -0.03622934 -0.09360006 -0.03119661 -0.04166011]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.07305239 -0.03622934 -0.09360006 -0.03119661 -0.04166011]
  [FlaxMamba2] B (step) sample values: [0.0547822  0.15692241 0.0141061  0.36750418 0.06366146]
  [FlaxMamba2] C (step) sample values: [-0.24812068 -0.20615928  0.03268655  0.05139961 -0.27009174]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0149885  -0.4675477  -0.42799968 -0.7895216  -0.4174731 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01698461 0.36260176 0.44221908 0.21622272 0.3249302 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.98290855 0.8440584  0.82756335 0.84306395 0.8731485 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.07305239 -0.03622934 -0.09360006 -0.03119661 -0.04166011]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [6.7971923e-05 1.9470407e-04 1.7502376e-05 4.5598688e-04 7.8989011e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [6.7971923e-05 1.9470407e-04 1.7502376e-05 4.5598688e-04 7.8989011e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [6.3481217e-04 4.7487425e-05 4.6204786e-05 1.3525428e-03 1.2135832e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 2.2536837e-03 -3.8967706e-04 -1.4807287e-03 -6.5301219e-04
 -2.0178844e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.09224868 -0.04502147 -0.1167889  -0.03908486 -0.05134227]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.09224868 -0.04502147 -0.1167889  -0.03908486 -0.05134227]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01119721 -0.0066051   0.0264404   0.00883214 -0.03379416]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.13312256 -0.07970104  0.19369096  0.08717085 -0.29641876]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.13312256 -0.07970104  0.19369096  0.08717085 -0.29641876]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.9865529  -2.2508929  -1.9573182  -2.2797046   0.76510954]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.9865529  -2.2508929  -1.9573182  -2.2797046   0.76510954]
  [Layer 30] Output shape after mixer: (1, 1, 2048)
  [Layer 30] Output sample values after mixer: [ 0.9865529  -2.2508929  -1.9573182  -2.2797046   0.76510954]
  [Layer 30] Residual connection shape: (1, 1, 2048)
  [Layer 30] Residual connection sample values: [  7.2313466  -1.8900988 -20.383314    3.3964305  17.274183 ]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.20630114 -0.05290414 -0.5721953   0.09279385  0.49788526]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.20630114 -0.05290414 -0.5721953   0.09279385  0.49788526]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.20630114 -0.05290414 -0.5721953   0.09279385  0.49788526]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.84815204  0.3834197   0.18007407  1.2778666   0.36424935]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.84815204  0.3834197   0.18007407  1.2778666   0.36424935]
  [FlaxMamba2] xBC (step) sample values: [ 0.6666407  -0.9495533  -0.13126181  0.32331482 -0.9193687 ]
  [FlaxMamba2] dt (step) sample values: [1.592082   1.2740221  1.8551699  0.40876254 1.6983097 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.1247746   0.07625837  0.26194924  0.6666407  -0.76230335]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.11281255  0.1333639  -0.10108485 -0.05528829  0.15720809]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.11231712  0.12304133 -0.10007014 -0.0571861   0.15190566]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.05930903  0.0653007  -0.04753365 -0.02777571  0.08171059]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05930903  0.0653007  -0.04753365 -0.02777571  0.08171059]
  [FlaxMamba2] B (step) sample values: [ 0.07935642 -0.04571659  0.12207563 -0.27773508  0.04187974]
  [FlaxMamba2] C (step) sample values: [-0.12061879 -0.13022412 -0.18433298 -0.10418579 -0.13370365]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.9477868 -3.5383902 -4.705952  -2.462968  -0.9027082]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.15263054 0.0789341  0.09687962 0.08865508 0.20848286]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.63767767 0.75631326 0.63387036 0.8038403  0.82844967]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05930903  0.0653007  -0.04753365 -0.02777571  0.08171059]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00071836 -0.00041384  0.00110507 -0.00251416  0.00037911]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00071836 -0.00041384  0.00110507 -0.00251416  0.00037911]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00189461 -0.00017908  0.00126    -0.00359101  0.00011155]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01082391  0.00494301  0.00270001 -0.01263115  0.02321349]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.05162949  0.04987096 -0.03000392 -0.0317413   0.07943171]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.05162949  0.04987096 -0.03000392 -0.0317413   0.07943171]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01312904  0.01137152 -0.00294404 -0.03172232  0.01707243]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.22746655  0.1721087  -0.03967759 -0.45505092  0.29021484]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.22746655  0.1721087  -0.03967759 -0.45505092  0.29021484]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.7916797  2.7682285 -0.3904382 -0.5060426  1.6296201]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.7916797  2.7682285 -0.3904382 -0.5060426  1.6296201]
  [Layer 31] Output shape after mixer: (1, 1, 2048)
  [Layer 31] Output sample values after mixer: [-1.7916797  2.7682285 -0.3904382 -0.5060426  1.6296201]
  [Layer 31] Residual connection shape: (1, 1, 2048)
  [Layer 31] Residual connection sample values: [  5.4396667   0.8781297 -20.773752    2.890388   18.903803 ]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15115918  0.02450676 -0.57819915  0.07535038  0.5462153 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15115918  0.02450676 -0.57819915  0.07535038  0.5462153 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15115918  0.02450676 -0.57819915  0.07535038  0.5462153 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.93161505 -0.26752442 -2.0125191  -1.3413074  -0.12222957]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.93161505 -0.26752442 -2.0125191  -1.3413074  -0.12222957]
  [FlaxMamba2] xBC (step) sample values: [-0.19899184  0.3345535  -0.3223851   0.5169553   0.95100504]
  [FlaxMamba2] dt (step) sample values: [1.0265919 2.7842038 1.1605914 1.0996724 0.9961488]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.927233    0.49158794  0.05904174 -0.19899184 -0.02829227]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.04701934 -0.12033209  0.06957438 -0.10398468 -0.14153008]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00984893 -0.17236456  0.05373576 -0.09150299 -0.14850335]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00490021 -0.07877323  0.02758959 -0.04365975 -0.06874847]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00490021 -0.07877323  0.02758959 -0.04365975 -0.06874847]
  [FlaxMamba2] B (step) sample values: [ 0.0646239  -0.06513776 -0.0915898  -0.06275286 -0.09797061]
  [FlaxMamba2] C (step) sample values: [ 0.16538851  0.49564466  0.49654853 -0.25084004 -0.23646638]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6970906 -2.0892735 -1.7966746 -1.3893797 -1.0395182]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.20450401 0.08463968 0.32893476 0.2764137  0.3825226 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.86713743 0.8379177  0.5537795  0.68110174 0.6719044 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00490021 -0.07877323  0.02758959 -0.04365975 -0.06874847]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.476049e-05  6.527543e-05  9.178338e-05  6.288549e-05  9.817768e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.476049e-05  6.527543e-05  9.178338e-05  6.288549e-05  9.817768e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00215673  0.00347702  0.00049662 -0.00385961 -0.00123754]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.04374559 -0.03672798 -0.0009389  -0.03361323  0.00114842]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.04257014 -0.05562378  0.00567918 -0.04408615 -0.01534268]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.04257014 -0.05562378  0.00567918 -0.04408615 -0.01534268]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01120752  0.00645101 -0.00134747  0.012258    0.00088043]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.0933555   0.04322552 -0.01753479  0.13056414  0.0076695 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0933555   0.04322552 -0.01753479  0.13056414  0.0076695 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.341662   -3.1503582  -0.73522246  1.1021696   2.2967362 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.341662   -3.1503582  -0.73522246  1.1021696   2.2967362 ]
  [Layer 32] Output shape after mixer: (1, 1, 2048)
  [Layer 32] Output sample values after mixer: [ 0.341662   -3.1503582  -0.73522246  1.1021696   2.2967362 ]
  [Layer 32] Residual connection shape: (1, 1, 2048)
  [Layer 32] Residual connection sample values: [  5.7813287  -2.2722285 -21.508974    3.9925575  21.200539 ]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.1310946  -0.0533927  -0.49682456  0.08954822  0.49791995]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1310946  -0.0533927  -0.49682456  0.08954822  0.49791995]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1310946  -0.0533927  -0.49682456  0.08954822  0.49791995]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.7766349  -1.3096697   1.0463523  -0.44245613 -0.07477358]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.7766349  -1.3096697   1.0463523  -0.44245613 -0.07477358]
  [FlaxMamba2] xBC (step) sample values: [ 0.7821941  -2.0370526   0.26436102 -0.9164948   0.9150745 ]
  [FlaxMamba2] dt (step) sample values: [-2.0615764   3.008184   -0.01992649  2.04702    -0.67109686]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.30283353 -1.0278451  -0.82687455  0.7821941  -1.5782133 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.08732314 -0.3070096  -0.05081371 -0.18461385 -0.1397512 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0741777  -0.35638705 -0.02398876 -0.18582025 -0.14094043]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.0384638  -0.14677246 -0.01185052 -0.08430259 -0.06551236]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0384638  -0.14677246 -0.01185052 -0.08430259 -0.06551236]
  [FlaxMamba2] B (step) sample values: [ 0.6082713   0.00359378  0.04481231 -0.0100046  -0.0206644 ]
  [FlaxMamba2] C (step) sample values: [ 0.05910219 -0.11716863 -0.21819004 -0.1643465  -0.23468   ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9790505  -9.693779   -6.1677613  -0.11351943 -2.090294  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0015037  0.1850161  0.01270033 0.06127593 0.00146868]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9970285  0.16637596 0.9246568  0.9930681  0.9969348 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0384638  -0.14677246 -0.01185052 -0.08430259 -0.06551236]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.5181147e-05  2.0785703e-07  2.5918512e-06 -5.7864537e-07
 -1.1951860e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.5181147e-05  2.0785703e-07  2.5918512e-06 -5.7864537e-07
 -1.1951860e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-4.1082130e-06  7.0682087e-05 -7.2057330e-05 -1.9176192e-05
  6.3100582e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-8.3072977e-05  1.3299820e-04  3.2414155e-04  4.7783444e-05
 -2.4191033e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03996819 -0.15269698 -0.01201547 -0.0877341  -0.06845807]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03996819 -0.15269698 -0.01201547 -0.0877341  -0.06845807]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01027634  0.04250473 -0.00930451  0.01518408  0.00246378]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.19281451  0.4753018  -0.1311049   0.20896222  0.0383733 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.19281451  0.4753018  -0.1311049   0.20896222  0.0383733 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-3.9503841   1.1274065   0.91848254 -1.5019413   1.8280032 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-3.9503841   1.1274065   0.91848254 -1.5019413   1.8280032 ]
  [Layer 33] Output shape after mixer: (1, 1, 2048)
  [Layer 33] Output sample values after mixer: [-3.9503841   1.1274065   0.91848254 -1.5019413   1.8280032 ]
  [Layer 33] Residual connection shape: (1, 1, 2048)
  [Layer 33] Residual connection sample values: [  1.8309445  -1.144822  -20.590492    2.4906163  23.028542 ]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03292906 -0.02181582 -0.37008002  0.04516211  0.43437183]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03292906 -0.02181582 -0.37008002  0.04516211  0.43437183]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03292906 -0.02181582 -0.37008002  0.04516211  0.43437183]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.5287213  -0.10147861  0.6246623  -1.2374986  -1.6944073 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.5287213  -0.10147861  0.6246623  -1.2374986  -1.6944073 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.25822285 -0.94799554 -0.00555747 -1.1736685  -0.42814103]
  [FlaxMamba2] dt (step) sample values: [2.1449914 1.2416549 3.327734  1.7655213 1.7856467]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.34320295  0.5365614  -0.66166776  0.25822285 -0.36762506]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.04442567  0.15110718 -0.04236541  0.2868678  -0.08634675]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.07631654  0.17713867 -0.05430541  0.24734753 -0.09488405]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03670292  0.09639341 -0.02641562  0.13889147 -0.04519296]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03670292  0.09639341 -0.02641562  0.13889147 -0.04519296]
  [FlaxMamba2] B (step) sample values: [ 0.01673139  0.02141294 -0.02925043  0.01734879 -0.05507812]
  [FlaxMamba2] C (step) sample values: [-0.0263185  -0.26421082 -0.27511057 -0.15983132 -0.27626377]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.5610816  -2.4810736  -2.893596   -0.01585086 -0.02613366]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.37709585 0.10807    0.23333845 0.08128674 0.04384988]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.3806887  0.76480865 0.50906116 0.99871236 0.9988547 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03670292  0.09639341 -0.02641562  0.13889147 -0.04519296]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00023157 -0.00029637  0.00040484 -0.00024012  0.00076231]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00023157 -0.00029637  0.00040484 -0.00024012  0.00076231]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00188949 -0.00032439  0.00038246 -0.00054544  0.00059324]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00206503  0.00655866 -0.00268698  0.01020463 -0.00260894]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02467194  0.06593152 -0.0189575   0.09575388 -0.03044524]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02467194  0.06593152 -0.0189575   0.09575388 -0.03044524]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00820745 -0.00317573 -0.00771246 -0.02664624  0.0080061 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.25793362 -0.0970604  -0.26949337 -1.0469617   0.29876634]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.25793362 -0.0970604  -0.26949337 -1.0469617   0.29876634]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.2688491  1.13854   -9.0522175  2.3128197  5.1123223]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.2688491  1.13854   -9.0522175  2.3128197  5.1123223]
  [Layer 34] Output shape after mixer: (1, 1, 2048)
  [Layer 34] Output sample values after mixer: [ 2.2688491  1.13854   -9.0522175  2.3128197  5.1123223]
  [Layer 34] Residual connection shape: (1, 1, 2048)
  [Layer 34] Residual connection sample values: [ 4.0997934e+00 -6.2819719e-03 -2.9642710e+01  4.8034363e+00
  2.8140863e+01]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 8.0668390e-02 -1.2337195e-04 -5.7279170e-01  8.7061219e-02
  5.4795408e-01]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 8.0668390e-02 -1.2337195e-04 -5.7279170e-01  8.7061219e-02
  5.4795408e-01]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 8.0668390e-02 -1.2337195e-04 -5.7279170e-01  8.7061219e-02
  5.4795408e-01]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.3593589  -0.6894043   0.39054987 -0.70189154 -1.4371719 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.3593589  -0.6894043   0.39054987 -0.70189154 -1.4371719 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.8682969   1.2026073   1.4729484  -1.2738813  -0.70510757]
  [FlaxMamba2] dt (step) sample values: [3.5235174 1.130048  1.2356255 1.3896067 1.4635328]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.38777608 -1.697997   -0.04688474  0.8682969   0.97738266]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.15389808 -0.28086746 -0.22740127 -0.29749134 -0.12895188]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.30990392 -0.23972976 -0.2635951  -0.34244373 -0.17042527]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.13113219 -0.10556571 -0.11452685 -0.14218812 -0.07796896]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.13113219 -0.10556571 -0.11452685 -0.14218812 -0.07796896]
  [FlaxMamba2] B (step) sample values: [ 0.03368577  0.18682039 -0.257165    0.16921401  0.0598541 ]
  [FlaxMamba2] C (step) sample values: [-0.2740526   0.34540313 -0.2627378   0.11062184 -0.09002685]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.709799  -2.7746034 -0.4452666 -1.139112  -3.5906036]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.2698823  0.05169889 0.46249476 0.2439855  0.1073921 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8256683  0.8663694  0.81388724 0.75735223 0.68004084]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.13113219 -0.10556571 -0.11452685 -0.14218812 -0.07796896]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00119215 -0.00661162  0.00910114 -0.00598853 -0.00211825]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00119215 -0.00661162  0.00910114 -0.00598853 -0.00211825]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00451631 -0.01306627  0.023014   -0.02051344 -0.00054348]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.06809978 -0.05269993 -0.05134393 -0.10748813 -0.02265754]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.15678822 -0.12409702 -0.1288017  -0.20365399 -0.07539017]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.15678822 -0.12409702 -0.1288017  -0.20365399 -0.07539017]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.04355224  0.02858888 -0.03000176  0.04737031  0.02080117]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.83902687  0.29300305 -0.21726066  0.39652532  0.23379979]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.83902687  0.29300305 -0.21726066  0.39652532  0.23379979]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 4.012516   5.039453  -5.0928564 -3.1043248  3.7083752]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 4.012516   5.039453  -5.0928564 -3.1043248  3.7083752]
  [Layer 35] Output shape after mixer: (1, 1, 2048)
  [Layer 35] Output sample values after mixer: [ 4.012516   5.039453  -5.0928564 -3.1043248  3.7083752]
  [Layer 35] Residual connection shape: (1, 1, 2048)
  [Layer 35] Residual connection sample values: [  8.112309    5.033171  -34.735565    1.6991115  31.84924  ]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.12934785  0.08125026 -0.54998845  0.0267278   0.51995176]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12934785  0.08125026 -0.54998845  0.0267278   0.51995176]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12934785  0.08125026 -0.54998845  0.0267278   0.51995176]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.5299428  -1.2722864  -0.27409196 -2.1294723  -1.0286402 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.5299428  -1.2722864  -0.27409196 -2.1294723  -1.0286402 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.03408239  1.1827321   0.8557146  -0.14927907 -0.54659474]
  [FlaxMamba2] dt (step) sample values: [ 1.0343521   1.3333684   0.2864223  -0.1778835  -0.28356352]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.46189055 -0.54411405 -0.4720742   0.03408239  2.262598  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.03110859  0.2057913   0.12179745 -0.03557979  0.10071847]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00508526  0.20565754  0.09330929 -0.06051265  0.07285592]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00253617  0.11336542  0.04882972 -0.02934116  0.03775437]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00253617  0.11336542  0.04882972 -0.02934116  0.03775437]
  [FlaxMamba2] B (step) sample values: [ 0.07287154  0.3335662   0.05050055 -0.10084347  0.04128544]
  [FlaxMamba2] C (step) sample values: [ 0.2814794  -0.278123   -0.1962035  -0.14746699 -0.16925578]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6566098 -1.1305923 -1.6058172 -2.4414158 -2.882315 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1156876  0.01390986 0.02860747 0.03073501 0.03102554]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7354029  0.98439664 0.95510083 0.9277092  0.9144565 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00253617  0.11336542  0.04882972 -0.02934116  0.03775437]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.1380722e-05 -9.7869299e-05 -1.4817010e-05  2.9587771e-05
 -1.2113269e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.1380722e-05 -9.7869299e-05 -1.4817010e-05  2.9587771e-05
 -1.2113269e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-4.4372727e-04 -9.2740246e-04 -2.9157047e-04  3.9534172e-04
  4.2908021e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-2.4407933e-05  1.2981661e-02 -1.2147491e-03 -4.1576936e-03
  5.5905274e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00293031  0.14287427  0.0547337  -0.03777641  0.04381752]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00293031  0.14287427  0.0547337  -0.03777641  0.04381752]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0005754  -0.03978482 -0.00647943  0.00854837 -0.01186973]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00847118 -0.8544436  -0.09399715  0.13957535 -0.16777897]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00847118 -0.8544436  -0.09399715  0.13957535 -0.16777897]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-5.847176   -1.3937755  -0.22460926 -0.4299724   0.37705556]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-5.847176   -1.3937755  -0.22460926 -0.4299724   0.37705556]
  [Layer 36] Output shape after mixer: (1, 1, 2048)
  [Layer 36] Output sample values after mixer: [-5.847176   -1.3937755  -0.22460926 -0.4299724   0.37705556]
  [Layer 36] Residual connection shape: (1, 1, 2048)
  [Layer 36] Residual connection sample values: [  2.2651334   3.6393957 -34.960175    1.269139   32.226295 ]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0379795   0.06243236 -0.5791513   0.02058734  0.54450196]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0379795   0.06243236 -0.5791513   0.02058734  0.54450196]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0379795   0.06243236 -0.5791513   0.02058734  0.54450196]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.0772985   1.8704664   1.4904064  -2.657676    0.14577967]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.0772985   1.8704664   1.4904064  -2.657676    0.14577967]
  [FlaxMamba2] xBC (step) sample values: [-0.252069   -0.17420769 -1.6905087  -0.82351595 -0.27881622]
  [FlaxMamba2] dt (step) sample values: [3.6748679 0.1585041 1.2984973 4.717592  1.4335531]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.68881214 -0.07730158 -0.6521405  -0.252069    0.31732222]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00210577  0.01819466 -0.16766305 -0.5126587   0.00711831]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01448827 -0.01024773 -0.16266198 -0.6635376   0.0218583 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00719166 -0.00509761 -0.07473081 -0.22556655  0.01104859]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00719166 -0.00509761 -0.07473081 -0.22556655  0.01104859]
  [FlaxMamba2] B (step) sample values: [ 0.06356331  0.28588328  0.03943996 -0.162982   -0.03865361]
  [FlaxMamba2] C (step) sample values: [-0.00777785 -0.02902759 -0.17639998 -0.25535142 -0.2751289 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.06064401 -3.2470093  -0.81907064 -0.24529998 -1.975189  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.3161792  0.01142202 0.03395928 0.13104188 0.04803277]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9810083  0.96359193 0.9725682  0.96836656 0.9094877 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00719166 -0.00509761 -0.07473081 -0.22556655  0.01104859]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.4453365e-04 -6.5005664e-04 -8.9680681e-05  3.7059718e-04
  8.7892644e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.4453365e-04 -6.5005664e-04 -8.9680681e-05  3.7059718e-04
  8.7892644e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00010183 -0.00052883 -0.00091864  0.00115753 -0.00029127]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00180416 -0.01157261 -0.02882094  0.01754427  0.06385612]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00043558 -0.01060253 -0.01459959  0.06046981  0.06175356]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00043558 -0.01060253 -0.01459959  0.06046981  0.06175356]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00035005 -0.01718439 -0.01775864 -0.01052926  0.00482872]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00302358 -0.13471648 -0.27436092 -0.3005187   0.0308025 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00302358 -0.13471648 -0.27436092 -0.3005187   0.0308025 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.52455175 -0.39484242  2.387925   -0.1917893  -2.755098  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.52455175 -0.39484242  2.387925   -0.1917893  -2.755098  ]
  [Layer 37] Output shape after mixer: (1, 1, 2048)
  [Layer 37] Output sample values after mixer: [ 0.52455175 -0.39484242  2.387925   -0.1917893  -2.755098  ]
  [Layer 37] Residual connection shape: (1, 1, 2048)
  [Layer 37] Residual connection sample values: [  2.7896852   3.2445533 -32.57225     1.0773498  29.471197 ]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03775457  0.04357982 -0.43542475  0.01405188  0.39396998]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03775457  0.04357982 -0.43542475  0.01405188  0.39396998]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03775457  0.04357982 -0.43542475  0.01405188  0.39396998]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.16528249 -0.14034705 -0.07693662 -1.6265109  -0.7712501 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.16528249 -0.14034705 -0.07693662 -1.6265109  -0.7712501 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.8204461   0.31709278 -0.32802808 -1.7335907  -0.15715855]
  [FlaxMamba2] dt (step) sample values: [1.1382802  2.190822   0.34427243 1.3332886  1.1790322 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.9851128 1.0854717 0.7721357 0.8204461 1.5083833]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.15613784 -0.06798755  0.03632465  0.33819294 -0.03486202]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.12804641 -0.10515796  0.01055256  0.32658863 -0.05611752]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.05992983 -0.04981697  0.00530412  0.18972483 -0.02727167]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05992983 -0.04981697  0.00530412  0.18972483 -0.02727167]
  [FlaxMamba2] B (step) sample values: [-0.17515613 -0.2761593  -0.05391323 -0.05103733 -0.24084923]
  [FlaxMamba2] C (step) sample values: [-0.18960978 -0.16204958 -0.17276794  0.3315631  -0.25958878]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0881431 -1.3535548 -1.1764196 -1.6451025 -1.1940706]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.15392213 0.24071614 0.22949225 0.15111634 0.07285142]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8457857  0.7219333  0.76339537 0.7798904  0.91668653]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05992983 -0.04981697  0.00530412  0.18972483 -0.02727167]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00161573 0.00254744 0.00049732 0.0004708  0.00222172]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00161573 0.00254744 0.00049732 0.0004708  0.00222172]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00923928 0.01182961 0.00177139 0.00089674 0.01134086]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02569078 -0.02912406 -0.00078552  0.06480679  0.00177913]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07422338 -0.06946704  0.00350988  0.21845047 -0.02030612]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07422338 -0.06946704  0.00350988  0.21845047 -0.02030612]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00663968  0.00453323 -0.00012983 -0.05838093  0.00495218]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.14089774  0.09304448 -0.00279546 -1.146749    0.08750479]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.14089774  0.09304448 -0.00279546 -1.146749    0.08750479]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 4.8594213 -4.391165  -4.6364627  4.8107667 -1.7834157]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 4.8594213 -4.391165  -4.6364627  4.8107667 -1.7834157]
  [Layer 38] Output shape after mixer: (1, 1, 2048)
  [Layer 38] Output sample values after mixer: [ 4.8594213 -4.391165  -4.6364627  4.8107667 -1.7834157]
  [Layer 38] Residual connection shape: (1, 1, 2048)
  [Layer 38] Residual connection sample values: [  7.6491065  -1.1466115 -37.208714    5.8881164  27.687782 ]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07920722 -0.01199534 -0.38592526  0.06116997  0.29012284]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07920722 -0.01199534 -0.38592526  0.06116997  0.29012284]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07920722 -0.01199534 -0.38592526  0.06116997  0.29012284]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.37490484 -0.37016624 -0.61255723 -0.04672803 -0.19098862]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.37490484 -0.37016624 -0.61255723 -0.04672803 -0.19098862]
  [FlaxMamba2] xBC (step) sample values: [-0.19632643 -0.1755606   0.78354114 -1.1488899  -0.6862301 ]
  [FlaxMamba2] dt (step) sample values: [0.5565253  0.99217105 0.7152615  1.4279182  0.04824992]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5098075  -0.19454132 -0.03167162 -0.19632643  0.4084825 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02836038  0.02386428  0.14558104 -0.26741302 -0.13120376]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04269601  0.10906935  0.12324217 -0.2633351  -0.15218459]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02089234  0.05750576  0.06541345 -0.1144307  -0.0703134 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02089234  0.05750576  0.06541345 -0.1144307  -0.0703134 ]
  [FlaxMamba2] B (step) sample values: [-0.07588317 -0.0534407   0.00513781  0.05822589  0.06904986]
  [FlaxMamba2] C (step) sample values: [-0.14117861  0.21658896  0.24581826  0.25435966 -0.00997953]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.69420344 -0.9242845  -1.3151171  -3.1532621  -2.1087465 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00843118 0.0202263  0.01808729 0.10955343 0.0269521 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99416417 0.9814788  0.9764938  0.70790124 0.9447498 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02089234  0.05750576  0.06541345 -0.1144307  -0.0703134 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.3366596e-05  9.4134220e-06 -9.0501038e-07 -1.0256319e-05
 -1.2162930e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.3366596e-05  9.4134220e-06 -9.0501038e-07 -1.0256319e-05
 -1.2162930e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00025866 -0.00012225  0.00010715 -0.0001746   0.00034865]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00149794  0.00818927  0.00063154 -0.0066962   0.0028488 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0164038   0.05746349  0.05668151 -0.10474695 -0.05739973]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0164038   0.05746349  0.05668151 -0.10474695 -0.05739973]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00250519 -0.00868924 -0.01220348  0.00239014  0.0049595 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.07896281 -0.29420695 -0.42237705  0.06689202  0.15826891]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.07896281 -0.29420695 -0.42237705  0.06689202  0.15826891]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ -5.734617  -10.187195    0.9806886   1.3138287  -4.9068017]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ -5.734617  -10.187195    0.9806886   1.3138287  -4.9068017]
  [Layer 39] Output shape after mixer: (1, 1, 2048)
  [Layer 39] Output sample values after mixer: [ -5.734617  -10.187195    0.9806886   1.3138287  -4.9068017]
  [Layer 39] Residual connection shape: (1, 1, 2048)
  [Layer 39] Residual connection sample values: [  1.9144893 -11.333806  -36.228024    7.2019453  22.780981 ]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0173515  -0.103525   -0.33972287  0.06589331  0.20589273]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0173515  -0.103525   -0.33972287  0.06589331  0.20589273]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0173515  -0.103525   -0.33972287  0.06589331  0.20589273]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.07363933 -0.45566642 -0.5131369  -0.3094504  -0.6952973 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.07363933 -0.45566642 -0.5131369  -0.3094504  -0.6952973 ]
  [FlaxMamba2] xBC (step) sample values: [-0.16612352 -0.22655748  0.24770893 -0.17402746 -0.8520594 ]
  [FlaxMamba2] dt (step) sample values: [0.3184488 1.2448916 2.068262  1.3858824 1.1141038]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.5224164  -0.30313236  0.02948296 -0.16612352 -0.7779392 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03112603  0.03759598  0.05356191  0.03834996 -0.17307732]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04678155  0.01896499  0.05931829  0.02847753 -0.17784187]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02284375  0.00957241  0.03053855  0.01444149 -0.08103478]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02284375  0.00957241  0.03053855  0.01444149 -0.08103478]
  [FlaxMamba2] B (step) sample values: [-0.04793976 -0.15955788 -0.07544101 -0.07515317 -0.05223804]
  [FlaxMamba2] C (step) sample values: [-0.18517804 -0.02580483  0.02794377  0.2875066  -0.08851118]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9809841  -1.4352343  -0.79658854 -1.6062093  -1.8464803 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.07771966 0.04618209 0.03543231 0.13999069 0.17016087]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8573051  0.93586683 0.97216964 0.79863256 0.73037386]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02284375  0.00957241  0.03053855  0.01444149 -0.08103478]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [8.5112631e-05 2.8328036e-04 1.3393859e-04 1.3342756e-04 9.2743852e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [8.5112631e-05 2.8328036e-04 1.3393859e-04 1.3342756e-04 9.2743852e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.9702127e-04  1.3566954e-03  5.7242130e-04 -6.2526509e-05
  4.4556096e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00257201  0.00890419  0.00442993  0.00318628 -0.00243519]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02122804  0.01672179  0.02937015  0.01498036 -0.06861468]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02122804  0.01672179  0.02937015  0.01498036 -0.06861468]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00075284 -0.0029565  -0.00564343 -0.00196205  0.01587975]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.02217298 -0.08759573 -0.16463998 -0.06782535  0.46164215]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02217298 -0.08759573 -0.16463998 -0.06782535  0.46164215]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-7.4903297  -0.22182311 -7.3766026   0.9665687   2.7905629 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-7.4903297  -0.22182311 -7.3766026   0.9665687   2.7905629 ]
  [Layer 40] Output shape after mixer: (1, 1, 2048)
  [Layer 40] Output sample values after mixer: [-7.4903297  -0.22182311 -7.3766026   0.9665687   2.7905629 ]
  [Layer 40] Residual connection shape: (1, 1, 2048)
  [Layer 40] Residual connection sample values: [ -5.5758405 -11.555629  -43.604626    8.168514   25.571545 ]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.04762688 -0.09951451 -0.38040605  0.06977259  0.21949916]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04762688 -0.09951451 -0.38040605  0.06977259  0.21949916]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04762688 -0.09951451 -0.38040605  0.06977259  0.21949916]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.72799563  0.29288054 -0.59774774 -0.12062596 -0.24668671]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.72799563  0.29288054 -0.59774774 -0.12062596 -0.24668671]
  [FlaxMamba2] xBC (step) sample values: [ 0.79864335 -0.04639884  1.0423224   0.1872408  -0.18982473]
  [FlaxMamba2] dt (step) sample values: [1.0577462  1.780896   1.5142113  0.24457324 1.8489115 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.30033192 -0.72513354  0.3270118   0.79864335 -0.39496836]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.13953513  0.00895337  0.21989632  0.05013009 -0.0279683 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.15288657 -0.00504656  0.2219944   0.04339334 -0.04355515]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07061107 -0.00251692  0.12326723  0.02216734 -0.02130339]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07061107 -0.00251692  0.12326723  0.02216734 -0.02130339]
  [FlaxMamba2] B (step) sample values: [-0.01426549 -0.05088155 -0.04132279 -0.2722954   0.31163815]
  [FlaxMamba2] C (step) sample values: [-0.0226311  -0.03453698 -0.12561741 -0.03152066 -0.05955661]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8258594 -1.8636904 -1.2829287 -1.4542811 -4.4079003]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10391397 0.1733658  0.03233238 0.05245576 0.03988017]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8271805  0.72390133 0.9593684  0.9265517  0.83879596]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07061107 -0.00251692  0.12326723  0.02216734 -0.02130339]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00010467  0.00037334  0.0003032   0.00199796 -0.00228664]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00010467  0.00037334  0.0003032   0.00199796 -0.00228664]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00038725  0.00057204 -0.00077064  0.00362687 -0.00427091]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0088615   0.00081556  0.02191053  0.00490869 -0.01078342]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07768488 -0.00163764  0.14205696  0.02651481 -0.03154746]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07768488 -0.00163764  0.14205696  0.02651481 -0.03154746]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.03813822 -0.00027469 -0.03013259 -0.00150285  0.00341364]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-1.4852809  -0.01069152 -1.154299   -0.06047682  0.10705967]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-1.4852809  -0.01069152 -1.154299   -0.06047682  0.10705967]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.727045    4.3371205  -1.2116891   0.93228364 -8.62059   ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.727045    4.3371205  -1.2116891   0.93228364 -8.62059   ]
  [Layer 41] Output shape after mixer: (1, 1, 2048)
  [Layer 41] Output sample values after mixer: [ 2.727045    4.3371205  -1.2116891   0.93228364 -8.62059   ]
  [Layer 41] Residual connection shape: (1, 1, 2048)
  [Layer 41] Residual connection sample values: [ -2.8487954  -7.2185082 -44.816315    9.100798   16.950954 ]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02389309 -0.0617263  -0.37974733  0.0757792   0.14151058]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02389309 -0.0617263  -0.37974733  0.0757792   0.14151058]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02389309 -0.0617263  -0.37974733  0.0757792   0.14151058]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.20760152  0.02092119 -1.4601374  -0.15359299  0.7239904 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.20760152  0.02092119 -1.4601374  -0.15359299  0.7239904 ]
  [FlaxMamba2] xBC (step) sample values: [-0.26236737  0.12281699 -1.3534976  -1.0306977  -0.7660502 ]
  [FlaxMamba2] dt (step) sample values: [ 1.91416    0.769115   1.93376   -1.0713165  2.3316767]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.22297688  0.6472919   0.08567549 -0.26236737 -0.35297105]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.036214   -0.02015551 -0.1951014   0.13552698 -0.12479907]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04554475 -0.03336962 -0.18505348  0.13905367 -0.14474231]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02225388 -0.01640645 -0.08398989  0.07435304 -0.0671427 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02225388 -0.01640645 -0.08398989  0.07435304 -0.0671427 ]
  [FlaxMamba2] B (step) sample values: [ 0.0089976   0.09860823 -0.0072194  -0.12234714  0.34553948]
  [FlaxMamba2] C (step) sample values: [-0.07967053  0.02039942  0.05514263 -0.10338712 -0.27452993]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.06612   -1.4514434 -0.7269863 -1.9455162 -0.6256312]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.13658002 0.31950533 0.02361112 0.00935633 0.1107194 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8644942 0.6289246 0.9829815 0.9819618 0.9330752]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02225388 -0.01640645 -0.08398989  0.07435304 -0.0671427 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.7347631e-05 -2.9971337e-04  2.1942900e-05  3.7186628e-04
 -1.0502450e-03]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.7347631e-05 -2.9971337e-04  2.1942900e-05  3.7186628e-04
 -1.0502450e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.5569002e-04 -2.6949507e-05 -2.5925480e-04  6.2056584e-04
 -5.7731988e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00086717 -0.00228646 -0.00346056  0.00486819 -0.00118496]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02319848 -0.01875    -0.08774269  0.07947994 -0.06856128]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02319848 -0.01875    -0.08774269  0.07947994 -0.06856128]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00265708 -0.00019819  0.02414306 -0.00563595 -0.03343026]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.13430028 -0.00984748  1.2202939  -0.23577827 -1.5337846 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.13430028 -0.00984748  1.2202939  -0.23577827 -1.5337846 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 5.3399973 -4.837529  -1.0702429 -3.2926402  6.095379 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 5.3399973 -4.837529  -1.0702429 -3.2926402  6.095379 ]
  [Layer 42] Output shape after mixer: (1, 1, 2048)
  [Layer 42] Output sample values after mixer: [ 5.3399973 -4.837529  -1.0702429 -3.2926402  6.095379 ]
  [Layer 42] Residual connection shape: (1, 1, 2048)
  [Layer 42] Residual connection sample values: [  2.4912019 -12.056038  -45.88656     5.8081574  23.046333 ]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01961667 -0.09954084 -0.3624475   0.04651483  0.17997658]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01961667 -0.09954084 -0.3624475   0.04651483  0.17997658]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01961667 -0.09954084 -0.3624475   0.04651483  0.17997658]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.13055772 -0.452125   -1.2797915   1.0297947  -0.6447906 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.13055772 -0.452125   -1.2797915   1.0297947  -0.6447906 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.78150445  0.13367744 -0.4885729   0.6066614   0.08526943]
  [FlaxMamba2] dt (step) sample values: [1.1389635  1.6491462  0.15305133 1.2893008  0.3944244 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.57381314 0.12404744 0.9579304  0.78150445 0.55972975]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12401928  0.01060115 -0.08496548 -0.12359795 -0.00875588]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.12044872 -0.03508367 -0.07249142 -0.11769661 -0.01757546]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.06384696 -0.01723415 -0.03493254 -0.05538918 -0.00871051]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06384696 -0.01723415 -0.03493254 -0.05538918 -0.00871051]
  [FlaxMamba2] B (step) sample values: [-0.07032321 -0.16037363  0.825284    0.00525054  0.27021644]
  [FlaxMamba2] C (step) sample values: [-0.24604858 -0.05881269 -0.27397794 -0.1418813  -0.14041361]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9761645 -1.478265  -1.0588893 -1.0815219 -5.9141264]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01258627 0.07517796 0.0095007  0.02482771 0.0784384 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9877889  0.8948198  0.98999023 0.9735056  0.62882984]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06384696 -0.01723415 -0.03493254 -0.05538918 -0.00871051]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.6511395e-05 -1.2887549e-04  6.6319428e-04  4.2193074e-06
  2.1714464e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.6511395e-05 -1.2887549e-04  6.6319428e-04  4.2193074e-06
  2.1714464e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0001465  -0.00131563  0.01014207  0.00019742  0.00015312]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00434083 -0.00443606 -0.00700659 -0.00505764  0.0002305 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.05978341 -0.01940162 -0.03734084 -0.05315577 -0.00733341]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.05978341 -0.01940162 -0.03734084 -0.05315577 -0.00733341]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00415699  0.00341103  0.01039809 -0.04033625  0.00162739]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.23169605  0.14583288  0.41725272 -1.7845521   0.08303398]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.23169605  0.14583288  0.41725272 -1.7845521   0.08303398]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [4.2824516 6.313245  4.8818126 8.32875   5.2703004]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [4.2824516 6.313245  4.8818126 8.32875   5.2703004]
  [Layer 43] Output shape after mixer: (1, 1, 2048)
  [Layer 43] Output sample values after mixer: [4.2824516 6.313245  4.8818126 8.32875   5.2703004]
  [Layer 43] Residual connection shape: (1, 1, 2048)
  [Layer 43] Residual connection sample values: [  6.7736535  -5.742793  -41.004745   14.136908   28.316633 ]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05049738 -0.04450348 -0.308549    0.10484244  0.21088018]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05049738 -0.04450348 -0.308549    0.10484244  0.21088018]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05049738 -0.04450348 -0.308549    0.10484244  0.21088018]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.17228442 -2.5767076  -1.1988956   0.53065896 -0.91599464]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.17228442 -2.5767076  -1.1988956   0.53065896 -0.91599464]
  [FlaxMamba2] xBC (step) sample values: [-0.74250704  0.67951876 -0.3842047  -0.75536937 -0.8289321 ]
  [FlaxMamba2] dt (step) sample values: [2.1888719 1.6420157 1.7170278 2.3071985 1.983098 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.21585748  0.30552325 -0.94895405 -0.74250704 -0.09480459]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.14030538 -0.08975153 -0.05208709 -0.18083128  0.09965551]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.14641272 -0.02932672 -0.07055023 -0.18738112  0.04716527]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06785674 -0.01444836 -0.0340313  -0.08493823  0.02413868]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06785674 -0.01444836 -0.0340313  -0.08493823  0.02413868]
  [FlaxMamba2] B (step) sample values: [-0.27764106  0.04908841  0.00200081  0.0175398   0.01017767]
  [FlaxMamba2] C (step) sample values: [-0.26177245 -0.01291481 -0.04461624  0.14903213 -0.09116263]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.74823433 -0.64391696 -1.1771379  -1.350584   -1.0269372 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.18029241 0.07551097 0.06047356 0.09499271 0.24266411]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8738024  0.95254034 0.9312889  0.8795933  0.7794234 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06785674 -0.01444836 -0.0340313  -0.08493823  0.02413868]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.3966764e-03 -6.0055038e-04 -2.4478020e-05 -2.1458288e-04
 -1.2451416e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.3966764e-03 -6.0055038e-04 -2.4478020e-05 -2.1458288e-04
 -1.2451416e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00507001 -0.00106566 -0.00036892 -0.00011158 -0.00126164]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00551395 -0.00144812 -0.00091738 -0.00814322  0.00526216]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0692563  -0.01502042 -0.03288524 -0.08793133  0.02793723]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0692563  -0.01502042 -0.03288524 -0.08793133  0.02793723]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00545324  0.00273448  0.00913388 -0.02937983 -0.00731307]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.27124456  0.10859708  0.4895236  -1.3657155  -0.36984694]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.27124456  0.10859708  0.4895236  -1.3657155  -0.36984694]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [  0.6683193   6.660744  -15.932491    4.437761   -5.9805226]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [  0.6683193   6.660744  -15.932491    4.437761   -5.9805226]
  [Layer 44] Output shape after mixer: (1, 1, 2048)
  [Layer 44] Output sample values after mixer: [  0.6683193   6.660744  -15.932491    4.437761   -5.9805226]
  [Layer 44] Residual connection shape: (1, 1, 2048)
  [Layer 44] Residual connection sample values: [  7.4419727   0.9179511 -56.937237   18.574669   22.336111 ]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05415733  0.00686377 -0.41603523  0.13297181  0.16171896]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05415733  0.00686377 -0.41603523  0.13297181  0.16171896]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05415733  0.00686377 -0.41603523  0.13297181  0.16171896]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.55848503 -0.81023747 -0.15498644  0.32713783  0.2974541 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.55848503 -0.81023747 -0.15498644  0.32713783  0.2974541 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.03926632  0.24271604 -0.70881873 -0.37597063 -2.691306  ]
  [FlaxMamba2] dt (step) sample values: [ 3.5813885   2.3979645  -0.57822174  1.1553884   2.5881577 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.13488795 -0.37752372 -0.22580063  0.03926632  0.53698236]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00151625 -0.05022335 -0.11559276 -0.08011606  0.49149817]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00306139  0.00199223 -0.1180437  -0.08670022  0.48899573]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00152835  0.00099711 -0.05554231 -0.04147206  0.3031137 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00152835  0.00099711 -0.05554231 -0.04147206  0.3031137 ]
  [FlaxMamba2] B (step) sample values: [-0.05923345  0.11080218 -0.02457774 -0.21246026 -0.01231719]
  [FlaxMamba2] C (step) sample values: [-0.05171626  0.19606593  0.06840792 -0.19502755 -0.15826848]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.250236  -4.181475  -1.0937363 -2.677446  -2.3148744]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.23085898 0.2241379  0.01093991 0.03949382 0.07142043]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.5948255  0.39171252 0.9881059  0.89965624 0.8476145 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00152835  0.00099711 -0.05554231 -0.04147206  0.3031137 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.0899528e-05 -3.9094692e-05  8.6718428e-06  7.4963042e-05
  4.3459140e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.0899528e-05 -3.9094692e-05  8.6718428e-06  7.4963042e-05
  4.3459140e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 4.0817141e-04 -3.0419895e-05 -9.4733950e-06  9.1148366e-04
  1.1560976e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00184659 -0.00054744 -0.01041988 -0.00769324  0.05376109]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00356114  0.00057115 -0.07272919 -0.05421805  0.3938047 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00356114  0.00057115 -0.07272919 -0.05421805  0.3938047 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00126511 -0.00014246  0.00520014 -0.01030618  0.0672166 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.06778019 -0.0055346   0.25602865 -0.4645241   3.2492366 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.06778019 -0.0055346   0.25602865 -0.4645241   3.2492366 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 5.692042   1.2223648 -8.109914   3.628216   7.3178368]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 5.692042   1.2223648 -8.109914   3.628216   7.3178368]
  [Layer 45] Output shape after mixer: (1, 1, 2048)
  [Layer 45] Output sample values after mixer: [ 5.692042   1.2223648 -8.109914   3.628216   7.3178368]
  [Layer 45] Residual connection shape: (1, 1, 2048)
  [Layer 45] Residual connection sample values: [ 13.134014   2.140316 -65.04715   22.202885  29.653948]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.10933248  0.01856983 -0.55154675  0.18685621  0.2451813 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10933248  0.01856983 -0.55154675  0.18685621  0.2451813 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10933248  0.01856983 -0.55154675  0.18685621  0.2451813 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.0146699  -0.6297357   0.23468542  0.7539782  -0.8062636 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.0146699  -0.6297357   0.23468542  0.7539782  -0.8062636 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.28203216  0.5911005   0.5946512  -1.3155112  -0.2558238 ]
  [FlaxMamba2] dt (step) sample values: [ 1.2695321   1.7020826   0.48468614  1.6759554  -0.01217464]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.26237017  0.3332455   0.19496793  0.28203216 -0.99083877]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.05122709  0.09192056  0.09662931  0.18382907  0.0431882 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.05436468  0.08812112  0.07552641  0.16799045  0.06349765]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02644364  0.04600064  0.03918859  0.09103387  0.03275647]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02644364  0.04600064  0.03918859  0.09103387  0.03275647]
  [FlaxMamba2] B (step) sample values: [-0.059433   -0.27479064 -0.02466202  0.02936737  0.00311269]
  [FlaxMamba2] C (step) sample values: [-0.04913526 -0.2709189   0.11454007  0.13767989  0.31806052]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8673339  -0.9793274  -1.6584101  -0.94076145 -0.4381494 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01070967 0.03076711 0.0102647  0.05406305 0.00871163]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9802001  0.9703183  0.983121   0.9504113  0.99619025]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02644364  0.04600064  0.03918859  0.09103387  0.03275647]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.6831576e-05  7.7821409e-05  6.9843472e-06 -8.3169125e-06
 -8.8152115e-07]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.6831576e-05  7.7821409e-05  6.9843472e-06 -8.3169125e-06
 -8.8152115e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.4718076e-05  6.5671006e-04 -4.3343171e-05  1.4678848e-05
 -1.3811680e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00064784  0.0002179   0.00020487  0.00118722  0.00057308]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02176189  0.03694734  0.03149519  0.07387366  0.02672765]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02176189  0.03694734  0.03149519  0.07387366  0.02672765]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00016079 -0.00808694  0.00412742  0.03787791 -0.00665207]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00702253 -0.33719146  0.15546104  1.3205191  -0.28321266]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00702253 -0.33719146  0.15546104  1.3205191  -0.28321266]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.4068449  7.289065  -1.7286416 -5.6941414 -6.29642  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.4068449  7.289065  -1.7286416 -5.6941414 -6.29642  ]
  [Layer 46] Output shape after mixer: (1, 1, 2048)
  [Layer 46] Output sample values after mixer: [ 0.4068449  7.289065  -1.7286416 -5.6941414 -6.29642  ]
  [Layer 46] Residual connection shape: (1, 1, 2048)
  [Layer 46] Residual connection sample values: [ 13.540859   9.42938  -66.775795  16.508743  23.357529]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.09737092  0.06845085 -0.4657862   0.11656656  0.15709439]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09737092  0.06845085 -0.4657862   0.11656656  0.15709439]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09737092  0.06845085 -0.4657862   0.11656656  0.15709439]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.655962    0.39681968 -0.706197   -0.88907784  0.19367625]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.655962    0.39681968 -0.706197   -0.88907784  0.19367625]
  [FlaxMamba2] xBC (step) sample values: [-0.08903592  2.019093    0.72988683  0.67300457  0.21799524]
  [FlaxMamba2] dt (step) sample values: [ 1.3744096  -0.38724035  2.258225    0.931374    2.0351477 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.02679448  0.22775415  0.22847776 -0.08903592  1.6558968 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01267117 -0.05477441  0.06883495 -0.11589149  0.03131736]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.02977627 -0.07967675 -0.15064748 -0.11927131  0.03649391]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01510978 -0.03825212 -0.06966078 -0.05608345  0.01857987]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01510978 -0.03825212 -0.06966078 -0.05608345  0.01857987]
  [FlaxMamba2] B (step) sample values: [-0.19285113 -0.02828134 -0.22485502 -0.25734165  0.06033374]
  [FlaxMamba2] C (step) sample values: [ 0.6727022   0.23975839 -0.02681324 -0.23678724  0.10696517]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -3.552239  -11.244981   -2.6866128  -3.193549   -3.1997924]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08562559 0.01033623 0.02445166 0.00925463 0.08567334]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.73774093 0.8902699  0.93641907 0.9708774  0.760228  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01510978 -0.03825212 -0.06966078 -0.05608345  0.01857987]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.4950760e-04 -3.6589932e-05 -2.9091371e-04 -3.3294436e-04
  7.8058794e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.4950760e-04 -3.6589932e-05 -2.9091371e-04 -3.3294436e-04
  7.8058794e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00068229 -0.00021404 -0.0015932  -0.00095354  0.00020428]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00107874 -0.00302831 -0.00505456 -0.00230808  0.0001147 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02244123 -0.05710988 -0.1035423  -0.08159994  0.02638327]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02244123 -0.05710988 -0.1035423  -0.08159994  0.02638327]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00502925 -0.01355033  0.02416217  0.02113345  0.00280155]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.21299595 -0.34395924  1.0037129   0.9170604   0.11659453]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.21299595 -0.34395924  1.0037129   0.9170604   0.11659453]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 6.620833  8.1563   -3.026394  7.160154 12.127894]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 6.620833  8.1563   -3.026394  7.160154 12.127894]
  [Layer 47] Output shape after mixer: (1, 1, 2048)
  [Layer 47] Output sample values after mixer: [ 6.620833  8.1563   -3.026394  7.160154 12.127894]
  [Layer 47] Residual connection shape: (1, 1, 2048)
  [Layer 47] Residual connection sample values: [ 20.161692  17.58568  -69.802185  23.668898  35.485424]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13761215  0.11208005 -0.43487546  0.15213159  0.21520384]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13761215  0.11208005 -0.43487546  0.15213159  0.21520384]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13761215  0.11208005 -0.43487546  0.15213159  0.21520384]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.38357693 -1.5550652   0.79010457 -0.01287497 -0.55048376]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.38357693 -1.5550652   0.79010457 -0.01287497 -0.55048376]
  [FlaxMamba2] xBC (step) sample values: [ 1.0177499   1.0137882  -0.43141022 -0.39385828 -0.43144727]
  [FlaxMamba2] dt (step) sample values: [0.7198476 1.6694491 1.0263369 1.0748703 0.3951591]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.7010987   0.03665016  0.37658596  1.0177499  -0.03854591]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.17417619  0.11158346 -0.06038003 -0.10223482  0.06733682]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.17934892  0.33155417 -0.1462565  -0.16851899  0.0648916 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.08165444  0.1930101  -0.06779002 -0.07717658  0.03349816]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08165444  0.1930101  -0.06779002 -0.07717658  0.03349816]
  [FlaxMamba2] B (step) sample values: [-0.1002028  -0.0104519  -0.0040147  -0.02630801 -0.11505488]
  [FlaxMamba2] C (step) sample values: [-0.13460855 -0.2743273   0.04370249 -0.21167357 -0.06306148]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-54.81184   -78.514336  -47.25076    -2.330753   -4.2266355]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06238699 0.04595112 0.01129694 0.00320469 0.01114087]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.03272731 0.02711083 0.586379   0.9925585  0.9540031 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08165444  0.1930101  -0.06779002 -0.07717658  0.03349816]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [5.1045051e-04 5.3243810e-05 2.0451602e-05 1.3401758e-04 5.8610964e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [5.1045051e-04 5.3243810e-05 2.0451602e-05 1.3401758e-04 5.8610964e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [5.1871914e-04 4.9779650e-05 2.3808343e-05 1.3784054e-04 5.9154513e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00194774  0.00464156 -0.00163699 -0.00189064  0.00079738]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.06696334  0.15832174 -0.05561335 -0.06334084  0.02746958]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.06696334  0.15832174 -0.05561335 -0.06334084  0.02746958]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01527613 -0.04292653 -0.03022454  0.00040513 -0.00553074]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.85314935 -1.9647493  -1.4316279   0.02198887 -0.33418477]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.85314935 -1.9647493  -1.4316279   0.02198887 -0.33418477]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [  1.1033069  -7.2080812 -21.840277   15.106547   19.017097 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [  1.1033069  -7.2080812 -21.840277   15.106547   19.017097 ]
  [Layer 48] Output shape after mixer: (1, 1, 2048)
  [Layer 48] Output sample values after mixer: [  1.1033069  -7.2080812 -21.840277   15.106547   19.017097 ]
  [Layer 48] Residual connection shape: (1, 1, 2048)
  [Layer 48] Residual connection sample values: [ 21.265     10.377599 -91.64246   38.775444  54.50252 ]
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.1442479   0.07786006 -0.63308406  0.27317038  0.36614534]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Final backbone norm output sample values: [ 0.1442479   0.07786006 -0.63308406  0.27317038  0.36614534]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 1, 50288)
[Mamba2LMHeadModel] Logits sample values: [ 1.8120631 -9.749964   1.4387654  1.8303242 -0.7135459]
[Mamba2LMHeadModel] Forward pass input_ids shape: (1, 1)
[Mamba2LMHeadModel] input_ids sample values: [5962]
[Mamba2LMHeadModel] Embedding output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Embedding sample values: [-0.29077148 -0.09613037 -0.2993164   0.01261902 -0.31445312]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.30592814 -0.11444563 -0.325329    0.0137157  -0.335857  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.30592814 -0.11444563 -0.325329    0.0137157  -0.335857  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.30592814 -0.11444563 -0.325329    0.0137157  -0.335857  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.7497531   1.6029322  -0.11934234  0.5636365  -1.0023719 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.7497531   1.6029322  -0.11934234  0.5636365  -1.0023719 ]
  [FlaxMamba2] xBC (step) sample values: [0.52318025 0.81650573 0.10996649 0.2891547  0.27641353]
  [FlaxMamba2] dt (step) sample values: [ 0.54864526  0.3115611   0.03226133 -0.01482309  0.42511535]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.20654811 -0.83976954  0.09133587  0.52318025 -0.28244972]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01140687  0.08731642  0.07884957  0.1305375  -0.25833666]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.21637633  0.30264845  0.34911323  0.17973183 -0.5151726 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.11984739  0.17405005  0.20472088  0.09792013 -0.19266514]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.11984739  0.17405005  0.20472088  0.09792013 -0.19266514]
  [FlaxMamba2] B (step) sample values: [ 0.21710059  0.43068582 -0.2775326  -0.27701452 -0.01638053]
  [FlaxMamba2] C (step) sample values: [-0.04922876  0.6244883  -0.26520535 -0.16484605 -0.10845209]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.617978  -2.5226073 -3.0473056 -3.307819  -3.9089987]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01569325 0.01848741 0.00935692 0.02408637 0.01112654]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9597479  0.95443434 0.97188926 0.9234179  0.95743865]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.11984739  0.17405005  0.20472088  0.09792013 -0.19266514]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.0832179e-04  8.1003195e-04 -5.2198209e-04 -5.2100763e-04
 -3.0808427e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.0832179e-04  8.1003195e-04 -5.2198209e-04 -5.2100763e-04
 -3.0808427e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00218154  0.00118782 -0.00264918 -0.00282447  0.00049052]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.06894553  0.06989646  0.08682631  0.00877533 -0.06743355]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.11465265  0.13627526  0.16490227  0.04611988 -0.14091173]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.11465265  0.13627526  0.16490227  0.04611988 -0.14091173]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0275828   0.18183553 -0.00925345  0.01656635  0.03792105]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.04971511  0.35299942 -0.0142295   0.04928937  0.06961568]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.04971511  0.35299942 -0.0142295   0.04928937  0.06961568]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.36136925  0.5234629  -0.14604315 -0.5957447   0.2582246 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.36136925  0.5234629  -0.14604315 -0.5957447   0.2582246 ]
  [Layer 1] Output shape after mixer: (1, 1, 2048)
  [Layer 1] Output sample values after mixer: [-0.36136925  0.5234629  -0.14604315 -0.5957447   0.2582246 ]
  [Layer 1] Residual connection shape: (1, 1, 2048)
  [Layer 1] Residual connection sample values: [-0.65214074  0.42733252 -0.44535956 -0.5831257  -0.05622852]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.5088447   0.2633204  -0.32024497 -0.43930495 -0.04138153]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.5088447   0.2633204  -0.32024497 -0.43930495 -0.04138153]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.5088447   0.2633204  -0.32024497 -0.43930495 -0.04138153]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.4347278  -0.38902184 -1.7394037  -2.3141325   0.35511962]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.4347278  -0.38902184 -1.7394037  -2.3141325   0.35511962]
  [FlaxMamba2] xBC (step) sample values: [ 0.35165885  0.28777426 -0.69305956  4.289652   -0.21933562]
  [FlaxMamba2] dt (step) sample values: [0.94922954 1.5420043  0.86174625 1.2401893  2.5306158 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.82048094  1.0773478   0.12975971  0.35165885  0.43783474]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01764924 -0.22803868  0.08335168 -2.6716895   0.07693482]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01216644 -0.38257968  0.07283837 -1.6179786   0.06380463]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00604621 -0.15513793  0.03774496 -0.2677493   0.03291973]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00604621 -0.15513793  0.03774496 -0.2677493   0.03291973]
  [FlaxMamba2] B (step) sample values: [ 0.2519573  -0.03509481  0.03957997 -0.25622305  0.22799231]
  [FlaxMamba2] C (step) sample values: [ 0.23296432 -0.2375302  -0.14336929 -0.24641612 -0.2597979 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-19.851534   -18.68525    -13.564036    -2.4188707   -0.46617994]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01566589 0.02904355 0.04926009 0.02506131 0.17146555]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7327198  0.5811851  0.51264805 0.94118077 0.9231775 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00604621 -0.15513793  0.03774496 -0.2677493   0.03291973]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.3865216e-05  3.3241554e-06 -3.7489870e-06  2.4269266e-05
 -2.1595270e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.3865216e-05  3.3241554e-06 -3.7489870e-06  2.4269266e-05
 -2.1595270e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00047886 -0.00018608  0.0001035  -0.00198076  0.00159108]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00391877 -0.03194988 -0.01756948 -0.04022858 -0.00267973]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00025522 -0.13904889  0.00848764 -0.22506851  0.0200463 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00025522 -0.13904889  0.00848764 -0.22506851  0.0200463 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 7.0437854e-05  2.1851040e-02 -2.2054897e-03  4.6854235e-02
  4.1848682e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 3.2365242e-05  4.7498145e-03 -1.0734168e-03  9.2325807e-03
  2.0648884e-03]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 3.2365242e-05  4.7498145e-03 -1.0734168e-03  9.2325807e-03
  2.0648884e-03]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.02942324  0.02103212 -0.0163385  -0.07172876  0.12669802]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.02942324  0.02103212 -0.0163385  -0.07172876  0.12669802]
  [Layer 2] Output shape after mixer: (1, 1, 2048)
  [Layer 2] Output sample values after mixer: [-0.02942324  0.02103212 -0.0163385  -0.07172876  0.12669802]
  [Layer 2] Residual connection shape: (1, 1, 2048)
  [Layer 2] Residual connection sample values: [-0.681564    0.44836465 -0.46169806 -0.6548545   0.0704695 ]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.5426443   0.27911493 -0.32931578 -0.48058087  0.05562209]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.5426443   0.27911493 -0.32931578 -0.48058087  0.05562209]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.5426443   0.27911493 -0.32931578 -0.48058087  0.05562209]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.59203297 -1.4523484  -3.294617    0.28034955  0.17493746]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.59203297 -1.4523484  -3.294617    0.28034955  0.17493746]
  [FlaxMamba2] xBC (step) sample values: [ 0.42976293 -0.24531002 -0.19813702 -0.02303142  0.46965396]
  [FlaxMamba2] dt (step) sample values: [1.5942354  0.9443001  1.4660562  2.2575977  0.92700523]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 2.6808503  -2.0851595  -0.9023777   0.42976293 -1.8550179 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.23471698  0.31545895 -0.2068964  -0.40672168  0.10229637]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.23316821  0.2961566  -0.08323917 -0.4190584   0.08599998]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.13011472  0.16984661 -0.03988839 -0.16625811  0.04484785]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.13011472  0.16984661 -0.03988839 -0.16625811  0.04484785]
  [FlaxMamba2] B (step) sample values: [ 0.34864086  0.15618268 -0.1701338   0.00780884 -0.03477409]
  [FlaxMamba2] C (step) sample values: [ 0.41866496 -0.15908876  1.1369741  -0.0686158   0.6183784 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6505536 -3.9938898 -6.780579  -0.9418818 -6.0307717]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0406203  0.05159046 0.05772822 0.06102288 0.05391294]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9739204  0.81379515 0.67608887 0.94414425 0.7224287 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.13011472  0.16984661 -0.03988839 -0.16625811  0.04484785]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.8426713e-03  8.2547218e-04 -8.9920807e-04  4.1272058e-05
 -1.8379150e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.8426713e-03  8.2547218e-04 -8.9920807e-04  4.1272058e-05
 -1.8379150e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.0942287e-03 -1.7663289e-05  3.3806392e-03 -6.7244185e-04
  1.0023013e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00251045  0.16821958  0.13202275 -0.02813755 -0.01997089]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.05672722  0.24554609  0.11386266 -0.10383031  0.00044711]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.05672722  0.24554609  0.11386266 -0.10383031  0.00044711]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-1.1961700e-02 -6.7629270e-02 -1.3413407e-02 -1.6581291e-02
  4.2519947e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-5.2396930e-03 -3.2302283e-02 -5.1632789e-03 -9.7776540e-03
  1.4448717e-05]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-5.2396930e-03 -3.2302283e-02 -5.1632789e-03 -9.7776540e-03
  1.4448717e-05]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.0387418  -0.07785054  0.02066911  0.00856698 -0.05005719]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.0387418  -0.07785054  0.02066911  0.00856698 -0.05005719]
  [Layer 3] Output shape after mixer: (1, 1, 2048)
  [Layer 3] Output sample values after mixer: [ 0.0387418  -0.07785054  0.02066911  0.00856698 -0.05005719]
  [Layer 3] Residual connection shape: (1, 1, 2048)
  [Layer 3] Residual connection sample values: [-0.64282215  0.3705141  -0.44102895 -0.6462875   0.02041231]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.5504366   0.2402713  -0.33359948 -0.5056468   0.01753353]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.5504366   0.2402713  -0.33359948 -0.5056468   0.01753353]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.5504366   0.2402713  -0.33359948 -0.5056468   0.01753353]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.9284054   0.733632   -2.4356828   0.92297244 -0.63028413]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.9284054   0.733632   -2.4356828   0.92297244 -0.63028413]
  [FlaxMamba2] xBC (step) sample values: [-0.09687654  1.8117951  -0.2202234   0.6599811  -0.8426389 ]
  [FlaxMamba2] dt (step) sample values: [0.91750234 2.762223   1.6039976  1.6751842  0.11547301]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.00505049  1.1195325   0.6362446  -0.09687654 -0.23636058]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.04776441  0.10199334  0.06558581 -0.09062433  0.20164868]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.12155591  0.06683709  0.01736803 -0.1064477   0.49461743]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.05708854  0.03453493  0.00875943 -0.05039375  0.30725318]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05708854  0.03453493  0.00875943 -0.05039375  0.30725318]
  [FlaxMamba2] B (step) sample values: [ 0.633142    0.03850235 -0.10720337  0.0330845   0.69006574]
  [FlaxMamba2] C (step) sample values: [ 0.73488355 -0.27548298 -0.03428613 -0.27799395  0.15142418]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.7127254  -1.2862217  -1.4869522 -27.028044   -4.0726624]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0152985  0.03748105 0.00948012 0.01718209 0.04243733]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.97413814 0.9529347  0.9860024  0.6285132  0.8412782 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05708854  0.03453493  0.00875943 -0.05039375  0.30725318]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.5296667e-04 -3.3626762e-05  9.3628114e-05 -2.8894981e-05
 -6.0268212e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.5296667e-04 -3.3626762e-05  9.3628114e-05 -2.8894981e-05
 -6.0268212e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.3219083e-03 -1.3206479e-03 -4.0956546e-04 -7.6475641e-05
 -7.7590672e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00483789  0.03500134 -0.02107218 -0.02749616  0.16072401]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03697173  0.05444027 -0.01614169 -0.05586165  0.3336698 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03697173  0.05444027 -0.01614169 -0.05586165  0.3336698 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00972243  0.02698294  0.00316462 -0.03689789 -0.07307028]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00498432  0.00888811  0.00159509 -0.01567212 -0.01852012]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00498432  0.00888811  0.00159509 -0.01567212 -0.01852012]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.03412481 -0.24322197  0.15686731  0.02809519  0.05793851]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.03412481 -0.24322197  0.15686731  0.02809519  0.05793851]
  [Layer 4] Output shape after mixer: (1, 1, 2048)
  [Layer 4] Output sample values after mixer: [ 0.03412481 -0.24322197  0.15686731  0.02809519  0.05793851]
  [Layer 4] Residual connection shape: (1, 1, 2048)
  [Layer 4] Residual connection sample values: [-0.60869735  0.12729213 -0.28416163 -0.6181923   0.07835081]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.40521437  0.07002795 -0.17668687 -0.3941746   0.05382306]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.40521437  0.07002795 -0.17668687 -0.3941746   0.05382306]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.40521437  0.07002795 -0.17668687 -0.3941746   0.05382306]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.7324415   3.701013   -0.73071593 -0.8016754  -0.21181726]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.7324415   3.701013   -0.73071593 -0.8016754  -0.21181726]
  [FlaxMamba2] xBC (step) sample values: [-0.33975518  3.8007505   2.747742    0.8532063  -0.84500676]
  [FlaxMamba2] dt (step) sample values: [ 2.0062892   1.024348    0.93957585 -0.3877611   0.62523586]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.27706146 -0.48543358 -0.02045043 -0.33975518 -0.13449931]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02309791  0.3023354  -0.63102806  0.2104956  -0.4191063 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.07467262  0.2650124  -0.7005471   0.18437256 -0.4249695 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03594296  0.14996207 -0.23236512  0.10066059 -0.16800243]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03594296  0.14996207 -0.23236512  0.10066059 -0.16800243]
  [FlaxMamba2] B (step) sample values: [-0.02172479  0.00917138 -0.18957162 -0.03727496  0.08927356]
  [FlaxMamba2] C (step) sample values: [-0.09826106  0.06730233  0.04652255  1.4155434   0.18093371]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.5762966   -1.0443833   -0.83880144  -5.6764617  -20.401838  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0285839  0.0331623  0.10517354 0.00944736 0.00636059]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9559433  0.9659587  0.9155597  0.947785   0.87829936]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03594296  0.14996207 -0.23236512  0.10066059 -0.16800243]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.2319826e-05 -9.4225843e-06  1.9476394e-04  3.8295908e-05
 -9.1718743e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.2319826e-05 -9.4225843e-06  1.9476394e-04  3.8295908e-05
 -9.1718743e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00024162 -0.00011463  0.00060577  0.00023313 -0.00047934]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00398265  0.00175788 -0.02006401 -0.0030098  -0.0152905 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02330302  0.08236678 -0.1449669   0.05109815 -0.1055966 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02330302  0.08236678 -0.1449669   0.05109815 -0.1055966 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00606679  0.2974929   0.03443111 -0.01268525  0.01000356]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.004217    0.21089596  0.02324911 -0.00896533  0.00626672]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.004217    0.21089596  0.02324911 -0.00896533  0.00626672]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.3488964  -0.05659286 -0.04083141 -0.03267307  0.17915024]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.3488964  -0.05659286 -0.04083141 -0.03267307  0.17915024]
  [Layer 5] Output shape after mixer: (1, 1, 2048)
  [Layer 5] Output sample values after mixer: [ 0.3488964  -0.05659286 -0.04083141 -0.03267307  0.17915024]
  [Layer 5] Residual connection shape: (1, 1, 2048)
  [Layer 5] Residual connection sample values: [-0.25980094  0.07069927 -0.32499304 -0.6508654   0.25750107]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.14254725  0.03002287 -0.1582623  -0.32763657  0.14332049]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.14254725  0.03002287 -0.1582623  -0.32763657  0.14332049]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.14254725  0.03002287 -0.1582623  -0.32763657  0.14332049]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 2.4529088   0.2748492  -1.7074909   3.6834674  -0.50308156]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 2.4529088   0.2748492  -1.7074909   3.6834674  -0.50308156]
  [FlaxMamba2] xBC (step) sample values: [ 0.05953435  0.23240817 -2.3873868   1.1489784   0.15220486]
  [FlaxMamba2] dt (step) sample values: [1.7275343  1.8058829  0.3597977  0.32378352 0.8971164 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.38086557 -0.996089    0.45463678  0.05953435 -1.1709539 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02509855  0.06213782 -1.6938547  -0.17284921 -0.0581498 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.00926425 -0.01018884 -1.756019   -0.11074594  0.01155235]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00465358 -0.00506847 -0.2586434  -0.05230993  0.00580954]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00465358 -0.00506847 -0.2586434  -0.05230993  0.00580954]
  [FlaxMamba2] B (step) sample values: [ 0.03380083  0.04437822 -0.20642178 -0.01649704  0.21711004]
  [FlaxMamba2] C (step) sample values: [-0.20930281 -0.05889069 -0.2780312   0.49269652  0.3479314 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.98658675 -8.774721   -3.3045902  -2.9912853  -3.3435438 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05208536 0.08077976 0.11819397 0.09007272 0.07131104]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.94991124 0.49222475 0.6766625  0.7638123  0.7878626 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00465358 -0.00506847 -0.2586434  -0.05230993  0.00580954]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.1927601e-06  1.0756546e-05 -5.0033213e-05 -3.9986094e-06
  5.2623873e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.1927601e-06  1.0756546e-05 -5.0033213e-05 -3.9986094e-06
  5.2623873e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01812914 -0.00051498 -0.01049056 -0.00117684  0.00397868]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.07753199 -0.13989307 -0.16596346  0.00325086 -0.1840674 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.07853973 -0.14099066 -0.22197342 -0.008077   -0.18280932]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.07853973 -0.14099066 -0.22197342 -0.008077   -0.18280932]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.17738783 -0.02202163  0.0581752  -0.0290219   0.03465508]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.13939154 -0.00810687  0.02035871 -0.01320559  0.01113092]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.13939154 -0.00810687  0.02035871 -0.01320559  0.01113092]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.07038251  0.11536738 -0.19479343 -0.14822309  0.09276946]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.07038251  0.11536738 -0.19479343 -0.14822309  0.09276946]
  [Layer 6] Output shape after mixer: (1, 1, 2048)
  [Layer 6] Output sample values after mixer: [ 0.07038251  0.11536738 -0.19479343 -0.14822309  0.09276946]
  [Layer 6] Residual connection shape: (1, 1, 2048)
  [Layer 6] Residual connection sample values: [-0.18941844  0.18606666 -0.5197865  -0.7990885   0.3502705 ]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.08249282  0.06730478 -0.2098519  -0.31863898  0.1530288 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.08249282  0.06730478 -0.2098519  -0.31863898  0.1530288 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.08249282  0.06730478 -0.2098519  -0.31863898  0.1530288 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.176013    0.09745101 -1.2726275  -0.79746443 -1.8163916 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.176013    0.09745101 -1.2726275  -0.79746443 -1.8163916 ]
  [FlaxMamba2] xBC (step) sample values: [-1.787138    0.1545884  -0.01594557 -1.2577735   0.07350454]
  [FlaxMamba2] dt (step) sample values: [1.0054107 0.4308493 1.5817457 0.9045045 1.806754 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.8322127 -2.4475067 -1.9761943 -1.787138  -1.0545921]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01608853 -0.04909634  0.13749984 -0.22679667 -0.20003712]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.08420376 -0.02446865  0.13674977 -0.22037272 -0.20363057]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04033036 -0.01208465  0.07304274 -0.09809422 -0.0914846 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04033036 -0.01208465  0.07304274 -0.09809422 -0.0914846 ]
  [FlaxMamba2] B (step) sample values: [0.14509135 0.01677942 0.02123344 0.02946652 0.0129872 ]
  [FlaxMamba2] C (step) sample values: [ 0.13747524 -0.04501637 -0.03105899 -0.114483    0.0417015 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.29588825 -1.1836219  -0.3113019  -0.1314279  -1.5015444 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04701671 0.00921389 0.01221808 0.03668814 0.00652283]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.98618466 0.9891535  0.9962037  0.9951898  0.9902535 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04033036 -0.01208465  0.07304274 -0.09809422 -0.0914846 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.7512232e-04 -3.1817148e-05 -4.0262865e-05 -5.5874443e-05
 -2.4626330e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.7512232e-04 -3.1817148e-05 -4.0262865e-05 -5.5874443e-05
 -2.4626330e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00084521  0.00069401 -0.00128041  0.00025506 -0.00327936]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00046397 -0.00193435 -0.00077889 -0.00080706  0.00017612]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-5.5624597e-04 -1.9620024e-03 -6.1176316e-04 -1.0315068e-03
 -3.3204269e-05]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-5.5624597e-04 -1.9620024e-03 -6.1176316e-04 -1.0315068e-03
 -3.3204269e-05]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 1.5422942e-04 -1.0025401e-04  1.7035208e-04  2.5547025e-04
  8.4356780e-06]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 1.0181591e-03 -3.6861072e-04  1.4779624e-03  1.5632999e-03
  7.0475071e-05]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 1.0181591e-03 -3.6861072e-04  1.4779624e-03  1.5632999e-03
  7.0475071e-05]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.36877555  0.08214986 -0.1653376   0.31673944  0.0984785 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.36877555  0.08214986 -0.1653376   0.31673944  0.0984785 ]
  [Layer 7] Output shape after mixer: (1, 1, 2048)
  [Layer 7] Output sample values after mixer: [ 0.36877555  0.08214986 -0.1653376   0.31673944  0.0984785 ]
  [Layer 7] Residual connection shape: (1, 1, 2048)
  [Layer 7] Residual connection sample values: [ 0.17935711  0.26821652 -0.6851241  -0.48234904  0.448749  ]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.09347541  0.10940652 -0.33272022 -0.2330553   0.2327668 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09347541  0.10940652 -0.33272022 -0.2330553   0.2327668 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09347541  0.10940652 -0.33272022 -0.2330553   0.2327668 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.9267586  -2.7419136  -1.0942607  -1.8193609  -0.14606906]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.9267586  -2.7419136  -1.0942607  -1.8193609  -0.14606906]
  [FlaxMamba2] xBC (step) sample values: [ 0.36608806  1.5788927   2.0784488  -2.8813963  -0.9781299 ]
  [FlaxMamba2] dt (step) sample values: [ 1.1001667   0.40081602  1.2543423  -0.5673378  -0.02281994]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.3310088   0.33567595  0.8000778   0.36608806  0.70608675]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.0727555   0.06930253 -0.27931574 -0.1907865  -0.18998784]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.53564614  0.03828141 -0.594013   -0.2423612  -0.24610966]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.33788508  0.01950703 -0.2112991  -0.10656733 -0.10798831]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.33788508  0.01950703 -0.2112991  -0.10656733 -0.10798831]
  [FlaxMamba2] B (step) sample values: [ 0.020377    0.12500377  0.09097497 -0.07156481 -0.15004495]
  [FlaxMamba2] C (step) sample values: [ 0.04612848 -0.15763018  0.16838838 -0.04902549 -0.13815245]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.6542776 -0.9827404 -0.5549556 -3.9396574 -1.8081155]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0299391  0.07996612 0.03849774 0.01371797 0.00942626]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8963666  0.9244226  0.97886205 0.9473903  0.98310065]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.33788508  0.01950703 -0.2112991  -0.10656733 -0.10798831]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00020613  0.00126453  0.0009203  -0.00072395 -0.00151785]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00020613  0.00126453  0.0009203  -0.00072395 -0.00151785]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00093335  0.00355319  0.0002559  -0.00316012 -0.0013123 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.05907874 -0.01869949 -0.03493605 -0.01828179 -0.01714957]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.34351042 -0.00227847 -0.21280766 -0.10799017 -0.10805412]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.34351042 -0.00227847 -0.21280766 -0.10799017 -0.10805412]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.09027892  0.00037825  0.05840697  0.02741008  0.00731634]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.04987932  0.00026625  0.02794666  0.02054947  0.0065437 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.04987932  0.00026625  0.02794666  0.02054947  0.0065437 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [0.1680949  0.2265947  0.05840207 0.00256097 0.06852984]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [0.1680949  0.2265947  0.05840207 0.00256097 0.06852984]
  [Layer 8] Output shape after mixer: (1, 1, 2048)
  [Layer 8] Output sample values after mixer: [0.1680949  0.2265947  0.05840207 0.00256097 0.06852984]
  [Layer 8] Residual connection shape: (1, 1, 2048)
  [Layer 8] Residual connection sample values: [ 0.347452    0.49481124 -0.62672204 -0.47978806  0.51727885]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15833077  0.1842317  -0.2625506  -0.19301909  0.2326911 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15833077  0.1842317  -0.2625506  -0.19301909  0.2326911 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15833077  0.1842317  -0.2625506  -0.19301909  0.2326911 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.4335897  -0.6820954  -2.1759577  -1.752438   -0.98649216]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.4335897  -0.6820954  -2.1759577  -1.752438   -0.98649216]
  [FlaxMamba2] xBC (step) sample values: [ 0.7055616   0.41203526  0.5896762  -0.08124622 -0.83701766]
  [FlaxMamba2] dt (step) sample values: [1.0617273  0.66008466 2.931017   0.4167444  0.8441525 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.01195776 -0.02064419  0.32918003  0.7055616   0.60611063]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.10118547  0.06392859 -0.26979056 -0.06181321 -0.11869189]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.09383455  0.03858374 -0.35646048 -0.13572678 -0.09365222]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04471766  0.019664   -0.14679636 -0.063265   -0.04463502]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04471766  0.019664   -0.14679636 -0.063265   -0.04463502]
  [FlaxMamba2] B (step) sample values: [-0.02099037 -0.27137324  0.14759344  0.265452   -0.14243929]
  [FlaxMamba2] C (step) sample values: [-0.18764839 -0.27518734 -0.25220323 -0.20490842 -0.26363233]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-5.234511  -1.2161361 -1.4887683 -0.9523448 -3.9666808]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02893741 0.07126264 0.08642782 0.18739961 0.03620579]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8594409  0.9169842  0.8792632  0.83654994 0.86621964]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04471766  0.019664   -0.14679636 -0.063265   -0.04463502]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.7161808e-05  3.5116053e-04 -1.9098785e-04 -3.4349837e-04
  1.8431831e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.7161808e-05  3.5116053e-04 -1.9098785e-04 -3.4349837e-04
  1.8431831e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00014537 -0.0023342   0.0040425   0.00434278 -0.00122959]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01121487  0.00331708 -0.00749592  0.01312442  0.0195402 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04940224  0.02997266 -0.20648602 -0.07263459 -0.0409649 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04940224  0.02997266 -0.20648602 -0.07263459 -0.0409649 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01363617 -0.00686504  0.04579781  0.01880547  0.010976  ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00856178 -0.0064229   0.02864678  0.00927568  0.00788531]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00856178 -0.0064229   0.02864678  0.00927568  0.00788531]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.0976915  -0.12619166  0.19451134 -0.23946841 -0.08928275]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.0976915  -0.12619166  0.19451134 -0.23946841 -0.08928275]
  [Layer 9] Output shape after mixer: (1, 1, 2048)
  [Layer 9] Output sample values after mixer: [-0.0976915  -0.12619166  0.19451134 -0.23946841 -0.08928275]
  [Layer 9] Residual connection shape: (1, 1, 2048)
  [Layer 9] Residual connection sample values: [ 0.24976051  0.36861956 -0.43221068 -0.71925646  0.4279961 ]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0843896   0.10410145 -0.13182496 -0.21719806  0.14133146]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0843896   0.10410145 -0.13182496 -0.21719806  0.14133146]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0843896   0.10410145 -0.13182496 -0.21719806  0.14133146]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.14302291  1.1485982  -0.55670244 -0.8147715  -1.874752  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.14302291  1.1485982  -0.55670244 -0.8147715  -1.874752  ]
  [FlaxMamba2] xBC (step) sample values: [-0.7617132   2.3396902  -0.7235498   1.083837   -0.93100846]
  [FlaxMamba2] dt (step) sample values: [ 0.24931554 -0.0809228   0.44318894 -0.3737512   1.2576956 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.1810347  0.3956909 -0.5293305 -0.7617132 -0.4587038]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.1258694  -0.7316497  -0.12496755 -0.20548487 -0.15812851]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.16422999 -0.81874686 -0.22878835 -0.2913003  -0.21769883]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07538724 -0.25056088 -0.10136493 -0.12458494 -0.09704778]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07538724 -0.25056088 -0.10136493 -0.12458494 -0.09704778]
  [FlaxMamba2] B (step) sample values: [-0.08516192  0.09606216  0.05553775  0.10524729 -0.06610869]
  [FlaxMamba2] C (step) sample values: [-0.27594137 -0.09494982 -0.09100015  0.04325316 -0.15170442]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.7154508  -1.4067873  -0.35344088 -2.010216   -0.4652703 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00056345 0.00328206 0.14369455 0.00125695 0.02639874]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9979087  0.99539346 0.9504806  0.99747646 0.98779255]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07538724 -0.25056088 -0.10136493 -0.12458494 -0.09704778]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.6174074e-06 -4.0804148e-06 -2.3590667e-06 -4.4705698e-06
  2.8080867e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.6174074e-06 -4.0804148e-06 -2.3590667e-06 -4.4705698e-06
  2.8080867e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [8.0473346e-06 5.8580677e-05 2.7077398e-05 1.3601728e-05 2.8488163e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-3.7188443e-06 -2.2269795e-03  3.0800852e-04 -4.6600230e-04
  1.8866108e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01656785 -0.05728038 -0.02196396 -0.02783988 -0.01943679]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01656785 -0.05728038 -0.02196396 -0.02783988 -0.01943679]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00110021 -0.049953    0.00445457  0.00696088  0.00484615]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01093007 -0.24182563  0.03465369  0.06162963  0.03970722]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01093007 -0.24182563  0.03465369  0.06162963  0.03970722]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.05404699 -0.31002873 -0.59652936  0.02305254  0.13546902]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.05404699 -0.31002873 -0.59652936  0.02305254  0.13546902]
  [Layer 10] Output shape after mixer: (1, 1, 2048)
  [Layer 10] Output sample values after mixer: [-0.05404699 -0.31002873 -0.59652936  0.02305254  0.13546902]
  [Layer 10] Residual connection shape: (1, 1, 2048)
  [Layer 10] Residual connection sample values: [ 0.19571352  0.05859083 -1.02874    -0.69620395  0.5634651 ]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07151755  0.01741927 -0.33579418 -0.22171065  0.19682536]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07151755  0.01741927 -0.33579418 -0.22171065  0.19682536]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07151755  0.01741927 -0.33579418 -0.22171065  0.19682536]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.64620954  0.2660021  -0.79916257 -0.65429866  0.5108186 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.64620954  0.2660021  -0.79916257 -0.65429866  0.5108186 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.5253639   1.1323724  -0.5392936   2.0060852  -0.23168398]
  [FlaxMamba2] dt (step) sample values: [1.4805254 2.0783846 0.8756684 1.88222   1.790871 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.33429423  1.5171268  -0.08247908  0.5253639   0.25403488]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.146688   -0.1786465   0.1539457  -0.24625385 -0.0310523 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.16089393 -0.5363125   0.2505033  -0.23410785 -0.00788946]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07398918 -0.19792388  0.1408581  -0.10341454 -0.00392917]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07398918 -0.19792388  0.1408581  -0.10341454 -0.00392917]
  [FlaxMamba2] B (step) sample values: [-0.21895075 -0.16044712 -0.26989052 -0.08624928 -0.0016303 ]
  [FlaxMamba2] C (step) sample values: [-0.04997259 -0.13186088 -0.2767478  -0.24195608  0.02633669]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.31160602 -0.09015273 -1.5786072  -0.20961139 -0.6694042 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.07513078 0.227444   0.26680312 0.25223225 0.04390647]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9768607  0.9797041  0.6562737  0.9485026  0.97103655]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07398918 -0.19792388  0.1408581  -0.10341454 -0.00392917]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [1.2171175e-03 8.9190376e-04 1.5002848e-03 4.7944806e-04 9.0626354e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [1.2171175e-03 8.9190376e-04 1.5002848e-03 4.7944806e-04 9.0626354e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.04503622 -0.05713083  0.05243772  0.01404033 -0.05247253]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.10767162 -0.1999781   0.20459282 -0.06612246  0.01325711]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.13481659 -0.27259192  0.2562705  -0.10406293  0.01181559]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.13481659 -0.27259192  0.2562705  -0.10406293  0.01181559]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.05716414 -0.04104873 -0.06353047  0.02328764  0.00377225]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.04319701 -0.0304027  -0.03337269  0.03986756  0.00212093]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.04319701 -0.0304027  -0.03337269  0.03986756  0.00212093]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.00583396  0.62642026 -0.24221201  0.14218867  0.33017385]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.00583396  0.62642026 -0.24221201  0.14218867  0.33017385]
  [Layer 11] Output shape after mixer: (1, 1, 2048)
  [Layer 11] Output sample values after mixer: [-0.00583396  0.62642026 -0.24221201  0.14218867  0.33017385]
  [Layer 11] Residual connection shape: (1, 1, 2048)
  [Layer 11] Residual connection sample values: [ 0.18987955  0.6850111  -1.2709521  -0.5540153   0.89363897]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05560381  0.16645265 -0.32510945 -0.14075823  0.25070968]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05560381  0.16645265 -0.32510945 -0.14075823  0.25070968]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05560381  0.16645265 -0.32510945 -0.14075823  0.25070968]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.0455892  -1.5554962  -1.5483619  -0.561382   -0.84464973]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.0455892  -1.5554962  -1.5483619  -0.561382   -0.84464973]
  [FlaxMamba2] xBC (step) sample values: [-0.6304363  -0.177373   -0.06023996 -0.57375765 -0.42161453]
  [FlaxMamba2] dt (step) sample values: [1.4938482  1.0200424  1.8997648  0.47508565 1.1763608 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.20059147 -0.16735914 -0.36496753 -0.6304363   0.16004978]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.10757513  0.03310843 -0.4544662  -0.02508737 -0.07660225]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.15057439  0.04600211 -0.4893478  -0.05479623 -0.06398323]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06962971  0.02353001 -0.18597527 -0.02664764 -0.0309685 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06962971  0.02353001 -0.18597527 -0.02664764 -0.0309685 ]
  [FlaxMamba2] B (step) sample values: [-0.05426584 -0.15378793  0.15628088 -0.13037278 -0.04014035]
  [FlaxMamba2] C (step) sample values: [-0.17410803 -0.13064845  0.10990537 -0.06174335 -0.03432554]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2411823 -0.7693517 -1.9974962 -1.2367963 -1.0181218]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.17619443 0.17695679 0.16781004 0.14535853 0.2327282 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8035712  0.8727187  0.71519506 0.83545494 0.7890341 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06962971  0.02353001 -0.18597527 -0.02664764 -0.0309685 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00066575  0.00188673 -0.00191731  0.00159946  0.00049246]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00066575  0.00188673 -0.00191731  0.00159946  0.00049246]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00357101  0.00645893 -0.01789279  0.00351531 -0.00054317]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02182358 -0.03447383  0.0808424  -0.01510685 -0.01044483]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07194405 -0.01753658 -0.05302528 -0.03428821 -0.0327364 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07194405 -0.01753658 -0.05302528 -0.03428821 -0.0327364 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.05566021  0.0047544   0.01439442  0.00699169  0.00831062]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.1411057   0.00793911  0.01816639  0.01009263  0.01724932]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.1411057   0.00793911  0.01816639  0.01009263  0.01724932]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.1834984  -0.03095501  1.0981964  -0.31015882  0.94218767]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.1834984  -0.03095501  1.0981964  -0.31015882  0.94218767]
  [Layer 12] Output shape after mixer: (1, 1, 2048)
  [Layer 12] Output sample values after mixer: [-1.1834984  -0.03095501  1.0981964  -0.31015882  0.94218767]
  [Layer 12] Residual connection shape: (1, 1, 2048)
  [Layer 12] Residual connection sample values: [-0.99361885  0.6540561  -0.17275572 -0.8641741   1.8358266 ]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.23978591  0.13659836 -0.03846992 -0.1811104   0.44971666]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.23978591  0.13659836 -0.03846992 -0.1811104   0.44971666]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.23978591  0.13659836 -0.03846992 -0.1811104   0.44971666]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-3.380954   -0.00970247  1.8774527   2.14586    -0.4664314 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-3.380954   -0.00970247  1.8774527   2.14586    -0.4664314 ]
  [FlaxMamba2] xBC (step) sample values: [-1.7109807   0.10807925 -3.3634202   0.10073277 -0.37516195]
  [FlaxMamba2] dt (step) sample values: [2.187609   1.3304898  1.1851747  0.36383042 2.4865701 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5842428   0.80534804 -0.29596958 -1.7109807   0.10605752]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.003652    0.28215054  0.1725817  -0.1040627  -0.04818828]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.26099643  0.17222622  0.15210441 -0.1048676  -0.07214458]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.11356445  0.09351031  0.08182502 -0.04968701 -0.03477164]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.11356445  0.09351031  0.08182502 -0.04968701 -0.03477164]
  [FlaxMamba2] B (step) sample values: [-0.06360033  0.14702435 -0.18527359  0.5265991   0.10065017]
  [FlaxMamba2] C (step) sample values: [ 0.72912604  0.00959769 -0.01045994  0.42817247  0.00974866]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3103099 -1.7870504 -0.8605819 -1.881061  -0.5251649]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08253226 0.03641505 0.12030011 0.06649574 0.19341   ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8974994  0.9369967  0.90165067 0.88242406 0.903416  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.11356445  0.09351031  0.08182502 -0.04968701 -0.03477164]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00059611 -0.00137802  0.00173652 -0.00493567 -0.00094337]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00059611 -0.00137802  0.00173652 -0.00493567 -0.00094337]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.5160234e-03 -5.6773447e-03 -5.5771531e-04 -3.7056915e-02
 -2.5773305e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.08990595  0.06625274 -0.0108715  -0.01267522  0.04979755]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.09479494  0.07027839 -0.0073489  -0.01481427  0.04830061]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.09479494  0.07027839 -0.0073489  -0.01481427  0.04830061]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01054309 -0.00033928 -0.01196657 -0.0284604  -0.00868403]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.03309725 -0.00035133 -0.05080856 -0.13755107 -0.01601351]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03309725 -0.00035133 -0.05080856 -0.13755107 -0.01601351]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.03983318 -0.02301123 -0.05563899  0.15642099 -0.0028445 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.03983318 -0.02301123 -0.05563899  0.15642099 -0.0028445 ]
  [Layer 13] Output shape after mixer: (1, 1, 2048)
  [Layer 13] Output sample values after mixer: [-0.03983318 -0.02301123 -0.05563899  0.15642099 -0.0028445 ]
  [Layer 13] Residual connection shape: (1, 1, 2048)
  [Layer 13] Residual connection sample values: [-1.033452    0.63104486 -0.2283947  -0.7077531   1.8329822 ]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.18609151  0.09980449 -0.03807801 -0.11095614  0.3222136 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.18609151  0.09980449 -0.03807801 -0.11095614  0.3222136 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.18609151  0.09980449 -0.03807801 -0.11095614  0.3222136 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.8832396  -0.31319836 -0.5038002  -1.225488   -0.4049681 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.8832396  -0.31319836 -0.5038002  -1.225488   -0.4049681 ]
  [FlaxMamba2] xBC (step) sample values: [-1.5263305   0.6926591   0.42409816 -0.15350543  0.28383917]
  [FlaxMamba2] dt (step) sample values: [0.47420952 0.9755431  1.0058275  0.8192023  1.2260498 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.5885432  -0.04662067 -0.787196   -1.5263305  -0.65424633]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.37670082 -0.129865   -0.20808667 -0.05459106 -0.03276565]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.4162516  -0.17112477 -0.26893872 -0.11739624  0.00379441]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.16542424 -0.07825927 -0.11649556 -0.0552566   0.0019008 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.16542424 -0.07825927 -0.11649556 -0.0552566   0.0019008 ]
  [FlaxMamba2] B (step) sample values: [-0.087156   -0.06712516  0.07281614  0.00827583 -0.00460999]
  [FlaxMamba2] C (step) sample values: [-0.18590476 -0.1352771   0.08122798 -0.02238239 -0.20562519]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.318424  -0.7620611 -2.6670074 -5.1836414 -2.8487349]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06277005 0.03160737 0.20828049 0.03713583 0.04656736]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.76256484 0.976201   0.57379353 0.82489526 0.8757645 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.16542424 -0.07825927 -0.11649556 -0.0552566   0.0019008 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.0500078e-04  6.9700676e-04 -7.5610017e-04 -8.5933665e-05
  4.7868671e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.0500078e-04  6.9700676e-04 -7.5610017e-04 -8.5933665e-05
  4.7868671e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00140486  0.00056182 -0.00024061  0.00098938  0.00032609]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01650925 -0.00060228 -0.01462002 -0.0054813  -0.0033235 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.08337761 -0.03223652 -0.06171026 -0.02781731 -0.00255515]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.08337761 -0.03223652 -0.06171026 -0.02781731 -0.00255515]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.1362907   0.00426407  0.01170985  0.00773743  0.00041402]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.8053798   0.01466471  0.05843905  0.05428539  0.00336735]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.8053798   0.01466471  0.05843905  0.05428539  0.00336735]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.38194698 -0.27673602  0.30086383  0.5624617   0.56502366]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.38194698 -0.27673602  0.30086383  0.5624617   0.56502366]
  [Layer 14] Output shape after mixer: (1, 1, 2048)
  [Layer 14] Output sample values after mixer: [ 0.38194698 -0.27673602  0.30086383  0.5624617   0.56502366]
  [Layer 14] Residual connection shape: (1, 1, 2048)
  [Layer 14] Residual connection sample values: [-0.65150505  0.35430884  0.07246913 -0.14529145  2.398006  ]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.09744905  0.0450557   0.00996336 -0.01870316  0.34368524]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09744905  0.0450557   0.00996336 -0.01870316  0.34368524]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09744905  0.0450557   0.00996336 -0.01870316  0.34368524]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.03947016  1.2126465  -0.2034521  -0.61878556 -0.81381595]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.03947016  1.2126465  -0.2034521  -0.61878556 -0.81381595]
  [FlaxMamba2] xBC (step) sample values: [-0.6432447 -1.235002  -0.2847735  1.5618005  0.3134964]
  [FlaxMamba2] dt (step) sample values: [-0.1949396   0.01662482  1.1430247   1.0441488  -0.40229318]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6377079  -0.47172862  0.19674203 -0.6432447  -0.42234656]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06495234  0.2623449  -0.0212689  -0.32504067 -0.03518118]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.02750728  0.2554899  -0.04604917 -0.34278664 -0.06052603]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01394279  0.14397553 -0.02249455 -0.14230195 -0.02934745]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01394279  0.14397553 -0.02249455 -0.14230195 -0.02934745]
  [FlaxMamba2] B (step) sample values: [ 0.04717356 -0.01521979  0.03302143  0.06268329  0.04983477]
  [FlaxMamba2] C (step) sample values: [-0.07599699 -0.04198806 -0.01923674 -0.0021735   0.02098189]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.27823287 -0.68077636 -2.7209377  -0.11263601 -3.8483953 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00159349 0.01611248 0.04670006 0.01617793 0.01554553]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9995567  0.9890909  0.8806738  0.99817944 0.94192904]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01394279  0.14397553 -0.02249455 -0.14230195 -0.02934745]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0480862e-06 -3.3814814e-07  7.3365891e-07  1.3926762e-06
  1.1072120e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0480862e-06 -3.3814814e-07  7.3365891e-07  1.3926762e-06
  1.1072120e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-7.3582218e-05 -9.7093189e-06 -2.2725197e-05 -7.9405982e-06
  2.9984737e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-5.8321712e-06  1.4841464e-05 -4.6791633e-06 -2.6663378e-05
 -4.2198931e-06]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00237043  0.02455256 -0.00383842 -0.02427915 -0.0050059 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00237043  0.02455256 -0.00383842 -0.02427915 -0.0050059 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-4.5857611e-05  2.2948485e-02  3.5088306e-04  5.2591236e-03
  1.2509988e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00088122  0.57619846  0.00679363  0.11841407  0.02067197]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00088122  0.57619846  0.00679363  0.11841407  0.02067197]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.1650919   1.2467928   0.7211827   0.27790922  0.88387513]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.1650919   1.2467928   0.7211827   0.27790922  0.88387513]
  [Layer 15] Output shape after mixer: (1, 1, 2048)
  [Layer 15] Output sample values after mixer: [-0.1650919   1.2467928   0.7211827   0.27790922  0.88387513]
  [Layer 15] Residual connection shape: (1, 1, 2048)
  [Layer 15] Residual connection sample values: [-0.816597    1.6011016   0.7936518   0.13261777  3.281881  ]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.12318039  0.20192142  0.10968017  0.01678756  0.4755413 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.12318039  0.20192142  0.10968017  0.01678756  0.4755413 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.12318039  0.20192142  0.10968017  0.01678756  0.4755413 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.3017482  -0.08599841 -0.4421868   0.8328158  -0.48259115]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.3017482  -0.08599841 -0.4421868   0.8328158  -0.48259115]
  [FlaxMamba2] xBC (step) sample values: [ 1.6344718  -0.59972036 -0.03500574  1.3552696  -0.47141263]
  [FlaxMamba2] dt (step) sample values: [0.6298608 1.5198034 1.3506287 1.3805313 1.3280454]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.00926928  0.9898985   0.8945974   1.6344718  -0.89864707]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.43946183 -0.06609596  0.00658769  0.27661997 -0.16172537]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.403329   -0.10723366 -0.0065425   0.18421274 -0.20380911]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.2417906  -0.05074481 -0.00326055  0.10056605 -0.09155581]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.2417906  -0.05074481 -0.00326055  0.10056605 -0.09155581]
  [FlaxMamba2] B (step) sample values: [-0.13046028 -0.1689769   0.06512536 -0.01320973  0.0880136 ]
  [FlaxMamba2] C (step) sample values: [-0.27235687  0.17328155 -0.17916334  0.91465855 -0.1408387 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6905513  -0.13480766 -1.3128716  -3.7739606  -1.2635014 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10467276 0.27835685 0.17640646 0.26474723 0.08534738]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.75455475 0.9631707  0.79326415 0.36819386 0.89777434]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.2417906  -0.05074481 -0.00326055  0.10056605 -0.09155581]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0033018  -0.00427662  0.00164825 -0.00033432  0.00222753]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0033018  -0.00427662  0.00164825 -0.00033432  0.00222753]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00394206 -0.00302263  0.00234455 -0.0014549   0.00948815]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.03700494 -0.03700716 -0.0020193  -0.01225695 -0.02813458]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.19261631 -0.06966546 -0.00411772  0.05246526 -0.08705799]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.19261631 -0.06966546 -0.00411772  0.05246526 -0.08705799]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.05362556  0.00286683  0.00071233  0.03045246  0.01603402]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.21352057  0.00896014  0.00266819  0.10162719  0.05496475]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.21352057  0.00896014  0.00266819  0.10162719  0.05496475]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.5318119   0.02355889  0.68663436  0.03154291 -0.13765533]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.5318119   0.02355889  0.68663436  0.03154291 -0.13765533]
  [Layer 16] Output shape after mixer: (1, 1, 2048)
  [Layer 16] Output sample values after mixer: [ 0.5318119   0.02355889  0.68663436  0.03154291 -0.13765533]
  [Layer 16] Residual connection shape: (1, 1, 2048)
  [Layer 16] Residual connection sample values: [-0.2847851   1.6246605   1.4802861   0.16416068  3.1442258 ]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03689868  0.1768801   0.17084844  0.01752339  0.39195573]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03689868  0.1768801   0.17084844  0.01752339  0.39195573]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03689868  0.1768801   0.17084844  0.01752339  0.39195573]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.19588305 -0.61480486 -0.17626019 -1.3843743  -0.85025424]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.19588305 -0.61480486 -0.17626019 -1.3843743  -0.85025424]
  [FlaxMamba2] xBC (step) sample values: [-1.2432877  -0.19948992  0.48205072 -0.5668056   0.30404466]
  [FlaxMamba2] dt (step) sample values: [-0.64430064 -0.07128213  1.4431057   1.5093879   0.85887146]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6556686  -0.9301225  -1.2048231  -1.2432877  -0.44531885]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.26712033  0.04072248 -0.12361085  0.09552148 -0.05310563]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.29891965  0.01452314 -0.13796937  0.09011987 -0.04047135]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.12728645  0.0073143  -0.06423333  0.04708895 -0.01982625]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.12728645  0.0073143  -0.06423333  0.04708895 -0.01982625]
  [FlaxMamba2] B (step) sample values: [-0.17442513  0.13294347  0.21802959  0.15409173 -0.20725173]
  [FlaxMamba2] C (step) sample values: [-0.1411818   0.01907736  0.02138702  0.27827796  0.1233432 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.1570504  -11.466768   -14.214988    -0.12863436 -14.242779  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00026958 0.00955889 0.0884207  0.09543991 0.01659496]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99968815 0.89618397 0.28453493 0.9877982  0.78949773]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.12728645  0.0073143  -0.06423333  0.04708895 -0.01982625]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.9851509e-06 -4.5617667e-06 -7.4813765e-06 -5.2874393e-06
  7.1115496e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.9851509e-06 -4.5617667e-06 -7.4813765e-06 -5.2874393e-06
  7.1115496e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-7.4263393e-05  8.5352680e-05  1.0143724e-04 -2.5738022e-04
  9.0375415e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.9150511e-04 -7.4858781e-06 -2.2324745e-04  3.4310087e-05
  7.1464325e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.08228555  0.00470991 -0.04165087  0.03040457 -0.01271558]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.08228555  0.00470991 -0.04165087  0.03040457 -0.01271558]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00884598 -0.00101628  0.00334803 -0.0084312   0.00323673]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.06840086 -0.00959798  0.02399966 -0.07359903  0.02836481]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.06840086 -0.00959798  0.02399966 -0.07359903  0.02836481]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.35544804 -0.8683954  -0.5722883   0.13139324  0.1921571 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.35544804 -0.8683954  -0.5722883   0.13139324  0.1921571 ]
  [Layer 17] Output shape after mixer: (1, 1, 2048)
  [Layer 17] Output sample values after mixer: [-0.35544804 -0.8683954  -0.5722883   0.13139324  0.1921571 ]
  [Layer 17] Residual connection shape: (1, 1, 2048)
  [Layer 17] Residual connection sample values: [-0.64023316  0.7562651   0.90799785  0.29555392  3.3363829 ]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.06968284  0.06959926  0.08837216  0.02699573  0.3490464 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.06968284  0.06959926  0.08837216  0.02699573  0.3490464 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.06968284  0.06959926  0.08837216  0.02699573  0.3490464 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.41252294 -0.0764173  -0.12841052 -0.78786784  0.6038343 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.41252294 -0.0764173  -0.12841052 -0.78786784  0.6038343 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.99266255  0.20882753 -0.29277974 -0.7085379  -0.8165244 ]
  [FlaxMamba2] dt (step) sample values: [0.9808062  1.1297919  0.67782754 1.2398852  1.9391634 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.37656048 -0.5444347   0.08378849  0.99266255  0.8191319 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.23249322 -0.10607981 -0.01387244 -0.26278168 -0.1465075 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.22248346 -0.37146068  0.2659127  -0.27661377 -0.18859124]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.12356566 -0.15162584  0.15053032 -0.11929914 -0.08543022]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.12356566 -0.15162584  0.15053032 -0.11929914 -0.08543022]
  [FlaxMamba2] B (step) sample values: [0.2075808  0.15513174 0.22793768 0.1014198  0.21527648]
  [FlaxMamba2] C (step) sample values: [-0.27783492 -0.02284992 -0.0456936   0.18886076  0.01135854]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3010656 -1.4685526 -1.2082934 -1.2128745 -2.5874777]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.23717602 0.16006619 0.13985704 0.23579742 0.26566613]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.734488   0.790519   0.8445188  0.7512681  0.50287926]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.12356566 -0.15162584  0.15053032 -0.11929914 -0.08543022]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00608353 0.00454642 0.00668013 0.00297229 0.00630907]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00608353 0.00454642 0.00668013 0.00297229 0.00630907]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 4.7364724e-03  6.8143490e-03  1.0430133e-02 -1.8609455e-05
  2.1210108e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00737837 -0.09486721  0.14875144 -0.07605585 -0.0461506 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01649926 -0.12416714  0.17783967 -0.09910902 -0.062659  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01649926 -0.12416714  0.17783967 -0.09910902 -0.062659  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00271101  0.00456308 -0.01068614  0.02441139 -0.024462  ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.01750132  0.01209788 -0.05153323  0.15146676 -0.23888353]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01750132  0.01209788 -0.05153323  0.15146676 -0.23888353]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.31724378  0.49619168  0.8498548   0.0882414  -0.8395191 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.31724378  0.49619168  0.8498548   0.0882414  -0.8395191 ]
  [Layer 18] Output shape after mixer: (1, 1, 2048)
  [Layer 18] Output sample values after mixer: [-0.31724378  0.49619168  0.8498548   0.0882414  -0.8395191 ]
  [Layer 18] Residual connection shape: (1, 1, 2048)
  [Layer 18] Residual connection sample values: [-0.957477    1.2524568   1.7578527   0.38379532  2.4968638 ]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.09029123  0.10196025  0.15473227  0.03111455  0.23495165]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09029123  0.10196025  0.15473227  0.03111455  0.23495165]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09029123  0.10196025  0.15473227  0.03111455  0.23495165]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.4576763 -0.6439154  0.6719014 -0.7895031 -0.9027611]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.4576763 -0.6439154  0.6719014 -0.7895031 -0.9027611]
  [FlaxMamba2] xBC (step) sample values: [-0.6588937  -0.666358    0.2509697  -0.46868587 -0.25592104]
  [FlaxMamba2] dt (step) sample values: [0.69400656 1.0949255  1.3049705  0.8788692  0.7551572 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.76022786 -1.4179927  -1.0870969  -0.6588937  -0.34830368]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.35002923 -0.19478199  0.06294245 -0.06344174  0.05143216]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.38567376 -0.21911976  0.05794138 -0.10604428  0.01847318]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.156105   -0.09760431  0.02980976 -0.05021342  0.0093219 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.156105   -0.09760431  0.02980976 -0.05021342  0.0093219 ]
  [FlaxMamba2] B (step) sample values: [ 0.00773624  0.9316574  -0.02195574 -0.02493552 -0.03429776]
  [FlaxMamba2] C (step) sample values: [-0.25178146 -0.06295329 -0.04850761 -0.18001807 -0.1118347 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9436172 -1.8178532 -2.0862153 -1.0006425 -0.9649832]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10620557 0.08370776 0.08270095 0.11923564 0.147593  ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8134889  0.8588436  0.8415314  0.8875306  0.86725277]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.156105   -0.09760431  0.02980976 -0.05021342  0.0093219 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00012826 -0.01544615  0.00036401  0.00041341  0.00056863]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00012826 -0.01544615  0.00036401  0.00041341  0.00056863]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00199085 -0.02478312  0.00015198 -0.00020279  0.00063561]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00801617 -0.01219897 -0.00659976  0.00567333  0.00507278]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-2.5575738e-02 -2.3178045e-02 -3.2465886e-03  2.5043730e-05
  6.1213556e-03]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-2.5575738e-02 -2.3178045e-02 -3.2465886e-03  2.5043730e-05
  6.1213556e-03]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 7.0395381e-03  5.1394994e-03 -1.4439232e-03 -6.1743408e-06
 -1.5941943e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 1.61148831e-01  1.23640426e-01 -4.45618071e-02 -1.39401876e-04
 -5.12039475e-02]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 1.61148831e-01  1.23640426e-01 -4.45618071e-02 -1.39401876e-04
 -5.12039475e-02]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.1226518  -0.28395334 -1.376689    0.17808986 -0.84960514]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.1226518  -0.28395334 -1.376689    0.17808986 -0.84960514]
  [Layer 19] Output shape after mixer: (1, 1, 2048)
  [Layer 19] Output sample values after mixer: [ 1.1226518  -0.28395334 -1.376689    0.17808986 -0.84960514]
  [Layer 19] Residual connection shape: (1, 1, 2048)
  [Layer 19] Residual connection sample values: [0.16517484 0.9685035  0.38116372 0.5618852  1.6472588 ]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.01549053 0.07786144 0.03281093 0.0447392  0.14979993]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.01549053 0.07786144 0.03281093 0.0447392  0.14979993]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.01549053 0.07786144 0.03281093 0.0447392  0.14979993]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.19344799 -0.92064613 -0.89962375  0.5642761   0.9348197 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.19344799 -0.92064613 -0.89962375  0.5642761   0.9348197 ]
  [FlaxMamba2] xBC (step) sample values: [-0.48445582  1.1289295  -1.628956    1.3918899   0.73034054]
  [FlaxMamba2] dt (step) sample values: [1.4019827 1.7525622 1.7439426 1.1152081 1.2821268]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.17979228 -0.41172123 -0.9065046  -0.48445582  0.9004154 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.19832459  0.24861526 -0.01521351 -0.14793585  0.49501848]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.15984192  0.25714493  0.05131481 -0.16673468  0.46756792]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.08629476  0.14501286  0.02631556 -0.07643328  0.28746447]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.08629476  0.14501286  0.02631556 -0.07643328  0.28746447]
  [FlaxMamba2] B (step) sample values: [-0.13176362  0.16352499  0.01801536 -0.01297473  0.2104978 ]
  [FlaxMamba2] C (step) sample values: [ 0.11202008 -0.20909919 -0.20142545  0.0071825   0.6441426 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.6215758 -5.0388985 -1.2056414 -1.6434968 -1.3345234]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1138299  0.06379001 0.04904318 0.1343375  0.1048593 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8314502  0.7251104  0.94258565 0.8018905  0.86941284]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.08629476  0.14501286  0.02631556 -0.07643328  0.28746447]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0012943   0.00160629  0.00017696 -0.00012745  0.0020677 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0012943   0.00160629  0.00017696 -0.00012745  0.0020677 ]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-4.4067586e-03 -3.6675483e-05  3.1974541e-03  2.6862107e-03
  4.0828921e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01753282  0.02863728  0.00217544 -0.01322366  0.04468693]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01822033  0.02979258  0.0023851  -0.0138326   0.04697714]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01822033  0.02979258  0.0023851  -0.0138326   0.04697714]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00193227 -0.00781234 -0.00062038 -0.00497549  0.03153337]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.02907853 -0.12593363 -0.01342521 -0.08146758  0.46131137]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02907853 -0.12593363 -0.01342521 -0.08146758  0.46131137]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.9376048   0.01779164  0.16625221 -0.8245687   0.36194116]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.9376048   0.01779164  0.16625221 -0.8245687   0.36194116]
  [Layer 20] Output shape after mixer: (1, 1, 2048)
  [Layer 20] Output sample values after mixer: [-0.9376048   0.01779164  0.16625221 -0.8245687   0.36194116]
  [Layer 20] Residual connection shape: (1, 1, 2048)
  [Layer 20] Residual connection sample values: [-0.77242994  0.9862951   0.5474159  -0.2626835   2.0091999 ]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.04787296  0.0554781   0.02920964 -0.013515    0.11643703]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04787296  0.0554781   0.02920964 -0.013515    0.11643703]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04787296  0.0554781   0.02920964 -0.013515    0.11643703]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.30726886 -0.40312585 -0.29582995 -0.0740428   0.28312895]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.30726886 -0.40312585 -0.29582995 -0.0740428   0.28312895]
  [FlaxMamba2] xBC (step) sample values: [-0.08383006  1.4520967   0.38826925 -0.2106402   0.07860772]
  [FlaxMamba2] dt (step) sample values: [0.9114172  2.022063   0.74884933 1.7731072  3.1596007 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.54034585  0.1051529   0.65818185 -0.08383006  0.4850397 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.02567201  0.26100695 -0.04782788  0.05782133 -0.01720465]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00560851  0.23091662 -0.03297345  0.05274015  0.01068841]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00279639  0.12873001 -0.01621494  0.0270653   0.00537277]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00279639  0.12873001 -0.01621494  0.0270653   0.00537277]
  [FlaxMamba2] B (step) sample values: [ 0.05146483 -0.0417052  -0.03349415  0.02647356  0.03585616]
  [FlaxMamba2] C (step) sample values: [-0.01274565 -0.05283028  0.11168838  0.05294189  0.0591641 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.2091806  -0.04342505 -3.8147197  -6.662431   -0.02279418]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.13924594 0.03159633 0.06260575 0.13454495 0.17025088]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.63963    0.99862885 0.78755397 0.4080374  0.9961268 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00279639  0.12873001 -0.01621494  0.0270653   0.00537277]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.0039677e-05  1.6239415e-05  1.3042150e-05 -1.0308431e-05
 -1.3961884e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.0039677e-05  1.6239415e-05  1.3042150e-05 -1.0308431e-05
 -1.3961884e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.9860681e-04  1.3271442e-05  2.0754825e-04 -1.9066696e-04
 -2.8111829e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-9.4036432e-06  1.4293585e-03  2.5605917e-04  6.5725925e-04
  1.3094762e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00050026  0.02402557 -0.00259018  0.00540808  0.00107404]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00050026  0.02402557 -0.00259018  0.00540808  0.00107404]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 6.5141132e-05 -3.8795692e-03  3.2686561e-04 -1.9280582e-04
  1.7342740e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00575974 -0.31499466  0.03527427 -0.01754726  0.01418753]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00575974 -0.31499466  0.03527427 -0.01754726  0.01418753]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.5199893   0.18935356  0.83433616  0.26746657  0.6353364 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.5199893   0.18935356  0.83433616  0.26746657  0.6353364 ]
  [Layer 21] Output shape after mixer: (1, 1, 2048)
  [Layer 21] Output sample values after mixer: [-0.5199893   0.18935356  0.83433616  0.26746657  0.6353364 ]
  [Layer 21] Residual connection shape: (1, 1, 2048)
  [Layer 21] Residual connection sample values: [-1.2924192   1.1756487   1.381752    0.00478306  2.6445363 ]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.11557905  0.0885506   0.11028881  0.00035189  0.22172357]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.11557905  0.0885506   0.11028881  0.00035189  0.22172357]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.11557905  0.0885506   0.11028881  0.00035189  0.22172357]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.3711903  -0.69761145  0.57974815 -0.29775396 -0.34856042]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.3711903  -0.69761145  0.57974815 -0.29775396 -0.34856042]
  [FlaxMamba2] xBC (step) sample values: [ 0.04268686 -0.38653865 -0.3823165   0.08125877 -1.2926755 ]
  [FlaxMamba2] dt (step) sample values: [1.3407462 1.4138184 1.3444514 0.7645704 2.286334 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.7527055  -0.02076029 -0.62286955  0.04268686  0.73178685]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.27894402 -0.08491682 -0.05642709  0.01696906 -0.41853175]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.32661247 -0.16365217  0.26290885 -0.02401604 -0.48420557]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.13687189 -0.07514548  0.14863585 -0.01186384 -0.18460798]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.13687189 -0.07514548  0.14863585 -0.01186384 -0.18460798]
  [FlaxMamba2] B (step) sample values: [ 0.06687021 -0.05353382 -0.04845006 -0.24566008  0.00778233]
  [FlaxMamba2] C (step) sample values: [ 0.04128496  0.02150312 -0.07667708 -0.05014092 -0.09434649]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.1489344 -3.5005836 -2.8320918 -5.5395546 -1.7185895]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00507775 0.15703693 0.22047889 0.09627067 0.02779047]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.97915316 0.5771109  0.53557384 0.5866678  0.95336217]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.13687189 -0.07514548  0.14863585 -0.01186384 -0.18460798]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.6474841e-05  3.7206039e-05  3.3672826e-05  1.7073391e-04
 -5.4087277e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.6474841e-05  3.7206039e-05  3.3672826e-05  1.7073391e-04
 -5.4087277e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [2.90909993e-05 3.25272595e-05 1.09676475e-05 3.11378244e-05
 6.61906743e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0023642   0.00090991  0.00279685  0.000681   -0.00113949]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03551417 -0.0172901   0.03879602 -0.00219238 -0.045851  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03551417 -0.0172901   0.03879602 -0.00219238 -0.045851  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00780071  0.00400863  0.01441753  0.00027816  0.00661219]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.05161399  0.07467009  0.15316306  0.00727008  0.1134808 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.05161399  0.07467009  0.15316306  0.00727008  0.1134808 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.8593582 -0.6939066  0.2245847 -1.2858062  0.8131701]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.8593582 -0.6939066  0.2245847 -1.2858062  0.8131701]
  [Layer 22] Output shape after mixer: (1, 1, 2048)
  [Layer 22] Output sample values after mixer: [-0.8593582 -0.6939066  0.2245847 -1.2858062  0.8131701]
  [Layer 22] Residual connection shape: (1, 1, 2048)
  [Layer 22] Residual connection sample values: [-2.1517773   0.48174208  1.6063367  -1.2810231   3.4577065 ]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.11895409  0.02291319  0.08129495 -0.06125024  0.18523341]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.11895409  0.02291319  0.08129495 -0.06125024  0.18523341]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.11895409  0.02291319  0.08129495 -0.06125024  0.18523341]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.08131752 -0.39543483 -0.1525558   0.4549773  -0.03566945]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.08131752 -0.39543483 -0.1525558   0.4549773  -0.03566945]
  [FlaxMamba2] xBC (step) sample values: [-1.093606    1.0026512  -0.5728402   0.26109704 -0.540077  ]
  [FlaxMamba2] dt (step) sample values: [ 1.0349586  1.0354104  1.6278948 -0.2572941  0.6341946]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.30462316 -1.1896893  -0.7503175  -1.093606   -0.04722341]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.3722939  -0.6507493  -0.18023652  0.06731069  0.2038715 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.39466327 -0.6838609  -0.19158906  0.06514966  0.15449406]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.15888955 -0.22936703 -0.08664591  0.03363558  0.0832023 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.15888955 -0.22936703 -0.08664591  0.03363558  0.0832023 ]
  [FlaxMamba2] B (step) sample values: [ 0.03656714  0.01471657  0.19982275  0.02182304 -0.03155947]
  [FlaxMamba2] C (step) sample values: [ 0.0396718  -0.06681423  0.14981896 -0.04810668 -0.03531695]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.08112868 -3.7998476  -0.08256738 -0.48783726 -1.4532163 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03299914 0.1168758  0.05178729 0.00112597 0.001954  ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9973264  0.64139473 0.9957332  0.99945086 0.9971644 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.15888955 -0.22936703 -0.08664591  0.03363558  0.0832023 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.9172950e-04 -7.7162185e-05 -1.0477144e-03 -1.1442299e-04
  1.6547319e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.9172950e-04 -7.7162185e-05 -1.0477144e-03 -1.1442299e-04
  1.6547319e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00016593  0.00051896 -0.00321792 -0.000136    0.00078307]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00567887 -0.00553268  0.00190214 -0.00100058  0.00056366]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00228926 -0.00063955  0.00375057 -0.00171814 -0.00121131]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00228926 -0.00063955  0.00375057 -0.00171814 -0.00121131]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 8.9295951e-05  1.0176990e-04 -2.6430585e-04 -4.7826904e-04
  2.1218166e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01899255  0.00274606 -0.01252527 -0.03636189  0.00472671]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01899255  0.00274606 -0.01252527 -0.03636189  0.00472671]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.6427967   1.1700157  -1.1381222  -0.40812454  0.19310798]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.6427967   1.1700157  -1.1381222  -0.40812454  0.19310798]
  [Layer 23] Output shape after mixer: (1, 1, 2048)
  [Layer 23] Output sample values after mixer: [ 0.6427967   1.1700157  -1.1381222  -0.40812454  0.19310798]
  [Layer 23] Residual connection shape: (1, 1, 2048)
  [Layer 23] Residual connection sample values: [-1.5089805  1.6517577  0.4682145 -1.6891477  3.6508145]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.06147804  0.06420806  0.01758818 -0.06121041  0.14423631]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.06147804  0.06420806  0.01758818 -0.06121041  0.14423631]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.06147804  0.06420806  0.01758818 -0.06121041  0.14423631]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.6313806  -0.59797305  0.619824   -0.0405669  -0.08283518]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.6313806  -0.59797305  0.619824   -0.0405669  -0.08283518]
  [FlaxMamba2] xBC (step) sample values: [-0.05577047  0.08314759  0.11900157 -0.4576761  -0.2301986 ]
  [FlaxMamba2] dt (step) sample values: [2.6934853  0.41469234 0.45957074 1.5550023  1.1322603 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.7060827   0.00151273 -0.5737442  -0.05577047  0.54867405]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00492623  0.0441806   0.01271336 -0.08435318 -0.08752168]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00827172  0.04417148  0.0087537  -0.08597061 -0.09225572]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00411875  0.02257344  0.00439601 -0.04113871 -0.04400158]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00411875  0.02257344  0.00439601 -0.04113871 -0.04400158]
  [FlaxMamba2] B (step) sample values: [ 0.01813481  0.06991003  0.01107105 -0.04467338 -0.03165964]
  [FlaxMamba2] C (step) sample values: [-0.20245963 -0.27447033 -0.18384725 -0.02772164  0.21426293]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.07415762 -3.4496791  -3.2884939  -0.16087165 -2.6944954 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.07845595 0.04368857 0.07144243 0.0215239  0.06555188]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9941988  0.86009574 0.79061985 0.9965434  0.8380905 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00411875  0.02257344  0.00439601 -0.04113871 -0.04400158]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.8600954e-06 -2.2590775e-05 -3.5775076e-06  1.4435786e-05
  1.0230519e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.8600954e-06 -2.2590775e-05 -3.5775076e-06  1.4435786e-05
  1.0230519e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [1.2618481e-04 5.2894140e-04 9.9756362e-05 4.7970749e-05 6.8420003e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00049042 -0.00039213  0.00019447 -0.00135197 -0.0022458 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00046849 -0.0005123   0.00017107 -0.00113296 -0.00201155]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00046849 -0.0005123   0.00017107 -0.00113296 -0.00201155]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-1.9309648e-04  1.0869189e-04  6.8940906e-05  2.2514248e-05
  7.9864993e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.01491186  0.01189075  0.00681093  0.00811435  0.01702847]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01491186  0.01189075  0.00681093  0.00811435  0.01702847]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.4492171   0.19766189  0.8760897   0.01113774 -1.0214874 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.4492171   0.19766189  0.8760897   0.01113774 -1.0214874 ]
  [Layer 24] Output shape after mixer: (1, 1, 2048)
  [Layer 24] Output sample values after mixer: [-0.4492171   0.19766189  0.8760897   0.01113774 -1.0214874 ]
  [Layer 24] Residual connection shape: (1, 1, 2048)
  [Layer 24] Residual connection sample values: [-1.9581976  1.8494196  1.3443042 -1.67801    2.6293273]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.07989203  0.06896535  0.05179146 -0.0604428   0.10613115]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.07989203  0.06896535  0.05179146 -0.0604428   0.10613115]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.07989203  0.06896535  0.05179146 -0.0604428   0.10613115]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.3646051  -0.27817976  1.1048696  -0.10967769 -0.12775913]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.3646051  -0.27817976  1.1048696  -0.10967769 -0.12775913]
  [FlaxMamba2] xBC (step) sample values: [ 0.06107979 -0.22494169 -1.1925755  -0.07694982 -0.9307882 ]
  [FlaxMamba2] dt (step) sample values: [ 1.1297193 -1.2214007  1.0834106  1.3766776  0.0918399]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.81913954 -1.5077785  -0.5970689   0.06107979 -0.11455661]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.17863205 -0.14040062  0.07607159  0.01094325  0.03475149]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.17607811 -0.16861412  0.06465802  0.07176478  0.02898748]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.09576996 -0.07721616  0.03337381  0.03716939  0.01470379]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.09576996 -0.07721616  0.03337381  0.03716939  0.01470379]
  [FlaxMamba2] B (step) sample values: [0.04891849 0.03513286 0.0195441  0.01424479 0.02921111]
  [FlaxMamba2] C (step) sample values: [ 0.00639834  0.06655501  0.01072282 -0.09784489 -0.13645174]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -0.37022203  -1.5044799   -5.7209826   -0.81757224 -14.66622   ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.3750637  0.00188632 0.07551015 0.02759075 0.03571022]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8703526 0.9971661 0.6492144 0.9776951 0.5923048]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.09576996 -0.07721616  0.03337381  0.03716939  0.01470379]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00175714 0.00126197 0.00070202 0.00051167 0.00104926]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00175714 0.00126197 0.00070202 0.00051167 0.00104926]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00626699 -0.00325192 -0.00075649  0.00181719  0.00209335]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00256093 -0.00029736  0.00434289  0.00042673  0.00613108]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00156043 -0.00110402  0.00469154  0.00081503  0.00628469]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00156043 -0.00110402  0.00469154  0.00081503  0.00628469]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-3.3576365e-04  1.3233678e-04  3.8937284e-03 -4.2246669e-05
 -3.7585266e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.03085734  0.00830806  0.3946178  -0.00255406 -0.04975568]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03085734  0.00830806  0.3946178  -0.00255406 -0.04975568]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.15827847 -0.7479709  -1.0873945   1.62168    -0.22836037]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.15827847 -0.7479709  -1.0873945   1.62168    -0.22836037]
  [Layer 25] Output shape after mixer: (1, 1, 2048)
  [Layer 25] Output sample values after mixer: [-0.15827847 -0.7479709  -1.0873945   1.62168    -0.22836037]
  [Layer 25] Residual connection shape: (1, 1, 2048)
  [Layer 25] Residual connection sample values: [-2.116476    1.1014488   0.25690973 -0.05632997  2.400967  ]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.09899899  0.04767295  0.01119563 -0.00240806  0.10981835]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09899899  0.04767295  0.01119563 -0.00240806  0.10981835]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09899899  0.04767295  0.01119563 -0.00240806  0.10981835]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.278096   -0.04630047 -0.21006776  0.38799334 -0.5011257 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.278096   -0.04630047 -0.21006776  0.38799334 -0.5011257 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.8584322  -0.451671    0.15670042 -0.70686215 -0.1332637 ]
  [FlaxMamba2] dt (step) sample values: [1.2770778 1.1028975 1.2693499 1.1627975 2.2095294]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.3082994   0.8974074   1.1812847   0.8584322  -0.35453346]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.22492819  0.12979767  0.047722    0.10562302  0.10538431]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.31342918  0.07373688  0.11186995  0.078676    0.11349435]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.13235423  0.0382271   0.05906044  0.04088468  0.05996396]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.13235423  0.0382271   0.05906044  0.04088468  0.05996396]
  [FlaxMamba2] B (step) sample values: [-0.04632655  0.01070457  0.03334683 -0.00057456  0.06788668]
  [FlaxMamba2] C (step) sample values: [-0.18077555  0.01504603  0.1308239   0.2578224   0.14960654]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9594627  -0.39448437 -0.84198165 -1.4275463  -0.14661841]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.19025306 0.29868582 0.2067883  0.30978635 0.09570204]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.83315074 0.8888499  0.8402028  0.64259905 0.9860663 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.13235423  0.0382271   0.05906044  0.04088468  0.05996396]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.1665395e-03 -2.6954972e-04 -8.3969982e-04  1.4467903e-05
 -1.7094408e-03]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.1665395e-03 -2.6954972e-04 -8.3969982e-04  1.4467903e-05
 -1.7094408e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00133812 -0.00142101 -0.00327863  0.00146666 -0.00257259]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01073807  0.01195354  0.00719097 -0.00199398  0.01537978]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02759799  0.01682309  0.01471437  0.00321411  0.02301828]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02759799  0.01682309  0.01471437  0.00321411  0.02301828]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02758782 -0.00038044 -0.00138377  0.00074299 -0.0043519 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.39876825 -0.01221194 -0.03779623  0.03089735 -0.15799858]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.39876825 -0.01221194 -0.03779623  0.03089735 -0.15799858]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.66788745 -0.13999337  0.8025172   1.6108042   1.4215674 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.66788745 -0.13999337  0.8025172   1.6108042   1.4215674 ]
  [Layer 26] Output shape after mixer: (1, 1, 2048)
  [Layer 26] Output sample values after mixer: [-0.66788745 -0.13999337  0.8025172   1.6108042   1.4215674 ]
  [Layer 26] Residual connection shape: (1, 1, 2048)
  [Layer 26] Residual connection sample values: [-2.7843635  0.9614554  1.0594269  1.5544742  3.8225343]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.1295277   0.04081237  0.04824906  0.06501479  0.18498166]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.1295277   0.04081237  0.04824906  0.06501479  0.18498166]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.1295277   0.04081237  0.04824906  0.06501479  0.18498166]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.64042306 -0.22925107 -0.38856146 -0.1948222   1.4145085 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.64042306 -0.22925107 -0.38856146 -0.1948222   1.4145085 ]
  [FlaxMamba2] xBC (step) sample values: [-0.31111884 -0.07905626  0.00574073 -0.04947012  0.6838477 ]
  [FlaxMamba2] dt (step) sample values: [1.064957  1.1164036 1.0470619 1.5372664 1.5863826]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.38961276 -1.2518519  -1.3849553  -0.31111884  0.2958978 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.2604959  -0.22395311  0.00113955 -0.25862744  0.09489541]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.28649688 -0.26045215 -0.00887021 -0.46053174  0.06511025]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.12286754 -0.11336247 -0.00441544 -0.17816116  0.03361459]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.12286754 -0.11336247 -0.00441544 -0.17816116  0.03361459]
  [FlaxMamba2] B (step) sample values: [-0.01403977 -0.0743985  -0.16490886 -0.03700765 -0.01997916]
  [FlaxMamba2] C (step) sample values: [-0.09373079 -0.2573497  -0.12407489  0.17867374 -0.22149329]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3661706 -1.3799144 -1.8267511 -2.0408754 -2.3490334]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11798549 0.1372169  0.13289845 0.0755633  0.20328377]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8511318  0.82749885 0.78445005 0.8570875  0.62031966]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.12286754 -0.11336247 -0.00441544 -0.17816116  0.03361459]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00020353 0.00107852 0.00239062 0.00053648 0.00028963]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00020353 0.00107852 0.00239062 0.00053648 0.00028963]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00200422  0.00252186  0.00457284 -0.0027892   0.00064032]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01826076 -0.01538525  0.00112961 -0.05387858 -0.00407517]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03068708 -0.02685026  0.00068305 -0.07189705 -0.00067553]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03068708 -0.02685026  0.00068305 -0.07189705 -0.00067553]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00678315  0.00272648 -0.00010724  0.00632349 -0.00076871]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.15226668  0.04449868 -0.00302272  0.16037796 -0.01198853]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.15226668  0.04449868 -0.00302272  0.16037796 -0.01198853]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.89985347  1.1390054   0.1225864   1.8636676  -1.4115319 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.89985347  1.1390054   0.1225864   1.8636676  -1.4115319 ]
  [Layer 27] Output shape after mixer: (1, 1, 2048)
  [Layer 27] Output sample values after mixer: [-0.89985347  1.1390054   0.1225864   1.8636676  -1.4115319 ]
  [Layer 27] Residual connection shape: (1, 1, 2048)
  [Layer 27] Residual connection sample values: [-3.684217   2.1004608  1.1820133  3.4181418  2.4110024]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.15062784  0.08035112  0.04568174  0.12840478  0.09756527]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.15062784  0.08035112  0.04568174  0.12840478  0.09756527]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.15062784  0.08035112  0.04568174  0.12840478  0.09756527]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.7042235  -0.08027205  0.20879248 -0.2500502  -0.06843236]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.7042235  -0.08027205  0.20879248 -0.2500502  -0.06843236]
  [FlaxMamba2] xBC (step) sample values: [-1.1665969  -1.2984579  -0.42646265 -0.8168064  -0.1137608 ]
  [FlaxMamba2] dt (step) sample values: [1.3929989 0.7234413 1.4700913 1.6108378 1.8546822]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.56316453 -0.02071643 -1.4833286  -1.1665969  -0.7451325 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.09933406  0.38978574 -0.10183395 -0.15431845 -0.04707993]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04156429  0.37842557 -0.1154982  -0.16569388  0.05759536]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02121398  0.22459306 -0.05441784 -0.07599898  0.02962676]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02121398  0.22459306 -0.05441784 -0.07599898  0.02962676]
  [FlaxMamba2] B (step) sample values: [-0.02573573 -0.05733455 -0.03436362 -0.04269945  0.17779806]
  [FlaxMamba2] C (step) sample values: [-0.20914793 -0.13418694  0.38633627 -0.1867222   0.35688373]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2727895 -3.997792  -2.517685  -2.1714401 -2.8654757]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04038516 0.08867425 0.17024207 0.08294998 0.09364118]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.94989693 0.7015233  0.6514101  0.8351692  0.7646581 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02121398  0.22459306 -0.05441784 -0.07599898  0.02962676]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.2048573e-05 -4.9120226e-05 -2.9440338e-05 -3.6581892e-05
  1.5232492e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.2048573e-05 -4.9120226e-05 -2.9440338e-05 -3.6581892e-05
  1.5232492e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-7.1914968e-05 -2.1293061e-04 -4.3971628e-05  2.2627536e-04
  4.8900611e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00124234  0.01552481 -0.00093831 -0.00539083  0.00646632]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00584095  0.06421045 -0.01273462 -0.02186533  0.01288859]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00584095  0.06421045 -0.01273462 -0.02186533  0.01288859]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00136101 -0.00247377 -0.00146773  0.0023937  -0.00042591]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.06747109 -0.08127509 -0.04568218  0.0860331  -0.01484985]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.06747109 -0.08127509 -0.04568218  0.0860331  -0.01484985]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.4545631  -2.126853   -0.53511995  3.1998532   1.4898093 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.4545631  -2.126853   -0.53511995  3.1998532   1.4898093 ]
  [Layer 28] Output shape after mixer: (1, 1, 2048)
  [Layer 28] Output sample values after mixer: [ 2.4545631  -2.126853   -0.53511995  3.1998532   1.4898093 ]
  [Layer 28] Residual connection shape: (1, 1, 2048)
  [Layer 28] Residual connection sample values: [-1.2296538  -0.02639222  0.6468933   6.6179953   3.9008117 ]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.04301465 -0.00088299  0.02167127  0.2135167   0.13567889]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04301465 -0.00088299  0.02167127  0.2135167   0.13567889]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04301465 -0.00088299  0.02167127  0.2135167   0.13567889]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.7589518  -0.5196182  -0.4186319  -0.00452065  0.36526158]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.7589518  -0.5196182  -0.4186319  -0.00452065  0.36526158]
  [FlaxMamba2] xBC (step) sample values: [-1.7794938  -0.19880426  0.9500365  -1.011795   -1.689404  ]
  [FlaxMamba2] dt (step) sample values: [1.8905929 1.5537177 2.054316  1.4443938 1.5483276]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.76493245  0.21881273 -0.40778008 -1.7794938   0.5886976 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.07106744  0.08377962 -0.16441801  0.18470356 -0.20518798]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.08447228  0.04926424 -0.16157034  0.12427875 -0.31828612]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04045331  0.02523874 -0.07427309  0.06599572 -0.13402821]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04045331  0.02523874 -0.07427309  0.06599572 -0.13402821]
  [FlaxMamba2] B (step) sample values: [ 0.04365508 -0.0411211   0.01616501 -0.05497961 -0.05061558]
  [FlaxMamba2] C (step) sample values: [-0.25331214 -0.27842635 -0.09353384 -0.27528417 -0.00280756]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8072329  -2.117      -1.925669   -0.29044876 -2.049864  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1328712  0.21480426 0.41380274 0.00665716 0.26607287]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.78652626 0.63461256 0.45074788 0.99806833 0.57960224]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04045331  0.02523874 -0.07427309  0.06599572 -0.13402821]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.3464953e-04  2.2102922e-04 -8.6888213e-05  2.9551977e-04
  2.7206278e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.3464953e-04  2.2102922e-04 -8.6888213e-05  2.9551977e-04
  2.7206278e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00090636  0.00058074 -0.00067725  0.00040334  0.00028641]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0088415   0.00380039 -0.01230067  0.01113868 -0.02624632]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05020618  0.02960773 -0.08824705  0.07862122 -0.16329406]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05020618  0.02960773 -0.08824705  0.07862122 -0.16329406]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01215039 -0.0057376   0.01466063 -0.00017731 -0.03520928]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.10536287 -0.046822    0.18956064 -0.00205645 -0.3622941 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.10536287 -0.046822    0.18956064 -0.00205645 -0.3622941 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.6001789   1.2670848  -0.40159035  1.1057935   0.8878914 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.6001789   1.2670848  -0.40159035  1.1057935   0.8878914 ]
  [Layer 29] Output shape after mixer: (1, 1, 2048)
  [Layer 29] Output sample values after mixer: [-0.6001789   1.2670848  -0.40159035  1.1057935   0.8878914 ]
  [Layer 29] Residual connection shape: (1, 1, 2048)
  [Layer 29] Residual connection sample values: [-1.8298328   1.2406926   0.24530298  7.7237887   4.788703  ]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.06290811  0.04196916  0.00823989  0.24467807  0.16916272]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.06290811  0.04196916  0.00823989  0.24467807  0.16916272]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.06290811  0.04196916  0.00823989  0.24467807  0.16916272]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.20107716 -0.82214934  0.14471233 -0.18710004  0.04131168]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.20107716 -0.82214934  0.14471233 -0.18710004  0.04131168]
  [FlaxMamba2] xBC (step) sample values: [ 0.4020718  -0.38845024 -0.7761282  -0.00837689  0.8945937 ]
  [FlaxMamba2] dt (step) sample values: [1.5240029 1.8036213 1.4371777 1.8233619 1.6543478]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.1255277   1.1604306   1.0086272   0.4020718  -0.62038404]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.05962282 -0.05343923 -0.32146072 -0.0035083  -0.19289955]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0363379  -0.03973683 -0.28831863 -0.021651   -0.2202433 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01849903 -0.01947371 -0.12352019 -0.01070831 -0.09804366]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01849903 -0.01947371 -0.12352019 -0.01070831 -0.09804366]
  [FlaxMamba2] B (step) sample values: [ 0.09963261  0.05567167 -0.0383487   0.16788593  0.00658194]
  [FlaxMamba2] C (step) sample values: [-0.2768969  -0.23950648  0.06689941 -0.11142062 -0.2783199 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0149885  -0.4675477  -0.42799968 -0.7895216  -0.4174731 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0181601  0.51086646 0.75483733 0.30319187 0.4523754 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.98173654 0.78752947 0.7239231  0.78711843 0.8279069 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01849903 -0.01947371 -0.12352019 -0.01070831 -0.09804366]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.3470998e-05  1.8702574e-05 -1.2883025e-05  5.6400306e-05
  2.2111649e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.3470998e-05  1.8702574e-05 -1.2883025e-05  5.6400306e-05
  2.2111649e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [6.5668928e-04 6.5322718e-05 3.2477903e-05 1.3842409e-03 1.4125355e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00194536 -0.00076455 -0.00272211 -0.00055012 -0.00082972]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02473476 -0.02475468 -0.1548896  -0.01374195 -0.12161206]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02473476 -0.02475468 -0.1548896  -0.01374195 -0.12161206]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00223762  0.00621363 -0.01201672  0.00116564 -0.00256388]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.02581935  0.07276925 -0.08543675  0.01116578 -0.02182624]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02581935  0.07276925 -0.08543675  0.01116578 -0.02182624]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.6493747 -1.938236   1.0694875  0.2112294  2.7200265]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.6493747 -1.938236   1.0694875  0.2112294  2.7200265]
  [Layer 30] Output shape after mixer: (1, 1, 2048)
  [Layer 30] Output sample values after mixer: [ 1.6493747 -1.938236   1.0694875  0.2112294  2.7200265]
  [Layer 30] Residual connection shape: (1, 1, 2048)
  [Layer 30] Residual connection sample values: [-0.18045807 -0.6975434   1.3147905   7.935018    7.5087295 ]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00581479 -0.02205218  0.04168705  0.24486093  0.24444057]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00581479 -0.02205218  0.04168705  0.24486093  0.24444057]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00581479 -0.02205218  0.04168705  0.24486093  0.24444057]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.0720129  -0.300955    0.05457117  1.4672781  -0.33852825]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.0720129  -0.300955    0.05457117  1.4672781  -0.33852825]
  [FlaxMamba2] xBC (step) sample values: [-0.7321551  -0.69987726 -0.48638606 -0.65261227 -0.4883969 ]
  [FlaxMamba2] dt (step) sample values: [1.8283389  1.7908398  1.6977731  0.83222824 1.1447103 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.07625837  0.26194924  0.6666407  -0.7321551   0.3346107 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.13296162  0.10602546 -0.03688573  0.11023382  0.07322234]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.13345705  0.09570289 -0.03587102  0.10833601  0.06791991]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06228243  0.05013946 -0.01761386  0.05709931  0.03511279]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06228243  0.05013946 -0.01761386  0.05709931  0.03511279]
  [FlaxMamba2] B (step) sample values: [-0.09428991 -0.07156307  0.04999529 -0.27699938 -0.04283117]
  [FlaxMamba2] C (step) sample values: [-0.01943325 -0.13086925 -0.17925708 -0.06762917 -0.12143681]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.9477868 -3.5383902 -4.705952  -2.462968  -0.9027082]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.18966027 0.12901838 0.08334123 0.1324144  0.12509929]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.5717359  0.63348603 0.6755691  0.7217096  0.8932148 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06228243  0.05013946 -0.01761386  0.05709931  0.03511279]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0011138   0.00084534 -0.00059057  0.00327206  0.00050594]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0011138   0.00084534 -0.00059057  0.00327206  0.00050594]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00219702 0.00074295 0.00012982 0.00121895 0.00056972]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00618679  0.01150682 -0.00245446  0.00507309  0.01942718]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04903812  0.04600359 -0.01457309  0.04435835  0.04358536]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04903812  0.04600359 -0.01457309  0.04435835  0.04358536]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0134063  -0.00588862 -0.00040848  0.05289174 -0.00614049]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.20193294 -0.07748391 -0.00478617  0.65962446 -0.09074891]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.20193294 -0.07748391 -0.00478617  0.65962446 -0.09074891]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.0899273  2.533996  -1.8518925 -3.2052245  1.3681235]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.0899273  2.533996  -1.8518925 -3.2052245  1.3681235]
  [Layer 31] Output shape after mixer: (1, 1, 2048)
  [Layer 31] Output sample values after mixer: [ 1.0899273  2.533996  -1.8518925 -3.2052245  1.3681235]
  [Layer 31] Residual connection shape: (1, 1, 2048)
  [Layer 31] Residual connection sample values: [ 0.90946925  1.8364527  -0.537102    4.7297935   8.876853  ]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0284407   0.05767624 -0.01682323  0.13875912  0.28864482]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0284407   0.05767624 -0.01682323  0.13875912  0.28864482]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0284407   0.05767624 -0.01682323  0.13875912  0.28864482]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.3308218  -0.6973139  -2.3049924  -0.41115603 -1.737141  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.3308218  -0.6973139  -2.3049924  -0.41115603 -1.737141  ]
  [FlaxMamba2] xBC (step) sample values: [0.16980265 0.01709211 0.8387961  1.1511693  1.0727506 ]
  [FlaxMamba2] dt (step) sample values: [0.69400275 2.87011    1.527826   1.5665019  1.4667541 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.49158794  0.05904174 -0.19899184  0.16980265 -0.18140157]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.05845162 -0.10877234 -0.31255323 -0.24549866 -0.17646976]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.09562203 -0.16080481 -0.32839185 -0.23301697 -0.18344302]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.05009517 -0.07395175 -0.13747533 -0.10299534 -0.0833322 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05009517 -0.07395175 -0.13747533 -0.10299534 -0.0833322 ]
  [FlaxMamba2] B (step) sample values: [ 0.07179552 -0.01972065 -0.07186202 -0.10624628 -0.11919114]
  [FlaxMamba2] C (step) sample values: [-0.25984156  0.10650875  0.00733113 -0.2711273  -0.23574504]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6970906 -2.0892735 -1.7966746 -1.3893797 -1.0395182]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1507567  0.0918934  0.4461699  0.41066134 0.5573352 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9002425  0.82531476 0.44860068 0.5652062  0.5602567 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05009517 -0.07395175 -0.13747533 -0.10299534 -0.0833322 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00054221 -0.00014893 -0.00054272 -0.00080239 -0.00090015]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00054221 -0.00014893 -0.00054272 -0.00080239 -0.00090015]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.4837926e-03  2.9812243e-03 -9.5632684e-05 -4.2769788e-03
 -2.0142407e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.02757731 -0.05136632 -0.00349144 -0.03740738 -0.01665989]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03959393 -0.06910557 -0.03646846 -0.06211348 -0.03664928]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03959393 -0.06910557 -0.03646846 -0.06211348 -0.03664928]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01101396  0.01601817  0.00762507  0.01018047  0.00952915]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.08139089  0.09521968  0.08802909  0.09619973  0.07364238]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.08139089  0.09521968  0.08802909  0.09619973  0.07364238]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.2079714  -0.59645563  1.1783518  -0.85414577  2.059117  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.2079714  -0.59645563  1.1783518  -0.85414577  2.059117  ]
  [Layer 32] Output shape after mixer: (1, 1, 2048)
  [Layer 32] Output sample values after mixer: [-0.2079714  -0.59645563  1.1783518  -0.85414577  2.059117  ]
  [Layer 32] Residual connection shape: (1, 1, 2048)
  [Layer 32] Residual connection sample values: [ 0.70149785  1.2399971   0.6412498   3.8756478  10.93597   ]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.01935217 0.0354484  0.01802008 0.10575386 0.3124756 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.01935217 0.0354484  0.01802008 0.10575386 0.3124756 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.01935217 0.0354484  0.01802008 0.10575386 0.3124756 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [0.17262517 1.2078917  1.1612625  0.08002517 0.34347165]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [0.17262517 1.2078917  1.1612625  0.08002517 0.34347165]
  [FlaxMamba2] xBC (step) sample values: [ 0.4439851  -2.928757    0.30137113 -1.7427633   0.3585797 ]
  [FlaxMamba2] dt (step) sample values: [-1.695856    2.6767986   1.4767417   0.89753455  0.30523443]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.0278451  -0.82687455  0.7821941   0.4439851  -0.00706927]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06766215 -0.4968243  -0.06816272 -0.31864914 -0.07165973]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0545167  -0.5462017  -0.04133777 -0.31985554 -0.07284896]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02800119 -0.20031732 -0.02024175 -0.13456672 -0.03509832]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02800119 -0.20031732 -0.02024175 -0.13456672 -0.03509832]
  [FlaxMamba2] B (step) sample values: [-0.17340651  0.03064205 -0.04950522  0.00379985 -0.01247192]
  [FlaxMamba2] C (step) sample values: [ 0.05230247 -0.06715797 -0.00282074  0.00122969 -0.20070353]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9790505  -9.693779   -6.1677613  -0.11351943 -2.090294  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00216694 0.13619927 0.05552116 0.01982153 0.00389417]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9957207  0.26705903 0.7100348  0.9977524  0.9918931 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02800119 -0.20031732 -0.02024175 -0.13456672 -0.03509832]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0521762e-05  1.8592635e-06 -3.0038211e-06  2.3056324e-07
 -7.5675672e-07]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0521762e-05  1.8592635e-06 -3.0038211e-06  2.3056324e-07
 -7.5675672e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.4612395e-05  7.2238880e-05 -7.4752796e-05 -1.8863569e-05
  6.2073799e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 4.67743776e-05  1.04816165e-04  3.65207059e-04  2.04300761e-07
 -3.13344121e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02920361 -0.2084799  -0.02071195 -0.14012028 -0.03686022]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02920361 -0.2084799  -0.02071195 -0.14012028 -0.03686022]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00273766 -0.19388355 -0.0183171  -0.00583079 -0.00740678]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.04153417 -1.7530637  -0.20869227 -0.06488302 -0.09327835]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04153417 -1.7530637  -0.20869227 -0.06488302 -0.09327835]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 4.337319  -4.398031  -0.9898607 -3.72878    3.4470146]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 4.337319  -4.398031  -0.9898607 -3.72878    3.4470146]
  [Layer 33] Output shape after mixer: (1, 1, 2048)
  [Layer 33] Output sample values after mixer: [ 4.337319  -4.398031  -0.9898607 -3.72878    3.4470146]
  [Layer 33] Residual connection shape: (1, 1, 2048)
  [Layer 33] Residual connection sample values: [ 5.038817   -3.158034   -0.34861094  0.14686775 14.382985  ]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.10012699 -0.06649189 -0.0069229   0.00294247  0.29975235]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10012699 -0.06649189 -0.0069229   0.00294247  0.29975235]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10012699 -0.06649189 -0.0069229   0.00294247  0.29975235]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.9944522   0.6779307   1.3666824  -0.30635497 -0.19554256]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.9944522   0.6779307   1.3666824  -0.30635497 -0.19554256]
  [FlaxMamba2] xBC (step) sample values: [-0.770059   -1.1400268   0.6138264  -1.2664692  -0.33048585]
  [FlaxMamba2] dt (step) sample values: [2.2524834 1.5767424 3.0720491 1.2322886 1.8109628]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5365614  -0.66166776  0.25822285 -0.770059   -0.23370919]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.16825315  0.19478598  0.08301312  0.31164408 -0.0695217 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.13636228  0.22081748  0.07107311  0.2721238  -0.078059  ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.07282262  0.12254954  0.03679887  0.15446134 -0.03750697]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.07282262  0.12254954  0.03679887  0.15446134 -0.03750697]
  [FlaxMamba2] B (step) sample values: [-0.14209323  0.0416919   0.03238855  0.05971873 -0.02945742]
  [FlaxMamba2] C (step) sample values: [-0.04065635 -0.14123529 -0.27317655 -0.06276674 -0.23003797]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.5610816  -2.4810736  -2.893596   -0.01585086 -0.02613366]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.41212544 0.14803626 0.18524683 0.0484885  0.04494925]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.34802294 0.69260955 0.5850667  0.9992317  0.998826  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.07282262  0.12254954  0.03679887  0.15446134 -0.03750697]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00426451  0.00125126  0.00097205  0.00179228 -0.00088408]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00426451  0.00125126  0.00097205  0.00179228 -0.00088408]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00360692  0.00113837  0.00110515  0.00160246 -0.00067762]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00473819  0.01038316  0.00206088  0.01360474 -0.00320426]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.04959278  0.0858667   0.02472689  0.10874414 -0.02630642]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.04959278  0.0858667   0.02472689  0.10874414 -0.02630642]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03600023  0.03861045  0.02692838 -0.01412542  0.00232134]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 1.0978636   1.1451106   0.91308033 -0.53856707  0.08406077]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 1.0978636   1.1451106   0.91308033 -0.53856707  0.08406077]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.2455728 -2.1574578 -0.6547846 -1.4642955  2.6218228]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.2455728 -2.1574578 -0.6547846 -1.4642955  2.6218228]
  [Layer 34] Output shape after mixer: (1, 1, 2048)
  [Layer 34] Output sample values after mixer: [ 3.2455728 -2.1574578 -0.6547846 -1.4642955  2.6218228]
  [Layer 34] Residual connection shape: (1, 1, 2048)
  [Layer 34] Residual connection sample values: [ 8.2843895 -5.3154917 -1.0033956 -1.3174278 17.004808 ]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.17141962 -0.10977981 -0.02038964 -0.02511066  0.3482067 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.17141962 -0.10977981 -0.02038964 -0.02511066  0.3482067 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.17141962 -0.10977981 -0.02038964 -0.02511066  0.3482067 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.2964741  -0.78661597  1.0567435  -1.2143798  -0.9339398 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.2964741  -0.78661597  1.0567435  -1.2143798  -0.9339398 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.96487004  0.8360199   1.0298575  -0.5382524  -0.00968171]
  [FlaxMamba2] dt (step) sample values: [2.2844799  0.49182287 1.1158254  1.5139623  1.847469  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.697997   -0.04688474  0.8682969   0.96487004  0.5343826 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.16174391 -0.21343938 -0.17848249 -0.14837791 -0.02632322]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.31774977 -0.17230168 -0.21467634 -0.1933303  -0.0677966 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.1338439  -0.07874718 -0.09586073 -0.08735    -0.03274965]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.1338439  -0.07874718 -0.09586073 -0.08735    -0.03274965]
  [FlaxMamba2] B (step) sample values: [-0.01247278  0.23421355 -0.275492    0.17528541 -0.06392778]
  [FlaxMamba2] C (step) sample values: [-0.2598606   0.35717565 -0.22705494  0.23156792 -0.12314482]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.709799  -2.7746034 -0.4452666 -1.139112  -3.5906036]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08593964 0.02764153 0.41978922 0.27225098 0.15395129]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9408234  0.926173   0.82951164 0.73335576 0.5753492 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.1338439  -0.07874718 -0.09586073 -0.08735    -0.03274965]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00014347 -0.00269404  0.00316885 -0.00201622  0.00073533]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00014347 -0.00269404  0.00316885 -0.00201622  0.00073533]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00410559 -0.01498709  0.02482095 -0.02131574  0.00022401]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.07983808 -0.06065422 -0.06084054 -0.11723948 -0.02595849]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.17036052 -0.11391319 -0.12567389 -0.17631677 -0.04810801]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.17036052 -0.11391319 -0.12567389 -0.17631677 -0.04810801]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02153738  0.02803731 -0.09855035  0.04901683  0.01267592]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.42585474  0.29492703 -0.7324799   0.42112702  0.14623088]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.42585474  0.29492703 -0.7324799   0.42112702  0.14623088]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.0276744  0.9852032 -1.3769543 -0.7084785  2.6365402]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.0276744  0.9852032 -1.3769543 -0.7084785  2.6365402]
  [Layer 35] Output shape after mixer: (1, 1, 2048)
  [Layer 35] Output sample values after mixer: [ 1.0276744  0.9852032 -1.3769543 -0.7084785  2.6365402]
  [Layer 35] Residual connection shape: (1, 1, 2048)
  [Layer 35] Residual connection sample values: [ 9.312064  -4.3302884 -2.3803499 -2.0259063 19.641348 ]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15255728 -0.07182442 -0.03872507 -0.03274409  0.3294637 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15255728 -0.07182442 -0.03872507 -0.03274409  0.3294637 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15255728 -0.07182442 -0.03872507 -0.03274409  0.3294637 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.287843   0.6145865 -1.2935978 -1.1008618 -0.8071184]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.287843   0.6145865 -1.2935978 -1.1008618 -0.8071184]
  [FlaxMamba2] xBC (step) sample values: [ 0.22343971  1.6855369   0.6235329   0.20292774 -0.9585565 ]
  [FlaxMamba2] dt (step) sample values: [ 1.275355    0.6248087   1.5238903   0.9866042  -0.10361499]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.54411405 -0.4720742   0.03408239  0.22343971  1.0577841 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02719992  0.2965222   0.14852874  0.02879739  0.18383133]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.06339377  0.29638845  0.12004058  0.00386453  0.15596879]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03069253  0.16999638  0.06361841  0.001936    0.08405366]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03069253  0.16999638  0.06361841  0.001936    0.08405366]
  [FlaxMamba2] B (step) sample values: [ 0.0864367   0.33939952  0.04012822 -0.0415364  -0.0152955 ]
  [FlaxMamba2] C (step) sample values: [ 0.39810523 -0.2751989   0.4167071  -0.05850286 -0.17735064]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6566098 -1.1305923 -1.6058172 -2.4414158 -2.882315 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1450254  0.00687274 0.09533778 0.09532171 0.03703042]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6802629  0.99225986 0.8580482  0.79237545 0.8987653 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03069253  0.16999638  0.06361841  0.001936    0.08405366]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.8474670e-04 -1.5107339e-03 -1.7861856e-04  1.8488667e-04
  6.8083282e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.8474670e-04 -1.5107339e-03 -1.7861856e-04  1.8488667e-04
  6.8083282e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-6.8659789e-04 -2.1416114e-03 -3.7696314e-04  4.5382296e-04
  9.7272015e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0027661   0.02120665  0.00453943 -0.00203132  0.00858598]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-3.7933204e-02  2.1598627e-01  7.7432565e-02  1.8691993e-04
  1.0489356e-01]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-3.7933204e-02  2.1598627e-01  7.7432565e-02  1.8691993e-04
  1.0489356e-01]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 1.0562690e-02  8.6147897e-02 -2.1560306e-02 -5.1356514e-05
 -2.6118493e-02]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 1.5734440e-01  1.8720189e+00 -3.1646964e-01 -8.4843877e-04
 -3.7354609e-01]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 1.5734440e-01  1.8720189e+00 -3.1646964e-01 -8.4843877e-04
 -3.7354609e-01]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.735048  -2.1988592 -4.603746  -4.275523   2.4925134]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.735048  -2.1988592 -4.603746  -4.275523   2.4925134]
  [Layer 36] Output shape after mixer: (1, 1, 2048)
  [Layer 36] Output sample values after mixer: [-1.735048  -2.1988592 -4.603746  -4.275523   2.4925134]
  [Layer 36] Residual connection shape: (1, 1, 2048)
  [Layer 36] Residual connection sample values: [ 7.577016  -6.5291476 -6.9840956 -6.3014297 22.133862 ]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.12786996 -0.11273322 -0.11645106 -0.10288334  0.37641   ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12786996 -0.11273322 -0.11645106 -0.10288334  0.37641   ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12786996 -0.11273322 -0.11645106 -0.10288334  0.37641   ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.5752584   1.7764091   0.47598985 -3.3742545   0.89073664]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.5752584   1.7764091   0.47598985 -3.3742545   0.89073664]
  [FlaxMamba2] xBC (step) sample values: [ 0.45179865  0.4241732  -0.24928428 -0.39695296 -1.7226627 ]
  [FlaxMamba2] dt (step) sample values: [ 1.1181864  -0.774681   -0.14647914  1.1253121   0.7860153 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.07730158 -0.6521405  -0.252069    0.45179865 -0.06128275]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.113167   -0.0806293   0.01234721 -0.11070029 -0.22461025]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.12554951 -0.10907168  0.01734827 -0.26157922 -0.20987026]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.05883925 -0.05156463  0.00874938 -0.11378057 -0.09396398]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05883925 -0.05156463  0.00874938 -0.11378057 -0.09396398]
  [FlaxMamba2] B (step) sample values: [ 0.3724534   0.2296945   0.02551582 -0.09018698 -0.01859012]
  [FlaxMamba2] C (step) sample values: [-0.1954341  -0.10439505 -0.27317446 -0.2538149  -0.27845144]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.06064401 -3.2470093  -0.81907064 -0.24529998 -1.975189  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0284352  0.00450785 0.00811047 0.00384798 0.02542464]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99827707 0.9854696  0.993379   0.9990565  0.9510216 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05883925 -0.05156463  0.00874938 -0.11378057 -0.09396398]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.2315405e-04 -3.8430328e-04 -4.2690670e-05  1.5089239e-04
  3.1103249e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.2315405e-04 -3.8430328e-04 -4.2690670e-05  1.5089239e-04
  3.1103249e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00072481 -0.00091222 -0.00095975  0.00130643 -0.00025967]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00248976 -0.00868118 -0.01088696  0.03447603  0.04258   ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00870741  0.00113162 -0.01255197  0.05612859  0.06046144]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00870741  0.00113162 -0.01255197  0.05612859  0.06046144]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00320564  0.00171924 -0.00368514 -0.00627074  0.03818562]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.02806614  0.01366164 -0.05770939 -0.1814146   0.24690698]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02806614  0.01366164 -0.05770939 -0.1814146   0.24690698]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.279741   -5.170976    0.24076203 -4.02844    -7.421985  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.279741   -5.170976    0.24076203 -4.02844    -7.421985  ]
  [Layer 37] Output shape after mixer: (1, 1, 2048)
  [Layer 37] Output sample values after mixer: [ 2.279741   -5.170976    0.24076203 -4.02844    -7.421985  ]
  [Layer 37] Residual connection shape: (1, 1, 2048)
  [Layer 37] Residual connection sample values: [  9.856757  -11.700124   -6.7433333 -10.32987    14.711876 ]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13473296 -0.15872537 -0.09104695 -0.13608116  0.1986364 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13473296 -0.15872537 -0.09104695 -0.13608116  0.1986364 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13473296 -0.15872537 -0.09104695 -0.13608116  0.1986364 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.70379305 -0.32588264  0.20846394 -0.81319743 -0.08105169]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.70379305 -0.32588264  0.20846394 -0.81319743 -0.08105169]
  [FlaxMamba2] xBC (step) sample values: [-0.35418734  0.48888022  0.72364366 -0.24835704 -0.03136246]
  [FlaxMamba2] dt (step) sample values: [0.7082766 2.0553718 1.3537635 1.4789077 1.6477549]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.0854717   0.7721357   0.8204461  -0.35418734  0.0791994 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.03906192 -0.09456506 -0.09715441  0.10347427 -0.01250228]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.06715335 -0.13173547 -0.1229265   0.09186997 -0.03375778]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.03470365 -0.06153544 -0.05769027  0.04804352 -0.01659402]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03470365 -0.06153544 -0.05769027  0.04804352 -0.01659402]
  [FlaxMamba2] B (step) sample values: [-0.27813318 -0.2763415   0.00519869  0.05593077 -0.249045  ]
  [FlaxMamba2] C (step) sample values: [-0.15401246 -0.25128865 -0.10535556 -0.07886435 -0.24460123]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0881431 -1.3535548 -1.1764196 -1.6451025 -1.1940706]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10277712 0.21324141 0.5352634  0.17286347 0.11400555]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8941907  0.7492864  0.5327546  0.75248206 0.8727286 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03470365 -0.06153544 -0.05769027  0.04804352 -0.01659402]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.9202886e-04 -9.8563847e-04  1.8542365e-05  1.9949053e-04
 -8.8827888e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.9202886e-04 -9.8563847e-04  1.8542365e-05  1.9949053e-04
 -8.8827888e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00726965 0.00959229 0.00160251 0.00100135 0.00925262]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01941463 -0.02955351 -0.00566113  0.05741009  0.00215309]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00868921 -0.07938637 -0.05238008  0.09631687 -0.01128514]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00868921 -0.07938637 -0.05238008  0.09631687 -0.01128514]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00202403  0.01084608 -0.0060267  -0.02406208  0.00043882]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.03877302  0.200961   -0.11714419 -0.42666462  0.00699962]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03877302  0.200961   -0.11714419 -0.42666462  0.00699962]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.1308948 -3.1339054 -3.796523  -1.508277  -3.067614 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.1308948 -3.1339054 -3.796523  -1.508277  -3.067614 ]
  [Layer 38] Output shape after mixer: (1, 1, 2048)
  [Layer 38] Output sample values after mixer: [-1.1308948 -3.1339054 -3.796523  -1.508277  -3.067614 ]
  [Layer 38] Residual connection shape: (1, 1, 2048)
  [Layer 38] Residual connection sample values: [  8.7258625 -14.834029  -10.539856  -11.838147   11.644262 ]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.09207094 -0.15813053 -0.11139183 -0.12531576  0.12432712]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09207094 -0.15813053 -0.11139183 -0.12531576  0.12432712]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09207094 -0.15813053 -0.11139183 -0.12531576  0.12432712]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.19340475  0.05379139  0.617583    0.7789245  -0.18936484]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.19340475  0.05379139  0.617583    0.7789245  -0.18936484]
  [FlaxMamba2] xBC (step) sample values: [ 0.79485327  0.40460876  1.5980114  -0.9058803   0.37796128]
  [FlaxMamba2] dt (step) sample values: [0.85821795 1.3765098  1.8369864  2.0854259  1.2437297 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.19454132 -0.03167162 -0.19632643  0.79485327  0.04537762]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.11329696 -0.06519802  0.2889499  -0.23142464  0.04939245]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.09896132  0.02000706  0.26661104 -0.22734673  0.02841162]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.051927    0.0101036   0.15097137 -0.10080711  0.0144076 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.051927    0.0101036   0.15097137 -0.10080711  0.0144076 ]
  [FlaxMamba2] B (step) sample values: [ 0.0846962  -0.0064454  -0.00014123  0.00176621 -0.05861942]
  [FlaxMamba2] C (step) sample values: [ 0.3175538   0.04537887  0.03347584  0.07894779 -0.03977216]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.69420344 -0.9242845  -1.3151171  -3.1532621  -2.1087465 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01138335 0.02956623 0.05452214 0.2016764  0.08644543]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9921288 0.9730424 0.9308073 0.5294384 0.8333584]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.051927    0.0101036   0.15097137 -0.10080711  0.0144076 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.0064180e-05 -3.8098956e-06 -8.3481495e-08  1.0440144e-06
 -3.4650122e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.0064180e-05 -3.8098956e-06 -8.3481495e-08  1.0440144e-06
 -3.4650122e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00020656 -0.00012509  0.00010622 -0.00017218  0.00031126]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00066443  0.00564992  0.00069738 -0.00470584  0.00365114]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.04515845  0.01430725  0.13005824 -0.09108312  0.01599639]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.04515845  0.01430725  0.13005824 -0.09108312  0.01599639]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00478791  0.00039515  0.05218252 -0.04863041 -0.0013716 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.14298926  0.01267678  1.711262   -1.2895368  -0.04147254]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.14298926  0.01267678  1.711262   -1.2895368  -0.04147254]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-3.8715305  -4.5301423  -0.25782907 -6.6594696  -5.377144  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-3.8715305  -4.5301423  -0.25782907 -6.6594696  -5.377144  ]
  [Layer 39] Output shape after mixer: (1, 1, 2048)
  [Layer 39] Output sample values after mixer: [-3.8715305  -4.5301423  -0.25782907 -6.6594696  -5.377144  ]
  [Layer 39] Residual connection shape: (1, 1, 2048)
  [Layer 39] Residual connection sample values: [  4.854332  -19.364172  -10.797685  -18.497616    6.2671185]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04481705 -0.18017648 -0.10314318 -0.17239988  0.05769872]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.04481705 -0.18017648 -0.10314318 -0.17239988  0.05769872]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.04481705 -0.18017648 -0.10314318 -0.17239988  0.05769872]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.8977712  -0.89841634 -0.7353593  -0.04011291 -1.442538  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.8977712  -0.89841634 -0.7353593  -0.04011291 -1.442538  ]
  [FlaxMamba2] xBC (step) sample values: [ 0.03213707  0.57169247 -0.01466266  0.2491858  -0.7072183 ]
  [FlaxMamba2] dt (step) sample values: [0.88711405 0.68133754 0.87460184 0.5606443  1.8610032 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.30313236  0.02948296 -0.16612352  0.03213707 -0.24345244]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00252238 -0.08472419  0.00411679 -0.03621004 -0.16113524]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01313314 -0.10335517  0.00987317 -0.04608248 -0.1658998 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00652345 -0.04900938  0.00496095 -0.02251044 -0.07608495]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00652345 -0.04900938  0.00496095 -0.02251044 -0.07608495]
  [FlaxMamba2] B (step) sample values: [-0.06066297  0.08735394 -0.01931231 -0.0918354   0.00941824]
  [FlaxMamba2] C (step) sample values: [0.01704376 0.04808528 0.00994385 0.184455   0.00198701]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9809841  -1.4352343  -0.79658854 -1.6062093  -1.8464803 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.13341142 0.02654695 0.01087309 0.06375841 0.33036676]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.767754   0.9626156  0.99137604 0.90265995 0.54334235]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00652345 -0.04900938  0.00496095 -0.02251044 -0.07608495]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.2795156e-05 -7.6024378e-05  1.6807558e-05  7.9924605e-05
 -8.1967237e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.2795156e-05 -7.6024378e-05  1.6807558e-05  7.9924605e-05
 -8.1967237e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [2.8083441e-04 9.6558401e-04 4.5628630e-04 3.1919626e-05 3.3388450e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00178967  0.00029263  0.00262623 -0.00134025 -0.00841034]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00711724 -0.03973236  0.00667774 -0.01972407 -0.07054739]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00711724 -0.03973236  0.00667774 -0.01972407 -0.07054739]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00184986  0.01032962 -0.00159111  0.00038766  0.01945309]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.06244692  0.35078666 -0.0532042   0.01535992  0.6481917 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.06244692  0.35078666 -0.0532042   0.01535992  0.6481917 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.6299224 -2.2112072 -1.0921744  7.7132273  2.7661471]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.6299224 -2.2112072 -1.0921744  7.7132273  2.7661471]
  [Layer 40] Output shape after mixer: (1, 1, 2048)
  [Layer 40] Output sample values after mixer: [ 3.6299224 -2.2112072 -1.0921744  7.7132273  2.7661471]
  [Layer 40] Residual connection shape: (1, 1, 2048)
  [Layer 40] Residual connection sample values: [  8.484255 -21.575378 -11.889859 -10.784389   9.033266]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07319818 -0.18767051 -0.10476986 -0.09304265  0.0783187 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07319818 -0.18767051 -0.10476986 -0.09304265  0.0783187 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07319818 -0.18767051 -0.10476986 -0.09304265  0.0783187 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.6468172  -0.58408564  0.01820041 -0.18127216 -0.72159576]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.6468172  -0.58408564  0.01820041 -0.18127216 -0.72159576]
  [FlaxMamba2] xBC (step) sample values: [ 0.17966998 -0.11757173  0.6869211   0.2805915   0.6460266 ]
  [FlaxMamba2] dt (step) sample values: [ 1.1855177   1.6538025   0.85842186 -0.6436598   0.783227  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.72513354  0.3270118   0.79864335  0.17966998  0.9139009 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.05336235 -0.01658845  0.15554197  0.05431104  0.19931822]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.0667138  -0.03058838  0.15764005  0.04757429  0.18373136]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03224463 -0.0150603   0.08501979  0.02435287  0.10028133]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03224463 -0.0150603   0.08501979  0.02435287  0.10028133]
  [FlaxMamba2] B (step) sample values: [ 0.06397533 -0.07138837 -0.12607421 -0.27188027  0.2630732 ]
  [FlaxMamba2] C (step) sample values: [ 0.06059268  0.02335345 -0.00891794 -0.07191478  0.2284652 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8258594 -1.8636904 -1.2829287 -1.4542811 -4.4079003]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11727607 0.15418634 0.01691197 0.0219135  0.0139187 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8072437  0.75024486 0.97853684 0.96863407 0.9404919 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03224463 -0.0150603   0.08501979  0.02435287  0.10028133]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00024192  0.00026996  0.00047675  0.00102812 -0.00099482]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00024192  0.00026996  0.00047675  0.00102812 -0.00099482]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00055453  0.00073174 -0.00014534  0.00395589 -0.00444248]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0029827   0.00023843  0.00851118  0.00209726  0.0003479 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03441098 -0.01444058  0.0913785   0.02583358  0.09809037]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03441098 -0.01444058  0.0913785   0.02583358  0.09809037]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01460751  0.0030195   0.00083913 -0.00212981 -0.02314853]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.5579848   0.11527539  0.03152892 -0.08406441 -0.71208155]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.5579848   0.11527539  0.03152892 -0.08406441 -0.71208155]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 4.21316    0.9360559  3.579741  -1.9357313 -2.459355 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 4.21316    0.9360559  3.579741  -1.9357313 -2.459355 ]
  [Layer 41] Output shape after mixer: (1, 1, 2048)
  [Layer 41] Output sample values after mixer: [ 4.21316    0.9360559  3.579741  -1.9357313 -2.459355 ]
  [Layer 41] Residual connection shape: (1, 1, 2048)
  [Layer 41] Residual connection sample values: [ 12.697414  -20.639322   -8.310118  -12.720119    6.5739107]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.11007744 -0.18242744 -0.0727843  -0.10947971  0.05672709]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11007744 -0.18242744 -0.0727843  -0.10947971  0.05672709]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11007744 -0.18242744 -0.0727843  -0.10947971  0.05672709]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.27790892 -0.19178163 -2.0395687  -0.765666    0.9295491 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.27790892 -0.19178163 -2.0395687  -0.765666    0.9295491 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.33231723  0.21291496 -1.0636083   0.2328955  -0.14482222]
  [FlaxMamba2] dt (step) sample values: [1.0626559 2.3121831 2.016329  0.6549228 0.0851713]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.6472919   0.08567549 -0.26236737  0.33231723 -0.58707714]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04761949 -0.03726803 -0.16709624  0.07874686 -0.03422346]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03828874 -0.05048214 -0.15704833  0.08227354 -0.0541667 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01951083 -0.0246041  -0.07237077  0.04282805 -0.02635002]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01951083 -0.0246041  -0.07237077  0.04282805 -0.02635002]
  [FlaxMamba2] B (step) sample values: [ 0.03298473  0.00185453  0.10823717 -0.03496908  0.3106834 ]
  [FlaxMamba2] C (step) sample values: [-0.02592436  0.0845421   0.16788    -0.04547954 -0.26551482]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.06612   -1.4514434 -0.7269863 -1.9455162 -0.6256312]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06058388 1.0157254  0.0256176  0.05147654 0.01230744]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.937452   0.22894627 0.9815487  0.90470314 0.99232966]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01951083 -0.0246041  -0.07237077  0.04282805 -0.02635002]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.8989339e-05  2.1921321e-06  1.2794088e-04 -4.1334923e-05
  3.6724081e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.8989339e-05  2.1921321e-06  1.2794088e-04 -4.1334923e-05
  3.6724081e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.9445300e-04 -2.3071738e-05 -1.1509805e-04  5.4041576e-04
 -1.7396890e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-2.7793800e-05 -1.3289282e-03 -2.5990393e-03  3.5084996e-03
 -1.3248145e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01955093 -0.02601863 -0.07522162  0.04648557 -0.02776652]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01955093 -0.02601863 -0.07522162  0.04648557 -0.02776652]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00309177  0.00225644  0.01766024 -0.01129765 -0.0185056 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.13472432  0.09665789  0.7695466  -0.40746564 -0.73197114]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.13472432  0.09665789  0.7695466  -0.40746564 -0.73197114]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.1468492  1.8040891 -1.0537126 -0.1677303 -2.012158 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.1468492  1.8040891 -1.0537126 -0.1677303 -2.012158 ]
  [Layer 42] Output shape after mixer: (1, 1, 2048)
  [Layer 42] Output sample values after mixer: [ 3.1468492  1.8040891 -1.0537126 -0.1677303 -2.012158 ]
  [Layer 42] Residual connection shape: (1, 1, 2048)
  [Layer 42] Residual connection sample values: [ 15.844263 -18.835234  -9.363831 -12.88785    4.561753]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13045715 -0.16260998 -0.07733794 -0.10792274  0.03724992]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13045715 -0.16260998 -0.07733794 -0.10792274  0.03724992]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13045715 -0.16260998 -0.07733794 -0.10792274  0.03724992]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.0321298  -0.21232834 -1.6902714  -0.37331477 -0.38303953]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.0321298  -0.21232834 -1.6902714  -0.37331477 -0.38303953]
  [FlaxMamba2] xBC (step) sample values: [ 0.9246726  -0.4871298   0.599972    0.01913554 -0.17384152]
  [FlaxMamba2] dt (step) sample values: [1.6916996  2.4772294  0.22766344 1.851137   2.2614396 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.12404744  0.9579304   0.78150445  0.9246726  -0.37006837]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.1446707   0.0009628   0.08863596 -0.00968699  0.02767277]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.14110014 -0.04472201  0.10111002 -0.00378565  0.01885319]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.07551914 -0.02186107  0.05310864 -0.00188924  0.00951545]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.07551914 -0.02186107  0.05310864 -0.00188924  0.00951545]
  [FlaxMamba2] B (step) sample values: [-0.07265132 -0.09840482  0.8906617   0.01846328 -0.02967602]
  [FlaxMamba2] C (step) sample values: [-0.21472012 -0.08277614 -0.27614227  0.03659055 -0.15367657]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9761645 -1.478265  -1.0588893 -1.0815219 -5.9141264]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02177441 0.16442084 0.01023293 0.04314583 0.42385882]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9789689  0.78422636 0.98922294 0.9544088  0.08153241]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.07551914 -0.02186107  0.05310864 -0.00188924  0.00951545]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.1946670e-04 -1.6181536e-04  1.4645903e-03  3.0360734e-05
 -4.8798782e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.1946670e-04 -1.6181536e-04  1.4645903e-03  3.0360734e-05
 -4.8798782e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00026288 -0.00144978  0.01139336  0.00022363  0.00010111]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 4.2821993e-03 -4.0777796e-03 -5.0951173e-03 -4.2430414e-03
  2.7341728e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.06986051 -0.02306121  0.04102267 -0.0058836   0.00829025]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.06986051 -0.02306121  0.04102267 -0.0058836   0.00829025]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01893995  0.00218933 -0.01079893  0.00089557 -0.00128733]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.997178    0.0884169  -0.40933642  0.03742738 -0.06204509]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.997178    0.0884169  -0.40933642  0.03742738 -0.06204509]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 7.591515  -1.8233576 -2.893963  -1.5133612  2.077277 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 7.591515  -1.8233576 -2.893963  -1.5133612  2.077277 ]
  [Layer 43] Output shape after mixer: (1, 1, 2048)
  [Layer 43] Output sample values after mixer: [ 7.591515  -1.8233576 -2.893963  -1.5133612  2.077277 ]
  [Layer 43] Residual connection shape: (1, 1, 2048)
  [Layer 43] Residual connection sample values: [ 23.435778  -20.658592  -12.257793  -14.401211    6.6390295]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.18277209 -0.16747737 -0.09649102 -0.11172911  0.05172296]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18277209 -0.16747737 -0.09649102 -0.11172911  0.05172296]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18277209 -0.16747737 -0.09649102 -0.11172911  0.05172296]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.11278193 -1.658446   -0.12210891  0.0408932  -0.81577116]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.11278193 -1.658446   -0.12210891  0.0408932  -0.81577116]
  [FlaxMamba2] xBC (step) sample values: [-0.70534456 -0.22827129  0.45996034 -1.2514802  -0.56960523]
  [FlaxMamba2] dt (step) sample values: [1.0364625  0.35465795 1.9307907  1.6035523  1.0082991 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.30552325 -0.94895405 -0.74250704 -0.70534456  0.5316378 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.13080972  0.02613919  0.0674826  -0.22921693  0.06896113]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.13691705  0.08656399  0.04901946 -0.23576677  0.01647089]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06377926  0.04515416  0.02511034 -0.1040509   0.00830327]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06377926  0.04515416  0.02511034 -0.1040509   0.00830327]
  [FlaxMamba2] B (step) sample values: [-0.27826306  0.12546398  0.07115281  0.02101613  0.04942582]
  [FlaxMamba2] C (step) sample values: [-0.2615681   0.14706543  0.02241355 -0.01407101 -0.04301254]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.74823433 -0.64391696 -1.1771379  -1.350584   -1.0269372 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06053671 0.02141701 0.07436214 0.04812808 0.09858944]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9557149  0.98630387 0.9161873  0.9370665  0.90371144]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06377926  0.04515416  0.02511034 -0.1040509   0.00830327]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0743700e-03 -4.8441475e-04 -2.7472005e-04 -8.1142985e-05
 -1.9083245e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0743700e-03 -4.8441475e-04 -2.7472005e-04 -8.1142985e-05
 -1.9083245e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00591985 -0.00150288 -0.00062731 -0.00018778 -0.0013966 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00435894 -0.00078643 -0.00054534 -0.00621055  0.00354511]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.06427103  0.04162987  0.02304246 -0.10395248  0.01134492]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.06427103  0.04162987  0.02304246 -0.10395248  0.01134492]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00342014 -0.01104452 -0.00132106 -0.00216893 -0.00283811]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.14505604 -0.37400275 -0.06037056 -0.0859689  -0.12238747]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.14505604 -0.37400275 -0.06037056 -0.0859689  -0.12238747]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-5.4042215   3.2675335   1.6772627   5.078156    0.39023635]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-5.4042215   3.2675335   1.6772627   5.078156    0.39023635]
  [Layer 44] Output shape after mixer: (1, 1, 2048)
  [Layer 44] Output sample values after mixer: [-5.4042215   3.2675335   1.6772627   5.078156    0.39023635]
  [Layer 44] Residual connection shape: (1, 1, 2048)
  [Layer 44] Residual connection sample values: [ 18.031555 -17.391058 -10.580531  -9.323055   7.029266]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13906138 -0.13780758 -0.08193045 -0.07072955  0.05393461]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13906138 -0.13780758 -0.08193045 -0.07072955  0.05393461]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13906138 -0.13780758 -0.08193045 -0.07072955  0.05393461]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.7642535   0.75365883 -0.3716076  -0.20430478  0.39637342]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.7642535   0.75365883 -0.3716076  -0.20430478  0.39637342]
  [FlaxMamba2] xBC (step) sample values: [ 0.5000783  -0.19819975 -0.5217314  -0.09955043 -2.9122581 ]
  [FlaxMamba2] dt (step) sample values: [ 2.165732   2.688454  -1.0819167  1.0392009  2.0222752]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.37752372 -0.22580063  0.03926632  0.5000783   0.17307422]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.07402671  0.02975485 -0.08933106 -0.02585048  0.5351505 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.06944907  0.08197042 -0.091782   -0.03243465  0.5326481 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.03592985  0.04266406 -0.0437865  -0.01595435  0.33562186]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03592985  0.04266406 -0.0437865  -0.01595435  0.33562186]
  [FlaxMamba2] B (step) sample values: [ 0.40364507 -0.04285268  0.03024888 -0.2449165   0.030587  ]
  [FlaxMamba2] C (step) sample values: [-0.02691004  0.07816496 -0.06386697 -0.21851711 -0.02421471]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.250236  -4.181475  -1.0937363 -2.677446  -2.3148744]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06113452 0.2896301  0.00662522 0.03523706 0.04118044]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8714759  0.2978751  0.99277997 0.9099685  0.90907514]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03592985  0.04266406 -0.0437865  -0.01595435  0.33562186]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.8662811e-04 -9.4128220e-05  6.6443288e-05 -5.3797226e-04
  6.7185996e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.8662811e-04 -9.4128220e-05  6.6443288e-05 -5.3797226e-04
  6.7185996e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.24233961e-03 -1.20638426e-04  5.81874519e-05  2.56363768e-04
  1.67937105e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00042818  0.00076492 -0.00949344 -0.00662315  0.05186095]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03987919  0.04862696 -0.05861467 -0.0245213   0.42837334]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03987919  0.04862696 -0.05861467 -0.0245213   0.42837334]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.02079429 0.02491983 0.00889024 0.00224991 0.10150665]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.8565686  0.74436975 0.33653483 0.07796849 3.7726116 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.8565686  0.74436975 0.33653483 0.07796849 3.7726116 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.33888328  4.31273    -7.3249016  -3.6895037  -0.36751887]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.33888328  4.31273    -7.3249016  -3.6895037  -0.36751887]
  [Layer 45] Output shape after mixer: (1, 1, 2048)
  [Layer 45] Output sample values after mixer: [-0.33888328  4.31273    -7.3249016  -3.6895037  -0.36751887]
  [Layer 45] Residual connection shape: (1, 1, 2048)
  [Layer 45] Residual connection sample values: [ 17.692673 -13.078328 -17.905434 -13.012559   6.661747]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15831012 -0.12196796 -0.16319332 -0.11771298  0.05920474]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15831012 -0.12196796 -0.16319332 -0.11771298  0.05920474]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15831012 -0.12196796 -0.16319332 -0.11771298  0.05920474]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.47302574  1.1020054  -0.15741341 -0.13032927  0.19518383]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.47302574  1.1020054  -0.15741341 -0.13032927  0.19518383]
  [FlaxMamba2] xBC (step) sample values: [ 0.87103164 -0.13413201 -0.32105112 -1.6309174  -0.50177443]
  [FlaxMamba2] dt (step) sample values: [ 1.3016251   1.4775947  -0.73107016  1.7520201  -0.06220125]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.3332455  0.19496793 0.28203216 0.87103164 0.709983  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.14167507 -0.00552586 -0.05464599  0.22772433  0.07887517]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.14481266 -0.0093253  -0.07574889  0.2118857   0.09918462]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.0671728  -0.00464091 -0.03644066  0.11712494  0.05204969]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0671728  -0.00464091 -0.03644066  0.11712494  0.05204969]
  [FlaxMamba2] B (step) sample values: [-0.03047843 -0.25849453 -0.01516    -0.00785543  0.07132309]
  [FlaxMamba2] C (step) sample values: [-0.04307727 -0.2745051   0.08732557 -0.00178278  0.09273103]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8673339  -0.9793274  -1.6584101  -0.94076145 -0.4381494 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01105702 0.02465619 0.00305434 0.05821372 0.0082883 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.97956455 0.9761427  0.99494743 0.94670737 0.9963751 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0671728  -0.00464091 -0.03644066  0.11712494  0.05204969]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.2637278e-05  1.9199192e-04  1.1259803e-05  5.8344758e-06
 -5.2973875e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.2637278e-05  1.9199192e-04  1.1259803e-05  5.8344758e-06
 -5.2973875e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.13713195e-05  8.35281797e-04 -3.11976291e-05  2.02133560e-05
 -6.65033076e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-5.2847544e-04  1.0432694e-05 -9.2381990e-05  9.6767896e-04
  4.2452986e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05416293 -0.00369512 -0.0291886   0.09448667  0.04198387]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05416293 -0.00369512 -0.0291886   0.09448667  0.04198387]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01578476 -0.00305662  0.0021169  -0.00575652  0.00449588]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.613216   -0.11336613  0.07092376 -0.17851242  0.17026305]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.613216   -0.11336613  0.07092376 -0.17851242  0.17026305]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 5.2694783  3.1069474 -2.9184115  1.238373  -7.962688 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 5.2694783  3.1069474 -2.9184115  1.238373  -7.962688 ]
  [Layer 46] Output shape after mixer: (1, 1, 2048)
  [Layer 46] Output sample values after mixer: [ 5.2694783  3.1069474 -2.9184115  1.238373  -7.962688 ]
  [Layer 46] Residual connection shape: (1, 1, 2048)
  [Layer 46] Residual connection sample values: [ 22.96215   -9.97138  -20.823845 -11.774186  -1.300941]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.17876714 -0.07836878 -0.15726084 -0.0900084  -0.00947291]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.17876714 -0.07836878 -0.15726084 -0.0900084  -0.00947291]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.17876714 -0.07836878 -0.15726084 -0.0900084  -0.00947291]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.1990982   1.0126548  -1.6359801  -0.5291816  -0.47823164]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.1990982   1.0126548  -1.6359801  -0.5291816  -0.47823164]
  [FlaxMamba2] xBC (step) sample values: [ 0.16257574 -0.7630959  -0.06681595  1.5433029  -0.15580276]
  [FlaxMamba2] dt (step) sample values: [ 0.549592  -0.4891132  2.0036492  1.5676682  1.1998653]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.22775415  0.22847776 -0.08903592  0.16257574  0.9385825 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02217271 -0.11917097 -0.00726614 -0.24224752 -0.02035648]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00506761 -0.14407331 -0.22674857 -0.24562734 -0.01517993]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00252738 -0.06685633 -0.10057535 -0.10780586 -0.00753236]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00252738 -0.06685633 -0.10057535 -0.10780586 -0.00753236]
  [FlaxMamba2] B (step) sample values: [-0.1472861  -0.02222679 -0.1913116  -0.27627602 -0.06784556]
  [FlaxMamba2] C (step) sample values: [ 0.6852051   0.1333912  -0.00470791 -0.24181078  0.0311084 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -3.552239  -11.244981   -2.6866128  -3.193549   -3.1997924]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0384364  0.00933976 0.01900789 0.01741493 0.03806551]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.87237555 0.9003016  0.95021516 0.9459028  0.8853239 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00252738 -0.06685633 -0.10057535 -0.10780586 -0.00753236]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [1.4307891e-05 2.1591884e-06 1.8584684e-05 2.6838428e-05 6.5907570e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [1.4307891e-05 2.1591884e-06 1.8584684e-05 2.6838428e-05 6.5907570e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0005809  -0.00018456 -0.00137129 -0.00080501  0.0001848 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00082566 -0.00362708 -0.00606995 -0.00473108  0.00016113]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0027476  -0.09814984 -0.14826529 -0.15714906 -0.01048827]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0027476  -0.09814984 -0.14826529 -0.15714906 -0.01048827]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00076316 -0.07290787  0.03954023  0.0308282   0.0019194 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.02557051 -1.4641613   1.299482    1.0583597   0.06319804]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02557051 -1.4641613   1.299482    1.0583597   0.06319804]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.7152472  5.9575276 -2.9154184  3.7960513 12.115603 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.7152472  5.9575276 -2.9154184  3.7960513 12.115603 ]
  [Layer 47] Output shape after mixer: (1, 1, 2048)
  [Layer 47] Output sample values after mixer: [ 1.7152472  5.9575276 -2.9154184  3.7960513 12.115603 ]
  [Layer 47] Residual connection shape: (1, 1, 2048)
  [Layer 47] Residual connection sample values: [ 24.677399   -4.0138526 -23.739264   -7.978135   10.814663 ]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.1842482  -0.02798366 -0.16178459 -0.05609405  0.07174424]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1842482  -0.02798366 -0.16178459 -0.05609405  0.07174424]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1842482  -0.02798366 -0.16178459 -0.05609405  0.07174424]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.04056185 -2.2301338  -0.44658095 -0.2212707   0.19896461]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.04056185 -2.2301338  -0.44658095 -0.2212707   0.19896461]
  [FlaxMamba2] xBC (step) sample values: [ 0.7337517   0.16931805  0.19097188 -0.5645437  -0.13727131]
  [FlaxMamba2] dt (step) sample values: [ 0.74058574  2.2838514   1.9848124   1.1418235  -0.047653  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.03665016  0.37658596  1.0177499   0.7337517  -1.3048716 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.13643068  0.01330442  0.02671607 -0.12427936  0.02381932]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.14160341  0.23327512 -0.05916039 -0.19056354  0.0213741 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06579718  0.13018052 -0.02870546 -0.08623052  0.01080126]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06579718  0.13018052 -0.02870546 -0.08623052  0.01080126]
  [FlaxMamba2] B (step) sample values: [ 0.042342    0.0026946   0.023594   -0.0274546  -0.05432502]
  [FlaxMamba2] C (step) sample values: [-0.09878825 -0.27846223  0.05651595 -0.1774252  -0.09270579]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-54.81184   -78.514336  -47.25076    -2.330753   -4.2266355]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06365354 0.08335248 0.02919589 0.00342623 0.00716922]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.03053238 0.0014382  0.25169736 0.9920461  0.9701528 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06579718  0.13018052 -0.02870546 -0.08623052  0.01080126]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.7733774e-04 -1.1285593e-05 -9.8816956e-05  1.1498601e-04
  2.2752532e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.7733774e-04 -1.1285593e-05 -9.8816956e-05  1.1498601e-04
  2.2752532e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.61500007e-04 -9.76570209e-06 -9.80900295e-05  1.19194614e-04
  2.45586591e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00071405  0.00142739 -0.00032596 -0.00092435  0.00012583]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05310364  0.10508085 -0.02318207 -0.06958357  0.00872611]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05310364  0.10508085 -0.02318207 -0.06958357  0.00872611]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00105515 -0.02274943  0.00403934  0.00685015  0.00095417]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.04813885 -0.8505915   0.15629686  0.30372232  0.0470975 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04813885 -0.8505915   0.15629686  0.30372232  0.0470975 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-13.201688   -2.6618469  -4.1937385  23.571217   15.235459 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-13.201688   -2.6618469  -4.1937385  23.571217   15.235459 ]
  [Layer 48] Output shape after mixer: (1, 1, 2048)
  [Layer 48] Output sample values after mixer: [-13.201688   -2.6618469  -4.1937385  23.571217   15.235459 ]
  [Layer 48] Residual connection shape: (1, 1, 2048)
  [Layer 48] Residual connection sample values: [ 11.475711  -6.675699 -27.933002  15.593081  26.050121]
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.09222281 -0.05933749 -0.22861086  0.13014378  0.2073296 ]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Final backbone norm output sample values: [ 0.09222281 -0.05933749 -0.22861086  0.13014378  0.2073296 ]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 1, 50288)
[Mamba2LMHeadModel] Logits sample values: [ 3.9310057 -7.731613   4.380334   3.325442  -1.4611228]
[Mamba2LMHeadModel] Forward pass input_ids shape: (1, 1)
[Mamba2LMHeadModel] input_ids sample values: [278]
[Mamba2LMHeadModel] Embedding output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Embedding sample values: [ 0.02981567 -0.00045133 -0.11676025  0.01713562 -0.04013062]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.030876   -0.00052886 -0.12490968  0.01833162 -0.04218743]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.030876   -0.00052886 -0.12490968  0.01833162 -0.04218743]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.030876   -0.00052886 -0.12490968  0.01833162 -0.04218743]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.0581944  -0.32233858  0.18909536 -0.0424443  -0.53803825]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.0581944  -0.32233858  0.18909536 -0.0424443  -0.53803825]
  [FlaxMamba2] xBC (step) sample values: [ 0.45514706  0.41143546 -0.26089063 -0.23439007 -0.09727416]
  [FlaxMamba2] dt (step) sample values: [ 0.5774521   0.2133228  -0.12663597 -0.5791575  -0.2676597 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.83976954  0.09133587  0.52318025  0.45514706  0.03642996]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06492926 -0.10638221  0.03221972  0.05536594  0.04596545]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.29271245  0.10894983  0.30248338  0.10456027 -0.21087049]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.16762473  0.05743949  0.17394291  0.05501086 -0.09435967]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.16762473  0.05743949  0.17394291  0.05501086 -0.09435967]
  [FlaxMamba2] B (step) sample values: [ 0.0711108   0.1038912  -0.2690817  -0.27836034  0.050758  ]
  [FlaxMamba2] C (step) sample values: [-0.2731724   0.76140714 -0.2704284  -0.265253   -0.00711377]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.617978  -2.5226073 -3.0473056 -3.307819  -3.9089987]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01614822 0.01677201 0.00798771 0.01376992 0.00558082]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.95860547 0.95857334 0.97595286 0.95547336 0.97842085]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.16762473  0.05743949  0.17394291  0.05501086 -0.09435967]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00019249  0.00028122 -0.00072836 -0.00075348  0.00013739]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00019249  0.00028122 -0.00072836 -0.00075348  0.00013739]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00228372  0.00141986 -0.00326788 -0.00346103  0.0006076 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.09195156  0.0843458   0.11678588  0.0169325  -0.08571652]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.15587988  0.10625193  0.18312381  0.03791241 -0.12170319]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.15587988  0.10625193  0.18312381  0.03791241 -0.12170319]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.12245076 -0.01438825  0.01894606 -0.00078751  0.02413917]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.08666483 -0.01096818  0.01144027 -0.00092006  0.01740125]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.08666483 -0.01096818  0.01144027 -0.00092006  0.01740125]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.08230776 -0.0419506   0.02688626  0.03526538 -0.10051402]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.08230776 -0.0419506   0.02688626  0.03526538 -0.10051402]
  [Layer 1] Output shape after mixer: (1, 1, 2048)
  [Layer 1] Output sample values after mixer: [-0.08230776 -0.0419506   0.02688626  0.03526538 -0.10051402]
  [Layer 1] Residual connection shape: (1, 1, 2048)
  [Layer 1] Residual connection sample values: [-0.05249209 -0.04240193 -0.08987399  0.052401   -0.14064464]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.06851356 -0.04370619 -0.10810465  0.06603623 -0.17314577]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.06851356 -0.04370619 -0.10810465  0.06603623 -0.17314577]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.06851356 -0.04370619 -0.10810465  0.06603623 -0.17314577]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.7234496  -0.9595895  -0.75573707 -0.8123292  -0.9571915 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.7234496  -0.9595895  -0.75573707 -0.8123292  -0.9571915 ]
  [FlaxMamba2] xBC (step) sample values: [0.7517786 1.775101  2.8290412 5.255075  2.2688732]
  [FlaxMamba2] dt (step) sample values: [0.9717764  1.8582237  0.44683936 1.4036072  2.305414  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [1.0773478  0.12975971 0.35165885 0.7517786  0.67953277]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.03740283 -0.34789056  0.21517944 -2.6153169  -0.15493464]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.00758716 -0.5024316   0.20466614 -1.5616059  -0.16806483]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00380797 -0.18940133  0.11276872 -0.27080795 -0.07698753]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00380797 -0.18940133  0.11276872 -0.27080795 -0.07698753]
  [FlaxMamba2] B (step) sample values: [-0.1315711  -0.10392638  0.04366439 -0.1561961   0.5363418 ]
  [FlaxMamba2] C (step) sample values: [ 0.67179596 -0.278362    0.13589355  0.13793536 -0.22675234]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-19.851534   -18.68525    -13.564036    -2.4188707   -0.46617994]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01602027 0.03963411 0.0328021  0.0294455  0.13917649]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.72758317 0.47684047 0.64086986 0.9312525  0.93717873]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00380797 -0.18940133  0.11276872 -0.27080795 -0.07698753]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-8.0264554e-06 -6.3399971e-06  2.6637329e-06 -9.5286960e-06
  3.2719370e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-8.0264554e-06 -6.3399971e-06  2.6637329e-06 -9.5286960e-06
  3.2719370e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 3.4038289e-04 -1.4173082e-04  7.7966419e-05 -1.4506988e-03
  1.1903612e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01190931 -0.08053643 -0.02179619 -0.11155245 -0.01606336]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01453813 -0.21128906  0.05605336 -0.2985039  -0.06921148]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01453813 -0.21128906  0.05605336 -0.2985039  -0.06921148]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00343541  0.05615393 -0.0135376   0.07453804  0.01838008]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00048774  0.00377156 -0.00203583  0.00453825  0.00280219]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00048774  0.00377156 -0.00203583  0.00453825  0.00280219]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.11344394 -0.00297357 -0.0578282  -0.11027321  0.04561093]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.11344394 -0.00297357 -0.0578282  -0.11027321  0.04561093]
  [Layer 2] Output shape after mixer: (1, 1, 2048)
  [Layer 2] Output sample values after mixer: [ 0.11344394 -0.00297357 -0.0578282  -0.11027321  0.04561093]
  [Layer 2] Residual connection shape: (1, 1, 2048)
  [Layer 2] Residual connection sample values: [ 0.06095185 -0.0453755  -0.14770219 -0.05787221 -0.09503371]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07177158 -0.04177632 -0.15581113 -0.06281289 -0.11093813]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07177158 -0.04177632 -0.15581113 -0.06281289 -0.11093813]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07177158 -0.04177632 -0.15581113 -0.06281289 -0.11093813]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.5711151  -0.00817512 -2.9526107  -1.3059088  -1.7269567 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.5711151  -0.00817512 -2.9526107  -1.3059088  -1.7269567 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.0515903   0.4026365  -2.073612    1.21598    -0.11059549]
  [FlaxMamba2] dt (step) sample values: [2.1018112 1.000669  1.3776678 2.159838  1.8721815]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.0851595  -0.9023777   0.42976293  0.0515903  -3.966658  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.11688421  0.13390386  0.20172867 -0.00929007 -0.05757232]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.11533544  0.11460149  0.3253859  -0.0216268  -0.07386871]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.0609896   0.06058053  0.18893085 -0.01069647 -0.03557083]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0609896   0.06058053  0.18893085 -0.01069647 -0.03557083]
  [FlaxMamba2] B (step) sample values: [ 0.3833127  -0.01670497  0.08569466  0.25550598  0.00446266]
  [FlaxMamba2] C (step) sample values: [ 0.4478231  -0.03006411 -0.23909563 -0.17803486  0.41197807]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6505536 -3.9938898 -6.780579  -0.9418818 -6.0307717]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06660215 0.05450198 0.05297171 0.0554943  0.13325405]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.957597   0.8043869  0.69824946 0.94907343 0.4477032 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0609896   0.06058053  0.18893085 -0.01069647 -0.03557083]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.5570309e-03 -6.7856243e-05  3.4809503e-04  1.0378751e-03
  1.8127497e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.5570309e-03 -6.7856243e-05  3.4809503e-04  1.0378751e-03
  1.8127497e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.4059932e-03 -8.4770552e-05  3.5853852e-03  3.9394677e-04
  9.7792828e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00122854  0.2516073   0.18196695 -0.04948821 -0.02013174]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02653836  0.27918795  0.26798198 -0.05435802 -0.03632616]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02653836  0.27918795  0.26798198 -0.05435802 -0.03632616]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00547117 -0.00113653 -0.03925632  0.01513238  0.00947136]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00154987 -0.00035106 -0.00977235  0.00577067  0.00208138]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00154987 -0.00035106 -0.00977235  0.00577067  0.00208138]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.02990483  0.0219485   0.05974261  0.01834237  0.00745849]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.02990483  0.0219485   0.05974261  0.01834237  0.00745849]
  [Layer 3] Output shape after mixer: (1, 1, 2048)
  [Layer 3] Output sample values after mixer: [-0.02990483  0.0219485   0.05974261  0.01834237  0.00745849]
  [Layer 3] Residual connection shape: (1, 1, 2048)
  [Layer 3] Residual connection sample values: [ 0.03104703 -0.02342699 -0.08795957 -0.03952984 -0.08757522]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03610591 -0.02063268 -0.09036145 -0.04200378 -0.10216457]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03610591 -0.02063268 -0.09036145 -0.04200378 -0.10216457]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03610591 -0.02063268 -0.09036145 -0.04200378 -0.10216457]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.79726833  0.23423003  0.11960681 -1.4104373   0.64923954]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.79726833  0.23423003  0.11960681 -1.4104373   0.64923954]
  [FlaxMamba2] xBC (step) sample values: [-1.3303822  -2.6721506  -1.320925   -0.24922952 -0.13252129]
  [FlaxMamba2] dt (step) sample values: [1.6738099 2.747622  2.1231976 2.24872   0.6724841]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.1195325   0.6362446  -0.09687654 -1.3303822  -1.7535933 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.2369893  -0.36695135  0.21597005  0.13058513  0.14405102]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.31078082 -0.4021076   0.16775228  0.11476177  0.43701977]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.13143674 -0.16116716  0.0908949   0.06066985  0.26551077]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.13143674 -0.16116716  0.0908949   0.06066985  0.26551077]
  [FlaxMamba2] B (step) sample values: [ 0.47733805  0.24457647  0.46593648 -0.17276509 -0.04334987]
  [FlaxMamba2] C (step) sample values: [ 0.73565984 -0.19649585 -0.27603382 -0.21382101  0.20666564]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.7127254  -1.2862217  -1.4869522 -27.028044   -4.0726624]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03231465 0.03694768 0.01588204 0.03029017 0.0729403 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9461576  0.9535886  0.97666085 0.44101167 0.7429985 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.13143674 -0.16116716  0.0908949   0.06066985  0.26551077]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00202741 -0.0010388  -0.00197899  0.00073379  0.00018412]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00202741 -0.0010388  -0.00197899  0.00073379  0.00018412]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00327815 -0.00228834 -0.0023665   0.00066143 -0.00055001]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00792771  0.04791604 -0.02324097 -0.03458576  0.1868316 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.08191045 -0.04280128  0.02792169 -0.00043608  0.33628154]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.08191045 -0.04280128  0.02792169 -0.00043608  0.33628154]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 2.0284273e-02 -5.5970629e-03  1.7695539e-03  1.2065467e-04
  1.4340588e-01]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 1.0070931e-02 -1.7854978e-03  8.6378556e-04  4.9630573e-05
  3.5200518e-02]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 1.0070931e-02 -1.7854978e-03  8.6378556e-04  4.9630573e-05
  3.5200518e-02]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.08542681  0.01323186  0.00193263 -0.1697561   0.0648711 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.08542681  0.01323186  0.00193263 -0.1697561   0.0648711 ]
  [Layer 4] Output shape after mixer: (1, 1, 2048)
  [Layer 4] Output sample values after mixer: [-0.08542681  0.01323186  0.00193263 -0.1697561   0.0648711 ]
  [Layer 4] Residual connection shape: (1, 1, 2048)
  [Layer 4] Residual connection sample values: [-0.05437978 -0.01019514 -0.08602694 -0.20928594 -0.02270412]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.05568833 -0.00862792 -0.08228423 -0.20528083 -0.02399235]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.05568833 -0.00862792 -0.08228423 -0.20528083 -0.02399235]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.05568833 -0.00862792 -0.08228423 -0.20528083 -0.02399235]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.43127513 -0.71496445 -1.0203453  -1.7592891   0.529275  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.43127513 -0.71496445 -1.0203453  -1.7592891   0.529275  ]
  [FlaxMamba2] xBC (step) sample values: [-0.0259489 -0.4396107  0.8289299  0.7618916 -2.648958 ]
  [FlaxMamba2] dt (step) sample values: [2.6276672 1.2197833 0.6108193 1.0300444 0.4495669]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.48543358 -0.02045043 -0.33975518 -0.0259489  -1.6659244 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04817643 -0.5023666  -0.4652035  -0.081048   -0.5243284 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00339827 -0.5396896  -0.53472257 -0.10717104 -0.5301916 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00169625 -0.198746   -0.19753513 -0.05071686 -0.19642125]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00169625 -0.198746   -0.19753513 -0.05071686 -0.19642125]
  [FlaxMamba2] B (step) sample values: [-0.09028264  0.11954989  0.05579021  1.1042556   0.28098485]
  [FlaxMamba2] C (step) sample values: [ 0.22880076 -0.11625691 -0.09294778 -0.20863819  0.06852627]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.5762966   -1.0443833   -0.83880144  -5.6764617  -20.401838  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05257009 0.04017801 0.07680387 0.03843579 0.0053386 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9204744  0.95890695 0.9376081  0.80398124 0.8968046 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00169625 -0.198746   -0.19753513 -0.05071686 -0.19642125]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.0506825e-06 -1.0660502e-05 -4.9749242e-06 -9.8468663e-05
 -2.5055979e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.0506825e-06 -1.0660502e-05 -4.9749242e-06 -9.8468663e-05
 -2.5055979e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00021436 -0.00011618  0.00055262  0.00011612 -0.00046628]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00211768  0.00579239 -0.02210208  0.00357385 -0.01656163]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00302946 -0.10103926 -0.12828285 -0.02368791 -0.12214366]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00302946 -0.10103926 -0.12828285 -0.02368791 -0.12214366]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00079199  0.02373087  0.03468138  0.00612104 -0.04068363]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00049641  0.01516975  0.02111663  0.0039009  -0.02298151]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00049641  0.01516975  0.02111663  0.0039009  -0.02298151]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.06506226  0.06482074 -0.12406791 -0.01524146 -0.04288833]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.06506226  0.06482074 -0.12406791 -0.01524146 -0.04288833]
  [Layer 5] Output shape after mixer: (1, 1, 2048)
  [Layer 5] Output sample values after mixer: [ 0.06506226  0.06482074 -0.12406791 -0.01524146 -0.04288833]
  [Layer 5] Residual connection shape: (1, 1, 2048)
  [Layer 5] Residual connection sample values: [ 0.01068248  0.05462561 -0.21009485 -0.2245274  -0.06559245]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00892077  0.03530578 -0.15571518 -0.17202151 -0.05556422]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00892077  0.03530578 -0.15571518 -0.17202151 -0.05556422]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00892077  0.03530578 -0.15571518 -0.17202151 -0.05556422]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.9844714  -0.05516092 -1.5301073   1.0817639   0.3402477 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.9844714  -0.05516092 -1.5301073   1.0817639   0.3402477 ]
  [FlaxMamba2] xBC (step) sample values: [-0.11477014 -0.311579   -0.78624827  2.284861    0.83050025]
  [FlaxMamba2] dt (step) sample values: [1.2884102 2.4765124 1.5164204 1.22311   1.4277744]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.996089    0.45463678  0.05953435 -0.11477014  0.23369399]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01035823  0.05210782 -1.6640282  -0.29819918  0.2575674 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04472102 -0.02021884 -1.7261925  -0.2360959   0.32726955]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02286042 -0.01000722 -0.26078495 -0.104177    0.19017467]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02286042 -0.01000722 -0.26078495 -0.104177    0.19017467]
  [FlaxMamba2] B (step) sample values: [ 0.05610009 -0.11450672 -0.25709862 -0.02935144  0.06346773]
  [FlaxMamba2] C (step) sample values: [-0.10983839 -0.12263151 -0.27844447  0.19912502  0.19724505]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.98658675 -8.774721   -3.3045902  -2.9912853  -3.3435438 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03388342 0.15230694 0.33566284 0.2083718  0.11836916]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9671236  0.2627766  0.32981342 0.5361724  0.67315984]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02286042 -0.01000722 -0.26078495 -0.104177    0.19017467]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.3454522e-05 -8.8695670e-05 -1.9914581e-04 -2.2735305e-05
  4.9161419e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.3454522e-05 -8.8695670e-05 -1.9914581e-04 -2.2735305e-05
  4.9161419e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01757657 -0.00058674 -0.01034481 -0.00116088  0.00389704]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.08766253 -0.16182034 -0.18685491  0.00432238 -0.19451617]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.09261301 -0.16398743 -0.24332863 -0.01823744 -0.1533333 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.09261301 -0.16398743 -0.24332863 -0.01823744 -0.1533333 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0663748   0.00439814  0.06626457 -0.01473386 -0.03048112]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.04841423  0.0015029   0.02152539 -0.00622309 -0.00908767]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04841423  0.0015029   0.02152539 -0.00622309 -0.00908767]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.12458795  0.16500194 -0.00361421 -0.22853312  0.43167832]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.12458795  0.16500194 -0.00361421 -0.22853312  0.43167832]
  [Layer 6] Output shape after mixer: (1, 1, 2048)
  [Layer 6] Output sample values after mixer: [ 0.12458795  0.16500194 -0.00361421 -0.22853312  0.43167832]
  [Layer 6] Residual connection shape: (1, 1, 2048)
  [Layer 6] Residual connection sample values: [ 0.13527043  0.21962756 -0.21370907 -0.4530605   0.3660859 ]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07890172  0.10640301 -0.11555815 -0.24196355  0.21421126]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07890172  0.10640301 -0.11555815 -0.24196355  0.21421126]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07890172  0.10640301 -0.11555815 -0.24196355  0.21421126]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.13863671 -1.2891706  -0.73557836 -1.5447118   0.30873245]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.13863671 -1.2891706  -0.73557836 -1.5447118   0.30873245]
  [FlaxMamba2] xBC (step) sample values: [-1.6185312  -0.38932902 -0.848622   -0.34194484  0.9687151 ]
  [FlaxMamba2] dt (step) sample values: [0.886331   0.00264359 1.5208656  1.5663581  1.3248701 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-2.4475067 -1.9761943 -1.787138  -1.6185312 -1.2237949]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00754185  0.07615247  0.02663243 -0.37713277 -0.16117263]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.07565708  0.10078016  0.02588236 -0.37070882 -0.16476607]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03639822  0.05292709  0.01310865 -0.15138628 -0.07561139]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03639822  0.05292709  0.01310865 -0.15138628 -0.07561139]
  [FlaxMamba2] B (step) sample values: [ 0.08912073 -0.04353692 -0.03807969 -0.1074515   0.05589483]
  [FlaxMamba2] C (step) sample values: [ 0.03436815 -0.06487557 -0.08390646 -0.04818168  0.01558311]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.29588825 -1.1836219  -0.3113019  -0.1314279  -1.5015444 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0418473  0.00601411 0.01150057 0.06993295 0.00403364]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9876942  0.99290687 0.9964262  0.990851   0.99396163]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03639822  0.05292709  0.01310865 -0.15138628 -0.07561139]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.3574579e-04  6.6314024e-05  5.8001737e-05  1.6366661e-04
 -8.5137181e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.3574579e-04  6.6314024e-05  5.8001737e-05  1.6366661e-04
 -8.5137181e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00097056  0.00075178 -0.00120665  0.00041558 -0.00332414]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 7.4541470e-04 -2.4307624e-03 -5.2648275e-03 -9.3926763e-05
  1.6280334e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00066213 -0.00230966 -0.00523483 -0.00044031  0.00145503]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00066213 -0.00230966 -0.00523483 -0.00044031  0.00145503]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [4.9074519e-05 6.4313045e-04 1.2474956e-03 1.1960448e-04 2.5900666e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.00032453 0.00236871 0.01084179 0.00073315 0.00216757]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.00032453 0.00236871 0.01084179 0.00073315 0.00216757]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.25639227  0.12315612 -0.0452614  -0.06841969 -0.14290386]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.25639227  0.12315612 -0.0452614  -0.06841969 -0.14290386]
  [Layer 7] Output shape after mixer: (1, 1, 2048)
  [Layer 7] Output sample values after mixer: [-0.25639227  0.12315612 -0.0452614  -0.06841969 -0.14290386]
  [Layer 7] Residual connection shape: (1, 1, 2048)
  [Layer 7] Residual connection sample values: [-0.12112184  0.3427837  -0.25897047 -0.5214802   0.22318202]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.07758828  0.1718592  -0.15458065 -0.30969223  0.14228913]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.07758828  0.1718592  -0.15458065 -0.30969223  0.14228913]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.07758828  0.1718592  -0.15458065 -0.30969223  0.14228913]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.28447375 -2.3648226  -2.3443794  -1.9352655  -0.5149045 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.28447375 -2.3648226  -2.3443794  -1.9352655  -0.5149045 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.7768992   1.3696895  -2.0141037  -0.04418973  0.00954033]
  [FlaxMamba2] dt (step) sample values: [ 0.7395196   0.22033116  0.55008674  1.6969756  -0.43957543]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.33567595 0.8000778  0.36608806 0.7768992  0.5890006 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.08337089 -0.11085863  0.19312862 -0.5691739   0.04834124]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.54626155 -0.14187974 -0.12156865 -0.6207486  -0.00778058]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.34592986 -0.06591582 -0.05709414 -0.21702068 -0.00387516]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.34592986 -0.06591582 -0.05709414 -0.21702068 -0.00387516]
  [FlaxMamba2] B (step) sample values: [-0.05687398 -0.06283933  0.18685082  0.03345123  0.07264537]
  [FlaxMamba2] C (step) sample values: [ 0.54765594 -0.13028781 -0.09128275  0.5309175  -0.24558233]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.6542776 -0.9827404 -0.5549556 -3.9396574 -1.8081155]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02096852 0.06719391 0.01922148 0.12481477 0.0062236 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.92623734 0.9360989  0.9893896  0.61156905 0.9888101 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.34592986 -0.06591582 -0.05709414 -0.21702068 -0.00387516]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00041254 -0.00045581  0.00135535  0.00024264  0.00052694]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00041254 -0.00045581  0.00135535  0.00024264  0.00052694]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00045196  0.00283528  0.00159238 -0.00268438 -0.00068856]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0541263  -0.01539865 -0.02801071 -0.01965731 -0.0128188 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.34533006 -0.0708866  -0.07607256 -0.20234533 -0.0160809 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.34533006 -0.0708866  -0.07607256 -0.20234533 -0.0160809 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.05605841 0.0143989  0.01560743 0.04940673 0.00309714]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.03172407 0.0103813  0.0076491  0.03793939 0.00283729]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.03172407 0.0103813  0.0076491  0.03793939 0.00283729]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.11312325  0.12391982  0.14950289  0.08698844 -0.14212686]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.11312325  0.12391982  0.14950289  0.08698844 -0.14212686]
  [Layer 8] Output shape after mixer: (1, 1, 2048)
  [Layer 8] Output sample values after mixer: [ 0.11312325  0.12391982  0.14950289  0.08698844 -0.14212686]
  [Layer 8] Residual connection shape: (1, 1, 2048)
  [Layer 8] Residual connection sample values: [-0.00799859  0.4667035  -0.10946758 -0.43449175  0.08105516]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00359641  0.17145564 -0.04524905 -0.17247188  0.03597673]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00359641  0.17145564 -0.04524905 -0.17247188  0.03597673]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00359641  0.17145564 -0.04524905 -0.17247188  0.03597673]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.351492   -0.06363332 -0.8075438  -1.260532   -0.97960234]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.351492   -0.06363332 -0.8075438  -1.260532   -0.97960234]
  [FlaxMamba2] xBC (step) sample values: [1.514101   0.47138992 0.06583139 0.7393728  0.04223258]
  [FlaxMamba2] dt (step) sample values: [2.6822097 1.4830296 2.3595881 1.2054068 2.1155987]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.02064419  0.32918003  0.7055616   1.514101   -0.9900185 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.22237355  0.07089875 -0.28799832  0.04120512 -0.13062009]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.21502262  0.0455539  -0.37466824 -0.03270846 -0.10558042]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.09599695  0.02329565 -0.15264489 -0.01608679 -0.05000599]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09599695  0.02329565 -0.15264489 -0.01608679 -0.05000599]
  [FlaxMamba2] B (step) sample values: [-0.17954114 -0.27688408 -0.01750264  0.43467423  0.15177983]
  [FlaxMamba2] C (step) sample values: [-0.10822972 -0.22885941 -0.24481297 -0.26965144 -0.24389532]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-5.234511  -1.2161361 -1.4887683 -0.9523448 -3.9666808]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1383968  0.15546498 0.04972173 0.37399727 0.12352279]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.48459607 0.8277314  0.9286493  0.7003505  0.6126414 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09599695  0.02329565 -0.15264489 -0.01608679 -0.05000599]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00238532  0.00367859  0.00023253 -0.00577494 -0.0020165 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00238532  0.00367859  0.00023253 -0.00577494 -0.0020165 ]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00245577  0.00254745  0.00219151 -0.00367045 -0.00261235]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00740712  0.00474513 -0.02587145  0.00048493 -0.00249935]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.13753599  0.0363236  -0.23278955 -0.02132155 -0.07028507]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.13753599  0.0363236  -0.23278955 -0.02132155 -0.07028507]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03822161 -0.00111894  0.05797808  0.00593654  0.01879442]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.02272338 -0.00099126  0.03433898  0.0027726   0.01278487]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02272338 -0.00099126  0.03433898  0.0027726   0.01278487]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.06971304 -0.03917409  0.39245018  0.10172108  0.09349236]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.06971304 -0.03917409  0.39245018  0.10172108  0.09349236]
  [Layer 9] Output shape after mixer: (1, 1, 2048)
  [Layer 9] Output sample values after mixer: [-0.06971304 -0.03917409  0.39245018  0.10172108  0.09349236]
  [Layer 9] Residual connection shape: (1, 1, 2048)
  [Layer 9] Residual connection sample values: [-0.07771163  0.4275294   0.2829826  -0.33277068  0.17454752]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02713852  0.12478989  0.08920657 -0.10386093  0.05957276]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02713852  0.12478989  0.08920657 -0.10386093  0.05957276]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02713852  0.12478989  0.08920657 -0.10386093  0.05957276]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.430098   -0.59845895 -0.01739044 -0.6373066  -0.5603554 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.430098   -0.59845895 -0.01739044 -0.6373066  -0.5603554 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.7225964   0.11366162  0.9380521  -0.26236328  0.5380375 ]
  [FlaxMamba2] dt (step) sample values: [2.0672796  0.29370907 0.6619266  0.7830824  1.2595373 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.3956909 -0.5293305 -0.7617132  0.7225964  1.2417812]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12280375 -0.31778225  0.08646078  0.00336222  0.08200701]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.08444315 -0.40487942 -0.01736002 -0.08245321  0.02243669]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.04400318 -0.16200869 -0.00860467 -0.03952793  0.01134419]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04400318 -0.16200869 -0.00860467 -0.03952793  0.01134419]
  [FlaxMamba2] B (step) sample values: [-0.10416421 -0.04644089  0.07931394  0.12463594 -0.08998584]
  [FlaxMamba2] C (step) sample values: [-0.24795336 -0.03663585 -0.27427673  0.06534757 -0.1072437 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.7154508  -1.4067873  -0.35344088 -2.010216   -0.4652703 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00346542 0.00477006 0.17589685 0.00399145 0.02644676]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.98720694 0.993312   0.9397239  0.99200845 0.9877705 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04400318 -0.16200869 -0.00860467 -0.03952793  0.01134419]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.5883936e-05 -7.0817432e-06  1.2094534e-05  1.9005658e-05
 -1.3721886e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.5883936e-05 -7.0817432e-06  1.2094534e-05  1.9005658e-05
 -1.3721886e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-7.9395513e-06  5.0749506e-05  3.8825528e-05  3.2433378e-05
  1.4401826e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 8.6366825e-05 -2.4252059e-03  2.8689296e-04 -5.1923195e-04
  1.8298278e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00975477 -0.03802186 -0.00160373 -0.00920433  0.00432238]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00975477 -0.03802186 -0.00160373 -0.00920433  0.00432238]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-1.65346230e-03  8.07094574e-03  1.38235355e-05  2.02878308e-03
 -8.80338135e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.01802042  0.04286357  0.00011797  0.01970534 -0.00791308]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01802042  0.04286357  0.00011797  0.01970534 -0.00791308]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.10132576  0.28631112  0.03689358 -0.01637703  0.03846041]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.10132576  0.28631112  0.03689358 -0.01637703  0.03846041]
  [Layer 10] Output shape after mixer: (1, 1, 2048)
  [Layer 10] Output sample values after mixer: [-0.10132576  0.28631112  0.03689358 -0.01637703  0.03846041]
  [Layer 10] Residual connection shape: (1, 1, 2048)
  [Layer 10] Residual connection sample values: [-0.17903739  0.7138405   0.31987616 -0.3491477   0.21300793]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.06179347  0.20045109  0.09861803 -0.1050186   0.07027757]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.06179347  0.20045109  0.09861803 -0.1050186   0.07027757]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.06179347  0.20045109  0.09861803 -0.1050186   0.07027757]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.1318187  -0.24464574  0.10411739 -0.6047611   0.7671467 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.1318187  -0.24464574  0.10411739 -0.6047611   0.7671467 ]
  [FlaxMamba2] xBC (step) sample values: [-0.5230793   0.56978554 -0.35053086  0.42227647 -0.08757225]
  [FlaxMamba2] dt (step) sample values: [1.0838584 1.5164758 1.7290212 2.312222  2.0289197]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.5171268  -0.08247908  0.5253639  -0.5230793   0.00863552]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.1060489  -0.18733762  0.10557526 -0.07010717 -0.0268258 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.09184296 -0.54500365  0.20213288 -0.05796117 -0.00366296]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.04802879 -0.20002964  0.11124623 -0.02814095 -0.00182812]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04802879 -0.20002964  0.11124623 -0.02814095 -0.00182812]
  [FlaxMamba2] B (step) sample values: [-0.26860312 -0.27450955 -0.2779133  -0.02087152  0.14212997]
  [FlaxMamba2] C (step) sample values: [-0.04138895 -0.07186621 -0.2667394  -0.20055741  0.01707067]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.31160602 -0.09015273 -1.5786072  -0.20961139 -0.6694042 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05114588 0.1359296  0.5410605  0.36535963 0.05538579]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.984189   0.9878203  0.42565674 0.92627555 0.9636034 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04802879 -0.20002964  0.11124623 -0.02814095 -0.00182812]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.5981667e-04 -6.7432568e-04 -6.8268692e-04 -5.1270352e-05
  3.4913863e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.5981667e-04 -6.7432568e-04 -6.8268692e-04 -5.1270352e-05
  3.4913863e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.04366433 -0.05690186  0.05092594  0.01376706 -0.05129375]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.08068714 -0.1563792   0.15931055 -0.0505252   0.01160871]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.06306646 -0.22976558  0.2001243  -0.06084949  0.01093802]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.06306646 -0.22976558  0.2001243  -0.06084949  0.01093802]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.05397557  0.02468468  0.01096008  0.01299958  0.00573029]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.05642195  0.02529069  0.00796423  0.03078537  0.00445679]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.05642195  0.02529069  0.00796423  0.03078537  0.00445679]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.00784922  0.20234334 -0.18189031  0.30640188  0.15056519]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.00784922  0.20234334 -0.18189031  0.30640188  0.15056519]
  [Layer 11] Output shape after mixer: (1, 1, 2048)
  [Layer 11] Output sample values after mixer: [ 0.00784922  0.20234334 -0.18189031  0.30640188  0.15056519]
  [Layer 11] Residual connection shape: (1, 1, 2048)
  [Layer 11] Residual connection sample values: [-0.17118818  0.9161838   0.13798586 -0.04274583  0.36357313]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.04536514  0.20146418  0.03194163 -0.00982806  0.09230451]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04536514  0.20146418  0.03194163 -0.00982806  0.09230451]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04536514  0.20146418  0.03194163 -0.00982806  0.09230451]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.14992124 -0.8383388  -0.64246595  0.13574788 -0.6005374 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.14992124 -0.8383388  -0.64246595  0.13574788 -0.6005374 ]
  [FlaxMamba2] xBC (step) sample values: [-0.6395428   0.37574255 -0.06515747 -0.25891897  0.14020887]
  [FlaxMamba2] dt (step) sample values: [2.0871632 2.0955722 1.8769577 1.2041562 1.7050661]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.16735914 -0.36496753 -0.6304363  -0.6395428   1.2600087 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.11111264 -0.08750191 -0.07738914  0.03234925  0.0248393 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.1541119  -0.07460824 -0.11227073  0.00264039  0.03745832]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07113006 -0.03591317 -0.05298749  0.00132194  0.0190799 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07113006 -0.03591317 -0.05298749  0.00132194  0.0190799 ]
  [FlaxMamba2] B (step) sample values: [ 0.0138132  -0.21999155 -0.00837158 -0.10363448 -0.01008963]
  [FlaxMamba2] C (step) sample values: [-0.27554363 -0.17536029  0.05374233 -0.26431596 -0.09793856]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2411823 -0.7693517 -1.9974962 -1.2367963 -1.0181218]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.29916224 0.44947386 0.16432045 0.28092426 0.36783907]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6898267  0.7076515  0.72019774 0.7064901  0.6876296 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07113006 -0.03591317 -0.05298749  0.00132194  0.0190799 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00029394  0.00468129  0.00017814  0.00220528  0.0002147 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00029394  0.00468129  0.00017814  0.00220528  0.0002147 ]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00275731  0.00913683 -0.01216478  0.00463024 -0.00015999]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00993571 -0.01162359  0.02579312 -0.00447893 -0.0038051 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.06113615 -0.03747441 -0.01234803 -0.00352738  0.00992888]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.06113615 -0.03747441 -0.01234803 -0.00352738  0.00992888]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00492569  0.00948409  0.00273449 -0.00025564 -0.0021121 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.01730857  0.02195157  0.00478348 -0.0005115  -0.00607641]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01730857  0.02195157  0.00478348 -0.0005115  -0.00607641]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.33381978 -0.16473861 -0.18243895 -0.21553363  0.4322055 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.33381978 -0.16473861 -0.18243895 -0.21553363  0.4322055 ]
  [Layer 12] Output shape after mixer: (1, 1, 2048)
  [Layer 12] Output sample values after mixer: [-0.33381978 -0.16473861 -0.18243895 -0.21553363  0.4322055 ]
  [Layer 12] Residual connection shape: (1, 1, 2048)
  [Layer 12] Residual connection sample values: [-0.505008    0.75144523 -0.0444531  -0.25827944  0.79577863]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.12397191  0.15964268 -0.0100696  -0.05506215  0.19829912]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.12397191  0.15964268 -0.0100696  -0.05506215  0.19829912]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.12397191  0.15964268 -0.0100696  -0.05506215  0.19829912]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-2.0498412   1.07248     0.5427088   1.0184585  -0.06802882]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-2.0498412   1.07248     0.5427088   1.0184585  -0.06802882]
  [FlaxMamba2] xBC (step) sample values: [-0.64950573 -0.21879862 -0.5107735   0.37458807  0.3226914 ]
  [FlaxMamba2] dt (step) sample values: [1.5957634 1.407247  1.5906146 1.0673125 2.1648698]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.80534804 -0.29596958 -1.7109807  -0.64950573  0.13512602]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-3.0876613e-01 -1.3195589e-02  7.7870131e-01 -2.3411587e-04
 -6.0881570e-02]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.57341456 -0.12311991  0.758224   -0.00103902 -0.08483787]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.20668687 -0.05777511  0.51632625 -0.00051924 -0.04062065]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.20668687 -0.05777511  0.51632625 -0.00051924 -0.04062065]
  [FlaxMamba2] B (step) sample values: [-0.07390478  0.097229   -0.1777342   0.53684723 -0.09326398]
  [FlaxMamba2] C (step) sample values: [ 0.30146444 -0.16813841 -0.05742713  0.4293737   0.14983255]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3103099 -1.7870504 -0.8605819 -1.881061  -0.5251649]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04650461 0.03926393 0.1754212  0.1300992  0.14382549]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.940884   0.93223846 0.8598784  0.7829202  0.92724997]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.20668687 -0.05777511  0.51632625 -0.00051924 -0.04062065]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00071036 -0.00093455  0.00170836 -0.00516012  0.00089644]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00071036 -0.00093455  0.00170836 -0.00516012  0.00089644]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00071604 -0.00627628  0.00118362 -0.04002637  0.00087219]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.07062566  0.03937114  0.02557248 -0.01068894  0.03271636]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0795236   0.0368839   0.0478005  -0.0107113   0.03096762]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0795236   0.0368839   0.0478005  -0.0107113   0.03096762]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01859438  0.02947284  0.01640666 -0.00801455 -0.00101753]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.07167915  0.03747639  0.08554103 -0.04756518 -0.00230409]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.07167915  0.03747639  0.08554103 -0.04756518 -0.00230409]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.25090805 -0.26930076  0.0111787   0.10970706  0.18250325]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.25090805 -0.26930076  0.0111787   0.10970706  0.18250325]
  [Layer 13] Output shape after mixer: (1, 1, 2048)
  [Layer 13] Output sample values after mixer: [ 0.25090805 -0.26930076  0.0111787   0.10970706  0.18250325]
  [Layer 13] Residual connection shape: (1, 1, 2048)
  [Layer 13] Residual connection sample values: [-0.25409994  0.48214447 -0.03327439 -0.14857239  0.97828186]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.05253005  0.08754555 -0.00636891 -0.02674082  0.1974316 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.05253005  0.08754555 -0.00636891 -0.02674082  0.1974316 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.05253005  0.08754555 -0.00636891 -0.02674082  0.1974316 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.18689758  0.18386774 -0.7540548  -0.44554538  0.29091313]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.18689758  0.18386774 -0.7540548  -0.44554538  0.29091313]
  [FlaxMamba2] xBC (step) sample values: [-1.276522   -0.10059457  0.23245984 -0.04149251  0.36344868]
  [FlaxMamba2] dt (step) sample values: [1.072948  1.2303205 1.2388091 1.6382762 2.3051145]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.04662067 -0.787196   -1.5263305  -1.276522    1.1026312 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.35706198 -0.10548972 -0.1315451  -0.02599183 -0.04994746]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.39661276 -0.14674948 -0.19239715 -0.088797   -0.0133874 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.15948847 -0.06800053 -0.08697285 -0.04242857 -0.0066489 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.15948847 -0.06800053 -0.08697285 -0.04242857 -0.0066489 ]
  [FlaxMamba2] B (step) sample values: [-0.08692669 -0.03362904  0.04303359 -0.03485589 -0.02884866]
  [FlaxMamba2] C (step) sample values: [-0.06820175 -0.05151916  0.03033841 -0.07598615 -0.1056065 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.318424  -0.7620611 -2.6670074 -5.1836414 -2.8487349]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11144444 0.04059509 0.2564312  0.08233778 0.13123672]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6180015  0.9695377  0.5046431  0.65258783 0.68807423]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.15948847 -0.06800053 -0.08697285 -0.04242857 -0.0066489 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00154504  0.00059773 -0.00076488  0.00061953  0.00051276]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00154504  0.00059773 -0.00076488  0.00061953  0.00051276]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00241325  0.00094493 -0.00091358  0.00123097  0.00071428]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02179145 -0.00416057 -0.01459268 -0.00570546 -0.00308709]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.08626043 -0.03164798 -0.04974915 -0.02285609 -0.00577473]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.08626043 -0.03164798 -0.04974915 -0.02285609 -0.00577473]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00881203 -0.00317625  0.01200204  0.00397582 -0.0009613 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.05089591 -0.0106767   0.05854353  0.0272637  -0.00764173]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.05089591 -0.0106767   0.05854353  0.0272637  -0.00764173]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.26384702  0.10686748  0.26732925  0.43442008 -0.0015774 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.26384702  0.10686748  0.26732925  0.43442008 -0.0015774 ]
  [Layer 14] Output shape after mixer: (1, 1, 2048)
  [Layer 14] Output sample values after mixer: [ 0.26384702  0.10686748  0.26732925  0.43442008 -0.0015774 ]
  [Layer 14] Residual connection shape: (1, 1, 2048)
  [Layer 14] Residual connection sample values: [0.00974709 0.58901197 0.23405485 0.2858477  0.9767045 ]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.00185468 0.0952853  0.0409359  0.04681054 0.178077  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.00185468 0.0952853  0.0409359  0.04681054 0.178077  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.00185468 0.0952853  0.0409359  0.04681054 0.178077  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.34628034  1.0722034   0.5539261  -0.0512478  -1.0556256 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.34628034  1.0722034   0.5539261  -0.0512478  -1.0556256 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.05313125 -0.7317989  -0.22813556  0.3990304   0.78115046]
  [FlaxMamba2] dt (step) sample values: [0.5565499  0.63640165 2.1196768  0.19308802 0.5581396 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.47172862  0.19674203 -0.6432447   0.05313125  0.11638839]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.13990459  0.16844758  0.07528837 -0.25585848 -0.06425945]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.17734966  0.16159257  0.0505081  -0.27360445 -0.0896043 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.08083215  0.08731016  0.02589168 -0.11820326 -0.04279626]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08083215  0.08731016  0.02589168 -0.11820326 -0.04279626]
  [FlaxMamba2] B (step) sample values: [-0.04000766 -0.05676329 -0.0148252   0.02926033  0.04815349]
  [FlaxMamba2] C (step) sample values: [-0.02692653 -0.02957459  0.00630189 -0.02542238 -0.03141974]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.27823287 -0.68077636 -2.7209377  -0.11263601 -3.8483953 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00337543 0.02974113 0.11951994 0.0069394  0.04011947]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9990613  0.97995657 0.7223783  0.9992187  0.85693294]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08083215  0.08731016  0.02589168 -0.11820326 -0.04279626]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0915829e-05  1.5487492e-05  4.0449581e-06 -7.9834899e-06
 -1.3138366e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0915829e-05  1.5487492e-05  4.0449581e-06 -7.9834899e-06
 -1.3138366e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-6.2597319e-05  5.7872876e-06 -1.8658906e-05 -1.5916634e-05
 -1.0142707e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 4.6981449e-06  1.2902686e-06  2.6805176e-06 -1.2029768e-06
  3.0831202e-06]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01377151  0.01488154  0.00441539 -0.02014656 -0.00729067]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01377151  0.01488154  0.00441539 -0.02014656 -0.00729067]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00279316  0.0118875   0.0015532   0.00050301  0.00198675]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.05368674  0.2985421   0.03007897  0.01132823  0.03283715]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.05368674  0.2985421   0.03007897  0.01132823  0.03283715]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.14566132  0.3816523   0.5156112  -0.25293356  0.09904069]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.14566132  0.3816523   0.5156112  -0.25293356  0.09904069]
  [Layer 15] Output shape after mixer: (1, 1, 2048)
  [Layer 15] Output sample values after mixer: [-0.14566132  0.3816523   0.5156112  -0.25293356  0.09904069]
  [Layer 15] Residual connection shape: (1, 1, 2048)
  [Layer 15] Residual connection sample values: [-0.13591424  0.97066426  0.74966604  0.03291413  1.0757452 ]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02252221  0.13447602  0.11380943  0.004577    0.17123286]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02252221  0.13447602  0.11380943  0.004577    0.17123286]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02252221  0.13447602  0.11380943  0.004577    0.17123286]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.6235746e-01  5.8015521e-06  5.3797085e-02  1.1052841e+00
 -6.6108692e-01]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.6235746e-01  5.8015521e-06  5.3797085e-02  1.1052841e+00
 -6.6108692e-01]
  [FlaxMamba2] xBC (step) sample values: [ 0.647479    0.09625299 -0.41014162  1.0362008   0.20332567]
  [FlaxMamba2] dt (step) sample values: [1.4631859 1.1194072 1.6726491 1.1930088 1.9715304]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.9898985  0.8945974  1.6344718  0.647479  -1.3074962]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.27551717 -0.04049308 -0.09581296  0.31577557  0.02448812]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.23938435 -0.08163078 -0.10894315  0.22336835 -0.01759562]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.13395038 -0.03915042 -0.05150735  0.12410593 -0.00872041]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.13395038 -0.03915042 -0.05150735  0.12410593 -0.00872041]
  [FlaxMamba2] B (step) sample values: [-0.22212    -0.03331426 -0.02909652  0.02774064 -0.19496898]
  [FlaxMamba2] C (step) sample values: [-0.19937912  0.10719105 -0.08470298  0.9006568  -0.15128799]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6905513  -0.13480766 -1.3128716  -3.7739606  -1.2635014 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.22626199 0.19479264 0.23603347 0.2241625  0.15662545]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.5440199  0.97408223 0.73353374 0.4291364  0.8204548 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.13395038 -0.03915042 -0.05150735  0.12410593 -0.00872041]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00673199 -0.00100968 -0.00088185  0.00084076 -0.0059091 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00673199 -0.00100968 -0.00088185  0.00084076 -0.0059091 ]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-8.8765454e-03 -2.6540556e-03  3.9362971e-04  4.9267372e-05
 -7.4735191e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.05085561 -0.02352341 -0.01328268  0.02794197 -0.01486695]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.1370633  -0.0487198  -0.04643174  0.10781395 -0.02047923]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.1370633  -0.0487198  -0.04643174  0.10781395 -0.02047923]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-1.0225359e-02 -1.4132564e-07 -1.2825328e-03  8.9522615e-02
  4.6098153e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-4.3200403e-02 -4.6867808e-07 -5.0973268e-03  3.1700173e-01
  1.6767440e-02]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-4.3200403e-02 -4.6867808e-07 -5.0973268e-03  3.1700173e-01
  1.6767440e-02]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.21431844  0.23497804  0.22422302  0.49433807 -0.14278302]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.21431844  0.23497804  0.22422302  0.49433807 -0.14278302]
  [Layer 16] Output shape after mixer: (1, 1, 2048)
  [Layer 16] Output sample values after mixer: [ 0.21431844  0.23497804  0.22422302  0.49433807 -0.14278302]
  [Layer 16] Residual connection shape: (1, 1, 2048)
  [Layer 16] Residual connection sample values: [0.0784042  1.2056423  0.97388905 0.5272522  0.9329622 ]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.01189375 0.15368122 0.13160147 0.0658951  0.13616744]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.01189375 0.15368122 0.13160147 0.0658951  0.13616744]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.01189375 0.15368122 0.13160147 0.0658951  0.13616744]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.07304983 -0.17395963 -0.31427214 -0.31783858 -0.11092847]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.07304983 -0.17395963 -0.31427214 -0.31783858 -0.11092847]
  [FlaxMamba2] xBC (step) sample values: [-0.46844298 -0.7466442   0.45776847 -1.0219275  -0.54118013]
  [FlaxMamba2] dt (step) sample values: [-0.30414802  2.0325398   1.1573162   1.6167827   1.6795502 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.9301225  -1.2048231  -1.2432877  -0.46844298  0.31953278]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.14172484  0.12961158 -0.11138364  0.07281739  0.09650264]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.17352416  0.10341224 -0.12574217  0.06741577  0.10913692]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07925326  0.05437727 -0.05892351  0.03484368  0.05754323]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07925326  0.05437727 -0.05892351  0.03484368  0.05754323]
  [FlaxMamba2] B (step) sample values: [-0.18491082  0.02730398 -0.16601276  0.1652447  -0.17762049]
  [FlaxMamba2] C (step) sample values: [-0.10557311  0.01170488  0.05989315  0.14290622  0.02139567]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.1570504  -11.466768   -14.214988    -0.12863436 -14.242779  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00037878 0.07578822 0.06716045 0.10570709 0.03731411]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99956185 0.41935143 0.38493338 0.9864945  0.58774817]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07925326  0.05437727 -0.05892351  0.03484368  0.05754323]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.5509317e-06 -8.1965192e-07  4.9836217e-06 -4.9605646e-06
  5.3320796e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.5509317e-06 -8.1965192e-07  4.9836217e-06 -4.9605646e-06
  5.3320796e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-6.8679925e-05  8.4495630e-05  1.0637642e-04 -2.6222802e-04
  1.4365662e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-2.3571622e-05 -1.4423742e-05  4.5072863e-07 -4.1233698e-06
  2.2888567e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05113836  0.03505647 -0.03800257  0.02246848  0.03713569]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05113836  0.03505647 -0.03800257  0.02246848  0.03713569]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00193602 -0.00278465  0.00504087 -0.00300796 -0.00194558]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.01629956 -0.02863454  0.03934351 -0.02858945 -0.0185641 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01629956 -0.02863454  0.03934351 -0.02858945 -0.0185641 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.5732602  -0.19289118  0.07208387 -0.23660825  0.40849006]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.5732602  -0.19289118  0.07208387 -0.23660825  0.40849006]
  [Layer 17] Output shape after mixer: (1, 1, 2048)
  [Layer 17] Output sample values after mixer: [ 0.5732602  -0.19289118  0.07208387 -0.23660825  0.40849006]
  [Layer 17] Residual connection shape: (1, 1, 2048)
  [Layer 17] Residual connection sample values: [0.6516644  1.0127511  1.045973   0.29064393 1.3414522 ]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.07102824 0.09333676 0.10194609 0.02658515 0.14054064]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.07102824 0.09333676 0.10194609 0.02658515 0.14054064]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.07102824 0.09333676 0.10194609 0.02658515 0.14054064]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.62224156 -0.7681729   0.0417581  -0.11620614  0.11042003]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.62224156 -0.7681729   0.0417581  -0.11620614  0.11042003]
  [FlaxMamba2] xBC (step) sample values: [-0.02576631  0.69796956 -0.01418924 -0.1406783  -0.41495553]
  [FlaxMamba2] dt (step) sample values: [0.99468553 1.7862222  0.6390062  1.42207    2.6001747 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.5444347   0.08378849  0.99266255 -0.02576631 -0.96895117]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.20329781 -0.51723194 -0.05527243 -0.19872952 -0.03359043]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.19328804 -0.7826128   0.22451273 -0.2125616  -0.07567418]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.10595512 -0.24555027  0.12480519 -0.09502754 -0.03640612]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.10595512 -0.24555027  0.12480519 -0.09502754 -0.03640612]
  [FlaxMamba2] B (step) sample values: [ 0.1720207   0.06821019 -0.06275787  0.05860883  0.03873344]
  [FlaxMamba2] C (step) sample values: [-0.27823955 -0.11081612  0.01732024 -0.08568261 -0.03802796]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3010656 -1.4685526 -1.2082934 -1.2128745 -2.5874777]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.24012269 0.28867733 0.13487485 0.27691767 0.4633264 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.73167753 0.65446454 0.849618   0.7147186  0.30154178]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.10595512 -0.24555027  0.12480519 -0.09502754 -0.03640612]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00437659  0.00173542 -0.0015967   0.00149114  0.00098546]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00437659  0.00173542 -0.0015967   0.00149114  0.00098546]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00784216 0.00672133 0.00603479 0.00147752 0.00253736]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01118919 -0.07267621  0.09113251 -0.04903264 -0.02532196]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03166378 -0.12012595  0.11524966 -0.06739561 -0.03235702]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03166378 -0.12012595  0.11524966 -0.06739561 -0.03235702]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00688154  0.02924038  0.00245654  0.00368862 -0.00188496]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.05926188  0.10341528  0.01580302  0.03053086 -0.02455538]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.05926188  0.10341528  0.01580302  0.03053086 -0.02455538]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.49005836  0.25539312  0.25747865 -0.27672714  0.36629206]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.49005836  0.25539312  0.25747865 -0.27672714  0.36629206]
  [Layer 18] Output shape after mixer: (1, 1, 2048)
  [Layer 18] Output sample values after mixer: [ 0.49005836  0.25539312  0.25747865 -0.27672714  0.36629206]
  [Layer 18] Residual connection shape: (1, 1, 2048)
  [Layer 18] Residual connection sample values: [1.1417227  1.2681442  1.3034515  0.01391679 1.7077444 ]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.11855631 0.11367988 0.12633978 0.00124237 0.17695111]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.11855631 0.11367988 0.12633978 0.00124237 0.17695111]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.11855631 0.11367988 0.12633978 0.00124237 0.17695111]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.13130747 -0.46821997  0.52740514 -0.17831449  0.07160947]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.13130747 -0.46821997  0.52740514 -0.17831449  0.07160947]
  [FlaxMamba2] xBC (step) sample values: [-0.02575407 -0.47584552 -0.45484757 -0.15943988 -0.2099081 ]
  [FlaxMamba2] dt (step) sample values: [0.92169666 1.6570516  1.670791   1.0044527  0.93220216]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.4179927  -1.0870969  -0.6588937  -0.02575407 -0.27428424]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.1832418  -0.18253368 -0.08342963 -0.07670142  0.02285353]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.21888633 -0.20687145 -0.0884307  -0.11930396 -0.01010546]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.09751295 -0.09277476 -0.04226163 -0.05609784 -0.0050272 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09751295 -0.09277476 -0.04226163 -0.05609784 -0.0050272 ]
  [FlaxMamba2] B (step) sample values: [-0.03376905 -0.05671554  0.02898834  0.10433295 -0.00656758]
  [FlaxMamba2] C (step) sample values: [-0.22568049 -0.0198461  -0.00777529 -0.19894202 -0.05858215]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9436172 -1.8178532 -2.0862153 -1.0006425 -0.9649832]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.13164328 0.142522   0.11715941 0.1341641  0.17382295]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.77424717 0.77175814 0.78315884 0.8743712  0.8455768 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09751295 -0.09277476 -0.04226163 -0.05609784 -0.0050272 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.3349076e-04  7.2805310e-04 -3.7212105e-04 -1.3393142e-03
  8.4307518e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.3349076e-04  7.2805310e-04 -3.7212105e-04 -1.3393142e-03
  8.4307518e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00110792 -0.0184602  -0.00025445 -0.00149632  0.00057643]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00737464 -0.00829055 -0.00302708  0.00074268  0.00293951]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01834344 -0.01872637 -0.00778091 -0.00556752  0.00237403]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01834344 -0.01872637 -0.00778091 -0.00556752  0.00237403]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-1.283270e-03  3.376034e-03 -2.580720e-03  4.522452e-04  8.804353e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.03651636  0.10095617 -0.09900246  0.01269224  0.00351517]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03651636  0.10095617 -0.09900246  0.01269224  0.00351517]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.12790143 -0.16981882  0.26925674 -0.05578046 -0.24803343]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.12790143 -0.16981882  0.26925674 -0.05578046 -0.24803343]
  [Layer 19] Output shape after mixer: (1, 1, 2048)
  [Layer 19] Output sample values after mixer: [ 0.12790143 -0.16981882  0.26925674 -0.05578046 -0.24803343]
  [Layer 19] Residual connection shape: (1, 1, 2048)
  [Layer 19] Residual connection sample values: [ 1.2696241   1.0983255   1.5727082  -0.04186366  1.459711  ]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.14720519  0.10916363  0.16737124 -0.00412101  0.16411275]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14720519  0.10916363  0.16737124 -0.00412101  0.16411275]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14720519  0.10916363  0.16737124 -0.00412101  0.16411275]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.09475964 -0.38239968 -0.5034777  -0.02051421  0.21130402]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.09475964 -0.38239968 -0.5034777  -0.02051421  0.21130402]
  [FlaxMamba2] xBC (step) sample values: [ 0.03750836  0.4224101  -0.8799346   0.37991014 -0.26209155]
  [FlaxMamba2] dt (step) sample values: [1.5366411 2.0371401 1.9466923 1.2002937 1.4708499]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.41172123 -0.9065046  -0.48445582  0.03750836  0.1886424 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12871066  0.21845679 -0.30277807 -0.32060018  0.17066689]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.09022799  0.22698645 -0.23624974 -0.339399    0.14321633]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.04714789  0.12631893 -0.10423593 -0.14117487  0.07672714]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04714789  0.12631893 -0.10423593 -0.14117487  0.07672714]
  [FlaxMamba2] B (step) sample values: [0.19690461 0.20243129 0.08076694 0.2078634  0.2334722 ]
  [FlaxMamba2] C (step) sample values: [ 0.12408857 -0.2318259   0.04478358 -0.02426726  0.6044039 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.6215758 -5.0388985 -1.2056414 -1.6434968 -1.3345234]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.12921955 0.0839298  0.05974303 0.14543955 0.12532535]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8109578  0.65513515 0.9305042  0.7873917  0.8459884 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04714789  0.12631893 -0.10423593 -0.14117487  0.07672714]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00119963 0.0012333  0.00049207 0.00126639 0.00142241]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00119963 0.0012333  0.00049207 0.00126639 0.00142241]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00237407  0.00120356  0.00308507  0.0034448   0.00473347]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01704795  0.03233213 -0.00933975 -0.02276255  0.03595383]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01742357  0.0333385  -0.01017019 -0.02388728  0.03656511]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01742357  0.0333385  -0.01017019 -0.02388728  0.03656511]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00078644 -0.00517019  0.001929    0.0002425   0.00426982]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.01051392 -0.07403912  0.03708434  0.00352742  0.05549164]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01051392 -0.07403912  0.03708434  0.00352742  0.05549164]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.26450026  0.43789175  0.12175389 -0.52577144  0.24321678]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.26450026  0.43789175  0.12175389 -0.52577144  0.24321678]
  [Layer 20] Output shape after mixer: (1, 1, 2048)
  [Layer 20] Output sample values after mixer: [ 0.26450026  0.43789175  0.12175389 -0.52577144  0.24321678]
  [Layer 20] Residual connection shape: (1, 1, 2048)
  [Layer 20] Residual connection sample values: [ 1.5341244  1.5362172  1.6944622 -0.5676351  1.7029277]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.12940913  0.11760899  0.12305912 -0.03974896  0.13431896]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12940913  0.11760899  0.12305912 -0.03974896  0.13431896]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12940913  0.11760899  0.12305912 -0.03974896  0.13431896]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.6028827  -0.37018013  0.04840028 -0.08478583 -0.07386611]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.6028827  -0.37018013  0.04840028 -0.08478583 -0.07386611]
  [FlaxMamba2] xBC (step) sample values: [ 0.00513765  0.50105286  0.02158759 -0.37743506  0.20006405]
  [FlaxMamba2] dt (step) sample values: [1.4230988 3.0359929 1.2013427 1.1697731 3.3351824]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.1051529   0.65818185 -0.08383006  0.00513765 -0.26555884]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00036521  0.13517386 -0.00578248  0.08134556 -0.03128211]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.03091531  0.10508353  0.00907196  0.07626438 -0.00338905]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01521873  0.05529986  0.00455655  0.03958555 -0.00169165]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01521873  0.05529986  0.00455655  0.03958555 -0.00169165]
  [FlaxMamba2] B (step) sample values: [ 0.00953718 -0.04545242  0.10312101  0.04172937  0.07918113]
  [FlaxMamba2] C (step) sample values: [-0.03935979 -0.00086373 -0.00414723  0.06331564 -0.00168508]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.2091806  -0.04342505 -3.8147197  -6.662431   -0.02279418]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.22252296 0.084785   0.09674274 0.07582578 0.1998558 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.4896246  0.99632496 0.6913933  0.60339457 0.9954548 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01521873  0.05529986  0.00455655  0.03958555 -0.00169165]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.2297838e-05  1.5392540e-04 -3.4922108e-04 -1.4131723e-04
 -2.6814829e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.2297838e-05  1.5392540e-04 -3.4922108e-04 -1.4131723e-04
 -2.6814829e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0001785   0.00016042 -0.0002476  -0.00023467 -0.00040579]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.8090708e-04  5.6091644e-04  9.9761783e-05  4.9232156e-04
 -3.1310436e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00285228  0.0102678   0.00089958  0.00744084 -0.00032825]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00285228  0.0102678   0.00089958  0.00744084 -0.00032825]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 6.0819188e-04 -1.5526724e-03  2.2296730e-05 -3.0207465e-04
  1.1675693e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.04553631 -0.10675024  0.00203751 -0.02327946  0.0008088 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04553631 -0.10675024  0.00203751 -0.02327946  0.0008088 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.27915683  0.3260287   0.08982181 -0.47352782  0.59020966]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.27915683  0.3260287   0.08982181 -0.47352782  0.59020966]
  [Layer 21] Output shape after mixer: (1, 1, 2048)
  [Layer 21] Output sample values after mixer: [-0.27915683  0.3260287   0.08982181 -0.47352782  0.59020966]
  [Layer 21] Residual connection shape: (1, 1, 2048)
  [Layer 21] Residual connection sample values: [ 1.2549676  1.8622459  1.784284  -1.041163   2.2931373]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15412822  0.19263045  0.19558668 -0.10519315  0.26403794]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15412822  0.19263045  0.19558668 -0.10519315  0.26403794]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15412822  0.19263045  0.19558668 -0.10519315  0.26403794]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.8318807   0.17222875 -0.1257449  -0.49012747 -0.41701594]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.8318807   0.17222875 -0.1257449  -0.49012747 -0.41701594]
  [FlaxMamba2] xBC (step) sample values: [-0.6779828   0.03898305 -0.31922895  0.30946594 -0.17608832]
  [FlaxMamba2] dt (step) sample values: [2.108001  1.7123237 1.2830878 1.0028446 1.8415312]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.02076029 -0.62286955  0.04268686 -0.6779828  -0.04857424]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.05751848 -0.01437545 -0.05036618 -0.04434464 -0.17022666]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.00985003 -0.0931108   0.26896977 -0.08532975 -0.23590049]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00494927 -0.04438956  0.15246283 -0.04084569 -0.10410214]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00494927 -0.04438956  0.15246283 -0.04084569 -0.10410214]
  [FlaxMamba2] B (step) sample values: [ 0.05353241  0.02225365 -0.05016139 -0.17360103 -0.04042023]
  [FlaxMamba2] C (step) sample values: [ 0.15134045 -0.06948771 -0.04817973 -0.01895785 -0.10459273]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.1489344 -3.5005836 -2.8320918 -5.5395546 -1.7185895]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01090482 0.20635182 0.2086323  0.12066522 0.01790095]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.95576483 0.48560888 0.55384755 0.5125118  0.96970403]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00494927 -0.04438956  0.15246283 -0.04084569 -0.10410214]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.8891909e-06  1.2010493e-06 -2.7072542e-06 -9.3693998e-06
 -2.1815149e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.8891909e-06  1.2010493e-06 -2.7072542e-06 -9.3693998e-06
 -2.1815149e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [3.0693343e-05 3.2289459e-05 7.7752375e-06 2.0391039e-05 6.1081206e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00138491  0.00042364  0.00236328  0.00032867 -0.00102591]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00018621 -0.01032738  0.03928933 -0.00956404 -0.02623915]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00018621 -0.01032738  0.03928933 -0.00956404 -0.02623915]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 4.7078032e-05 -9.6573157e-04 -2.3151119e-03  1.7806471e-03
  4.3465584e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00027314 -0.01577422 -0.02156634  0.04080992  0.06541294]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00027314 -0.01577422 -0.02156634  0.04080992  0.06541294]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.00773562 -0.47832105  0.20412554  0.38764805 -0.00551909]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.00773562 -0.47832105  0.20412554  0.38764805 -0.00551909]
  [Layer 22] Output shape after mixer: (1, 1, 2048)
  [Layer 22] Output sample values after mixer: [-0.00773562 -0.47832105  0.20412554  0.38764805 -0.00551909]
  [Layer 22] Residual connection shape: (1, 1, 2048)
  [Layer 22] Residual connection sample values: [ 1.247232   1.3839248  1.9884095 -0.6535149  2.2876182]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.10016636  0.09562603  0.14619261 -0.04539405  0.1780358 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10016636  0.09562603  0.14619261 -0.04539405  0.1780358 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10016636  0.09562603  0.14619261 -0.04539405  0.1780358 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.02673815 -0.53912985 -0.6545214  -0.15690358 -0.03120874]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.02673815 -0.53912985 -0.6545214  -0.15690358 -0.03120874]
  [FlaxMamba2] xBC (step) sample values: [ 0.5952018  -0.47868153 -0.06770775  0.01691078 -0.4891895 ]
  [FlaxMamba2] dt (step) sample values: [-0.1255136   0.7122484   0.945801    0.11487946  1.4041035 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.1896893  -0.7503175  -1.093606    0.5952018   0.44678605]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.27626473 -0.07414079 -0.01630839  0.02028344  0.16619207]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.25389534 -0.10725236 -0.02766093  0.01812241  0.11681463]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.14297736 -0.05075317 -0.01363919  0.00914331  0.06181486]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.14297736 -0.05075317 -0.01363919  0.00914331  0.06181486]
  [FlaxMamba2] B (step) sample values: [ 0.08462739 -0.00052297  0.19646467  0.02155471 -0.04700972]
  [FlaxMamba2] C (step) sample values: [ 0.03995707 -0.05925013  0.12469465 -0.00063847 -0.0114529 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.08112868 -3.7998476  -0.08256738 -0.48783726 -1.4532163 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01045752 0.08594244 0.02651654 0.00163324 0.00421503]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99915195 0.7213952  0.997813   0.99920356 0.9938934 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.14297736 -0.05075317 -0.01363919  0.00914331  0.06181486]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.2653385e-04 -7.8194017e-07  2.9375163e-04  3.2228349e-05
 -7.0288363e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.2653385e-04 -7.8194017e-07  2.9375163e-04  3.2228349e-05
 -7.0288363e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00029232  0.00051774 -0.00292144 -0.00010365  0.00071212]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00239679 -0.00227562  0.00067953 -0.00053834  0.00034922]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00544695 -0.0011929   0.0009705  -0.00073339 -0.00096949]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00544695 -0.0011929   0.0009705  -0.00073339 -0.00096949]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 7.1847244e-05  2.3692138e-04 -2.1722357e-04  5.3031326e-05
  1.4892181e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.0128324   0.00536834 -0.00864437  0.00338573  0.00278584]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0128324   0.00536834 -0.00864437  0.00338573  0.00278584]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.9534981   0.65391546 -1.8661215   0.5106204   0.5506106 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.9534981   0.65391546 -1.8661215   0.5106204   0.5506106 ]
  [Layer 23] Output shape after mixer: (1, 1, 2048)
  [Layer 23] Output sample values after mixer: [ 0.9534981   0.65391546 -1.8661215   0.5106204   0.5506106 ]
  [Layer 23] Residual connection shape: (1, 1, 2048)
  [Layer 23] Residual connection sample values: [ 2.20073     2.0378404   0.12228799 -0.1428945   2.8382287 ]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13511565  0.11937568  0.00692249 -0.00780325  0.1689798 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13511565  0.11937568  0.00692249 -0.00780325  0.1689798 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13511565  0.11937568  0.00692249 -0.00780325  0.1689798 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.8014818  -0.5439023   0.8107632  -0.06783347 -0.16019809]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.8014818  -0.5439023   0.8107632  -0.06783347 -0.16019809]
  [FlaxMamba2] xBC (step) sample values: [ 0.12918073  0.3147636   0.23644935 -0.22505614  0.76081526]
  [FlaxMamba2] dt (step) sample values: [1.5067226  0.09431453 0.01758309 0.67138034 0.91151375]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.00151273 -0.5737442  -0.05577047  0.12918073 -0.00165033]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03460703  0.00129089  0.02762    -0.03030447  0.3518287 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.03795252  0.00128177  0.02366034 -0.0319219   0.34709466]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.0186162   0.0006413   0.01197012 -0.01570622  0.2033672 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0186162   0.0006413   0.01197012 -0.01570622  0.2033672 ]
  [FlaxMamba2] B (step) sample values: [-0.05359497 -0.05464678  0.1523793   0.24980035 -0.03482043]
  [FlaxMamba2] C (step) sample values: [-0.22663459 -0.24372633 -0.27785105 -0.27211648  0.27509612]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.07415762 -3.4496791  -3.2884939  -0.16087165 -2.6944954 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02460455 0.03190107 0.04650209 0.00895171 0.05290414]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99817705 0.89579076 0.8581968  0.99856097 0.8671442 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0186162   0.0006413   0.01197012 -0.01570622  0.2033672 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.4548819e-05  2.5030591e-05 -6.9796326e-05 -1.1441939e-04
  1.5949265e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.4548819e-05  2.5030591e-05 -6.9796326e-05 -1.1441939e-04
  1.5949265e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.5050361e-04  5.5300776e-04  2.9778188e-05 -6.6536086e-05
  6.9890200e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00085518 -0.00138682  0.00127948 -0.001191   -0.00435138]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00075608 -0.00139023  0.00121576 -0.00110739 -0.00543402]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00075608 -0.00139023  0.00121576 -0.00110739 -0.00543402]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-4.1830420e-04  2.7771958e-04  6.8236724e-04  3.6285684e-05
  4.0047060e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.02369076  0.02228167  0.04943978  0.00959093  0.06262088]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02369076  0.02228167  0.04943978  0.00959093  0.06262088]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.30724293  0.36787972 -0.8010866  -0.23963356 -0.5940074 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.30724293  0.36787972 -0.8010866  -0.23963356 -0.5940074 ]
  [Layer 24] Output shape after mixer: (1, 1, 2048)
  [Layer 24] Output sample values after mixer: [-0.30724293  0.36787972 -0.8010866  -0.23963356 -0.5940074 ]
  [Layer 24] Residual connection shape: (1, 1, 2048)
  [Layer 24] Residual connection sample values: [ 1.8934872   2.40572    -0.6787986  -0.38252807  2.2442212 ]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.11176863  0.12979296 -0.0378366  -0.01993535  0.1310613 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11176863  0.12979296 -0.0378366  -0.01993535  0.1310613 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11176863  0.12979296 -0.0378366  -0.01993535  0.1310613 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.19792636  0.03782441  0.17599027  0.2141224  -0.17020686]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.19792636  0.03782441  0.17599027  0.2141224  -0.17020686]
  [FlaxMamba2] xBC (step) sample values: [-0.11417346 -0.26667106 -0.05463539  0.08104246 -0.09501009]
  [FlaxMamba2] dt (step) sample values: [ 0.9929336  -1.2430222   1.27635     2.538061    0.70145804]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.5077785  -0.5970689   0.06107979 -0.11417346 -0.1708531 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01801599 -0.10867948  0.19530913 -0.02623963  0.2664592 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01546205 -0.13689297  0.18389556  0.0345819   0.2606952 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00779079 -0.06376887  0.10037843  0.0175899   0.14724252]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00779079 -0.06376887  0.10037843  0.0175899   0.14724252]
  [FlaxMamba2] B (step) sample values: [-0.00718573  0.02944786  0.03759442 -0.05469862  0.05893783]
  [FlaxMamba2] C (step) sample values: [ 0.00217541  0.02197268 -0.08382475 -0.0036143  -0.05270683]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -0.37022203  -1.5044799   -5.7209826   -0.81757224 -14.66622   ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.334259   0.00184601 0.09086914 0.08559185 0.06474247]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.88360065 0.99722654 0.5946033  0.93241477 0.3869239 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00779079 -0.06376887  0.10037843  0.0175899   0.14724252]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.8712670e-05  7.6686396e-05  9.7901211e-05 -1.4244298e-04
  1.5348248e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.8712670e-05  7.6686396e-05  9.7901211e-05 -1.4244298e-04
  1.5348248e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00551881 -0.00279671 -0.00057053  0.00146322  0.00200316]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00023874 -0.00022809  0.00098134  0.00040199  0.00077687]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00015735 -0.00089427  0.00202998  0.00058575  0.00231509]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00015735 -0.00089427  0.00202998  0.00058575  0.00231509]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-1.7107623e-05 -1.7232524e-05  1.9430637e-04  6.9399073e-05
 -1.8029554e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00104488 -0.00071899  0.01308734  0.00278834 -0.0158622 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00104488 -0.00071899  0.01308734  0.00278834 -0.0158622 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.05580717  0.71784556  0.07598099 -0.39133373 -0.40721658]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.05580717  0.71784556  0.07598099 -0.39133373 -0.40721658]
  [Layer 25] Output shape after mixer: (1, 1, 2048)
  [Layer 25] Output sample values after mixer: [ 0.05580717  0.71784556  0.07598099 -0.39133373 -0.40721658]
  [Layer 25] Residual connection shape: (1, 1, 2048)
  [Layer 25] Residual connection sample values: [ 1.9492943   3.1235657  -0.60281765 -0.77386177  1.8370047 ]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.12860416  0.19068588 -0.03705223 -0.04666068  0.11851116]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12860416  0.19068588 -0.03705223 -0.04666068  0.11851116]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12860416  0.19068588 -0.03705223 -0.04666068  0.11851116]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.6179293  -0.03673495 -0.01485235 -0.13656338 -0.7683219 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.6179293  -0.03673495 -0.01485235 -0.13656338 -0.7683219 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.5639119  -0.36273304 -0.48251963 -0.01406073  0.35461858]
  [FlaxMamba2] dt (step) sample values: [1.3262231 1.018771  1.1904577 1.3196919 2.2738574]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.8974074   1.1812847   0.8584322   0.5639119  -0.68180907]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.23806113  0.15481116 -0.0837004   0.03885458 -0.0746047 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.3265621   0.09875037 -0.01955245  0.01190756 -0.06649465]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.13685478  0.05181111 -0.00968065  0.00598923 -0.03214235]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.13685478  0.05181111 -0.00968065  0.00598923 -0.03214235]
  [FlaxMamba2] B (step) sample values: [-0.06590577  0.00354811 -0.02183223  0.03446694  0.03451851]
  [FlaxMamba2] C (step) sample values: [-0.11120103  0.08909398  0.05649085  0.02228263 -0.01120669]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9594627  -0.39448437 -0.84198165 -1.4275463  -0.14661841]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.19894232 0.27763227 0.19251557 0.35404563 0.10174758]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8262336  0.8962628  0.85036075 0.60325426 0.98519266]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.13685478  0.05181111 -0.00968065  0.00598923 -0.03214235]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.7943643e-03 -9.6601449e-05  5.9440878e-04 -9.3840412e-04
 -9.3980820e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.7943643e-03 -9.6601449e-05  5.9440878e-04 -9.3840412e-04
 -9.3980820e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00289996 -0.00127069 -0.0021145   0.0002734  -0.00306537]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00784202  0.0062415   0.00217111 -0.00085467  0.0049085 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-2.5275234e-02  1.2841450e-02  9.3794242e-04 -9.1728929e-05
  8.1405370e-04]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-2.5275234e-02  1.2841450e-02  9.3794242e-04 -9.1728929e-05
  8.1405370e-04]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-1.0147955e-02 -2.3153330e-04 -6.9135999e-06  5.8363939e-06
 -1.9817064e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.13937557 -0.00706175 -0.00017943  0.00023061 -0.00683626]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.13937557 -0.00706175 -0.00017943  0.00023061 -0.00683626]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.00209476 -0.17145689 -1.3994201  -0.2292752   0.44726574]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.00209476 -0.17145689 -1.3994201  -0.2292752   0.44726574]
  [Layer 26] Output shape after mixer: (1, 1, 2048)
  [Layer 26] Output sample values after mixer: [ 0.00209476 -0.17145689 -1.3994201  -0.2292752   0.44726574]
  [Layer 26] Residual connection shape: (1, 1, 2048)
  [Layer 26] Residual connection sample values: [ 1.9513891  2.9521089 -2.0022378 -1.003137   2.2842703]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.12074331  0.16667771 -0.12128749 -0.05580477  0.14703043]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12074331  0.16667771 -0.12128749 -0.05580477  0.14703043]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12074331  0.16667771 -0.12128749 -0.05580477  0.14703043]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.62818    -0.2562102  -0.6263548  -0.03057065  1.0180296 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.62818    -0.2562102  -0.6263548  -0.03057065  1.0180296 ]
  [FlaxMamba2] xBC (step) sample values: [-0.23419484  0.32151973 -0.2837435   0.11499073 -0.22290133]
  [FlaxMamba2] dt (step) sample values: [1.3268001 1.3115104 1.109096  1.291675  1.5881076]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.2518519  -1.3849553  -0.31111884 -0.23419484  1.154055  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.08675712  0.04176913 -0.06429653  0.02765467  0.2415583 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.1127581   0.00527011 -0.07430629 -0.17424963  0.21177314]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.05320381  0.002642   -0.03577343 -0.07955323  0.11705682]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05320381  0.002642   -0.03577343 -0.07955323  0.11705682]
  [FlaxMamba2] B (step) sample values: [-0.09036147 -0.08889748 -0.0821156  -0.02542199 -0.00063308]
  [FlaxMamba2] C (step) sample values: [-0.03421337 -0.27588144 -0.07224488 -0.01762588 -0.17648634]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3661706 -1.3799144 -1.8267511 -2.0408754 -2.3490334]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.15075457 0.16446584 0.14083128 0.05958817 0.2036013 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8138685  0.7969616  0.7731643  0.88549185 0.61985713]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05320381  0.002642   -0.03577343 -0.07955323  0.11705682]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [7.2476384e-04 7.1302161e-04 6.5862603e-04 2.0390259e-04 5.0777676e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [7.2476384e-04 7.1302161e-04 6.5862603e-04 2.0390259e-04 5.0777676e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00090641  0.00276548  0.00438032 -0.00206614  0.00052621]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01098931 -0.0069903  -0.00321657 -0.02667468  0.00652681]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01637012 -0.0067231  -0.00683454 -0.03472036  0.01836544]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01637012 -0.0067231  -0.00683454 -0.03472036  0.01836544]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.00357783 0.00075153 0.00149118 0.0005226  0.01373428]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.08165234 0.01247003 0.04273066 0.01347514 0.21776249]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.08165234 0.01247003 0.04273066 0.01347514 0.21776249]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.38016278 -0.4232262  -0.6408262   0.28955048 -0.58463144]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.38016278 -0.4232262  -0.6408262   0.28955048 -0.58463144]
  [Layer 27] Output shape after mixer: (1, 1, 2048)
  [Layer 27] Output sample values after mixer: [-0.38016278 -0.4232262  -0.6408262   0.28955048 -0.58463144]
  [Layer 27] Residual connection shape: (1, 1, 2048)
  [Layer 27] Residual connection sample values: [ 1.5712264  2.5288827 -2.643064  -0.7135865  1.6996388]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.08839957  0.13312432 -0.1405657  -0.03688834  0.09464673]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.08839957  0.13312432 -0.1405657  -0.03688834  0.09464673]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.08839957  0.13312432 -0.1405657  -0.03688834  0.09464673]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.5933801   0.13518861 -0.17874603 -0.7502588  -0.6143925 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.5933801   0.13518861 -0.17874603 -0.7502588  -0.6143925 ]
  [FlaxMamba2] xBC (step) sample values: [-0.27866125 -0.21869077 -0.5852938  -0.9051875  -0.29925033]
  [FlaxMamba2] dt (step) sample values: [1.0018406  0.86533886 1.4772623  1.0500609  1.5163586 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.02071643 -1.4833286  -1.1665969  -0.27866125 -1.8382512 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.05545169  0.22895361 -0.1430133  -0.16936307  0.01810946]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.11322147  0.21759345 -0.15667754 -0.1807385   0.12278476]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.05340938  0.12058697 -0.07221434 -0.08222479  0.06515668]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05340938  0.12058697 -0.07221434 -0.08222479  0.06515668]
  [FlaxMamba2] B (step) sample values: [-0.03776166 -0.08084124 -0.05260869 -0.05395031  0.15506518]
  [FlaxMamba2] C (step) sample values: [-0.19026753 -0.12126186  0.37740955 -0.09419738  0.31006357]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2727895 -3.997792  -2.517685  -2.1714401 -2.8654757]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02748907 0.10152834 0.171368   0.04818431 0.06764801]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9656172 0.666384  0.6495661 0.9006583 0.8237866]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05340938  0.12058697 -0.07221434 -0.08222479  0.06515668]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.5440702e-05  1.1868904e-04  7.7238728e-05  7.9208454e-05
 -2.2766271e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.5440702e-05  1.1868904e-04  7.7238728e-05  7.9208454e-05
 -2.2766271e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.4001627e-05 -8.6920416e-05  3.4778968e-05  2.9770384e-04
  2.4453001e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 3.8179114e-05  6.8862881e-03 -5.5648881e-04 -2.6307623e-03
  3.2282246e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01153951  0.03302624 -0.01621058 -0.02045485  0.01735241]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01153951  0.03302624 -0.01621058 -0.02045485  0.01735241]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00243668  0.00238305  0.00131965  0.0049226  -0.0037427 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.13433689  0.08707033  0.04567693  0.19675611 -0.14511833]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.13433689  0.08707033  0.04567693  0.19675611 -0.14511833]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.45493853 -1.5126235  -1.4145977   0.8265142  -2.2326984 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.45493853 -1.5126235  -1.4145977   0.8265142  -2.2326984 ]
  [Layer 28] Output shape after mixer: (1, 1, 2048)
  [Layer 28] Output sample values after mixer: [-0.45493853 -1.5126235  -1.4145977   0.8265142  -2.2326984 ]
  [Layer 28] Residual connection shape: (1, 1, 2048)
  [Layer 28] Residual connection sample values: [ 1.1162878   1.0162592  -4.057662    0.11292768 -0.5330596 ]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05244186  0.04566162 -0.18255596  0.00489299 -0.02490012]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05244186  0.04566162 -0.18255596  0.00489299 -0.02490012]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05244186  0.04566162 -0.18255596  0.00489299 -0.02490012]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.2457376   0.24210595  0.58839387 -0.6429741   0.01310966]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.2457376   0.24210595  0.58839387 -0.6429741   0.01310966]
  [FlaxMamba2] xBC (step) sample values: [-0.6524618   0.41975227  0.62719846 -1.1346806  -0.18364559]
  [FlaxMamba2] dt (step) sample values: [1.5272202  0.1935419  0.16542298 0.5269238  0.6012663 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.21881273 -0.40778008 -1.7794938  -0.6524618  -1.4939541 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.1714609  -0.10535803 -0.12295444  0.22925006 -0.05434652]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.15805605 -0.13987342 -0.12010676  0.16882525 -0.16744468]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.08526048 -0.06505352 -0.0564513   0.09152124 -0.07672924]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.08526048 -0.06505352 -0.0564513   0.09152124 -0.07672924]
  [FlaxMamba2] B (step) sample values: [-0.05395257 -0.03143313 -0.03818225  0.04548232  0.05227456]
  [FlaxMamba2] C (step) sample values: [-0.24277881 -0.2591651  -0.12434766 -0.26881963 -0.06314779]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8072329  -2.117      -1.925669   -0.29044876 -2.049864  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.09422596 0.05967363 0.07466109 0.00266505 0.1117536 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8434217  0.88132477 0.8660847  0.9992262  0.7952652 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.08526048 -0.06505352 -0.0564513   0.09152124 -0.07672924]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00043344 -0.00025253 -0.00030675  0.00036539  0.00041996]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00043344 -0.00025253 -0.00030675  0.00036539  0.00041996]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00119789  0.00023728 -0.00087795  0.00070558  0.00066152]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00289624 -0.00476838 -0.01225591  0.01523675 -0.02077689]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.09007755 -0.07128749 -0.069979    0.10881987 -0.09923476]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.09007755 -0.07128749 -0.069979    0.10881987 -0.09923476]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02507274 -0.00966913 -0.02647552 -0.02410931 -0.00065473]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.21580306 -0.07831871 -0.3397807  -0.2775456  -0.00668691]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.21580306 -0.07831871 -0.3397807  -0.2775456  -0.00668691]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.24021691 -0.13125958 -1.1813234   0.6551671  -0.554055  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.24021691 -0.13125958 -1.1813234   0.6551671  -0.554055  ]
  [Layer 29] Output shape after mixer: (1, 1, 2048)
  [Layer 29] Output sample values after mixer: [-0.24021691 -0.13125958 -1.1813234   0.6551671  -0.554055  ]
  [Layer 29] Residual connection shape: (1, 1, 2048)
  [Layer 29] Residual connection sample values: [ 0.8760709   0.88499963 -5.2389855   0.7680948  -1.0871146 ]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03959481  0.03935618 -0.23134989  0.03198771 -0.0504854 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03959481  0.03935618 -0.23134989  0.03198771 -0.0504854 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03959481  0.03935618 -0.23134989  0.03198771 -0.0504854 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.8399954  -0.15934722 -0.9440683   0.5418051  -1.0709413 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.8399954  -0.15934722 -0.9440683   0.5418051  -1.0709413 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.9596449  -0.31650984 -0.06255568  0.9050651   0.7477373 ]
  [FlaxMamba2] dt (step) sample values: [1.3823612 1.829978  1.3649428 1.9464911 1.7947032]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [1.1604306  1.0086272  0.4020718  0.9596449  0.40173358]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.1513332  -0.04362209 -0.03022348 -0.17032987 -0.17771992]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.12804829 -0.0299197   0.00291861 -0.18847257 -0.20506367]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.06811764 -0.01473607  0.00146143 -0.085382   -0.09205575]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06811764 -0.01473607  0.00146143 -0.085382   -0.09205575]
  [FlaxMamba2] B (step) sample values: [ 0.14905983 -0.03906213 -0.02771338  0.06317501 -0.08733859]
  [FlaxMamba2] C (step) sample values: [-0.27844033 -0.25171724 -0.14341025 -0.166018   -0.24329023]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0149885  -0.4675477  -0.42799968 -0.7895216  -0.4174731 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01578056 0.52149326 0.7172098  0.33688778 0.50575614]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.98411053 0.7836263  0.73567593 0.76645434 0.80966103]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06811764 -0.01473607  0.00146143 -0.085382   -0.09205575]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.6022952e-04 -4.1989220e-05 -2.9790057e-05  6.7908979e-05
 -9.3883245e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.6022952e-04 -4.1989220e-05 -2.9790057e-05  6.7908979e-05
 -9.3883245e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 8.0648437e-04  2.2295553e-05  2.1717879e-06  1.4301551e-03
 -7.9982332e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00113038 -0.00030816 -0.00091578 -0.00058653 -0.00057757]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.08504613 -0.01846188  0.0008846  -0.10577066 -0.11398326]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.08504613 -0.01846188  0.0008846  -0.10577066 -0.11398326]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02154122  0.00135398 -0.0002339  -0.03623138  0.03115505]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.27630943  0.01762705 -0.00184866 -0.3858102   0.29483283]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.27630943  0.01762705 -0.00184866 -0.3858102   0.29483283]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.7487651   0.88845235 -3.4273775   3.4365723  -2.2537003 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.7487651   0.88845235 -3.4273775   3.4365723  -2.2537003 ]
  [Layer 30] Output shape after mixer: (1, 1, 2048)
  [Layer 30] Output sample values after mixer: [ 1.7487651   0.88845235 -3.4273775   3.4365723  -2.2537003 ]
  [Layer 30] Residual connection shape: (1, 1, 2048)
  [Layer 30] Residual connection sample values: [ 2.624836   1.773452  -8.666363   4.204667  -3.3408148]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.1035161   0.06861956 -0.33630216  0.15880033 -0.133109  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1035161   0.06861956 -0.33630216  0.15880033 -0.133109  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1035161   0.06861956 -0.33630216  0.15880033 -0.133109  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.20849548 -0.73629075 -0.31784713 -1.2847421  -0.9090481 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.20849548 -0.73629075 -0.31784713 -1.2847421  -0.9090481 ]
  [FlaxMamba2] xBC (step) sample values: [-1.1307228   0.3566156  -0.29841876  0.3375786  -0.06151031]
  [FlaxMamba2] dt (step) sample values: [ 1.0959383  0.4065581  0.3598956 -0.2166063  0.8276162]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.26194924  0.6666407  -0.7321551  -1.1307228   0.37529522]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.21234173 -0.0489741  -0.06807895 -0.04807382 -0.00679486]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.21283716 -0.05929667 -0.06706424 -0.04997163 -0.01209729]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.09513623 -0.02876957 -0.03240814 -0.02436165 -0.00601206]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09513623 -0.02876957 -0.03240814 -0.02436165 -0.00601206]
  [FlaxMamba2] B (step) sample values: [-0.11241499 -0.02700341  0.0532096  -0.16153094 -0.01403823]
  [FlaxMamba2] C (step) sample values: [ 0.02208641 -0.07084456 -0.2212724  -0.03057106 -0.07480954]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.9477868 -3.5383902 -4.705952  -2.462968  -0.9027082]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.09567375 0.03391543 0.02254988 0.04841144 0.09262378]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7542542  0.8869151  0.8993179  0.88759845 0.9197878 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09513623 -0.02876957 -0.03240814 -0.02436165 -0.00601206]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00102321  0.00024579 -0.00048432  0.00147026  0.00012778]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00102321  0.00024579 -0.00048432  0.00147026  0.00012778]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00268031  0.00080616 -0.0003864   0.00238966  0.00055749]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01032955  0.00342487 -0.00293842  0.00077768  0.0109706 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07578483 -0.01636907 -0.02523576 -0.01598353  0.00683421]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07578483 -0.01636907 -0.02523576 -0.01598353  0.00683421]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00707977  0.00390275  0.0033785   0.00445078 -0.00178423]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.11739852  0.05653466  0.04357968  0.06110688 -0.02902917]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.11739852  0.05653466  0.04357968  0.06110688 -0.02902917]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [0.02516189 1.8321434  0.35048062 0.611409   0.35619906]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [0.02516189 1.8321434  0.35048062 0.611409   0.35619906]
  [Layer 31] Output shape after mixer: (1, 1, 2048)
  [Layer 31] Output sample values after mixer: [0.02516189 1.8321434  0.35048062 0.611409   0.35619906]
  [Layer 31] Residual connection shape: (1, 1, 2048)
  [Layer 31] Residual connection sample values: [ 2.649998   3.6055956 -8.315882   4.8160763 -2.9846158]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.10127588  0.13838927 -0.31832376  0.1726716  -0.11860456]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10127588  0.13838927 -0.31832376  0.1726716  -0.11860456]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10127588  0.13838927 -0.31832376  0.1726716  -0.11860456]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.70641816 -0.7555338  -1.0059618  -1.3591315  -0.80581146]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.70641816 -0.7555338  -1.0059618  -1.3591315  -0.80581146]
  [FlaxMamba2] xBC (step) sample values: [-0.18697533 -0.12207187 -0.08743849  0.6319185   0.31997505]
  [FlaxMamba2] dt (step) sample values: [0.62096804 1.4874114  1.1315747  1.8265283  1.7347536 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.05904174 -0.19899184  0.16980265 -0.18697533  0.4397621 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03885693  0.00072101  0.07302649 -0.19067942 -0.29866576]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00168652 -0.05131146  0.05718787 -0.17819773 -0.30563903]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00084255 -0.02499766  0.02941133 -0.0811812  -0.12964582]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00084255 -0.02499766  0.02941133 -0.0811812  -0.12964582]
  [FlaxMamba2] B (step) sample values: [ 0.00090222 -0.04278178  0.01498358 -0.06595616 -0.07325358]
  [FlaxMamba2] C (step) sample values: [-0.26648784 -0.11817886  0.06044656 -0.27495947 -0.20434104]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6970906 -2.0892735 -1.7966746 -1.3893797 -1.0395182]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.14085142 0.0238617  0.3208857  0.5059844  0.6807194 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9064801  0.9513687  0.5618462  0.49509552 0.4928156 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00084255 -0.02499766  0.02941133 -0.0811812  -0.12964582]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0707000e-07  5.0771077e-06 -1.7781699e-06  7.8273169e-06
  8.6933342e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.0707000e-07  5.0771077e-06 -1.7781699e-06  7.8273169e-06
  8.6933342e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.2514013e-03  2.7074974e-03 -8.8467292e-05 -3.8691687e-03
 -1.8171758e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01810552 -0.0223457  -0.0084982  -0.03479508 -0.03327194]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01790341 -0.02834204 -0.00144313 -0.05426849 -0.06437085]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01790341 -0.02834204 -0.00144313 -0.05426849 -0.06437085]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00417855  0.00684407  0.00038873  0.01507477  0.01601685]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.03881638  0.05114291  0.00564145  0.1790663   0.15559949]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03881638  0.05114291  0.00564145  0.1790663   0.15559949]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.0744445  1.8628635 -1.1539874  2.3416386 -0.7819703]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.0744445  1.8628635 -1.1539874  2.3416386 -0.7819703]
  [Layer 32] Output shape after mixer: (1, 1, 2048)
  [Layer 32] Output sample values after mixer: [ 1.0744445  1.8628635 -1.1539874  2.3416386 -0.7819703]
  [Layer 32] Residual connection shape: (1, 1, 2048)
  [Layer 32] Residual connection sample values: [ 3.7244425  5.468459  -9.46987    7.157715  -3.766586 ]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.14627552  0.22256048 -0.3788616   0.2780567  -0.15321942]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14627552  0.22256048 -0.3788616   0.2780567  -0.15321942]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14627552  0.22256048 -0.3788616   0.2780567  -0.15321942]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.8508358   4.0607457   2.0955477  -0.12072312 -0.62644726]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.8508358   4.0607457   2.0955477  -0.12072312 -0.62644726]
  [FlaxMamba2] xBC (step) sample values: [ 0.24129574 -0.96666205  0.5068376  -1.4963305   0.608724  ]
  [FlaxMamba2] dt (step) sample values: [-0.87824535  0.9499564   0.9954172   1.6113172  -1.6688952 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.82687455  0.7821941   0.4439851   0.24129574 -1.1368337 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04598129 -0.4505766  -0.10838658 -0.29348814 -0.10569289]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03283584 -0.49995404 -0.08156163 -0.29469454 -0.10688213]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01668744 -0.1887584  -0.03911866 -0.12579182 -0.05058783]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01668744 -0.1887584  -0.03911866 -0.12579182 -0.05058783]
  [FlaxMamba2] B (step) sample values: [-0.27719718 -0.06907393 -0.041449   -0.02393584 -0.02676754]
  [FlaxMamba2] C (step) sample values: [ 0.01474707 -0.18247382 -0.09207609 -0.14321226 -0.17553793]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9790505  -9.693779   -6.1677613  -0.11351943 -2.090294  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00490158 0.02561845 0.03467234 0.04006014 0.00054174]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99034643 0.780095   0.8074689  0.9954627  0.9988682 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01668744 -0.1887584  -0.03911866 -0.12579182 -0.05058783]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.2673314e-05 -5.6498943e-06 -3.3903164e-06 -1.9578295e-06
 -2.1894480e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.2673314e-05 -5.6498943e-06 -3.3903164e-06 -1.9578295e-06
 -2.1894480e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.7144648e-05  6.5891618e-05 -7.7421486e-05 -2.0639298e-05
  5.9285117e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-2.0708943e-05 -7.3294458e-04 -2.2366627e-05 -5.2993337e-04
 -3.7576811e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01735545 -0.19728167 -0.04075551 -0.13151336 -0.05305143]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01735545 -0.19728167 -0.04075551 -0.13151336 -0.05305143]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02776072 -0.7875367  -0.07605066  0.00745976  0.01157593]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.34913176 -5.902835   -0.71826696  0.06881163  0.12084816]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.34913176 -5.902835   -0.71826696  0.06881163  0.12084816]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.7545865  -0.5026243   1.2313936  -2.62994    -0.22110832]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.7545865  -0.5026243   1.2313936  -2.62994    -0.22110832]
  [Layer 33] Output shape after mixer: (1, 1, 2048)
  [Layer 33] Output sample values after mixer: [ 2.7545865  -0.5026243   1.2313936  -2.62994    -0.22110832]
  [Layer 33] Residual connection shape: (1, 1, 2048)
  [Layer 33] Residual connection sample values: [ 6.4790287  4.9658346 -8.238476   4.527775  -3.9876943]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.18061125  0.14667511 -0.22951254  0.12725735 -0.11658636]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18061125  0.14667511 -0.22951254  0.12725735 -0.11658636]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18061125  0.14667511 -0.22951254  0.12725735 -0.11658636]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.67658347  0.5828287   0.6725104  -0.12551734  0.39863682]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.67658347  0.5828287   0.6725104  -0.12551734  0.39863682]
  [FlaxMamba2] xBC (step) sample values: [ 0.51194197 -0.57450795  0.34147128 -0.46362248 -0.47868642]
  [FlaxMamba2] dt (step) sample values: [ 1.213057    0.71613574  2.1978815  -0.19349253 -0.02990381]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.66166776  0.25822285 -0.770059    0.51194197 -0.19410421]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.09181008  0.12223584  0.06729244  0.11995572 -0.09748377]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.12370095  0.14826733  0.05535244  0.08043545 -0.10602106]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.05802986  0.07961942  0.028442    0.04183432 -0.05020304]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05802986  0.07961942  0.028442    0.04183432 -0.05020304]
  [FlaxMamba2] B (step) sample values: [-0.2070746   0.03065629 -0.00060201  0.05156108 -0.02929038]
  [FlaxMamba2] C (step) sample values: [-0.00187229 -0.23456068 -0.2579694  -0.12606327 -0.2659889 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.5610816  -2.4810736  -2.893596   -0.01585086 -0.02613366]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.16583113 0.0652976  0.08149565 0.01186921 0.00726879]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6539613  0.8504343  0.7899264  0.9998119  0.99981004]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05802986  0.07961942  0.028442    0.04183432 -0.05020304]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.9927116e-03 -2.9501034e-04  5.7932066e-06 -4.9618038e-04
  2.8186594e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.9927116e-03 -2.9501034e-04  5.7932066e-06 -4.9618038e-04
  2.8186594e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00036608  0.00044944  0.00072852  0.00055177 -0.00016127]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00059965  0.00457597  0.0007792   0.00533721 -0.00177889]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03514345  0.05361701  0.01829786  0.03110477 -0.03270111]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03514345  0.05361701  0.01829786  0.03110477 -0.03270111]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01576389  0.02005339  0.00814704 -0.00182974 -0.00780014]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.4045294   0.5004653   0.23245685 -0.05870461 -0.2376843 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.4045294   0.5004653   0.23245685 -0.05870461 -0.2376843 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.6159661e+00  2.5553684e+00 -1.6755451e+00  6.6686141e-01
 -1.6360771e-03]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.6159661e+00  2.5553684e+00 -1.6755451e+00  6.6686141e-01
 -1.6360771e-03]
  [Layer 34] Output shape after mixer: (1, 1, 2048)
  [Layer 34] Output sample values after mixer: [ 1.6159661e+00  2.5553684e+00 -1.6755451e+00  6.6686141e-01
 -1.6360771e-03]
  [Layer 34] Residual connection shape: (1, 1, 2048)
  [Layer 34] Residual connection sample values: [ 8.094995   7.521203  -9.914021   5.1946363 -3.9893303]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.23604919  0.21890329 -0.28390506  0.13953155 -0.11512012]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.23604919  0.21890329 -0.28390506  0.13953155 -0.11512012]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.23604919  0.21890329 -0.28390506  0.13953155 -0.11512012]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.2381998  -0.6078031   0.12324532 -1.5464809   0.1043774 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.2381998  -0.6078031   0.12324532 -1.5464809   0.1043774 ]
  [FlaxMamba2] xBC (step) sample values: [-0.8679777   1.2172838   0.63992107 -0.38209105  0.41696504]
  [FlaxMamba2] dt (step) sample values: [ 1.5355139  -0.22945765  0.7667075   0.6425541   0.0259445 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.04688474  0.8682969   0.96487004 -0.8679777   0.45092207]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.1546049  -0.2918495  -0.12226223 -0.10006049  0.06864049]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00140096 -0.2507118  -0.15845609 -0.14501289  0.0271671 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00069999 -0.10972359 -0.07296406 -0.06725845  0.01376805]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00069999 -0.10972359 -0.07296406 -0.06725845  0.01376805]
  [FlaxMamba2] B (step) sample values: [ 0.04295964  0.30689108 -0.2782643   0.10719863  0.03215535]
  [FlaxMamba2] C (step) sample values: [-0.23173214  0.23997195 -0.10087449 -0.27190387 -0.10590711]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.709799  -2.7746034 -0.4452666 -1.139112  -3.5906036]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04155864 0.01353281 0.31329018 0.12302471 0.02656941]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.97093254 0.963148   0.8697951  0.8692375  0.90900904]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00069999 -0.10972359 -0.07296406 -0.06725845  0.01376805]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.2497239e-06 -8.9276618e-06  8.0948912e-06 -3.1184782e-06
 -9.3542002e-07]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.2497239e-06 -8.9276618e-06  8.0948912e-06 -3.1184782e-06
 -9.3542002e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0039875  -0.01456038  0.02410757 -0.02069927  0.00021656]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02176131 -0.02198259 -0.02128934 -0.03111186 -0.00791289]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02223474 -0.09619178 -0.07063702 -0.07660067  0.00139884]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02223474 -0.09619178 -0.07063702 -0.07660067  0.00139884]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 6.1875889e-03  2.0612681e-02 -4.6207355e-03  2.0801257e-02
  7.6810211e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.15316904  0.2714524  -0.04299616  0.22373734  0.00110933]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.15316904  0.2714524  -0.04299616  0.22373734  0.00110933]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.03310352  0.42597967  4.6874886   4.8888326  -5.282108  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.03310352  0.42597967  4.6874886   4.8888326  -5.282108  ]
  [Layer 35] Output shape after mixer: (1, 1, 2048)
  [Layer 35] Output sample values after mixer: [-0.03310352  0.42597967  4.6874886   4.8888326  -5.282108  ]
  [Layer 35] Residual connection shape: (1, 1, 2048)
  [Layer 35] Residual connection sample values: [ 8.061891   7.9471827 -5.226532  10.083469  -9.271439 ]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.18208686  0.18172859 -0.11722487  0.2246872  -0.21440658]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18208686  0.18172859 -0.11722487  0.2246872  -0.21440658]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18208686  0.18172859 -0.11722487  0.2246872  -0.21440658]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.8352787   0.35058826 -1.11636    -1.4677677  -0.39316225]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.8352787   0.35058826 -1.11636    -1.4677677  -0.39316225]
  [FlaxMamba2] xBC (step) sample values: [ 0.04255656  1.3037248  -0.36226046 -0.05600523  0.1965583 ]
  [FlaxMamba2] dt (step) sample values: [ 0.50586736  1.3390976  -0.28664652  0.40427867  0.99910235]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.4720742   0.03408239  0.22343971  0.04255656  0.5465798 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.0183244   0.23638861 -0.01674832 -0.00863614 -0.01833452]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.05451825  0.23625486 -0.04523648 -0.033569   -0.04619707]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02651625  0.13201697 -0.02210674 -0.01650281 -0.02256509]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02651625  0.13201697 -0.02210674 -0.01650281 -0.02256509]
  [FlaxMamba2] B (step) sample values: [ 0.12528017  0.33241412 -0.04767542  0.03438169 -0.01769394]
  [FlaxMamba2] C (step) sample values: [ 0.1973243  -0.2501494  -0.16754879 -0.14591289 -0.25254235]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6566098 -1.1305923 -1.6058172 -2.4414158 -2.882315 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06980494 0.01398923 0.01622919 0.05436211 0.10763331]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.83073497 0.9843083  0.9742755  0.87570983 0.733276  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02651625  0.13201697 -0.02210674 -0.01650281 -0.02256509]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.3188924e-04 -6.1528699e-04  8.8245542e-05 -6.3639316e-05
  3.2750864e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.3188924e-04 -6.1528699e-04  8.8245542e-05 -6.3639316e-05
  3.2750864e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00080227 -0.0023944  -0.00022491  0.00031337  0.00011356]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00198875  0.01236123  0.00189024 -0.00081268  0.00437802]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03237072  0.16362454 -0.02343937 -0.01972139 -0.02147677]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03237072  0.16362454 -0.02343937 -0.01972139 -0.02147677]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.00817998 0.03365941 0.00645501 0.00542115 0.0034025 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.13551258 0.81343436 0.10537177 0.09960166 0.05411844]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.13551258 0.81343436 0.10537177 0.09960166 0.05411844]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.0698847 -5.4777265 -3.361298  -7.5937214 -1.7813483]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.0698847 -5.4777265 -3.361298  -7.5937214 -1.7813483]
  [Layer 36] Output shape after mixer: (1, 1, 2048)
  [Layer 36] Output sample values after mixer: [ 1.0698847 -5.4777265 -3.361298  -7.5937214 -1.7813483]
  [Layer 36] Residual connection shape: (1, 1, 2048)
  [Layer 36] Residual connection sample values: [  9.131775    2.4694562  -8.58783     2.489748  -11.052787 ]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.20189339  0.05585902 -0.18759157  0.0532547  -0.2462478 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.20189339  0.05585902 -0.18759157  0.0532547  -0.2462478 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.20189339  0.05585902 -0.18759157  0.0532547  -0.2462478 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.08625665  1.061217   -0.02345936 -4.1206174   0.7103481 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.08625665  1.061217   -0.02345936 -4.1206174   0.7103481 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.2273136  0.823326   0.8962155  0.7070891 -1.1056734]
  [FlaxMamba2] dt (step) sample values: [ 2.3691716  -0.71895045 -0.65596485  1.8336865  -1.1352835 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6521405  -0.252069    0.45179865  0.2273136  -0.22544284]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.03186413 -0.11340779  0.09218094  0.36714795 -0.20112565]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04424664 -0.14185017  0.09718201  0.21626905 -0.18638566]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02163396 -0.06590314  0.05095023  0.11978223 -0.08453298]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02163396 -0.06590314  0.05095023  0.11978223 -0.08453298]
  [FlaxMamba2] B (step) sample values: [ 0.10318492  0.09415923 -0.1657644  -0.01548108 -0.08049437]
  [FlaxMamba2] C (step) sample values: [-0.20166905 -0.10000332 -0.22012608 -0.25520912 -0.2691421 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.06064401 -3.2470093  -0.81907064 -0.24529998 -1.975189  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0960121  0.00476559 0.00488069 0.00779861 0.00376323]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9941944  0.9846452  0.99601036 0.99808884 0.9925945 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02163396 -0.06590314  0.05095023  0.11978223 -0.08453298]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.1432762e-04 -1.9558017e-04  3.4431281e-04  3.2156084e-05
  1.6719660e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.1432762e-04 -1.9558017e-04  3.4431281e-04  3.2156084e-05
  1.6719660e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-9.3493308e-04 -1.1025016e-03 -6.0986186e-04  1.3309993e-03
 -9.0963222e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00142802 -0.00565949  0.00049527  0.03633617  0.02056825]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00268894  0.00688194 -0.00920061  0.01354149  0.03665496]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00268894  0.00688194 -0.00920061  0.01354149  0.03665496]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00012097  0.00542574  0.00010665 -0.0008914   0.01745776]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00116301  0.04734473  0.00183408 -0.02831868  0.1239563 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00116301  0.04734473  0.00183408 -0.02831868  0.1239563 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 5.208303    2.1047218  -7.034652    0.49835888 -3.5286906 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 5.208303    2.1047218  -7.034652    0.49835888 -3.5286906 ]
  [Layer 37] Output shape after mixer: (1, 1, 2048)
  [Layer 37] Output sample values after mixer: [ 5.208303    2.1047218  -7.034652    0.49835888 -3.5286906 ]
  [Layer 37] Residual connection shape: (1, 1, 2048)
  [Layer 37] Residual connection sample values: [ 14.340078    4.5741777 -15.622482    2.988107  -14.581477 ]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.25640878  0.08117279 -0.27591947  0.05149213 -0.25753358]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.25640878  0.08117279 -0.27591947  0.05149213 -0.25753358]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.25640878  0.08117279 -0.27591947  0.05149213 -0.25753358]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.50944704 -0.71509814 -0.765414   -0.36718664 -1.0991855 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.50944704 -0.71509814 -0.765414   -0.36718664 -1.0991855 ]
  [FlaxMamba2] xBC (step) sample values: [0.47133467 1.1070267  1.1654241  1.2715482  0.710059  ]
  [FlaxMamba2] dt (step) sample values: [1.047007   0.65559894 2.3129697  1.5041984  1.1871603 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.7721357   0.8204461  -0.35418734  0.47133467  0.47873154]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.06990866 -0.21002646 -0.2432346  -0.22336796  0.13447545]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04181723 -0.24719687 -0.2690067  -0.23497227  0.11321996]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02047151 -0.10839918 -0.11652052 -0.1037463   0.05981125]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02047151 -0.10839918 -0.11652052 -0.1037463   0.05981125]
  [FlaxMamba2] B (step) sample values: [-0.24037477 -0.27818823  0.04271113  0.03927545 -0.27489132]
  [FlaxMamba2] C (step) sample values: [-0.05617031 -0.2707352  -0.13132018  0.24097106 -0.2748228 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0881431 -1.3535548 -1.1764196 -1.6451025 -1.1940706]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.14139946 0.0569712  1.0463879  0.17692126 0.07342466]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.85738957 0.92578465 0.29200298 0.7474756  0.91605926]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02047151 -0.10839918 -0.11652052 -0.1037463   0.05981125]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0006958   0.00080526 -0.00012363 -0.00011369  0.00079572]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0006958   0.00080526 -0.00012363 -0.00011369  0.00079572]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00692872 0.00902959 0.00125034 0.00074486 0.00872881]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00666492 -0.01614511 -0.00944865  0.01059563  0.00692342]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02324323 -0.10392934 -0.10380974 -0.0734206   0.05536   ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02324323 -0.10392934 -0.10380974 -0.0734206   0.05536   ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00444428  0.02441203  0.02522551  0.01103221 -0.01520619]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.11165152  0.5931893   0.6430303   0.2565468  -0.3180993 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.11165152  0.5931893   0.6430303   0.2565468  -0.3180993 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [  2.2422361 -10.382516   -1.5054706  -5.35003    -5.625542 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [  2.2422361 -10.382516   -1.5054706  -5.35003    -5.625542 ]
  [Layer 38] Output shape after mixer: (1, 1, 2048)
  [Layer 38] Output sample values after mixer: [  2.2422361 -10.382516   -1.5054706  -5.35003    -5.625542 ]
  [Layer 38] Residual connection shape: (1, 1, 2048)
  [Layer 38] Residual connection sample values: [ 16.582314  -5.808338 -17.127953  -2.361923 -20.20702 ]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.21761413 -0.07700807 -0.2251396  -0.03109678 -0.26833904]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.21761413 -0.07700807 -0.2251396  -0.03109678 -0.26833904]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.21761413 -0.07700807 -0.2251396  -0.03109678 -0.26833904]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.88491714  0.51553416 -0.1668347   0.43377075  0.3528559 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.88491714  0.51553416 -0.1668347   0.43377075  0.3528559 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.5400192   0.21959762  0.5276375  -0.9052339  -0.7406772 ]
  [FlaxMamba2] dt (step) sample values: [ 1.186485    1.9203082  -0.30672073  1.1737827   0.8142964 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.03167162 -0.19632643  0.79485327  1.5400192  -1.564645  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.23819076 -0.03502353  0.11222688 -0.22356507 -0.1286869 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.22385512  0.05018155  0.08988801 -0.21948716 -0.14966774]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.12440328  0.02572019  0.04696261 -0.09774804 -0.0692442 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.12440328  0.02572019  0.04696261 -0.09774804 -0.0692442 ]
  [FlaxMamba2] B (step) sample values: [-0.07546759 -0.01418331  0.06941261 -0.07508685  0.06894927]
  [FlaxMamba2] C (step) sample values: [ 0.17094564 -0.06112674 -0.1222233  -0.13743535 -0.14778624]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.69420344 -0.9242845  -1.3151171  -3.1532621  -2.1087465 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01577173 0.05039773 0.00654702 0.08599162 0.0571069 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.98911095 0.9544864  0.9914269  0.762499   0.88654447]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.12440328  0.02572019  0.04696261 -0.09774804 -0.0692442 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.4807159e-04 -2.7828450e-05  1.3619139e-04 -1.4732455e-04
  1.3528229e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.4807159e-04 -2.7828450e-05  1.3619139e-04 -1.4732455e-04
  1.3528229e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00035238 -0.00015156  0.00024126 -0.00031763  0.00044315]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00046139  0.0014329   0.00032941 -0.00159113  0.00158842]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.10705721  0.02347143  0.04056965 -0.08534723 -0.05774396]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.10705721  0.02347143  0.04056965 -0.08534723 -0.05774396]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.06705848  0.00757605 -0.00310256 -0.02246345 -0.01196661]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 2.2878673   0.2776569  -0.11623361 -0.6804902  -0.41335577]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 2.2878673   0.2776569  -0.11623361 -0.6804902  -0.41335577]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-3.4482      1.1391989  -2.002076    0.84245235 -2.680297  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-3.4482      1.1391989  -2.002076    0.84245235 -2.680297  ]
  [Layer 39] Output shape after mixer: (1, 1, 2048)
  [Layer 39] Output sample values after mixer: [-3.4482      1.1391989  -2.002076    0.84245235 -2.680297  ]
  [Layer 39] Residual connection shape: (1, 1, 2048)
  [Layer 39] Residual connection sample values: [ 13.134113   -4.6691394 -19.130028   -1.5194707 -22.887318 ]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.14676023 -0.05258112 -0.22116649 -0.01713987 -0.25502753]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14676023 -0.05258112 -0.22116649 -0.01713987 -0.25502753]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14676023 -0.05258112 -0.22116649 -0.01713987 -0.25502753]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.43784642 -0.6115422  -0.4215475  -0.38817108 -0.59879726]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.43784642 -0.6115422  -0.4215475  -0.38817108 -0.59879726]
  [FlaxMamba2] xBC (step) sample values: [ 0.84650826 -0.2876327  -0.6515347   0.18631594 -0.4697469 ]
  [FlaxMamba2] dt (step) sample values: [1.8675678  1.0565667  1.7143154  0.54706544 1.1895934 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.02948296 -0.16612352  0.03213707  0.84650826 -0.02222425]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.17086305  0.01639611 -0.12812316 -0.03313008 -0.11499606]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.15520753 -0.00223487 -0.12236679 -0.04300252 -0.11976062]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.08361405 -0.00111619 -0.05744465 -0.02103902 -0.05629894]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.08361405 -0.00111619 -0.05744465 -0.02103902 -0.05629894]
  [FlaxMamba2] B (step) sample values: [-0.16725142  0.15650943 -0.04609868 -0.06441551  0.07946403]
  [FlaxMamba2] C (step) sample values: [ 0.00897537  0.06327576 -0.02531175  0.07607844 -0.12789106]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9809841  -1.4352343  -0.79658854 -1.6062093  -1.8464803 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.3224051  0.03840483 0.02500108 0.06292499 0.18235543]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.5279892  0.9463717  0.9802814  0.90386915 0.7141118 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.08361405 -0.00111619 -0.05744465 -0.02103902 -0.05629894]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0045087   0.00421912 -0.00124271 -0.00173649  0.00214216]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0045087   0.00421912 -0.00124271 -0.00173649  0.00214216]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00436042  0.00472894 -0.0010018  -0.00171963  0.00231845]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01049535 -0.00042887 -0.00669405 -0.00305297 -0.00980337]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.07878128 -0.00134044 -0.05360795 -0.02023512 -0.05578159]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.07878128 -0.00134044 -0.05360795 -0.02023512 -0.05578159]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01353046  0.00028831  0.00895224  0.00317453  0.01184493]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.64353794  0.01379441  0.42176095  0.17721698  0.5560796 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.64353794  0.01379441  0.42176095  0.17721698  0.5560796 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.003642    0.59163994 -6.342777   -2.8142571  -1.7545866 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.003642    0.59163994 -6.342777   -2.8142571  -1.7545866 ]
  [Layer 40] Output shape after mixer: (1, 1, 2048)
  [Layer 40] Output sample values after mixer: [ 3.003642    0.59163994 -6.342777   -2.8142571  -1.7545866 ]
  [Layer 40] Residual connection shape: (1, 1, 2048)
  [Layer 40] Residual connection sample values: [ 16.137756   -4.0774994 -25.472805   -4.333728  -24.641905 ]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.16859782 -0.04294907 -0.27180573 -0.04527625 -0.25871235]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.16859782 -0.04294907 -0.27180573 -0.04527625 -0.25871235]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.16859782 -0.04294907 -0.27180573 -0.04527625 -0.25871235]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.65684867  2.4248757  -0.72701776 -0.10121958 -0.46808872]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.65684867  2.4248757  -0.72701776 -0.10121958 -0.46808872]
  [FlaxMamba2] xBC (step) sample values: [-0.26111516 -1.1826257   0.9859603   0.00279788  0.6041258 ]
  [FlaxMamba2] dt (step) sample values: [ 0.10151     1.0041698   1.806383    0.86038566 -0.4574097 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.3270118   0.79864335  0.17966998 -0.26111516  0.278807  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.03277888 -0.1776161   0.19407591  0.01162865  0.17665948]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01942744 -0.19161604  0.196174    0.00489189  0.16107263]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00980807 -0.08665682  0.10767733  0.00245193  0.08700842]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00980807 -0.08665682  0.10767733  0.00245193  0.08700842]
  [FlaxMamba2] B (step) sample values: [ 0.02104353 -0.06798156 -0.12140614 -0.25104305 -0.00269851]
  [FlaxMamba2] C (step) sample values: [-0.0768399  -0.04472448 -0.12324628 -0.09989651 -0.26603994]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8258594 -1.8636904 -1.2829287 -1.4542811 -4.4079003]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04122524 0.08347802 0.0430705  0.09503376 0.00404524]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.92749166 0.85592103 0.9462425  0.87091947 0.98232704]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00980807 -0.08665682  0.10767733  0.00245193  0.08700842]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.5087440e-06 -2.7487677e-05 -4.9089376e-05 -1.0150679e-04
 -1.0911142e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.5087440e-06 -2.7487677e-05 -4.9089376e-05 -1.0150679e-04
 -1.0911142e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00050582  0.00065119 -0.00018389  0.00356755 -0.00412146]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00145578  0.00122261 -0.00287858 -0.00067536  0.00131052]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01101554 -0.08324029  0.10207264  0.0017145   0.08611611]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01101554 -0.08324029  0.10207264  0.0017145   0.08611611]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 4.7649806e-03 -1.8543813e-01 -2.4180843e-02 -8.2382569e-05
 -1.5522113e-02]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 2.3271081e-01 -9.0512648e+00 -1.1616104e+00 -4.1573383e-03
 -6.1047304e-01]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 2.3271081e-01 -9.0512648e+00 -1.1616104e+00 -4.1573383e-03
 -6.1047304e-01]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.69743586 -0.22966896  2.6988513  -1.8997872   4.3440037 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.69743586 -0.22966896  2.6988513  -1.8997872   4.3440037 ]
  [Layer 41] Output shape after mixer: (1, 1, 2048)
  [Layer 41] Output sample values after mixer: [ 0.69743586 -0.22966896  2.6988513  -1.8997872   4.3440037 ]
  [Layer 41] Residual connection shape: (1, 1, 2048)
  [Layer 41] Residual connection sample values: [ 16.835192   -4.3071685 -22.773954   -6.233515  -20.297901 ]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.1727475  -0.04506063 -0.2360911  -0.06350181 -0.20731394]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1727475  -0.04506063 -0.2360911  -0.06350181 -0.20731394]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1727475  -0.04506063 -0.2360911  -0.06350181 -0.20731394]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.543092   -1.173949   -0.9943789  -1.2556752  -0.09877612]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.543092   -1.173949   -0.9943789  -1.2556752  -0.09877612]
  [FlaxMamba2] xBC (step) sample values: [ 1.3847492   0.6303705  -0.0501625  -0.02713851 -0.17192006]
  [FlaxMamba2] dt (step) sample values: [ 0.07995077  3.0358179   0.7682623  -0.16092461 -0.18076153]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.08567549 -0.26236737  0.33231723  1.3847492   0.4672822 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.21504132 -0.10042807 -0.02308312 -0.01031366 -0.03187934]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.20571057 -0.11364218 -0.01303521 -0.00678697 -0.05182258]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.11339735 -0.05359592 -0.00647512 -0.00338197 -0.02524005]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.11339735 -0.05359592 -0.00647512 -0.00338197 -0.02524005]
  [FlaxMamba2] B (step) sample values: [-0.06062894 -0.18937646 -0.11385393  0.35127708  0.33173424]
  [FlaxMamba2] C (step) sample values: [ 0.14859524 -0.03942188  0.10771898  0.24952033 -0.2762459 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.06612   -1.4514434 -0.7269863 -1.9455162 -0.6256312]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02310831 1.5329422  0.00742117 0.02309367 0.00944707]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.97566473 0.1080697  0.9946194  0.95606524 0.99410707]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.11339735 -0.05359592 -0.00647512 -0.00338197 -0.02524005]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00015887 -0.00049625 -0.00029835  0.00092049  0.00086928]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00015887 -0.00049625 -0.00029835  0.00092049  0.00086928]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00044616 -0.00051876 -0.00041064  0.00144776  0.00069955]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00091061 -0.00029706 -0.00100696  0.00061091 -0.00039954]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.11470252 -0.05407947 -0.00750461 -0.00278282 -0.0257274 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.11470252 -0.05407947 -0.00750461 -0.00278282 -0.0257274 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02289109  0.01499183  0.00201521  0.00077476  0.00120792]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-1.1988814   0.7718633   0.10554333  0.03358459  0.05742509]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-1.1988814   0.7718633   0.10554333  0.03358459  0.05742509]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-3.3860335  9.819732   2.0461774 -2.7276156  2.2025847]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-3.3860335  9.819732   2.0461774 -2.7276156  2.2025847]
  [Layer 42] Output shape after mixer: (1, 1, 2048)
  [Layer 42] Output sample values after mixer: [-3.3860335  9.819732   2.0461774 -2.7276156  2.2025847]
  [Layer 42] Residual connection shape: (1, 1, 2048)
  [Layer 42] Residual connection sample values: [ 13.449158   5.512563 -20.727777  -8.96113  -18.095316]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.12807241  0.05504202 -0.197996   -0.08678805 -0.17089306]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12807241  0.05504202 -0.197996   -0.08678805 -0.17089306]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.12807241  0.05504202 -0.197996   -0.08678805 -0.17089306]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-5.1884484e-01 -1.0425816e+00 -1.0342054e+00 -5.7445036e-04
  2.5692692e-01]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-5.1884484e-01 -1.0425816e+00 -1.0342054e+00 -5.7445036e-04
  2.5692692e-01]
  [FlaxMamba2] xBC (step) sample values: [-0.28933084 -0.09350564 -0.26776543  0.6841031  -1.0252515 ]
  [FlaxMamba2] dt (step) sample values: [0.7361878  0.28034285 2.8295565  2.7732973  0.9008806 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.9579304   0.78150445  0.9246726  -0.28933084  0.03600967]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01841855 -0.07020795 -0.02837804 -0.12015597  0.166129  ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02198911 -0.11589276 -0.01590398 -0.11425463  0.15730941]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01087368 -0.05459235 -0.00788875 -0.05386733  0.08482854]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01087368 -0.05459235 -0.00788875 -0.05386733  0.08482854]
  [FlaxMamba2] B (step) sample values: [-0.06022155  0.01081536  0.8849819   0.01830215 -0.00268582]
  [FlaxMamba2] C (step) sample values: [-0.20459665 -0.0405826  -0.2773331   0.01773006 -0.12352259]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9761645 -1.478265  -1.0588893 -1.0815219 -5.9141264]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00843097 0.01966871 0.12992513 0.10514729 0.12698643]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99180377 0.97134304 0.8714678  0.8925086  0.4718879 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01087368 -0.05459235 -0.00788875 -0.05386733  0.08482854]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.5208516e-06 -9.9150520e-07 -8.1131322e-05 -1.6778621e-06
  2.4622486e-07]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.5208516e-06 -9.9150520e-07 -8.1131322e-05 -1.6778621e-06
  2.4622486e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00025521 -0.00143888  0.01121884  0.00022012  0.00010052]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-2.7510125e-05 -3.8415092e-04 -1.2553902e-04  7.3137874e-04
 -1.3088938e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00946985 -0.04779034 -0.00697587 -0.04604523  0.0735314 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00946985 -0.04779034 -0.00697587 -0.04604523  0.0735314 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [1.83329347e-03 1.29870810e-02 1.89214002e-03 1.32215491e-05
 1.06529435e-02]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.1296788  0.7046593  0.0963598  0.00074236 0.68981385]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.1296788  0.7046593  0.0963598  0.00074236 0.68981385]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [  2.4439654   1.6089967   4.2123547  -4.420803  -12.417671 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [  2.4439654   1.6089967   4.2123547  -4.420803  -12.417671 ]
  [Layer 43] Output shape after mixer: (1, 1, 2048)
  [Layer 43] Output sample values after mixer: [  2.4439654   1.6089967   4.2123547  -4.420803  -12.417671 ]
  [Layer 43] Residual connection shape: (1, 1, 2048)
  [Layer 43] Residual connection sample values: [ 15.893124   7.12156  -16.515423 -13.381933 -30.512987]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.1408515   0.06560732 -0.14773591 -0.11797986 -0.27013773]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1408515   0.06560732 -0.14773591 -0.11797986 -0.27013773]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1408515   0.06560732 -0.14773591 -0.11797986 -0.27013773]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.06202843 -2.6219409  -1.4493084  -0.05887424 -1.0573844 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.06202843 -2.6219409  -1.4493084  -0.05887424 -1.0573844 ]
  [FlaxMamba2] xBC (step) sample values: [-0.6839967   0.9485096  -0.48306507 -1.8760031   0.3305939 ]
  [FlaxMamba2] dt (step) sample values: [0.1768484  1.0524304  0.21169068 0.11871826 1.6994077 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.94895405 -0.74250704 -0.70534456 -0.6839967   1.2354441 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.1253119  -0.12018765 -0.06944758 -0.34825718 -0.03500849]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.13141923 -0.05976284 -0.08791071 -0.35480702 -0.08749872]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06139807 -0.02898879 -0.04202453 -0.14625756 -0.04183657]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06139807 -0.02898879 -0.04202453 -0.14625756 -0.04183657]
  [FlaxMamba2] B (step) sample values: [-0.2774964   0.03243831  0.150538    0.00095943  0.05194979]
  [FlaxMamba2] C (step) sample values: [-0.2774747  -0.03859259  0.01872466  0.00622432 -0.0634043 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.74823433 -0.64391696 -1.1771379  -1.350584   -1.0269372 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02607536 0.04257731 0.01374095 0.01110764 0.1879757 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9806786  0.9729562  0.98395514 0.98511016 0.8244496 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06139807 -0.02898879 -0.04202453 -0.14625756 -0.04183657]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.4426526e-04 -5.1932973e-05 -2.4100783e-04 -1.5360317e-06
 -8.3170402e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.4426526e-04 -5.1932973e-05 -2.4100783e-04 -1.5360317e-06
 -8.3170402e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00624974 -0.00152578 -0.00085619 -0.00018569 -0.00145278]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00156341 -0.00024348 -0.00021153 -0.00250316  0.00099301]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05923869 -0.02747458 -0.03968796 -0.1398926  -0.03830686]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05923869 -0.02747458 -0.03968796 -0.1398926  -0.03830686]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.00178028 0.00487974 0.01093503 0.00399685 0.0104426 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.09666728 0.21155562 0.6397694  0.2028214  0.57652193]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.09666728 0.21155562 0.6397694  0.2028214  0.57652193]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.8844004  7.2130113  9.467898  10.768599  -2.1720812]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.8844004  7.2130113  9.467898  10.768599  -2.1720812]
  [Layer 44] Output shape after mixer: (1, 1, 2048)
  [Layer 44] Output sample values after mixer: [-2.8844004  7.2130113  9.467898  10.768599  -2.1720812]
  [Layer 44] Residual connection shape: (1, 1, 2048)
  [Layer 44] Residual connection sample values: [ 13.008723   14.334572   -7.0475245  -2.6133347 -32.68507  ]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.11120275  0.12590395 -0.06048978 -0.02197583 -0.2779806 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11120275  0.12590395 -0.06048978 -0.02197583 -0.2779806 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11120275  0.12590395 -0.06048978 -0.02197583 -0.2779806 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.71909344  0.91022706  0.55714    -0.5244223  -1.0145235 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.71909344  0.91022706  0.55714    -0.5244223  -1.0145235 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.170957    0.17410518  0.46671474  0.39458004 -1.0843278 ]
  [FlaxMamba2] dt (step) sample values: [ 1.3726037   0.94476545  0.59013146  0.33328205 -0.22438464]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.22580063  0.03926632  0.5000783   1.170957    0.38722134]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.18102667 -0.0300074   0.06441988  0.0630793   0.2477034 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [0.17644903 0.02220818 0.06196894 0.05649514 0.24520096]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [0.09598794 0.01122739 0.0319442  0.02904528 0.1375565 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [0.09598794 0.01122739 0.0319442  0.02904528 0.1375565 ]
  [FlaxMamba2] B (step) sample values: [ 0.04465805  0.05353705  0.09555856 -0.2478967   0.04331109]
  [FlaxMamba2] C (step) sample values: [-0.02640082 -0.23331724 -0.02390317 -0.25298193 -0.10584368]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.250236  -4.181475  -1.0937363 -2.677446  -2.3148744]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0281227  0.05708524 0.03477191 0.01755014 0.00443597]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.938678  0.7876507 0.9626828 0.9540974 0.9897838]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [0.09598794 0.01122739 0.0319442  0.02904528 0.1375565 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00012055  0.00014452  0.00025795 -0.00066918  0.00011692]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00012055  0.00014452  0.00025795 -0.00066918  0.00011692]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.2867086e-03  3.1279422e-05  3.1257392e-04 -4.2853929e-04
  2.7455459e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00053046  0.00041541 -0.0041619  -0.00244035  0.02550728]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [0.1082131  0.01301068 0.03167422 0.03014367 0.179823  ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [0.1082131  0.01301068 0.03167422 0.03014367 0.179823  ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.05232361  0.00844438  0.01121978 -0.00587771 -0.04854504]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 3.1039221  0.3632507  0.6116403 -0.2933303 -2.59829  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 3.1039221  0.3632507  0.6116403 -0.2933303 -2.59829  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [  1.1217005   14.580474   -11.108429    14.747561    -0.60304433]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [  1.1217005   14.580474   -11.108429    14.747561    -0.60304433]
  [Layer 45] Output shape after mixer: (1, 1, 2048)
  [Layer 45] Output sample values after mixer: [  1.1217005   14.580474   -11.108429    14.747561    -0.60304433]
  [Layer 45] Residual connection shape: (1, 1, 2048)
  [Layer 45] Residual connection sample values: [ 14.130424  28.915047 -18.155952  12.134227 -33.288113]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13662021  0.2913815  -0.17880557  0.11860918 -0.3196701 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13662021  0.2913815  -0.17880557  0.11860918 -0.3196701 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13662021  0.2913815  -0.17880557  0.11860918 -0.3196701 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.5435272   0.4922056   0.09281684 -1.7475471  -1.1121597 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.5435272   0.4922056   0.09281684 -1.7475471  -1.1121597 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.24076298  0.42401862 -0.40171534  0.33692083 -1.4697926 ]
  [FlaxMamba2] dt (step) sample values: [2.8565838  1.5089704  1.0396509  0.40257427 0.89189   ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.19496793 0.28203216 0.87103164 0.24076298 0.07607359]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.06528641  0.06420766 -0.06614446 -0.06733801  0.24002753]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.068424    0.06040822 -0.08724736 -0.08317664  0.260337  ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.033042    0.03111612 -0.04172186 -0.03985972  0.14701729]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.033042    0.03111612 -0.04172186 -0.03985972  0.14701729]
  [FlaxMamba2] B (step) sample values: [-0.05530081 -0.2693106   0.13460465  0.0012718   0.07315691]
  [FlaxMamba2] C (step) sample values: [-0.09109019 -0.26892054  0.56236756  0.10686187 -0.10484864]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8673339  -0.9793274  -1.6584101  -0.94076145 -0.4381494 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05130537 0.02543214 0.01781237 0.01542823 0.02137826]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9086419  0.9754012  0.97089183 0.9855905  0.9906769 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.033042    0.03111612 -0.04172186 -0.03985972  0.14701729]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.3747702e-05  4.5654390e-04 -2.2818609e-04 -2.1559999e-06
 -1.2401793e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.3747702e-05  4.5654390e-04 -2.2818609e-04 -2.1559999e-06
 -1.2401793e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 8.3415245e-05  1.2155159e-03 -2.5653356e-04  1.6210703e-05
 -1.8444561e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00072994  0.0002908  -0.00046409  0.00019758  0.00204343]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02711248  0.02513562 -0.03377711 -0.03162861  0.11943011]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02711248  0.02513562 -0.03377711 -0.03162861  0.11943011]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00932271  0.00767832 -0.00164024  0.00820005 -0.03287009]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.55695415  0.43793482 -0.08450861  0.39104477 -1.9142916 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.55695415  0.43793482 -0.08450861  0.39104477 -1.9142916 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ -4.091425    1.9296129   4.6536894 -11.7227545   3.1316433]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ -4.091425    1.9296129   4.6536894 -11.7227545   3.1316433]
  [Layer 46] Output shape after mixer: (1, 1, 2048)
  [Layer 46] Output sample values after mixer: [ -4.091425    1.9296129   4.6536894 -11.7227545   3.1316433]
  [Layer 46] Residual connection shape: (1, 1, 2048)
  [Layer 46] Residual connection sample values: [ 10.038999    30.84466    -13.502263     0.41147232 -30.15647   ]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.08275151  0.2566718  -0.10796341  0.00333045 -0.23249671]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.08275151  0.2566718  -0.10796341  0.00333045 -0.23249671]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.08275151  0.2566718  -0.10796341  0.00333045 -0.23249671]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.4284284   0.68486935 -2.1313384  -1.150988   -0.32396832]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.4284284   0.68486935 -2.1313384  -1.150988   -0.32396832]
  [FlaxMamba2] xBC (step) sample values: [ 0.00613084 -0.03127391 -0.32412875 -0.31287652  0.72000813]
  [FlaxMamba2] dt (step) sample values: [-0.5192406   0.7115644   0.34774357  1.1887639   1.201587  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.22847776 -0.08903592  0.16257574  0.00613084 -0.39338654]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00082659  0.04121529 -0.03092776  0.01131328  0.09711834]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01627852  0.01631295 -0.25041017  0.00793346  0.10229488]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.0082055   0.008223   -0.10961019  0.00398246  0.05376123]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0082055   0.008223   -0.10961019  0.00398246  0.05376123]
  [FlaxMamba2] B (step) sample values: [-0.11808705 -0.00861965  1.5812612  -0.26001677  0.02342047]
  [FlaxMamba2] C (step) sample values: [ 0.6723009  -0.11469694  0.08210438 -0.2663044  -0.23311877]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -3.552239  -11.244981   -2.6866128  -3.193549   -3.1997924]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01336663 0.03069941 0.00365698 0.01195513 0.03812987]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9536281 0.7080686 0.9902232 0.9625403 0.8851416]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0082055   0.008223   -0.10961019  0.00398246  0.05376123]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.2951783e-05 -9.4540337e-07  1.7343268e-04 -2.8518631e-05
  2.5687559e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.2951783e-05 -9.4540337e-07  1.7343268e-04 -2.8518631e-05
  2.5687559e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00056692 -0.00017695 -0.00113427 -0.0007962   0.0001788 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 2.5115252e-04  6.9419824e-05 -6.2954682e-04 -9.8612078e-04
  4.1892103e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01185225  0.01169525 -0.15559852  0.00464436  0.07642757]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01185225  0.01169525 -0.15559852  0.00464436  0.07642757]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00200322  0.00532506  0.03518229 -0.00128459 -0.01039204]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.12222414  0.19473436  2.1055174  -0.08030728 -0.6230774 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.12222414  0.19473436  2.1055174  -0.08030728 -0.6230774 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-4.4154215  2.5382757 -5.816571  14.495964   1.7445506]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-4.4154215  2.5382757 -5.816571  14.495964   1.7445506]
  [Layer 47] Output shape after mixer: (1, 1, 2048)
  [Layer 47] Output sample values after mixer: [-4.4154215  2.5382757 -5.816571  14.495964   1.7445506]
  [Layer 47] Residual connection shape: (1, 1, 2048)
  [Layer 47] Residual connection sample values: [  5.623577  33.382935 -19.318834  14.907436 -28.411919]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04613989  0.25575712 -0.1446808   0.11518036 -0.20712604]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.04613989  0.25575712 -0.1446808   0.11518036 -0.20712604]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.04613989  0.25575712 -0.1446808   0.11518036 -0.20712604]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.65370905 -3.1629739  -1.9489919   0.10665403  1.0383805 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.65370905 -3.1629739  -1.9489919   0.10665403  1.0383805 ]
  [FlaxMamba2] xBC (step) sample values: [-0.01763411 -0.22492543 -1.8963215  -1.2040799   0.00907404]
  [FlaxMamba2] dt (step) sample values: [ 0.7631255   2.6111665   0.5736751  -0.56218433 -0.8373967 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.37658596  1.0177499   0.7337517  -0.01763411  0.28610983]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01137585 -0.02673769 -0.27118516 -0.24046344 -0.00053684]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01654858  0.19323301 -0.35706162 -0.30674762 -0.00298207]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00820582  0.10592233 -0.14699194 -0.13003302 -0.00148881]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00820582  0.10592233 -0.14699194 -0.13003302 -0.00148881]
  [FlaxMamba2] B (step) sample values: [ 0.06353847  0.06110233 -0.07084242 -0.08363008  0.11549965]
  [FlaxMamba2] C (step) sample values: [-0.13092062 -0.2660851  -0.09529356 -0.19523618 -0.04792316]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-54.81184   -78.514336  -47.25076    -2.330753   -4.2266355]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06505834 0.11385134 0.00719886 0.00062429 0.00326092]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [2.8269619e-02 1.3117713e-04 7.1166241e-01 9.9854600e-01 9.8631185e-01]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00820582  0.10592233 -0.14699194 -0.13003302 -0.00148881]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.3920478e-05 -3.2619926e-05  3.7819744e-05  4.4646531e-05
 -6.1660336e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.3920478e-05 -3.2619926e-05  3.7819744e-05  4.4646531e-05
 -6.1660336e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.8486021e-05 -3.2895998e-05  3.5046774e-05  4.8016118e-05
 -5.4717697e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-8.6185217e-05  1.0741730e-03 -1.4824521e-03 -1.3143801e-03
 -1.4313240e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0066199   0.08541256 -0.11852164 -0.10485039 -0.00119975]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0066199   0.08541256 -0.11852164 -0.10485039 -0.00119975]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00284682 -0.01096384  0.02879694 -0.00588925 -0.00092006]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.18147132 -0.57277024  1.5568731  -0.36484125 -0.06345386]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.18147132 -0.57277024  1.5568731  -0.36484125 -0.06345386]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-17.414377  -1.015167  -9.633092  10.469638   5.261778]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-17.414377  -1.015167  -9.633092  10.469638   5.261778]
  [Layer 48] Output shape after mixer: (1, 1, 2048)
  [Layer 48] Output sample values after mixer: [-17.414377  -1.015167  -9.633092  10.469638   5.261778]
  [Layer 48] Residual connection shape: (1, 1, 2048)
  [Layer 48] Residual connection sample values: [-11.7908    32.367767 -28.951927  25.377075 -23.15014 ]
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.10475909  0.31807894 -0.26196688  0.2341654  -0.20370181]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Final backbone norm output sample values: [-0.10475909  0.31807894 -0.26196688  0.2341654  -0.20370181]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 1, 50288)
[Mamba2LMHeadModel] Logits sample values: [11.74462   -7.495748   7.3954086  8.328713   7.041163 ]
[Mamba2LMHeadModel] Forward pass input_ids shape: (1, 1)
[Mamba2LMHeadModel] input_ids sample values: [4875]
[Mamba2LMHeadModel] Embedding output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Embedding sample values: [-0.01163483 -0.01197815  0.07043457 -0.08422852 -0.02706909]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00842208 -0.00981115  0.0526708  -0.06298588 -0.01989134]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00842208 -0.00981115  0.0526708  -0.06298588 -0.01989134]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00842208 -0.00981115  0.0526708  -0.06298588 -0.01989134]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.11275311 -0.20208144  0.6347761   0.08725106  0.6652949 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.11275311 -0.20208144  0.6347761   0.08725106  0.6652949 ]
  [FlaxMamba2] xBC (step) sample values: [-0.8021352   0.07543899 -0.7153869  -0.33171976  0.22087908]
  [FlaxMamba2] dt (step) sample values: [ 0.02447925 -0.10859955 -0.46763209 -0.47939697  0.15236123]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.09133587  0.52318025  0.45514706 -0.8021352  -0.23571667]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.11645307 -0.06928407 -0.02270969 -0.0321366  -0.01123477]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.34423625  0.14604795  0.24755397  0.01705773 -0.2680707 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.20145367  0.07834702  0.13901997  0.00860161 -0.11617669]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.20145367  0.07834702  0.13901997  0.00860161 -0.11617669]
  [FlaxMamba2] B (step) sample values: [ 0.13005465  0.08450586 -0.27043074 -0.24301438  0.10426824]
  [FlaxMamba2] C (step) sample values: [-0.25101694 -0.08271261 -0.2753519  -0.27838153  0.16910681]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.617978  -2.5226073 -3.0473056 -3.307819  -3.9089987]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00932089 0.01218358 0.0056863  0.01520354 0.00848164]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.97589344 0.9697331  0.98282135 0.95095307 0.96738887]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.20145367  0.07834702  0.13901997  0.00860161 -0.11617669]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00024421  0.00015868 -0.0005078  -0.00045631  0.00019579]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00024421  0.00015868 -0.0005078  -0.00045631  0.00019579]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00247287  0.00154431 -0.00369689 -0.00383391  0.00078874]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00432644 -0.00314262 -0.00546759 -0.0012464   0.00382089]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.07250348  0.02673718  0.04755151  0.00203406 -0.0404863 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.07250348  0.02673718  0.04755151  0.00203406 -0.0404863 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-3.8573011e-03 -2.4295035e-03  1.9727776e-02  9.2605864e-05
 -1.7789405e-02]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.02098089 -0.01423322  0.0915492   0.00083149 -0.09855497]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02098089 -0.01423322  0.0915492   0.00083149 -0.09855497]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.14837626 -0.7831715   0.9442884   0.2655581  -0.22859967]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.14837626 -0.7831715   0.9442884   0.2655581  -0.22859967]
  [Layer 1] Output shape after mixer: (1, 1, 2048)
  [Layer 1] Output sample values after mixer: [-0.14837626 -0.7831715   0.9442884   0.2655581  -0.22859967]
  [Layer 1] Residual connection shape: (1, 1, 2048)
  [Layer 1] Residual connection sample values: [-0.16001108 -0.7951496   1.014723    0.18132958 -0.25566876]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.10644332 -0.41772634  0.6220761   0.11646543 -0.1604176 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.10644332 -0.41772634  0.6220761   0.11646543 -0.1604176 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.10644332 -0.41772634  0.6220761   0.11646543 -0.1604176 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.9690083 -2.824075  -0.1591119 -3.7866657 -0.6855852]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.9690083 -2.824075  -0.1591119 -3.7866657 -0.6855852]
  [FlaxMamba2] xBC (step) sample values: [-0.15312672  1.3667797  -0.47485134  4.5446734   0.37204036]
  [FlaxMamba2] dt (step) sample values: [ 0.8720598   1.3767811   0.10755577 -0.5022849  -1.2164688 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.12975971  0.35165885  0.7517786  -0.15312672  0.9405384 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12279473 -0.21146137 -0.44110867 -3.1344452   0.32726386]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.09297906 -0.36600238 -0.45162198 -2.0807343   0.31413367]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.04864925 -0.14988066 -0.17566974 -0.23092717  0.18153594]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04864925 -0.14988066 -0.17566974 -0.23092717  0.18153594]
  [FlaxMamba2] B (step) sample values: [ 0.14142884 -0.02579806  0.27013433  0.53438014 -0.11030551]
  [FlaxMamba2] C (step) sample values: [-0.2299745  -0.23933126 -0.14569269 -0.06197777 -0.24691069]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-19.851534   -18.68525    -13.564036    -2.4188707   -0.46617994]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01451082 0.02467443 0.02347404 0.0044335  0.00440198]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7497151 0.6306225 0.7273098 0.9893332 0.99795  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04864925 -0.14988066 -0.17566974 -0.23092717  0.18153594]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.9840363e-05 -1.8211897e-05  1.9069879e-04  3.7724062e-04
 -7.7869139e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.9840363e-05 -1.8211897e-05  1.9069879e-04  3.7724062e-04
 -7.7869139e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00035503 -0.00012447  0.00024915 -0.00071037  0.00081456]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00116808 -0.00403888 -0.00182535 -0.00578099 -0.00083409]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03475295 -0.10750856 -0.12309843 -0.16520087  0.12448871]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03475295 -0.10750856 -0.12309843 -0.16520087  0.12448871]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.06004662  0.01701351  0.00901574  0.01386773 -0.02859281]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.08888285  0.01191393  0.01413584  0.00880311 -0.04544941]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.08888285  0.01191393  0.01413584  0.00880311 -0.04544941]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.05832656 -0.31123358 -0.21963058  0.24945498  0.19789894]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.05832656 -0.31123358 -0.21963058  0.24945498  0.19789894]
  [Layer 2] Output shape after mixer: (1, 1, 2048)
  [Layer 2] Output sample values after mixer: [ 0.05832656 -0.31123358 -0.21963058  0.24945498  0.19789894]
  [Layer 2] Residual connection shape: (1, 1, 2048)
  [Layer 2] Residual connection sample values: [-0.10168453 -1.1063832   0.79509234  0.43078455 -0.05776982]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.05994536 -0.5099756   0.41991773  0.23408519 -0.03376286]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.05994536 -0.5099756   0.41991773  0.23408519 -0.03376286]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.05994536 -0.5099756   0.41991773  0.23408519 -0.03376286]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.8215135   0.8987272   0.32485503 -1.0636994   1.0181788 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.8215135   0.8987272   0.32485503 -1.0636994   1.0181788 ]
  [FlaxMamba2] xBC (step) sample values: [-1.0486968  -0.1920896  -2.3975084  -0.80274814 -1.7819091 ]
  [FlaxMamba2] dt (step) sample values: [-0.42835206  1.4872828   0.57111365 -0.62614304  0.03765127]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.9023777   0.42976293  0.0515903  -1.0486968  -0.4886475 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02710974 -0.03884714  0.06383798 -0.37402374  0.12106314]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02865851 -0.05814951  0.1874952  -0.38636047  0.10476676]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01412394 -0.02822965  0.10251056 -0.15631902  0.05512489]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01412394 -0.02822965  0.10251056 -0.15631902  0.05512489]
  [FlaxMamba2] B (step) sample values: [ 0.29049966 -0.11127101  0.01662482 -0.00291181  0.19769347]
  [FlaxMamba2] C (step) sample values: [ 0.38574108 -0.07216018 -0.19514452 -0.20443557 -0.2530069 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6505536 -3.9938898 -6.780579  -0.9418818 -6.0307717]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00547024 0.08720872 0.02399356 0.00351282 0.02250685]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9964476  0.70588565 0.84985435 0.9966968  0.8730751 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01412394 -0.02822965  0.10251056 -0.15631902  0.05512489]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.2444410e-05  8.5969541e-06 -1.2844571e-06  2.2497042e-07
 -1.5274074e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.2444410e-05  8.5969541e-06 -1.2844571e-06  2.2497042e-07
 -1.5274074e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.4234431e-03 -7.5872464e-05  3.5713641e-03  3.9277229e-04
  9.5918024e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00882339  0.09608945  0.06400232 -0.02295997 -0.01117272]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00239315  0.08323727  0.11067256 -0.09412774  0.01392413]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00239315  0.08323727  0.11067256 -0.09412774  0.01392413]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0006005   0.05316485  0.0208707   0.02569203  0.01041486]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00096857  0.09350385  0.02958216  0.05578547  0.01303156]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00096857  0.09350385  0.02958216  0.05578547  0.01303156]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.87905204  0.09721599  0.00653719 -0.69578475  0.14154243]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.87905204  0.09721599  0.00653719 -0.69578475  0.14154243]
  [Layer 3] Output shape after mixer: (1, 1, 2048)
  [Layer 3] Output sample values after mixer: [-0.87905204  0.09721599  0.00653719 -0.69578475  0.14154243]
  [Layer 3] Residual connection shape: (1, 1, 2048)
  [Layer 3] Residual connection sample values: [-0.98073655 -1.0091672   0.80162954 -0.2650002   0.08377261]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.5388247  -0.41989323  0.38905463 -0.13302898  0.04616979]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.5388247  -0.41989323  0.38905463 -0.13302898  0.04616979]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.5388247  -0.41989323  0.38905463 -0.13302898  0.04616979]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.7146277   0.43508014 -1.5108904  -0.57048446 -1.3258048 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.7146277   0.43508014 -1.5108904  -0.57048446 -1.3258048 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.3904788 -1.0079834 -2.0407057 -2.4531453 -2.2156875]
  [FlaxMamba2] dt (step) sample values: [ 0.04958722  2.197534    0.23349395  0.898044   -0.7356892 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.6362446  -0.09687654 -1.3303822   1.3904788   0.2179003 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [0.26385638 0.3041923  0.29191843 0.03899173 0.03814368]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [0.19006488 0.26903605 0.24370065 0.02316837 0.33111244]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [0.10403652 0.15250477 0.13662478 0.01171837 0.19271739]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [0.10403652 0.15250477 0.13662478 0.01171837 0.19271739]
  [FlaxMamba2] B (step) sample values: [ 0.39537272  0.15055966 -0.03350805  0.20786247  0.0722395 ]
  [FlaxMamba2] C (step) sample values: [ 0.7366573  -0.25769642 -0.27237752 -0.2743248  -0.15746462]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.7127254  -1.2862217  -1.4869522 -27.028044   -4.0726624]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00645123 0.02148136 0.00241628 0.00793561 0.01833803]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.98901165 0.9727484  0.9964135  0.8069577  0.92803615]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [0.10403652 0.15250477 0.13662478 0.01171837 0.19271739]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.6535991e-04  1.0105021e-04 -2.2489392e-05  1.3950978e-04
  4.8484540e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.6535991e-04  1.0105021e-04 -2.2489392e-05  1.3950978e-04
  4.8484540e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00297677 -0.00216214 -0.00236299  0.00079367 -0.00049548]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00296026  0.01302823 -0.00554646 -0.00988188  0.05429198]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.05559953  0.09886968  0.07135651 -0.00328588  0.1627682 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.05559953  0.09886968  0.07135651 -0.00328588  0.1627682 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01454435  0.02611456 -0.01949313  0.00067694 -0.04528629]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.03171999  0.03659404 -0.04179768  0.00122317 -0.04882894]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.03171999  0.03659404 -0.04179768  0.00122317 -0.04882894]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.0001582  -0.14130142 -0.90887696 -0.76988435 -0.16684575]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.0001582  -0.14130142 -0.90887696 -0.76988435 -0.16684575]
  [Layer 4] Output shape after mixer: (1, 1, 2048)
  [Layer 4] Output sample values after mixer: [ 1.0001582  -0.14130142 -0.90887696 -0.76988435 -0.16684575]
  [Layer 4] Residual connection shape: (1, 1, 2048)
  [Layer 4] Residual connection sample values: [ 0.01942164 -1.1504686  -0.10724741 -1.0348846  -0.08307314]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.00814794 -0.39886245 -0.04202466 -0.41584885 -0.03596367]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00814794 -0.39886245 -0.04202466 -0.41584885 -0.03596367]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.00814794 -0.39886245 -0.04202466 -0.41584885 -0.03596367]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.984916   -0.19469512 -0.13782306 -0.52553076 -1.6196051 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.984916   -0.19469512 -0.13782306 -0.52553076 -1.6196051 ]
  [FlaxMamba2] xBC (step) sample values: [-0.7607311   1.3172069  -1.2999375   0.1637539   0.97698927]
  [FlaxMamba2] dt (step) sample values: [ 2.2093542   0.920526    0.50491387 -0.0413352  -0.9343357 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.02045043 -0.33975518 -0.0259489  -0.7607311  -0.17593281]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.05443234 -0.06655633  0.00677986 -0.16998126 -0.28259483]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.10600705 -0.10387933 -0.06273918 -0.1961043  -0.28845802]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.05019678 -0.04924436 -0.03038586 -0.08846862 -0.12357006]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05019678 -0.04924436 -0.03038586 -0.08846862 -0.12357006]
  [FlaxMamba2] B (step) sample values: [ 0.1307075  -0.02777206 -0.02493091 -0.14511105  0.1112069 ]
  [FlaxMamba2] C (step) sample values: [ 0.06689776 -0.24353483 -0.15980665  0.38170186  0.02008419]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.5762966   -1.0443833   -0.83880144  -5.6764617  -20.401838  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03490847 0.02994047 0.06934703 0.01333264 0.00134053]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9464604  0.9692145  0.94349104 0.9271108  0.97302145]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05019678 -0.04924436 -0.03038586 -0.08846862 -0.12357006]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.2903777e-04  4.8664773e-05  4.3686250e-05  2.5427702e-04
 -1.9486703e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.2903777e-04  4.8664773e-05  4.3686250e-05  2.5427702e-04
 -1.9486703e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-4.3191659e-04 -6.1292158e-05  5.6671794e-04  3.6418176e-04
 -6.3618121e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0018432  -0.00747279 -0.01736307 -0.00148018 -0.01608946]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0288254  -0.03394304 -0.03369634 -0.04903459 -0.0825119 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0288254  -0.03394304 -0.03369634 -0.04903459 -0.0825119 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.0077199  0.00298362 0.0021623  0.0095748  0.02208471]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.01087117 0.00428505 0.00295796 0.01370935 0.02802837]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.01087117 0.00428505 0.00295796 0.01370935 0.02802837]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.25923684 -0.2833861  -0.332377   -0.12039159  0.11676569]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.25923684 -0.2833861  -0.332377   -0.12039159  0.11676569]
  [Layer 5] Output shape after mixer: (1, 1, 2048)
  [Layer 5] Output sample values after mixer: [ 0.25923684 -0.2833861  -0.332377   -0.12039159  0.11676569]
  [Layer 5] Residual connection shape: (1, 1, 2048)
  [Layer 5] Residual connection sample values: [ 0.27865848 -1.4338547  -0.4396244  -1.1552762   0.03369255]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.10768142 -0.42883763 -0.15077718 -0.4095788   0.01320728]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10768142 -0.42883763 -0.15077718 -0.4095788   0.01320728]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10768142 -0.42883763 -0.15077718 -0.4095788   0.01320728]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.8856976 -2.4525716 -3.1562655  0.7793832 -1.7863548]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.8856976 -2.4525716 -3.1562655  0.7793832 -1.7863548]
  [FlaxMamba2] xBC (step) sample values: [-0.0793758 -0.0990798 -4.5567355  2.412023  -2.1858366]
  [FlaxMamba2] dt (step) sample values: [ 2.4731083   0.01952896 -0.05337044 -0.03462399  1.3284115 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.45463678  0.05953435 -0.11477014 -0.0793758   0.7236467 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01415016  0.01004661 -2.2782543  -0.40683895 -0.4082664 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04851295 -0.06228005 -2.3404186  -0.34473568 -0.33856425]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02484474 -0.03017064 -0.20555983 -0.14294796 -0.1408963 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02484474 -0.03017064 -0.20555983 -0.14294796 -0.1408963 ]
  [FlaxMamba2] B (step) sample values: [ 0.14076181  0.01820246 -0.2669484   0.02051954  0.04990068]
  [FlaxMamba2] C (step) sample values: [-0.21846586 -0.13693276 -0.2668166   0.26524428  0.0527873 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.98658675 -8.774721   -3.3045902  -2.9912853  -3.3435438 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10677776 0.01399956 0.07973476 0.06378526 0.10775422]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9000135  0.88440317 0.7683647  0.8262979  0.6974803 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02484474 -0.03017064 -0.20555983 -0.14294796 -0.1408963 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.7342217e-04  4.8288683e-05 -7.0817821e-04  5.4435575e-05
  1.3237979e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.7342217e-04  4.8288683e-05 -7.0817821e-04  5.4435575e-05
  1.3237979e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01619257 -0.00047979 -0.01001865 -0.00099037  0.00363977]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0512302  -0.08029116 -0.13844258 -0.02367603 -0.11146265]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.05661039 -0.08682469 -0.18295714 -0.05463181 -0.14197414]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.05661039 -0.08682469 -0.18295714 -0.05463181 -0.14197414]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03549898  0.01687594  0.02358647 -0.02918999  0.03639905]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.06464469  0.01439713  0.01912845 -0.03078012  0.0270931 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.06464469  0.01439713  0.01912845 -0.03078012  0.0270931 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.23813154  0.03240951  0.18403077 -0.17183016 -0.00517855]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.23813154  0.03240951  0.18403077 -0.17183016 -0.00517855]
  [Layer 6] Output shape after mixer: (1, 1, 2048)
  [Layer 6] Output sample values after mixer: [-0.23813154  0.03240951  0.18403077 -0.17183016 -0.00517855]
  [Layer 6] Residual connection shape: (1, 1, 2048)
  [Layer 6] Residual connection sample values: [ 0.04052694 -1.4014452  -0.25559363 -1.3271064   0.028514  ]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0122164  -0.35088038 -0.0714239  -0.36628184  0.0086225 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0122164  -0.35088038 -0.0714239  -0.36628184  0.0086225 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0122164  -0.35088038 -0.0714239  -0.36628184  0.0086225 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.39897454 -1.8637      0.9486468  -0.69493634 -0.44985342]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.39897454 -1.8637      0.9486468  -0.69493634 -0.44985342]
  [FlaxMamba2] xBC (step) sample values: [-3.4465427e+00 -1.1131960e-04  1.3463660e+00 -1.7855108e+00
  1.1311409e+00]
  [FlaxMamba2] dt (step) sample values: [0.91461414 1.0837028  0.7944953  1.325023   1.4011437 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.9761943 -1.787138  -1.6185312 -3.4465427  0.2975154]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.28504145  0.13461776  0.14835219 -0.39382973 -0.3004756 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.21692622  0.15924545  0.14760213 -0.38740578 -0.30406904]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.12018143  0.08594914  0.07923779 -0.15664442 -0.1290965 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.12018143  0.08594914  0.07923779 -0.15664442 -0.1290965 ]
  [FlaxMamba2] B (step) sample values: [ 0.03505111 -0.06558279 -0.05946294 -0.04728736  0.04278339]
  [FlaxMamba2] C (step) sample values: [-0.04349972 -0.00942221 -0.21488702  0.00150408 -0.08185916]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.29588825 -1.1836219  -0.3113019  -0.1314279  -1.5015444 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04302231 0.01762558 0.0055789  0.05534424 0.00435265]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9873509 0.9793541 0.9982648 0.9927526 0.9934856]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.12018143  0.08594914  0.07923779 -0.15664442 -0.1290965 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00018123 -0.00033909 -0.00030745 -0.0002445   0.00022121]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00018123 -0.00033909 -0.00030745 -0.0002445   0.00022121]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00077705  0.00040318 -0.00149884  0.00016583 -0.00306088]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00293871 -0.0021006  -0.00178627 -0.00166511 -0.00048224]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00321369 -0.00190394 -0.00160497 -0.00202352 -0.00077762]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00321369 -0.00190394 -0.00160497 -0.00202352 -0.00077762]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00076731  0.00047645 -0.00109752  0.00046818  0.00013622]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00897267  0.00310302 -0.01686677  0.00507478  0.00201579]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00897267  0.00310302 -0.01686677  0.00507478  0.00201579]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.37749207 -0.4032641   0.12486098 -0.34701073 -0.4346462 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.37749207 -0.4032641   0.12486098 -0.34701073 -0.4346462 ]
  [Layer 7] Output shape after mixer: (1, 1, 2048)
  [Layer 7] Output sample values after mixer: [ 0.37749207 -0.4032641   0.12486098 -0.34701073 -0.4346462 ]
  [Layer 7] Residual connection shape: (1, 1, 2048)
  [Layer 7] Residual connection sample values: [ 0.418019   -1.8047092  -0.13073266 -1.6741171  -0.4061322 ]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15017994 -0.50746036 -0.04376543 -0.5575971  -0.14521857]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15017994 -0.50746036 -0.04376543 -0.5575971  -0.14521857]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15017994 -0.50746036 -0.04376543 -0.5575971  -0.14521857]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.84708136 -0.82542175 -1.2191921  -0.8384686   1.224651  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.84708136 -0.82542175 -1.2191921  -0.8384686   1.224651  ]
  [FlaxMamba2] xBC (step) sample values: [ 0.77030414 -0.16261686 -1.913331    0.79612255 -0.6924859 ]
  [FlaxMamba2] dt (step) sample values: [-1.0605335  -0.06797374  0.6733955  -0.5552152   0.0548978 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.8000778   0.36608806  0.7768992   0.77030414 -0.83707124]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.10543722  0.29172397  0.28331214 -0.06772403 -0.12067483]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.56832784  0.26070285 -0.03138512 -0.11929874 -0.17679664]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.36280757  0.14724734 -0.01544633 -0.05609553 -0.08060435]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.36280757  0.14724734 -0.01544633 -0.05609553 -0.08060435]
  [FlaxMamba2] B (step) sample values: [ 0.27663168  0.01173088 -0.09094444  0.5037904  -0.1231394 ]
  [FlaxMamba2] C (step) sample values: [ 0.6367408  -0.23853211 -0.08964671 -0.22389863 -0.01208215]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.6542776 -0.9827404 -0.5549556 -3.9396574 -1.8081155]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00349636 0.0507831  0.02171678 0.01388412 0.0101842 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.98730457 0.95131826 0.9880205  0.94677037 0.9817543 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.36280757  0.14724734 -0.01544633 -0.05609553 -0.08060435]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.50909133e-04  1.48806985e-05 -1.15363626e-04  6.39061444e-04
 -1.56203154e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.50909133e-04  1.48806985e-05 -1.15363626e-04  6.39061444e-04
 -1.56203154e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00079713  0.00281417  0.0014568  -0.00201123 -0.00083602]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.04535982 -0.01525409 -0.02075252 -0.01810497 -0.0105135 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.35077125  0.10869873 -0.03375524 -0.06532619 -0.07836624]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.35077125  0.10869873 -0.03375524 -0.06532619 -0.07836624]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.08915304 -0.02733067  0.00938638  0.01653393 -0.0741744 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.0872459  -0.0340748   0.00795496  0.02195539 -0.11750543]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0872459  -0.0340748   0.00795496  0.02195539 -0.11750543]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.08452008 -0.31422675 -0.26271737 -0.28602356  0.46211183]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.08452008 -0.31422675 -0.26271737 -0.28602356  0.46211183]
  [Layer 8] Output shape after mixer: (1, 1, 2048)
  [Layer 8] Output sample values after mixer: [-0.08452008 -0.31422675 -0.26271737 -0.28602356  0.46211183]
  [Layer 8] Residual connection shape: (1, 1, 2048)
  [Layer 8] Residual connection sample values: [ 0.33349892 -2.118936   -0.39345002 -1.9601407   0.05597964]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.10355092 -0.5375658  -0.11230952 -0.5373127   0.0171583 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10355092 -0.5375658  -0.11230952 -0.5373127   0.0171583 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10355092 -0.5375658  -0.11230952 -0.5373127   0.0171583 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.4279815  -1.152502   -0.41802675 -3.2023494  -0.687402  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.4279815  -1.152502   -0.41802675 -3.2023494  -0.687402  ]
  [FlaxMamba2] xBC (step) sample values: [ 2.0374093 -2.5895147 -2.6665668 -2.1465635 -1.9542264]
  [FlaxMamba2] dt (step) sample values: [ 0.6421583   0.5095762   1.8905274  -0.04064138  1.4602077 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.32918003 0.7055616  1.514101   2.0374093  0.4804765 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.41203398 -0.3818268   0.09731711 -0.18208635 -0.13134769]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.40468305 -0.40717164  0.01064719 -0.25599992 -0.10630801]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.16194919 -0.16270192  0.00535193 -0.11170487 -0.05033131]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.16194919 -0.16270192  0.00535193 -0.11170487 -0.05033131]
  [FlaxMamba2] B (step) sample values: [-0.10227851 -0.2779722   0.05911335  0.3092341   0.3576818 ]
  [FlaxMamba2] C (step) sample values: [-0.22460449 -0.2288362  -0.2782918  -0.27359018  0.00134131]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-5.234511  -1.2161361 -1.4887683 -0.9523448 -3.9666808]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01911545 0.06160518 0.0313937  0.12261927 0.06603805]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9047831  0.92781746 0.9543375  0.88978463 0.76954806]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.16194919 -0.16270192  0.00535193 -0.11170487 -0.05033131]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00031663  0.00086053 -0.000183   -0.00095731 -0.00110729]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00031663  0.00086053 -0.000183   -0.00095731 -0.00110729]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00253856  0.00316542  0.00179985 -0.00427826 -0.0034709 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01673708  0.00508716 -0.03540714 -0.00057801 -0.00481475]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.23626763 -0.21546376 -0.02815232 -0.15199977 -0.07304147]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.23626763 -0.21546376 -0.02815232 -0.15199977 -0.07304147]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.06525493 0.05960542 0.00467193 0.01902118 0.01680045]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.06178368 0.08409355 0.00440673 0.01414777 0.01820055]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.06178368 0.08409355 0.00440673 0.01414777 0.01820055]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.1356587   0.08497953  0.3726888  -0.07230215  0.09408589]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.1356587   0.08497953  0.3726888  -0.07230215  0.09408589]
  [Layer 9] Output shape after mixer: (1, 1, 2048)
  [Layer 9] Output sample values after mixer: [-0.1356587   0.08497953  0.3726888  -0.07230215  0.09408589]
  [Layer 9] Residual connection shape: (1, 1, 2048)
  [Layer 9] Residual connection sample values: [ 0.19784023 -2.0339565  -0.02076122 -2.0324428   0.15006554]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0495969  -0.42618173 -0.00469818 -0.45537087  0.03676671]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0495969  -0.42618173 -0.00469818 -0.45537087  0.03676671]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0495969  -0.42618173 -0.00469818 -0.45537087  0.03676671]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.22387739  0.5750672  -0.9455408  -2.8225002  -1.3545727 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.22387739  0.5750672  -0.9455408  -2.8225002  -1.3545727 ]
  [FlaxMamba2] xBC (step) sample values: [ 2.0155783  -1.0325099   0.9786305   0.25161856 -0.86676157]
  [FlaxMamba2] dt (step) sample values: [ 1.1343733  -0.30196038  0.42634964  0.39299425  0.98023385]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.5293305 -0.7617132  0.7225964  2.0155783  1.1741984]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.33434582  0.13814577  0.18077339 -0.0455934  -0.1571024 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.29598522  0.05104861  0.07695259 -0.13140883 -0.21667272]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.16973592  0.02617565  0.03995599 -0.06139355 -0.0966453 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.16973592  0.02617565  0.03995599 -0.06139355 -0.0966453 ]
  [FlaxMamba2] B (step) sample values: [-0.03266738 -0.05104408 -0.02885129  0.10297104 -0.0742678 ]
  [FlaxMamba2] C (step) sample values: [-0.22002481 -0.17809139 -0.2617456  -0.13743357  0.19768153]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.7154508  -1.4067873  -0.35344088 -2.010216   -0.4652703 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00136476 0.00263204 0.14145702 0.00270394 0.02006613]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9949421  0.9963041  0.95123255 0.99457926 0.9907073 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.16973592  0.02617565  0.03995599 -0.06139355 -0.0966453 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.5673488e-06 -1.1824284e-05 -6.6833591e-06  2.3853087e-05
 -1.7204025e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.5673488e-06 -1.1824284e-05 -6.6833591e-06  2.3853087e-05
 -1.7204025e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.5466743e-05  3.8668535e-05  3.1945794e-05  5.6122422e-05
 -2.8750419e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00034297 -0.0017603   0.00027647 -0.00049003  0.00116414]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03763746  0.00399103  0.00905563 -0.01397946 -0.02007082]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03763746  0.00399103  0.00905563 -0.01397946 -0.02007082]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00374344  0.00146872 -0.00239563  0.00221434  0.00557678]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.04585523  0.00876696 -0.02297912  0.02417354  0.0563413 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.04585523  0.00876696 -0.02297912  0.02417354  0.0563413 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.62599754 -0.4454289   0.13851018 -0.36804402 -0.2528578 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.62599754 -0.4454289   0.13851018 -0.36804402 -0.2528578 ]
  [Layer 10] Output shape after mixer: (1, 1, 2048)
  [Layer 10] Output sample values after mixer: [-0.62599754 -0.4454289   0.13851018 -0.36804402 -0.2528578 ]
  [Layer 10] Residual connection shape: (1, 1, 2048)
  [Layer 10] Residual connection sample values: [-0.42815733 -2.4793854   0.11774896 -2.400487   -0.10279226]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.11162674 -0.5259172   0.02742191 -0.54540926 -0.02561813]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.11162674 -0.5259172   0.02742191 -0.54540926 -0.02561813]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.11162674 -0.5259172   0.02742191 -0.54540926 -0.02561813]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.1286296   1.1728762   1.3942102  -2.1085567  -0.14013241]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.1286296   1.1728762   1.3942102  -2.1085567  -0.14013241]
  [FlaxMamba2] xBC (step) sample values: [0.8702426  0.84047693 1.4423826  1.3520141  0.6081202 ]
  [FlaxMamba2] dt (step) sample values: [ 2.8898785   3.3387756  -0.18182649  1.3176622   1.8409139 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.08247908  0.5253639  -0.5230793   0.8702426   0.01610305]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.19933939 -0.1888892  -0.32767218 -0.13042998  0.12634896]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.21354532 -0.5465552  -0.23111457 -0.11828399  0.1495118 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.09541539 -0.20040213 -0.10226292 -0.05564829  0.08033396]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09541539 -0.20040213 -0.10226292 -0.05564829  0.08033396]
  [FlaxMamba2] B (step) sample values: [-0.23180434 -0.27384672 -0.2754921   0.04380002  0.04902847]
  [FlaxMamba2] C (step) sample values: [ 0.00749505 -0.1358404  -0.22282632 -0.27806813 -0.0998943 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.31160602 -0.09015273 -1.5786072  -0.20961139 -0.6694042 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.27716246 0.6422219  0.10093626 0.15111615 0.04610839]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9172589  0.94374615 0.8527075  0.96882075 0.96960634]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09541539 -0.20040213 -0.10226292 -0.05564829  0.08033396]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0061302   0.00724203  0.00728554 -0.00115832 -0.00129659]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0061302   0.00724203  0.00728554 -0.00115832 -0.00129659]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.04618169 -0.04495171  0.05399782  0.01146965 -0.04834623]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.07893015 -0.16299951  0.11836232 -0.04963841  0.01834389]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.11393592 -0.23652256  0.08084435 -0.07005452  0.04781661]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.11393592 -0.23652256  0.08084435 -0.07005452  0.04781661]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03142956 -0.21184945  0.09031364  0.01599268 -0.00311597]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.03888765 -0.2569113   0.07767941  0.04482898 -0.00286854]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03888765 -0.2569113   0.07767941  0.04482898 -0.00286854]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.53938955 -0.16978057 -0.41829535  0.87639093  0.3597469 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.53938955 -0.16978057 -0.41829535  0.87639093  0.3597469 ]
  [Layer 11] Output shape after mixer: (1, 1, 2048)
  [Layer 11] Output sample values after mixer: [ 0.53938955 -0.16978057 -0.41829535  0.87639093  0.3597469 ]
  [Layer 11] Residual connection shape: (1, 1, 2048)
  [Layer 11] Residual connection sample values: [ 0.11123222 -2.6491659  -0.3005464  -1.524096    0.25695464]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02266669 -0.44795406 -0.0534987  -0.2694608   0.05016452]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.02266669 -0.44795406 -0.0534987  -0.2694608   0.05016452]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.02266669 -0.44795406 -0.0534987  -0.2694608   0.05016452]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.23492579 -1.2867897   2.1060972   0.14595176 -0.93319786]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.23492579 -1.2867897   2.1060972   0.14595176 -0.93319786]
  [FlaxMamba2] xBC (step) sample values: [ 0.39472455  0.4078149  -0.73441696 -0.42176694 -0.7466923 ]
  [FlaxMamba2] dt (step) sample values: [0.98352873 1.091852   1.1430585  0.8081369  1.3763429 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.36496753 -0.6304363  -0.6395428   0.39472455  0.5146205 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.0578329  -0.11034344 -0.05545613 -0.00475443 -0.13665079]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01483364 -0.09744976 -0.09033772 -0.03446329 -0.12403177]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00747183 -0.04635265 -0.04313002 -0.01693475 -0.05817483]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00747183 -0.04635265 -0.04313002 -0.01693475 -0.05817483]
  [FlaxMamba2] B (step) sample values: [ 0.06009204 -0.13032521  0.23523724 -0.03078203  0.10161657]
  [FlaxMamba2] C (step) sample values: [-0.27733758 -0.23749883  0.06546871 -0.27769202 -0.26087296]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2411823 -0.7693517 -1.9974962 -1.2367963 -1.0181218]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10944658 0.18895917 0.0822527  0.19744638 0.27766863]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8729795  0.86469704 0.8484879  0.7833302  0.7537455 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00747183 -0.04635265 -0.04313002 -0.01693475 -0.05817483]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.9141221e-05 -1.0657551e-04  1.9236899e-04 -2.5172498e-05
  8.3098566e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.9141221e-05 -1.0657551e-04  1.9236899e-04 -2.5172498e-05
  8.3098566e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.3579379e-03  7.8696925e-03 -1.0427237e-02  4.0169316e-03
 -5.6570047e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01549505 -0.01530483  0.0078566  -0.00475465 -0.00540186]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01011672 -0.04867014 -0.02318901 -0.01694453 -0.04727695]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01011672 -0.04867014 -0.02318901 -0.01694453 -0.04727695]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00104939  0.01355254 -0.04353907 -0.00132662  0.01245368]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00369919  0.03146777 -0.07640518 -0.0026628   0.03594226]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00369919  0.03146777 -0.07640518 -0.0026628   0.03594226]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.70488477  1.2908888   0.30222717  1.260126    0.5833577 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.70488477  1.2908888   0.30222717  1.260126    0.5833577 ]
  [Layer 12] Output shape after mixer: (1, 1, 2048)
  [Layer 12] Output sample values after mixer: [-0.70488477  1.2908888   0.30222717  1.260126    0.5833577 ]
  [Layer 12] Residual connection shape: (1, 1, 2048)
  [Layer 12] Residual connection sample values: [-0.59365255 -1.3582771   0.00168076 -0.26397002  0.84031236]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.10270607 -0.2033662   0.00026832 -0.03966036  0.14757337]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.10270607 -0.2033662   0.00026832 -0.03966036  0.14757337]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.10270607 -0.2033662   0.00026832 -0.03966036  0.14757337]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.9925914   0.96955633 -1.2271885   3.5364819   0.29688886]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.9925914   0.96955633 -1.2271885   3.5364819   0.29688886]
  [FlaxMamba2] xBC (step) sample values: [-0.5728934  0.5522115 -1.3964007  1.8348083 -0.6279039]
  [FlaxMamba2] dt (step) sample values: [0.93085563 0.7781505  1.506351   0.6419528  0.90144634]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.29596958 -1.7109807  -0.64950573 -0.5728934  -0.66589975]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.18260607  0.1500876   0.12285051  0.00687154 -0.03935488]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.4472545   0.04016328  0.10237321  0.00606664 -0.06331117]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.17443539  0.02048486  0.05380439  0.00304252 -0.03065385]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.17443539  0.02048486  0.05380439  0.00304252 -0.03065385]
  [FlaxMamba2] B (step) sample values: [-0.07799886  0.35098168 -0.06761825  0.5664751  -0.06520073]
  [FlaxMamba2] C (step) sample values: [ 0.05580596 -0.259629   -0.06396301  0.4147039   0.21586071]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3103099 -1.7870504 -0.8605819 -1.881061  -0.5251649]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02418826 0.02112223 0.16233371 0.08691414 0.04279737]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.96880287 0.962957   0.8696178  0.8491743  0.97777504]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.17443539  0.02048486  0.05380439  0.00304252 -0.03065385]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0003291  -0.00148089  0.0002853  -0.00239012  0.0002751 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.0003291  -0.00148089  0.0002853  -0.00239012  0.0002751 ]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0003646  -0.00756137  0.00143199 -0.04116779  0.00112008]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.06654186  0.03305436  0.02387413 -0.00958599  0.02675678]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07405137  0.03393624  0.02619043 -0.00945501  0.02543712]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07405137  0.03393624  0.02619043 -0.00945501  0.02543712]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01770398  0.02385577 -0.00728543 -0.03249146  0.00433244]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.08183668  0.03637433 -0.04554864 -0.23123056  0.0117639 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.08183668  0.03637433 -0.04554864 -0.23123056  0.0117639 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.2336032   0.3416059  -0.9413817  -1.1357731  -0.04566284]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.2336032   0.3416059  -0.9413817  -1.1357731  -0.04566284]
  [Layer 13] Output shape after mixer: (1, 1, 2048)
  [Layer 13] Output sample values after mixer: [ 0.2336032   0.3416059  -0.9413817  -1.1357731  -0.04566284]
  [Layer 13] Residual connection shape: (1, 1, 2048)
  [Layer 13] Residual connection sample values: [-0.36004937 -1.0166712  -0.93970096 -1.3997431   0.79464954]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.04884143 -0.12113243 -0.11802336 -0.16531338  0.10523286]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04884143 -0.12113243 -0.11802336 -0.16531338  0.10523286]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04884143 -0.12113243 -0.11802336 -0.16531338  0.10523286]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.6311346  -1.0245197  -1.1783336  -2.0791252   0.05967832]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.6311346  -1.0245197  -1.1783336  -2.0791252   0.05967832]
  [FlaxMamba2] xBC (step) sample values: [-1.3515543   0.1898144  -0.16760561 -1.6490779   0.25160778]
  [FlaxMamba2] dt (step) sample values: [0.46934286 0.95732695 0.7980079  1.4170948  1.8094839 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.787196  -1.5263305 -1.276522  -1.3515543 -0.5360401]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.3783187  -0.06333905 -0.03210033 -0.36771703 -0.02947529]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.41786948 -0.10459881 -0.09295238 -0.4305222   0.00708477]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.16590533 -0.04956666 -0.04431771 -0.16962646  0.00355493]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.16590533 -0.04956666 -0.04431771 -0.16962646  0.00355493]
  [FlaxMamba2] B (step) sample values: [-0.06171329  0.04217961  0.13149127 -0.10707289 -0.03503332]
  [FlaxMamba2] C (step) sample values: [-0.19794343 -0.05529925  0.28281584 -0.15485553 -0.2678026 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.318424  -0.7620611 -2.6670074 -5.1836414 -2.8487349]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06247464 0.03104559 0.17236164 0.06652985 0.08197706]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.76353824 0.976619   0.6314795  0.70831466 0.79173315]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.16590533 -0.04956666 -0.04431771 -0.16962646  0.00355493]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00063965 -0.00043719 -0.00136289  0.0011098   0.00036312]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00063965 -0.00043719 -0.00136289  0.0011098   0.00036312]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00248226  0.00028431 -0.00206045  0.00204969  0.0009085 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02085408 -0.0058665  -0.00927004 -0.01401327 -0.00081286]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.08791691 -0.02590251 -0.0271843  -0.08258026  0.00062413]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.08791691 -0.02590251 -0.0271843  -0.08258026  0.00062413]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [1.9268187e-02 7.0098601e-03 7.5388351e-03 1.9082556e-02 1.9179044e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.13906759 0.02944485 0.04595222 0.16352092 0.00019052]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.13906759 0.02944485 0.04595222 0.16352092 0.00019052]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.03769895 -0.01382298  0.8130446  -0.32079825  0.8243314 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.03769895 -0.01382298  0.8130446  -0.32079825  0.8243314 ]
  [Layer 14] Output shape after mixer: (1, 1, 2048)
  [Layer 14] Output sample values after mixer: [ 0.03769895 -0.01382298  0.8130446  -0.32079825  0.8243314 ]
  [Layer 14] Residual connection shape: (1, 1, 2048)
  [Layer 14] Residual connection sample values: [-0.3223504  -1.0304942  -0.12665635 -1.7205414   1.6189809 ]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03848648 -0.10460044 -0.01389952 -0.17679103  0.18521345]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03848648 -0.10460044 -0.01389952 -0.17679103  0.18521345]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03848648 -0.10460044 -0.01389952 -0.17679103  0.18521345]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.1081062   1.1945149  -1.6091615  -0.52770865 -1.5534624 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.1081062   1.1945149  -1.6091615  -0.52770865 -1.5534624 ]
  [FlaxMamba2] xBC (step) sample values: [-0.19407633 -0.6310926   0.27748516 -0.49587533  0.18424039]
  [FlaxMamba2] dt (step) sample values: [1.4769738  0.17406604 1.945134   0.6347891  0.57147026]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.19674203 -0.6432447   0.05313125 -0.19407633  0.9232607 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01696003  0.14438418 -0.00120477 -0.04818925 -0.17391184]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02048504  0.13752916 -0.02598505 -0.06593522 -0.19925669]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01013761  0.07348572 -0.01282373 -0.03188114 -0.08973525]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01013761  0.07348572 -0.01282373 -0.03188114 -0.08973525]
  [FlaxMamba2] B (step) sample values: [-0.01941951 -0.03550541  0.00080499  0.00924509 -0.02583714]
  [FlaxMamba2] C (step) sample values: [-0.09993851 -0.00908188  0.02174261 -0.0355063  -0.00102556]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.27823287 -0.68077636 -2.7209377  -0.11263601 -3.8483953 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00845202 0.01883413 0.1013127  0.0107725  0.04064707]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99765116 0.98726004 0.75906676 0.99878734 0.8551948 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01013761  0.07348572 -0.01282373 -0.03188114 -0.08973525]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.6639293e-06  3.0422227e-06 -6.8974529e-08 -7.9215044e-07
  2.2138133e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.6639293e-06  3.0422227e-06 -6.8974529e-08 -7.9215044e-07
  2.2138133e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-6.0786359e-05  8.8159168e-06 -1.8684053e-05 -1.6671398e-05
 -7.9050697e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 6.2468542e-05  2.0656100e-05 -2.0287857e-06  8.0034806e-06
 -1.4981886e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00166528  0.01254481 -0.00218757 -0.00542549 -0.01530854]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00166528  0.01254481 -0.00218757 -0.00542549 -0.01530854]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [8.5152911e-05 1.1501671e-02 5.8682839e-04 1.0623498e-03 4.1518896e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.00176076 0.31074655 0.01222582 0.02573859 0.07382409]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.00176076 0.31074655 0.01222582 0.02573859 0.07382409]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.13641687 -0.16095038 -0.14400887  0.3249719   0.31649232]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.13641687 -0.16095038 -0.14400887  0.3249719   0.31649232]
  [Layer 15] Output shape after mixer: (1, 1, 2048)
  [Layer 15] Output sample values after mixer: [ 0.13641687 -0.16095038 -0.14400887  0.3249719   0.31649232]
  [Layer 15] Residual connection shape: (1, 1, 2048)
  [Layer 15] Residual connection sample values: [-0.18593355 -1.1914446  -0.27066523 -1.3955694   1.9354732 ]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02320829 -0.12433372 -0.03095153 -0.14618029  0.23206204]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02320829 -0.12433372 -0.03095153 -0.14618029  0.23206204]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02320829 -0.12433372 -0.03095153 -0.14618029  0.23206204]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.16069748  0.07319532  0.47476724  1.1465535  -0.29352796]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.16069748  0.07319532  0.47476724  1.1465535  -0.29352796]
  [FlaxMamba2] xBC (step) sample values: [ 0.7790512  -0.7829687   0.53318745  1.8585021   0.00516054]
  [FlaxMamba2] dt (step) sample values: [ 0.02763152  0.5608837   0.65832376 -0.20874006  1.2359321 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.8945974 1.6344718 0.647479  0.7790512 0.5627588]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.23398957 -0.14239916  0.10750576  0.44405788  0.00571982]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.19785675 -0.18353686  0.09437557  0.35165066 -0.03636392]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.1086834  -0.08337054  0.04941282  0.2064252  -0.01785141]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.1086834  -0.08337054  0.04941282  0.2064252  -0.01785141]
  [FlaxMamba2] B (step) sample values: [-0.1604921   0.1177271   0.10577809 -0.0759592   1.334027  ]
  [FlaxMamba2] C (step) sample values: [-0.21756552 -0.04751977 -0.21824802  1.0132174  -0.0553223 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6905513  -0.13480766 -1.3128716  -3.7739606  -1.2635014 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05866974 0.1160261  0.09216222 0.06001759 0.0781225 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.85397446 0.9844805  0.88603646 0.79731613 0.9060073 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.1086834  -0.08337054  0.04941282  0.2064252  -0.01785141]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00102337  0.00075068  0.00067449 -0.00048435  0.00850633]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00102337  0.00075068  0.00067449 -0.00048435  0.00850633]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00860371 -0.00151582  0.00101064 -0.00044228  0.00786811]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.06227789 -0.0332684  -0.00943926  0.0497187  -0.01518432]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.13222426 -0.08692394  0.0223618   0.18256965 -0.02667312]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.13222426 -0.08692394  0.0223618   0.18256965 -0.02667312]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01147585 -0.00329759  0.00654529  0.1588534   0.00334421]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.05063718 -0.01142155  0.02716928  0.5874904   0.01270435]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.05063718 -0.01142155  0.02716928  0.5874904   0.01270435]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.08796259  0.9377211   0.02534684  0.10400778 -2.0604513 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.08796259  0.9377211   0.02534684  0.10400778 -2.0604513 ]
  [Layer 16] Output shape after mixer: (1, 1, 2048)
  [Layer 16] Output sample values after mixer: [-0.08796259  0.9377211   0.02534684  0.10400778 -2.0604513 ]
  [Layer 16] Residual connection shape: (1, 1, 2048)
  [Layer 16] Residual connection sample values: [-0.27389613 -0.25372356 -0.24531838 -1.2915616  -0.12497807]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02887624 -0.022477   -0.02303863 -0.11218251 -0.01267705]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02887624 -0.022477   -0.02303863 -0.11218251 -0.01267705]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02887624 -0.022477   -0.02303863 -0.11218251 -0.01267705]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.16681512 -0.3452957  -0.6527113  -1.053418   -1.038945  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.16681512 -0.3452957  -0.6527113  -1.053418   -1.038945  ]
  [FlaxMamba2] xBC (step) sample values: [-0.35404056 -0.7616512   0.23514673 -1.1376157  -1.2454346 ]
  [FlaxMamba2] dt (step) sample values: [-0.21069081 -0.281642    0.5769901   1.0011295  -1.1012601 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.2048231  -1.2432877  -0.46844298 -0.35404056 -0.39280137]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.10322039  0.1441465  -0.06112966  0.0489854   0.21639037]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.1350197   0.11794716 -0.07548818  0.04358379  0.22902465]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06295918  0.06244743 -0.03632015  0.0222667   0.12756838]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06295918  0.06244743 -0.03632015  0.0222667   0.12756838]
  [FlaxMamba2] B (step) sample values: [-0.11166103  0.02776664 -0.05192826 -0.00571215  0.15079062]
  [FlaxMamba2] C (step) sample values: [-0.19266696  0.00320757 -0.12344917  0.02679675  0.05416689]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.1570504  -11.466768   -14.214988    -0.12863436 -14.242779  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00041588 0.0077525  0.03814496 0.05849538 0.00235396]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99951893 0.9149406  0.5814501  0.9925037  0.96702886]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06295918  0.06244743 -0.03632015  0.0222667   0.12756838]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.9236612e-06 -7.2702409e-07  1.3596564e-06  1.4956326e-07
 -3.9482052e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.9236612e-06 -7.2702409e-07  1.3596564e-06  1.4956326e-07
 -3.9482052e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-6.5723223e-05  8.3727959e-05  1.0768491e-04 -2.6195231e-04
  1.0410546e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.2957516e-04 -9.6266149e-07 -1.0373946e-04 -4.5872125e-06
  9.5357151e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04073542  0.04027483 -0.0235286   0.01435644  0.08237123]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04073542  0.04027483 -0.0235286   0.01435644  0.08237123]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00368038 -0.00576467  0.00525804 -0.00391043 -0.02236643]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.0301224  -0.0576267   0.03989531 -0.03613175 -0.20746829]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0301224  -0.0576267   0.03989531 -0.03613175 -0.20746829]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.06120605 -1.4298359  -0.1503017   0.6381466   1.0714908 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.06120605 -1.4298359  -0.1503017   0.6381466   1.0714908 ]
  [Layer 17] Output shape after mixer: (1, 1, 2048)
  [Layer 17] Output sample values after mixer: [-0.06120605 -1.4298359  -0.1503017   0.6381466   1.0714908 ]
  [Layer 17] Residual connection shape: (1, 1, 2048)
  [Layer 17] Residual connection sample values: [-0.33510217 -1.6835594  -0.39562008 -0.653415    0.9465127 ]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02891512 -0.12283414 -0.03052594 -0.04731595  0.07850436]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02891512 -0.12283414 -0.03052594 -0.04731595  0.07850436]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02891512 -0.12283414 -0.03052594 -0.04731595  0.07850436]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.4846824   0.01179923  0.24506906 -1.9850829  -0.55265784]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.4846824   0.01179923  0.24506906 -1.9850829  -0.55265784]
  [FlaxMamba2] xBC (step) sample values: [-0.91999096 -0.15726142  0.00602711 -0.7874982   2.0869536 ]
  [FlaxMamba2] dt (step) sample values: [ 0.23609443  0.47291046 -0.20670493  0.1860265   0.9229434 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.08378849  0.99266255 -0.02576631 -0.91999096 -0.11642445]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.20764156 -0.07949305 -0.00105897 -0.10270631  0.5652883 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.21765132 -0.3448739   0.2787262  -0.11653841  0.52320457]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.09702917 -0.1429937   0.15866041 -0.05487774  0.32851845]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09702917 -0.1429937   0.15866041 -0.05487774  0.32851845]
  [FlaxMamba2] B (step) sample values: [0.07196963 0.04662252 0.08077658 0.13951589 0.09957037]
  [FlaxMamba2] C (step) sample values: [-0.20902504  0.03260162  0.06637372 -0.12866157 -0.10622463]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3010656 -1.4685526 -1.2082934 -1.2128745 -2.5874777]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11965331 0.08617742 0.06013625 0.08864833 0.10449011]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.85583574 0.88112473 0.9299149  0.8980592  0.76310027]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09702917 -0.1429937   0.15866041 -0.05487774  0.32851845]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00083556 -0.00054128 -0.0009378  -0.00161976 -0.001156  ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00083556 -0.00054128 -0.0009378  -0.00161976 -0.001156  ]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00587604  0.00521107  0.00422699 -0.00035524  0.00101557]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01273786 -0.14325792  0.14051194 -0.07857947  0.00034871]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0060119  -0.17088978  0.17117122 -0.08918396  0.06383108]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0060119  -0.17088978  0.17117122 -0.08918396  0.06383108]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00164878 -0.00101413  0.02353168  0.02138225 -0.01288476]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.0118926  -0.00300414  0.12679265  0.14823563 -0.14058699]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0118926  -0.00300414  0.12679265  0.14823563 -0.14058699]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.1326872   0.81866974  1.5821092  -1.0155929  -1.0541718 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.1326872   0.81866974  1.5821092  -1.0155929  -1.0541718 ]
  [Layer 18] Output shape after mixer: (1, 1, 2048)
  [Layer 18] Output sample values after mixer: [-1.1326872   0.81866974  1.5821092  -1.0155929  -1.0541718 ]
  [Layer 18] Residual connection shape: (1, 1, 2048)
  [Layer 18] Residual connection sample values: [-1.4677894 -0.8648897  1.1864891 -1.669008  -0.1076591]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.11796948 -0.06000916  0.08901247 -0.11532168 -0.00863422]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.11796948 -0.06000916  0.08901247 -0.11532168 -0.00863422]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.11796948 -0.06000916  0.08901247 -0.11532168 -0.00863422]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.95773023  0.96350104  0.16814087 -0.6893841  -0.6378439 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.95773023  0.96350104  0.16814087 -0.6893841  -0.6378439 ]
  [FlaxMamba2] xBC (step) sample values: [-1.3337432   0.4218243  -0.47934332  0.7233896  -1.3484553 ]
  [FlaxMamba2] dt (step) sample values: [-0.36599877  0.3635662   0.9963539  -0.15368606  0.24165848]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.0870969  -0.6588937  -0.02575407 -1.3337432  -0.65387625]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.2570922  -0.03055122 -0.12260988  0.12383971  0.26258537]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.29273674 -0.05488899 -0.12761095  0.08123717  0.22962639]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.12509638 -0.02669149 -0.05973986  0.04226755  0.12793764]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.12509638 -0.02669149 -0.05973986  0.04226755  0.12793764]
  [FlaxMamba2] B (step) sample values: [-0.03829256  0.28831345  0.3229719   0.11826609 -0.03649997]
  [FlaxMamba2] C (step) sample values: [-0.2734515   0.02528824 -0.07002148 -0.07765745 -0.26789886]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9436172 -1.8178532 -2.0862153 -1.0006425 -0.9649832]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03808577 0.04116003 0.06139898 0.04410716 0.09090951]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.92864925 0.9279078  0.8797729  0.9568243  0.9160117 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.12509638 -0.02669149 -0.05973986  0.04226755  0.12793764]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00018244 -0.00137364 -0.00153876 -0.00056347  0.0001739 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00018244 -0.00137364 -0.00153876 -0.00056347  0.0001739 ]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00084643 -0.01851669 -0.00177506 -0.00195302  0.0007092 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01805594 -0.01562011 -0.00529054  0.00019814  0.00282495]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03212748 -0.01862251 -0.01201041  0.00495263  0.01721609]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03212748 -0.01862251 -0.01201041  0.00495263  0.01721609]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00853338 -0.01298741 -0.00109441 -0.00114094 -0.00379657]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.18898715 -0.3022666  -0.03267581 -0.0249213  -0.11797269]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.18898715 -0.3022666  -0.03267581 -0.0249213  -0.11797269]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.687833    0.12961158 -0.5138759  -0.35198185  0.14661647]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.687833    0.12961158 -0.5138759  -0.35198185  0.14661647]
  [Layer 19] Output shape after mixer: (1, 1, 2048)
  [Layer 19] Output sample values after mixer: [ 1.687833    0.12961158 -0.5138759  -0.35198185  0.14661647]
  [Layer 19] Residual connection shape: (1, 1, 2048)
  [Layer 19] Residual connection sample values: [ 0.22004354 -0.7352781   0.6726132  -2.02099     0.03895737]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01851762 -0.05304288  0.05195491 -0.14439726  0.00317902]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01851762 -0.05304288  0.05195491 -0.14439726  0.00317902]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01851762 -0.05304288  0.05195491 -0.14439726  0.00317902]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.26718995 -1.9069579  -0.35167563  0.5110619  -0.01222019]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.26718995 -1.9069579  -0.35167563  0.5110619  -0.01222019]
  [FlaxMamba2] xBC (step) sample values: [ 0.6735129  -0.50948113 -0.29237288  1.7617676   0.4259103 ]
  [FlaxMamba2] dt (step) sample values: [0.7417241  0.7943998  1.1939769  0.13663621 0.46731582]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.9065046  -0.48445582  0.03750836  0.6735129   0.89717627]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01531085 -0.02534634 -0.18969223 -0.06482868 -0.09031384]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.02317181 -0.01681667 -0.12316391 -0.08362751 -0.1177644 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01145168 -0.00833764 -0.05779441 -0.04006638 -0.05541909]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01145168 -0.00833764 -0.05779441 -0.04006638 -0.05541909]
  [FlaxMamba2] B (step) sample values: [-0.05265203  0.12649283  0.11374578 -0.10286053  0.32345527]
  [FlaxMamba2] C (step) sample values: [ 0.18549049 -0.19951242  0.13828202 -0.14873794  0.60357434]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.6215758 -5.0388985 -1.2056414 -1.6434968 -1.3345234]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06043283 0.02495306 0.02858919 0.05262935 0.04778485]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.90665215 0.8818477  0.96611893 0.91713905 0.93822074]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01145168 -0.00833764 -0.05779441 -0.04006638 -0.05541909]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.6438229e-05 -8.7540306e-05 -7.8718615e-05  7.1185394e-05
 -2.2384964e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.6438229e-05 -8.7540306e-05 -7.8718615e-05  7.1185394e-05
 -2.2384964e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00211602  0.00100367  0.00271836  0.00319442  0.00406776]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01439966  0.03074695 -0.01065386 -0.0250008   0.03091665]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01430843  0.03068052 -0.01111431 -0.02532     0.03047513]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01430843  0.03068052 -0.01111431 -0.02532     0.03047513]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0021654  -0.00756623  0.00161417 -0.00808827 -0.00018507]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.03062134 -0.11461022  0.03282439 -0.12444796 -0.00254413]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03062134 -0.11461022  0.03282439 -0.12444796 -0.00254413]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.2448206  -0.1427619   0.86866385 -1.0498512  -0.314829  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.2448206  -0.1427619   0.86866385 -1.0498512  -0.314829  ]
  [Layer 20] Output shape after mixer: (1, 1, 2048)
  [Layer 20] Output sample values after mixer: [ 1.2448206  -0.1427619   0.86866385 -1.0498512  -0.314829  ]
  [Layer 20] Residual connection shape: (1, 1, 2048)
  [Layer 20] Residual connection sample values: [ 1.4648641  -0.87804     1.541277   -3.070841   -0.27587163]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.08172078 -0.04445626  0.07402755 -0.14221475 -0.0143906 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.08172078 -0.04445626  0.07402755 -0.14221475 -0.0143906 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.08172078 -0.04445626  0.07402755 -0.14221475 -0.0143906 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.24088068 -0.5133339   0.38745236 -0.09564746 -0.00698706]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.24088068 -0.5133339   0.38745236 -0.09564746 -0.00698706]
  [FlaxMamba2] xBC (step) sample values: [ 1.1839298   0.42006326 -2.2819252  -0.1326618  -0.25094333]
  [FlaxMamba2] dt (step) sample values: [0.353033  2.2025616 1.1780329 0.6180488 2.9182239]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.65818185 -0.08383006  0.00513765  1.1839298  -0.2593016 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.18447119  0.11663671  0.29656363  0.03805977  0.02696554]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.21575171  0.08654638  0.31141806  0.03297859  0.0548586 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.09628359  0.04514459  0.17976026  0.01676117  0.02818148]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09628359  0.04514459  0.17976026  0.01676117  0.02818148]
  [FlaxMamba2] B (step) sample values: [-0.02028398  0.01242118  0.02190741  0.06230293  0.03805675]
  [FlaxMamba2] C (step) sample values: [-0.02748024 -0.04069958  0.02255784 -0.0775581  -0.16407391]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.2091806  -0.04342505 -3.8147197  -6.662431   -0.02279418]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08202275 0.03772998 0.09461594 0.04437156 0.13610223]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.76856834 0.9983629  0.69702554 0.7440683  0.99690247]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09628359  0.04514459  0.17976026  0.01676117  0.02818148]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.6019163e-04 -9.8095574e-05 -1.7301255e-04 -4.9203396e-04
 -3.0055107e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.6019163e-04 -9.8095574e-05 -1.7301255e-04 -4.9203396e-04
 -3.0055107e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.2999811e-05  2.5200796e-05 -3.6331036e-04 -6.7239581e-04
 -6.1242899e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00059482  0.00046664  0.00106706  0.00035334  0.0002064 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01749565  0.00839095  0.03262069  0.00329546  0.00515315]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01749565  0.00839095  0.03262069  0.00329546  0.00515315]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-2.3597514e-03 -1.6127285e-03  7.5286431e-03 -1.5006994e-04
 -1.7939778e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.18009551 -0.11302374  0.7012845  -0.01178886 -0.00126676]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.18009551 -0.11302374  0.7012845  -0.01178886 -0.00126676]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.57077456  0.5948041   0.1680296  -0.7108183   0.2923373 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.57077456  0.5948041   0.1680296  -0.7108183   0.2923373 ]
  [Layer 21] Output shape after mixer: (1, 1, 2048)
  [Layer 21] Output sample values after mixer: [-0.57077456  0.5948041   0.1680296  -0.7108183   0.2923373 ]
  [Layer 21] Residual connection shape: (1, 1, 2048)
  [Layer 21] Residual connection sample values: [ 0.8940896  -0.2832359   1.7093067  -3.7816594   0.01646566]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.07279776 -0.01942332  0.12421745 -0.2533019   0.00125691]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07279776 -0.01942332  0.12421745 -0.2533019   0.00125691]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.07279776 -0.01942332  0.12421745 -0.2533019   0.00125691]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.35457364  0.16479531  0.4552616  -0.86183906 -0.3584338 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.35457364  0.16479531  0.4552616  -0.86183906 -0.3584338 ]
  [FlaxMamba2] xBC (step) sample values: [-0.172494   -0.33807328  1.5188272  -0.6970011  -1.4117903 ]
  [FlaxMamba2] dt (step) sample values: [ 2.7274852   1.1237879  -0.652863   -0.16864227  2.014974  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.62286955  0.04268686 -0.6779828  -0.172494   -0.21440516]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.2966769  -0.08288769  0.22867091  0.10826596 -0.46373868]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.34434536 -0.16162303  0.54800683  0.06728085 -0.5294125 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.14281873 -0.07429519  0.34725714  0.03477168 -0.1962288 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.14281873 -0.07429519  0.34725714  0.03477168 -0.1962288 ]
  [FlaxMamba2] B (step) sample values: [ 0.05077947 -0.06920123 -0.00399902 -0.0715514  -0.05824274]
  [FlaxMamba2] C (step) sample values: [ 0.19315079  0.04568879 -0.16881482 -0.00567033 -0.03020968]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.1489344 -3.5005836 -2.8320918 -5.5395546 -1.7185895]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02016697 0.11976327 0.03292538 0.03897504 0.02125547]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9197334  0.6575455  0.9109678  0.80581236 0.96412975]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.14281873 -0.07429519  0.34725714  0.03477168 -0.1962288 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.4625612e-04  1.9931489e-04  1.1518059e-05  2.0608390e-04
  1.6775200e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.4625612e-04  1.9931489e-04  1.1518059e-05  2.0608390e-04
  1.6775200e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.1802642e-04  2.2901258e-04  1.8669205e-05  2.2483822e-04
  2.2393043e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00223171 -0.00019325  0.00493969  0.00048315 -0.00248848]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03682199 -0.01818733  0.08904435  0.00890475 -0.05001451]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03682199 -0.01818733  0.08904435  0.00890475 -0.05001451]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00538269 -0.0016218   0.02480507 -0.00227897  0.00737403]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.02977575 -0.02525667  0.22030964 -0.04979842  0.10580628]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02977575 -0.02525667  0.22030964 -0.04979842  0.10580628]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.6845798   0.8441711   0.10423635 -1.0303873  -1.1604353 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.6845798   0.8441711   0.10423635 -1.0303873  -1.1604353 ]
  [Layer 22] Output shape after mixer: (1, 1, 2048)
  [Layer 22] Output sample values after mixer: [-0.6845798   0.8441711   0.10423635 -1.0303873  -1.1604353 ]
  [Layer 22] Residual connection shape: (1, 1, 2048)
  [Layer 22] Residual connection sample values: [ 0.20950979  0.5609352   1.8135431  -4.8120465  -1.1439697 ]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01104057  0.02543248  0.0874903  -0.21932372 -0.05841855]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01104057  0.02543248  0.0874903  -0.21932372 -0.05841855]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01104057  0.02543248  0.0874903  -0.21932372 -0.05841855]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.01981751 -0.50498927 -0.31580865  0.40701097 -0.0709343 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.01981751 -0.50498927 -0.31580865  0.40701097 -0.0709343 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.0781335   0.09437992  0.22403131 -0.03208283  0.6033123 ]
  [FlaxMamba2] dt (step) sample values: [1.5697471  0.831032   2.8422322  0.30998492 1.1010957 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.7503175 -1.093606   0.5952018  1.0781335  0.2686147]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.39545733  0.07106832  0.1012683  -0.00089181 -0.2850431 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.37308794  0.03795675  0.08991576 -0.00305284 -0.33442053]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.22094452  0.01933851  0.04697773 -0.00152409 -0.13950868]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.22094452  0.01933851  0.04697773 -0.00152409 -0.13950868]
  [FlaxMamba2] B (step) sample values: [ 0.07759818  0.05434057  0.17398545  0.01584615 -0.13007312]
  [FlaxMamba2] C (step) sample values: [ 0.08401277  0.07534277  0.24198718 -0.14812653 -0.02632453]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.08112868 -3.7998476  -0.08256738 -0.48783726 -1.4532163 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05569216 0.09627575 0.16468206 0.00198476 0.00311491]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.995492   0.69361854 0.98649466 0.9990322  0.9954836 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.22094452  0.01933851  0.04697773 -0.00152409 -0.13950868]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00095484  0.00066865  0.00214087  0.00019498 -0.00160053]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00095484  0.00066865  0.00214087  0.00019498 -0.00160053]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.2458410e-03  1.1840574e-03 -7.6739839e-04  9.1799862e-05
 -8.9162338e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00098315 -0.00326218  0.00225708 -0.00072998 -0.0018081 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00373029 -0.00367473  0.0012549  -0.00069746  0.00116806]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00373029 -0.00367473  0.0012549  -0.00069746  0.00116806]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 3.6596317e-05  6.9842750e-04 -1.6712220e-04 -1.7043075e-04
 -3.9959104e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.0064224   0.01554963 -0.00653466 -0.01069131 -0.00734472]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0064224   0.01554963 -0.00653466 -0.01069131 -0.00734472]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.57356954 -1.9277439  -0.4666269  -0.07133343  1.9250662 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.57356954 -1.9277439  -0.4666269  -0.07133343  1.9250662 ]
  [Layer 23] Output shape after mixer: (1, 1, 2048)
  [Layer 23] Output sample values after mixer: [ 0.57356954 -1.9277439  -0.4666269  -0.07133343  1.9250662 ]
  [Layer 23] Residual connection shape: (1, 1, 2048)
  [Layer 23] Residual connection sample values: [ 0.7830793 -1.3668087  1.3469162 -4.88338    0.7810966]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03149664 -0.05245332  0.04995035 -0.17470296  0.03046574]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03149664 -0.05245332  0.04995035 -0.17470296  0.03046574]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03149664 -0.05245332  0.04995035 -0.17470296  0.03046574]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.13477175  0.05314662  0.11695061  0.07952778 -0.20812117]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.13477175  0.05314662  0.11695061  0.07952778 -0.20812117]
  [FlaxMamba2] xBC (step) sample values: [-0.42032832 -0.44802055  0.5168125   0.1241068  -0.70130885]
  [FlaxMamba2] dt (step) sample values: [ 3.0235944  -0.1708422  -0.3728723   2.2897475   0.01217876]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.5737442  -0.05577047  0.12918073 -0.42032832 -0.17116855]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.08096759 -0.08983994  0.06764375  0.0364051  -0.33086482]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0776221  -0.08984905  0.06368409  0.03478767 -0.33559886]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.04031659 -0.04290767  0.03285562  0.01769635 -0.1399041 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04031659 -0.04290767  0.03285562  0.01769635 -0.1399041 ]
  [FlaxMamba2] B (step) sample values: [-0.09012907  0.00659392 -0.01281547 -0.01057442 -0.07673973]
  [FlaxMamba2] C (step) sample values: [-0.2145759  -0.22572435 -0.25386044 -0.27387726  0.10752695]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.07415762 -3.4496791  -3.2884939  -0.16087165 -2.6944954 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10754166 0.02456125 0.03170544 0.04436391 0.02186231]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99205667 0.9187618  0.90098816 0.9928885  0.9427936 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04031659 -0.04290767  0.03285562  0.01769635 -0.1399041 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.9077376e-04  2.8589338e-05 -5.5564178e-05 -4.5847635e-05
 -3.3272142e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.9077376e-04  2.8589338e-05 -5.5564178e-05 -4.5847635e-05
 -3.3272142e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.4146565e-04  5.7720440e-04 -2.6022528e-05 -1.1185520e-04
  3.6062897e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0003972  -0.00144853  0.0012347  -0.00112068 -0.00563638]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00018257 -0.0012201   0.00105979 -0.00121489 -0.00489158]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00018257 -0.0012201   0.00105979 -0.00121489 -0.00489158]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-1.1474935e-05 -3.3283548e-05  6.5590983e-05 -5.0228715e-05
  4.5624241e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00072869 -0.00299417  0.00532853 -0.01488617  0.07999253]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00072869 -0.00299417  0.00532853 -0.01488617  0.07999253]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.00422518  0.81340396 -1.1086693   2.6689348   0.80124927]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.00422518  0.81340396 -1.1086693   2.6689348   0.80124927]
  [Layer 24] Output shape after mixer: (1, 1, 2048)
  [Layer 24] Output sample values after mixer: [ 0.00422518  0.81340396 -1.1086693   2.6689348   0.80124927]
  [Layer 24] Residual connection shape: (1, 1, 2048)
  [Layer 24] Residual connection sample values: [ 0.7873045  -0.5534047   0.23824692 -2.214445    1.5823458 ]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03345243 -0.02149197  0.00955929 -0.08307166  0.06651775]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03345243 -0.02149197  0.00955929 -0.08307166  0.06651775]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03345243 -0.02149197  0.00955929 -0.08307166  0.06651775]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.09780353  0.23919295 -0.39452785  0.41718376  0.03572543]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.09780353  0.23919295 -0.39452785  0.41718376  0.03572543]
  [FlaxMamba2] xBC (step) sample values: [ 1.575577   -1.016383    0.55047673 -1.044797   -0.89922965]
  [FlaxMamba2] dt (step) sample values: [ 0.00638674 -1.6357819   0.3497786   0.31134716 -1.3776431 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.5970689   0.06107979 -0.11417346  1.575577   -0.36369836]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.05098988 -0.07048582  0.05539032  0.09204258  0.05336116]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04843594 -0.09869932  0.04397675  0.15286411  0.04759715]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02480436 -0.04691625  0.02247178  0.08226257  0.02436484]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02480436 -0.04691625  0.02247178  0.08226257  0.02436484]
  [FlaxMamba2] B (step) sample values: [-0.05351995 -0.02161275  0.00991627 -0.05564956 -0.03394897]
  [FlaxMamba2] C (step) sample values: [-0.02220558 -0.02968522 -0.06015995 -0.11826207 -0.1483029 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -0.37022203  -1.5044799   -5.7209826   -0.81757224 -14.66622   ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.13801324 0.00124679 0.03696924 0.00959437 0.0083286 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.95018786 0.998126   0.80936897 0.9921866  0.88501644]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02480436 -0.04691625  0.02247178  0.08226257  0.02436484]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.83216500e-04 -7.39876050e-05  3.39466751e-05 -1.90506835e-04
 -1.16218565e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.83216500e-04 -7.39876050e-05  3.39466751e-05 -1.90506835e-04
 -1.16218565e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00506069 -0.00273139 -0.00050817  0.00119983  0.00178716]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00607974 -0.00320324  0.00689113  0.00319093  0.00786796]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00633887 -0.00369337  0.00712589  0.00405032  0.0081225 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00633887 -0.00369337  0.00712589  0.00405032  0.0081225 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00029484 -0.00049429 -0.00113193  0.00101858  0.00014768]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.01869949 -0.02141543 -0.0791693   0.04249721  0.01349199]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01869949 -0.02141543 -0.0791693   0.04249721  0.01349199]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.2460356  -1.7600673   0.06390481 -1.1130594  -1.4462057 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.2460356  -1.7600673   0.06390481 -1.1130594  -1.4462057 ]
  [Layer 25] Output shape after mixer: (1, 1, 2048)
  [Layer 25] Output sample values after mixer: [-1.2460356  -1.7600673   0.06390481 -1.1130594  -1.4462057 ]
  [Layer 25] Residual connection shape: (1, 1, 2048)
  [Layer 25] Residual connection sample values: [-0.45873106 -2.313472    0.30215174 -3.3275046   0.13614011]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02316544 -0.1081028   0.01421537 -0.1535717   0.00672264]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02316544 -0.1081028   0.01421537 -0.1535717   0.00672264]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02316544 -0.1081028   0.01421537 -0.1535717   0.00672264]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.7279792  -1.2263006  -2.0534594   0.925992    0.83028585]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.7279792  -1.2263006  -2.0534594   0.925992    0.83028585]
  [FlaxMamba2] xBC (step) sample values: [-1.1610427  -0.12937698  0.3055054  -0.5404331   0.20255761]
  [FlaxMamba2] dt (step) sample values: [ 0.47041196  0.5686102   0.06518976 -0.9440707   1.4523078 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.1812847   0.8584322   0.5639119  -1.1610427  -0.00365034]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.6670296   0.08851526  0.01681866  0.10745159 -0.07081108]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.7555306   0.03245447  0.08096661  0.08050457 -0.06270103]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.24148072  0.01649053  0.04212131  0.04187165 -0.03036798]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.24148072  0.01649053  0.04212131  0.04187165 -0.03036798]
  [FlaxMamba2] B (step) sample values: [-0.02287456  0.00087968  0.00770681  0.03467703  0.00428684]
  [FlaxMamba2] C (step) sample values: [-1.1362136e-01  1.0336680e-02  3.3984886e-04  6.5055698e-01
  1.1679565e-01]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9594627  -0.39448437 -0.84198165 -1.4275463  -0.14661841]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08941452 0.18565652 0.0666336  0.04321628 0.04602342]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.917787   0.92937905 0.94544053 0.94017124 0.9932748 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.24148072  0.01649053  0.04212131  0.04187165 -0.03036798]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.9390481e-04 -1.8993966e-05 -1.6640447e-04 -7.4874237e-04
 -9.2560847e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.9390481e-04 -1.8993966e-05 -1.6640447e-04 -7.4874237e-04
 -9.2560847e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00315545 -0.00118521 -0.00210707 -0.00049782 -0.00290591]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00961537  0.00705983  0.00520026  0.00153015  0.00487227]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04037635  0.00916047  0.01056588  0.00686396  0.00100385]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04037635  0.00916047  0.01056588  0.00686396  0.00100385]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01982161 -0.00254809 -0.00246697  0.00455254  0.00058045]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.25026953 -0.07144536 -0.05885927  0.16536948  0.0184079 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.25026953 -0.07144536 -0.05885927  0.16536948  0.0184079 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.7338054   0.05924919  1.4057729  -1.2037735   1.5033724 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.7338054   0.05924919  1.4057729  -1.2037735   1.5033724 ]
  [Layer 26] Output shape after mixer: (1, 1, 2048)
  [Layer 26] Output sample values after mixer: [-2.7338054   0.05924919  1.4057729  -1.2037735   1.5033724 ]
  [Layer 26] Residual connection shape: (1, 1, 2048)
  [Layer 26] Residual connection sample values: [-3.1925364 -2.2542229  1.7079246 -4.531278   1.6395125]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.16825113 -0.10840391  0.08811949 -0.21470131  0.08988297]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.16825113 -0.10840391  0.08811949 -0.21470131  0.08988297]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.16825113 -0.10840391  0.08811949 -0.21470131  0.08988297]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.66976076 -1.3666626  -1.5653161   0.01246105  1.1743699 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.66976076 -1.3666626  -1.5653161   0.01246105  1.1743699 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.5273738  -0.67309254 -0.7319303   0.6465417  -1.2052805 ]
  [FlaxMamba2] dt (step) sample values: [0.68029684 0.37394494 0.6799878  0.7740983  0.8439839 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.3849553  -0.31111884 -0.23419484  0.5273738   0.9141894 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06124502  0.0201546  -0.16836002 -0.06462795  0.07447964]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03524404 -0.01634443 -0.17836979 -0.26653224  0.04469448]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01793252 -0.00810543 -0.08125197 -0.11561066  0.02284656]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01793252 -0.00810543 -0.08125197 -0.11561066  0.02284656]
  [FlaxMamba2] B (step) sample values: [ 0.3530362  -0.09638265 -0.10540637  0.0621395  -0.0067522 ]
  [FlaxMamba2] C (step) sample values: [-0.11570472 -0.2672859   0.00193807 -0.10753131 -0.25774395]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3661706 -1.3799144 -1.8267511 -2.0408754 -2.3490334]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08180141 0.06765877 0.09391331 0.03593815 0.10191868]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8942636  0.9108625  0.84235287 0.9292799  0.78709185]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01793252 -0.00810543 -0.08125197 -0.11561066  0.02284656]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.1787082e-04 -1.4138425e-04 -1.5462120e-04  9.1152790e-05
 -9.9048348e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.1787082e-04 -1.4138425e-04 -1.5462120e-04  9.1152790e-05
 -9.9048348e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00029269  0.00233169  0.00376254 -0.00175652  0.00046067]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02104647 -0.01149013 -0.00992527 -0.05640528  0.01818595]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01923285 -0.01230988 -0.01814276 -0.06809766  0.02049655]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01923285 -0.01230988 -0.01814276 -0.06809766  0.02049655]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00436101  0.00341785  0.00490979 -0.00042693  0.0183883 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.06558309  0.03737056  0.09271039 -0.00725393  0.19212095]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.06558309  0.03737056  0.09271039 -0.00725393  0.19212095]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-5.0758615  -1.0240637   1.0852681   0.01428319 -0.09448186]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-5.0758615  -1.0240637   1.0852681   0.01428319 -0.09448186]
  [Layer 27] Output shape after mixer: (1, 1, 2048)
  [Layer 27] Output sample values after mixer: [-5.0758615  -1.0240637   1.0852681   0.01428319 -0.09448186]
  [Layer 27] Residual connection shape: (1, 1, 2048)
  [Layer 27] Residual connection sample values: [-8.268398  -3.2782865  2.7931929 -4.516995   1.5450307]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.38439605 -0.14260073  0.12274922 -0.19294709  0.07109388]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.38439605 -0.14260073  0.12274922 -0.19294709  0.07109388]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.38439605 -0.14260073  0.12274922 -0.19294709  0.07109388]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.7522973  -0.1227207   0.23567079 -0.51586324 -0.87939334]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.7522973  -0.1227207   0.23567079 -0.51586324 -0.87939334]
  [FlaxMamba2] xBC (step) sample values: [ 0.11472865 -0.836338   -0.46284884 -0.03720131  0.11767876]
  [FlaxMamba2] dt (step) sample values: [ 1.783227   -0.8174627  -0.23011221  1.0237912   0.73312634]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.4833286  -1.1665969  -0.27866125  0.11472865 -1.6980083 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.08588605  0.23672292 -0.12870228 -0.03307813 -0.03996271]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.14365582  0.22536275 -0.14236653 -0.04445356  0.06471258]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06667752  0.12532501 -0.06612474 -0.02173283  0.03340286]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06667752  0.12532501 -0.06612474 -0.02173283  0.03340286]
  [FlaxMamba2] B (step) sample values: [-0.06040666 -0.02116662  0.0279085  -0.03892131  0.22109868]
  [FlaxMamba2] C (step) sample values: [-0.2105724  -0.01353531  0.42898145 -0.14755228  0.37634948]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2727895 -3.997792  -2.517685  -2.1714401 -2.8654757]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05910141 0.0196658  0.0333358  0.04696389 0.03147897]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.927536   0.9243913  0.9194965  0.9030483  0.91374636]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06667752  0.12532501 -0.06612474 -0.02173283  0.03340286]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.3804668e-04  8.3412058e-05 -1.0998000e-04  1.5337858e-04
 -8.7129138e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.3804668e-04  8.3412058e-05 -1.0998000e-04  1.5337858e-04
 -8.7129138e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.2505966e-04  2.7902424e-06 -7.7721255e-05  4.2950962e-04
 -6.4448098e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00115881  0.01172108 -0.00290458 -0.00464336  0.00513542]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01561267  0.03888811 -0.01723862 -0.00935445  0.01237624]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01561267  0.03888811 -0.01723862 -0.00935445  0.01237624]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00376229 -0.00223995 -0.00226958  0.00180391 -0.00319219]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.14863974 -0.05864926 -0.05629507  0.05166974 -0.08869802]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.14863974 -0.05864926 -0.05629507  0.05166974 -0.08869802]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.5756829  -1.4097539   2.2738607  -0.56753767 -1.5896583 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.5756829  -1.4097539   2.2738607  -0.56753767 -1.5896583 ]
  [Layer 28] Output shape after mixer: (1, 1, 2048)
  [Layer 28] Output sample values after mixer: [ 2.5756829  -1.4097539   2.2738607  -0.56753767 -1.5896583 ]
  [Layer 28] Residual connection shape: (1, 1, 2048)
  [Layer 28] Residual connection sample values: [-5.6927156  -4.6880403   5.067054   -5.0845327  -0.04462755]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.21873504 -0.17228012  0.18645442 -0.18018635 -0.00170501]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.21873504 -0.17228012  0.18645442 -0.18018635 -0.00170501]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.21873504 -0.17228012  0.18645442 -0.18018635 -0.00170501]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.2780712  -0.87403715  0.12605122 -0.35063988 -0.3966995 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.2780712  -0.87403715  0.12605122 -0.35063988 -0.3966995 ]
  [FlaxMamba2] xBC (step) sample values: [-4.2566440e-01 -3.7953055e-01  1.0583744e-01  3.4574326e-04
 -2.1192245e+00]
  [FlaxMamba2] dt (step) sample values: [2.8958297  0.42656296 0.6632533  2.7775357  0.6621997 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.40778008 -1.7794938  -0.6524618  -0.4256644  -0.437087  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.08559139  0.09917811 -0.02356881  0.02837221 -0.2341087 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.07218654  0.06466272 -0.02072114 -0.0320526  -0.34720683]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.03739543  0.03337631 -0.01025323 -0.01576948 -0.14376442]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03739543  0.03337631 -0.01025323 -0.01576948 -0.14376442]
  [FlaxMamba2] B (step) sample values: [ 0.01704733  0.0285903  -0.063949   -0.07680781  0.12980819]
  [FlaxMamba2] C (step) sample values: [-0.2782932  -0.27374935 -0.13566372 -0.17804924 -0.15220861]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8072329  -2.117      -1.925669   -0.29044876 -2.049864  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.32808274 0.07476004 0.12002947 0.02501887 0.11837479]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.55270994 0.85362184 0.7936307  0.99275964 0.78454435]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03739543  0.03337631 -0.01025323 -0.01576948 -0.14376442]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00020915  0.00035077 -0.00078458 -0.00094234  0.00159259]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00020915  0.00035077 -0.00078458 -0.00094234  0.00159259]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00045293  0.00048192 -0.00126983 -0.00055236  0.00195822]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01026881  0.00333636 -0.01065809  0.00627551 -0.04493471]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.04850672  0.0374646  -0.02114231 -0.00984924 -0.19193801]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.04850672  0.0374646  -0.02114231 -0.00984924 -0.19193801]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.04848764 -0.00964075 -0.00141638  0.0014271   0.03061701]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.33650836 -0.06296486 -0.01465691  0.01324682  0.25213578]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.33650836 -0.06296486 -0.01465691  0.01324682  0.25213578]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.5539007  -2.5189362  -1.8895004   0.9590596  -0.87117654]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.5539007  -2.5189362  -1.8895004   0.9590596  -0.87117654]
  [Layer 29] Output shape after mixer: (1, 1, 2048)
  [Layer 29] Output sample values after mixer: [-2.5539007  -2.5189362  -1.8895004   0.9590596  -0.87117654]
  [Layer 29] Residual connection shape: (1, 1, 2048)
  [Layer 29] Residual connection sample values: [-8.246616  -7.2069764  3.1775534 -4.125473  -0.9158041]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.3209953  -0.27602395  0.12084782 -0.1479674  -0.03662832]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.3209953  -0.27602395  0.12084782 -0.1479674  -0.03662832]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.3209953  -0.27602395  0.12084782 -0.1479674  -0.03662832]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.61414385 -1.0966793  -0.31963453 -0.4329849  -0.413296  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.61414385 -1.0966793  -0.31963453 -0.4329849  -0.413296  ]
  [FlaxMamba2] xBC (step) sample values: [ 1.1810967  -1.3214791  -0.17922185 -0.09980366  0.8313982 ]
  [FlaxMamba2] dt (step) sample values: [2.1883452 1.3976487 0.4698785 1.4756154 1.322182 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.0086272   0.4020718   0.9596449   1.1810967  -0.65109116]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.1895478  -0.18154556 -0.07963546  0.00250394 -0.20004758]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.1662629  -0.16784316 -0.04649337 -0.01563876 -0.22739133]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.09002641 -0.07689524 -0.02270637 -0.00775824 -0.10082437]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.09002641 -0.07689524 -0.02270637 -0.00775824 -0.10082437]
  [FlaxMamba2] B (step) sample values: [ 0.02759448 -0.01681717  0.02349599  0.18506642 -0.01967403]
  [FlaxMamba2] C (step) sample values: [-0.2705122  -0.27403653  0.36631542 -0.22819014 -0.19727783]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0149885  -0.4675477  -0.42799968 -0.7895216  -0.4174731 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03499188 0.36760005 0.35661307 0.2232599  0.34384844]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.96510696 0.84208816 0.8584471  0.83839285 0.86627966]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.09002641 -0.07689524 -0.02270637 -0.00775824 -0.10082437]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.6927961e-05 -5.2977332e-05  7.4016913e-05  5.8299495e-04
 -6.1976993e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.6927961e-05 -5.2977332e-05  7.4016913e-05  5.8299495e-04
 -6.1976993e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 8.6527166e-04 -3.1459738e-05  7.6112919e-05  1.9632475e-03
 -1.3916849e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0039835  -0.00180082 -0.00317552 -0.00186744 -0.00286402]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.1148892  -0.09652992 -0.03114805 -0.011425   -0.12707199]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.1148892  -0.09652992 -0.03114805 -0.011425   -0.12707199]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02477411  0.02650398  0.00418913  0.00194616  0.02090872]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.2287078   0.24833427  0.02382902  0.01491505  0.1424073 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.2287078   0.24833427  0.02382902  0.01491505  0.1424073 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.7066419 -0.5364102  2.1819527 -0.672586   1.1817055]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.7066419 -0.5364102  2.1819527 -0.672586   1.1817055]
  [Layer 30] Output shape after mixer: (1, 1, 2048)
  [Layer 30] Output sample values after mixer: [ 1.7066419 -0.5364102  2.1819527 -0.672586   1.1817055]
  [Layer 30] Residual connection shape: (1, 1, 2048)
  [Layer 30] Residual connection sample values: [-6.539974  -7.7433867  5.359506  -4.798059   0.2659014]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.2418831  -0.28098497  0.19504789 -0.16994527  0.00993572]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.2418831  -0.28098497  0.19504789 -0.16994527  0.00993572]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.2418831  -0.28098497  0.19504789 -0.16994527  0.00993572]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.3222214   0.44680145 -0.56466514 -0.30322573 -0.14827476]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.3222214   0.44680145 -0.56466514 -0.30322573 -0.14827476]
  [FlaxMamba2] xBC (step) sample values: [ 0.4075005  -0.13087286 -0.26039833 -1.1924748  -1.9379652 ]
  [FlaxMamba2] dt (step) sample values: [ 0.18200913 -0.4091041   1.8075444   0.53822595  0.5307329 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.6666407 -0.7321551 -1.1307228  0.4075005 -0.9495533]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.07203768  0.0139794  -0.04247758  0.19346079  0.36278725]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.07154225  0.00365683 -0.04146287  0.19156298  0.35748482]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.03705015  0.00183176 -0.0203017   0.10492763  0.2103553 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03705015  0.00183176 -0.0203017   0.10492763  0.2103553 ]
  [FlaxMamba2] B (step) sample values: [0.07642323 0.04898551 0.07654732 0.05329108 0.00057954]
  [FlaxMamba2] C (step) sample values: [-0.0498417  -0.2180083  -0.27581266 -0.06603303 -0.26350865]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.9477868 -3.5383902 -4.705952  -2.462968  -0.9027082]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03946584 0.01514441 0.09257596 0.10031307 0.06963803]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8901753  0.94782364 0.6468389  0.78108764 0.9390723 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03705015  0.00183176 -0.0203017   0.10492763  0.2103553 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [1.11747206e-04 7.16273644e-05 1.11928653e-04 7.79230322e-05
 8.47412082e-07]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [1.11747206e-04 7.16273644e-05 1.11928653e-04 7.79230322e-05
 8.47412082e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0024977   0.00078925 -0.00023204  0.00220514  0.00049711]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01442146  0.00588532 -0.00513207  0.00373392  0.01846615]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01106965  0.0071456  -0.01909997  0.07592586  0.16319406]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01106965  0.0071456  -0.01909997  0.07592586  0.16319406]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00206831  0.00194714  0.00390926 -0.00977932 -0.01120345]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.02509923  0.02064149  0.03690251 -0.09825709 -0.133394  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02509923  0.02064149  0.03690251 -0.09825709 -0.133394  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.1575372   2.9140356  -2.463599   -0.09036157 -0.23495649]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.1575372   2.9140356  -2.463599   -0.09036157 -0.23495649]
  [Layer 31] Output shape after mixer: (1, 1, 2048)
  [Layer 31] Output sample values after mixer: [-2.1575372   2.9140356  -2.463599   -0.09036157 -0.23495649]
  [Layer 31] Residual connection shape: (1, 1, 2048)
  [Layer 31] Residual connection sample values: [-8.697512  -4.8293514  2.8959072 -4.8884206  0.0309449]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.32923216 -0.18359505  0.10979743 -0.17359728  0.001218  ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.32923216 -0.18359505  0.10979743 -0.17359728  0.001218  ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.32923216 -0.18359505  0.10979743 -0.17359728  0.001218  ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.26701358  1.7944353  -3.408071   -0.2836074  -1.0539874 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.26701358  1.7944353  -3.408071   -0.2836074  -1.0539874 ]
  [FlaxMamba2] xBC (step) sample values: [-0.92954063  1.4687666  -0.69136095 -0.27795267  1.1739006 ]
  [FlaxMamba2] dt (step) sample values: [-0.5178313   0.99399763  1.1025665   0.9327322   1.041867  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.19899184  0.16980265 -0.18697533 -0.92954063  0.3345535 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.03735531  0.14037605  0.22444518  0.04431579 -0.03717979]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.07452572  0.08834358  0.20860656  0.05679748 -0.04415306]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.03865074  0.04612167  0.11514317  0.02920501 -0.02158924]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03865074  0.04612167  0.11514317  0.02920501 -0.02158924]
  [FlaxMamba2] B (step) sample values: [-0.03756497 -0.04435631 -0.02091367 -0.03207     0.08033717]
  [FlaxMamba2] C (step) sample values: [-0.27834088 -0.27765682 -0.0904248  -0.25978208 -0.22056076]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6970906 -2.0892735 -1.7966746 -1.3893797 -1.0395182]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0472956  0.01463606 0.31300652 0.23857608 0.3972825 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9675682  0.96988404 0.5698564  0.7178657  0.6616739 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03865074  0.04612167  0.11514317  0.02920501 -0.02158924]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.8669142e-05 -8.1083781e-05 -3.8230399e-05 -5.8624279e-05
  1.4685714e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.8669142e-05 -8.1083781e-05 -3.8230399e-05 -5.8624279e-05
  1.4685714e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00210972  0.0025386  -0.00012383 -0.00380231 -0.00161138]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.03160908 -0.03268819 -0.00927097 -0.05219974 -0.04981438]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.04088046 -0.02162471  0.0183491  -0.04519416 -0.05499312]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.04088046 -0.02162471  0.0183491  -0.04519416 -0.05499312]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00618218 -0.0332734  -0.00200388  0.00550596  0.01498088]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.03634536 -0.15735708 -0.01840477  0.04139183  0.09210571]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03634536 -0.15735708 -0.01840477  0.04139183  0.09210571]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 4.781951   -0.31688982 -4.448974    0.21310936  0.27546093]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 4.781951   -0.31688982 -4.448974    0.21310936  0.27546093]
  [Layer 32] Output shape after mixer: (1, 1, 2048)
  [Layer 32] Output sample values after mixer: [ 4.781951   -0.31688982 -4.448974    0.21310936  0.27546093]
  [Layer 32] Residual connection shape: (1, 1, 2048)
  [Layer 32] Residual connection sample values: [-3.9155607  -5.146241   -1.553067   -4.675311    0.30640584]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.13743305 -0.18718025 -0.0555282  -0.16231415  0.01113909]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.13743305 -0.18718025 -0.0555282  -0.16231415  0.01113909]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.13743305 -0.18718025 -0.0555282  -0.16231415  0.01113909]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.47138172  0.9789204   2.511367   -0.91537434 -0.5974888 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.47138172  0.9789204   2.511367   -0.91537434 -0.5974888 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.4796238  -1.0333188   0.6729877  -1.7224746   0.57312167]
  [FlaxMamba2] dt (step) sample values: [-1.2196943  0.3853261  0.9212914  2.234993   0.4392464]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.7821941   0.4439851   0.24129574  1.4796238  -2.0370526 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.2249507  -0.21782091 -0.14906365 -0.3318251  -0.10231081]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.21180525 -0.26719835 -0.1222387  -0.3330315  -0.10350004]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.11707625 -0.11585587 -0.05738841 -0.13904172 -0.04907434]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.11707625 -0.11585587 -0.05738841 -0.13904172 -0.04907434]
  [FlaxMamba2] B (step) sample values: [-0.23294625  0.10183089 -0.04459728 -0.11022259  0.05691179]
  [FlaxMamba2] C (step) sample values: [-0.01559252 -0.08503409 -0.1879883  -0.22202261  0.51412994]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9790505  -9.693779   -6.1677613  -0.11351943 -2.090294  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00348622 0.01464628 0.03223466 0.07349249 0.00445137]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99312437 0.8676405  0.81970096 0.9916919  0.99073845]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.11707625 -0.11585587 -0.05738841 -0.13904172 -0.04907434]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.5077790e-05  4.1562620e-05 -1.8202529e-05 -4.4987715e-05
  2.3228735e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.5077790e-05  4.1562620e-05 -1.8202529e-05 -4.4987715e-05
  2.3228735e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.3196704e-04  1.0700119e-04 -9.5091687e-05 -6.5485103e-05
  8.2106228e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 3.2224294e-04 -5.9400144e-04  5.2635442e-05 -8.1614353e-04
 -5.6118786e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.1222304  -0.12123141 -0.05970428 -0.14559631 -0.0516609 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.1222304  -0.12123141 -0.05970428 -0.14559631 -0.0516609 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02214166 -0.0862648  -0.13868415  0.03810354  0.0109552 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.22245507 -0.5165315  -1.0463648   0.2807861   0.09136461]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.22245507 -0.5165315  -1.0463648   0.2807861   0.09136461]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.76767635  0.32447228 -0.8572704  -0.19642866  4.566535  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.76767635  0.32447228 -0.8572704  -0.19642866  4.566535  ]
  [Layer 33] Output shape after mixer: (1, 1, 2048)
  [Layer 33] Output sample values after mixer: [ 0.76767635  0.32447228 -0.8572704  -0.19642866  4.566535  ]
  [Layer 33] Residual connection shape: (1, 1, 2048)
  [Layer 33] Residual connection sample values: [-3.1478844 -4.8217688 -2.4103374 -4.87174    4.872941 ]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.08690409 -0.14104481 -0.06650036 -0.13560282  0.14109239]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.08690409 -0.14104481 -0.06650036 -0.13560282  0.14109239]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.08690409 -0.14104481 -0.06650036 -0.13560282  0.14109239]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.6186929  -0.04194176 -1.3448064  -0.19305795  1.4958912 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.6186929  -0.04194176 -1.3448064  -0.19305795  1.4958912 ]
  [FlaxMamba2] xBC (step) sample values: [-0.24101172 -0.3326057  -0.10617951 -1.2701516  -1.4115754 ]
  [FlaxMamba2] dt (step) sample values: [1.6954188  0.09299571 3.4723938  2.7844794  2.4847984 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.25822285 -0.770059    0.51194197 -0.24101172 -0.94799554]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04457467  0.08017974 -0.00050892  0.30728057 -0.2855862 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0126838   0.10621123 -0.01244892  0.2677603  -0.2941235 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00638212  0.05592318 -0.00618572  0.15169773 -0.12558918]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00638212  0.05592318 -0.00618572  0.15169773 -0.12558918]
  [FlaxMamba2] B (step) sample values: [-0.10595013  0.02947627  0.04097327  0.02997931  0.00037559]
  [FlaxMamba2] C (step) sample values: [ 0.00427872 -0.21954128 -0.2356617  -0.22498076 -0.20776056]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.5610816  -2.4810736  -2.893596   -0.01585086 -0.02613366]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.25633588 0.03554559 0.26521713 0.2107428  0.08635283]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.51866496 0.91558576 0.46420398 0.9966651  0.9977458 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00638212  0.05592318 -0.00618572  0.15169773 -0.12558918]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.7333085e-04  4.8222188e-05  6.7030895e-05  4.9045149e-05
  6.1445667e-07]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.7333085e-04  4.8222188e-05  6.7030895e-05  4.9045149e-05
  6.1445667e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.6320183e-04  2.8132918e-04  4.4488866e-04  3.3522642e-04
 -8.3029830e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00054809  0.00353789 -0.00046333  0.00928369 -0.00746642]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00447911  0.03798338 -0.00427338  0.10272086 -0.08482222]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00447911  0.03798338 -0.00427338  0.10272086 -0.08482222]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00097014 -0.00077984  0.001188   -0.00896136 -0.10365993]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.02011427 -0.01572455  0.02738686 -0.23229557 -2.552076  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02011427 -0.01572455  0.02738686 -0.23229557 -2.552076  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.5225872   3.1208427  -3.4012923  -0.22524478  0.7497583 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.5225872   3.1208427  -3.4012923  -0.22524478  0.7497583 ]
  [Layer 34] Output shape after mixer: (1, 1, 2048)
  [Layer 34] Output sample values after mixer: [-1.5225872   3.1208427  -3.4012923  -0.22524478  0.7497583 ]
  [Layer 34] Residual connection shape: (1, 1, 2048)
  [Layer 34] Residual connection sample values: [-4.6704717 -1.7009261 -5.81163   -5.096985   5.6226993]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.13728948 -0.04990465 -0.16776904 -0.13801338  0.16356362]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.13728948 -0.04990465 -0.16776904 -0.13801338  0.16356362]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.13728948 -0.04990465 -0.16776904 -0.13801338  0.16356362]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.1347176   0.6326344   2.0333295   0.48680604 -1.4443419 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.1347176   0.6326344   2.0333295   0.48680604 -1.4443419 ]
  [FlaxMamba2] xBC (step) sample values: [ 2.3284924   0.3600725   0.49459502 -0.45328978 -0.40722674]
  [FlaxMamba2] dt (step) sample values: [2.9657936  2.2282062  0.59402597 1.3362134  2.6826768 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.8682969   0.96487004 -0.8679777   2.3284924   1.2026073 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.39402315 -0.09637999 -0.09493553 -0.10618321 -0.06240091]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.55002904 -0.05524229 -0.13112938 -0.1511356  -0.1038743 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.20123236 -0.02685841 -0.06127211 -0.06986815 -0.04924211]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.20123236 -0.02685841 -0.06127211 -0.06986815 -0.04924211]
  [FlaxMamba2] B (step) sample values: [ 0.00520218  0.0736789  -0.2738618   0.1994261  -0.14592186]
  [FlaxMamba2] C (step) sample values: [ 0.8458255   0.47536254 -0.19892931 -0.26231113  0.3933112 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.709799  -2.7746034 -0.4452666 -1.139112  -3.5906036]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1632829  0.1476469  0.26969776 0.23266515 0.3247461 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.890566   0.66387486 0.8868429  0.76718163 0.31160012]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.20123236 -0.02685841 -0.06127211 -0.06986815 -0.04924211]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00017093 -0.00242093  0.0089985  -0.0065527   0.00479467]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00017093 -0.00242093  0.0089985  -0.0065527   0.00479467]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00372206 -0.01538791  0.03046788 -0.02498677  0.00498753]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.10828124 -0.07649069 -0.0759875  -0.13000417 -0.02481879]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.24438041 -0.0946558  -0.11742758 -0.17725798 -0.05812263]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.24438041 -0.0946558  -0.11742758 -0.17725798 -0.05812263]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.06746541 -0.03910846 -0.211132   -0.05344419  0.01602366]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.80122757 -0.24709    -0.9425357  -0.27578747  0.11102673]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.80122757 -0.24709    -0.9425357  -0.27578747  0.11102673]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [3.1231296  1.0606762  0.8837734  0.4894509  0.11304561]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [3.1231296  1.0606762  0.8837734  0.4894509  0.11304561]
  [Layer 35] Output shape after mixer: (1, 1, 2048)
  [Layer 35] Output sample values after mixer: [3.1231296  1.0606762  0.8837734  0.4894509  0.11304561]
  [Layer 35] Residual connection shape: (1, 1, 2048)
  [Layer 35] Residual connection sample values: [-1.5473421  -0.64024985 -4.9278564  -4.607534    5.735745  ]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03605785 -0.01510537 -0.11403444 -0.1059275   0.13685247]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03605785 -0.01510537 -0.11403444 -0.1059275   0.13685247]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03605785 -0.01510537 -0.11403444 -0.1059275   0.13685247]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.9160734  -1.044856   -1.5966115   0.16244687 -1.092359  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.9160734  -1.044856   -1.5966115   0.16244687 -1.092359  ]
  [FlaxMamba2] xBC (step) sample values: [-1.0857224  -0.37452057  0.17564191 -1.7711695   0.2430627 ]
  [FlaxMamba2] dt (step) sample values: [1.0326619  1.0413489  0.54457206 2.1517718  0.9206664 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.03408239  0.22343971  0.04255656 -1.0857224   1.1827321 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.1848424  -0.05222562  0.00887321 -0.31337956 -0.0444203 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.14864855 -0.05235937 -0.01961495 -0.33831242 -0.07228285]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.07983822 -0.02549447 -0.00971129 -0.14081222 -0.03483579]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.07983822 -0.02549447 -0.00971129 -0.14081222 -0.03483579]
  [FlaxMamba2] B (step) sample values: [ 0.11377407  0.34439978 -0.01370578  0.04222447 -0.03437526]
  [FlaxMamba2] C (step) sample values: [-0.27376842 -0.26080328  0.10098522 -0.00485965 -0.27238262]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6566098 -1.1305923 -1.6058172 -2.4414158 -2.882315 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1155031  0.0104055  0.03687962 0.2781518  0.09990553]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.73576343 0.98830456 0.9424976  0.50708115 0.7497922 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.07983822 -0.02549447 -0.00971129 -0.14081222 -0.03483579]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00104917  0.0031759  -0.00012639  0.00038938 -0.00031699]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00104917  0.0031759  -0.00012639  0.00038938 -0.00031699]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00045889  0.00141419 -0.00029187  0.00061994 -0.00023344]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 2.3312778e-03  5.6373226e-03  1.8428933e-04 -6.6257371e-03
  2.8410264e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.09380887 -0.02357391 -0.01094278 -0.16796653 -0.03988599]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.09380887 -0.02357391 -0.01094278 -0.16796653 -0.03988599]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0245569   0.00640942  0.00294315 -0.01474851  0.01094362]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.2780278   0.10585765  0.0328343  -0.18518716  0.11895836]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.2780278   0.10585765  0.0328343  -0.18518716  0.11895836]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.05634939 -2.552709   -0.68485785  0.53612906 -3.231502  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.05634939 -2.552709   -0.68485785  0.53612906 -3.231502  ]
  [Layer 36] Output shape after mixer: (1, 1, 2048)
  [Layer 36] Output sample values after mixer: [ 0.05634939 -2.552709   -0.68485785  0.53612906 -3.231502  ]
  [Layer 36] Residual connection shape: (1, 1, 2048)
  [Layer 36] Residual connection sample values: [-1.4909927 -3.1929588 -5.6127143 -4.071405   2.504243 ]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03710464 -0.08129635 -0.13800302 -0.09802404  0.06280045]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03710464 -0.08129635 -0.13800302 -0.09802404  0.06280045]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03710464 -0.08129635 -0.13800302 -0.09802404  0.06280045]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.7180506   2.1851687   2.9554698  -3.1200469   0.12170342]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.7180506   2.1851687   2.9554698  -3.1200469   0.12170342]
  [FlaxMamba2] xBC (step) sample values: [-1.6311437   0.4639334   0.15517911  0.15684748 -0.11409771]
  [FlaxMamba2] dt (step) sample values: [2.5734847 0.6769064 1.2332699 1.7005875 1.1724309]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.252069    0.45179865  0.2273136  -1.6311437  -0.17420769]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.3285336  -0.02517279  0.00218971  0.01632319 -0.06213826]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.31615108 -0.05361517  0.00719078 -0.13455571 -0.04739827]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.18285735 -0.02608911  0.00360832 -0.06275836 -0.02313759]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.18285735 -0.02608911  0.00360832 -0.06275836 -0.02313759]
  [FlaxMamba2] B (step) sample values: [ 0.00293937  0.03226194 -0.11640836 -0.08572281 -0.0688154 ]
  [FlaxMamba2] C (step) sample values: [-0.23520505 -0.10770687 -0.26255587 -0.26153615 -0.27809483]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.06064401 -3.2470093  -0.81907064 -0.24529998 -1.975189  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11655177 0.01910772 0.03184868 0.00683005 0.03719662]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99295676 0.9398425  0.974251   0.998326   0.9291637 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.18285735 -0.02608911  0.00360832 -0.06275836 -0.02313759]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 6.2644795e-05  6.8757765e-04 -2.4809355e-03 -1.8269544e-03
 -1.4666177e-03]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 6.2644795e-05  6.8757765e-04 -2.4809355e-03 -1.8269544e-03
 -1.4666177e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0008657  -0.00040716 -0.0030865  -0.00050533 -0.00155694]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.02277273 -0.01427824 -0.00211543  0.00131176  0.01920503]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0120252  -0.00931346 -0.0028021   0.01325474  0.02360814]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0120252  -0.00931346 -0.0028021   0.01325474  0.02360814]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01751707 -0.01829414 -0.00787176 -0.00174883  0.00152391]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.102673   -0.09732072 -0.08252612 -0.03387105  0.00659659]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.102673   -0.09732072 -0.08252612 -0.03387105  0.00659659]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.2231772   2.8247526  -2.7777257   0.04998495 -2.1041486 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.2231772   2.8247526  -2.7777257   0.04998495 -2.1041486 ]
  [Layer 37] Output shape after mixer: (1, 1, 2048)
  [Layer 37] Output sample values after mixer: [ 2.2231772   2.8247526  -2.7777257   0.04998495 -2.1041486 ]
  [Layer 37] Residual connection shape: (1, 1, 2048)
  [Layer 37] Residual connection sample values: [ 0.7321845  -0.36820626 -8.39044    -4.02142     0.40009427]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01561975 -0.0077958  -0.17680287 -0.08267923  0.00843076]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01561975 -0.0077958  -0.17680287 -0.08267923  0.00843076]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01561975 -0.0077958  -0.17680287 -0.08267923  0.00843076]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.65839696  0.07815574 -0.76988685 -1.5018661  -0.4566471 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.65839696  0.07815574 -0.76988685 -1.5018661  -0.4566471 ]
  [FlaxMamba2] xBC (step) sample values: [-0.822568    0.1888349   1.1450217   0.53429425  0.39458787]
  [FlaxMamba2] dt (step) sample values: [1.0319408  2.1570735  0.23207122 1.3022321  2.14718   ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.8204461  -0.35418734  0.47133467 -0.822568    0.31709278]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12831444 -0.07785022 -0.2679457  -0.1517659   0.08980495]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.15640587 -0.11502063 -0.2937178  -0.1633702   0.06854946]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.0843062  -0.05420652 -0.12544508 -0.07502744  0.03544903]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0843062  -0.05420652 -0.12544508 -0.07502744  0.03544903]
  [FlaxMamba2] B (step) sample values: [-0.11472139 -0.1628484  -0.03533899 -0.00686972 -0.27776545]
  [FlaxMamba2] C (step) sample values: [-0.11135161 -0.23764384 -0.02372053 -0.05090689 -0.27784175]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0881431 -1.3535548 -1.1764196 -1.6451025 -1.1940706]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.13942583 0.23359132 0.20748745 0.14681832 0.18147324]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8592329  0.7289292  0.7834153  0.7854243  0.80517805]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0843062  -0.05420652 -0.12544508 -0.07502744  0.03544903]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.3484881e-03 -1.9141953e-03 -4.1539085e-04 -8.0749873e-05
 -3.2649834e-03]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.3484881e-03 -1.9141953e-03 -4.1539085e-04 -8.0749873e-05
 -3.2649834e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.0046049  0.00584432 0.00065894 0.00055926 0.0042351 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01300941 -0.05057311 -0.03477309  0.03320027  0.02018879]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.05526375 -0.09447084 -0.13636151 -0.02755874  0.04889626]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.05526375 -0.09447084 -0.13636151 -0.02755874  0.04889626]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01241108 -0.00383591  0.03322748  0.007539   -0.00865852]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.13326918 -0.03983954  0.36203063  0.07493312 -0.07741805]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.13326918 -0.03983954  0.36203063  0.07493312 -0.07741805]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.60599446 -5.589441   -5.9618635   0.64405864  3.9604106 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.60599446 -5.589441   -5.9618635   0.64405864  3.9604106 ]
  [Layer 38] Output shape after mixer: (1, 1, 2048)
  [Layer 38] Output sample values after mixer: [ 0.60599446 -5.589441   -5.9618635   0.64405864  3.9604106 ]
  [Layer 38] Residual connection shape: (1, 1, 2048)
  [Layer 38] Residual connection sample values: [  1.338179   -5.9576473 -14.3523035  -3.3773613   4.360505 ]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0218431  -0.09824654 -0.23465304 -0.05530768  0.07202389]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0218431  -0.09824654 -0.23465304 -0.05530768  0.07202389]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0218431  -0.09824654 -0.23465304 -0.05530768  0.07202389]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.3353202  -0.19126602  0.22192052  1.1864158   0.9397679 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.3353202  -0.19126602  0.22192052  1.1864158   0.9397679 ]
  [FlaxMamba2] xBC (step) sample values: [ 2.3278708  -0.7219757  -0.24255066 -1.1985916   0.6004605 ]
  [FlaxMamba2] dt (step) sample values: [3.3731542 1.8072848 0.8137398 2.6992452 1.3507359]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.19632643  0.79485327  1.5400192   2.3278708  -0.1755606 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.37677762  0.11715215 -0.02813927 -0.27400032  0.09028687]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.362442    0.20235723 -0.05047813 -0.2699224   0.06930603]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.2137072   0.11138093 -0.02460219 -0.11685647  0.03585336]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.2137072   0.11138093 -0.02460219 -0.11685647  0.03585336]
  [FlaxMamba2] B (step) sample values: [0.11216298 0.00535223 0.04621276 0.03651027 0.11694891]
  [FlaxMamba2] C (step) sample values: [ 0.6452632   0.27161738  0.3597705  -0.07243266 -0.17024016]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.69420344 -0.9242845  -1.3151171  -3.1532621  -2.1087465 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.13240328 0.04513135 0.01994061 0.34558898 0.09575512]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.91218287 0.9591439  0.9741166  0.3363064  0.8171576 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.2137072   0.11138093 -0.02460219 -0.11685647  0.03585336]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00317371 0.00015144 0.00130761 0.00103308 0.00330913]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [0.00317371 0.00015144 0.00130761 0.00103308 0.00330913]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [2.85227341e-03 1.31943525e-05 1.52768393e-03 7.43341283e-04
 3.71336495e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0210824   0.00850615 -0.00333769 -0.01066166  0.00554457]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.20419891  0.10394369 -0.02441824 -0.11079094  0.03626577]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.20419891  0.10394369 -0.02441824 -0.11079094  0.03626577]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.21587886 -0.0089927  -0.00300887 -0.10069927  0.02450633]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 4.201367   -0.18800059 -0.06430099 -1.7401036   0.48287457]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 4.201367   -0.18800059 -0.06430099 -1.7401036   0.48287457]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.26955998 -2.206476    2.1189504   0.05084899 -0.537576  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.26955998 -2.206476    2.1189504   0.05084899 -0.537576  ]
  [Layer 39] Output shape after mixer: (1, 1, 2048)
  [Layer 39] Output sample values after mixer: [-0.26955998 -2.206476    2.1189504   0.05084899 -0.537576  ]
  [Layer 39] Residual connection shape: (1, 1, 2048)
  [Layer 39] Residual connection sample values: [  1.068619   -8.164124  -12.233353   -3.3265123   3.8229291]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01502916 -0.11571953 -0.17801364 -0.04722894  0.05361576]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01502916 -0.11571953 -0.17801364 -0.04722894  0.05361576]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01502916 -0.11571953 -0.17801364 -0.04722894  0.05361576]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.9584407  -1.5013214  -1.1254007   0.04223924 -0.04569242]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.9584407  -1.5013214  -1.1254007   0.04223924 -0.04569242]
  [FlaxMamba2] xBC (step) sample values: [ 0.05527284  0.37902182 -0.53138936  0.77013636  0.5125301 ]
  [FlaxMamba2] dt (step) sample values: [1.0549278  1.0217944  1.7598522  0.42634067 1.2541294 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.16612352  0.03213707  0.84650826  0.05527284 -0.22655748]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.03367143 -0.04835194 -0.11800005 -0.13658172  0.07831132]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01801592 -0.06698292 -0.11224367 -0.14645416  0.07354676]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.0090891  -0.0323702  -0.05297548 -0.06787443  0.03812505]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.0090891  -0.0323702  -0.05297548 -0.06787443  0.03812505]
  [FlaxMamba2] B (step) sample values: [ 0.19298834 -0.00128051 -0.04830346 -0.0393984   0.02292926]
  [FlaxMamba2] C (step) sample values: [ 0.2141702  -0.13568923 -0.0464075  -0.07713103  0.3229497 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9809841  -1.4352343  -0.79658854 -1.6062093  -1.8464803 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1559753  0.0371164  0.02615077 0.05596535 0.19340669]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.73419213 0.9481233  0.97938406 0.91402984 0.6996874 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.0090891  -0.0323702  -0.05297548 -0.06787443  0.03812505]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.7359472e-04 -1.8153490e-06 -6.8478599e-05 -5.5854129e-05
  3.2506232e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.7359472e-04 -1.8153490e-06 -6.8478599e-05 -5.5854129e-05
  3.2506232e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00292779  0.00347013 -0.00080399 -0.0013184   0.00173469]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0084013  -0.00308304 -0.0093142  -0.0077389  -0.00397298]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01582419 -0.02951914 -0.05257822 -0.06317059  0.02716299]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01582419 -0.02951914 -0.05257822 -0.06317059  0.02716299]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00420402  0.00807595  0.01449768 -0.00136231 -0.0006064 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.10605896  0.20495689  0.36228803 -0.04033877 -0.01510016]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.10605896  0.20495689  0.36228803 -0.04033877 -0.01510016]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.00824099  0.43510732  1.7284436   0.03671126 -2.3697164 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.00824099  0.43510732  1.7284436   0.03671126 -2.3697164 ]
  [Layer 40] Output shape after mixer: (1, 1, 2048)
  [Layer 40] Output sample values after mixer: [ 0.00824099  0.43510732  1.7284436   0.03671126 -2.3697164 ]
  [Layer 40] Residual connection shape: (1, 1, 2048)
  [Layer 40] Residual connection sample values: [  1.07686    -7.7290163 -10.5049095  -3.2898011   1.4532127]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0143209  -0.10363019 -0.14268436 -0.04375026  0.01942112]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0143209  -0.10363019 -0.14268436 -0.04375026  0.01942112]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0143209  -0.10363019 -0.14268436 -0.04375026  0.01942112]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.23245655  0.25572    -0.7214323  -0.57518166 -0.6546968 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.23245655  0.25572    -0.7214323  -0.57518166 -0.6546968 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.4608445  -0.26436818  0.254081   -0.2605246   0.05228021]
  [FlaxMamba2] dt (step) sample values: [1.0245003  0.53918886 1.4763485  1.3783221  0.9164043 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.79864335  0.17966998 -0.26111516  0.4608445  -0.04639884]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.07450464 -0.09579709  0.07461491 -0.04304723  0.00360642]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.08785608 -0.10979703  0.076713   -0.04978398 -0.01198044]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04199961 -0.05188769  0.039827   -0.02427251 -0.00595434]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04199961 -0.05188769  0.039827   -0.02427251 -0.00595434]
  [FlaxMamba2] B (step) sample values: [-0.05987403  0.03060479  0.13676396 -0.25259107 -0.01645209]
  [FlaxMamba2] C (step) sample values: [ 0.00083198 -0.02992741 -0.19395094 -0.10814843  0.11434589]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8258594 -1.8636904 -1.2829287 -1.4542811 -4.4079003]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10068143 0.05324433 0.03114958 0.15473254 0.01588579]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.83207715 0.90553355 0.96082526 0.79849654 0.9323724 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04199961 -0.05188769  0.039827   -0.02427251 -0.00595434]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.5318217e-04 -1.2941481e-04 -5.7831744e-04  1.0681017e-03
  6.9568981e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.5318217e-04 -1.2941481e-04 -5.7831744e-04  1.0681017e-03
  6.9568981e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00016769  0.00041243 -0.00073133  0.00403658 -0.0033598 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 8.6746833e-05 -2.1091111e-03  1.5644511e-03 -2.0899812e-03
  2.8805784e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04084954 -0.05268314  0.04038313 -0.02574797 -0.00292301]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04084954 -0.05268314  0.04038313 -0.02574797 -0.00292301]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00419851 -0.00759268 -0.00952898  0.00533214  0.00065435]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.10461742 -0.1890858  -0.23355508  0.1372888   0.01313045]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.10461742 -0.1890858  -0.23355508  0.1372888   0.01313045]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.8299546  -4.159021   -0.14471558  1.6130505   0.80972695]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.8299546  -4.159021   -0.14471558  1.6130505   0.80972695]
  [Layer 41] Output shape after mixer: (1, 1, 2048)
  [Layer 41] Output sample values after mixer: [-1.8299546  -4.159021   -0.14471558  1.6130505   0.80972695]
  [Layer 41] Residual connection shape: (1, 1, 2048)
  [Layer 41] Residual connection sample values: [ -0.7530947 -11.888037  -10.649625   -1.6767507   2.2629397]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00998536 -0.16070741 -0.14265792 -0.02207202  0.02986557]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00998536 -0.16070741 -0.14265792 -0.02207202  0.02986557]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00998536 -0.16070741 -0.14265792 -0.02207202  0.02986557]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.60382426  0.02541831 -1.383623   -1.2326099   0.11777646]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.60382426  0.02541831 -1.383623   -1.2326099   0.11777646]
  [FlaxMamba2] xBC (step) sample values: [ 0.20667031  0.5194198  -0.6454064   0.87382835 -0.02863757]
  [FlaxMamba2] dt (step) sample values: [1.3940505 3.0386386 4.124083  1.6152804 2.2530744]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.26236737  0.33231723  1.3847492   0.20667031  0.12281699]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04779447 -0.08800051 -0.09898816 -0.06900895 -0.00873294]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.03846372 -0.10121462 -0.08894025 -0.06548226 -0.02867618]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01960168 -0.0480484  -0.04249384 -0.03166953 -0.01413252]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01960168 -0.0480484  -0.04249384 -0.03166953 -0.01413252]
  [FlaxMamba2] B (step) sample values: [-0.02648159 -0.12983762 -0.11935672  0.08678915  0.3653927 ]
  [FlaxMamba2] C (step) sample values: [-0.01005256 -0.01749188  0.02181055  0.2791231  -0.26077473]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.06612   -1.4514434 -0.7269863 -1.9455162 -0.6256312]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08341843 1.5351546  0.19354971 0.12928191 0.10276499]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9149059  0.10772324 0.86874294 0.7776179  0.9377302 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01960168 -0.0480484  -0.04249384 -0.03166953 -0.01413252]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.3301130e-05 -2.1230282e-04 -1.9516508e-04  1.4191250e-04
  5.9746864e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.3301130e-05 -2.1230282e-04 -1.9516508e-04  1.4191250e-04
  5.9746864e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0004515  -0.00068692 -0.00057086  0.00146648  0.00123749]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 2.1271501e-03 -1.6517356e-03 -7.7521006e-05 -1.6425304e-03
  1.5687465e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02179703 -0.04986731 -0.04271922 -0.03342225 -0.01261295]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02179703 -0.04986731 -0.04271922 -0.03342225 -0.01261295]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00465221 -0.00064183  0.01184674  0.0092991  -0.00078644]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.13568106 -0.01840148  0.34550843  0.22447349 -0.02081995]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.13568106 -0.01840148  0.34550843  0.22447349 -0.02081995]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.5375696  -1.6051768  -0.03769691  2.1305418  -0.8895307 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.5375696  -1.6051768  -0.03769691  2.1305418  -0.8895307 ]
  [Layer 42] Output shape after mixer: (1, 1, 2048)
  [Layer 42] Output sample values after mixer: [-0.5375696  -1.6051768  -0.03769691  2.1305418  -0.8895307 ]
  [Layer 42] Residual connection shape: (1, 1, 2048)
  [Layer 42] Residual connection sample values: [ -1.2906642  -13.493214   -10.687322     0.45379114   1.373409  ]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01633171 -0.17902517 -0.13565333  0.00583998  0.01723519]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.01633171 -0.17902517 -0.13565333  0.00583998  0.01723519]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.01633171 -0.17902517 -0.13565333  0.00583998  0.01723519]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.0600065  -1.2852592  -0.09103686  0.04946698  0.27086896]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.0600065  -1.2852592  -0.09103686  0.04946698  0.27086896]
  [FlaxMamba2] xBC (step) sample values: [ 0.34351736 -0.7023578   0.14017384  0.6628095  -0.93104863]
  [FlaxMamba2] dt (step) sample values: [2.2374508 2.4461343 0.8040335 2.856507  2.2613661]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.78150445  0.9246726  -0.28933084  0.34351736  0.13367744]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.0480939  -0.03651965  0.01749647 -0.12293228  0.15713201]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04452335 -0.08220446  0.02997053 -0.11703094  0.14831243]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02275717 -0.03941379  0.01520981 -0.05509531  0.07964531]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02275717 -0.03941379  0.01520981 -0.05509531  0.07964531]
  [FlaxMamba2] B (step) sample values: [-0.00775723 -0.02115123  0.8786032  -0.02910595  0.02223408]
  [FlaxMamba2] C (step) sample values: [ 0.15010136 -0.13144138 -0.27512866  0.01545351  0.11652721]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9761645 -1.478265  -1.0588893 -1.0815219 -5.9141264]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03728874 0.15976812 0.01813816 0.11377032 0.42383337]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.96425456 0.7896388  0.98097694 0.8842238  0.08154468]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02275717 -0.03941379  0.01520981 -0.05509531  0.07964531]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.5826766e-06 -1.7948640e-05  7.4557058e-04 -2.4698908e-05
  1.8867533e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.5826766e-06 -1.7948640e-05  7.4557058e-04 -2.4698908e-05
  1.8867533e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00025267 -0.0014054   0.01156339  0.00018755  0.0001158 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00452005 -0.00478886 -0.00693334 -0.00400077  0.00179611]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02428162 -0.03901448  0.00627436 -0.05184371  0.07095745]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02428162 -0.03901448  0.00627436 -0.05184371  0.07095745]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00662277  0.01086395 -0.00027261 -0.00131398  0.01090372]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.21389958  0.26914647 -0.0063389  -0.03368637  0.32238156]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.21389958  0.26914647 -0.0063389  -0.03368637  0.32238156]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.9473636  1.4699085 -2.2605507  1.8258561  2.081671 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.9473636  1.4699085 -2.2605507  1.8258561  2.081671 ]
  [Layer 43] Output shape after mixer: (1, 1, 2048)
  [Layer 43] Output sample values after mixer: [-2.9473636  1.4699085 -2.2605507  1.8258561  2.081671 ]
  [Layer 43] Residual connection shape: (1, 1, 2048)
  [Layer 43] Residual connection sample values: [ -4.2380276 -12.023305  -12.947872    2.2796474   3.45508  ]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.05154569 -0.15201183 -0.15895389  0.02758247  0.04197928]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.05154569 -0.15201183 -0.15895389  0.02758247  0.04197928]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.05154569 -0.15201183 -0.15895389  0.02758247  0.04197928]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.26042107 -0.18914564  0.43101713  0.21787421 -1.5253243 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.26042107 -0.18914564  0.43101713  0.21787421 -1.5253243 ]
  [FlaxMamba2] xBC (step) sample values: [-0.5128645  -0.68179244  0.16636933 -1.5110067  -2.1670969 ]
  [FlaxMamba2] dt (step) sample values: [1.910843   0.5673861  0.6831124  1.5004791  0.70612967]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.74250704 -0.70534456 -0.6839967  -0.5128645   0.67951876]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.09651958  0.08256938  0.01996175 -0.34762675  0.2517631 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.10262691  0.14299418  0.00149862 -0.35417658  0.19927287]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04868269  0.07660023  0.00074987 -0.14605178  0.10953113]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04868269  0.07660023  0.00074987 -0.14605178  0.10953113]
  [FlaxMamba2] B (step) sample values: [-0.27846396 -0.12646642  0.06002353 -0.00857951  0.0688539 ]
  [FlaxMamba2] C (step) sample values: [-0.26104745 -0.01399507  0.0224145  -0.12317151  0.1847803 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.74823433 -0.64391696 -1.1771379  -1.350584   -1.0269372 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1394253  0.02642733 0.02192652 0.04351548 0.07380061]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.90093446 0.98312694 0.9745197  0.94292235 0.92701215]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04868269  0.07660023  0.00074987 -0.14605178  0.10953113]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.8901015e-03  8.5840328e-04 -4.0741562e-04  5.8234255e-05
 -4.6735260e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.8901015e-03  8.5840328e-04 -4.0741562e-04  5.8234255e-05
 -4.6735260e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.0075207  -0.00051622 -0.00117879 -0.00010906 -0.00177621]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00238194  0.00047746 -0.00030089 -0.00461736  0.00268052]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04811282  0.07243314  0.00040351 -0.1418135   0.10557038]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04811282  0.07243314  0.00040351 -0.1418135   0.10557038]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00545363 -0.00620429  0.00010542 -0.01712507 -0.02877248]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.14226937 -0.12922719  0.00296307 -0.41750595 -0.7631655 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.14226937 -0.12922719  0.00296307 -0.41750595 -0.7631655 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-3.4187977   1.3169855  -0.98028445 -2.603894    2.306182  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-3.4187977   1.3169855  -0.98028445 -2.603894    2.306182  ]
  [Layer 44] Output shape after mixer: (1, 1, 2048)
  [Layer 44] Output sample values after mixer: [-3.4187977   1.3169855  -0.98028445 -2.603894    2.306182  ]
  [Layer 44] Residual connection shape: (1, 1, 2048)
  [Layer 44] Residual connection sample values: [ -7.656825   -10.70632    -13.928157    -0.32424664   5.761262  ]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.0915123  -0.13147546 -0.16714329 -0.0038122   0.06850662]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.0915123  -0.13147546 -0.16714329 -0.0038122   0.06850662]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.0915123  -0.13147546 -0.16714329 -0.0038122   0.06850662]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.63932645  0.1957774   0.69505256 -0.48558304  0.550044  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.63932645  0.1957774   0.69505256 -0.48558304  0.550044  ]
  [FlaxMamba2] xBC (step) sample values: [ 0.9238664  -0.09186218  0.5986486  -0.38313594 -1.0492951 ]
  [FlaxMamba2] dt (step) sample values: [2.131453  1.7030092 1.0458012 1.3852441 1.8565489]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.03926632 0.5000783  1.170957   0.9238664  0.24271604]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.15549886  0.01463967  0.0972924  -0.06068937  0.20791449]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.15092123  0.06685525  0.09484146 -0.06727354  0.20541205]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.08114412  0.03454462  0.04966777 -0.03250576  0.11321761]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.08114412  0.03454462  0.04966777 -0.03250576  0.11321761]
  [FlaxMamba2] B (step) sample values: [ 0.26462784 -0.11070263 -0.0855371  -0.04482267  0.01448146]
  [FlaxMamba2] C (step) sample values: [-0.00802188  0.5110868   0.28950977 -0.1989643   0.42179942]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.250236  -4.181475  -1.0937363 -2.677446  -2.3148744]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05913412 0.11813395 0.05430628 0.04945111 0.03499996]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8754076  0.61019653 0.9423328  0.8759882  0.9221748 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.08114412  0.03454462  0.04966777 -0.03250576  0.11321761]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.2697866e-03 -5.3119397e-04 -4.1044003e-04 -2.1507651e-04
  6.9487643e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.2697866e-03 -5.3119397e-04 -4.1044003e-04 -2.1507651e-04
  6.9487643e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00239618 -0.00050381 -0.00013681 -0.00059022  0.00030983]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00413112  0.0020774  -0.00633704 -0.00515066  0.05257125]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.09516145  0.04083076  0.04938201 -0.04161677  0.17958274]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.09516145  0.04083076  0.04938201 -0.04161677  0.17958274]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0210138   0.00438687  0.02289659  0.00769808  0.06263991]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.54009503  0.08176102  0.54079795  0.16644982  1.4526012 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.54009503  0.08176102  0.54079795  0.16644982  1.4526012 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.42490748 -0.85999644  0.13766046  0.40832663 -0.5764908 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.42490748 -0.85999644  0.13766046  0.40832663 -0.5764908 ]
  [Layer 45] Output shape after mixer: (1, 1, 2048)
  [Layer 45] Output sample values after mixer: [ 0.42490748 -0.85999644  0.13766046  0.40832663 -0.5764908 ]
  [Layer 45] Residual connection shape: (1, 1, 2048)
  [Layer 45] Residual connection sample values: [ -7.2319174  -11.566317   -13.790497     0.08407998   5.184771  ]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.09992256 -0.1665649  -0.19408514  0.00117449  0.07115293]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09992256 -0.1665649  -0.19408514  0.00117449  0.07115293]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.09992256 -0.1665649  -0.19408514  0.00117449  0.07115293]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.1639938  -0.14745569 -0.85575885  0.13894312 -0.00294614]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.1639938  -0.14745569 -0.85575885  0.13894312 -0.00294614]
  [FlaxMamba2] xBC (step) sample values: [ 0.92738557 -0.02690419 -0.6170673  -1.3089695  -0.01307385]
  [FlaxMamba2] dt (step) sample values: [ 2.3832679   1.8035588  -0.6665258   0.20842601  1.4802749 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.28203216 0.87103164 0.24076298 0.92738557 0.5911005 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.1534231   0.00637402 -0.10388798  0.19331971  0.00392952]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.15656069  0.00257458 -0.12499089  0.17748109  0.02423897]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07216502  0.00128895 -0.05859484  0.09659483  0.01226636]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07216502  0.00128895 -0.05859484  0.09659483  0.01226636]
  [FlaxMamba2] B (step) sample values: [-0.10897519 -0.18536036 -0.032411    0.04128946  0.09383325]
  [FlaxMamba2] C (step) sample values: [-0.01885569 -0.25336456  0.06565828  0.03598886 -0.05341919]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8673339  -0.9793274  -1.6584101  -0.94076145 -0.4381494 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03226763 0.03399788 0.00325765 0.01272294 0.03818019]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9415249  0.96725315 0.99461204 0.9881021  0.98341054]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07216502  0.00128895 -0.05859484  0.09659483  0.01226636]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.5375903e-04  4.3162910e-04  7.5472068e-05 -9.6146396e-05
 -2.1849960e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.5375903e-04  4.3162910e-04  7.5472068e-05 -9.6146396e-05
 -2.1849960e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 3.3229656e-04  1.5760676e-03 -1.6606068e-04 -8.0883619e-05
 -3.9215974e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-5.2377989e-04  9.3222458e-05 -7.2452798e-04  2.4152954e-05
  1.5596293e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0581443   0.00112239 -0.04750986  0.07715077  0.01135377]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0581443   0.00112239 -0.04750986  0.07715077  0.01135377]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 1.6103845e-02 -7.6661367e-05  1.2124979e-02  5.7315393e-03
 -1.6700258e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.3677838  -0.0016715   0.2388146   0.1044881  -0.00037181]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.3677838  -0.0016715   0.2388146   0.1044881  -0.00037181]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-4.608795    0.59573936 -2.7293825  -5.022286   -4.041363  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-4.608795    0.59573936 -2.7293825  -5.022286   -4.041363  ]
  [Layer 46] Output shape after mixer: (1, 1, 2048)
  [Layer 46] Output sample values after mixer: [-4.608795    0.59573936 -2.7293825  -5.022286   -4.041363  ]
  [Layer 46] Residual connection shape: (1, 1, 2048)
  [Layer 46] Residual connection sample values: [-11.840713  -10.970577  -16.519878   -4.9382057   1.1434083]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.14296076 -0.13371533 -0.19347747 -0.05854438  0.01291193]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.14296076 -0.13371533 -0.19347747 -0.05854438  0.01291193]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.14296076 -0.13371533 -0.19347747 -0.05854438  0.01291193]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.3059984   0.50079924 -1.7024662  -1.1663759   0.56440806]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.3059984   0.50079924 -1.7024662  -1.1663759   0.56440806]
  [FlaxMamba2] xBC (step) sample values: [ 0.41813856 -1.3584349  -0.2559699  -0.5960421  -0.13893065]
  [FlaxMamba2] dt (step) sample values: [ 0.6253623  -0.9813625   1.2230728   1.241806   -0.07695181]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.08903592  0.16257574  0.00613084  0.41813856  2.019093  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.05765676  0.0591408  -0.02396173  0.08671646 -0.01881515]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.04055166  0.03423845 -0.24344414  0.08333664 -0.0136386 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01986478  0.01741227 -0.10697855  0.04340356 -0.0067728 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01986478  0.01741227 -0.10697855  0.04340356 -0.0067728 ]
  [FlaxMamba2] B (step) sample values: [-0.2244125  -0.01878608 -0.27532554 -0.27639017  0.03486449]
  [FlaxMamba2] C (step) sample values: [ 0.65824896 -0.07911573 -0.0244629  -0.27666104  0.08661144]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -3.552239  -11.244981   -2.6866128  -3.193549   -3.1997924]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04140012 0.00571929 0.00875318 0.01260229 0.0107639 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8632395  0.9377112  0.97675794 0.9605531  0.96614414]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01986478  0.01741227 -0.10697855  0.04340356 -0.0067728 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.8455775e-04  1.5449745e-05  2.2642883e-04  2.2730439e-04
 -2.8672697e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.8455775e-04  1.5449745e-05  2.2642883e-04  2.2730439e-04
 -2.8672697e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00030483 -0.0001373  -0.00075271 -0.00046001  0.00012567]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0005729  -0.00220986 -0.00661079 -0.00146918  0.0001227 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0275123   0.02240794 -0.15785912  0.05989561 -0.00945282]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0275123   0.02240794 -0.15785912  0.05989561 -0.00945282]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00765896  0.00698727  0.04142602 -0.01659269 -0.00340107]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.15845042  0.08664042  0.84062576 -0.35172257 -0.0691435 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.15845042  0.08664042  0.84062576 -0.35172257 -0.0691435 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.452815  -5.925662  -9.736407  -2.4756632 -8.140685 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.452815  -5.925662  -9.736407  -2.4756632 -8.140685 ]
  [Layer 47] Output shape after mixer: (1, 1, 2048)
  [Layer 47] Output sample values after mixer: [-2.452815  -5.925662  -9.736407  -2.4756632 -8.140685 ]
  [Layer 47] Residual connection shape: (1, 1, 2048)
  [Layer 47] Residual connection sample values: [-14.293528 -16.89624  -26.256287  -7.413869  -6.997277]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.17815064 -0.19664247 -0.29870832 -0.08701706 -0.07749028]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.17815064 -0.19664247 -0.29870832 -0.08701706 -0.07749028]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.17815064 -0.19664247 -0.29870832 -0.08701706 -0.07749028]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.64570796 -1.7126734  -1.4627969  -0.7311434  -0.11455118]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.64570796 -1.7126734  -1.4627969  -0.7311434  -0.11455118]
  [FlaxMamba2] xBC (step) sample values: [0.38660777 1.1819475  0.8151167  0.30424225 0.3603977 ]
  [FlaxMamba2] dt (step) sample values: [-2.2091632   0.92232     1.0554835   2.6992884   0.66326416]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.0177499   0.7337517  -0.01763411  0.38660777  1.0137882 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.06775918  0.13164487  0.11859176  0.02077342 -0.05504883]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.07293191  0.35161558  0.0327153  -0.04551076 -0.05749406]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03513677  0.20640162  0.0166252  -0.02223766 -0.02792087]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03513677  0.20640162  0.0166252  -0.02223766 -0.02792087]
  [FlaxMamba2] B (step) sample values: [-0.00397086  0.03421021  0.02912354  0.15526906  0.12939923]
  [FlaxMamba2] C (step) sample values: [-0.03487387 -0.14908998 -0.14624147  0.23010202  0.10412014]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-54.81184   -78.514336  -47.25076    -2.330753   -4.2266355]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00343489 0.02203158 0.01162912 0.01616012 0.01454171]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.82838905 0.17732084 0.5772472  0.9630353  0.9403882 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03513677  0.20640162  0.0166252  -0.02223766 -0.02792087]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.7924641e-07 -4.1288572e-06 -3.5149437e-06 -1.8739545e-05
 -1.5617296e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.7924641e-07 -4.1288572e-06 -3.5149437e-06 -1.8739545e-05
 -1.5617296e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.1402153e-05 -3.1379543e-05  2.5517420e-05  2.1036481e-05
 -6.0944840e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-6.9060065e-05  6.7427644e-04 -7.3727896e-04 -6.7975163e-04
 -2.3269524e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02804597  0.16501716  0.01250018 -0.01838602 -0.02225466]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02804597  0.16501716  0.01250018 -0.01838602 -0.02225466]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0062289  -0.0431893  -0.00343835  0.00436816  0.00120172]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.13691838 -0.7780303  -0.06410026  0.09331366  0.02857896]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.13691838 -0.7780303  -0.06410026  0.09331366  0.02857896]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [  3.916684  -27.426317   -3.7029223  19.868351  -20.128275 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [  3.916684  -27.426317   -3.7029223  19.868351  -20.128275 ]
  [Layer 48] Output shape after mixer: (1, 1, 2048)
  [Layer 48] Output sample values after mixer: [  3.916684  -27.426317   -3.7029223  19.868351  -20.128275 ]
  [Layer 48] Residual connection shape: (1, 1, 2048)
  [Layer 48] Residual connection sample values: [-10.376843 -44.322556 -29.95921   12.454482 -27.125551]
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.12475564 -0.5893773  -0.36681387  0.15550819 -0.32297304]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Final backbone norm output sample values: [-0.12475564 -0.5893773  -0.36681387  0.15550819 -0.32297304]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 1, 50288)
[Mamba2LMHeadModel] Logits sample values: [29.614622  -0.7066658 28.87678   28.00637   22.173767 ]
[Mamba2LMHeadModel] Forward pass input_ids shape: (1, 1)
[Mamba2LMHeadModel] input_ids sample values: [323]
[Mamba2LMHeadModel] Embedding output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Embedding sample values: [-0.14892578  0.08081055 -0.05273438 -0.19360352  0.01483917]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.18558624  0.11395014 -0.06788821 -0.2492377   0.01877225]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.18558624  0.11395014 -0.06788821 -0.2492377   0.01877225]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.18558624  0.11395014 -0.06788821 -0.2492377   0.01877225]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.0376734  -0.6923726  -0.4287442   0.01159943 -0.59433186]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.0376734  -0.6923726  -0.4287442   0.01159943 -0.59433186]
  [FlaxMamba2] xBC (step) sample values: [ 0.40460795 -0.5026346   0.44830823  0.19087563 -1.1876968 ]
  [FlaxMamba2] dt (step) sample values: [ 0.45219356 -0.03445127  0.07714302 -0.16457057  0.2103905 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.52318025  0.45514706 -0.8021352   0.40460795  0.81650573]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.15442401 -0.04558413 -0.14885485 -0.06060659  0.01098801]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.07335919  0.16974789  0.12140882 -0.01141226 -0.24584793]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.03802438  0.09206029  0.06438491 -0.00567357 -0.10788931]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03802438  0.09206029  0.06438491 -0.00567357 -0.10788931]
  [FlaxMamba2] B (step) sample values: [ 0.20079151  0.24938822 -0.27068076 -0.27804637  0.0463805 ]
  [FlaxMamba2] C (step) sample values: [-0.22557057  0.30973092 -0.27556416 -0.20160346  0.10519624]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.617978  -2.5226073 -3.0473056 -3.307819  -3.9089987]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01426056 0.01311518 0.00978434 0.0207711  0.00898612]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.96335447 0.9674569  0.9706242  0.9336002  0.96548307]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03802438  0.09206029  0.06438491 -0.00567357 -0.10788931]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0887901e-04  1.3523053e-04 -1.4677638e-04 -1.5077039e-04
  2.5149784e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0887901e-04  1.3523053e-04 -1.4677638e-04 -1.5077039e-04
  2.5149784e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00249113  0.00162295 -0.0037082  -0.00384419  0.00078499]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.05870634  0.04697446  0.0665182   0.00860971 -0.05163759]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.07320799  0.08208419  0.09107317  0.00644594 -0.09278415]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.07320799  0.08208419  0.09107317  0.00644594 -0.09278415]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-1.9872639e-02 -1.8954067e-02 -1.5401198e-02  3.7601436e-05
  1.9611703e-02]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-6.6391337e-03 -6.8202997e-03 -4.3898160e-03  2.0736565e-05
  6.6734101e-03]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-6.6391337e-03 -6.8202997e-03 -4.3898160e-03  2.0736565e-05
  6.6734101e-03]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.07485307 -0.02763539  0.05593578  0.00294132 -0.07210177]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.07485307 -0.02763539  0.05593578  0.00294132 -0.07210177]
  [Layer 1] Output shape after mixer: (1, 1, 2048)
  [Layer 1] Output sample values after mixer: [ 0.07485307 -0.02763539  0.05593578  0.00294132 -0.07210177]
  [Layer 1] Residual connection shape: (1, 1, 2048)
  [Layer 1] Residual connection sample values: [-0.07407271  0.05317515  0.00320141 -0.19066219 -0.0572626 ]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.17004085  0.09640031  0.00677273 -0.4225904  -0.12398585]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.17004085  0.09640031  0.00677273 -0.4225904  -0.12398585]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.17004085  0.09640031  0.00677273 -0.4225904  -0.12398585]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.4617754   0.06438057 -0.97595024 -1.6177826  -0.19314893]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.4617754   0.06438057 -0.97595024 -1.6177826  -0.19314893]
  [FlaxMamba2] xBC (step) sample values: [-1.5585302  1.6584195  0.825104   4.1605816  1.5427039]
  [FlaxMamba2] dt (step) sample values: [2.0985622 1.4235647 0.6771714 1.2663878 2.2661448]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.35165885  0.7517786  -0.15312672 -1.5585302   0.28777426]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01736222 -0.35854262  0.09257919 -3.0269752  -0.02288083]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01245346 -0.51308364  0.08206588 -1.9732642  -0.03601102]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00618796 -0.1921349   0.0427157  -0.24081461 -0.01768135]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00618796 -0.1921349   0.0427157  -0.24081461 -0.01768135]
  [FlaxMamba2] B (step) sample values: [ 0.06125281  0.01021938 -0.09996242 -0.08437335  0.04585274]
  [FlaxMamba2] C (step) sample values: [-0.14288889 -0.25387233  0.1074595  -0.26404494 -0.19371612]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-19.851534   -18.68525    -13.564036    -2.4188707   -0.46617994]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04863034 0.02584108 0.04112586 0.02571808 0.13416074]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.38083586 0.61702424 0.57244843 0.9396868  0.9393726 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00618796 -0.1921349   0.0427157  -0.24081461 -0.01768135]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.8432347e-05 -3.0752417e-06  3.0080937e-05  2.5389836e-05
 -1.3798121e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.8432347e-05 -3.0752417e-06  3.0080937e-05  2.5389836e-05
 -1.3798121e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.1677602e-04 -5.0477742e-05  1.2496673e-04 -2.4514462e-04
  2.9641652e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00062992 -0.0532289  -0.00446749 -0.07014927  0.00631837]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00364192 -0.18586865  0.02502117 -0.23639491 -0.00588789]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00364192 -0.18586865  0.02502117 -0.23639491 -0.00588789]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00065011 -0.0061757  -0.0066835   0.06329726  0.00051388]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 8.3209925e-05 -3.7394639e-04 -9.0612035e-04  3.4743848e-03
  7.0630464e-05]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 8.3209925e-05 -3.7394639e-04 -9.0612035e-04  3.4743848e-03
  7.0630464e-05]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [0.02257792 0.00783229 0.02925718 0.01339662 0.04900742]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [0.02257792 0.00783229 0.02925718 0.01339662 0.04900742]
  [Layer 2] Output shape after mixer: (1, 1, 2048)
  [Layer 2] Output sample values after mixer: [0.02257792 0.00783229 0.02925718 0.01339662 0.04900742]
  [Layer 2] Residual connection shape: (1, 1, 2048)
  [Layer 2] Residual connection sample values: [-0.05149478  0.06100744  0.03245859 -0.17726557 -0.00825518]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.11544725  0.10694148  0.06519223 -0.36631763 -0.01834781]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.11544725  0.10694148  0.06519223 -0.36631763 -0.01834781]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.11544725  0.10694148  0.06519223 -0.36631763 -0.01834781]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.0628489  -0.30257472 -1.44369    -0.80983555 -2.3236656 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.0628489  -0.30257472 -1.44369    -0.80983555 -2.3236656 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.1436963   0.15622495 -0.428588    0.670979   -1.0356034 ]
  [FlaxMamba2] dt (step) sample values: [2.2556202 0.9853353 1.932936  2.156255  1.1443824]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.42976293  0.0515903  -1.0486968   1.1436963  -0.24531002]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.20076393  0.01251058 -0.23399283  0.15105858  0.04386716]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.19921516 -0.00679178 -0.1103356   0.13872185  0.02757077]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.10949656 -0.00338436 -0.0521274   0.07416417  0.01397541]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.10949656 -0.00338436 -0.0521274   0.07416417  0.01397541]
  [FlaxMamba2] B (step) sample values: [ 0.29496008 -0.1499666  -0.03578742 -0.1759741  -0.03563808]
  [FlaxMamba2] C (step) sample values: [ 0.3513409   0.3623495  -0.2495393   0.37736702  0.2316783 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6505536 -3.9938898 -6.780579  -0.9418818 -6.0307717]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.07725827 0.05369451 0.09055952 0.05530121 0.06657655]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9509815  0.8069852  0.54115695 0.9492461  0.66931   ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.10949656 -0.00338436 -0.0521274   0.07416417  0.01397541]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00249522 -0.00126864 -0.00030274 -0.00148866 -0.00030148]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00249522 -0.00126864 -0.00030274 -0.00148866 -0.00030148]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00114155 -0.0013408   0.00309356 -0.00111514  0.00061068]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.03548973  0.27195346  0.25458795 -0.04836562 -0.02311795]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.08534051  0.27041265  0.23085578 -0.0146007  -0.01675533]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.08534051  0.27041265  0.23085578 -0.0146007  -0.01675533]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02328967 -0.03476764 -0.06364881  0.00364096  0.00347219]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00295119 -0.00480391 -0.00708758  0.00062109  0.00034132]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00295119 -0.00480391 -0.00708758  0.00062109  0.00034132]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.09099177  0.00195749  0.09123597 -0.02237272  0.03809676]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.09099177  0.00195749  0.09123597 -0.02237272  0.03809676]
  [Layer 3] Output shape after mixer: (1, 1, 2048)
  [Layer 3] Output sample values after mixer: [ 0.09099177  0.00195749  0.09123597 -0.02237272  0.03809676]
  [Layer 3] Residual connection shape: (1, 1, 2048)
  [Layer 3] Residual connection sample values: [ 0.03949698  0.06296492  0.12369455 -0.19963828  0.02984159]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.09257365  0.11176423  0.25610366 -0.42753565  0.07016267]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09257365  0.11176423  0.25610366 -0.42753565  0.07016267]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09257365  0.11176423  0.25610366 -0.42753565  0.07016267]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.310976    0.30714792 -0.57339996  0.20972942 -0.9840876 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.310976    0.30714792 -0.57339996  0.20972942 -0.9840876 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.49621466  0.8577647  -0.95171005 -0.19013621 -0.67033505]
  [FlaxMamba2] dt (step) sample values: [ 1.7185076   2.7992208   2.660539    0.48691383 -0.5503483 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.09687654 -1.3303822   1.3904788   0.49621466  1.8117951 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.07108572  0.25351718  0.07468062 -0.42689428  0.32027325]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00270578  0.21836093  0.02646285 -0.44271764  0.61324203]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00135106  0.1210537   0.01340648 -0.17314403  0.39779785]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00135106  0.1210537   0.01340648 -0.17314403  0.39779785]
  [FlaxMamba2] B (step) sample values: [ 0.49347565  0.18240882  0.64832145  1.0504735  -0.06917968]
  [FlaxMamba2] C (step) sample values: [ 0.7369288  -0.2574366  -0.03703546 -0.27813026 -0.01714245]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.7127254  -1.2862217  -1.4869522 -27.028044   -4.0726624]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03376714 0.03886663 0.0270297  0.00526755 0.02203132]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.94380677 0.95123786 0.9606051  0.86729896 0.91418153]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00135106  0.1210537   0.01340648 -0.17314403  0.39779785]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.2513084e-05 -8.3217583e-06 -2.9577377e-05 -4.7924143e-05
  3.1560785e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.2513084e-05 -8.3217583e-06 -2.9577377e-05 -4.7924143e-05
  3.1560785e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.002832   -0.00204897 -0.00225978  0.00070115 -0.00046448]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.03738139 -0.01415141  0.01875636 -0.00661867  0.21162611]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03814187  0.05398695  0.02630256 -0.1040775   0.43553746]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03814187  0.05398695  0.02630256 -0.1040775   0.43553746]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00501583  0.00955435 -0.00543631 -0.01205438 -0.11661602]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00124813  0.00152759 -0.00133    -0.00248517 -0.01434651]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00124813  0.00152759 -0.00133    -0.00248517 -0.01434651]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.0913096   0.0362453   0.04070225 -0.00377457  0.04675925]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.0913096   0.0362453   0.04070225 -0.00377457  0.04675925]
  [Layer 4] Output shape after mixer: (1, 1, 2048)
  [Layer 4] Output sample values after mixer: [-0.0913096   0.0362453   0.04070225 -0.00377457  0.04675925]
  [Layer 4] Residual connection shape: (1, 1, 2048)
  [Layer 4] Residual connection sample values: [-0.05181262  0.09921022  0.1643968  -0.20341285  0.07660083]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.10070017  0.15934466  0.29843065 -0.37866455  0.15362772]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.10070017  0.15934466  0.29843065 -0.37866455  0.15362772]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.10070017  0.15934466  0.29843065 -0.37866455  0.15362772]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.1818403   0.34342915  2.2649176  -1.3481814  -1.9904561 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.1818403   0.34342915  2.2649176  -1.3481814  -1.9904561 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.3624507  1.5349048  0.2524752  0.3147383 -3.6175714]
  [FlaxMamba2] dt (step) sample values: [1.4653518  1.4435489  0.8728133  1.344948   0.14230585]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.33975518 -0.0259489  -0.7607311   1.3624507   3.8007505 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.2165192  -0.15687162  0.03664662 -0.06844901 -0.4373285 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.1649445  -0.19419461 -0.03287242 -0.09457205 -0.44319168]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.08925854 -0.08769894 -0.01616609 -0.04505172 -0.1732794 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.08925854 -0.08769894 -0.01616609 -0.04505172 -0.1732794 ]
  [FlaxMamba2] B (step) sample values: [ 0.15383951 -0.13159598 -0.12377553  0.23292235  0.01940445]
  [FlaxMamba2] C (step) sample values: [ 0.06610201  0.03272716 -0.05607735  0.08245444  0.05718864]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.5762966   -1.0443833   -0.83880144  -5.6764617  -20.401838  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01674082 0.05000558 0.09870524 0.05229551 0.00392909]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.97395664 0.9491153  0.9205407  0.743153   0.92296803]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.08925854 -0.08769894 -0.01616609 -0.04505172 -0.1732794 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.2987647e-04 -1.9663882e-04 -1.8495302e-04  3.4804692e-04
  2.8995330e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.2987647e-04 -1.9663882e-04 -1.8495302e-04  3.4804692e-04
  2.8995330e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00019079 -0.00025633  0.00036701  0.00070274 -0.00059062]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00537424 -0.00718685 -0.03806472 -0.00409311 -0.03502478]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.04260478 -0.05432753 -0.04675446 -0.0283097  -0.1281674 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.04260478 -0.05432753 -0.04675446 -0.0283097  -0.1281674 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03853334 -0.01091516 -0.09593341  0.00786873  0.03066662]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01320841 -0.00381585 -0.03194438  0.00274246  0.00947373]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01320841 -0.00381585 -0.03194438  0.00274246  0.00947373]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.06961814  0.07412583 -0.07578055  0.03295537  0.05692757]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.06961814  0.07412583 -0.07578055  0.03295537  0.05692757]
  [Layer 5] Output shape after mixer: (1, 1, 2048)
  [Layer 5] Output sample values after mixer: [ 0.06961814  0.07412583 -0.07578055  0.03295537  0.05692757]
  [Layer 5] Residual connection shape: (1, 1, 2048)
  [Layer 5] Residual connection sample values: [ 0.01780552  0.17333604  0.08861624 -0.17045748  0.1335284 ]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.02757468  0.20776092  0.121802   -0.24218929  0.20976862]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.02757468  0.20776092  0.121802   -0.24218929  0.20976862]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.02757468  0.20776092  0.121802   -0.24218929  0.20976862]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.5757431  -1.56099    -1.2645236  -1.3052737  -0.76099485]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.5757431  -1.56099    -1.2645236  -1.3052737  -0.76099485]
  [FlaxMamba2] xBC (step) sample values: [ 0.17969343  0.7129316   0.05860366  1.3582684  -1.3140756 ]
  [FlaxMamba2] dt (step) sample values: [1.9922365  1.8435302  0.89529294 0.03201995 1.2804897 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.05953435 -0.11477014 -0.0793758   0.17969343  0.23240817]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.01917677  0.06675918 -1.9171873  -0.37711143 -1.1058149 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01518602 -0.00556748 -1.9793516  -0.31500816 -1.0361128 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00765066 -0.00277599 -0.24026948 -0.13289967 -0.2713587 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00765066 -0.00277599 -0.24026948 -0.13289967 -0.2713587 ]
  [FlaxMamba2] B (step) sample values: [ 0.3874416  -0.03807471 -0.26109496  0.67475426  0.07309975]
  [FlaxMamba2] C (step) sample values: [-0.24460897 -0.1380989  -0.16508406 -0.14359385  0.3047964 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.98658675 -8.774721   -3.3045902  -2.9912853  -3.3435438 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06734837 0.08375258 0.19418976 0.06803472 0.1029629 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.93571436 0.47955075 0.5263876  0.815861   0.70874393]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00765066 -0.00277599 -0.24026948 -0.13289967 -0.2713587 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.9963301e-04 -1.9618361e-05 -1.3453169e-04  3.4767363e-04
  3.7665348e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.9963301e-04 -1.9618361e-05 -1.3453169e-04  3.4767363e-04
  3.7665348e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01535126 -0.00046856 -0.00950912 -0.00057903  0.00344345]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.12534755 -0.20907986 -0.3321107  -0.06696553 -0.26903522]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.12700433 -0.209681   -0.38414174 -0.09574533 -0.32779872]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.12700433 -0.209681   -0.38414174 -0.09574533 -0.32779872]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.16582473 0.05678979 0.10696167 0.02665428 0.07943345]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.05713889 0.00916735 0.01641385 0.00531825 0.01118762]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.05713889 0.00916735 0.01641385 0.00531825 0.01118762]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.08472488  0.10536721 -0.03782091  0.02912875  0.07819153]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.08472488  0.10536721 -0.03782091  0.02912875  0.07819153]
  [Layer 6] Output shape after mixer: (1, 1, 2048)
  [Layer 6] Output sample values after mixer: [ 0.08472488  0.10536721 -0.03782091  0.02912875  0.07819153]
  [Layer 6] Residual connection shape: (1, 1, 2048)
  [Layer 6] Residual connection sample values: [ 0.1025304   0.27870324  0.05079534 -0.14132872  0.21171993]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.09773609  0.2206621   0.04488696 -0.12335105  0.20246023]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09773609  0.2206621   0.04488696 -0.12335105  0.20246023]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09773609  0.2206621   0.04488696 -0.12335105  0.20246023]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.2346221  -0.4950028  -1.1343157  -0.02850619  0.1176167 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.2346221  -0.4950028  -1.1343157  -0.02850619  0.1176167 ]
  [FlaxMamba2] xBC (step) sample values: [-2.2220976  -0.81983835 -0.6863976   0.93733007  0.6041026 ]
  [FlaxMamba2] dt (step) sample values: [1.539057  1.0056483 3.11867   2.670902  1.7323067]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.787138  -1.6185312 -3.4465427 -2.2220976  0.1545884]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.12722418  0.27958095 -0.24089174 -0.35523778 -0.35123456]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.19533941  0.30420864 -0.2416418  -0.34881383 -0.354828  ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.08816055  0.17506327 -0.10629383 -0.14429384 -0.14626442]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08816055  0.17506327 -0.10629383 -0.14429384 -0.14626442]
  [FlaxMamba2] B (step) sample values: [ 0.06585934  0.0141075  -0.22515829  0.02916852 -0.06827848]
  [FlaxMamba2] C (step) sample values: [ 0.11232142 -0.05414249  0.07550284 -0.09143086  0.10292159]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.29588825 -1.1836219  -0.3113019  -0.1314279  -1.5015444 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.07888932 0.01631287 0.05559159 0.197704   0.00605627]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9769279  0.9808769  0.9828431  0.97435087 0.9909475 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08816055  0.17506327 -0.10629383 -0.14429384 -0.14626442]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.5804682e-04 -9.8116630e-05  1.5659592e-03 -2.0286492e-04
  4.7487172e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.5804682e-04 -9.8116630e-05  1.5659592e-03 -2.0286492e-04
  4.7487172e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.2171672e-03  2.9576133e-04  1.0169763e-04 -4.0861298e-05
 -2.5153905e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-4.5917423e-05  2.1522038e-03  3.0208223e-03 -3.4739776e-04
 -1.3921390e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00024763  0.00255276  0.00277762 -0.00067755 -0.0017268 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00024763  0.00255276  0.00277762 -0.00067755 -0.0017268 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-3.2442422e-05 -4.7855341e-04 -7.6677045e-04  9.5195337e-06
 -1.0751531e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-1.3805332e-04 -1.1341796e-03 -4.2881155e-03  3.7549391e-05
 -5.7898997e-04]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-1.3805332e-04 -1.1341796e-03 -4.2881155e-03  3.7549391e-05
 -5.7898997e-04]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.13265793  0.09467012  0.04813391  0.08912916  0.01728288]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.13265793  0.09467012  0.04813391  0.08912916  0.01728288]
  [Layer 7] Output shape after mixer: (1, 1, 2048)
  [Layer 7] Output sample values after mixer: [-0.13265793  0.09467012  0.04813391  0.08912916  0.01728288]
  [Layer 7] Residual connection shape: (1, 1, 2048)
  [Layer 7] Residual connection sample values: [-0.03012753  0.37337336  0.09892925 -0.05219956  0.22900282]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03405266  0.330301    0.10419419 -0.05469823  0.25761268]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03405266  0.330301    0.10419419 -0.05469823  0.25761268]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03405266  0.330301    0.10419419 -0.05469823  0.25761268]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.5377178  -2.561687   -0.44362372 -2.188953   -1.2127513 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.5377178  -2.561687   -0.44362372 -2.188953   -1.2127513 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.5939753  -0.32259572 -0.8893963  -0.12788847 -0.06734711]
  [FlaxMamba2] dt (step) sample values: [0.73029387 0.48414487 1.1490594  0.6103973  0.18151912]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.36608806 0.7768992  0.77030414 0.5939753  1.5788927 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [0.10221865 0.29956335 0.17574835 0.15049516 0.02283208]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.56510925  0.26854223 -0.13894892  0.09892045 -0.03328975]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.3603328   0.15219228 -0.06465551  0.05190454 -0.01636785]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.3603328   0.15219228 -0.06465551  0.05190454 -0.01636785]
  [FlaxMamba2] B (step) sample values: [ 0.47409052 -0.04902838 -0.01207233 -0.18106198  0.02012198]
  [FlaxMamba2] C (step) sample values: [ 0.06774429 -0.19645149  0.11328673 -0.19179188 -0.22295764]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.6542776 -0.9827404 -0.5549556 -3.9396574 -1.8081155]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02077794 0.08662234 0.03471662 0.0438727  0.01155103]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9268826 0.9183954 0.9809182 0.8412693 0.979331 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.3603328   0.15219228 -0.06465551  0.05190454 -0.01636785]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.5495039e-03 -3.6707427e-04 -9.0385249e-05 -1.3556065e-03
  1.5065279e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.5495039e-03 -3.6707427e-04 -9.0385249e-05 -1.3556065e-03
  1.5065279e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00428835  0.00224133  0.00125989 -0.00321979 -0.00062424]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.07029273 -0.00789292 -0.02801699 -0.0211935  -0.01152375]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.3736209   0.12022254 -0.082444    0.02249975 -0.02530221]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.3736209   0.12022254 -0.082444    0.02249975 -0.02530221]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.12682608 -0.02206477  0.01429601 -0.00496188  0.00703352]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.04697755 -0.01041251  0.00458593 -0.00249393  0.00421744]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04697755 -0.01041251  0.00458593 -0.00249393  0.00421744]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.0072687  -0.06420813  0.03314595 -0.15694465  0.02103913]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.0072687  -0.06420813  0.03314595 -0.15694465  0.02103913]
  [Layer 8] Output shape after mixer: (1, 1, 2048)
  [Layer 8] Output sample values after mixer: [-0.0072687  -0.06420813  0.03314595 -0.15694465  0.02103913]
  [Layer 8] Residual connection shape: (1, 1, 2048)
  [Layer 8] Residual connection sample values: [-0.03739623  0.30916524  0.13207519 -0.2091442   0.25004196]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03167773  0.21397907  0.10285256 -0.15640567  0.20908543]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03167773  0.21397907  0.10285256 -0.15640567  0.20908543]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03167773  0.21397907  0.10285256 -0.15640567  0.20908543]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.1074318  -1.6438292  -0.2577243  -2.0183063  -0.33091944]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.1074318  -1.6438292  -0.2577243  -2.0183063  -0.33091944]
  [FlaxMamba2] xBC (step) sample values: [ 0.2393057   0.32494932 -0.19792137  0.34210002 -1.1412636 ]
  [FlaxMamba2] dt (step) sample values: [2.5816088 2.2358546 2.9717407 0.5032577 1.6491883]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.7055616  1.514101   2.0374093  0.2393057  0.41203526]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.43035856  0.03868667 -0.06893466  0.3330842  -0.36366582]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.42300764  0.01334182 -0.15560459  0.25917062 -0.33862615]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.16742526  0.00671541 -0.07176128  0.1462843  -0.14091699]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.16742526  0.00671541 -0.07176128  0.1462843  -0.14091699]
  [FlaxMamba2] B (step) sample values: [ 0.4654644  -0.10326208  0.39147526  0.40450022 -0.08099454]
  [FlaxMamba2] C (step) sample values: [-0.25909987 -0.19094495 -0.27690038  0.2331156   0.22554822]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-5.234511  -1.2161361 -1.4887683 -0.9523448 -3.9666808]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.12594992 0.30534193 0.08986337 0.202724   0.07924377]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.5172204  0.68981117 0.8747775  0.8244299  0.73027456]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.16742526  0.00671541 -0.07176128  0.1462843  -0.14091699]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00981534  0.00217751 -0.00825512 -0.00852978  0.00170795]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00981534  0.00217751 -0.00825512 -0.00852978  0.00170795]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-8.50234274e-03  3.81472521e-03 -7.32419919e-03 -1.07425805e-02
 -8.72703968e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.03677841  0.00340361 -0.0432896   0.0113317  -0.02056612]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.26373208  0.0125067  -0.14056575  0.20962769 -0.21158643]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.26373208  0.0125067  -0.14056575  0.20962769 -0.21158643]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.07253441 -0.0033294   0.01579228 -0.04962635  0.02926873]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.02710679 -0.00185403  0.00587947 -0.01456923  0.0125153 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02710679 -0.00185403  0.00587947 -0.01456923  0.0125153 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.33172634  0.07036816  0.08496551 -0.04238411 -0.13560402]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.33172634  0.07036816  0.08496551 -0.04238411 -0.13560402]
  [Layer 9] Output shape after mixer: (1, 1, 2048)
  [Layer 9] Output sample values after mixer: [-0.33172634  0.07036816  0.08496551 -0.04238411 -0.13560402]
  [Layer 9] Residual connection shape: (1, 1, 2048)
  [Layer 9] Residual connection sample values: [-0.36912256  0.3795334   0.2170407  -0.25152832  0.11443794]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.21046865  0.18087563  0.11171075 -0.12817717  0.06377063]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.21046865  0.18087563  0.11171075 -0.12817717  0.06377063]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.21046865  0.18087563  0.11171075 -0.12817717  0.06377063]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.05804131 -0.8002141   0.10051748 -0.6536916  -1.5378964 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.05804131 -0.8002141   0.10051748 -0.6536916  -1.5378964 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.39297265  1.538493   -0.3590837  -0.03475082 -0.68078595]
  [FlaxMamba2] dt (step) sample values: [2.0854294  0.9994368  0.28231466 1.9490495  1.5139213 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.7617132   0.7225964   2.0155783   0.39297265  2.3396902 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.05501296 -0.3319647   0.01033679 -0.00721611 -0.15088958]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01665237 -0.41906187 -0.09348401 -0.09303154 -0.21045989]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00839551 -0.16625912 -0.04455879 -0.04435361 -0.0941973 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00839551 -0.16625912 -0.04455879 -0.04435361 -0.0941973 ]
  [FlaxMamba2] B (step) sample values: [ 0.04200848 -0.14171371  0.04973371 -0.00196336  0.34819758]
  [FlaxMamba2] C (step) sample values: [-0.19156198 -0.16050711 -0.26217756 -0.15586503 -0.1483864 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.7154508  -1.4067873  -0.35344088 -2.010216   -0.4652703 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00352878 0.00963739 0.1236042  0.01275259 0.03397867]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9869746  0.9865337  0.95725375 0.9746903  0.98431504]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00839551 -0.16625912 -0.04455879 -0.04435361 -0.0941973 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.2445373e-06 -4.1983903e-06  1.4734038e-06 -5.8166222e-08
  1.0315653e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.2445373e-06 -4.1983903e-06  1.4734038e-06 -5.8166222e-08
  1.0315653e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.4020746e-05  3.3966469e-05  3.3003089e-05  5.5333239e-05
  7.4780592e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 1.6164478e-04 -1.8486878e-03  6.4417200e-06 -4.9624516e-04
  5.1498151e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00200631 -0.03837925 -0.00978404 -0.01024165 -0.02018211]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00200631 -0.03837925 -0.00978404 -0.01024165 -0.02018211]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-5.6535227e-05  9.5199784e-03 -5.1642675e-04  2.2907073e-03
  5.4887980e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00042007  0.03446906 -0.00300473  0.01516867  0.03363588]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00042007  0.03446906 -0.00300473  0.01516867  0.03363588]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.18049964  0.07611908  0.06915977  0.19990498 -0.19350667]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.18049964  0.07611908  0.06915977  0.19990498 -0.19350667]
  [Layer 10] Output shape after mixer: (1, 1, 2048)
  [Layer 10] Output sample values after mixer: [ 0.18049964  0.07611908  0.06915977  0.19990498 -0.19350667]
  [Layer 10] Residual connection shape: (1, 1, 2048)
  [Layer 10] Residual connection sample values: [-0.18862292  0.45565248  0.28620046 -0.05162334 -0.07906874]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.11607457  0.22813128  0.1573217  -0.02768516 -0.04651249]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.11607457  0.22813128  0.1573217  -0.02768516 -0.04651249]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.11607457  0.22813128  0.1573217  -0.02768516 -0.04651249]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.7146617   0.08029411  0.41111097 -0.89974624  0.28578365]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.7146617   0.08029411  0.41111097 -0.89974624  0.28578365]
  [FlaxMamba2] xBC (step) sample values: [ 0.0569149   1.7948288   0.8932888   2.0630665  -0.13313963]
  [FlaxMamba2] dt (step) sample values: [1.6317447 1.996573  1.5929723 2.8814654 2.5661855]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5253639 -0.5230793  0.8702426  0.0569149  1.1323724]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.06951183 -0.34963137 -0.25979915 -0.22014672 -0.01438843]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.08371776 -0.7072974  -0.16324154 -0.20800072  0.00877441]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04010774 -0.23354697 -0.07497358 -0.09322311  0.00440645]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04010774 -0.23354697 -0.07497358 -0.09322311  0.00440645]
  [FlaxMamba2] B (step) sample values: [-0.25993958 -0.2759025  -0.27752823 -0.00879848 -0.01500375]
  [FlaxMamba2] C (step) sample values: [-0.03191642 -0.1319648  -0.2575185  -0.17197736 -0.02492992]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.31160602 -0.09015273 -1.5786072  -0.20961139 -0.6694042 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08687732 0.21133435 0.48644271 0.5762048  0.09299552]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.97329164 0.981128   0.4639855  0.88622975 0.9396464 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04010774 -0.23354697 -0.07497358 -0.09322311  0.00440645]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [9.0574718e-04 9.6136919e-04 9.6703396e-04 3.0657891e-05 5.2279855e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [9.0574718e-04 9.6136919e-04 9.6703396e-04 3.0657891e-05 5.2279855e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.04585401 -0.04278975  0.05352266  0.01119397 -0.0470027 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.1189671  -0.2500718   0.15610498 -0.07831818  0.02125174]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.13368173 -0.33575493  0.12859885 -0.11251964  0.02286837]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.13368173 -0.33575493  0.12859885 -0.11251964  0.02286837]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03139062 -0.01402045  0.03179264  0.0292685   0.00373148]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01637252 -0.00716737  0.01152714  0.03458441  0.00144808]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01637252 -0.00716737  0.01152714  0.03458441  0.00144808]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.41899678  0.23010911  0.17235813 -0.00996663  0.30804133]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.41899678  0.23010911  0.17235813 -0.00996663  0.30804133]
  [Layer 11] Output shape after mixer: (1, 1, 2048)
  [Layer 11] Output sample values after mixer: [ 0.41899678  0.23010911  0.17235813 -0.00996663  0.30804133]
  [Layer 11] Residual connection shape: (1, 1, 2048)
  [Layer 11] Residual connection sample values: [ 0.23037386  0.6857616   0.4585586  -0.06158997  0.2289726 ]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.10795908  0.2666649   0.18771324 -0.02504158  0.10279977]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10795908  0.2666649   0.18771324 -0.02504158  0.10279977]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.10795908  0.2666649   0.18771324 -0.02504158  0.10279977]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.76802295 -1.1509331  -0.7787131  -0.93822765 -0.80019605]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.76802295 -1.1509331  -0.7787131  -0.93822765 -0.80019605]
  [FlaxMamba2] xBC (step) sample values: [-0.86049336  0.04524883 -0.5800428  -0.08868881  0.6866393 ]
  [FlaxMamba2] dt (step) sample values: [2.3719115 2.265933  2.0392792 1.0341389 1.5797825]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6304363  -0.6395428   0.39472455 -0.86049336 -0.177373  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.13459703 -0.02111956 -0.20658943  0.04372635  0.1304379 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.1775963  -0.00822589 -0.24147102  0.01401749  0.14305691]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.0809337  -0.00409603 -0.10622888  0.00705786  0.07663607]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0809337  -0.00409603 -0.10622888  0.00705786  0.07663607]
  [FlaxMamba2] B (step) sample values: [ 0.0059554  -0.0979939   0.50647205 -0.10858452  0.07289494]
  [FlaxMamba2] C (step) sample values: [ 0.28690746 -0.14022888 -0.07308729 -0.16715154 -0.1993909 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2411823 -0.7693517 -1.9974962 -1.2367963 -1.0181218]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.38090536 0.5145515  0.19067548 0.24187954 0.33092493]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6232715  0.67309344 0.68326426 0.74144393 0.7139646 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0809337  -0.00409603 -0.10622888  0.00705786  0.07663607]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00018359  0.00302096 -0.01561356  0.00334745 -0.00224721]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00018359  0.00302096 -0.01561356  0.00334745 -0.00224721]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00165323  0.00792592 -0.02211256  0.00585109 -0.00228247]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01976874 -0.01498433 -0.013564   -0.00741429 -0.01055831]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07802597 -0.01793271 -0.09002908 -0.00233394  0.04460543]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07802597 -0.01793271 -0.09002908 -0.00233394  0.04460543]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01899088  0.00496002  0.02205542  0.00061589 -0.01106427]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.04401943  0.00757284  0.02545008  0.00081288 -0.02099717]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.04401943  0.00757284  0.02545008  0.00081288 -0.02099717]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.46786463 -0.18175209 -0.19206354 -0.58589554  0.23256165]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.46786463 -0.18175209 -0.19206354 -0.58589554  0.23256165]
  [Layer 12] Output shape after mixer: (1, 1, 2048)
  [Layer 12] Output sample values after mixer: [-0.46786463 -0.18175209 -0.19206354 -0.58589554  0.23256165]
  [Layer 12] Residual connection shape: (1, 1, 2048)
  [Layer 12] Residual connection sample values: [-0.23749077  0.5040095   0.26649505 -0.6474855   0.46153426]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.08382195  0.15394883  0.08679309 -0.19846292  0.16535543]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.08382195  0.15394883  0.08679309 -0.19846292  0.16535543]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.08382195  0.15394883  0.08679309 -0.19846292  0.16535543]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-3.3700025   0.3975605   0.26109543  1.9615711  -0.315771  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-3.3700025   0.3975605   0.26109543  1.9615711  -0.315771  ]
  [FlaxMamba2] xBC (step) sample values: [ 0.23475601  0.1387446  -0.08492186  0.80820274  0.23655704]
  [FlaxMamba2] dt (step) sample values: [2.1382396 1.9397933 1.8942399 1.5393409 1.7981485]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.7109807  -0.64950573 -0.5728934   0.23475601  0.10807925]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.15507728 -0.20148607  0.26953945 -0.2251157  -0.15304577]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.41972572 -0.31141037  0.24906215 -0.2259206  -0.17700207]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.16645582 -0.13165513  0.1399594  -0.10025427 -0.08068899]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.16645582 -0.13165513  0.1399594  -0.10025427 -0.08068899]
  [FlaxMamba2] B (step) sample values: [ 0.084985   -0.20626666 -0.06545415  0.5345519   0.2384472 ]
  [FlaxMamba2] C (step) sample values: [ 0.24157466  0.01600148 -0.09938722  0.44323647  0.2127846 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3103099 -1.7870504 -0.8605819 -1.881061  -0.5251649]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.07870898 0.06598163 0.23093145 0.20110796 0.10183021]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.90200686 0.8887738  0.81976676 0.6850275  0.9479271 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.16645582 -0.13165513  0.1399594  -0.10025427 -0.08068899]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00111344  0.00270242  0.00085755 -0.00700347 -0.00312403]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00111344  0.00270242  0.00085755 -0.00700347 -0.00312403]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00144231 -0.00411799  0.00214922 -0.04413709 -0.00211371]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.09681758  0.01631521  0.05358479 -0.02758543  0.0130781 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.10398357  0.0106474   0.05961009 -0.03190142  0.00960441]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.10398357  0.0106474   0.05961009 -0.03190142  0.00960441]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0116503   0.00253176  0.00879215 -0.05486135 -0.00127895]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.03133727  0.00224631  0.03198615 -0.22719008 -0.00202078]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03133727  0.00224631  0.03198615 -0.22719008 -0.00202078]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.7218731e-01 -8.5322686e-02  1.6752933e-01 -7.9507219e-05
  2.1903355e-01]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.7218731e-01 -8.5322686e-02  1.6752933e-01 -7.9507219e-05
  2.1903355e-01]
  [Layer 13] Output shape after mixer: (1, 1, 2048)
  [Layer 13] Output sample values after mixer: [-1.7218731e-01 -8.5322686e-02  1.6752933e-01 -7.9507219e-05
  2.1903355e-01]
  [Layer 13] Residual connection shape: (1, 1, 2048)
  [Layer 13] Residual connection sample values: [-0.4096781  0.4186868  0.4340244 -0.647565   0.6805678]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.10555599  0.09475082  0.10353953 -0.1452636   0.1711831 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.10555599  0.09475082  0.10353953 -0.1452636   0.1711831 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.10555599  0.09475082  0.10353953 -0.1452636   0.1711831 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.02360394  0.067467   -0.30814165  0.11994381 -0.10442029]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.02360394  0.067467   -0.30814165  0.11994381 -0.10442029]
  [FlaxMamba2] xBC (step) sample values: [-1.2849444   0.35224518  0.2567114  -0.8128586   0.3961301 ]
  [FlaxMamba2] dt (step) sample values: [0.90992314 1.2543042  1.217202   1.2914147  2.3400598 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.5263305 -1.276522  -1.3515543 -1.2849444  0.6926591]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.36931843 -0.13821718 -0.03613494 -0.2502846  -0.05412456]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.4088692  -0.17947695 -0.09698699 -0.3130898  -0.0175645 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.16321376 -0.08170702 -0.04614372 -0.13223684 -0.00870512]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.16321376 -0.08170702 -0.04614372 -0.13223684 -0.00870512]
  [FlaxMamba2] B (step) sample values: [-0.07907358 -0.03127125  0.0706555  -0.11042272 -0.00947944]
  [FlaxMamba2] C (step) sample values: [-1.83615357e-01 -1.15484975e-01  1.23298087e-04 -1.94899350e-01
 -7.22570643e-02]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.318424  -0.7620611 -2.6670074 -5.1836414 -2.8487349]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.09545307 0.04156028 0.25158453 0.05889911 0.13560106]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6621873  0.9688248  0.5112085  0.73689353 0.6795724 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.16321376 -0.08170702 -0.04614372 -0.13223684 -0.00870512]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00123191  0.00048718 -0.00110076  0.0017203   0.00014768]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00123191  0.00048718 -0.00110076  0.0017203   0.00014768]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00287563  0.00067545 -0.00246516  0.00307758  0.00074928]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01861721 -0.00687289 -0.00739302 -0.01274841 -0.00137509]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.08459204 -0.03990078 -0.02604539 -0.06620164 -0.00489391]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.08459204 -0.03990078 -0.02604539 -0.06620164 -0.00489391]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00098657 -0.00139138  0.00339942 -0.00420806  0.00024218]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00543287 -0.00445925  0.01580968 -0.02751276  0.00183558]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00543287 -0.00445925  0.01580968 -0.02751276  0.00183558]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.26343682 -0.50206506  0.04614726  0.49238318 -0.01678999]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.26343682 -0.50206506  0.04614726  0.49238318 -0.01678999]
  [Layer 14] Output shape after mixer: (1, 1, 2048)
  [Layer 14] Output sample values after mixer: [ 0.26343682 -0.50206506  0.04614726  0.49238318 -0.01678999]
  [Layer 14] Residual connection shape: (1, 1, 2048)
  [Layer 14] Residual connection sample values: [-0.14624128 -0.08337826  0.48017165 -0.15518183  0.6637778 ]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.03074111 -0.01490083  0.09277672 -0.02807408  0.13369747]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03074111 -0.01490083  0.09277672 -0.02807408  0.13369747]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.03074111 -0.01490083  0.09277672 -0.02807408  0.13369747]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.4150019   0.83106863 -0.2714273  -1.0481681  -0.7236906 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.4150019   0.83106863 -0.2714273  -1.0481681  -0.7236906 ]
  [FlaxMamba2] xBC (step) sample values: [-0.04488943 -0.15259798  0.25692394  0.60790205  0.17135523]
  [FlaxMamba2] dt (step) sample values: [0.52048934 0.9815016  1.7339977  0.01518364 0.93124294]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6432447   0.05313125 -0.19407633 -0.04488943 -1.235002  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.0384606   0.03952195 -0.07921723 -0.06147908 -0.05530208]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.07590567  0.03266694 -0.1039975  -0.07922506 -0.08064692]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03651311  0.01660023 -0.04929731 -0.0380442  -0.03869836]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03651311  0.01660023 -0.04929731 -0.0380442  -0.03869836]
  [FlaxMamba2] B (step) sample values: [-0.07335067 -0.03892769  0.01999622 -0.0303028   0.01474923]
  [FlaxMamba2] C (step) sample values: [-0.02858071  0.01350761  0.01710001  0.01500529 -0.03137558]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.27823287 -0.68077636 -2.7209377  -0.11263601 -3.8483953 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00325607 0.04174554 0.08280363 0.00581171 0.05774745]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9990945  0.97198063 0.7982739  0.9993456  0.8007271 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03651311  0.01660023 -0.04929731 -0.0380442  -0.03869836]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.7206163e-06  4.6280888e-06 -2.3773382e-06  3.6026813e-06
 -1.7535269e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.7206163e-06  4.6280888e-06 -2.3773382e-06  3.6026813e-06
 -1.7535269e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-5.2010699e-05  1.3436023e-05 -2.1044474e-05 -1.3053621e-05
 -9.6514386e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-2.7296888e-05  4.3816231e-05 -2.1748814e-05 -3.7867991e-05
 -3.9726790e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00625022  0.00287299 -0.00842348 -0.00652173 -0.00663508]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00625022  0.00287299 -0.00842348 -0.00652173 -0.00663508]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00711553  0.00166319  0.00098898  0.00177444  0.00156816]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.12677671  0.03871851  0.01775357  0.03704317  0.02402552]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.12677671  0.03871851  0.01775357  0.03704317  0.02402552]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.2600611  -0.30160642 -0.4335738  -0.1642513   0.33302173]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.2600611  -0.30160642 -0.4335738  -0.1642513   0.33302173]
  [Layer 15] Output shape after mixer: (1, 1, 2048)
  [Layer 15] Output sample values after mixer: [-0.2600611  -0.30160642 -0.4335738  -0.1642513   0.33302173]
  [Layer 15] Residual connection shape: (1, 1, 2048)
  [Layer 15] Residual connection sample values: [-0.40630236 -0.38498467  0.04659784 -0.31943312  0.9967996 ]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.08686765 -0.06881479  0.00912722 -0.05731135  0.2047143 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.08686765 -0.06881479  0.00912722 -0.05731135  0.2047143 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.08686765 -0.06881479  0.00912722 -0.05731135  0.2047143 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.490526   -0.38080892  0.28762954  0.7669845  -0.61354864]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.490526   -0.38080892  0.28762954  0.7669845  -0.61354864]
  [FlaxMamba2] xBC (step) sample values: [ 0.272198   -0.08356655  0.46500796  0.4789018  -1.3026924 ]
  [FlaxMamba2] dt (step) sample values: [1.0368176 1.5826328 2.3847048 0.7781329 2.7998927]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.6344718   0.647479    0.7790512   0.272198   -0.59972036]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12313323 -0.09441128  0.12326716  0.32467377 -0.3325785 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.08700041 -0.13554898  0.11013697  0.23226655 -0.37466225]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.04539128 -0.06318812  0.05809797  0.1295599  -0.152643  ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04539128 -0.06318812  0.05809797  0.1295599  -0.152643  ]
  [FlaxMamba2] B (step) sample values: [-0.14012921 -0.05019793  0.06860382 -0.04118673 -0.24312213]
  [FlaxMamba2] C (step) sample values: [ 0.27034205 -0.04107031 -0.07255451  0.86380935 -0.24362874]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6905513  -0.13480766 -1.3128716  -3.7739606  -1.2635014 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.15337999 0.29398966 0.43346715 0.15353377 0.32801732]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.6618762 0.961143  0.5660422 0.5602174 0.6607033]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04539128 -0.06318812  0.05809797  0.1295599  -0.152643  ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0009756  -0.00034948  0.00047763 -0.00028675 -0.00169264]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0009756  -0.00034948  0.00047763 -0.00028675 -0.00169264]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00667019 -0.00135277  0.00114654 -0.00057948  0.00351507]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.06456526 -0.03961912  0.0053272   0.07271766 -0.04913876]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.09377813 -0.08028567  0.04271784  0.1560997  -0.1473766 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.09377813 -0.08028567  0.04271784  0.1560997  -0.1473766 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01746964  0.01241076  0.00702094  0.08175712  0.03176099]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.05241209  0.0292274   0.0198156   0.20558564  0.08203811]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.05241209  0.0292274   0.0198156   0.20558564  0.08203811]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.0679725   0.59130013  0.725647    0.65127605 -0.30744433]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.0679725   0.59130013  0.725647    0.65127605 -0.30744433]
  [Layer 16] Output shape after mixer: (1, 1, 2048)
  [Layer 16] Output sample values after mixer: [ 1.0679725   0.59130013  0.725647    0.65127605 -0.30744433]
  [Layer 16] Residual connection shape: (1, 1, 2048)
  [Layer 16] Residual connection sample values: [0.6616702  0.20631546 0.7722448  0.33184293 0.68935525]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.11135145 0.02917487 0.11576603 0.04600894 0.11161619]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.11135145 0.02917487 0.11576603 0.04600894 0.11161619]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.11135145 0.02917487 0.11576603 0.04600894 0.11161619]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.1600537  -0.474319   -0.32730693  0.2958129  -0.03044971]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.1600537  -0.474319   -0.32730693  0.2958129  -0.03044971]
  [FlaxMamba2] xBC (step) sample values: [-1.1873327  -0.6482814   0.67320836 -0.69125134  0.01518784]
  [FlaxMamba2] dt (step) sample values: [0.6570532  0.5147759  0.98616207 2.005077   1.1320235 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.2432877  -0.46844298 -0.35404056 -1.1873327  -0.19948992]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.23369347  0.12732497 -0.15694706 -0.01021304 -0.00432333]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.2654928   0.10112563 -0.17130558 -0.01561465  0.00831095]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.11522758  0.05311723 -0.07833428 -0.00774637  0.00417274]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.11522758  0.05311723 -0.07833428 -0.00774637  0.00417274]
  [FlaxMamba2] B (step) sample values: [-0.09608808  0.06612146  0.06569248  0.01880745  0.10961244]
  [FlaxMamba2] C (step) sample values: [-0.18106629 -0.15763678 -0.00959181 -0.01866493 -0.01239587]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.1570504  -11.466768   -14.214988    -0.12863436 -14.242779  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00099014 0.01711139 0.05688996 0.15220352 0.02175111]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.998855   0.82183766 0.44544116 0.9806118  0.73359644]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.11522758  0.05311723 -0.07833428 -0.00774637  0.00417274]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0962864e-05 -7.5439175e-06 -7.4949739e-06 -2.1457761e-06
 -1.2505883e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0962864e-05 -7.5439175e-06 -7.4949739e-06 -2.1457761e-06
 -1.2505883e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-5.4685104e-05  7.6088174e-05  1.0006664e-04 -2.6379814e-04
 -2.1072574e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-2.2111708e-04  1.5487170e-05 -2.1734212e-04  7.7627074e-06
  1.0987258e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07453773  0.03427371 -0.05073943 -0.0049883   0.0028011 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07453773  0.03427371 -0.05073943 -0.0049883   0.0028011 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-6.441366e-03 -6.235971e-03  6.956761e-03 -8.461387e-04 -4.199716e-05]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.05446067 -0.06439634  0.0545271  -0.00807633 -0.00040242]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.05446067 -0.06439634  0.0545271  -0.00807633 -0.00040242]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [0.36987588 0.56132084 0.1222668  0.77073747 0.0166597 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [0.36987588 0.56132084 0.1222668  0.77073747 0.0166597 ]
  [Layer 17] Output shape after mixer: (1, 1, 2048)
  [Layer 17] Output sample values after mixer: [0.36987588 0.56132084 0.1222668  0.77073747 0.0166597 ]
  [Layer 17] Residual connection shape: (1, 1, 2048)
  [Layer 17] Residual connection sample values: [1.0315461  0.7676363  0.8945116  1.1025804  0.70601493]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.13379836 0.08419002 0.10375072 0.1200171  0.08802289]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.13379836 0.08419002 0.10375072 0.1200171  0.08802289]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.13379836 0.08419002 0.10375072 0.1200171  0.08802289]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.5636616  -1.1075093   0.04135213 -0.3215503  -0.9016129 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.5636616  -1.1075093   0.04135213 -0.3215503  -0.9016129 ]
  [FlaxMamba2] xBC (step) sample values: [-0.40584886  0.1566485   0.4410069  -0.0681473  -0.78276014]
  [FlaxMamba2] dt (step) sample values: [0.72469723 1.34555    0.04540111 1.5866319  1.8619353 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.99266255 -0.02576631 -0.91999096 -0.40584886  0.20882753]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.29534966 -0.02953831  0.03612768 -0.19013444 -0.27413002]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.30535942 -0.29491916  0.31591284 -0.20396653 -0.31621376]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.12954809 -0.12587151  0.18270119 -0.09161858 -0.13331532]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.12954809 -0.12587151  0.18270119 -0.09161858 -0.13331532]
  [FlaxMamba2] B (step) sample values: [-0.02142565 -0.01647882 -0.13059081  0.18490198  0.03790687]
  [FlaxMamba2] C (step) sample values: [-0.2328065   0.08880308  0.04401197 -0.0323882   0.07906327]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3010656 -1.4685526 -1.2082934 -1.2128745 -2.5874777]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.18829331 0.19506422 0.07673255 0.31927502 0.2481745 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.78271866 0.7509155  0.91145283 0.6789278  0.5261621 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.12954809 -0.12587151  0.18270119 -0.09161858 -0.13331532]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00052264  0.00040197  0.00318551 -0.00451032 -0.00092466]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00052264  0.00040197  0.00318551 -0.00451032 -0.00092466]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00512193  0.00448077  0.00649405 -0.00478838 -0.00012976]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00055113 -0.12850007  0.1445034  -0.07886761  0.00618749]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02448253 -0.15282328  0.17980827 -0.09657183 -0.01957414]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02448253 -0.15282328  0.17980827 -0.09657183 -0.01957414]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00879464  0.04203159  0.00379458  0.01305139  0.0050954 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.06777291  0.13302256  0.02184383  0.09666728  0.05939786]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.06777291  0.13302256  0.02184383  0.09666728  0.05939786]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.14021665 -0.8747938  -0.12754023 -1.1452184   0.601143  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.14021665 -0.8747938  -0.12754023 -1.1452184   0.601143  ]
  [Layer 18] Output shape after mixer: (1, 1, 2048)
  [Layer 18] Output sample values after mixer: [ 0.14021665 -0.8747938  -0.12754023 -1.1452184   0.601143  ]
  [Layer 18] Residual connection shape: (1, 1, 2048)
  [Layer 18] Residual connection sample values: [ 1.1717627  -0.10715753  0.76697135 -0.04263794  1.307158  ]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.11870582 -0.00937143  0.07252583 -0.00371343  0.13213772]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11870582 -0.00937143  0.07252583 -0.00371343  0.13213772]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11870582 -0.00937143  0.07252583 -0.00371343  0.13213772]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.20011495  0.39810553 -0.1604656  -0.8683436  -1.3554044 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.20011495  0.39810553 -0.1604656  -0.8683436  -1.3554044 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.12690578  0.00564661 -0.33798748 -0.17880745 -0.11766534]
  [FlaxMamba2] dt (step) sample values: [0.8226831 1.6173667 1.5510858 1.2919399 0.9090784]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6588937  -0.02575407 -1.3337432   0.12690578 -0.666358  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.21449767  0.04045935 -0.0884962   0.03877736  0.03584302]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.25014222  0.01612158 -0.09349727 -0.00382518  0.00288404]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.10950939  0.00812577 -0.04456479 -0.00190893  0.0014441 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.10950939  0.00812577 -0.04456479 -0.00190893  0.0014441 ]
  [FlaxMamba2] B (step) sample values: [ 0.06341098 -0.27357408 -0.08880776  0.0867631   0.11229517]
  [FlaxMamba2] C (step) sample values: [-0.23570465 -0.01197063 -0.15913716 -0.09476613 -0.02278452]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9436172 -1.8178532 -2.0862153 -1.0006425 -0.9649832]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11994734 0.13734044 0.10460819 0.17513184 0.17016913]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7920492  0.7790619  0.80393636 0.8392519  0.8485635 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.10950939  0.00812577 -0.04456479 -0.00190893  0.0014441 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00083293  0.00359349  0.00116652 -0.00113966 -0.00147504]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00083293  0.00359349  0.00116652 -0.00113966 -0.00147504]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00150334 -0.01107264 -0.00023941 -0.00268656 -0.00091332]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01485242 -0.00733132 -0.0027369  -0.00150147  0.0003023 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02717065 -0.00641729 -0.0077498  -0.0017162   0.00046474]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02717065 -0.00641729 -0.0077498  -0.0017162   0.00046474]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00244751 -0.00152834  0.00057201  0.00044052 -0.00012913]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.07461983 -0.04896724  0.02351075  0.01324609 -0.00552358]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.07461983 -0.04896724  0.02351075  0.01324609 -0.00552358]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.4857718   0.66746294 -1.1257505  -0.41067198  0.8675512 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.4857718   0.66746294 -1.1257505  -0.41067198  0.8675512 ]
  [Layer 19] Output shape after mixer: (1, 1, 2048)
  [Layer 19] Output sample values after mixer: [ 1.4857718   0.66746294 -1.1257505  -0.41067198  0.8675512 ]
  [Layer 19] Residual connection shape: (1, 1, 2048)
  [Layer 19] Residual connection sample values: [ 2.6575346   0.5603054  -0.3587792  -0.45330992  2.1747093 ]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.27493414  0.04969052 -0.03406918 -0.03981652  0.21816169]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.27493414  0.04969052 -0.03406918 -0.03981652  0.21816169]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.27493414  0.04969052 -0.03406918 -0.03981652  0.21816169]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.16519529 -1.1993003  -0.3780105   0.23878181 -0.05217991]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.16519529 -1.1993003  -0.3780105   0.23878181 -0.05217991]
  [FlaxMamba2] xBC (step) sample values: [ 0.52316165  0.17070675 -0.18768495  0.4434246   0.15032607]
  [FlaxMamba2] dt (step) sample values: [1.8364506 1.830468  2.185259  1.4468518 1.653568 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.48445582  0.03750836  0.6735129   0.52316165  1.1289295 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.13459553 -0.11711982 -0.0427632  -0.38375863  0.08929204]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.1730782  -0.10859016  0.02376512 -0.40255746  0.06184148]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07906872 -0.05135001  0.01202375 -0.16130398  0.03187653]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07906872 -0.05135001  0.01202375 -0.16130398  0.03187653]
  [FlaxMamba2] B (step) sample values: [-0.24273199  0.46504414  0.04473788  0.15112787  0.18100828]
  [FlaxMamba2] C (step) sample values: [ 0.14341883 -0.15379514  0.14018598 -0.02320183  0.62912977]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.6215758 -5.0388985 -1.2056414 -1.6434968 -1.3345234]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.17072453 0.06878446 0.07524728 0.18258877 0.14866495]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7581737  0.7070896  0.91327226 0.7407559  0.82004434]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07906872 -0.05135001  0.01202375 -0.16130398  0.03187653]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00327663 -0.00627762 -0.00060392 -0.00204007 -0.00244343]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00327663 -0.00627762 -0.00060392 -0.00204007 -0.00244343]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00167232 -0.00551666  0.00145708  0.00038185  0.00064064]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00103895  0.01538689 -0.0063809  -0.04168569  0.03035619]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00166889  0.01497779 -0.00628511 -0.04297079  0.03061014]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00166889  0.01497779 -0.00628511 -0.04297079  0.03061014]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00012649 -0.0041602   0.00096603 -0.00573994 -0.00077779]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00196748 -0.0693166   0.02160817 -0.09714474 -0.01176107]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00196748 -0.0693166   0.02160817 -0.09714474 -0.01176107]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.27442485 -0.5046697   0.171014   -1.6336375   0.08009195]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.27442485 -0.5046697   0.171014   -1.6336375   0.08009195]
  [Layer 20] Output shape after mixer: (1, 1, 2048)
  [Layer 20] Output sample values after mixer: [ 0.27442485 -0.5046697   0.171014   -1.6336375   0.08009195]
  [Layer 20] Residual connection shape: (1, 1, 2048)
  [Layer 20] Residual connection sample values: [ 2.9319594   0.05563569 -0.1877652  -2.0869474   2.2548013 ]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.18516904  0.00318895 -0.01020947 -0.1094143   0.13315438]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18516904  0.00318895 -0.01020947 -0.1094143   0.13315438]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18516904  0.00318895 -0.01020947 -0.1094143   0.13315438]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.27530095 -0.5542214   0.38084614 -0.2136888   0.08975653]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.27530095 -0.5542214   0.38084614 -0.2136888   0.08975653]
  [FlaxMamba2] xBC (step) sample values: [-0.18652946 -0.03359072 -0.19070725  0.43432015 -0.5582824 ]
  [FlaxMamba2] dt (step) sample values: [0.8770571 3.1818728 0.5587225 1.3208704 1.3802203]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.08383006  0.00513765  1.1839298  -0.18652946  1.4520967 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.05243703  0.03473378  0.04759077 -0.06510309  0.08149279]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.02115651  0.00464345  0.0624452  -0.07018427  0.10938586]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01069015  0.00232711  0.03219713 -0.03386118  0.05768127]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01069015  0.00232711  0.03219713 -0.03386118  0.05768127]
  [FlaxMamba2] B (step) sample values: [-0.03262316 -0.01770483  0.04440949 -0.02520067 -0.12260608]
  [FlaxMamba2] C (step) sample values: [-0.00897702 -0.02144846  0.00927819 -0.05881077 -0.08802107]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.2091806  -0.04342505 -3.8147197  -6.662431   -0.02279418]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.13484581 0.09747141 0.05204258 0.08766607 0.03083859]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.64872617 0.99577624 0.81993693 0.5576247  0.9992973 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01069015  0.00232711  0.03219713 -0.03386118  0.05768127]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.7027013e-05 -2.5521909e-05  6.4017258e-05 -3.6327332e-05
 -1.7673937e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.7027013e-05 -2.5521909e-05  6.4017258e-05 -3.6327332e-05
 -1.7673937e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.2106433e-05 -9.1734928e-06 -1.7167168e-04 -4.7252810e-04
 -5.7403807e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 6.7549052e-05  6.1443582e-04  1.6642328e-03 -8.6919422e-04
  2.2032799e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00194401  0.00102292  0.00731585 -0.00681291  0.01232817]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00194401  0.00102292  0.00731585 -0.00681291  0.01232817]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00023099 -0.00020686  0.00165523  0.00065044  0.00057808]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.02415521 -0.01986413  0.21125898  0.070011    0.05593017]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02415521 -0.01986413  0.21125898  0.070011    0.05593017]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.14516011  1.1269499  -0.11247139 -0.28298822  0.5369623 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.14516011  1.1269499  -0.11247139 -0.28298822  0.5369623 ]
  [Layer 21] Output shape after mixer: (1, 1, 2048)
  [Layer 21] Output sample values after mixer: [ 0.14516011  1.1269499  -0.11247139 -0.28298822  0.5369623 ]
  [Layer 21] Residual connection shape: (1, 1, 2048)
  [Layer 21] Residual connection sample values: [ 3.0771196   1.1825856  -0.30023658 -2.3699358   2.7917635 ]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.2675364   0.08659829 -0.02329849 -0.16950954  0.2275641 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.2675364   0.08659829 -0.02329849 -0.16950954  0.2275641 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.2675364   0.08659829 -0.02329849 -0.16950954  0.2275641 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.12527177 -0.68570995 -0.0665125   0.26656675 -1.4796253 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.12527177 -0.68570995 -0.0665125   0.26656675 -1.4796253 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.2033798   0.33480477 -0.7407946  -0.00089517 -0.6835784 ]
  [FlaxMamba2] dt (step) sample values: [ 2.5202096   1.0950482  -0.04025105  0.61580354  2.6906908 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.04268686 -0.6779828  -0.172494    0.2033798  -0.38653865]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.08253928  0.05229473 -0.10695508  0.01446819 -0.33001363]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.13020775 -0.02644062  0.21238086 -0.02651692 -0.39568746]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06087134 -0.01304554  0.11742463 -0.01308268 -0.15920442]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06087134 -0.01304554  0.11742463 -0.01308268 -0.15920442]
  [FlaxMamba2] B (step) sample values: [ 0.07825493 -0.07795484 -0.1117424  -0.17817844 -0.08335301]
  [FlaxMamba2] C (step) sample values: [ 0.02571757  0.02085909 -0.072072   -0.01337136 -0.18582356]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.1489344 -3.5005836 -2.8320918 -5.5395546 -1.7185895]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01642244 0.11656049 0.05993418 0.08350249 0.04135643]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.93413377 0.6649591  0.84388494 0.6296655  0.9313923 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06087134 -0.01304554  0.11742463 -0.01308268 -0.15920442]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.82279749e-05  7.79279944e-05  1.11703914e-04  1.78117072e-04
  8.33242957e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.82279749e-05  7.79279944e-05  1.11703914e-04  1.78117072e-04
  8.33242957e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00018848  0.00029186  0.00012914  0.00038815  0.00029251]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-2.8415981e-03 -4.1442112e-05  5.2389866e-03  5.2845746e-04
 -3.0656434e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01758446 -0.00320103  0.03367889 -0.00264013 -0.04162448]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01758446 -0.00320103  0.03367889 -0.00264013 -0.04162448]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00103252  0.00073529 -0.0010828  -0.00039851  0.01142371]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.0080213   0.01608138 -0.01350591 -0.01222922  0.23019555]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0080213   0.01608138 -0.01350591 -0.01222922  0.23019555]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.2353902  -0.5082063  -0.9754256  -0.51701796  0.7572723 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.2353902  -0.5082063  -0.9754256  -0.51701796  0.7572723 ]
  [Layer 22] Output shape after mixer: (1, 1, 2048)
  [Layer 22] Output sample values after mixer: [ 1.2353902  -0.5082063  -0.9754256  -0.51701796  0.7572723 ]
  [Layer 22] Residual connection shape: (1, 1, 2048)
  [Layer 22] Residual connection sample values: [ 4.3125095  0.6743793 -1.2756622 -2.8869538  3.5490358]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.23195854  0.03120854 -0.06281465 -0.13430397  0.1849864 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.23195854  0.03120854 -0.06281465 -0.13430397  0.1849864 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.23195854  0.03120854 -0.06281465 -0.13430397  0.1849864 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.01022244  0.24330388 -0.57545197  0.11172946 -0.26756462]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.01022244  0.24330388 -0.57545197  0.11172946 -0.26756462]
  [FlaxMamba2] xBC (step) sample values: [-0.15697731 -0.53027385 -0.1674853  -0.48751247 -0.3197337 ]
  [FlaxMamba2] dt (step) sample values: [1.452682  0.9041064 1.9397051 1.342524  1.7491415]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.093606    0.5952018   1.0781335  -0.15697731  1.0026512 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.14462256  0.26235318 -0.06511194 -0.10111814  0.12090622]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.16699195  0.22924161 -0.07646447 -0.10327917  0.07152878]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07654055  0.12770149 -0.03677124 -0.0489753   0.03704294]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07654055  0.12770149 -0.03677124 -0.0489753   0.03704294]
  [FlaxMamba2] B (step) sample values: [ 0.12356087  0.13505985  0.18190256 -0.05734934 -0.12892276]
  [FlaxMamba2] C (step) sample values: [-0.06029401  0.00088617  0.2218494  -0.06597593 -0.02090714]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.08112868 -3.7998476  -0.08256738 -0.48783726 -1.4532163 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04968992 0.10321002 0.0700853  0.0055636  0.00594665]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99597687 0.6755809  0.99423    0.99728954 0.9913955 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07654055  0.12770149 -0.03677124 -0.0489753   0.03704294]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00046994 -0.00051367 -0.00069183  0.00021812  0.00049033]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00046994 -0.00051367 -0.00069183  0.00021812  0.00049033]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00077089  0.00066562 -0.00145614  0.00030955 -0.00039771]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.3506286e-03 -6.1746847e-05  1.0101311e-03 -1.5927486e-03
 -5.7283737e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00028222 -0.00278602  0.00179458 -0.00054795 -0.00136308]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00028222 -0.00278602  0.00179458 -0.00054795 -0.00136308]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-1.4351333e-06 -3.7995388e-04 -3.7174870e-04 -3.2319407e-05
  1.5810454e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00033957 -0.01140539 -0.01959833 -0.00273355  0.03918181]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00033957 -0.01140539 -0.01959833 -0.00273355  0.03918181]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.639387   -0.6851539   0.25878862 -1.6338234   1.7691985 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.639387   -0.6851539   0.25878862 -1.6338234   1.7691985 ]
  [Layer 23] Output shape after mixer: (1, 1, 2048)
  [Layer 23] Output sample values after mixer: [ 1.639387   -0.6851539   0.25878862 -1.6338234   1.7691985 ]
  [Layer 23] Residual connection shape: (1, 1, 2048)
  [Layer 23] Residual connection sample values: [ 5.9518967  -0.01077461 -1.0168736  -4.520777    5.3182344 ]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.22827789 -0.00039429 -0.03595962 -0.15422077  0.19779915]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.22827789 -0.00039429 -0.03595962 -0.15422077  0.19779915]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.22827789 -0.00039429 -0.03595962 -0.15422077  0.19779915]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.35211155 -0.42374188  0.8178615  -0.18397874 -0.18010007]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.35211155 -0.42374188  0.8178615  -0.18397874 -0.18010007]
  [FlaxMamba2] xBC (step) sample values: [-0.01069574 -0.4499576  -0.0546894   0.21319589 -0.11875429]
  [FlaxMamba2] dt (step) sample values: [0.02769558 0.6836017  1.2464857  1.8249162  1.0091023 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.05577047  0.12918073 -0.42032832 -0.01069574  0.08314759]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00426904  0.06597415 -0.01664548  0.04347831 -0.07013371]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00761453  0.06596503 -0.02060514  0.04186088 -0.07486775]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00379277  0.03406997 -0.01019643  0.02136846 -0.03603323]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00379277  0.03406997 -0.01019643  0.02136846 -0.03603323]
  [FlaxMamba2] B (step) sample values: [-0.04954713  0.02282655  0.05958739 -0.03717009 -0.01765943]
  [FlaxMamba2] C (step) sample values: [-0.10506917 -0.21647617 -0.2679881  -0.22394934  0.3246051 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.07415762 -3.4496791  -3.2884939  -0.16087165 -2.6944954 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00565987 0.05679164 0.15072152 0.02810018 0.05817244]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9995804  0.82208383 0.60917675 0.99548966 0.8549217 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00379277  0.03406997 -0.01019643  0.02136846 -0.03603323]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0636073e-06 -4.9000789e-07 -1.2791372e-06  7.9791454e-07
  3.7908757e-07]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0636073e-06 -4.9000789e-07 -1.2791372e-06  7.9791454e-07
  3.7908757e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.4030071e-04  5.7647220e-04 -2.7290745e-05 -1.1101035e-04
  3.6085671e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00141255 -0.00149226  0.00095708 -0.00145441 -0.00480228]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00139235 -0.00167363  0.00101136 -0.00156817 -0.00461045]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00139235 -0.00167363  0.00101136 -0.00156817 -0.00461045]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00028785  0.00028057  0.00057386  0.00013102  0.00037789]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.02681915  0.03703199  0.06840067  0.05697246  0.09720827]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02681915  0.03703199  0.06840067  0.05697246  0.09720827]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.6979297   0.3600705   0.67699516  0.8764321  -1.400952  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.6979297   0.3600705   0.67699516  0.8764321  -1.400952  ]
  [Layer 24] Output shape after mixer: (1, 1, 2048)
  [Layer 24] Output sample values after mixer: [-1.6979297   0.3600705   0.67699516  0.8764321  -1.400952  ]
  [Layer 24] Residual connection shape: (1, 1, 2048)
  [Layer 24] Residual connection sample values: [ 4.253967    0.34929588 -0.33987844 -3.644345    3.9172826 ]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15797044  0.01185561 -0.01191843 -0.1194825   0.14391892]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15797044  0.01185561 -0.01191843 -0.1194825   0.14391892]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15797044  0.01185561 -0.01191843 -0.1194825   0.14391892]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.28725174 -0.0095362   0.36439633  0.30949953 -0.30574074]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.28725174 -0.0095362   0.36439633  0.30949953 -0.30574074]
  [FlaxMamba2] xBC (step) sample values: [ 0.21576144 -0.5131226   0.14615987 -0.29448238 -1.1210811 ]
  [FlaxMamba2] dt (step) sample values: [ 0.7590004  -1.0610471   0.98708624  2.5146282   0.23032123]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.06107979 -0.11417346  1.575577    0.21576144 -0.22494169]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.30124906 -0.37480247 -0.06952848 -0.21720387  0.21176615]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.303803   -0.40301597 -0.08094206 -0.15638234  0.20600215]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.12900329 -0.16144334 -0.03883402 -0.07208974  0.11357293]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.12900329 -0.16144334 -0.03883402 -0.07208974  0.11357293]
  [FlaxMamba2] B (step) sample values: [-0.06745741  0.02232579 -0.01062625 -0.0799353   0.00122611]
  [FlaxMamba2] C (step) sample values: [ 0.00459547  0.18291421 -0.10893246 -0.069433   -0.17398159]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -0.37022203  -1.5044799   -5.7209826   -0.81757224 -14.66622   ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.27316448 0.00221404 0.06880894 0.08369017 0.04090708]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9038142  0.99667454 0.67458695 0.9338656  0.54883784]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.12900329 -0.16144334 -0.03883402 -0.07208974  0.11357293]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.3771394e-03 -7.8674109e-04  3.7445969e-04  2.8168492e-03
 -4.3207168e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.3771394e-03 -7.8674109e-04  3.7445969e-04  2.8168492e-03
 -4.3207168e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 6.9510611e-03 -3.2554085e-03 -8.4827829e-05  3.9012728e-03
  1.5720573e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0040849  -0.01328486  0.00045825 -0.00416187  0.01067709]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-5.4325778e-03 -1.4971435e-02  5.2560965e-05 -4.9149832e-03
  1.1863573e-02]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-5.4325778e-03 -1.4971435e-02  5.2560965e-05 -4.9149832e-03
  1.1863573e-02]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 6.6895765e-04  7.1044953e-05  1.1302280e-05 -8.7736337e-04
 -1.5384846e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.07302079  0.00529756  0.00136051 -0.06300011 -0.24190304]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.07302079  0.00529756  0.00136051 -0.06300011 -0.24190304]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.09677001  0.09082309  0.30346417  0.47351438 -0.53763515]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.09677001  0.09082309  0.30346417  0.47351438 -0.53763515]
  [Layer 25] Output shape after mixer: (1, 1, 2048)
  [Layer 25] Output sample values after mixer: [ 0.09677001  0.09082309  0.30346417  0.47351438 -0.53763515]
  [Layer 25] Residual connection shape: (1, 1, 2048)
  [Layer 25] Residual connection sample values: [ 4.3507366   0.44011897 -0.03641427 -3.1708307   3.3796475 ]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.1868015   0.01748549 -0.0014566  -0.12442301  0.14189279]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1868015   0.01748549 -0.0014566  -0.12442301  0.14189279]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1868015   0.01748549 -0.0014566  -0.12442301  0.14189279]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.01677205 -0.06238937 -1.4686261   0.10468492 -0.12948309]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.01677205 -0.06238937 -1.4686261   0.10468492 -0.12948309]
  [FlaxMamba2] xBC (step) sample values: [-0.3228466   0.2073316  -0.63448596 -0.77441365  0.5522232 ]
  [FlaxMamba2] dt (step) sample values: [1.204739   0.80913097 0.7218838  0.6488671  2.7675805 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.8584322  0.5639119 -1.1610427 -0.3228466 -0.451671 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.24578479 -0.00595849 -0.10863478  0.18353939 -0.12482017]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.15728381 -0.06201928 -0.04448684  0.15659237 -0.11671013]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.08481374 -0.03004835 -0.02174873  0.08441398 -0.05495361]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.08481374 -0.03004835 -0.02174873  0.08441398 -0.05495361]
  [FlaxMamba2] B (step) sample values: [-0.04487339  0.03889164  0.01622168  0.08004948  0.10712745]
  [FlaxMamba2] C (step) sample values: [-0.15289006 -0.10228679  0.19921155  0.28065857  0.17805743]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9594627  -0.39448437 -0.84198165 -1.4275463  -0.14661841]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.17808925 0.23069964 0.12475816 0.19655716 0.1616763 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.84293115 0.91301095 0.9002848  0.7553346  0.976574  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.08481374 -0.03004835 -0.02174873  0.08441398 -0.05495361]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00067779  0.00058744  0.00024502  0.0012091   0.0016181 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00067779  0.00058744  0.00024502  0.0012091   0.0016181 ]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00198204 -0.00041162 -0.0015311   0.00078947 -0.00083139]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00861309  0.00728001  0.00378155  0.00119772  0.00709115]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [2.1908907e-03 3.4523045e-03 1.0110922e-03 1.1950773e-02 9.0900343e-05]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [2.1908907e-03 3.4523045e-03 1.0110922e-03 1.1950773e-02 9.0900343e-05]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 1.8526935e-05 -1.0433517e-04 -2.7790436e-04  6.5824494e-04
 -5.5045543e-06]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00038654 -0.00483407 -0.01095641  0.03951047 -0.00028846]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00038654 -0.00483407 -0.01095641  0.03951047 -0.00028846]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.80833465 -0.49864736  0.66334337 -1.9165182  -0.27233157]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.80833465 -0.49864736  0.66334337 -1.9165182  -0.27233157]
  [Layer 26] Output shape after mixer: (1, 1, 2048)
  [Layer 26] Output sample values after mixer: [-0.80833465 -0.49864736  0.66334337 -1.9165182  -0.27233157]
  [Layer 26] Residual connection shape: (1, 1, 2048)
  [Layer 26] Residual connection sample values: [ 3.542402   -0.05852839  0.6269291  -5.087349    3.107316  ]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15251245 -0.00229932  0.02642451 -0.19692042  0.13916607]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15251245 -0.00229932  0.02642451 -0.19692042  0.13916607]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15251245 -0.00229932  0.02642451 -0.19692042  0.13916607]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.40934324  0.65687776 -0.38523427 -0.18038714  0.15368664]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.40934324  0.65687776 -0.38523427 -0.18038714  0.15368664]
  [FlaxMamba2] xBC (step) sample values: [ 0.31166753  0.42350638  0.8974767   0.20641239 -0.5985966 ]
  [FlaxMamba2] dt (step) sample values: [1.3742001 1.2260005 1.035882  1.4232823 1.6975358]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.31111884 -0.23419484  0.5273738   0.31166753 -0.07905626]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.11966208  0.13963369  0.25235876 -0.1885226  -0.26892585]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0936611   0.10313466  0.242349   -0.3904269  -0.298711  ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.04902205  0.05422417  0.13578632 -0.15758197 -0.12721284]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04902205  0.05422417  0.13578632 -0.15758197 -0.12721284]
  [FlaxMamba2] B (step) sample values: [-0.09416748 -0.10554155 -0.14447032  0.05907152  0.00166625]
  [FlaxMamba2] C (step) sample values: [-0.06719112 -0.2466536  -0.04821784  0.28337207 -0.20778793]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3661706 -1.3799144 -1.8267511 -2.0408754 -2.3490334]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.15752454 0.15195906 0.13151394 0.06769208 0.2246799 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8063758  0.8108352  0.78643656 0.8709671  0.5899128 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04902205  0.05422417  0.13578632 -0.15758197 -0.12721284]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.2717783e-04 -8.1501040e-04 -1.1156251e-03  4.5616066e-04
  1.2867103e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.2717783e-04 -8.1501040e-04 -1.1156251e-03  4.5616066e-04
  1.2867103e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0009632   0.0010652   0.0019184  -0.00096026  0.00038434]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01505638 -0.01059567  0.01594122 -0.07226126 -0.01610509]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01009849 -0.00511166  0.02967409 -0.08819845 -0.02897087]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01009849 -0.00511166  0.02967409 -0.08819845 -0.02897087]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00164965 -0.00221127 -0.00462821  0.00723939 -0.00239695]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.03878602 -0.03780032 -0.13663292  0.19230847 -0.03915342]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03878602 -0.03780032 -0.13663292  0.19230847 -0.03915342]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-3.6765335   1.8786644  -2.2716365   1.9078642  -0.79772323]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-3.6765335   1.8786644  -2.2716365   1.9078642  -0.79772323]
  [Layer 27] Output shape after mixer: (1, 1, 2048)
  [Layer 27] Output sample values after mixer: [-3.6765335   1.8786644  -2.2716365   1.9078642  -0.79772323]
  [Layer 27] Residual connection shape: (1, 1, 2048)
  [Layer 27] Residual connection sample values: [-0.13413143  1.820136   -1.6447074  -3.1794848   2.3095927 ]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.00489499  0.06215023 -0.05673754 -0.10661282  0.08342468]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00489499  0.06215023 -0.05673754 -0.10661282  0.08342468]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.00489499  0.06215023 -0.05673754 -0.10661282  0.08342468]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.55484426 -0.44605324  0.5157836  -0.4006523  -1.0697062 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.55484426 -0.44605324  0.5157836  -0.4006523  -1.0697062 ]
  [FlaxMamba2] xBC (step) sample values: [-0.8092534  -0.5083563  -0.36683255 -0.67228377  0.22035815]
  [FlaxMamba2] dt (step) sample values: [1.5127497 0.7697462 1.2848516 1.0060952 2.0728452]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.1665969  -0.27866125  0.11472865 -0.8092534  -1.2984579 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12320188  0.17615458 -0.10965677 -0.11289605 -0.03714994]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0654321   0.16479442 -0.12332101 -0.12427148  0.06752535]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.03378601  0.08917119 -0.0578633  -0.05827985  0.03490216]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03378601  0.08917119 -0.0578633  -0.05827985  0.03490216]
  [FlaxMamba2] B (step) sample values: [-0.04105007 -0.02995675 -0.11635078 -0.07198139  0.32229427]
  [FlaxMamba2] C (step) sample values: [-0.19871582 -0.07828088  0.5835497  -0.02460447  0.43352056]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2727895 -3.997792  -2.517685  -2.1714401 -2.8654757]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0454078  0.09268783 0.1434154  0.04615884 0.11519963]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.94384384 0.69035685 0.69692683 0.9046283  0.7188506 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03378601  0.08917119 -0.0578633  -0.05827985  0.03490216]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.2976891e-05 -4.5958095e-05 -1.7849934e-04 -1.1043013e-04
  4.9444719e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.2976891e-05 -4.5958095e-05 -1.7849934e-04 -1.1043013e-04
  4.9444719e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.49444284e-04 -4.33245405e-05 -2.51856050e-04  2.94959900e-04
 -1.13842194e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00034722  0.01803166 -0.00357069 -0.00666076  0.00709782]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.0076711   0.03736154 -0.01611387 -0.01929424  0.01466366]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.0076711   0.03736154 -0.01611387 -0.01929424  0.01466366]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00155244 -0.00650443 -0.00520419  0.00310105 -0.00400708]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.09525137 -0.2644888  -0.20047173  0.13794427 -0.17291279]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.09525137 -0.2644888  -0.20047173  0.13794427 -0.17291279]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.2609036  -0.34098577 -5.000515   -1.7636139   2.191489  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.2609036  -0.34098577 -5.000515   -1.7636139   2.191489  ]
  [Layer 28] Output shape after mixer: (1, 1, 2048)
  [Layer 28] Output sample values after mixer: [ 1.2609036  -0.34098577 -5.000515   -1.7636139   2.191489  ]
  [Layer 28] Residual connection shape: (1, 1, 2048)
  [Layer 28] Residual connection sample values: [ 1.1267722  1.4791502 -6.6452227 -4.943099   4.5010815]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03539575  0.04443981 -0.19991383 -0.14321426  0.14059041]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03539575  0.04443981 -0.19991383 -0.14321426  0.14059041]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03539575  0.04443981 -0.19991383 -0.14321426  0.14059041]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.27359447 -0.14026318 -0.5835844   0.18159318 -0.3232155 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.27359447 -0.14026318 -0.5835844   0.18159318 -0.3232155 ]
  [FlaxMamba2] xBC (step) sample values: [-0.6982512  -0.00941766 -0.20878994 -1.3533808  -1.2695713 ]
  [FlaxMamba2] dt (step) sample values: [2.643935  1.5319241 1.5101429 1.3739723 1.2412306]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.7794938  -0.6524618  -0.4256644  -0.6982512  -0.19880426]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.02648875  0.01043271  0.04034946  0.2632519  -0.17276567]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0130839  -0.02408267  0.04319713  0.2028271  -0.28586382]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00658475 -0.01189635  0.02206499  0.11166314 -0.12264037]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00658475 -0.01189635  0.02206499  0.11166314 -0.12264037]
  [FlaxMamba2] B (step) sample values: [ 0.0347079   0.03293112 -0.02895133  0.01425809 -0.05188154]
  [FlaxMamba2] C (step) sample values: [-0.18342707 -0.13582611 -0.07839227 -0.24888307 -0.24246514]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8072329  -2.117      -1.925669   -0.29044876 -2.049864  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.2637778  0.2106284  0.26039985 0.00620589 0.20230941]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.62082386 0.6402476  0.6056555  0.9981991  0.6605339 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00658475 -0.01189635  0.02206499  0.11166314 -0.12264037]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 6.0284492e-05  5.7198380e-05 -5.0285857e-05  2.4765017e-05
 -9.0113565e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 6.0284492e-05  5.7198380e-05 -5.0285857e-05  2.4765017e-05
 -9.0113565e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00022091  0.00035638 -0.00083863 -0.00031815  0.0011256 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00604866  0.00371652 -0.00155244  0.01218826 -0.0390311 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01278176 -0.00844784  0.02100965  0.12636706 -0.16443443]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01278176 -0.00844784  0.02100965  0.12636706 -0.16443443]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0015108   0.00055098 -0.00439073  0.01251262  0.02231633]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.0181381   0.00622504 -0.07859965  0.2009219   0.31791797]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0181381   0.00622504 -0.07859965  0.2009219   0.31791797]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.7099144 -2.7723665 -2.1012907 -2.1310477  0.3492064]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.7099144 -2.7723665 -2.1012907 -2.1310477  0.3492064]
  [Layer 29] Output shape after mixer: (1, 1, 2048)
  [Layer 29] Output sample values after mixer: [ 0.7099144 -2.7723665 -2.1012907 -2.1310477  0.3492064]
  [Layer 29] Residual connection shape: (1, 1, 2048)
  [Layer 29] Residual connection sample values: [ 1.8366866 -1.2932163 -8.746513  -7.0741467  4.850288 ]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05908612 -0.04093478 -0.27492136 -0.2096978   0.16032803]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05908612 -0.04093478 -0.27492136 -0.2096978   0.16032803]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05908612 -0.04093478 -0.27492136 -0.2096978   0.16032803]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.70034933 -0.8176151  -1.3876696   0.7437582  -0.46119192]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.70034933 -0.8176151  -1.3876696   0.7437582  -0.46119192]
  [FlaxMamba2] xBC (step) sample values: [-0.37989354 -0.48848453 -0.3057426   0.18668999  1.1633635 ]
  [FlaxMamba2] dt (step) sample values: [1.961376  2.4313195 1.8865713 2.467605  2.2380226]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.4020718   0.9596449   1.1810967  -0.37989354 -0.38845024]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.06605164 -0.06719501 -0.12749518 -0.03696197 -0.2726698 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.08933655 -0.05349261 -0.09435309 -0.05510467 -0.30001354]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04267434 -0.02603111 -0.04495257 -0.02679339 -0.12767202]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04267434 -0.02603111 -0.04495257 -0.02679339 -0.12767202]
  [FlaxMamba2] B (step) sample values: [ 0.00636929 -0.17437673 -0.11543107  0.14156064 -0.07510037]
  [FlaxMamba2] C (step) sample values: [-0.26327842 -0.27196157  0.26958576  0.05290259 -0.26841268]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0149885  -0.4675477  -0.42799968 -0.7895216  -0.4174731 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.027985   0.81048113 1.0177032  0.51553905 0.70579207]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9719952  0.6845876  0.64689153 0.66562474 0.7447928 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04267434 -0.02603111 -0.04495257 -0.02679339 -0.12767202]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.6064725e-06  2.0824792e-04  1.3785256e-04 -1.6905759e-04
  8.9687972e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.6064725e-06  2.0824792e-04  1.3785256e-04 -1.6905759e-04
  8.9687972e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 8.3343341e-04  1.7766921e-04  2.1183395e-04  1.7392095e-03
 -4.5583125e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00246684 -0.00199501 -0.00257126 -0.00127058 -0.00360665]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.05010471 -0.03406336 -0.05794941 -0.03427801 -0.1608889 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.05010471 -0.03406336 -0.05794941 -0.03427801 -0.1608889 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01164084  0.00852984  0.01606524 -0.01728064  0.02869363]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.17806835  0.13242999  0.15142208 -0.21944502  0.32382464]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.17806835  0.13242999  0.15142208 -0.21944502  0.32382464]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.4723186  -0.25372413 -1.20446     3.6796544   2.2694209 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.4723186  -0.25372413 -1.20446     3.6796544   2.2694209 ]
  [Layer 30] Output shape after mixer: (1, 1, 2048)
  [Layer 30] Output sample values after mixer: [ 3.4723186  -0.25372413 -1.20446     3.6796544   2.2694209 ]
  [Layer 30] Residual connection shape: (1, 1, 2048)
  [Layer 30] Residual connection sample values: [ 5.3090053 -1.5469404 -9.9509735 -3.3944924  7.119709 ]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15984946 -0.0456977  -0.29481572 -0.09787841  0.21657562]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15984946 -0.0456977  -0.29481572 -0.09787841  0.21657562]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15984946 -0.0456977  -0.29481572 -0.09787841  0.21657562]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.1986294  -1.0227469  -0.19185086 -0.33643806 -0.02991476]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.1986294  -1.0227469  -0.19185086 -0.33643806 -0.02991476]
  [FlaxMamba2] xBC (step) sample values: [-0.98609334 -0.4091385  -1.0542943   1.3792281  -0.7905535 ]
  [FlaxMamba2] dt (step) sample values: [2.763057  1.8699007 2.7823415 1.9183872 1.4938722]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.7321551  -1.1307228   0.4075005  -0.98609334 -0.69987726]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.16344306  0.0588535  -0.08018681 -0.21968283  0.13635132]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.16393849  0.04853093 -0.0791721  -0.22158064  0.13104889]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.0752653   0.02485416 -0.03801981 -0.0985658   0.06981177]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0752653   0.02485416 -0.03801981 -0.0985658   0.06981177]
  [FlaxMamba2] B (step) sample values: [-0.08582495 -0.04177011 -0.05907499 -0.10922626 -0.01125059]
  [FlaxMamba2] C (step) sample values: [-0.04719733 -0.09199233 -0.240628   -0.08582051 -0.16459684]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.9477868 -3.5383902 -4.705952  -2.462968  -0.9027082]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.42644823 0.1389273  0.22880885 0.3502957  0.17306879]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.28448397 0.6116598  0.3406964  0.42199278 0.85536194]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0752653   0.02485416 -0.03801981 -0.0985658   0.06981177]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [0.0027547  0.00134068 0.00189612 0.00350581 0.00036111]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [0.0027547  0.00134068 0.00189612 0.00350581 0.00036111]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00346526 0.00156521 0.0018301  0.00413313 0.00050253]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02564702  0.00900809 -0.01310986 -0.03068805  0.02663541]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07743078  0.02610816 -0.03926811 -0.09850293  0.07466705]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07743078  0.02610816 -0.03926811 -0.09850293  0.07466705]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.07130477 -0.0070625   0.00340658  0.01380867 -0.00110012]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-1.4098811  -0.12198941  0.05239621  0.22606127 -0.02134243]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-1.4098811  -0.12198941  0.05239621  0.22606127 -0.02134243]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-4.098913    1.871597   -0.17032224 -0.610352    0.10581407]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-4.098913    1.871597   -0.17032224 -0.610352    0.10581407]
  [Layer 31] Output shape after mixer: (1, 1, 2048)
  [Layer 31] Output sample values after mixer: [-4.098913    1.871597   -0.17032224 -0.610352    0.10581407]
  [Layer 31] Residual connection shape: (1, 1, 2048)
  [Layer 31] Residual connection sample values: [  1.2100921   0.3246566 -10.121296   -4.004844    7.225523 ]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03577421  0.0096392  -0.29970092 -0.11107194  0.22211272]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03577421  0.0096392  -0.29970092 -0.11107194  0.22211272]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03577421  0.0096392  -0.29970092 -0.11107194  0.22211272]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.20357677 -0.3869203  -2.2421627  -0.9119618  -1.4023489 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.20357677 -0.3869203  -2.2421627  -0.9119618  -1.4023489 ]
  [FlaxMamba2] xBC (step) sample values: [-0.824492    1.0548698  -0.9100173   0.04923613  0.9841099 ]
  [FlaxMamba2] dt (step) sample values: [1.1423001 2.5867622 1.9189149 1.6093612 2.1025965]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.16980265 -0.18697533 -0.92954063 -0.824492    0.01709211]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.25920257 -0.40079698 -0.10530915  0.0395119  -0.21037042]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.29637298 -0.45282945 -0.12114777  0.05199359 -0.21734369]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.1699864  -0.17600949 -0.05690917  0.02667248 -0.09690854]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.1699864  -0.17600949 -0.05690917  0.02667248 -0.09690854]
  [FlaxMamba2] B (step) sample values: [ 0.01404984 -0.06530811 -0.00669519 -0.00984111  0.19358175]
  [FlaxMamba2] C (step) sample values: [ 0.03675537 -0.23371522 -0.14115348 -0.255221    0.5725628 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6970906 -2.0892735 -1.7966746 -1.3893797 -1.0395182]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.22693779 0.06999192 0.60510045 0.425302   0.87918293]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8536823  0.86395705 0.33716983 0.5538253  0.40094674]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.1699864  -0.17600949 -0.05690917  0.02667248 -0.09690854]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00054199 -0.00251935 -0.00025828 -0.00037963  0.00746767]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00054199 -0.00251935 -0.00025828 -0.00037963  0.00746767]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00234302 -0.00035219 -0.00036399 -0.0036256   0.00609206]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.04276741 -0.04562756 -0.00795177 -0.02175457 -0.03621895]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.08354305 -0.08784799 -0.0216029  -0.01535649 -0.05946497]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.08354305 -0.08784799 -0.0216029  -0.01535649 -0.05946497]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00764111  0.01374763  0.00465131  0.00401368  0.01646495]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.07288425  0.10548399  0.06931111  0.04895459  0.16424014]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.07288425  0.10548399  0.06931111  0.04895459  0.16424014]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.4690447   0.4954235  -2.3034096   0.35365912  1.4677764 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.4690447   0.4954235  -2.3034096   0.35365912  1.4677764 ]
  [Layer 32] Output shape after mixer: (1, 1, 2048)
  [Layer 32] Output sample values after mixer: [ 1.4690447   0.4954235  -2.3034096   0.35365912  1.4677764 ]
  [Layer 32] Residual connection shape: (1, 1, 2048)
  [Layer 32] Residual connection sample values: [  2.6791368   0.8200801 -12.4247055  -3.651185    8.693299 ]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.06527323  0.02070471 -0.30835605 -0.08798784  0.21937156]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.06527323  0.02070471 -0.30835605 -0.08798784  0.21937156]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.06527323  0.02070471 -0.30835605 -0.08798784  0.21937156]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.9590167  -0.03870476 -0.69008535  0.05267084 -0.5883098 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.9590167  -0.03870476 -0.69008535  0.05267084 -0.5883098 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.6877787  -1.7402567   0.08403952 -0.8051303   0.7886008 ]
  [FlaxMamba2] dt (step) sample values: [-1.8586094  1.3889797  1.497273   1.7511449  0.8159263]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.4439851   0.24129574  1.4796238   0.6877787  -2.928757  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.13124208 -0.2743774  -0.04487537 -0.18529981 -0.13637516]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.11809663 -0.32375485 -0.01805042 -0.18650621 -0.13756439]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.06253098 -0.13589963 -0.00894376 -0.08458208 -0.06405865]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06253098 -0.13589963 -0.00894376 -0.08458208 -0.06405865]
  [FlaxMamba2] B (step) sample values: [-0.27806878  0.16949242 -0.0500221  -0.05497649  0.11611434]
  [FlaxMamba2] C (step) sample values: [-0.02919142 -0.04071252 -0.2752346  -0.20817302  0.33285385]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9790505  -9.693779   -6.1677613  -0.11351943 -2.090294  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00184177 0.03946349 0.05664084 0.04593606 0.00648101]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9963617  0.68211955 0.7051483  0.99479896 0.98654413]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06253098 -0.13589963 -0.00894376 -0.08458208 -0.06405865]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.2024473e-05  1.9520010e-05 -5.7609177e-06 -6.3315024e-06
  1.3372593e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.2024473e-05  1.9520010e-05 -5.7609177e-06 -6.3315024e-06
  1.3372593e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.6351137e-04  1.2613190e-04 -1.0050663e-04 -7.1578346e-05
  9.5180090e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-5.4509183e-05 -2.7082392e-04  2.9765192e-04 -5.2382791e-04
 -6.6499342e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.06505722 -0.14177923 -0.00901523 -0.08859674 -0.06736743]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.06505722 -0.14177923 -0.00901523 -0.08859674 -0.06736743]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01728698  0.00269067  0.00207799 -0.00239467  0.01414986]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.3168165   0.02938873  0.02859941 -0.03218931  0.21526144]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.3168165   0.02938873  0.02859941 -0.03218931  0.21526144]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.6721599  -0.34558132 -5.189808   -2.6945572  -3.0287595 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.6721599  -0.34558132 -5.189808   -2.6945572  -3.0287595 ]
  [Layer 33] Output shape after mixer: (1, 1, 2048)
  [Layer 33] Output sample values after mixer: [-1.6721599  -0.34558132 -5.189808   -2.6945572  -3.0287595 ]
  [Layer 33] Residual connection shape: (1, 1, 2048)
  [Layer 33] Residual connection sample values: [  1.0069768    0.47449878 -17.614513    -6.345742     5.66454   ]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01884992  0.0094114  -0.3295228  -0.1197666   0.11121049]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01884992  0.0094114  -0.3295228  -0.1197666   0.11121049]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01884992  0.0094114  -0.3295228  -0.1197666   0.11121049]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.94119275 -0.9202045   0.16871017 -0.77619255 -0.8357108 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.94119275 -0.9202045   0.16871017 -0.77619255 -0.8357108 ]
  [FlaxMamba2] xBC (step) sample values: [-0.83088464 -0.66318566 -1.0588164  -0.5511245  -0.44243184]
  [FlaxMamba2] dt (step) sample values: [2.5736072 2.3367608 4.1036105 1.1139057 0.8445499]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.770059    0.51194197 -0.24101172 -0.83088464 -1.1400268 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.19143404  0.11935052 -0.16550004  0.13897243 -0.09832803]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.15954317  0.14538202 -0.17744005  0.09945217 -0.10686532]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.08612163  0.0779657  -0.08086938  0.05219673 -0.05058033]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.08612163  0.0779657  -0.08086938  0.05219673 -0.05058033]
  [FlaxMamba2] B (step) sample values: [-0.05476293  0.06793638 -0.07143792  0.00364152 -0.00039905]
  [FlaxMamba2] C (step) sample values: [-0.03051361 -0.26306263 -0.27027962 -0.20793839 -0.27424335]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.5610816  -2.4810736  -2.893596   -0.01585086 -0.02613366]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.532484   0.29354894 0.45168114 0.04319018 0.01733969]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.25570396 0.48272094 0.2706354  0.9993156  0.99954695]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.08612163  0.0779657  -0.08086938  0.05219673 -0.05058033]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.5113400e-03  3.1154533e-03 -3.2760280e-03  1.6699446e-04
 -1.8299887e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.5113400e-03  3.1154533e-03 -3.2760280e-03  1.6699446e-04
 -1.8299887e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.6042121e-03  3.1873903e-03 -3.1622681e-03  2.5271319e-04
 -3.9530943e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00535108  0.00527867 -0.00486449  0.00411193 -0.00350073]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.05839711  0.05330111 -0.05467543  0.03626215 -0.03465534]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.05839711  0.05330111 -0.05467543  0.03626215 -0.03465534]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01542587 -0.01397455 -0.00500029 -0.00887009  0.00875919]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.54398304 -0.47926208 -0.19605891 -0.39107403  0.36678433]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.54398304 -0.47926208 -0.19605891 -0.39107403  0.36678433]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 4.8856225  0.6709655 -7.6328497 -2.837732  -2.674384 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 4.8856225  0.6709655 -7.6328497 -2.837732  -2.674384 ]
  [Layer 34] Output shape after mixer: (1, 1, 2048)
  [Layer 34] Output sample values after mixer: [ 4.8856225  0.6709655 -7.6328497 -2.837732  -2.674384 ]
  [Layer 34] Residual connection shape: (1, 1, 2048)
  [Layer 34] Residual connection sample values: [  5.892599    1.1454643 -25.247364   -9.183475    2.9901557]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.1189753   0.02308397 -0.5006144  -0.17080015  0.05974602]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1189753   0.02308397 -0.5006144  -0.17080015  0.05974602]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1189753   0.02308397 -0.5006144  -0.17080015  0.05974602]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-2.8080626  -1.8827432   2.0980766   0.34900382 -1.7820818 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-2.8080626  -1.8827432   2.0980766   0.34900382 -1.7820818 ]
  [FlaxMamba2] xBC (step) sample values: [-0.50260264  0.671741    0.81036526 -0.60308295  0.45429647]
  [FlaxMamba2] dt (step) sample values: [2.253631  0.9244969 1.6619133 1.395989  1.8999548]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.96487004 -0.8679777   2.3284924  -0.50260264  0.8360199 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.09411472 -0.15247864 -0.13707563 -0.13469929  0.07234661]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.06189114 -0.11134094 -0.17326948 -0.17965168  0.03087322]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.02998825 -0.05257447 -0.07914788 -0.08177879  0.01567488]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.02998825 -0.05257447 -0.07914788 -0.08177879  0.01567488]
  [FlaxMamba2] B (step) sample values: [-0.00423087  0.22669385 -0.24615544  0.15722375  0.5074878 ]
  [FlaxMamba2] C (step) sample values: [-0.27189487  0.40327352 -0.24977799  0.10215643 -0.00371004]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.709799  -2.7746034 -0.4452666 -1.139112  -3.5906036]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.08343487 0.04229314 0.64217234 0.24537075 0.1616109 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.94249755 0.88927686 0.7513093  0.7561581  0.55974126]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.02998825 -0.05257447 -0.07914788 -0.08177879  0.01567488]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0585917e-05 -5.6720286e-04  6.1589701e-04 -3.9338411e-04
 -1.2697676e-03]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0585917e-05 -5.6720286e-04  6.1589701e-04 -3.9338411e-04
 -1.2697676e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00349745 -0.01507027  0.02933179 -0.02394335  0.00343097]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.07768173 -0.05737718 -0.05967282 -0.10908823 -0.02010312]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.09796363 -0.09293479 -0.11320279 -0.16439755 -0.00950176]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.09796363 -0.09293479 -0.11320279 -0.16439755 -0.00950176]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01564977  0.02310931 -0.21155229 -0.03364354  0.00243912]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.35301968  0.27732417 -1.7938153  -0.32975546  0.03210078]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.35301968  0.27732417 -1.7938153  -0.32975546  0.03210078]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 4.8114815  -2.0332913   0.99868584  1.8831365  -6.663554  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 4.8114815  -2.0332913   0.99868584  1.8831365  -6.663554  ]
  [Layer 35] Output shape after mixer: (1, 1, 2048)
  [Layer 35] Output sample values after mixer: [ 4.8114815  -2.0332913   0.99868584  1.8831365  -6.663554  ]
  [Layer 35] Residual connection shape: (1, 1, 2048)
  [Layer 35] Residual connection sample values: [ 10.704081    -0.88782704 -24.248678    -7.300338    -3.6733985 ]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.17679931 -0.01484663 -0.39772582 -0.11895996 -0.06212245]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.17679931 -0.01484663 -0.39772582 -0.11895996 -0.06212245]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.17679931 -0.01484663 -0.39772582 -0.11895996 -0.06212245]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-2.163201   -1.4303429  -0.6671011   0.06190918 -1.2295173 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-2.163201   -1.4303429  -0.6671011   0.06190918 -1.2295173 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.10369059  1.6130625   0.07666386 -1.3562231  -0.88874114]
  [FlaxMamba2] dt (step) sample values: [ 1.5082266   0.7759062   1.5400747   0.71167344 -0.4492576 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.22343971  0.04255656 -1.0857224   0.10369059  1.6855369 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04282323  0.27224037  0.02211667 -0.272964    0.15951799]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.00662939  0.27210662 -0.00637149 -0.29789686  0.13165544]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00332568  0.15445043 -0.00317559 -0.12692541  0.07015476]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00332568  0.15445043 -0.00317559 -0.12692541  0.07015476]
  [FlaxMamba2] B (step) sample values: [ 0.1286736   0.35433742  0.03322116 -0.02169836  0.08287478]
  [FlaxMamba2] C (step) sample values: [-0.18693957 -0.27134082 -0.1059104  -0.13223648 -0.06674682]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6566098 -1.1305923 -1.6058172 -2.4414158 -2.882315 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.17981277 0.00798929 0.09682038 0.07322454 0.02634993]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.620213   0.99100804 0.85600775 0.8362969  0.9268637 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00332568  0.15445043 -0.00317559 -0.12692541  0.07015476]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 7.6946773e-05  2.1189368e-04  1.9866246e-05 -1.2975614e-05
  4.9559098e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 7.6946773e-05  2.1189368e-04  1.9866246e-05 -1.2975614e-05
  4.9559098e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 3.6155857e-04  1.0889947e-03 -1.6115523e-04  3.7151907e-04
 -9.5224445e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00079835  0.0094141  -0.00020384 -0.00670755  0.00219521]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00460887  0.18638137 -0.00384239 -0.15213701  0.08257762]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00460887  0.18638137 -0.00384239 -0.15213701  0.08257762]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00102794 -0.0514638   0.00086932 -0.00485507 -0.02297292]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.01652699 -1.2070273   0.01377232 -0.08657051 -0.354619  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01652699 -1.2070273   0.01377232 -0.08657051 -0.354619  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.9512392 -1.0934757 -4.689245  -1.2774649 -2.3990407]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.9512392 -1.0934757 -4.689245  -1.2774649 -2.3990407]
  [Layer 36] Output shape after mixer: (1, 1, 2048)
  [Layer 36] Output sample values after mixer: [-1.9512392 -1.0934757 -4.689245  -1.2774649 -2.3990407]
  [Layer 36] Residual connection shape: (1, 1, 2048)
  [Layer 36] Residual connection sample values: [  8.752841   -1.9813027 -28.937923   -8.577803   -6.072439 ]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15222616 -0.03525463 -0.49724516 -0.14432843 -0.10642338]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15222616 -0.03525463 -0.49724516 -0.14432843 -0.10642338]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15222616 -0.03525463 -0.49724516 -0.14432843 -0.10642338]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.24564411  1.4671239   0.59830374 -3.7595348  -0.5859462 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.24564411  1.4671239   0.59830374 -3.7595348  -0.5859462 ]
  [FlaxMamba2] xBC (step) sample values: [-0.4155812  -0.24296534 -0.17130886 -0.3639321  -0.6205452 ]
  [FlaxMamba2] dt (step) sample values: [1.3310809  0.8073487  0.40197417 1.6221948  0.90199775]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.45179865  0.2273136  -1.6311437  -0.4155812   0.4241732 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00437723  0.08099105 -0.02465232 -0.19553117 -0.1015732 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01675974  0.05254867 -0.01965125 -0.3464101  -0.08683321]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00830965  0.02696452 -0.00972908 -0.1435015  -0.04153279]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00830965  0.02696452 -0.00972908 -0.1435015  -0.04153279]
  [FlaxMamba2] B (step) sample values: [ 0.0088292   0.03455591 -0.08525728 -0.02062414 -0.05713036]
  [FlaxMamba2] C (step) sample values: [-0.15014715 -0.10173847 -0.22455859 -0.2648555  -0.26186892]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.06064401 -3.2470093  -0.81907064 -0.24529998 -1.975189  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03506454 0.0217413  0.01399446 0.0063167  0.0285071 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9978758  0.93183994 0.988603   0.9984517  0.94524896]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00830965  0.02696452 -0.00972908 -0.1435015  -0.04153279]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.5725992e-06 -1.0068693e-05  2.4841751e-05  6.0093375e-06
  1.6646300e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.5725992e-06 -1.0068693e-05  2.4841751e-05  6.0093375e-06
  1.6646300e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00086644 -0.00041636 -0.0030551  -0.00049825 -0.00153699]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01671595 -0.02221515 -0.01908703  0.08876727  0.07257649]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01829728 -0.02734652 -0.01723558  0.11607575  0.08048022]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01829728 -0.02734652 -0.01723558  0.11607575  0.08048022]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00197267 -0.03260291 -0.00665407 -0.00993413 -0.01686174]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.01772798 -0.26592538 -0.10695897 -0.29499882 -0.11191117]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01772798 -0.26592538 -0.10695897 -0.29499882 -0.11191117]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.9278383 -2.396511  -1.3034207  4.50697   -9.740342 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.9278383 -2.396511  -1.3034207  4.50697   -9.740342 ]
  [Layer 37] Output shape after mixer: (1, 1, 2048)
  [Layer 37] Output sample values after mixer: [-0.9278383 -2.396511  -1.3034207  4.50697   -9.740342 ]
  [Layer 37] Residual connection shape: (1, 1, 2048)
  [Layer 37] Residual connection sample values: [  7.8250027  -4.377814  -30.241344   -4.0708327 -15.812781 ]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.11072559 -0.06148043 -0.42268375 -0.05551497 -0.2210155 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11072559 -0.06148043 -0.42268375 -0.05551497 -0.2210155 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11072559 -0.06148043 -0.42268375 -0.05551497 -0.2210155 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.8527616  -0.84387296  0.8074232  -1.9084634   0.15207782]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.8527616  -0.84387296  0.8074232  -1.9084634   0.15207782]
  [FlaxMamba2] xBC (step) sample values: [-0.29388085  0.14164437  0.4405741  -0.04866157  0.29850844]
  [FlaxMamba2] dt (step) sample values: [1.035232  2.2947285 1.0654933 0.9594285 0.5877675]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.35418734  0.47133467 -0.822568   -0.29388085  0.48888022]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06682822 -0.0184259  -0.13770495 -0.01417674  0.07193694]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.09491965 -0.05559631 -0.16347705 -0.02578105  0.05068145]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.04971057 -0.02702562 -0.07507217 -0.01272437  0.02598274]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04971057 -0.02702562 -0.07507217 -0.01272437  0.02598274]
  [FlaxMamba2] B (step) sample values: [-0.18360522 -0.24383567 -0.05464245  0.10688345 -0.27605206]
  [FlaxMamba2] C (step) sample values: [-0.18863386 -0.17278233 -0.2652874   0.45400155 -0.11722431]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0881431 -1.3535548 -1.1764196 -1.6451025 -1.1940706]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.13985474 0.26387122 0.42566726 0.10638206 0.04098643]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.858832   0.6996576  0.6060679  0.83944917 0.9522376 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04971057 -0.02702562 -0.07507217 -0.01272437  0.02598274]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00127647 -0.00169521 -0.00037989  0.00074308 -0.00191919]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00127647 -0.00169521 -0.00037989  0.00074308 -0.00191919]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00267836 0.00332408 0.00018603 0.00122339 0.00171805]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0003627  -0.03127381 -0.0306586   0.0221487   0.00715195]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03989411 -0.0531598  -0.09145384  0.01184421  0.02819339]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03989411 -0.0531598  -0.09145384  0.01184421  0.02819339]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01016706  0.01349032 -0.05106615 -0.00291942  0.00230649]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.19830213  0.25449556 -1.010632   -0.05270705  0.03745957]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.19830213  0.25449556 -1.010632   -0.05270705  0.03745957]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [  0.962978   -4.9549646 -10.865356    5.200281    3.6770687]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [  0.962978   -4.9549646 -10.865356    5.200281    3.6770687]
  [Layer 38] Output shape after mixer: (1, 1, 2048)
  [Layer 38] Output sample values after mixer: [  0.962978   -4.9549646 -10.865356    5.200281    3.6770687]
  [Layer 38] Residual connection shape: (1, 1, 2048)
  [Layer 38] Residual connection sample values: [  8.787981   -9.332779  -41.1067      1.1294484 -12.135713 ]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.09589652 -0.10288855 -0.44929418  0.01236482 -0.13400428]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09589652 -0.10288855 -0.44929418  0.01236482 -0.13400428]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.09589652 -0.10288855 -0.44929418  0.01236482 -0.13400428]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.3752218   0.19620173 -0.98685455 -0.35691118 -0.19420822]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.3752218   0.19620173 -0.98685455 -0.35691118 -0.19420822]
  [FlaxMamba2] xBC (step) sample values: [ 1.4473349  -1.3426017   1.3164527  -1.3168596  -0.47401255]
  [FlaxMamba2] dt (step) sample values: [2.602999  1.5964841 1.4173344 1.3479695 1.3564056]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.79485327 1.5400192  2.3278708  1.4473349  0.40460876]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.27347878  0.21508226  0.23513743 -0.30785388 -0.07442369]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.25914314  0.30028734  0.21279857 -0.30377597 -0.09540452]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.14626704  0.17251891  0.11767756 -0.12899381 -0.04542848]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.14626704  0.17251891  0.11767756 -0.12899381 -0.04542848]
  [FlaxMamba2] B (step) sample values: [-0.00853749 -0.04529183 -0.00748702  0.13615471 -0.06377889]
  [FlaxMamba2] C (step) sample values: [ 0.29819885 -0.05137671  0.30341187  0.27205992 -0.10043482]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.69420344 -0.9242845  -1.3151171  -3.1532621  -2.1087465 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06347978 0.03670879 0.03616894 0.10154851 0.09627419]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.956889   0.96663976 0.9535472  0.7259972  0.8162637 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.14626704  0.17251891  0.11767756 -0.12899381 -0.04542848]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.9270627e-05 -4.2053469e-04 -6.9516958e-05  1.2641965e-03
 -5.9218705e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-7.9270627e-05 -4.2053469e-04 -6.9516958e-05  1.2641965e-03
 -5.9218705e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00265004 -0.00040791  0.00139231  0.00197549  0.00296109]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.01646815  0.02600085  0.00834702 -0.01984512  0.00342565]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.1417981   0.17382489  0.10917986 -0.13037437 -0.03550005]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.1417981   0.17382489  0.10917986 -0.13037437 -0.03550005]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03153611  0.01871988 -0.02925632  0.0191576   0.00311351]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.93970317  0.5992033  -0.9572737   0.5068647   0.09393092]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.93970317  0.5992033  -0.9572737   0.5068647   0.09393092]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.9195502  -6.8659267  -0.72389156  1.2917689  -1.0414497 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.9195502  -6.8659267  -0.72389156  1.2917689  -1.0414497 ]
  [Layer 39] Output shape after mixer: (1, 1, 2048)
  [Layer 39] Output sample values after mixer: [-2.9195502  -6.8659267  -0.72389156  1.2917689  -1.0414497 ]
  [Layer 39] Residual connection shape: (1, 1, 2048)
  [Layer 39] Residual connection sample values: [  5.868431  -16.198706  -41.830593    2.4212174 -13.177162 ]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05663105 -0.15754269 -0.41765982  0.02358706 -0.12680577]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05663105 -0.15754269 -0.41765982  0.02358706 -0.12680577]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05663105 -0.15754269 -0.41765982  0.02358706 -0.12680577]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.7729384  -0.27321917 -1.2925314   0.32329598 -1.6035029 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.7729384  -0.27321917 -1.2925314   0.32329598 -1.6035029 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.00958643  0.06943457 -0.20004438  0.29494548 -0.5704413 ]
  [FlaxMamba2] dt (step) sample values: [1.1876295  1.4927772  1.572686   1.5608892  0.90595627]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.03213707 0.84650826 0.05527284 0.00958643 0.57169247]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00186348 -0.03179841 -0.05388361 -0.06100247 -0.10027571]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01379204 -0.05042939 -0.04812723 -0.0708749  -0.10504027]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00684846 -0.02457905 -0.02348467 -0.03418216 -0.0497643 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00684846 -0.02457905 -0.02348467 -0.03418216 -0.0497643 ]
  [FlaxMamba2] B (step) sample values: [-0.10702498 -0.09556498 -0.04534631  0.00708403  0.10942332]
  [FlaxMamba2] C (step) sample values: [-0.00481469  0.00202916 -0.011807    0.21609811 -0.06512414]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9809841  -1.4352343  -0.79658854 -1.6062093  -1.8464803 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1762626  0.05879838 0.02173511 0.16466795 0.14031708]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7052708  0.9190732  0.98283505 0.76759636 0.77175146]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00684846 -0.02457905 -0.02348467 -0.03418216 -0.0497643 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.2919283e-04  1.1535916e-04  5.4738801e-05 -8.5513275e-06
 -1.3208794e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.2919283e-04  1.1535916e-04  5.4738801e-05 -8.5513275e-06
 -1.3208794e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00193569  0.00256274 -0.00051229 -0.00093838  0.00109134]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00262605 -0.00231312 -0.005672   -0.00637311 -0.01094306]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00296695 -0.02238634 -0.02485146 -0.03428899 -0.05158457]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00296695 -0.02238634 -0.02485146 -0.03428899 -0.05158457]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00072432  0.00264299  0.00691972 -0.006431    0.01385432]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.02201861  0.08082467  0.20836443 -0.22945857  0.4157096 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02201861  0.08082467  0.20836443 -0.22945857  0.4157096 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-11.238433   -4.456673   -3.7279713   5.7640285   5.9877324]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-11.238433   -4.456673   -3.7279713   5.7640285   5.9877324]
  [Layer 40] Output shape after mixer: (1, 1, 2048)
  [Layer 40] Output sample values after mixer: [-11.238433   -4.456673   -3.7279713   5.7640285   5.9877324]
  [Layer 40] Residual connection shape: (1, 1, 2048)
  [Layer 40] Residual connection sample values: [ -5.370002  -20.655378  -45.558563    8.1852455  -7.1894298]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.04907295 -0.19030577 -0.42521724  0.07479963 -0.06602316]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04907295 -0.19030577 -0.42521724  0.07479963 -0.06602316]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.04907295 -0.19030577 -0.42521724  0.07479963 -0.06602316]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.5009025  -0.391177   -0.21725841 -0.45914045 -0.58814293]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.5009025  -0.391177   -0.21725841 -0.45914045 -0.58814293]
  [FlaxMamba2] xBC (step) sample values: [-0.02623196  0.29188755  0.8350156  -0.47638002  0.24250709]
  [FlaxMamba2] dt (step) sample values: [ 0.9918265   1.3118159   1.6879853  -0.03889722  1.4421756 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.17966998 -0.26111516  0.4608445  -0.02623196 -0.11757173]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00583017  0.02558018  0.1561597  -0.09045803  0.07023878]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.01918161  0.01158024  0.15825778 -0.09719478  0.05465192]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00949882  0.00582365  0.08537723 -0.04623754  0.02807249]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00949882  0.00582365  0.08537723 -0.04623754  0.02807249]
  [FlaxMamba2] B (step) sample values: [-0.04376884 -0.06519005 -0.01120872 -0.23885657  0.14129807]
  [FlaxMamba2] C (step) sample values: [-0.00031186 -0.02425425  0.10840791 -0.09564371  0.16424268]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8258594 -1.8636904 -1.2829287 -1.4542811 -4.4079003]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.09759779 0.11191919 0.03835235 0.03976137 0.02672917]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8367752  0.8117339  0.95198756 0.9438158  0.8888565 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00949882  0.00582365  0.08537723 -0.04623754  0.02807249]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.0576528e-05  6.0435359e-05  1.0391206e-05  2.2143537e-04
 -1.3099238e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.0576528e-05  6.0435359e-05  1.0391206e-05  2.2143537e-04
 -1.3099238e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-9.9746452e-05  4.0554372e-04 -6.0156750e-04  3.5991457e-03
 -2.9423910e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00654336 -0.00069838  0.02774544 -0.00157277  0.0007306 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01580169  0.00497783  0.11096115 -0.0466397   0.02809236]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01580169  0.00497783  0.11096115 -0.0466397   0.02809236]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0029866  -0.00078557 -0.01074937  0.00829135 -0.00589948]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.10028225 -0.02636257 -0.35502937  0.28767174 -0.15952228]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.10028225 -0.02636257 -0.35502937  0.28767174 -0.15952228]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 4.006132    1.5372081  -0.00766307 -3.1244094   1.589939  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 4.006132    1.5372081  -0.00766307 -3.1244094   1.589939  ]
  [Layer 41] Output shape after mixer: (1, 1, 2048)
  [Layer 41] Output sample values after mixer: [ 4.006132    1.5372081  -0.00766307 -3.1244094   1.589939  ]
  [Layer 41] Residual connection shape: (1, 1, 2048)
  [Layer 41] Residual connection sample values: [ -1.3638697 -19.11817   -45.566227    5.060836   -5.5994906]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01241067 -0.17737009 -0.41890252  0.04571978 -0.05071712]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.01241067 -0.17737009 -0.41890252  0.04571978 -0.05071712]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.01241067 -0.17737009 -0.41890252  0.04571978 -0.05071712]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.0213699   0.4447835  -1.6406974  -0.09190067  0.46621338]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.0213699   0.4447835  -1.6406974  -0.09190067  0.46621338]
  [FlaxMamba2] xBC (step) sample values: [-0.8123917   0.6042481  -1.1135063  -0.23450017 -0.3577447 ]
  [FlaxMamba2] dt (step) sample values: [0.7142774  2.085892   1.7807457  0.22354853 1.4669751 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.33231723  1.3847492   0.20667031 -0.8123917   0.21291496]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.11737012 -0.10258915 -0.1679989  -0.06249059 -0.06072756]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.12670088 -0.11580326 -0.15795098 -0.0589639  -0.0806708 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.05934252 -0.05455277 -0.0727513  -0.02861302 -0.03870934]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05934252 -0.05455277 -0.0727513  -0.02861302 -0.03870934]
  [FlaxMamba2] B (step) sample values: [-0.01705966  0.02292649  0.04897409  0.0371519   0.39655033]
  [FlaxMamba2] C (step) sample values: [ 0.01011305 -0.09008937  0.16055477  0.28898    -0.25049704]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.06612   -1.4514434 -0.7269863 -1.9455162 -0.6256312]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04313987 0.87741023 0.02029486 0.03373997 0.04813474]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.95504934 0.27984726 0.98535424 0.9364664  0.97033435]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05934252 -0.05455277 -0.0727513  -0.02861302 -0.03870934]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.3673201e-05 -5.8692476e-05 -1.2537505e-04 -9.5109921e-05
 -1.0151800e-03]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.3673201e-05 -5.8692476e-05 -1.2537505e-04 -9.5109921e-05
 -1.0151800e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00038753 -0.00071473 -0.00067058  0.00130545  0.00016668]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.000211   -0.00256544 -0.00178936  0.00198683  0.00094514]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.059338   -0.05730803 -0.07479379 -0.02672575 -0.03789888]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.059338   -0.05730803 -0.07479379 -0.02672575 -0.03789888]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00062725 -0.01553336  0.01992509  0.00117167 -0.01085735]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.02437709 -0.59344834  0.7743583   0.03768862 -0.38301694]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.02437709 -0.59344834  0.7743583   0.03768862 -0.38301694]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 7.852306   2.5392494  2.236931   0.86079   -2.4022765]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 7.852306   2.5392494  2.236931   0.86079   -2.4022765]
  [Layer 42] Output shape after mixer: (1, 1, 2048)
  [Layer 42] Output sample values after mixer: [ 7.852306   2.5392494  2.236931   0.86079   -2.4022765]
  [Layer 42] Residual connection shape: (1, 1, 2048)
  [Layer 42] Residual connection sample values: [  6.488436 -16.57892  -43.329296   5.921626  -8.001767]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05662211 -0.15169895 -0.3792895   0.05255616 -0.06925157]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05662211 -0.15169895 -0.3792895   0.05255616 -0.06925157]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05662211 -0.15169895 -0.3792895   0.05255616 -0.06925157]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.6732948  -0.13480921 -0.78779215 -0.56937283 -0.28381836]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.6732948  -0.13480921 -0.78779215 -0.56937283 -0.28381836]
  [FlaxMamba2] xBC (step) sample values: [ 0.4704377 -1.1298168  0.5342429 -0.0578065 -1.677592 ]
  [FlaxMamba2] dt (step) sample values: [ 2.3784378  0.6024303 -0.498242   1.9435608  1.2625599]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.9246726  -0.28933084  0.34351736  0.4704377  -0.4871298 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06943146 -0.13598979  0.09783681  0.00279081  0.27730003]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0658609  -0.1816746   0.11031087  0.00869214  0.26848045]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.03401447 -0.0826085   0.05819448  0.00436496  0.15215318]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.03401447 -0.0826085   0.05819448  0.00436496  0.15215318]
  [FlaxMamba2] B (step) sample values: [ 0.01861995 -0.06254446  0.87191373 -0.01122617  0.03690706]
  [FlaxMamba2] C (step) sample values: [ 0.2772119  -0.08149655 -0.27634874 -0.04914401 -0.01633646]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9761645 -1.478265  -1.0588893 -1.0815219 -5.9141264]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04281534 0.02704264 0.00496465 0.04722643 0.17764506]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.95906657 0.96081233 0.99475676 0.95020604 0.3497225 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.03401447 -0.0826085   0.05819448  0.00436496  0.15215318]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.7117007e-05 -9.1086084e-05  1.2698041e-03 -1.6349133e-05
  5.3749282e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.7117007e-05 -9.1086084e-05  1.2698041e-03 -1.6349133e-05
  5.3749282e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00021521 -0.00143896  0.01235987  0.00016352  0.00016481]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00835078 -0.0100102  -0.00965696 -0.00838669  0.00565463]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03788782 -0.08174468  0.04087719 -0.00459631  0.13777941]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03788782 -0.08174468  0.04087719 -0.00459631  0.13777941]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00861613  0.00513913 -0.01006796  0.00094574 -0.01679601]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.40737376  0.18638071 -0.3427106   0.03549328 -0.7269623 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.40737376  0.18638071 -0.3427106   0.03549328 -0.7269623 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.9057198  2.9767678 -5.9393477  6.69149    3.4082592]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.9057198  2.9767678 -5.9393477  6.69149    3.4082592]
  [Layer 43] Output shape after mixer: (1, 1, 2048)
  [Layer 43] Output sample values after mixer: [ 1.9057198  2.9767678 -5.9393477  6.69149    3.4082592]
  [Layer 43] Residual connection shape: (1, 1, 2048)
  [Layer 43] Residual connection sample values: [  8.3941555 -13.602153  -49.268642   12.613116   -4.593508 ]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0700066  -0.11792193 -0.4147408   0.10464568 -0.03826968]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0700066  -0.11792193 -0.4147408   0.10464568 -0.03826968]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0700066  -0.11792193 -0.4147408   0.10464568 -0.03826968]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.0290384  -2.118311   -1.3477012  -0.11124229 -1.6878465 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.0290384  -2.118311   -1.3477012  -0.11124229 -1.6878465 ]
  [FlaxMamba2] xBC (step) sample values: [-1.8358371   0.7219684  -0.54950887 -1.6235832  -1.7361766 ]
  [FlaxMamba2] dt (step) sample values: [0.74209106 0.8141912  0.3061561  1.6176742  0.5173428 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.70534456 -0.6839967  -0.5128645  -1.8358371  -0.22827129]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.31523338 -0.08892497 -0.08556584 -0.34252784  0.20361386]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.3213407  -0.02850016 -0.10402897 -0.34907767  0.15112363]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.13507526 -0.01404703 -0.04931142 -0.14438064  0.08126056]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.13507526 -0.01404703 -0.04931142 -0.14438064  0.08126056]
  [FlaxMamba2] B (step) sample values: [-0.27476797 -0.04409511  0.05422926 -0.01879077  0.03194219]
  [FlaxMamba2] C (step) sample values: [-0.27844667 -0.02712625  0.18251501 -0.05814024 -0.05127567]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.74823433 -0.64391696 -1.1771379  -1.350584   -1.0269372 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04544447 0.03370171 0.01509205 0.04879614 0.06148585]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.96656847 0.9785327  0.9823915  0.9362214  0.93881005]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.13507526 -0.01404703 -0.04931142 -0.14438064  0.08126056]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00168664  0.00027067 -0.00033288  0.00011535 -0.00019607]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00168664  0.00027067 -0.00033288  0.00011535 -0.00019607]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 8.9559173e-03 -2.2829164e-04 -1.4722624e-03  9.9339231e-06
 -1.9129078e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00861198 -0.00195695 -0.00142548 -0.01174769  0.00679328]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.13549714 -0.01515226 -0.04774697 -0.14737402  0.08312672]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.13549714 -0.01515226 -0.04774697 -0.14737402  0.08312672]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.03670828  0.00344499  0.01327168  0.00774165 -0.02189592]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 1.4116668   0.10577721  0.5499283   0.27823156 -0.85614467]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 1.4116668   0.10577721  0.5499283   0.27823156 -0.85614467]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.05178156 -5.441157   -5.835339    0.42162544 -0.20696819]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.05178156 -5.441157   -5.835339    0.42162544 -0.20696819]
  [Layer 44] Output shape after mixer: (1, 1, 2048)
  [Layer 44] Output sample values after mixer: [-0.05178156 -5.441157   -5.835339    0.42162544 -0.20696819]
  [Layer 44] Residual connection shape: (1, 1, 2048)
  [Layer 44] Residual connection sample values: [  8.342374 -19.04331  -55.10398   13.034741  -4.800476]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.0691026  -0.16207683 -0.4583025   0.10621271 -0.03956154]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0691026  -0.16207683 -0.4583025   0.10621271 -0.03956154]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.0691026  -0.16207683 -0.4583025   0.10621271 -0.03956154]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.4485761  -0.6402611   0.04474285  0.39467734  1.315676  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.4485761  -0.6402611   0.04474285  0.39467734  1.315676  ]
  [FlaxMamba2] xBC (step) sample values: [ 0.04467821  0.06740516 -0.22443356 -0.13443002 -2.102752  ]
  [FlaxMamba2] dt (step) sample values: [ 1.7857599   1.8735973  -1.075689    0.9464963   0.99426967]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5000783   1.170957    0.9238664   0.04467821 -0.19819975]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.0233127  -0.01136095 -0.02665493 -0.02773777  0.37326816]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.01873507  0.04085463 -0.02910587 -0.03432193  0.37076572]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00945528  0.02084453 -0.01434116 -0.0168665   0.2193613 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00945528  0.02084453 -0.01434116 -0.0168665   0.2193613 ]
  [FlaxMamba2] B (step) sample values: [-0.08004811  0.11104763  0.17429811 -0.23969765  0.00185125]
  [FlaxMamba2] C (step) sample values: [-0.04767636  0.02904889 -0.03599121 -0.1946691   0.06054914]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.250236  -4.181475  -1.0937363 -2.677446  -2.3148744]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04220964 0.13864703 0.00666647 0.03216688 0.01492662]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9093896  0.56003886 0.99273515 0.91747946 0.9660369 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00945528  0.02084453 -0.01434116 -0.0168665   0.2193613 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.1947518e-05  4.4319549e-05  6.9563066e-05 -9.5664283e-05
  7.3883928e-07]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.1947518e-05  4.4319549e-05  6.9563066e-05 -9.5664283e-05
  7.3883928e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.1471146e-03 -4.1384163e-04 -5.4850934e-05 -6.3240703e-04
  2.8249939e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00196007  0.00165317 -0.00674539 -0.00598522  0.04960186]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01256734  0.0250373  -0.02283381 -0.02490664  0.29568908]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01256734  0.0250373  -0.02283381 -0.02490664  0.29568908]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00344051 -0.0055335  -0.00052225 -0.00587257  0.30673593]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.1370977  -0.15989405 -0.01912427 -0.19686605 11.028114  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.1370977  -0.15989405 -0.01912427 -0.19686605 11.028114  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 7.075207   -1.9054984   0.72623193  3.6908014   0.16193202]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 7.075207   -1.9054984   0.72623193  3.6908014   0.16193202]
  [Layer 45] Output shape after mixer: (1, 1, 2048)
  [Layer 45] Output sample values after mixer: [ 7.075207   -1.9054984   0.72623193  3.6908014   0.16193202]
  [Layer 45] Residual connection shape: (1, 1, 2048)
  [Layer 45] Residual connection sample values: [ 15.417582 -20.948809 -54.37775   16.725542  -4.638544]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.14920111 -0.21129707 -0.53601795  0.16363735 -0.04458519]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14920111 -0.21129707 -0.53601795  0.16363735 -0.04458519]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14920111 -0.21129707 -0.53601795  0.16363735 -0.04458519]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.10768761 -0.28916174  0.37586826 -1.3688911  -0.97032595]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.10768761 -0.28916174  0.37586826 -1.3688911  -0.97032595]
  [FlaxMamba2] xBC (step) sample values: [ 1.7096478  -0.08411314 -0.36347148 -0.2131054  -0.10047169]
  [FlaxMamba2] dt (step) sample values: [ 1.4192766   2.2339616   0.1429095   0.77954566 -0.8997244 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.87103164  0.24076298  0.92738557  1.7096478  -0.13413201]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.28902313 -0.0126635  -0.06059637  0.01792433  0.01792362]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.29216072 -0.01646294 -0.08169928  0.00208571  0.03823306]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.12489139 -0.00816371 -0.03918187  0.00104394  0.01948193]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.12489139 -0.00816371 -0.03918187  0.00104394  0.01948193]
  [FlaxMamba2] B (step) sample values: [-0.14729188 -0.20699021  0.01823823  0.00172972 -0.08484856]
  [FlaxMamba2] C (step) sample values: [ 0.04245783 -0.27845407 -0.07021545  0.09728208  0.13342734]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8673339  -0.9793274  -1.6584101  -0.94076145 -0.4381494 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01242897 0.05181748 0.00730396 0.02241358 0.00359545]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.97705823 0.9505198  0.9879601  0.9791349  0.9984259 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.12489139 -0.00816371 -0.03918187  0.00104394  0.01948193]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.2863693e-04  3.2130492e-04 -2.8310680e-05 -2.6849955e-06
  1.3170797e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.2863693e-04  3.2130492e-04 -2.8310680e-05 -2.6849955e-06
  1.3170797e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 5.5331003e-04  1.8612148e-03 -1.9056164e-04 -8.1712999e-05
 -2.5145494e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.0173382e-03  7.4238626e-05 -3.8283764e-04  6.2587368e-04
  1.1866619e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.10073749 -0.00644412 -0.0316678   0.00145941  0.0167421 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.10073749 -0.00644412 -0.0316678   0.00145941  0.0167421 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00571586  0.00079792 -0.00705696 -0.00040515 -0.00446446]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.19749692  0.02632116 -0.2102873  -0.0111744  -0.15037562]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.19749692  0.02632116 -0.2102873  -0.0111744  -0.15037562]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ -1.6329057   -2.1699812   -6.842719     0.10828033 -17.88258   ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ -1.6329057   -2.1699812   -6.842719     0.10828033 -17.88258   ]
  [Layer 46] Output shape after mixer: (1, 1, 2048)
  [Layer 46] Output sample values after mixer: [ -1.6329057   -2.1699812   -6.842719     0.10828033 -17.88258   ]
  [Layer 46] Residual connection shape: (1, 1, 2048)
  [Layer 46] Residual connection sample values: [ 13.784676 -23.11879  -61.22047   16.833822 -22.521124]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.11616892 -0.19668496 -0.500466    0.13930064 -0.17751467]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11616892 -0.19668496 -0.500466    0.13930064 -0.17751467]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.11616892 -0.19668496 -0.500466    0.13930064 -0.17751467]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.8013213   0.77178794 -0.8056501  -1.0202338  -1.090084  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.8013213   0.77178794 -0.8056501  -1.0202338  -1.090084  ]
  [FlaxMamba2] xBC (step) sample values: [ 0.18091597 -0.7292887   0.63086694  0.23725101 -0.03840729]
  [FlaxMamba2] dt (step) sample values: [0.26099795 0.14452189 2.7768207  1.6106359  1.1466649 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.16257574  0.00613084  0.41813856  0.18091597 -0.7630959 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02480638  0.12932944  0.06045781 -0.02299815 -0.00585046]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.00770128  0.1044271  -0.15902461 -0.02637797 -0.00067392]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.00383581  0.05493733 -0.07320338 -0.01301504 -0.00033685]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.00383581  0.05493733 -0.07320338 -0.01301504 -0.00033685]
  [FlaxMamba2] B (step) sample values: [-0.12974387 -0.02679643 -0.25487518 -0.27737758  0.00946496]
  [FlaxMamba2] C (step) sample values: [ 0.68156004  0.34766898 -0.02804466 -0.27491328 -0.00282836]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -3.552239  -11.244981   -2.6866128  -3.193549   -3.1997924]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02893889 0.01752823 0.04073581 0.01817262 0.03612853]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.90230936 0.82110476 0.8963347  0.9436168  0.89082813]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.00383581  0.05493733 -0.07320338 -0.01301504 -0.00033685]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.4402111e-05  2.9745156e-06  2.8292208e-05  3.0790066e-05
 -1.0506503e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.4402111e-05  2.9745156e-06  2.8292208e-05  3.0790066e-05
 -1.0506503e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00026065 -0.00012091 -0.00065089 -0.00038428  0.00011235]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00053995 -0.00265263 -0.00932647 -0.00280257 -0.00012624]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0048832   0.07501881 -0.11282282 -0.02120349 -0.00060248]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0048832   0.07501881 -0.11282282 -0.02120349 -0.00060248]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.00121203 0.0395973  0.02807025 0.00573222 0.00016524]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.03570786 0.6992072  0.81115377 0.17303507 0.00478389]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.03570786 0.6992072  0.81115377 0.17303507 0.00478389]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ -3.6283221  -2.1619303 -10.343853   -4.455464    2.6698616]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ -3.6283221  -2.1619303 -10.343853   -4.455464    2.6698616]
  [Layer 47] Output shape after mixer: (1, 1, 2048)
  [Layer 47] Output sample values after mixer: [ -3.6283221  -2.1619303 -10.343853   -4.455464    2.6698616]
  [Layer 47] Residual connection shape: (1, 1, 2048)
  [Layer 47] Residual connection sample values: [ 10.156353 -25.28072  -71.56432   12.378359 -19.851263]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.08278372 -0.19241364 -0.5324389   0.09501272 -0.14376907]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.08278372 -0.19241364 -0.5324389   0.09501272 -0.14376907]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.08278372 -0.19241364 -0.5324389   0.09501272 -0.14376907]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.35105813 -0.25152427  0.11130625 -0.48506176 -1.0328418 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.35105813 -0.25152427  0.11130625 -0.48506176 -1.0328418 ]
  [FlaxMamba2] xBC (step) sample values: [-0.18895857  0.6391684   0.16332659 -0.24183777  0.1534659 ]
  [FlaxMamba2] dt (step) sample values: [ 0.10404874  1.6839939  -1.1274236   0.34824184 -0.08215807]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.7337517  -0.01763411  0.38660777 -0.18895857  0.16931805]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.02547882  0.06405415  0.02246373 -0.05102241 -0.0254523 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.02030609  0.28402483 -0.06341274 -0.11730659 -0.02789752]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01025612  0.16204545 -0.03070141 -0.05521703 -0.0137542 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01025612  0.16204545 -0.03070141 -0.05521703 -0.0137542 ]
  [FlaxMamba2] B (step) sample values: [-0.10769682 -0.04070318  0.0553989  -0.01670941 -0.0348415 ]
  [FlaxMamba2] C (step) sample values: [-0.07964119 -0.24186347 -0.11466022 -0.22996892  0.06594151]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-54.81184   -78.514336  -47.25076    -2.330753   -4.2266355]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0341845  0.04660891 0.00131754 0.00155087 0.0069269 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.15355206 0.02574623 0.93964344 0.99639183 0.97114694]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01025612  0.16204545 -0.03070141 -0.05521703 -0.0137542 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.7758564e-05 -1.4270556e-05  1.9422885e-05 -5.8583282e-06
 -1.2215449e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.7758564e-05 -1.4270556e-05  1.9422885e-05 -5.8583282e-06
 -1.2215449e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-4.2580428e-05 -1.9088950e-05  2.3341137e-05 -2.6281332e-06
 -2.1573655e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 6.1161889e-05  1.6953462e-03 -6.5233913e-04 -8.2432979e-04
 -1.2356466e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00822738  0.13072059 -0.02509768 -0.04478971 -0.01107506]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00822738  0.13072059 -0.02509768 -0.04478971 -0.01107506]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00119323 -0.01438304 -0.00147442  0.00827877  0.00300306]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.04691534 -0.46346003 -0.04916674  0.31633976  0.12774621]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.04691534 -0.46346003 -0.04916674  0.31633976  0.12774621]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-25.510347   -16.94632    -23.81023     26.349651     0.24068925]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-25.510347   -16.94632    -23.81023     26.349651     0.24068925]
  [Layer 48] Output shape after mixer: (1, 1, 2048)
  [Layer 48] Output sample values after mixer: [-25.510347   -16.94632    -23.81023     26.349651     0.24068925]
  [Layer 48] Residual connection shape: (1, 1, 2048)
  [Layer 48] Residual connection sample values: [-15.353994 -42.22704  -95.37456   38.728012 -19.610575]
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.1273664  -0.3874341  -0.8057244   0.3336502  -0.16110781]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Final backbone norm output sample values: [-0.1273664  -0.3874341  -0.8057244   0.3336502  -0.16110781]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 1, 50288)
[Mamba2LMHeadModel] Logits sample values: [ 7.008424  -6.6157117  4.392304   5.5547624  3.2240152]
 enterprise[Mamba2LMHeadModel] Forward pass input_ids shape: (1, 1)
[Mamba2LMHeadModel] input_ids sample values: [16100]
[Mamba2LMHeadModel] Embedding output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Embedding sample values: [ 0.2479248  -0.22668457 -0.21606445  0.24694824 -0.18640137]
[Mamba2LMHeadModel] Processing layer 1/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.26292428 -0.27202174 -0.23671113  0.2705461  -0.2006738 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.26292428 -0.27202174 -0.23671113  0.2705461  -0.2006738 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.26292428 -0.27202174 -0.23671113  0.2705461  -0.2006738 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.07525343 -0.17256477  0.00538611  0.15692757  0.9847104 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.07525343 -0.17256477  0.00538611  0.15692757  0.9847104 ]
  [FlaxMamba2] xBC (step) sample values: [-0.2866966   0.30745307 -0.630859    0.10692745 -0.61284775]
  [FlaxMamba2] dt (step) sample values: [ 0.59284127 -0.16019487  0.5683336  -0.3511524   0.3780118 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.45514706 -0.8021352   0.40460795 -0.2866966   0.41143546]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.08095505  0.10013679  0.09968207  0.0293496  -0.25287122]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.30873826  0.31546882  0.36994573  0.07854394 -0.50970715]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.17801146  0.18241026  0.21880287  0.04081346 -0.19127382]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.17801146  0.18241026  0.21880287  0.04081346 -0.19127382]
  [FlaxMamba2] B (step) sample values: [ 0.28429466  0.04756939 -0.27331182 -0.2761261   0.09131929]
  [FlaxMamba2] C (step) sample values: [-0.22440885  0.8835294  -0.27423364 -0.04835023 -0.09330168]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.617978  -2.5226073 -3.0473056 -3.307819  -3.9089987]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01639661 0.01157444 0.01594092 0.01726599 0.0106173 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9579823  0.97122437 0.95258415 0.9444876  0.9593464 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.17801146  0.18241026  0.21880287  0.04081346 -0.19127382]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00082979  0.00013884 -0.00079774 -0.00080595  0.00026654]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00082979  0.00013884 -0.00079774 -0.00080595  0.00026654]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00321626  0.0016936  -0.00435012 -0.00448861  0.00101855]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.09661072  0.0904063   0.11907632  0.01415133 -0.09327389]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.16450033  0.15997349  0.20252284  0.02971668 -0.16622145]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.16450033  0.15997349  0.20252284  0.02971668 -0.16622145]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00642239 -0.01261489  0.00054687  0.00251426 -0.11916589]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01296691 -0.02743269  0.00094203  0.00837966 -0.24505764]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01296691 -0.02743269  0.00094203  0.00837966 -0.24505764]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.01973639  1.6343726   0.75278044 -0.6763827   0.6302638 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.01973639  1.6343726   0.75278044 -0.6763827   0.6302638 ]
  [Layer 1] Output shape after mixer: (1, 1, 2048)
  [Layer 1] Output sample values after mixer: [ 0.01973639  1.6343726   0.75278044 -0.6763827   0.6302638 ]
  [Layer 1] Residual connection shape: (1, 1, 2048)
  [Layer 1] Residual connection sample values: [ 0.26766118  1.407688    0.536716   -0.42943448  0.44386244]
[Mamba2LMHeadModel] Processing layer 2/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13830316  0.57441765  0.25557533 -0.21424153  0.21632221]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13830316  0.57441765  0.25557533 -0.21424153  0.21632221]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13830316  0.57441765  0.25557533 -0.21424153  0.21632221]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.1488218  -0.3568931   0.49313986 -2.1478157  -2.2719347 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.1488218  -0.3568931   0.49313986 -2.1478157  -2.2719347 ]
  [FlaxMamba2] xBC (step) sample values: [-1.3569406   3.0144792  -1.7532846   4.525156    0.61464196]
  [FlaxMamba2] dt (step) sample values: [0.98572475 1.4176345  0.8072245  1.1794614  2.0194993 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.7517786  -0.15312672 -1.5585302  -1.3569406   1.775101  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.21156828 -0.6663725  -0.1972557  -2.7460318   0.2003813 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.24138395 -0.8209135  -0.207769   -1.6923208   0.1872511 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.10619574 -0.25084636 -0.09313116 -0.26310658  0.10236577]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.10619574 -0.25084636 -0.09313116 -0.26310658  0.10236577]
  [FlaxMamba2] B (step) sample values: [ 0.14131695  0.08792445  0.03966545 -0.19813965  0.20813246]
  [FlaxMamba2] C (step) sample values: [-0.03438677 -0.25415197  0.15355383 -0.0660872  -0.27530876]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-19.851534   -18.68525    -13.564036    -2.4188707   -0.46617994]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01624347 0.02569023 0.04670632 0.02360197 0.10633402]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7243664  0.61876583 0.5307171  0.94450897 0.9516378 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.10619574 -0.25084636 -0.09313116 -0.26310658  0.10236577]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.4377000e-04 -1.5166860e-04 -6.8422414e-05  3.4178849e-04
 -3.5902596e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.4377000e-04 -1.5166860e-04 -6.8422414e-05  3.4178849e-04
 -3.5902596e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.5918136e-04 -1.8823298e-04  2.2099288e-05  1.6421395e-04
 -1.4431178e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00175582 -0.0567002  -0.01064362 -0.07123625  0.00119001]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07506774 -0.22987123 -0.07493644 -0.2528711   0.07185791]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07506774 -0.22987123 -0.07493644 -0.2528711   0.07185791]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00517097  0.03377661 -0.02294283  0.05677538 -0.01526026]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00138963  0.00429411 -0.00653075  0.00654316 -0.00440382]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00138963  0.00429411 -0.00653075  0.00654316 -0.00440382]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.01592801 -0.01189625 -0.11358778  0.02118779  0.0233092 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.01592801 -0.01189625 -0.11358778  0.02118779  0.0233092 ]
  [Layer 2] Output shape after mixer: (1, 1, 2048)
  [Layer 2] Output sample values after mixer: [ 0.01592801 -0.01189625 -0.11358778  0.02118779  0.0233092 ]
  [Layer 2] Residual connection shape: (1, 1, 2048)
  [Layer 2] Residual connection sample values: [ 0.28358918  1.3957918   0.4231282  -0.4082467   0.46717164]
[Mamba2LMHeadModel] Processing layer 3/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15703474  0.6043239   0.20990553 -0.20837319  0.25646025]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15703474  0.6043239   0.20990553 -0.20837319  0.25646025]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15703474  0.6043239   0.20990553 -0.20837319  0.25646025]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.44529706 -1.0496453  -2.431273   -2.1931756   0.09508625]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.44529706 -1.0496453  -2.431273   -2.1931756   0.09508625]
  [FlaxMamba2] xBC (step) sample values: [ 0.4135593  -2.4019015  -0.60253733  2.8656752   0.61861384]
  [FlaxMamba2] dt (step) sample values: [1.2615372 1.2145482 1.9921892 1.7473643 1.7441864]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.0515903 -1.0486968  1.1436963  0.4135593  0.4026365]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.11306038  0.01345546 -0.06203543  0.21080497 -0.3052473 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.11460914 -0.00584691  0.0616218   0.19846824 -0.3215437 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.05402435 -0.00291491  0.03175991  0.10904933 -0.13514468]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05402435 -0.00291491  0.03175991  0.10904933 -0.13514468]
  [FlaxMamba2] B (step) sample values: [ 0.22277673  0.02410536  0.01925044  0.16456695 -0.07206395]
  [FlaxMamba2] C (step) sample values: [ 0.51465285  0.11296477 -0.17970714 -0.0781495   0.11113416]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6505536 -3.9938898 -6.780579  -0.9418818 -6.0307717]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02929063 0.06707206 0.09583078 0.03708026 0.11815196]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9811253  0.7650008  0.52215636 0.9656776  0.4903933 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05402435 -0.00291491  0.03175991  0.10904933 -0.13514468]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.5252344e-04 -3.8144492e-05 -3.0462032e-05 -2.6041188e-04
  1.1403450e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.5252344e-04 -3.8144492e-05 -3.0462032e-05 -2.6041188e-04
  1.1403450e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00076748 -0.00135364  0.00300471 -0.0013545   0.00071319]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.02637104  0.26664257  0.20840336 -0.04580159 -0.0308963 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00177523  0.2653155   0.22286278  0.00384558 -0.09242398]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00177523  0.2653155   0.22286278  0.00384558 -0.09242398]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00030868 -0.07220984 -0.04379091 -0.00084648 -0.00460288]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00013743 -0.03505706 -0.01713369 -0.00050736 -0.00158982]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00013743 -0.03505706 -0.01713369 -0.00050736 -0.00158982]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.02013984 -0.02413328  0.13830079 -0.04506178 -0.03982008]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.02013984 -0.02413328  0.13830079 -0.04506178 -0.03982008]
  [Layer 3] Output shape after mixer: (1, 1, 2048)
  [Layer 3] Output sample values after mixer: [ 0.02013984 -0.02413328  0.13830079 -0.04506178 -0.03982008]
  [Layer 3] Residual connection shape: (1, 1, 2048)
  [Layer 3] Residual connection sample values: [ 0.30372903  1.3716584   0.56142896 -0.45330846  0.42735156]
[Mamba2LMHeadModel] Processing layer 4/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.18439025  0.6306354   0.3010844  -0.25144935  0.26025414]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18439025  0.6306354   0.3010844  -0.25144935  0.26025414]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18439025  0.6306354   0.3010844  -0.25144935  0.26025414]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.2389364   2.5480154  -0.24495603 -2.516433   -1.186306  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.2389364   2.5480154  -0.24495603 -2.516433   -1.186306  ]
  [FlaxMamba2] xBC (step) sample values: [-0.00885479  0.5757862  -0.71635157  0.06151485 -1.1123335 ]
  [FlaxMamba2] dt (step) sample values: [1.1484761  2.6772983  1.7705402  0.24610746 0.3534776 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.3303822   1.3904788   0.49621466 -0.00885479 -2.6721506 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02691794 -0.03622843  0.05838695 -0.07068607  0.13924292]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.10070945 -0.07138468  0.01016918 -0.08650944  0.43221167]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04782127 -0.03441894  0.00511044 -0.04138491  0.26209387]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04782127 -0.03441894  0.00511044 -0.04138491  0.26209387]
  [FlaxMamba2] B (step) sample values: [ 0.34658125  0.32084018 -0.13013949  0.04418295  0.08781547]
  [FlaxMamba2] C (step) sample values: [ 0.7372695  -0.03730728 -0.04352927 -0.26748666  0.5534492 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.7127254  -1.2862217  -1.4869522 -27.028044   -4.0726624]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01923544 0.03448139 0.01118847 0.00414259 0.05354042]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.96759176 0.9566184  0.9835009  0.8940745  0.8040836 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04782127 -0.03441894  0.00511044 -0.04138491  0.26209387]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.1880735e-04 -2.9512908e-04  1.1971053e-04 -4.0642266e-05
 -8.0778220e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.1880735e-04 -2.9512908e-04  1.1971053e-04 -4.0642266e-05
 -8.0778220e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00305903 -0.00227769 -0.00206683  0.00063779 -0.00053021]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01625188  0.0604822  -0.02006762 -0.04775362  0.2835162 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04316938  0.04110856 -0.01719107 -0.07104824  0.43104285]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04316938  0.04110856 -0.01719107 -0.07104824  0.43104285]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01201366  0.09714494  0.00184893  0.01335801 -0.11961483]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00617045  0.03205905  0.00093367  0.00568432 -0.03037376]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00617045  0.03205905  0.00093367  0.00568432 -0.03037376]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.06034466 -0.00215902  0.24346006 -0.19671907 -0.03503676]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.06034466 -0.00215902  0.24346006 -0.19671907 -0.03503676]
  [Layer 4] Output shape after mixer: (1, 1, 2048)
  [Layer 4] Output sample values after mixer: [ 0.06034466 -0.00215902  0.24346006 -0.19671907 -0.03503676]
  [Layer 4] Residual connection shape: (1, 1, 2048)
  [Layer 4] Residual connection sample values: [ 0.3640737  1.3694994  0.804889  -0.6500275  0.3923148]
[Mamba2LMHeadModel] Processing layer 5/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.20513582  0.63767666  0.42358798 -0.35080487  0.22810161]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.20513582  0.63767666  0.42358798 -0.35080487  0.22810161]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.20513582  0.63767666  0.42358798 -0.35080487  0.22810161]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-2.5753527   0.70482373 -0.6702965  -2.5493917   1.1895041 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-2.5753527   0.70482373 -0.6702965  -2.5493917   1.1895041 ]
  [FlaxMamba2] xBC (step) sample values: [-1.9022293   0.80370843  1.6341292   2.1248255  -1.3118963 ]
  [FlaxMamba2] dt (step) sample values: [2.1845016  1.5427207  0.8054711  0.27588245 0.27657816]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.0259489 -0.7607311  1.3624507 -1.9022293 -0.4396107]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.3470707  -0.23019166 -0.23150897  0.00646849 -0.60274136]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.3986454  -0.26751465 -0.301028   -0.01965456 -0.60860455]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.16011108 -0.11597224 -0.12802908 -0.00973071 -0.2144586 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.16011108 -0.11597224 -0.12802908 -0.00973071 -0.2144586 ]
  [FlaxMamba2] B (step) sample values: [-0.05023839 -0.0500129  -0.06462762  0.06192894  0.02921714]
  [FlaxMamba2] C (step) sample values: [-0.19734862  0.09856649 -0.08377162 -0.2549104  -0.0219182 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.5762966   -1.0443833   -0.83880144  -5.6764617  -20.401838  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03406603 0.05507788 0.09256536 0.01826452 0.00449245]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.94771814 0.94410074 0.9252938  0.90151566 0.9124205 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.16011108 -0.11597224 -0.12802908 -0.00973071 -0.2144586 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00027402  0.00027279  0.0003525  -0.00033778 -0.00015936]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00027402  0.00027279  0.0003525  -0.00033778 -0.00015936]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 9.3201015e-05  2.9854724e-05  7.0031942e-04  3.2822139e-04
 -7.1909948e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00715326  0.00497723 -0.0285804  -0.00084836 -0.02678701]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.09321754 -0.05736116 -0.09739969 -0.00607889 -0.14206463]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.09321754 -0.05736116 -0.09739969 -0.00607889 -0.14206463]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0169828  -0.02705771  0.022095    0.00112306 -0.12955387]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01357936 -0.02206521  0.01716227  0.00091305 -0.09336018]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01357936 -0.02206521  0.01716227  0.00091305 -0.09336018]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.00349955 -0.16501085  0.04986012  0.09036867  0.18066148]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.00349955 -0.16501085  0.04986012  0.09036867  0.18066148]
  [Layer 5] Output shape after mixer: (1, 1, 2048)
  [Layer 5] Output sample values after mixer: [ 0.00349955 -0.16501085  0.04986012  0.09036867  0.18066148]
  [Layer 5] Residual connection shape: (1, 1, 2048)
  [Layer 5] Residual connection sample values: [ 0.36757323  1.2044886   0.85474914 -0.5596588   0.5729763 ]
[Mamba2LMHeadModel] Processing layer 6/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.18880056  0.47882995  0.3896578  -0.26373386  0.29854318]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18880056  0.47882995  0.3896578  -0.26373386  0.29854318]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18880056  0.47882995  0.3896578  -0.26373386  0.29854318]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 2.8084939   0.94218445 -0.21395165  1.8928462  -2.146704  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 2.8084939   0.94218445 -0.21395165  1.8928462  -2.146704  ]
  [FlaxMamba2] xBC (step) sample values: [ 2.9639974 -2.1712565 -1.7756863 -1.3649249 -1.9128183]
  [FlaxMamba2] dt (step) sample values: [3.2916873 1.5122192 1.1272658 1.4812325 1.4354331]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.11477014 -0.0793758   0.17969343  2.9639974  -0.311579  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.34858257 -0.22285366 -1.2463342  -0.1039601  -1.2597286 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.31421977 -0.29518032 -1.3084985  -0.04185683 -1.1900264 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.13262747 -0.1259641  -0.27836764 -0.02049048 -0.27757868]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.13262747 -0.1259641  -0.27836764 -0.02049048 -0.27757868]
  [FlaxMamba2] B (step) sample values: [ 0.08285921  0.08666264 -0.18654697 -0.16654253  0.03870017]
  [FlaxMamba2] C (step) sample values: [ 0.26678213 -0.18950365 -0.27445883  0.0995476   0.2833748 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.98658675 -8.774721   -3.3045902  -2.9912853  -3.3435438 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.22752781 0.06083426 0.2392407  0.26228544 0.11922704]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7989348  0.58637035 0.45357597 0.4563156  0.67123175]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.13262747 -0.1259641  -0.27836764 -0.02049048 -0.27757868]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0025004  -0.00261517  0.00562932  0.00502566 -0.00116783]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0025004  -0.00261517  0.00562932  0.00502566 -0.00116783]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00976426 -0.00298952 -0.00196785  0.00456305  0.00158326]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.05576168 -0.17650788 -0.2679982  -0.0378171  -0.26547736]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02704083 -0.20378576 -0.3282795  -0.04225437 -0.3255878 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02704083 -0.20378576 -0.3282795  -0.04225437 -0.3255878 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.07162529 -0.13815452  0.03137546 -0.06950989  0.07313689]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.06041415 -0.05459192  0.01178588 -0.03394988  0.02521509]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.06041415 -0.05459192  0.01178588 -0.03394988  0.02521509]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.8282166   0.12088639 -0.3538632  -0.37222192 -0.21952716]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.8282166   0.12088639 -0.3538632  -0.37222192 -0.21952716]
  [Layer 6] Output shape after mixer: (1, 1, 2048)
  [Layer 6] Output sample values after mixer: [ 0.8282166   0.12088639 -0.3538632  -0.37222192 -0.21952716]
  [Layer 6] Residual connection shape: (1, 1, 2048)
  [Layer 6] Residual connection sample values: [ 1.1957898   1.3253751   0.50088596 -0.9318807   0.35344914]
[Mamba2LMHeadModel] Processing layer 7/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.46828517  0.43109977  0.18183957 -0.3341381   0.13885391]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.46828517  0.43109977  0.18183957 -0.3341381   0.13885391]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.46828517  0.43109977  0.18183957 -0.3341381   0.13885391]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.0687572  -1.8444879  -2.1677737   0.01973847  0.06006756]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.0687572  -1.8444879  -2.1677737   0.01973847  0.06006756]
  [FlaxMamba2] xBC (step) sample values: [-1.8469846   0.51698834 -2.308546   -1.0379894   0.33593312]
  [FlaxMamba2] dt (step) sample values: [ 1.1203756  -0.00763595  1.7896566   1.416528    0.7359922 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.6185312  -3.4465427  -2.2220976  -1.8469846  -0.38932902]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.05406049  0.17448384  0.14701797 -0.00219603 -0.26138926]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.12217572  0.19911152  0.1462679   0.00422792 -0.2649827 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.05736077  0.10943449  0.07847302  0.00211843 -0.11503939]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.05736077  0.10943449  0.07847302  0.00211843 -0.11503939]
  [FlaxMamba2] B (step) sample values: [ 0.08397584 -0.03812531  0.07048112 -0.07485575  0.14610538]
  [FlaxMamba2] C (step) sample values: [ 0.0324941  -0.14594382  0.0516047  -0.10780681 -0.03894296]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.29588825 -1.1836219  -0.3113019  -0.1314279  -1.5015444 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05259677 0.00595279 0.01502061 0.06049009 0.00224048]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9845577  0.99297893 0.995335   0.9920814  0.99664146]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.05736077  0.10943449  0.07847302  0.00211843 -0.11503939]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00025335  0.00011502 -0.00021264  0.00022584 -0.0004408 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00025335  0.00011502 -0.00021264  0.00022584 -0.0004408 ]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00145173  0.00040622 -0.00011251  0.00018561 -0.00291735]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00348743  0.00681646  0.00099333 -0.00335075 -0.00477768]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00361867  0.00706685  0.00117288 -0.00334591 -0.00504089]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00361867  0.00706685  0.00117288 -0.00334591 -0.00504089]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-2.8788028e-03 -1.7795172e-03 -2.6107239e-04 -3.3347431e-05
 -1.5594270e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.0208495  -0.007178   -0.00248492 -0.00022387 -0.00142928]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.0208495  -0.007178   -0.00248492 -0.00022387 -0.00142928]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.00540131  0.51420873  0.18175149  0.5313077  -0.37181944]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.00540131  0.51420873  0.18175149  0.5313077  -0.37181944]
  [Layer 7] Output shape after mixer: (1, 1, 2048)
  [Layer 7] Output sample values after mixer: [-0.00540131  0.51420873  0.18175149  0.5313077  -0.37181944]
  [Layer 7] Residual connection shape: (1, 1, 2048)
  [Layer 7] Residual connection sample values: [ 1.1903886   1.8395839   0.68263745 -0.40057302 -0.0183703 ]
[Mamba2LMHeadModel] Processing layer 8/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.5644478   0.68270576  0.30161735 -0.17609031 -0.00866942]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.5644478   0.68270576  0.30161735 -0.17609031 -0.00866942]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.5644478   0.68270576  0.30161735 -0.17609031 -0.00866942]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-2.0483909 -1.6024811  1.5364635 -3.8416584 -1.6664447]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-2.0483909 -1.6024811  1.5364635 -3.8416584 -1.6664447]
  [FlaxMamba2] xBC (step) sample values: [-1.4893849 -0.2617728 -1.274145  -0.0439995  0.5837924]
  [FlaxMamba2] dt (step) sample values: [-1.0454832  -0.04548275  1.1035739   0.31888855 -0.9467666 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.7768992   0.77030414  0.5939753  -1.4893849   1.3696895 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00781847  0.01640311  0.20392865 -0.00910907  0.11294112]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.4707091  -0.01461801 -0.11076862 -0.06068378  0.0568193 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.28974572 -0.00725559 -0.05232002 -0.02942154  0.02921654]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.28974572 -0.00725559 -0.05232002 -0.02942154  0.02921654]
  [FlaxMamba2] B (step) sample values: [-0.04892989 -0.04689221  0.14228423 -0.0569732  -0.15312435]
  [FlaxMamba2] C (step) sample values: [ 0.08884599 -0.08976628 -0.16142753 -0.15427475 -0.18905833]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.6542776 -0.9827404 -0.5549556 -3.9396574 -1.8081155]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00354929 0.05190874 0.03319823 0.03295936 0.00375239]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.98711365 0.9502665  0.9817451  0.8782284  0.9932382 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.28974572 -0.00725559 -0.05232002 -0.02942154  0.02921654]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.0319060e-05 -4.8223526e-05  1.4632381e-04 -5.8590722e-05
 -1.5747169e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.0319060e-05 -4.8223526e-05  1.4632381e-04 -5.8590722e-05
 -1.5747169e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00418277  0.00216422  0.00138998 -0.00323688 -0.00077367]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.08275943 -0.01636147 -0.04248042 -0.02153129 -0.02177414]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.32666737 -0.02246922 -0.08652341 -0.04629835  0.00282035]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.32666737 -0.02246922 -0.08652341 -0.04629835  0.00282035]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.07642616  0.00603595 -0.10940304  0.00373639 -0.00074682]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.04821935  0.00485176 -0.05977778  0.00319881 -0.00076276]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.04821935  0.00485176 -0.05977778  0.00319881 -0.00076276]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.05171937  0.16635324  0.5098461   0.4466794   0.20244724]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.05171937  0.16635324  0.5098461   0.4466794   0.20244724]
  [Layer 8] Output shape after mixer: (1, 1, 2048)
  [Layer 8] Output sample values after mixer: [-0.05171937  0.16635324  0.5098461   0.4466794   0.20244724]
  [Layer 8] Residual connection shape: (1, 1, 2048)
  [Layer 8] Residual connection sample values: [1.1386693  2.005937   1.1924835  0.0461064  0.18407694]
[Mamba2LMHeadModel] Processing layer 9/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.4275781  0.61544526 0.41165912 0.01528479 0.06823414]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.4275781  0.61544526 0.41165912 0.01528479 0.06823414]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.4275781  0.61544526 0.41165912 0.01528479 0.06823414]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-4.2989497  -0.04376063 -2.0166755  -1.4561713  -0.68533146]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-4.2989497  -0.04376063 -2.0166755  -1.4561713  -0.68533146]
  [FlaxMamba2] xBC (step) sample values: [ 0.74400103 -0.6567654  -1.1730114   0.20231883 -0.12882677]
  [FlaxMamba2] dt (step) sample values: [1.7252439 1.2044449 1.7735553 1.5693477 1.3810585]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [1.514101   2.0374093  0.2393057  0.74400103 0.47138992]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.10606276 -0.08578298 -0.25115922  0.21460128 -0.2312631 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.09871184 -0.11112783 -0.33782914  0.1406877  -0.20622343]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04692189 -0.05247974 -0.14065073  0.07528397 -0.09251721]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04692189 -0.05247974 -0.14065073  0.07528397 -0.09251721]
  [FlaxMamba2] B (step) sample values: [-0.22144608 -0.25058126  0.295062    0.5368703  -0.00461837]
  [FlaxMamba2] C (step) sample values: [-0.2244876  -0.16508743 -0.27608946 -0.2733411  -0.22553493]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-5.234511  -1.2161361 -1.4887683 -0.9523448 -3.9666808]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05544033 0.11982863 0.02797615 0.5023675  0.06116316]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.74811167 0.8643929  0.95920545 0.6197575  0.78457373]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04692189 -0.05247974 -0.14065073  0.07528397 -0.09251721]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.7606213e-04  6.5185333e-04 -7.6756399e-04 -1.3965956e-03
  1.2014072e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.7606213e-04  6.5185333e-04 -7.6756399e-04 -1.3965956e-03
  1.2014072e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-5.7846396e-03  3.5056937e-03 -6.2468830e-03 -9.4332453e-03
 -5.3273932e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01420027 -0.00293926 -0.01674455  0.01056262 -0.01326929]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07780533 -0.07407828 -0.20740393  0.11261396 -0.13868119]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07780533 -0.07407828 -0.20740393  0.11261396 -0.13868119]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00448231  0.0015854   0.04913091 -0.031002    0.03184615]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00282798  0.00149049  0.03088081 -0.01536576  0.02298976]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00282798  0.00149049  0.03088081 -0.01536576  0.02298976]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.43940717 -0.17307198  0.0830994   0.03945067 -0.17342593]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.43940717 -0.17307198  0.0830994   0.03945067 -0.17342593]
  [Layer 9] Output shape after mixer: (1, 1, 2048)
  [Layer 9] Output sample values after mixer: [ 0.43940717 -0.17307198  0.0830994   0.03945067 -0.17342593]
  [Layer 9] Residual connection shape: (1, 1, 2048)
  [Layer 9] Residual connection sample values: [1.5780764  1.8328651  1.2755829  0.08555707 0.01065101]
[Mamba2LMHeadModel] Processing layer 10/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [0.46419662 0.45062754 0.33870348 0.02249246 0.00306195]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.46419662 0.45062754 0.33870348 0.02249246 0.00306195]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [0.46419662 0.45062754 0.33870348 0.02249246 0.00306195]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.64321166  0.02389133  0.2780849  -0.9893524  -0.03759465]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.64321166  0.02389133  0.2780849  -0.9893524  -0.03759465]
  [FlaxMamba2] xBC (step) sample values: [0.48656034 0.68346614 0.67347175 0.04100247 0.8821859 ]
  [FlaxMamba2] dt (step) sample values: [ 0.6575152 -0.2018119  0.3099752  1.094931   1.0770488]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.7225964  2.0155783  0.39297265 0.48656034 0.11366162]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.06105339 -0.2809265   0.08105548 -0.00660046  0.13754848]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0226928  -0.36802366 -0.02276532 -0.09241589  0.07797816]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01147513 -0.15052855 -0.0112531  -0.04407429  0.04050846]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01147513 -0.15052855 -0.0112531  -0.04407429  0.04050846]
  [FlaxMamba2] B (step) sample values: [ 0.09124937  0.18543133  0.05291329  0.0088989  -0.08408322]
  [FlaxMamba2] C (step) sample values: [-0.03265212  0.584296   -0.23038873  0.00977116  0.11633645]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.7154508  -1.4067873  -0.35344088 -2.010216   -0.4652703 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00084737 0.00290889 0.12685987 0.00544814 0.02208361]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99685663 0.9959162  0.95615286 0.98910785 0.98977774]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01147513 -0.15052855 -0.0112531  -0.04407429  0.04050846]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.8727626e-07  1.8030680e-06  5.1450985e-07  8.6529695e-08
 -8.1759521e-07]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 8.8727626e-07  1.8030680e-06  5.1450985e-07  8.6529695e-08
 -8.1759521e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.3089397e-05  3.5662772e-05  3.3413857e-05  5.5245837e-05
  6.6369576e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00020653 -0.00429197  0.00040364 -0.00081697  0.00326538]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00272786 -0.0373662  -0.0020689  -0.010501    0.01216593]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00272786 -0.0373662  -0.0020689  -0.010501    0.01216593]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.0011501  -0.0004517  -0.00032741  0.00281589 -0.00022439]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.0109836  -0.00210208 -0.00244847  0.02396643 -0.00176741]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.0109836  -0.00210208 -0.00244847  0.02396643 -0.00176741]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.1543947  -0.31559217  0.27604842 -0.12869246  0.22383687]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.1543947  -0.31559217  0.27604842 -0.12869246  0.22383687]
  [Layer 10] Output shape after mixer: (1, 1, 2048)
  [Layer 10] Output sample values after mixer: [-0.1543947  -0.31559217  0.27604842 -0.12869246  0.22383687]
  [Layer 10] Residual connection shape: (1, 1, 2048)
  [Layer 10] Residual connection sample values: [ 1.4236816   1.517273    1.5516313  -0.0431354   0.23448788]
[Mamba2LMHeadModel] Processing layer 11/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.3919304   0.3398351   0.38155776 -0.01034876  0.0617076 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.3919304   0.3398351   0.38155776 -0.01034876  0.0617076 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.3919304   0.3398351   0.38155776 -0.01034876  0.0617076 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.0826054 -2.1334503 -1.1931291 -0.6530562  1.3748035]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.0826054 -2.1334503 -1.1931291 -0.6530562  1.3748035]
  [FlaxMamba2] xBC (step) sample values: [ 1.1339895  -0.40562987 -2.527443    1.6858798   0.9375946 ]
  [FlaxMamba2] dt (step) sample values: [2.535506  3.9766006 1.1647758 2.0704625 2.0891523]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.5230793   0.8702426   0.0569149   1.1339895   0.56978554]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.31263623 -0.08928963  0.5599219  -0.19671664  0.20426686]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.32684216 -0.44695565  0.65647954 -0.18457064  0.2274297 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.13694987 -0.17435062  0.43227148 -0.08379283  0.12659048]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.13694987 -0.17435062  0.43227148 -0.08379283  0.12659048]
  [FlaxMamba2] B (step) sample values: [-0.26654848  0.01220457 -0.23705366 -0.04746572 -0.01601345]
  [FlaxMamba2] C (step) sample values: [-0.03150813 -0.06854954 -0.2621268  -0.22674236  0.11099349]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.31160602 -0.09015273 -1.5786072  -0.20961139 -0.6694042 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.20219104 0.9948978  0.3423781  0.2973737  0.05872527]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.93893975 0.91421205 0.5824683  0.93957    0.9614517 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.13694987 -0.17435062  0.43227148 -0.08379283  0.12659048]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00738074 -0.00033794  0.00656402  0.00131433  0.00044341]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00738074 -0.00033794  0.00656402  0.00131433  0.00044341]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.05043489 -0.04051494  0.05681857  0.01182479 -0.04368929]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.14086197 -0.24273801  0.2650199  -0.07484537  0.02714521]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.19110581 -0.30670333  0.4236106  -0.10558708  0.07358842]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.19110581 -0.30670333  0.4236106  -0.10558708  0.07358842]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.05234647  0.06928629 -0.11761161  0.02360314  0.08074905]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.05433714  0.07049189 -0.08486697  0.05550643  0.06236515]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.05433714  0.07049189 -0.08486697  0.05550643  0.06236515]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.27516264 -0.16657288  0.4648182  -0.73667216 -0.4834189 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.27516264 -0.16657288  0.4648182  -0.73667216 -0.4834189 ]
  [Layer 11] Output shape after mixer: (1, 1, 2048)
  [Layer 11] Output sample values after mixer: [ 0.27516264 -0.16657288  0.4648182  -0.73667216 -0.4834189 ]
  [Layer 11] Residual connection shape: (1, 1, 2048)
  [Layer 11] Residual connection sample values: [ 1.6988442   1.3507      2.0164495  -0.77980757 -0.24893104]
[Mamba2LMHeadModel] Processing layer 12/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.34017447  0.22442633  0.35270333 -0.13547568 -0.04775401]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.34017447  0.22442633  0.35270333 -0.13547568 -0.04775401]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.34017447  0.22442633  0.35270333 -0.13547568 -0.04775401]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.1664429  -1.3688966  -2.5093265   0.3612146  -0.20388043]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.1664429  -1.3688966  -2.5093265   0.3612146  -0.20388043]
  [FlaxMamba2] xBC (step) sample values: [-0.30458507  1.7689916   3.5047493  -2.8266444  -0.01032448]
  [FlaxMamba2] dt (step) sample values: [1.5124822 1.9355086 1.4244593 1.0513393 1.8245797]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6395428   0.39472455 -0.86049336 -0.30458507  0.37574255]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.05715937 -0.44292367  0.12433411 -0.2955881  -0.00263597]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.10015864 -0.43003     0.08945252 -0.32529697  0.00998304]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04757348 -0.16948307  0.04672537 -0.13642478  0.00501644]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04757348 -0.16948307  0.04672537 -0.13642478  0.00501644]
  [FlaxMamba2] B (step) sample values: [ 0.03326565 -0.08818284 -0.07030886 -0.05498015 -0.1121283 ]
  [FlaxMamba2] C (step) sample values: [-0.25639677 -0.24263367 -0.08637426 -0.2544859  -0.14502713]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2411823 -0.7693517 -1.9974962 -1.2367963 -1.0181218]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.17922826 0.39443776 0.10759003 0.24560004 0.4061663 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.80055106 0.73825836 0.80661345 0.73804003 0.66131383]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04757348 -0.16948307  0.04672537 -0.13642478  0.00501644]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00028364  0.00075189  0.00059949  0.00046879  0.00095606]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00028364  0.00075189  0.00059949  0.00046879  0.00095606]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00160713  0.00709699 -0.01710274  0.00515289 -0.00087117]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00240513 -0.00605026  0.00227378 -0.00339204 -0.00040422]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.0366492  -0.12804662  0.03590738 -0.10159256  0.00320669]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.0366492  -0.12804662  0.03590738 -0.10159256  0.00320669]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.03259633  0.03554699 -0.0067764  -0.02162664 -0.00029368]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.11693063  0.08399214 -0.01210133 -0.04417445 -0.00086253]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.11693063  0.08399214 -0.01210133 -0.04417445 -0.00086253]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.18805675 -0.2233128  -0.3085371   0.31507358  0.6216904 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.18805675 -0.2233128  -0.3085371   0.31507358  0.6216904 ]
  [Layer 12] Output shape after mixer: (1, 1, 2048)
  [Layer 12] Output sample values after mixer: [-0.18805675 -0.2233128  -0.3085371   0.31507358  0.6216904 ]
  [Layer 12] Residual connection shape: (1, 1, 2048)
  [Layer 12] Residual connection sample values: [ 1.5107875   1.1273873   1.7079123  -0.464734    0.37275934]
[Mamba2LMHeadModel] Processing layer 13/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.2684672   0.17337546  0.2800518  -0.07171839  0.06723879]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.2684672   0.17337546  0.2800518  -0.07171839  0.06723879]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.2684672   0.17337546  0.2800518  -0.07171839  0.06723879]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-3.599688    0.58704895 -0.1104285   0.6900235   0.43975264]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-3.599688    0.58704895 -0.1104285   0.6900235   0.43975264]
  [FlaxMamba2] xBC (step) sample values: [ 0.15744863  0.51225334 -1.3102652  -0.6685747  -1.6151448 ]
  [FlaxMamba2] dt (step) sample values: [1.5698277  1.2215087  1.5289066  0.84720975 1.8777179 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.64950573 -0.5728934   0.23475601  0.15744863 -0.21879862]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01109758 -0.04895309  0.01271088 -0.13782549 -0.2583628 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.25355086 -0.1588774  -0.00776642 -0.13863039 -0.2823191 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.11078898 -0.07314143 -0.00386813 -0.06451828 -0.12136483]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.11078898 -0.07314143 -0.00386813 -0.06451828 -0.12136483]
  [FlaxMamba2] B (step) sample values: [ 0.02927983  0.17311057 -0.09208668  0.5205012   0.06273603]
  [FlaxMamba2] C (step) sample values: [ 0.08915894 -0.2643254  -0.12381383  0.39261967  0.2439582 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3103099 -1.7870504 -0.8605819 -1.881061  -0.5251649]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04534056 0.03271591 0.16574606 0.10570291 0.10981669]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.94232017 0.94321126 0.8670678  0.8196863  0.94395965]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.11078898 -0.07314143 -0.00386813 -0.06451828 -0.12136483]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00014708 -0.00086957  0.00046257 -0.0026146  -0.00031514]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00014708 -0.00086957  0.00046257 -0.0026146  -0.00031514]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.0015062  -0.00475004  0.00248783 -0.04420587 -0.00230693]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.06790007 -0.0018268   0.00566891 -0.01351919  0.01880126]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07266957 -0.00497556  0.00550239 -0.01629673  0.01357646]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07266957 -0.00497556  0.00550239 -0.01629673  0.01357646]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00695956 -0.00187723 -0.00028705 -0.00748894  0.00363113]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.03069906 -0.00273139 -0.00171257 -0.05085839  0.00940862]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03069906 -0.00273139 -0.00171257 -0.05085839  0.00940862]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.01637634  0.21290873  0.28951418  0.08630756 -0.37497252]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.01637634  0.21290873  0.28951418  0.08630756 -0.37497252]
  [Layer 13] Output shape after mixer: (1, 1, 2048)
  [Layer 13] Output sample values after mixer: [ 0.01637634  0.21290873  0.28951418  0.08630756 -0.37497252]
  [Layer 13] Residual connection shape: (1, 1, 2048)
  [Layer 13] Residual connection sample values: [ 1.5271639   1.340296    1.9974265  -0.37842643 -0.00221318]
[Mamba2LMHeadModel] Processing layer 14/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.21015908  0.16200067  0.2544985  -0.04533955 -0.00029732]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.21015908  0.16200067  0.2544985  -0.04533955 -0.00029732]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.21015908  0.16200067  0.2544985  -0.04533955 -0.00029732]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.2714794  -0.8880305  -0.43540072 -1.4011304  -0.08119207]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.2714794  -0.8880305  -0.43540072 -1.4011304  -0.08119207]
  [FlaxMamba2] xBC (step) sample values: [-3.09959     0.94947356 -1.7110456  -0.5546023  -1.2241718 ]
  [FlaxMamba2] dt (step) sample values: [0.36766118 0.50365275 1.1464775  1.3008244  1.1958693 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.276522   -1.3515543  -1.2849444  -3.09959    -0.10059457]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.76824164 -0.3053502   0.25486434 -0.178157    0.1906764 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.8077924  -0.34660998  0.19401228 -0.24096218  0.22723646]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.24909177 -0.14356749  0.10638693 -0.10603523  0.12647206]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.24909177 -0.14356749  0.10638693 -0.10603523  0.12647206]
  [FlaxMamba2] B (step) sample values: [-0.05443754 -0.0468229   0.01373878  0.01318354  0.07720596]
  [FlaxMamba2] C (step) sample values: [-0.2163514  -0.00970475 -0.0249707   0.00640349 -0.05679396]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.318424  -0.7620611 -2.6670074 -5.1836414 -2.8487349]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05660201 0.01983429 0.23628001 0.05943971 0.04521376]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7831496  0.9849987  0.5325063  0.73483145 0.879148  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.24909177 -0.14356749  0.10638693 -0.10603523  0.12647206]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00076752  0.00066016 -0.0001937  -0.00018588 -0.00108853]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00076752  0.00066016 -0.0001937  -0.00018588 -0.00108853]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00301957  0.00118914 -0.00212429  0.00222433 -0.00050174]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.01395898 -0.00861858  0.00565717 -0.00631464  0.00706901]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.11464772 -0.06665193  0.04866127 -0.04917657  0.05819198]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.11464772 -0.06665193  0.04866127 -0.04917657  0.05819198]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01346271  0.01725455 -0.00832311  0.01361773 -0.00226651]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.09957933  0.07427716 -0.05199232  0.11958946 -0.02307395]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.09957933  0.07427716 -0.05199232  0.11958946 -0.02307395]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.33236018  0.00712446  0.42447683 -0.28297475  1.2427815 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.33236018  0.00712446  0.42447683 -0.28297475  1.2427815 ]
  [Layer 14] Output shape after mixer: (1, 1, 2048)
  [Layer 14] Output sample values after mixer: [-0.33236018  0.00712446  0.42447683 -0.28297475  1.2427815 ]
  [Layer 14] Residual connection shape: (1, 1, 2048)
  [Layer 14] Residual connection sample values: [ 1.1948037   1.3474205   2.4219034  -0.66140115  1.2405684 ]
[Mamba2LMHeadModel] Processing layer 15/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.13512953  0.12955816  0.25176966 -0.06437744  0.13443899]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13512953  0.12955816  0.25176966 -0.06437744  0.13443899]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.13512953  0.12955816  0.25176966 -0.06437744  0.13443899]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.16882502  1.3513474  -0.55799806  0.30724692 -0.26687375]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.16882502  1.3513474  -0.55799806  0.30724692 -0.26687375]
  [FlaxMamba2] xBC (step) sample values: [ 0.52967876 -0.44822162  0.61840105  0.55363446  0.619765  ]
  [FlaxMamba2] dt (step) sample values: [0.259384   0.5534323  1.0237466  0.38349393 0.42725733]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.05313125 -0.19407633 -0.04488943  0.52967876 -0.7317989 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02598034  0.09997323 -0.12806734 -0.11814    -0.03640975]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.06342541  0.09311822 -0.15284762 -0.13588597 -0.0617546 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03070735  0.0487253  -0.07059456 -0.06333382 -0.0299242 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03070735  0.0487253  -0.07059456 -0.06333382 -0.0299242 ]
  [FlaxMamba2] B (step) sample values: [-0.03367187 -0.00137766  0.0140944   0.01106217 -0.01789412]
  [FlaxMamba2] C (step) sample values: [ 0.13814591  0.07834511 -0.02211903  0.16698    -0.04025433]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.27823287 -0.68077636 -2.7209377  -0.11263601 -3.8483953 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00250877 0.02740526 0.04155666 0.00838878 0.03528341]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9993022  0.9815161  0.8930854  0.99905556 0.8730308 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03070735  0.0487253  -0.07059456 -0.06333382 -0.0299242 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.59399894e-06  1.06131594e-07 -1.08579832e-06 -8.52202731e-07
  1.37851907e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.59399894e-06  1.06131594e-07 -1.08579832e-06 -8.52202731e-07
  1.37851907e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-4.9380407e-05  1.3532779e-05 -2.2115588e-05 -1.3896715e-05
 -8.2661845e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 4.18215277e-05 -1.38802652e-05  4.15468185e-06  1.23034015e-05
  3.51897688e-05]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00519162  0.00829036 -0.01202726 -0.01078167 -0.00506478]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00519162  0.00829036 -0.01202726 -0.01078167 -0.00506478]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00047514  0.00889923  0.00244294 -0.00190878  0.00058618]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.01059662  0.25932178  0.05489362 -0.04987871  0.01124151]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.01059662  0.25932178  0.05489362 -0.04987871  0.01124151]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.7868198   0.8028993   0.77236694 -0.7273318   0.02642746]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.7868198   0.8028993   0.77236694 -0.7273318   0.02642746]
  [Layer 15] Output shape after mixer: (1, 1, 2048)
  [Layer 15] Output sample values after mixer: [ 1.7868198   0.8028993   0.77236694 -0.7273318   0.02642746]
  [Layer 15] Residual connection shape: (1, 1, 2048)
  [Layer 15] Residual connection sample values: [ 2.9816236  2.1503198  3.1942704 -1.3887329  1.2669959]
[Mamba2LMHeadModel] Processing layer 16/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.30567145  0.18430403  0.30001158 -0.11947383  0.12476962]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.30567145  0.18430403  0.30001158 -0.11947383  0.12476962]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.30567145  0.18430403  0.30001158 -0.11947383  0.12476962]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.7388468  -0.68737763  0.84424895 -0.77333206 -0.69356847]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.7388468  -0.68737763  0.84424895 -0.77333206 -0.69356847]
  [FlaxMamba2] xBC (step) sample values: [ 1.0122138   0.3079844  -1.0101141  -0.30976778 -0.70987606]
  [FlaxMamba2] dt (step) sample values: [1.3200928  0.71241885 1.2487599  0.89715457 1.4178364 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.647479   0.7790512  0.272198   1.0122138  0.09625299]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.25059912  0.04713677 -0.21622762  0.08335237 -0.23779616]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.2144663   0.00599908 -0.22935781 -0.00905485 -0.2798799 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.11868823  0.00300854 -0.101585   -0.00450693 -0.1204836 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.11868823  0.00300854 -0.101585   -0.00450693 -0.1204836 ]
  [FlaxMamba2] B (step) sample values: [ 0.04621317  0.26350814  0.09162098  0.15161628 -0.0272528 ]
  [FlaxMamba2] C (step) sample values: [-0.06553209 -0.04070849 -0.1585012   0.8881161  -0.12062412]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6905513  -0.13480766 -1.3128716  -3.7739606  -1.2635014 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.19889344 0.13379149 0.1606193  0.17136335 0.09300338]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.5855914  0.9821256  0.8098773  0.52376163 0.8891317 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.11868823  0.00300854 -0.101585   -0.00450693 -0.1204836 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00109092  0.00622046  0.00216283  0.0035791  -0.00064334]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00109092  0.00622046  0.00216283  0.0035791  -0.00064334]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00281508  0.00542829  0.00283424  0.00323976  0.00141506]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.04152541 -0.00875473 -0.02113563  0.01069005 -0.0357842 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.11791068 -0.0068185  -0.08651362  0.00778949 -0.11332494]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.11791068 -0.0068185  -0.08651362  0.00778949 -0.11332494]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.02816143  0.00156831 -0.05108052 -0.00190209  0.02619218]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.14285602  0.00624483 -0.24376088 -0.00808712  0.11439038]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.14285602  0.00624483 -0.24376088 -0.00808712  0.11439038]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.23173901 -0.38557845 -0.40360427  0.4602266  -0.13797925]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.23173901 -0.38557845 -0.40360427  0.4602266  -0.13797925]
  [Layer 16] Output shape after mixer: (1, 1, 2048)
  [Layer 16] Output sample values after mixer: [ 0.23173901 -0.38557845 -0.40360427  0.4602266  -0.13797925]
  [Layer 16] Residual connection shape: (1, 1, 2048)
  [Layer 16] Residual connection sample values: [ 3.2133627  1.7647414  2.790666  -0.9285063  1.1290166]
[Mamba2LMHeadModel] Processing layer 17/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.28932062  0.133513    0.22382022 -0.06887472  0.09780245]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.28932062  0.133513    0.22382022 -0.06887472  0.09780245]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.28932062  0.133513    0.22382022 -0.06887472  0.09780245]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.11232135 -0.3419168  -0.10284931 -0.37785926 -0.3187233 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.11232135 -0.3419168  -0.10284931 -0.37785926 -0.3187233 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.09237908 -0.03532908 -0.32033205  0.32217768 -0.7980424 ]
  [FlaxMamba2] dt (step) sample values: [ 0.23249796 -0.10573452  0.21001881  1.7157727   0.44942087]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.46844298 -0.35404056 -1.1873327   0.09237908 -0.7466442 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.02810423  0.02600929  0.06141514 -0.08900219  0.13889088]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.05990355 -0.00019005  0.04705662 -0.0944038   0.15152515]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-2.9054932e-02 -9.5015675e-05  2.4081785e-02 -4.4975538e-02
  8.1491597e-02]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-2.9054932e-02 -9.5015675e-05  2.4081785e-02 -4.4975538e-02
  8.1491597e-02]
  [FlaxMamba2] B (step) sample values: [-0.18845497  0.02329716 -0.17357749 -0.13684489  0.04520342]
  [FlaxMamba2] C (step) sample values: [-0.02518412 -0.06682429  0.0383407  -0.0439357  -0.05800257]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -1.1570504  -11.466768   -14.214988    -0.12863436 -14.242779  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00064772 0.00923666 0.02658202 0.11609097 0.01104997]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9992508  0.89950144 0.6853244  0.98517764 0.85437745]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-2.9054932e-02 -9.5015675e-05  2.4081785e-02 -4.4975538e-02
  8.1491597e-02]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.5466476e-06 -4.3844324e-07  3.2666594e-06  2.5753664e-06
 -8.5071048e-07]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.5466476e-06 -4.3844324e-07  3.2666594e-06  2.5753664e-06
 -8.5071048e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-5.1097490e-05  7.5592732e-05  1.0325833e-04 -2.6102512e-04
 -2.9563892e-06]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 2.5168245e-04 -7.2049035e-05  2.8078200e-04  1.0151570e-04
 -1.7993791e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01848744 -0.00013333  0.01581245 -0.02890569  0.05237848]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01848744 -0.00013333  0.01581245 -0.02890569  0.05237848]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 9.8001864e-04  1.8934585e-05 -7.7137077e-04  4.4414727e-03
 -7.0280582e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01029841  0.00024302 -0.00751449  0.05269024 -0.08370066]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01029841  0.00024302 -0.00751449  0.05269024 -0.08370066]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.58114004  0.5476277  -0.06627166  0.32239756  1.4714859 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.58114004  0.5476277  -0.06627166  0.32239756  1.4714859 ]
  [Layer 17] Output shape after mixer: (1, 1, 2048)
  [Layer 17] Output sample values after mixer: [ 0.58114004  0.5476277  -0.06627166  0.32239756  1.4714859 ]
  [Layer 17] Residual connection shape: (1, 1, 2048)
  [Layer 17] Residual connection sample values: [ 3.7945027  2.312369   2.7243946 -0.6061088  2.6005025]
[Mamba2LMHeadModel] Processing layer 18/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.2741748   0.14127743  0.17602961 -0.0367531   0.18061323]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.2741748   0.14127743  0.17602961 -0.0367531   0.18061323]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.2741748   0.14127743  0.17602961 -0.0367531   0.18061323]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.08272516  0.9873495  -0.02244263 -0.47814205  0.5206959 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.08272516  0.9873495  -0.02244263 -0.47814205  0.5206959 ]
  [FlaxMamba2] xBC (step) sample values: [-0.97145236 -0.84481263 -0.15177055  0.547438    1.7617224 ]
  [FlaxMamba2] dt (step) sample values: [0.862232  1.0599841 0.5443739 1.5022435 1.5708323]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.02576631 -0.91999096 -0.40584886 -0.97145236  0.69796956]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.21100098  0.4981175   0.06260502  0.0326333   0.4080158 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.22101074  0.23273665  0.34239018  0.01880121  0.36593205]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.09834339  0.12984912  0.20021985  0.00948897  0.21607397]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.09834339  0.12984912  0.20021985  0.00948897  0.21607397]
  [FlaxMamba2] B (step) sample values: [ 0.07809542 -0.01566067  0.09976792  0.09889977  0.17955942]
  [FlaxMamba2] C (step) sample values: [-0.27771577 -0.0635366  -0.13684909  0.03932747 -0.10359778]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3010656 -1.4685526 -1.2082934 -1.2128745 -2.5874777]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.21328358 0.15004282 0.12341683 0.29690775 0.19106752]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7576786  0.8022413  0.8614625  0.6975983  0.60994714]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.09834339  0.12984912  0.20021985  0.00948897  0.21607397]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00163805  0.00032848 -0.00209264 -0.00207443 -0.00376626]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00163805  0.00032848 -0.00209264 -0.00207443 -0.00376626]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00224272  0.00372347  0.00282777 -0.00570248 -0.00386458]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02809385 -0.02804044  0.08831554 -0.02916451  0.02685205]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04709757 -0.0029486   0.1270057  -0.02733088  0.06860583]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04709757 -0.0029486   0.1270057  -0.02733088  0.06860583]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00186755 -0.00212107 -0.00140918  0.00500102  0.02240927]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.01836478 -0.00856607 -0.0103516   0.04726702  0.3333472 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.01836478 -0.00856607 -0.0103516   0.04726702  0.3333472 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.28104594 -0.6171204   0.02250325  0.019426   -0.48775518]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.28104594 -0.6171204   0.02250325  0.019426   -0.48775518]
  [Layer 18] Output shape after mixer: (1, 1, 2048)
  [Layer 18] Output sample values after mixer: [-0.28104594 -0.6171204   0.02250325  0.019426   -0.48775518]
  [Layer 18] Residual connection shape: (1, 1, 2048)
  [Layer 18] Residual connection sample values: [ 3.5134568  1.6952487  2.7468977 -0.5866828  2.1127472]
[Mamba2LMHeadModel] Processing layer 19/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.23483928  0.09781837  0.17137986 -0.03371212  0.14091267]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.23483928  0.09781837  0.17137986 -0.03371212  0.14091267]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.23483928  0.09781837  0.17137986 -0.03371212  0.14091267]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.5063496  -0.02292746  0.5588291  -1.1425536   0.15498845]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.5063496  -0.02292746  0.5588291  -1.1425536   0.15498845]
  [FlaxMamba2] xBC (step) sample values: [ 0.5975693   0.11717212 -0.05021509  0.28321996  0.3605038 ]
  [FlaxMamba2] dt (step) sample values: [0.64193374 1.0867985  1.198341   0.8685117  1.1506207 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.02575407 -1.3337432   0.12690578  0.5975693  -0.47584552]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.05009653  0.03084253 -0.01706526  0.0437199  -0.08486   ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.014452    0.00650476 -0.02206632  0.00111736 -0.11781899]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00727821  0.00326296 -0.01091144  0.00055899 -0.05544318]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00727821  0.00326296 -0.01091144  0.00055899 -0.05544318]
  [FlaxMamba2] B (step) sample values: [-0.06779621 -0.26495072 -0.18132283  0.0023418  -0.04249986]
  [FlaxMamba2] C (step) sample values: [-0.2333518  -0.00886736 -0.10520323 -0.2438384  -0.22893597]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9436172 -1.8178532 -2.0862153 -1.0006425 -0.9649832]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10107986 0.08305762 0.07464059 0.11807679 0.21203205]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.82163376 0.8598592  0.85580194 0.8885604  0.8149672 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00727821  0.00326296 -0.01091144  0.00055899 -0.05544318]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.9876369e-05 -1.9491916e-04 -1.3339572e-04  1.7228203e-06
 -3.1266329e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-4.9876369e-05 -1.9491916e-04 -1.3339572e-04  1.7228203e-06
 -3.1266329e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00128507 -0.00929257 -0.00033011 -0.00220564 -0.00078168]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00588721 -0.00379072 -0.00105673  0.00050851 -0.00025566]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00506851 -0.00342368 -0.00228411  0.00057139 -0.00649221]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00506851 -0.00342368 -0.00228411  0.00057139 -0.00649221]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 9.6510828e-04  3.8798244e-05 -8.1204070e-04 -1.5789116e-04
 -5.4201938e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.03668252  0.00154972 -0.04160989 -0.00591883 -0.02890528]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03668252  0.00154972 -0.04160989 -0.00591883 -0.02890528]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.17100562 -0.05909688 -0.27645797  0.06091475  0.41769156]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.17100562 -0.05909688 -0.27645797  0.06091475  0.41769156]
  [Layer 19] Output shape after mixer: (1, 1, 2048)
  [Layer 19] Output sample values after mixer: [ 0.17100562 -0.05909688 -0.27645797  0.06091475  0.41769156]
  [Layer 19] Residual connection shape: (1, 1, 2048)
  [Layer 19] Residual connection sample values: [ 3.6844625   1.6361518   2.4704397  -0.52576804  2.5304387 ]
[Mamba2LMHeadModel] Processing layer 20/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.25769344  0.0980961   0.15859452 -0.03122064  0.17161392]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.25769344  0.0980961   0.15859452 -0.03122064  0.17161392]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.25769344  0.0980961   0.15859452 -0.03122064  0.17161392]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 1.3625399  -0.1630951   0.23427545  0.12834036 -0.09099864]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 1.3625399  -0.1630951   0.23427545  0.12834036 -0.09099864]
  [FlaxMamba2] xBC (step) sample values: [ 0.4870015   0.58799255 -0.81579137 -0.16690779 -0.4216572 ]
  [FlaxMamba2] dt (step) sample values: [1.3799813 1.3109342 1.7322098 1.4136105 1.35029  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.03750836 0.6735129  0.52316165 0.4870015  0.4224101 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.12523463  0.0941226  -0.00881949 -0.10947467  0.04588101]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.1637173   0.10265226  0.05770884 -0.1282735   0.01843045]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07517274  0.05395819  0.02968677 -0.06002886  0.00930014]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07517274  0.05395819  0.02968677 -0.06002886  0.00930014]
  [FlaxMamba2] B (step) sample values: [0.13444354 0.28834864 0.05231624 0.24379525 0.30302003]
  [FlaxMamba2] C (step) sample values: [ 0.06195866 -0.17652105  0.1727753  -0.09095375  0.6556032 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.6215758 -5.0388985 -1.2056414 -1.6434968 -1.3345234]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11148585 0.04148041 0.04848476 0.17711739 0.1118569 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.83461666 0.8113826  0.94322044 0.747447   0.86133164]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07517274  0.05395819  0.02968677 -0.06002886  0.00930014]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00112673 -0.00241656 -0.00043845 -0.00204317 -0.00253952]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00112673 -0.00241656 -0.00043845 -0.00204317 -0.00253952]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00026902 -0.00702086  0.00077765 -0.00172447 -0.00200483]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0078026   0.02036044 -0.00147352 -0.03377177  0.02065354]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00840149  0.02079032 -0.00123701 -0.03425001  0.02072764]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00840149  0.02079032 -0.00123701 -0.03425001  0.02072764]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00911408 -0.00155745 -0.0001618  -0.00233867 -0.00090021]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.15890805 -0.02908735 -0.00405659 -0.04436573 -0.01525803]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.15890805 -0.02908735 -0.00405659 -0.04436573 -0.01525803]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.5378847   1.0921433   0.39624178 -0.46410912  0.481517  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.5378847   1.0921433   0.39624178 -0.46410912  0.481517  ]
  [Layer 20] Output shape after mixer: (1, 1, 2048)
  [Layer 20] Output sample values after mixer: [ 1.5378847   1.0921433   0.39624178 -0.46410912  0.481517  ]
  [Layer 20] Residual connection shape: (1, 1, 2048)
  [Layer 20] Residual connection sample values: [ 5.2223473   2.728295    2.8666816  -0.98987716  3.0119557 ]
[Mamba2LMHeadModel] Processing layer 21/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.2666417   0.12642622  0.12601414 -0.04195616  0.14379628]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.2666417   0.12642622  0.12601414 -0.04195616  0.14379628]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.2666417   0.12642622  0.12601414 -0.04195616  0.14379628]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.32506266  0.04110169  0.20094891  0.05731266 -0.5079476 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.32506266  0.04110169  0.20094891  0.05731266 -0.5079476 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.74325556  0.36148807 -0.9582787   0.103035   -0.32607466]
  [FlaxMamba2] dt (step) sample values: [0.767657   3.3534539  0.82524014 1.0129609  1.6152406 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.00513765  1.1839298  -0.18652946  0.74325556  0.50105286]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.11520886  0.07903195  0.13021278 -0.02618068  0.0590219 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.14648938  0.04894162  0.14506721 -0.03126185  0.08691497]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.06788948  0.02506951  0.07778552 -0.01538662  0.04534485]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.06788948  0.02506951  0.07778552 -0.01538662  0.04534485]
  [FlaxMamba2] B (step) sample values: [-0.00881876 -0.00242095  0.03755706 -0.03594084 -0.08699187]
  [FlaxMamba2] C (step) sample values: [-0.0949454  -0.06451716 -0.0537728  -0.06108846 -0.09384231]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-3.2091806  -0.04342505 -3.8147197  -6.662431   -0.02279418]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.12168697 0.1147058  0.06741173 0.0651711  0.0388519 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.676708  0.9950313 0.7732469 0.647784  0.9991148]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.06788948  0.02506951  0.07778552 -0.01538662  0.04534485]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 7.2854120e-05  2.0000081e-05 -3.1026881e-04  2.9691678e-04
  7.1866292e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 7.2854120e-05  2.0000081e-05 -3.1026881e-04  2.9691678e-04
  7.1866292e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 5.1127441e-05  1.3792305e-05 -4.2644041e-04 -2.2846769e-05
  3.3020676e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00046375 -0.00056163 -0.00067645 -0.00011888 -0.00037733]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.01145301  0.00383887  0.01297738 -0.00281972  0.00758213]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.01145301  0.00383887  0.01297738 -0.00281972  0.00758213]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 1.5615611e-03  8.0513069e-05  1.4344638e-03 -8.3117629e-05
 -1.4468454e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.142298    0.00673718  0.15954027 -0.00779604 -0.12198409]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.142298    0.00673718  0.15954027 -0.00779604 -0.12198409]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.0968731  -0.28200096  0.6381178   0.08030768  0.6048633 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.0968731  -0.28200096  0.6381178   0.08030768  0.6048633 ]
  [Layer 21] Output shape after mixer: (1, 1, 2048)
  [Layer 21] Output sample values after mixer: [ 0.0968731  -0.28200096  0.6381178   0.08030768  0.6048633 ]
  [Layer 21] Residual connection shape: (1, 1, 2048)
  [Layer 21] Residual connection sample values: [ 5.3192205  2.446294   3.5047994 -0.9095695  3.616819 ]
[Mamba2LMHeadModel] Processing layer 22/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.39880127  0.154474    0.23452939 -0.05610007  0.25422713]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.39880127  0.154474    0.23452939 -0.05610007  0.25422713]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.39880127  0.154474    0.23452939 -0.05610007  0.25422713]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.3647368  0.2090928  0.0106659  0.2680826 -0.8451507]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.3647368  0.2090928  0.0106659  0.2680826 -0.8451507]
  [FlaxMamba2] xBC (step) sample values: [ 0.34528682 -0.8194618   0.36892962  0.17128003 -0.9776802 ]
  [FlaxMamba2] dt (step) sample values: [0.8959327  0.6001449  0.93786865 1.1368147  1.4880171 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6779828  -0.172494    0.2033798   0.34528682  0.03898305]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.08809382 -0.17024249  0.0539047  -0.02264983 -0.3770977 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04042536 -0.24897784  0.37324065 -0.06363493 -0.44277152]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02062118 -0.10907099  0.22104873 -0.03080546 -0.17315942]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02062118 -0.10907099  0.22104873 -0.03080546 -0.17315942]
  [FlaxMamba2] B (step) sample values: [ 0.01527206 -0.03674252 -0.07920713 -0.20389192 -0.06838209]
  [FlaxMamba2] C (step) sample values: [-0.01771513 -0.0288255   0.00083791 -0.01992816 -0.05774676]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-4.1489344 -3.5005836 -2.8320918 -5.5395546 -1.7185895]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.00325752 0.07266086 0.15209031 0.13682938 0.01260376]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9865757  0.77541614 0.650032   0.468615   0.97857225]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02062118 -0.10907099  0.22104873 -0.03080546 -0.17315942]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0258824e-06 -2.4681351e-06 -5.3206450e-06 -1.3696198e-05
 -4.5934862e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.0258824e-06 -2.4681351e-06 -5.3206450e-06 -1.3696198e-05
 -4.5934862e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00018492  0.00028547  0.00012209  0.00036924  0.00028399]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-2.5353241e-03  1.4577288e-05  4.3048109e-03  5.7218288e-04
 -2.4811835e-03]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00245906 -0.0264021   0.05784216 -0.00688881 -0.04441988]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00245906 -0.0264021   0.05784216 -0.00688881 -0.04441988]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00052934 -0.00304777  0.00031011 -0.00104642  0.01127938]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00358543 -0.05811679  0.00337252 -0.02799767  0.19816698]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00358543 -0.05811679  0.00337252 -0.02799767  0.19816698]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.4061264  -0.05070315  0.04318068 -0.78839105 -1.0047596 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.4061264  -0.05070315  0.04318068 -0.78839105 -1.0047596 ]
  [Layer 22] Output shape after mixer: (1, 1, 2048)
  [Layer 22] Output sample values after mixer: [ 1.4061264  -0.05070315  0.04318068 -0.78839105 -1.0047596 ]
  [Layer 22] Residual connection shape: (1, 1, 2048)
  [Layer 22] Residual connection sample values: [ 6.725347   2.395591   3.54798   -1.6979606  2.6120594]
[Mamba2LMHeadModel] Processing layer 23/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.32204854  0.09869798  0.15553665 -0.07032391  0.12121011]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.32204854  0.09869798  0.15553665 -0.07032391  0.12121011]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.32204854  0.09869798  0.15553665 -0.07032391  0.12121011]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.09378246 -0.02482441 -0.49573117 -0.33821014 -0.12685408]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.09378246 -0.02482441 -0.49573117 -0.33821014 -0.12685408]
  [FlaxMamba2] xBC (step) sample values: [-0.32969666 -0.61323893  0.0021698  -0.51173115 -1.2142476 ]
  [FlaxMamba2] dt (step) sample values: [1.1205165  0.68453515 1.8633525  0.87010014 0.24578543]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5952018   1.0781335  -0.15697731 -0.32969666 -0.47868153]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.12877834  0.5122943  -0.01087762 -0.09481519  0.49041682]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.15114772  0.47918272 -0.02223016 -0.09697621  0.44103938]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.0698733   0.29592162 -0.01099154 -0.04613885  0.2683754 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0698733   0.29592162 -0.01099154 -0.04613885  0.2683754 ]
  [FlaxMamba2] B (step) sample values: [ 0.00398668  0.05868715  0.25077432 -0.01031593 -0.13853623]
  [FlaxMamba2] C (step) sample values: [-0.10616603  0.04990623  0.33659762  0.03437267 -0.03237912]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.08112868 -3.7998476  -0.08256738 -0.48783726 -1.4532163 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03589448 0.08368897 0.06509727 0.00347248 0.00132549]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9970922 0.7275989 0.9946395 0.9983074 0.9980756]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0698733   0.29592162 -0.01099154 -0.04613885  0.2683754 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.9988656e-06 -1.4719124e-04 -6.2895846e-04  2.5873022e-05
  3.4745797e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.9988656e-06 -1.4719124e-04 -6.2895846e-04  2.5873022e-05
  3.4745797e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 7.5865019e-04  5.1649485e-04 -2.0808643e-03  3.3451986e-04
 -4.9090770e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00180424  0.00392845  0.00052327 -0.00160193  0.00298363]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00031362 -0.0023845   0.00075775 -0.00061765 -0.00274167]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00031362 -0.0023845   0.00075775 -0.00061765 -0.00274167]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 1.40170505e-05  2.92295299e-05 -1.42196674e-04  8.69511277e-05
  1.62881101e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00295623  0.00078206 -0.00668189  0.0065551   0.03597919]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00295623  0.00078206 -0.00668189  0.0065551   0.03597919]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.2806141  -0.0287948   0.75616056 -0.5494322  -0.7495306 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.2806141  -0.0287948   0.75616056 -0.5494322  -0.7495306 ]
  [Layer 23] Output shape after mixer: (1, 1, 2048)
  [Layer 23] Output sample values after mixer: [-1.2806141  -0.0287948   0.75616056 -0.5494322  -0.7495306 ]
  [Layer 23] Residual connection shape: (1, 1, 2048)
  [Layer 23] Residual connection sample values: [ 5.4447327  2.3667963  4.3041406 -2.247393   1.8625288]
[Mamba2LMHeadModel] Processing layer 24/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.19578505  0.08120275  0.14270164 -0.07187921  0.06494631]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.19578505  0.08120275  0.14270164 -0.07187921  0.06494631]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.19578505  0.08120275  0.14270164 -0.07187921  0.06494631]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.4180158  -0.2025787   0.63625675  0.05638359 -0.11059003]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.4180158  -0.2025787   0.63625675  0.05638359 -0.11059003]
  [FlaxMamba2] xBC (step) sample values: [-0.05739507  0.31810018 -1.2551407  -0.19987668 -1.2039355 ]
  [FlaxMamba2] dt (step) sample values: [2.105252   0.03478663 0.33497554 1.8210869  0.7117185 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.12918073 -0.42032832 -0.01069574 -0.05739507  0.3147636 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.00652789  0.12301138 -0.1758412  -0.04211872 -0.5600342 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.0031824   0.12300226 -0.17980085 -0.04373616 -0.56476825]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00159373  0.06527876 -0.08184004 -0.02138994 -0.20469737]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00159373  0.06527876 -0.08184004 -0.02138994 -0.20469737]
  [FlaxMamba2] B (step) sample values: [ 0.01585431  0.02640816 -0.00570114  0.04750301 -0.06418918]
  [FlaxMamba2] C (step) sample values: [-0.08812443 -0.26851273 -0.2728583  -0.27069926  0.03769807]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.07415762 -3.4496791  -3.2884939  -0.16087165 -2.6944954 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0443248  0.03008493 0.06333242 0.02799427 0.04352833]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.99671835 0.9014206  0.8119892  0.99550664 0.88933   ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00159373  0.06527876 -0.08184004 -0.02138994 -0.20469737]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.1199770e-06  1.8655201e-06 -4.0273852e-07  3.3556980e-06
 -4.5344391e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.1199770e-06  1.8655201e-06 -4.0273852e-07  3.3556980e-06
 -4.5344391e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.3839215e-04  5.7644589e-04 -2.7603926e-05 -1.0729035e-04
  3.5513807e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00049038 -0.00164616  0.00043407 -0.00097574 -0.01147545]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00048189 -0.00199368  0.00086975 -0.00086187 -0.01038572]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00048189 -0.00199368  0.00086975 -0.00086187 -0.01038572]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 1.2146877e-04  1.8155413e-04  3.6186259e-04 -2.4982404e-05
  5.4255611e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00818092  0.01732201  0.03117834 -0.00785255  0.10088907]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00818092  0.01732201  0.03117834 -0.00785255  0.10088907]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.25302333  0.07226266  2.139916    1.018281   -0.02288928]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.25302333  0.07226266  2.139916    1.018281   -0.02288928]
  [Layer 24] Output shape after mixer: (1, 1, 2048)
  [Layer 24] Output sample values after mixer: [-0.25302333  0.07226266  2.139916    1.018281   -0.02288928]
  [Layer 24] Residual connection shape: (1, 1, 2048)
  [Layer 24] Residual connection sample values: [ 5.1917095  2.439059   6.4440565 -1.2291119  1.8396395]
[Mamba2LMHeadModel] Processing layer 25/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.19678773  0.08450035  0.23065382 -0.04113222  0.0689877 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.19678773  0.08450035  0.23065382 -0.04113222  0.0689877 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.19678773  0.08450035  0.23065382 -0.04113222  0.0689877 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.58079326 -0.06605548  0.06537454 -0.10884294  0.15602374]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.58079326 -0.06605548  0.06537454 -0.10884294  0.15602374]
  [FlaxMamba2] xBC (step) sample values: [ 0.11061095 -0.20219691  0.31660682  0.7256267   0.18880068]
  [FlaxMamba2] dt (step) sample values: [ 0.7436945  -0.90917534  0.5156055   1.2800239  -0.47843346]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.11417346  1.575577    0.21576144  0.11061095 -0.26667106]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.09722573 -0.28782696 -0.01767975 -0.1943785   0.37881052]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.09977967 -0.31604046 -0.02909332 -0.13355696  0.37304652]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.0474029  -0.13325562 -0.01433507 -0.06232573  0.22091626]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.0474029  -0.13325562 -0.01433507 -0.06232573  0.22091626]
  [FlaxMamba2] B (step) sample values: [-0.02528375  0.06525394 -0.04434089 -0.0342361   0.01767176]
  [FlaxMamba2] C (step) sample values: [ 0.05634417  0.01550983 -0.08054093 -0.03884536 -0.23865971]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -0.37022203  -1.5044799   -5.7209826   -0.81757224 -14.66622   ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.26952714 0.0025767  0.04349424 0.02508043 0.02034595]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9050321 0.9961309 0.7797127 0.9797037 0.7420058]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.0474029  -0.13325562 -0.01433507 -0.06232573  0.22091626]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00032303 -0.00083371  0.00056652  0.00043741 -0.00022578]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00032303 -0.00083371  0.00056652  0.00043741 -0.00022578]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00661397 -0.00377996  0.00048974  0.00396819  0.00119698]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.0066159  -0.00915431  0.00409625  0.00156215  0.01147041]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00612069 -0.01054641  0.00394649  0.00091104  0.0137783 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00612069 -0.01054641  0.00394649  0.00091104  0.0137783 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-1.2753038e-03  3.3682404e-04  1.3321519e-04 -4.6884386e-05
  1.1585538e-03]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.09042555  0.01631454  0.0104164  -0.00218685  0.11832973]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.09042555  0.01631454  0.0104164  -0.00218685  0.11832973]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.805938    1.2408671  -0.24486212 -0.9957651  -0.01329996]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.805938    1.2408671  -0.24486212 -0.9957651  -0.01329996]
  [Layer 25] Output shape after mixer: (1, 1, 2048)
  [Layer 25] Output sample values after mixer: [ 0.805938    1.2408671  -0.24486212 -0.9957651  -0.01329996]
  [Layer 25] Residual connection shape: (1, 1, 2048)
  [Layer 25] Residual connection sample values: [ 5.9976473  3.6799262  6.1991944 -2.2248769  1.8263396]
[Mamba2LMHeadModel] Processing layer 26/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.26933706  0.15291306  0.2593589  -0.09131271  0.08019884]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.26933706  0.15291306  0.2593589  -0.09131271  0.08019884]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.26933706  0.15291306  0.2593589  -0.09131271  0.08019884]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.8408812  -0.27625334 -0.5010579  -0.07304787 -0.7534821 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.8408812  -0.27625334 -0.5010579  -0.07304787 -0.7534821 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.63375294 -1.1265304  -0.39583337  1.2357006  -0.97775286]
  [FlaxMamba2] dt (step) sample values: [1.1059504 0.7481244 1.101058  1.6952456 2.173672 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.5639119  -1.1610427  -0.3228466   0.63375294 -0.36273304]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.42269802  0.23397915 -0.14390244 -0.18148562  0.17585523]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.33419704  0.17791836 -0.07975449 -0.20843264  0.18396528]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.19476344  0.0968521  -0.03828789 -0.09339443  0.10041966]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.19476344  0.0968521  -0.03828789 -0.09339443  0.10041966]
  [FlaxMamba2] B (step) sample values: [-0.02295793  0.01694942  0.06088715  0.08729877  0.09785648]
  [FlaxMamba2] C (step) sample values: [-0.07619493 -0.03135844 -0.01599987  0.1493272   0.02025361]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9594627  -0.39448437 -0.84198165 -1.4275463  -0.14661841]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1626251  0.21843171 0.17742614 0.48147017 0.0924823 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8555312  0.9174402  0.86123353 0.50292164 0.9865319 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.19476344  0.0968521  -0.03828789 -0.09339443  0.10041966]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00072716  0.00053685  0.0019285   0.00276505  0.00309945]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00072716  0.00053685  0.0019285   0.00276505  0.00309945]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [0.00096854 0.00018469 0.00061861 0.00344047 0.00238817]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00089344  0.00890244  0.00071968 -0.00304312  0.00777472]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02570335  0.02123992 -0.00415761 -0.01494015  0.02056666]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02570335  0.02123992 -0.00415761 -0.01494015  0.02056666]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01510026 -0.00253112  0.00078598  0.00052575 -0.00495989]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.22102562 -0.08227381  0.02173945  0.0221397  -0.18234818]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.22102562 -0.08227381  0.02173945  0.0221397  -0.18234818]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 0.06429762  0.21316735 -0.3292522  -0.5975357   1.0450064 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 0.06429762  0.21316735 -0.3292522  -0.5975357   1.0450064 ]
  [Layer 26] Output shape after mixer: (1, 1, 2048)
  [Layer 26] Output sample values after mixer: [ 0.06429762  0.21316735 -0.3292522  -0.5975357   1.0450064 ]
  [Layer 26] Residual connection shape: (1, 1, 2048)
  [Layer 26] Residual connection sample values: [ 6.061945   3.8930936  5.869942  -2.8224125  2.871346 ]
[Mamba2LMHeadModel] Processing layer 27/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.2592242   0.15190929  0.2457415  -0.10851152  0.12772903]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.2592242   0.15190929  0.2457415  -0.10851152  0.12772903]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.2592242   0.15190929  0.2457415  -0.10851152  0.12772903]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.6161703  -0.389307   -0.3991307  -0.4823206   0.16430005]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.6161703  -0.389307   -0.3991307  -0.4823206   0.16430005]
  [FlaxMamba2] xBC (step) sample values: [-0.40488234  0.40536064  0.64665145  0.01245894  0.28890675]
  [FlaxMamba2] dt (step) sample values: [1.0299335 1.0709538 0.8259534 1.5728371 1.8974723]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.23419484  0.5273738   0.31166753 -0.40488234  0.32151973]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.00976815 -0.15081236  0.15500478 -0.04962387 -0.20162313]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.03576913 -0.18731138  0.14499502 -0.25152817 -0.23140828]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.01756474 -0.08490986  0.07774421 -0.11003034 -0.10237613]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.01756474 -0.08490986  0.07774421 -0.11003034 -0.10237613]
  [FlaxMamba2] B (step) sample values: [ 0.5989125  -0.07832679 -0.06520917  0.03969433  0.03468619]
  [FlaxMamba2] C (step) sample values: [ 0.07356441 -0.14190137 -0.0628994   0.0586214  -0.15751718]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.3661706 -1.3799144 -1.8267511 -2.0408754 -2.3490334]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.11414777 0.13150354 0.10790224 0.07819524 0.2682535 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.85560596 0.83404857 0.8210999  0.852496   0.53251916]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.01756474 -0.08490986  0.07774421 -0.11003034 -0.10237613]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.2008051e-03  1.5704334e-04  1.3074280e-04 -7.9586178e-05
 -6.9544978e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-1.2008051e-03  1.5704334e-04  1.3074280e-04 -7.9586178e-05
 -6.9544978e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00202492  0.00106844  0.00177213 -0.00090119  0.0002593 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00642103 -0.01349288  0.01151113 -0.03902121 -0.01504412]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.00819745 -0.02208031  0.01937386 -0.05014922 -0.02539801]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.00819745 -0.02208031  0.01937386 -0.05014922 -0.02539801]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00177116  0.0034718  -0.00310484  0.00923266 -0.00225746]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.03874777  0.05522243 -0.08528832  0.22820786 -0.03431139]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.03874777  0.05522243 -0.08528832  0.22820786 -0.03431139]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.6167963  -0.9649202  -0.00905991  1.5135977   1.26445   ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.6167963  -0.9649202  -0.00905991  1.5135977   1.26445   ]
  [Layer 27] Output shape after mixer: (1, 1, 2048)
  [Layer 27] Output sample values after mixer: [-0.6167963  -0.9649202  -0.00905991  1.5135977   1.26445   ]
  [Layer 27] Residual connection shape: (1, 1, 2048)
  [Layer 27] Residual connection sample values: [ 5.4451485  2.9281733  5.8608823 -1.3088148  4.135796 ]
[Mamba2LMHeadModel] Processing layer 28/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.20583107  0.10356555  0.20942304 -0.04545802  0.15473832]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.20583107  0.10356555  0.20942304 -0.04545802  0.15473832]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.20583107  0.10356555  0.20942304 -0.04545802  0.15473832]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.5267671  -0.310846    0.04688958 -0.380334   -0.23758405]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.5267671  -0.310846    0.04688958 -0.380334   -0.23758405]
  [FlaxMamba2] xBC (step) sample values: [ 0.8156006  -0.40537596  1.0494418  -0.29981247  0.4420864 ]
  [FlaxMamba2] dt (step) sample values: [1.3088548 0.9810593 0.8924729 1.1116444 1.2492121]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.27866125  0.11472865 -0.8092534   0.8156006  -0.21869077]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.19592686  0.12904486  0.18579051 -0.06395105 -0.06578567]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.25369662  0.11768469  0.17212626 -0.07532647  0.03888962]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.11084357  0.06230078  0.09345175 -0.03624539  0.01982286]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.11084357  0.06230078  0.09345175 -0.03624539  0.01982286]
  [FlaxMamba2] B (step) sample values: [-2.3859866e-04 -1.0885895e-01 -6.8562761e-02 -1.0955911e-02
  2.6649162e-01]
  [FlaxMamba2] C (step) sample values: [-0.1461094  -0.12594102  0.49421757 -0.10312463  0.26756465]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.2727895 -3.997792  -2.517685  -2.1714401 -2.8654757]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.03718585 0.11330301 0.09908517 0.05116792 0.05219442]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.95377284 0.63574237 0.77921736 0.894842   0.8610852 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.11084357  0.06230078  0.09345175 -0.03624539  0.01982286]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.8345879e-07  4.4869614e-04  2.8260282e-04  4.5158205e-05
 -1.0984284e-03]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 9.8345879e-07  4.4869614e-04  2.8260282e-04  4.5158205e-05
 -1.0984284e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.4351936e-04  4.0737438e-04  4.2389365e-05  3.2648296e-04
 -1.2070080e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00065947  0.01058115 -0.00071284 -0.0039375   0.00413695]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.02468733  0.02408625  0.01954494 -0.01179451  0.00843401]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.02468733  0.02408625  0.01954494 -0.01179451  0.00843401]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00482819 -0.00316636  0.00046897  0.00182146 -0.00088343]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.2593846  -0.11273563  0.01581779  0.07094451 -0.03337916]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.2593846  -0.11273563  0.01581779  0.07094451 -0.03337916]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.0190254   2.3496454  -2.3110743   0.37897933  0.55514383]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.0190254   2.3496454  -2.3110743   0.37897933  0.55514383]
  [Layer 28] Output shape after mixer: (1, 1, 2048)
  [Layer 28] Output sample values after mixer: [-1.0190254   2.3496454  -2.3110743   0.37897933  0.55514383]
  [Layer 28] Residual connection shape: (1, 1, 2048)
  [Layer 28] Residual connection sample values: [ 4.426123    5.2778187   3.549808   -0.92983544  4.69094   ]
[Mamba2LMHeadModel] Processing layer 29/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.14668725  0.16728935  0.11266578 -0.0284215   0.15457973]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14668725  0.16728935  0.11266578 -0.0284215   0.15457973]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.14668725  0.16728935  0.11266578 -0.0284215   0.15457973]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.29256868 -0.74871963 -0.19414324  0.28574648 -0.39661926]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.29256868 -0.74871963 -0.19414324  0.28574648 -0.39661926]
  [FlaxMamba2] xBC (step) sample values: [-1.1774943   0.54889506  1.1013047  -1.0727484  -1.1582961 ]
  [FlaxMamba2] dt (step) sample values: [1.3452064  1.5681621  0.8358141  3.6385999  0.68772936]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6524618  -0.4256644  -0.6982512  -1.1774943   0.41975227]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01868211 -0.15406658 -0.18383706  0.22914305 -0.15130632]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.00527726 -0.18858196 -0.18098938  0.16871825 -0.26440448]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00264559 -0.08542645 -0.08232769  0.09145875 -0.11482592]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00264559 -0.08542645 -0.08232769  0.09145875 -0.11482592]
  [FlaxMamba2] B (step) sample values: [ 0.0899537   0.03762928 -0.01552493 -0.01983736  0.15316299]
  [FlaxMamba2] C (step) sample values: [-0.27844366 -0.2293423  -0.10621068 -0.25673562  0.02501856]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8072329  -2.117      -1.925669   -0.29044876 -2.049864  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.07914877 0.21761268 0.14110853 0.05820586 0.12125736]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8667192 0.6308507 0.7620613 0.9832363 0.7799222]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00264559 -0.08542645 -0.08232769  0.09145875 -0.11482592]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.8835894e-05  7.8793983e-06 -3.2508487e-06 -4.1538524e-06
  3.2071628e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.8835894e-05  7.8793983e-06 -3.2508487e-06 -4.1538524e-06
  3.2071628e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00017263  0.00031676 -0.00073011 -0.0002799   0.00100765]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00448585 -0.00196533 -0.00178402  0.02251091 -0.04035597]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00719104 -0.08931635 -0.08596648  0.11603013 -0.1577688 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00719104 -0.08931635 -0.08596648  0.11603013 -0.1577688 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [0.00120473 0.02147291 0.00753739 0.01893011 0.02516262]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [0.01022791 0.1715579  0.09541494 0.2149533  0.2534895 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [0.01022791 0.1715579  0.09541494 0.2149533  0.2534895 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.0452888 -1.1891148  1.430394  -2.0564172 -2.5052474]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.0452888 -1.1891148  1.430394  -2.0564172 -2.5052474]
  [Layer 29] Output shape after mixer: (1, 1, 2048)
  [Layer 29] Output sample values after mixer: [ 1.0452888 -1.1891148  1.430394  -2.0564172 -2.5052474]
  [Layer 29] Residual connection shape: (1, 1, 2048)
  [Layer 29] Residual connection sample values: [ 5.4714117  4.088704   4.980202  -2.9862528  2.1856925]
[Mamba2LMHeadModel] Processing layer 30/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.18354912  0.13496134  0.16323866 -0.09231003  0.07534137]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18354912  0.13496134  0.16323866 -0.09231003  0.07534137]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.18354912  0.13496134  0.16323866 -0.09231003  0.07534137]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.4416769  -0.9691348   0.4012966   0.14088379 -0.5117837 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.4416769  -0.9691348   0.4012966   0.14088379 -0.5117837 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.8674269  -0.72417396 -0.24933542  0.5171941   1.4804412 ]
  [FlaxMamba2] dt (step) sample values: [2.5225031 1.9328904 1.718811  2.4779656 1.8577174]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.9596449   1.1810967  -0.37989354  0.8674269  -0.31650984]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.13639417 -0.09916159 -0.10410866 -0.10165045 -0.34499478]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.11310926 -0.0854592  -0.07096657 -0.11979315 -0.37233853]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.05974966 -0.04090489 -0.03422475 -0.05631327 -0.15190521]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05974966 -0.04090489 -0.03422475 -0.05631327 -0.15190521]
  [FlaxMamba2] B (step) sample values: [ 0.01984578 -0.02796306 -0.12492717  0.15643716  0.08633119]
  [FlaxMamba2] C (step) sample values: [-0.27538157 -0.24004433 -0.23721054 -0.05632515  0.01147126]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0149885  -0.4675477  -0.42799968 -0.7895216  -0.4174731 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.04854306 0.56459856 0.9138706  0.5197253  0.53124684]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9519235  0.7679914  0.67628795 0.6634284  0.8010906 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05974966 -0.04090489 -0.03422475 -0.05631327 -0.15190521]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.7561319e-05 -8.1104910e-05 -3.6234263e-04  4.5373518e-04
  2.5039766e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.7561319e-05 -8.1104910e-05 -3.6234263e-04  4.5373518e-04
  2.5039766e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 8.5092615e-04  8.8022585e-05 -1.6069291e-04  2.1093297e-03
  2.0700601e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00336477 -0.00224958 -0.00312743 -0.00238041 -0.00594772]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.07697181 -0.05264129 -0.04528972 -0.07175408 -0.1930834 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.07697181 -0.05264129 -0.04528972 -0.07175408 -0.1930834 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.01330431  0.01403224 -0.01088658 -0.00540995  0.03703417]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.14128126  0.15123844 -0.07123329 -0.0476924   0.29014617]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.14128126  0.15123844 -0.07123329 -0.0476924   0.29014617]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.1387858  -0.26689118 -1.4280213   1.7558967   2.5250955 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.1387858  -0.26689118 -1.4280213   1.7558967   2.5250955 ]
  [Layer 30] Output shape after mixer: (1, 1, 2048)
  [Layer 30] Output sample values after mixer: [ 2.1387858  -0.26689118 -1.4280213   1.7558967   2.5250955 ]
  [Layer 30] Residual connection shape: (1, 1, 2048)
  [Layer 30] Residual connection sample values: [ 7.6101975  3.8218129  3.5521808 -1.2303561  4.710788 ]
[Mamba2LMHeadModel] Processing layer 31/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.24182867  0.11915272  0.11106927 -0.0374418   0.15123582]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.24182867  0.11915272  0.11106927 -0.0374418   0.15123582]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.24182867  0.11915272  0.11106927 -0.0374418   0.15123582]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.57445264 -0.2635896   0.6143846  -0.8340168  -0.62115735]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.57445264 -0.2635896   0.6143846  -0.8340168  -0.62115735]
  [FlaxMamba2] xBC (step) sample values: [-1.0628929  -0.03691984 -1.6133535  -0.88461405 -1.3913506 ]
  [FlaxMamba2] dt (step) sample values: [1.7265698  1.6605684  1.6104444  0.55914694 1.1793054 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-1.1307228   0.4075005  -0.98609334 -1.0628929   0.3566156 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.18955946  0.0075527  -0.2065383   0.13241692  0.24922968]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.1900549  -0.00276987 -0.2055236   0.1305191   0.24392726]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.08602431 -0.00138302 -0.09223882  0.06951233  0.13676544]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.08602431 -0.00138302 -0.09223882  0.06951233  0.13676544]
  [FlaxMamba2] B (step) sample values: [ 0.05856629 -0.01010632  0.0401047   0.22215283  0.04047619]
  [FlaxMamba2] C (step) sample values: [ 0.06268368 -0.14144047 -0.27553773  0.0337516  -0.20178488]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.9477868 -3.5383902 -4.705952  -2.462968  -0.9027082]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1728024  0.11412355 0.07663196 0.1023289  0.12923   ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.60086524 0.66776854 0.6972395  0.77721924 0.8898904 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.08602431 -0.00138302 -0.09223882  0.06951233  0.13676544]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0008706   0.00015023 -0.00059616 -0.00330235 -0.00060169]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.0008706   0.00015023 -0.00059616 -0.00330235 -0.00060169]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00121155  0.00109072  0.00050348 -0.00081889 -0.00029974]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.02773703  0.00581799 -0.019359   -0.01368208  0.03345858]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.08692317  0.00486645 -0.08282083  0.03414354  0.12755543]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.08692317  0.00486645 -0.08282083  0.03414354  0.12755543]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01798646 -0.00055733 -0.03302058 -0.00862252 -0.02769303]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.2676781  -0.00724568 -0.3822689  -0.10624584 -0.4043688 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.2676781  -0.00724568 -0.3822689  -0.10624584 -0.4043688 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.194728   1.6393511  2.2945254 -2.36222   -2.5540397]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.194728   1.6393511  2.2945254 -2.36222   -2.5540397]
  [Layer 31] Output shape after mixer: (1, 1, 2048)
  [Layer 31] Output sample values after mixer: [-2.194728   1.6393511  2.2945254 -2.36222   -2.5540397]
  [Layer 31] Residual connection shape: (1, 1, 2048)
  [Layer 31] Residual connection sample values: [ 5.4154696  5.461164   5.8467064 -3.592576   2.156748 ]
[Mamba2LMHeadModel] Processing layer 32/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.17115842  0.17334539  0.18508607 -0.10652099  0.07087842]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.17115842  0.17334539  0.18508607 -0.10652099  0.07087842]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.17115842  0.17334539  0.18508607 -0.10652099  0.07087842]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.01273512  1.3456761  -4.8016367  -1.010491   -0.20653869]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.01273512  1.3456761  -4.8016367  -1.010491   -0.20653869]
  [FlaxMamba2] xBC (step) sample values: [-0.80220383  0.20696166 -0.00923485  0.20923355  0.64787674]
  [FlaxMamba2] dt (step) sample values: [0.7131626 3.1651778 1.8124514 2.178052  2.5598748]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.18697533 -0.92954063 -0.824492   -0.80220383 -0.12207187]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.2560178  -0.32025215 -0.06505322 -0.0436848  -0.2567778 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.2931882  -0.37228462 -0.08089184 -0.03120311 -0.26375106]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.1679313  -0.15188806 -0.03881094 -0.01535817 -0.11458449]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.1679313  -0.15188806 -0.03881094 -0.01535817 -0.11458449]
  [FlaxMamba2] B (step) sample values: [ 0.03871176 -0.0900695   0.05061855  0.01374975  0.03771287]
  [FlaxMamba2] C (step) sample values: [-0.18951666 -0.2635692  -0.26937264 -0.1565708   0.512756  ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.6970906 -2.0892735 -1.7966746 -1.3893797 -1.0395182]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.15346019 0.12158198 0.5581677  0.6606487  1.171176  ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.89854753 0.7756778  0.36683404 0.39936003 0.29598138]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.1679313  -0.15188806 -0.03881094 -0.01535817 -0.11458449]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00099763 -0.00232116  0.00130448  0.00035434  0.00097189]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00099763 -0.00232116  0.00130448  0.00035434  0.00097189]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00310294 -0.00263762  0.00097742 -0.00290343  0.0064459 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.07196679 -0.0704017  -0.02099877 -0.01971738 -0.05093248]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.11224946 -0.10683598 -0.03030858 -0.02340143 -0.07841854]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.11224946 -0.10683598 -0.03030858 -0.02340143 -0.07841854]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.0007102  -0.11406758  0.00118598  0.00631098  0.00726489]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00441191 -0.5700162   0.01150987  0.0501319   0.04719697]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00441191 -0.5700162   0.01150987  0.0501319   0.04719697]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.724555    0.36482513 -2.2702637   0.5652473   4.1256266 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.724555    0.36482513 -2.2702637   0.5652473   4.1256266 ]
  [Layer 32] Output shape after mixer: (1, 1, 2048)
  [Layer 32] Output sample values after mixer: [-0.724555    0.36482513 -2.2702637   0.5652473   4.1256266 ]
  [Layer 32] Residual connection shape: (1, 1, 2048)
  [Layer 32] Residual connection sample values: [ 4.6909146  5.8259892  3.5764427 -3.0273287  6.2823744]
[Mamba2LMHeadModel] Processing layer 33/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15134396  0.19478251  0.11753983 -0.09660859  0.20993596]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15134396  0.19478251  0.11753983 -0.09660859  0.20993596]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15134396  0.19478251  0.11753983 -0.09660859  0.20993596]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.28382528 -0.00305352 -0.6313542  -1.1242633  -0.5305989 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.28382528 -0.00305352 -0.6313542  -1.1242633  -0.5305989 ]
  [FlaxMamba2] xBC (step) sample values: [ 0.7720811  -0.898452   -1.6341037  -0.18361728  0.59437907]
  [FlaxMamba2] dt (step) sample values: [-0.01745799 -0.12143861 -0.05151583 -0.10341782  0.54055357]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.24129574  1.4796238   0.6877787   0.7720811  -0.96666205]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.13750796 -0.2933684   0.3001732  -0.06435069 -0.10998466]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.12436251 -0.34274584  0.32699814 -0.06555709 -0.11117389]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.06604279 -0.14228842  0.18999535 -0.0317045  -0.05250021]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.06604279 -0.14228842  0.18999535 -0.0317045  -0.05250021]
  [FlaxMamba2] B (step) sample values: [-0.2748698   0.1356218  -0.06016108  0.03073189  0.18985581]
  [FlaxMamba2] C (step) sample values: [-0.03837382 -0.09172732 -0.255655   -0.24291256  0.5236599 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9790505  -9.693779   -6.1677613  -0.11351943 -2.090294  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01155381 0.00884919 0.01230783 0.00733074 0.0049248 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.97739387 0.91779417 0.926898   0.99916816 0.98975855]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.06604279 -0.14228842  0.18999535 -0.0317045  -0.05250021]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.0973817e-04  1.0348560e-04 -4.5905639e-05  2.3449833e-05
  1.4486862e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-2.0973817e-04  1.0348560e-04 -4.5905639e-05  2.3449833e-05
  1.4486862e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.6955316e-04  2.2676613e-04 -1.4414021e-04 -4.6510406e-05
  2.3789707e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00045836 -0.00157153  0.00224678 -0.00083459 -0.0012604 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.06922683 -0.1497324   0.20008351 -0.03384758 -0.05592738]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.06922683 -0.1497324   0.20008351 -0.03384758 -0.05592738]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00843927  0.00022826 -0.04385999  0.00933155  0.01099094]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.08392379  0.0013528  -0.32754627  0.06806315  0.09072784]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.08392379  0.0013528  -0.32754627  0.06806315  0.09072784]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.6945509  -0.13871391  2.1718886  -3.7625573  -0.91661906]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.6945509  -0.13871391  2.1718886  -3.7625573  -0.91661906]
  [Layer 33] Output shape after mixer: (1, 1, 2048)
  [Layer 33] Output sample values after mixer: [ 1.6945509  -0.13871391  2.1718886  -3.7625573  -0.91661906]
  [Layer 33] Residual connection shape: (1, 1, 2048)
  [Layer 33] Residual connection sample values: [ 6.3854656  5.6872754  5.748331  -6.789886   5.365755 ]
[Mamba2LMHeadModel] Processing layer 34/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15116818  0.14265972  0.13599855 -0.16206658  0.1332262 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15116818  0.14265972  0.13599855 -0.16206658  0.1332262 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15116818  0.14265972  0.13599855 -0.16206658  0.1332262 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.8655152  -0.22637764  0.6310231  -1.0043838  -0.37208754]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.8655152  -0.22637764  0.6310231  -1.0043838  -0.37208754]
  [FlaxMamba2] xBC (step) sample values: [-0.15408613  0.00480284 -0.85511374  0.15388753 -0.63694304]
  [FlaxMamba2] dt (step) sample values: [0.7055871 1.7671531 2.4751723 4.012124  3.9502633]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.51194197 -0.24101172 -0.83088464 -0.15408613 -0.57450795]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.05860179  0.02026374 -0.16658072 -0.0321976  -0.1270769 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.02671092  0.04629523 -0.17852072 -0.07171786 -0.13561419]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.01353382  0.02368333 -0.08131404 -0.03457361 -0.06321633]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.01353382  0.02368333 -0.08131404 -0.03457361 -0.06321633]
  [FlaxMamba2] B (step) sample values: [-4.7211729e-02  3.9356682e-02 -2.0226946e-02  5.1862455e-05
 -4.0968366e-02]
  [FlaxMamba2] C (step) sample values: [-0.03148251 -0.27687767 -0.19982022 -0.24066788 -0.273346  ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.5610816  -2.4810736  -2.893596   -0.01585086 -0.02613366]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10308716 0.17648876 0.10619708 0.58818346 0.3296537 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.76796234 0.6454022  0.7354362  0.9907201  0.99142194]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.01353382  0.02368333 -0.08131404 -0.03457361 -0.06321633]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.5868051e-05  5.4908982e-05 -2.8219885e-05  7.2356571e-08
 -5.7157544e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-6.5868051e-05  5.4908982e-05 -2.8219885e-05  7.2356571e-08
 -5.7157544e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-2.0658048e-03  2.5027045e-03 -2.4567225e-03  1.9414656e-04
 -8.7515822e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00419667  0.00412861 -0.00524603  0.00195505 -0.00357557]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01253273  0.0187162  -0.05533085 -0.01934033 -0.04251323]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01253273  0.0187162  -0.05533085 -0.01934033 -0.04251323]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00321283 -0.0018797  -0.0227898   0.00520749  0.00645459]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.08040363 -0.04574827 -0.63413775  0.16293381  0.19180815]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.08040363 -0.04574827 -0.63413775  0.16293381  0.19180815]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.05429735  2.866016   -4.5609827   1.5611503  -2.307196  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.05429735  2.866016   -4.5609827   1.5611503  -2.307196  ]
  [Layer 34] Output shape after mixer: (1, 1, 2048)
  [Layer 34] Output sample values after mixer: [-0.05429735  2.866016   -4.5609827   1.5611503  -2.307196  ]
  [Layer 34] Residual connection shape: (1, 1, 2048)
  [Layer 34] Residual connection sample values: [ 6.331168   8.553291   1.1873484 -5.228736   3.0585592]
[Mamba2LMHeadModel] Processing layer 35/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.15685692  0.2115106   0.02888919 -0.11932951  0.07498977]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15685692  0.2115106   0.02888919 -0.11932951  0.07498977]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.15685692  0.2115106   0.02888919 -0.11932951  0.07498977]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.8323946   1.0598723   2.6597314  -0.04188237  0.02295729]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.8323946   1.0598723   2.6597314  -0.04188237  0.02295729]
  [FlaxMamba2] xBC (step) sample values: [ 1.6608108  -0.50148606  1.0647807   0.4891581   0.44775596]
  [FlaxMamba2] dt (step) sample values: [4.0857143  0.16508086 1.0700119  0.6498204  1.3298117 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.8679777   2.3284924  -0.50260264  1.6608108   1.2172838 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.27650428  0.11330546 -0.17816971  0.07922595  0.09453832]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.43251014  0.15444316 -0.21436356  0.03427356  0.05306493]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.17020448  0.08317292 -0.09573764  0.01743042  0.02723627]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.17020448  0.08317292 -0.09573764  0.01743042  0.02723627]
  [FlaxMamba2] B (step) sample values: [ 0.01301965  0.18110643 -0.25151107  0.2590882  -0.14122061]
  [FlaxMamba2] C (step) sample values: [ 0.6316078   0.46266863 -0.25436622 -0.11848132  0.19392592]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.709799  -2.7746034 -0.4452666 -1.139112  -3.5906036]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.43409747 0.02001349 0.40431893 0.12386854 0.09456494]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.73482573 0.9459841  0.8352454  0.86840236 0.7120941 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.17020448  0.08317292 -0.09573764  0.01743042  0.02723627]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00096196 -0.01338111  0.01858298 -0.01914282  0.01043413]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00096196 -0.01338111  0.01858298 -0.01914282  0.01043413]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00353198 -0.02445513  0.04013673 -0.03673701  0.0129553 ]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.1182942  -0.01815267 -0.07936141 -0.07512777 -0.00437596]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.23340833  0.03809955 -0.1441115  -0.06333908  0.0140447 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.23340833  0.03809955 -0.1441115  -0.06333908  0.0140447 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 5.8896217e-02  2.9989343e-02 -3.5823333e-01  1.2986233e-03
  1.6306460e-04]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 9.4491816e-01  2.5596666e-01 -2.1604378e+00  9.0529332e-03
  1.5263617e-03]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 9.4491816e-01  2.5596666e-01 -2.1604378e+00  9.0529332e-03
  1.5263617e-03]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.9079998 -2.2112174 -1.4479246 -1.0196751 -4.5511174]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.9079998 -2.2112174 -1.4479246 -1.0196751 -4.5511174]
  [Layer 35] Output shape after mixer: (1, 1, 2048)
  [Layer 35] Output sample values after mixer: [ 3.9079998 -2.2112174 -1.4479246 -1.0196751 -4.5511174]
  [Layer 35] Residual connection shape: (1, 1, 2048)
  [Layer 35] Residual connection sample values: [10.239168    6.342074   -0.26057625 -6.248411   -1.4925582 ]
[Mamba2LMHeadModel] Processing layer 36/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.20462228  0.12831809 -0.00517115 -0.12319256 -0.03053999]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.20462228  0.12831809 -0.00517115 -0.12319256 -0.03053999]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.20462228  0.12831809 -0.00517115 -0.12319256 -0.03053999]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.2342504  -1.7658818  -0.5927026   0.0387757  -0.92920524]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.2342504  -1.7658818  -0.5927026   0.0387757  -0.92920524]
  [FlaxMamba2] xBC (step) sample values: [-0.09834912  1.9529384   0.09446472 -0.8683169   0.27253705]
  [FlaxMamba2] dt (step) sample values: [ 0.77983916  2.0860271   1.032508   -0.23955856  0.22631367]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.04255656 -1.0857224   0.10369059 -0.09834912  1.3037248 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.03607564  0.34444708  0.01960467 -0.19248822 -0.03589784]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-1.1821091e-04  3.4431332e-01 -8.8834856e-03 -2.1742108e-01
 -6.3760385e-02]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-5.9101960e-05  2.0150521e-01 -4.4220136e-03 -9.6938893e-02
 -3.0864192e-02]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-5.9101960e-05  2.0150521e-01 -4.4220136e-03 -9.6938893e-02
 -3.0864192e-02]
  [FlaxMamba2] B (step) sample values: [ 0.06790616  0.35582605 -0.07857414 -0.09403969  0.04904059]
  [FlaxMamba2] C (step) sample values: [-0.01917882 -0.27827805 -0.23721948 -0.16928183 -0.12116064]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.6566098 -1.1305923 -1.6058172 -2.4414158 -2.882315 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.0908329  0.02929846 0.05939712 0.02892302 0.05113974]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.78559995 0.967418   0.9090266  0.9318223  0.862948  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-5.9101960e-05  2.0150521e-01 -4.4220136e-03 -9.6938893e-02
 -3.0864192e-02]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.6454759e-07 -1.9102174e-06  4.2181762e-07  5.0484294e-07
 -2.6326964e-07]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-3.6454759e-07 -1.9102174e-06  4.2181762e-07  5.0484294e-07
 -2.6326964e-07]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 2.8367585e-04  8.5360394e-04 -1.2618172e-04  2.9237018e-04
 -7.5071592e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00120997  0.01552131 -0.0006989  -0.0109554   0.00139003]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.00114225  0.24640335 -0.00576559 -0.12202671 -0.03397375]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.00114225  0.24640335 -0.00576559 -0.12202671 -0.03397375]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00031783 -0.06355143  0.0012166  -0.0024117   0.00893662]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.00415269 -1.2113014   0.01566345 -0.03494695  0.11210655]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.00415269 -1.2113014   0.01566345 -0.03494695  0.11210655]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.364106   -0.37044984 -4.512063   -1.4319597  -3.2261775 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.364106   -0.37044984 -4.512063   -1.4319597  -3.2261775 ]
  [Layer 36] Output shape after mixer: (1, 1, 2048)
  [Layer 36] Output sample values after mixer: [-2.364106   -0.37044984 -4.512063   -1.4319597  -3.2261775 ]
  [Layer 36] Residual connection shape: (1, 1, 2048)
  [Layer 36] Residual connection sample values: [ 7.875062   5.971624  -4.7726393 -7.680371  -4.7187357]
[Mamba2LMHeadModel] Processing layer 37/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.1647682   0.12783122 -0.09865998 -0.15546665 -0.09948983]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1647682   0.12783122 -0.09865998 -0.15546665 -0.09948983]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.1647682   0.12783122 -0.09865998 -0.15546665 -0.09948983]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.9209805  1.8311539  2.643296  -3.0028222 -0.3963135]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.9209805  1.8311539  2.643296  -3.0028222 -0.3963135]
  [FlaxMamba2] xBC (step) sample values: [-0.89848167  0.18833342 -0.58299536  0.32261226 -0.6734067 ]
  [FlaxMamba2] dt (step) sample values: [2.810003   1.1701967  2.7386248  1.1583724  0.26850817]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.2273136  -1.6311437  -0.4155812  -0.89848167  0.823326  ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.12398135 -0.02585611 -0.05222818  0.16561677 -0.1082826 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.11159884 -0.05429849 -0.04722711  0.01473786 -0.09354261]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.05890977 -0.02641235 -0.02305606  0.00742323 -0.04458534]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.05890977 -0.02641235 -0.02305606  0.00742323 -0.04458534]
  [FlaxMamba2] B (step) sample values: [ 0.01596462  0.1208576  -0.09197979 -0.0208005   0.03649102]
  [FlaxMamba2] C (step) sample values: [-0.18065982 -0.07737079 -0.24551702 -0.22049549 -0.27836832]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.06064401 -3.2470093  -0.81907064 -0.24529998 -1.975189  ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1454848  0.03110471 0.13611348 0.00397707 0.01523089]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.991216   0.9039355  0.8945034  0.9990249  0.97036415]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.05890977 -0.02641235 -0.02305606  0.00742323 -0.04458534]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00013682  0.00103581 -0.00078831 -0.00017827  0.00031275]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.00013682  0.00103581 -0.00078831 -0.00017827  0.00031275]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.000722    0.0006231  -0.00381658 -0.00067214 -0.00121074]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.02325463 -0.02341025 -0.01932867  0.0662628   0.04159158]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01204404 -0.01838395 -0.01494108  0.06485015  0.05007622]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01204404 -0.01838395 -0.01494108  0.06485015  0.05007622]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00793369 -0.02901484 -0.03687119 -0.00921061 -0.00798198]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.05385572 -0.17876197 -0.44768047 -0.20660006 -0.04001595]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.05385572 -0.17876197 -0.44768047 -0.20660006 -0.04001595]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-4.6054945  1.4824877 -4.1609406  2.371287  -5.873205 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-4.6054945  1.4824877 -4.1609406  2.371287  -5.873205 ]
  [Layer 37] Output shape after mixer: (1, 1, 2048)
  [Layer 37] Output sample values after mixer: [-4.6054945  1.4824877 -4.1609406  2.371287  -5.873205 ]
  [Layer 37] Residual connection shape: (1, 1, 2048)
  [Layer 37] Residual connection sample values: [  3.2695675   7.4541116  -8.93358    -5.309084  -10.591941 ]
[Mamba2LMHeadModel] Processing layer 38/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05480352  0.1240024  -0.14790902 -0.08576322 -0.1753657 ]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05480352  0.1240024  -0.14790902 -0.08576322 -0.1753657 ]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05480352  0.1240024  -0.14790902 -0.08576322 -0.1753657 ]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.16911937 -0.63276947 -0.9910135  -0.81932896 -0.22172885]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.16911937 -0.63276947 -0.9910135  -0.81932896 -0.22172885]
  [FlaxMamba2] xBC (step) sample values: [-0.02911314  0.5632992   0.81245124 -0.46283698  0.12270688]
  [FlaxMamba2] dt (step) sample values: [1.0187459 1.8382853 2.364664  1.6143042 1.7738267]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.47133467 -0.822568   -0.29388085 -0.02911314  1.1070267 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.01599808 -0.09630721 -0.14896397  0.09076332  0.03294746]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04408951 -0.13347763 -0.17473607  0.07915901  0.01169197]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02253065 -0.06229135 -0.07975423  0.04114522  0.00588016]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02253065 -0.06229135 -0.07975423  0.04114522  0.00588016]
  [FlaxMamba2] B (step) sample values: [-0.20274961 -0.24149965 -0.03426144  0.17436633 -0.27788123]
  [FlaxMamba2] C (step) sample values: [-0.19281575 -0.10850453 -0.27771848 -0.05094934 -0.22865853]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.0881431 -1.3535548 -1.1764196 -1.6451025 -1.1940706]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.13771842 0.17504679 1.0802299  0.1956195  0.12837903]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8608308  0.78904223 0.28060603 0.7248329  0.8578778 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02253065 -0.06229135 -0.07975423  0.04114522  0.00588016]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00062911 -0.00074935 -0.00010631  0.00054104 -0.00086223]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-0.00062911 -0.00074935 -0.00010631  0.00054104 -0.00086223]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [1.6765095e-03 2.1121274e-03 5.3831842e-05 1.5941701e-03 6.1671954e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00024656 -0.03615322 -0.03646229  0.02691178  0.00749591]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.01799929 -0.08659824 -0.10104915  0.06023216  0.0122578 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.01799929 -0.08659824 -0.10104915  0.06023216  0.0122578 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00139362  0.01900804  0.02710939 -0.01509645 -0.00120891]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.02044155  0.26967025  0.40347573 -0.20496751 -0.01476529]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.02044155  0.26967025  0.40347573 -0.20496751 -0.01476529]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [  0.22318381  -5.724151   -10.5944805    2.891333     2.973635  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [  0.22318381  -5.724151   -10.5944805    2.891333     2.973635  ]
  [Layer 38] Output shape after mixer: (1, 1, 2048)
  [Layer 38] Output sample values after mixer: [  0.22318381  -5.724151   -10.5944805    2.891333     2.973635  ]
  [Layer 38] Residual connection shape: (1, 1, 2048)
  [Layer 38] Residual connection sample values: [  3.4927514   1.7299604 -19.52806    -2.4177508  -7.618306 ]
[Mamba2LMHeadModel] Processing layer 39/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.04488469  0.02245997 -0.2513588  -0.03117094 -0.09906691]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.04488469  0.02245997 -0.2513588  -0.03117094 -0.09906691]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.04488469  0.02245997 -0.2513588  -0.03117094 -0.09906691]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.2835229   0.13603763 -0.38329464 -0.21292384 -0.19914317]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.2835229   0.13603763 -0.38329464 -0.21292384 -0.19914317]
  [FlaxMamba2] xBC (step) sample values: [ 0.8892955  -0.21612628  0.5964609  -0.4922687   0.01030823]
  [FlaxMamba2] dt (step) sample values: [4.631259   2.6646845  0.77168137 1.3222486  0.46091157]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [1.5400192  2.3278708  1.4473349  0.8892955  0.21959762]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.1914939   0.03136597  0.11587294 -0.1692543  -0.00729716]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.17715827  0.11657105  0.09353407 -0.16517639 -0.028278  ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.09640493  0.06167889  0.0489526  -0.07578285 -0.0139391 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.09640493  0.06167889  0.0489526  -0.07578285 -0.0139391 ]
  [FlaxMamba2] B (step) sample values: [ 0.2879916  -0.01875282  0.03472782 -0.03004422 -0.08727813]
  [FlaxMamba2] C (step) sample values: [ 0.7077874   0.15907623  0.20914935  0.10574295 -0.26819882]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.69420344 -0.9242845  -1.3151171  -3.1532621  -2.1087465 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.40422702 0.10328972 0.01912713 0.09909347 0.04044483]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.7553185  0.90894645 0.9751593  0.73163927 0.9182479 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.09640493  0.06167889  0.0489526  -0.07578285 -0.0139391 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01122288 -0.00073079  0.00135333 -0.00117081 -0.00340118]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 0.01122288 -0.00073079  0.00135333 -0.00117081 -0.00340118]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.01322451 -0.00103889  0.00240496  0.00032132 -0.00116462]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.04353444  0.03352419  0.01734556 -0.03556236 -0.00131279]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.12613969  0.08637418  0.05929094 -0.10049742 -0.0132566 ]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.12613969  0.08637418  0.05929094 -0.10049742 -0.0132566 ]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.02039984  0.00627407 -0.00921155  0.00956438  0.00118898]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.490865    0.16217102 -0.24338943  0.2043433   0.02896582]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.490865    0.16217102 -0.24338943  0.2043433   0.02896582]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.5707417 -0.7138067  1.9700968  0.7276336 -7.433341 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.5707417 -0.7138067  1.9700968  0.7276336 -7.433341 ]
  [Layer 39] Output shape after mixer: (1, 1, 2048)
  [Layer 39] Output sample values after mixer: [-2.5707417 -0.7138067  1.9700968  0.7276336 -7.433341 ]
  [Layer 39] Residual connection shape: (1, 1, 2048)
  [Layer 39] Residual connection sample values: [  0.9220097   1.0161538 -17.557964   -1.6901172 -15.051647 ]
[Mamba2LMHeadModel] Processing layer 40/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01041553  0.01156886 -0.20521823 -0.01927391 -0.16955642]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01041553  0.01156886 -0.20521823 -0.01927391 -0.16955642]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01041553  0.01156886 -0.20521823 -0.01927391 -0.16955642]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.0501189  -0.7784398  -1.5441333   0.08201168 -1.5605453 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.0501189  -0.7784398  -1.5441333   0.08201168 -1.5605453 ]
  [FlaxMamba2] xBC (step) sample values: [-0.44089025 -0.33049092 -0.39234093 -0.06115335  0.14056787]
  [FlaxMamba2] dt (step) sample values: [0.1538197 1.7632166 2.5424795 1.1793646 1.385534 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.84650826  0.05527284  0.00958643 -0.44089025 -0.2876327 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.08970825  0.0515264  -0.08643302  0.00398425  0.01237421]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.10536376  0.03289542 -0.08067665 -0.00588818  0.00760965]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04990906  0.01671821 -0.03871202 -0.00293542  0.0038193 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04990906  0.01671821 -0.03871202 -0.00293542  0.0038193 ]
  [FlaxMamba2] B (step) sample values: [-0.17381857  0.12394647 -0.06909575 -0.00876472 -0.0137382 ]
  [FlaxMamba2] C (step) sample values: [-0.09410793 -0.01383758 -0.05202023  0.07462533  0.04594648]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.9809841  -1.4352343  -0.79658854 -1.6062093  -1.8464803 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06630434 0.0763758  0.05633467 0.11531401 0.2178016 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8769127  0.8961772  0.95611644 0.8309227  0.6688695 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04990906  0.01671821 -0.03871202 -0.00293542  0.0038193 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.7519827e-04 -4.1016212e-04  2.2865080e-04  2.9004088e-05
  4.5462275e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 5.7519827e-04 -4.1016212e-04  2.2865080e-04  2.9004088e-05
  4.5462275e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00112223  0.00183714 -0.00022058 -0.00079387  0.00100247]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00487601 -0.00135629 -0.00743524 -0.00515516 -0.0077339 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03588373  0.01229715 -0.03905058 -0.00755246 -0.00461475]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03588373  0.01229715 -0.03905058 -0.00755246 -0.00461475]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00976731 -0.00301207  0.01060877 -0.00032239  0.00124996]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.28793854 -0.08932582  0.3097869  -0.01115492  0.03637163]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.28793854 -0.08932582  0.3097869  -0.01115492  0.03637163]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-2.2654076  -1.8474281   0.41194218  6.634643    2.3114517 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-2.2654076  -1.8474281   0.41194218  6.634643    2.3114517 ]
  [Layer 40] Output shape after mixer: (1, 1, 2048)
  [Layer 40] Output sample values after mixer: [-2.2654076  -1.8474281   0.41194218  6.634643    2.3114517 ]
  [Layer 40] Residual connection shape: (1, 1, 2048)
  [Layer 40] Residual connection sample values: [ -1.3433979  -0.8312743 -17.146023    4.9445257 -12.740195 ]
[Mamba2LMHeadModel] Processing layer 41/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.0141313  -0.00881602 -0.18421029  0.05201182 -0.13467519]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.0141313  -0.00881602 -0.18421029  0.05201182 -0.13467519]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.0141313  -0.00881602 -0.18421029  0.05201182 -0.13467519]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.5724922  -0.33024067 -0.42002916 -0.6757991  -0.603198  ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.5724922  -0.33024067 -0.42002916 -0.6757991  -0.603198  ]
  [FlaxMamba2] xBC (step) sample values: [-0.1322795   0.53108037  0.36007056 -0.35173047  0.69720185]
  [FlaxMamba2] dt (step) sample values: [0.50941885 1.5712721  2.0296626  1.3317704  1.8309151 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.26111516  0.4608445  -0.02623196 -0.1322795  -1.1826257 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.0198982   0.08815578  0.08539844 -0.07881135  0.20495278]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.00654676  0.07415584  0.08749652 -0.08554811  0.18936592]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.00328409  0.03845207  0.04566095 -0.04094555  0.10362113]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.00328409  0.03845207  0.04566095 -0.04094555  0.10362113]
  [FlaxMamba2] B (step) sample values: [-0.04664992 -0.05784366 -0.09325491 -0.25826138  0.20899457]
  [FlaxMamba2] C (step) sample values: [-0.00862293  0.15603794 -0.14785422 -0.06943681  0.11606611]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8258594 -1.8636904 -1.2829287 -1.4542811 -4.4079003]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.06136286 0.1428027  0.05356148 0.14819069 0.03918263]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8940085  0.7663318  0.9335922  0.80612946 0.8413789 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.00328409  0.03845207  0.04566095 -0.04094555  0.10362113]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.4009602e-06 -1.1656739e-05 -1.8792865e-05 -5.2045209e-05
  4.2116888e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-9.4009602e-06 -1.1656739e-05 -1.8792865e-05 -5.2045209e-05
  4.2116888e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-9.8575139e-05  3.5090279e-04 -5.5659935e-04  3.1656218e-03
 -2.5884055e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00310754  0.00122867  0.01395775 -0.00244764  0.00637424]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 9.3413284e-05  3.8707234e-02  5.8462687e-02 -4.2356562e-02
  1.0737195e-01]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 9.3413284e-05  3.8707234e-02  5.8462687e-02 -4.2356562e-02
  1.0737195e-01]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 3.4190758e-05 -5.3454968e-03 -9.7367065e-03  9.6521778e-03
 -2.2902254e-02]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.00100577 -0.15715595 -0.28173035  0.29338494 -0.5425333 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.00100577 -0.15715595 -0.28173035  0.29338494 -0.5425333 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-1.4187393  4.5483675  1.5643035  1.8960475  2.1963055]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-1.4187393  4.5483675  1.5643035  1.8960475  2.1963055]
  [Layer 41] Output shape after mixer: (1, 1, 2048)
  [Layer 41] Output sample values after mixer: [-1.4187393  4.5483675  1.5643035  1.8960475  2.1963055]
  [Layer 41] Residual connection shape: (1, 1, 2048)
  [Layer 41] Residual connection sample values: [ -2.7621372   3.7170932 -15.581719    6.8405733 -10.54389  ]
[Mamba2LMHeadModel] Processing layer 42/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02925794  0.04014335 -0.1667483   0.07193669 -0.11116883]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02925794  0.04014335 -0.1667483   0.07193669 -0.11116883]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02925794  0.04014335 -0.1667483   0.07193669 -0.11116883]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.15038279  0.5477783  -1.5028743  -0.36727634  0.31399435]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.15038279  0.5477783  -1.5028743  -0.36727634  0.31399435]
  [FlaxMamba2] xBC (step) sample values: [ 0.68036914  0.6849731  -0.9734296  -0.56185883  1.5870436 ]
  [FlaxMamba2] dt (step) sample values: [1.592238  2.9007015 1.7724448 0.5837762 3.1620204]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.3847492   0.20667031 -0.8123917   0.68036914  0.6303705 ]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.09472752 -0.11512719 -0.15369946  0.06432621  0.2596463 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.08539677 -0.1283413  -0.14365155  0.0678529   0.23970306]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.04452043 -0.06005842 -0.06667568  0.03507701  0.13414752]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.04452043 -0.06005842 -0.06667568  0.03507701  0.13414752]
  [FlaxMamba2] B (step) sample values: [ 0.0141492  -0.04771908  0.05599944  0.02335033  0.40955752]
  [FlaxMamba2] C (step) sample values: [ 0.01243875 -0.07222345  0.14553563  0.19309637 -0.27492774]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.06612   -1.4514434 -0.7269863 -1.9455162 -0.6256312]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.10080902 1.4285822  0.02012877 0.04802491 0.2379118 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8980994 0.1257441 0.9854732 0.9107988 0.8617026]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.04452043 -0.06005842 -0.06667568  0.03507701  0.13414752]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 6.3502492e-05 -2.1416614e-04  2.5132892e-04  1.0479770e-04
  1.8381192e-03]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 6.3502492e-05 -2.1416614e-04  2.5132892e-04  1.0479770e-04
  1.8381192e-03]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-0.00028454 -0.00085607 -0.00035092  0.00127722  0.00198782]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00368272 -0.00531135 -0.00506032  0.00251955  0.00751798]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.04835806 -0.06557875 -0.071968    0.03771861  0.14213227]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.04835806 -0.06557875 -0.071968    0.03771861  0.14213227]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00336322 -0.02276129  0.01968461 -0.0056687   0.02578915]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.11715653 -0.77944255  0.6857063  -0.16344032  0.8154567 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.11715653 -0.77944255  0.6857063  -0.16344032  0.8154567 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 1.5188323 -3.059627  -6.04839    3.323069  -0.7707787]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 1.5188323 -3.059627  -6.04839    3.323069  -0.7707787]
  [Layer 42] Output shape after mixer: (1, 1, 2048)
  [Layer 42] Output sample values after mixer: [ 1.5188323 -3.059627  -6.04839    3.323069  -0.7707787]
  [Layer 42] Residual connection shape: (1, 1, 2048)
  [Layer 42] Residual connection sample values: [ -1.2433048   0.6574662 -21.63011    10.163643  -11.314669 ]
[Mamba2LMHeadModel] Processing layer 43/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01258383  0.00697732 -0.21960233  0.10462153 -0.11357288]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.01258383  0.00697732 -0.21960233  0.10462153 -0.11357288]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.01258383  0.00697732 -0.21960233  0.10462153 -0.11357288]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.15501313 -0.17853855 -0.18867801  0.08387764 -0.32267174]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.15501313 -0.17853855 -0.18867801  0.08387764 -0.32267174]
  [FlaxMamba2] xBC (step) sample values: [ 0.2570974  -0.3154338  -0.81925565  0.4449611  -0.16993542]
  [FlaxMamba2] dt (step) sample values: [3.657601   0.23955081 0.689285   2.5281157  2.080368  ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.28933084  0.34351736  0.4704377   0.2570974  -0.09350564]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.04450135 -0.16494647 -0.12364216 -0.07906277  0.04203421]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04093079 -0.21063128 -0.1111681  -0.07316144  0.03321463]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02088417 -0.09426509 -0.05249764 -0.03524316  0.01688309]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02088417 -0.09426509 -0.05249764 -0.03524316  0.01688309]
  [FlaxMamba2] B (step) sample values: [ 0.00869174  0.04512512  0.8872649  -0.01646508 -0.00164435]
  [FlaxMamba2] C (step) sample values: [-0.0887943  -0.15889007 -0.27793375 -0.00530717 -0.0253526 ]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.9761645 -1.478265  -1.0588893 -1.0815219 -5.9141264]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.1460067  0.0188899  0.01618764 0.08320631 0.3649359 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8671645  0.972462   0.98300517 0.91394085 0.11552399]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02088417 -0.09426509 -0.05249764 -0.03524316  0.01688309]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.6503092e-05  1.3759680e-04  2.7054732e-03 -5.0205803e-05
 -5.0139975e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 2.6503092e-05  1.3759680e-04  2.7054732e-03 -5.0205803e-05
 -5.0139975e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-1.6011723e-04 -1.1102166e-03  1.3423512e-02  9.1594942e-05
  1.3790047e-04]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00617006 -0.01318051 -0.01038015 -0.0069702   0.00394699]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.02430518 -0.09503719 -0.05596735 -0.0375742   0.01860771]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.02430518 -0.09503719 -0.05596735 -0.0375742   0.01860771]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00173809  0.00772855  0.00478328 -0.00164187 -0.0025219 ]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.06830446  0.23297241  0.13533393 -0.0512162  -0.09072552]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.06830446  0.23297241  0.13533393 -0.0512162  -0.09072552]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-0.21328922  6.1424665  -1.0211799   5.2187905   0.5170082 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-0.21328922  6.1424665  -1.0211799   5.2187905   0.5170082 ]
  [Layer 43] Output shape after mixer: (1, 1, 2048)
  [Layer 43] Output sample values after mixer: [-0.21328922  6.1424665  -1.0211799   5.2187905   0.5170082 ]
  [Layer 43] Residual connection shape: (1, 1, 2048)
  [Layer 43] Residual connection sample values: [ -1.4565941   6.7999325 -22.651289   15.382433  -10.797661 ]
[Mamba2LMHeadModel] Processing layer 44/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.01417684  0.06879713 -0.2225245   0.14893702 -0.10498294]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.01417684  0.06879713 -0.2225245   0.14893702 -0.10498294]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.01417684  0.06879713 -0.2225245   0.14893702 -0.10498294]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.75009763 -1.7919886  -1.1131222  -0.12191255 -1.4247655 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.75009763 -1.7919886  -1.1131222  -0.12191255 -1.4247655 ]
  [FlaxMamba2] xBC (step) sample values: [-0.7437821   0.25780278 -0.8780189  -1.8605409  -2.2638998 ]
  [FlaxMamba2] dt (step) sample values: [1.448334  1.5254837 1.3538321 2.2942066 1.149827 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.6839967 -0.5128645 -1.8358371 -0.7437821  0.9485096]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.15485105 -0.03560862 -0.14636008 -0.38104242  0.2649908 ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.16095838  0.02481618 -0.16482322 -0.38759226  0.21250057]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.07401624  0.01256204 -0.07563527 -0.1567024   0.11749712]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.07401624  0.01256204 -0.07563527 -0.1567024   0.11749712]
  [FlaxMamba2] B (step) sample values: [-0.26994553  0.03519299  0.02137902  0.01027639  0.08710068]
  [FlaxMamba2] C (step) sample values: [-0.26588228 -0.00469462  0.0358154   0.00373718 -0.13482046]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-0.74823433 -0.64391696 -1.1771379  -1.350584   -1.0269372 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.09003402 0.06747856 0.04244057 0.09382232 0.11276216]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.9348525  0.95747983 0.95126903 0.8809848  0.8906536 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.07401624  0.01256204 -0.07563527 -0.1567024   0.11749712]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.7989115e-03 -2.3452537e-04 -1.4246933e-04 -6.8481677e-05
 -5.8043719e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.7989115e-03 -2.3452537e-04 -1.4246933e-04 -6.8481677e-05
 -5.8043719e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 1.0171372e-02 -4.4794439e-04 -1.5188175e-03 -5.9194925e-05
 -2.3687237e-03]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.0030788  -0.00121013 -0.00253197 -0.0047546   0.00240137]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.07260717  0.01059023 -0.0735812  -0.15195557  0.11277421]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.07260717  0.01059023 -0.0735812  -0.15195557  0.11277421]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.01747156 -0.00271055  0.02025419  0.00869873 -0.03115774]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.5764457  -0.07140367  0.7200352   0.26821762 -1.0452219 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.5764457  -0.07140367  0.7200352   0.26821762 -1.0452219 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 3.4708407 -7.640226  -2.1182275  7.3636765 -4.377922 ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 3.4708407 -7.640226  -2.1182275  7.3636765 -4.377922 ]
  [Layer 44] Output shape after mixer: (1, 1, 2048)
  [Layer 44] Output sample values after mixer: [ 3.4708407 -7.640226  -2.1182275  7.3636765 -4.377922 ]
  [Layer 44] Residual connection shape: (1, 1, 2048)
  [Layer 44] Residual connection sample values: [  2.0142465  -0.8402934 -24.769516   22.746109  -15.175583 ]
[Mamba2LMHeadModel] Processing layer 45/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.01923865 -0.00824644 -0.237544    0.21371667 -0.14420874]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01923865 -0.00824644 -0.237544    0.21371667 -0.14420874]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.01923865 -0.00824644 -0.237544    0.21371667 -0.14420874]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [ 0.3821945  -0.35121718 -0.05849761  0.66608447  0.91945904]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [ 0.3821945  -0.35121718 -0.05849761  0.66608447  0.91945904]
  [FlaxMamba2] xBC (step) sample values: [-0.5169239   0.52896166  1.0757629   0.06199526 -2.8740203 ]
  [FlaxMamba2] dt (step) sample values: [2.055372   3.2633457  0.72921073 2.0360467  2.9457195 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 1.170957    0.9238664   0.04467821 -0.5169239   0.17410518]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.07322812 -0.09497102  0.16229752  0.00806444  0.51444   ]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.07780576 -0.04275544  0.15984657  0.00148027  0.51193756]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.03739021 -0.02092078  0.08629745  0.00074069  0.32009435]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.03739021 -0.02092078  0.08629745  0.00074069  0.32009435]
  [FlaxMamba2] B (step) sample values: [-0.21418808 -0.00789938 -0.12552078 -0.20447974  0.04985553]
  [FlaxMamba2] C (step) sample values: [-0.07081569  0.07951314  0.07922949 -0.22402516  0.50273687]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-2.250236  -4.181475  -1.0937363 -2.677446  -2.3148744]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.05491875 0.46808463 0.03985828 0.09274764 0.10061862]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.8837508  0.14124148 0.95734215 0.780105   0.7922174 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.03739021 -0.02092078  0.08629745  0.00074069  0.32009435]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.3981886e-04  1.6220774e-05  2.5774734e-04  4.1988352e-04
 -1.0237451e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 4.3981886e-04  1.6220774e-05  2.5774734e-04  4.1988352e-04
 -1.0237451e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 0.00233733 -0.00034951  0.00020927 -0.00013901  0.00014728]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 0.00148082  0.00107257 -0.00222    -0.00396446  0.04537788]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.04046483 -0.0223971   0.09459151 -0.00313353  0.40447095]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.04046483 -0.0223971   0.09459151 -0.00313353  0.40447095]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00919269  0.00324945 -0.00268579 -0.00137886  0.26587918]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.31893817  0.08175209 -0.08563166 -0.04024555  8.322961  ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.31893817  0.08175209 -0.08563166 -0.04024555  8.322961  ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ 2.9761474 -8.149034  -1.217328   1.2068603 -4.6731787]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ 2.9761474 -8.149034  -1.217328   1.2068603 -4.6731787]
  [Layer 45] Output shape after mixer: (1, 1, 2048)
  [Layer 45] Output sample values after mixer: [ 2.9761474 -8.149034  -1.217328   1.2068603 -4.6731787]
  [Layer 45] Residual connection shape: (1, 1, 2048)
  [Layer 45] Residual connection sample values: [  4.9903936  -8.9893265 -25.986843   23.952969  -19.848763 ]
[Mamba2LMHeadModel] Processing layer 46/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.05550313 -0.10420489 -0.29440042  0.2693323  -0.21926492]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05550313 -0.10420489 -0.29440042  0.2693323  -0.21926492]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.05550313 -0.10420489 -0.29440042  0.2693323  -0.21926492]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.24966304  0.2640165  -0.03439397 -1.6126355  -1.0237963 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.24966304  0.2640165  -0.03439397 -1.6126355  -1.0237963 ]
  [FlaxMamba2] xBC (step) sample values: [ 1.2521778   0.6103421  -0.83137846 -1.5275873   0.6237635 ]
  [FlaxMamba2] dt (step) sample values: [1.995586   1.8971119  0.22303353 2.1049342  0.5411845 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [0.24076298 0.92738557 1.7096478  1.2521778  0.42401862]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.2476673   0.09312186 -0.1405161   0.22345582 -0.09861416]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.2508049   0.08932243 -0.16161901  0.2076172  -0.07830472]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.10975859  0.04665451 -0.07429351  0.11454628 -0.03762024]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.10975859  0.04665451 -0.07429351  0.11454628 -0.03762024]
  [FlaxMamba2] B (step) sample values: [-0.14887899 -0.26906392  0.03009094 -0.03121977 -0.06288254]
  [FlaxMamba2] C (step) sample values: [-0.01041707 -0.2730542  -0.13310798  0.06430425  0.22825134]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-1.8673339  -0.9793274  -1.6584101  -0.94076145 -0.4381494 ]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.02201083 0.03727061 0.00791086 0.081865   0.01510184]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.95973164 0.96415794 0.98696625 0.92587554 0.993405  ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.10975859  0.04665451 -0.07429351  0.11454628 -0.03762024]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.5967337e-04  6.5002544e-04 -7.2696013e-05  7.5423144e-05
  1.5191649e-04]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 3.5967337e-04  6.5002544e-04 -7.2696013e-05  7.5423144e-05
  1.5191649e-04]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 8.9070247e-04  2.4362921e-03 -2.5558405e-04 -2.9994044e-06
 -8.9412773e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-0.00098555  0.00045657 -0.00070682  0.00049801  0.0011046 ]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.08862284  0.03770809 -0.06002683  0.09195805 -0.02893346]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.08862284  0.03770809 -0.06002683  0.09195805 -0.02893346]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00968905  0.0056311   0.00101453 -0.02465001  0.00782875]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.29862934  0.16569531  0.02696702 -0.6064583   0.23521957]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.29862934  0.16569531  0.02696702 -0.6064583   0.23521957]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ -0.98350024  -0.9942821   -1.0730846   -1.2509044  -15.544778  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ -0.98350024  -0.9942821   -1.0730846   -1.2509044  -15.544778  ]
  [Layer 46] Output shape after mixer: (1, 1, 2048)
  [Layer 46] Output sample values after mixer: [ -0.98350024  -0.9942821   -1.0730846   -1.2509044  -15.544778  ]
  [Layer 46] Residual connection shape: (1, 1, 2048)
  [Layer 46] Residual connection sample values: [  4.006893  -9.983608 -27.059927  22.702065 -35.39354 ]
[Mamba2LMHeadModel] Processing layer 47/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [ 0.03845225 -0.09671952 -0.2518982   0.21392241 -0.31767917]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03845225 -0.09671952 -0.2518982   0.21392241 -0.31767917]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [ 0.03845225 -0.09671952 -0.2518982   0.21392241 -0.31767917]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-0.15274146  1.1242106  -0.5884412  -1.1951721  -0.9197254 ]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-0.15274146  1.1242106  -0.5884412  -1.1951721  -0.9197254 ]
  [FlaxMamba2] xBC (step) sample values: [-0.23225786 -1.9806023   0.15991858  0.93901503 -0.59374183]
  [FlaxMamba2] dt (step) sample values: [-0.62325305 -0.45199284  3.0954888   2.6406162   0.46483114]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [ 0.00613084  0.41813856  0.18091597 -0.23225786 -0.03127391]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [ 0.03270344  0.1402707   0.01456659 -0.13933878 -0.08202515]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [ 0.04980854  0.11536835 -0.20491584 -0.1427186  -0.0768486 ]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [ 0.02552437  0.06100795 -0.09199687 -0.06627578 -0.0369486 ]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [ 0.02552437  0.06100795 -0.09199687 -0.06627578 -0.0369486 ]
  [FlaxMamba2] B (step) sample values: [-0.19107649 -0.07818866 -0.264322   -0.2780111  -0.02712939]
  [FlaxMamba2] C (step) sample values: [ 0.6765346   0.11113013 -0.03803824 -0.27830788 -0.02174654]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [ -3.552239  -11.244981   -2.6866128  -3.193549   -3.1997924]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01205412 0.00969127 0.05560545 0.05009125 0.0184329 ]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.95808464 0.89675003 0.8612329  0.85217035 0.9427242 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [ 0.02552437  0.06100795 -0.09199687 -0.06627578 -0.0369486 ]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.8789239e-05 -2.4056606e-05 -8.1324972e-05 -8.5536747e-05
 -8.3470050e-06]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [-5.8789239e-05 -2.4056606e-05 -8.1324972e-05 -8.5536747e-05
 -8.3470050e-06]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [-3.0850974e-04 -1.3990188e-04 -7.0493133e-04 -4.5370674e-04
  9.9290977e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [ 7.8120320e-05 -6.0968858e-04 -4.9785641e-03 -9.2776201e-04
 -3.7587303e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [ 0.03616495  0.08564452 -0.1350455  -0.09462972 -0.05261451]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [ 0.03616495  0.08564452 -0.1350455  -0.09462972 -0.05261451]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [-0.00255142  0.07267102  0.02836889  0.02627683  0.01379208]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [-0.07030759  1.2002463   0.76677513  0.7419125   0.37347525]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [-0.07030759  1.2002463   0.76677513  0.7419125   0.37347525]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [ -6.5584826    0.4591783    0.6891369    0.35796785 -13.397302  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [ -6.5584826    0.4591783    0.6891369    0.35796785 -13.397302  ]
  [Layer 47] Output shape after mixer: (1, 1, 2048)
  [Layer 47] Output sample values after mixer: [ -6.5584826    0.4591783    0.6891369    0.35796785 -13.397302  ]
  [Layer 47] Residual connection shape: (1, 1, 2048)
  [Layer 47] Residual connection sample values: [ -2.5515895  -9.52443   -26.37079    23.060032  -48.79084  ]
[Mamba2LMHeadModel] Processing layer 48/48
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.02361326 -0.08230446 -0.2227585   0.2009632  -0.40119323]
  [FlaxMamba2] __call__
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02361326 -0.08230446 -0.2227585   0.2009632  -0.40119323]
  [FlaxMamba2] Boolean Branch: True
  [FlaxMamba2] Step Mode: True
  [FlaxMamba2] step
  [FlaxMamba2] u shape: (1, 1, 2048)
  [FlaxMamba2] u sample values: [-0.02361326 -0.08230446 -0.2227585   0.2009632  -0.40119323]
[Mamba2] Performing single inference step.
  [FlaxMamba2] in_proj output shape: (1, 8512)
  [FlaxMamba2] in_proj output sample values: [-1.0297395 -1.3534526 -2.914347  -1.0372669 -0.4950742]
  [FlaxMamba2] Split shapes (step) -> z: (1, 4096), xBC: (1, 4352), dt: (1, 64)
  [FlaxMamba2] z (step) sample values: [-1.0297395 -1.3534526 -2.914347  -1.0372669 -0.4950742]
  [FlaxMamba2] xBC (step) sample values: [ 0.5054903   0.71485406 -0.00540612  0.9846316   0.9562839 ]
  [FlaxMamba2] dt (step) sample values: [-0.6590884   1.7657993  -0.24027206  2.0998704   1.3972692 ]
  [FlaxMamba2] conv_state updated shape: (1, 4352, 4)
  [FlaxMamba2] conv_state updated sample values: [-0.01763411  0.38660777 -0.18895857  0.5054903  -0.22492543]
[Mamba2] Using JAX for convolution and rearrange
  [FlaxMamba2] xBC after convolution sum shape: (1, 4352)
  [FlaxMamba2] xBC after convolution sum sample values: [-0.08268914  0.07477453 -0.0031081   0.17080303 -0.14545695]
  [FlaxMamba2] Added conv1d bias shape: (1, 4352)
  [FlaxMamba2] xBC after adding bias sample values: [-0.08786187  0.29474524 -0.08898457  0.10451885 -0.14790218]
  [FlaxMamba2] xBC after silu shape: (1, 4352)
  [FlaxMamba2] xBC after silu sample values: [-0.04200224  0.16893542 -0.04251403  0.05498799 -0.06849227]
  [FlaxMamba2] Split xBC -> x: (1, 4096), B: (1, 128), C: (1, 128)
  [FlaxMamba2] x (step) sample values: [-0.04200224  0.16893542 -0.04251403  0.05498799 -0.06849227]
  [FlaxMamba2] B (step) sample values: [-0.02700455  0.00972113  0.01088774 -0.00345635 -0.13227016]
  [FlaxMamba2] C (step) sample values: [-0.11652741 -0.27355435 -0.12522724 -0.1343823  -0.01187248]
  [FlaxMamba2] A shape: (64,)
  [FlaxMamba2] A sample values: [-54.81184   -78.514336  -47.25076    -2.330753   -4.2266355]
  [FlaxMamba2] dt after softplus (step) shape: (1, 64)
  [FlaxMamba2] dt after softplus (step) sample values: [0.01608238 0.05048338 0.00319625 0.00890634 0.03006127]
  [FlaxMamba2] dA shape: (1, 64)
  [FlaxMamba2] dA sample values: [0.41415912 0.0189933  0.85982597 0.9794555  0.8806826 ]
[FlaxMamba2] Before rearrange, x shape: (1, 4096)
[FlaxMamba2] Using JAX for rearrange
  [FlaxMamba2] x after rearrange (step) shape: (1, 64, 64)
  [FlaxMamba2] x after rearrange (step) sample values: [-0.04200224  0.16893542 -0.04251403  0.05498799 -0.06849227]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.8241468e-05 -6.5665886e-06 -7.3546280e-06  2.3347511e-06
  8.9347988e-05]
  [FlaxMamba2] dBx shape: (1, 64, 64, 128)
  [FlaxMamba2] dBx sample values: [ 1.8241468e-05 -6.5665886e-06 -7.3546280e-06  2.3347511e-06
  8.9347988e-05]
  [FlaxMamba2] ssm_state updated shape: (1, 64, 64, 128)
  [FlaxMamba2] ssm_state updated sample values: [ 6.0639468e-07 -1.4472451e-05  2.3123166e-06  1.2462858e-06
  8.0413061e-05]
  [FlaxMamba2] y after einsum shape: (1, 64, 64)
  [FlaxMamba2] y after einsum sample values: [-1.02264654e-04  9.30183451e-04 -3.07811686e-04 -8.00902417e-05
 -2.23402923e-04]
  [FlaxMamba2] y after adding D scaling (step) shape: (1, 64, 64)
  [FlaxMamba2] y after adding D scaling (step) sample values: [-0.03354565  0.13544141 -0.0341587   0.04370292 -0.05475891]
  [FlaxMamba2] y after rearrange to (b, d_inner) shape: (1, 4096)
  [FlaxMamba2] y after rearrange to (b, d_inner) sample values: [-0.03354565  0.13544141 -0.0341587   0.04370292 -0.05475891]
[FlaxRMSNorm] x after gated scaling shape: (1, 4096)
[FlaxRMSNorm] x after gated scaling sample values: [ 0.00908953 -0.03763546  0.00512175 -0.01186227  0.01026642]
[FlaxRMSNorm] x_normalized shape: (1, 4096)
[FlaxRMSNorm] x_normalized sample values: [ 0.31595498 -1.0721378   0.15099443 -0.40072596  0.3860953 ]
  [FlaxMamba2] y after RMSNorm (step) shape: (1, 4096)
  [FlaxMamba2] y after RMSNorm (step) sample values: [ 0.31595498 -1.0721378   0.15099443 -0.40072596  0.3860953 ]
  [FlaxMamba2] y after out_proj (step) shape: (1, 2048)
  [FlaxMamba2] y after out_proj (step) sample values: [-12.404845    -1.6106412   -0.74615425   7.2448397  -10.907659  ]
  [FlaxMamba2] y after expand_dims (step) shape: (1, 1, 2048)
  [FlaxMamba2] y after expand_dims (step) sample values: [-12.404845    -1.6106412   -0.74615425   7.2448397  -10.907659  ]
  [Layer 48] Output shape after mixer: (1, 1, 2048)
  [Layer 48] Output sample values after mixer: [-12.404845    -1.6106412   -0.74615425   7.2448397  -10.907659  ]
  [Layer 48] Residual connection shape: (1, 1, 2048)
  [Layer 48] Residual connection sample values: [-14.956434 -11.135072 -27.116945  30.30487  -59.698498]
[FlaxRMSNorm] x_normalized shape: (1, 1, 2048)
[FlaxRMSNorm] x_normalized sample values: [-0.13976756 -0.11509197 -0.2580712   0.29411924 -0.5525029 ]
[Mamba2LMHeadModel] Final backbone norm output shape: (1, 1, 2048)
[Mamba2LMHeadModel] Final backbone norm output sample values: [-0.13976756 -0.11509197 -0.2580712   0.29411924 -0.5525029 ]
[Mamba2LMHeadModel] Using JAX for lm_head
[Mamba2LMHeadModel] Logits shape: (1, 1, 50288)
[Mamba2LMHeadModel] Logits sample values: [  2.6918545  -24.166094    -1.0432553    0.84299445  -4.4663286 ]


---
Prompt eval | tokens: 10 | elapsed: 30.47s | tok/s: 0.33
Generation | tokens: 1 | elapsed: 3.04s | tok/s: 0.33
