[Mamba.from_pretrained] Loading pretrained model: state-spaces/mamba-370m
[ModelArgs] Initialized with d_model=1024, n_layer=48, vocab_size=50280, d_state=16, expand=2, dt_rank=64, d_conv=4, pad_vocab_size_multiple=8, conv_bias=True, bias=False
[ModelArgs] Calculated d_inner=2048
[Mamba] Initializing Mamba model.
  [Mamba] Initialized embedding with vocab_size=50280 and d_model=1024
  [Mamba] Initialized 48 ResidualBlocks.
  [Mamba] Initialized final RMSNorm with d_model=1024
[Mamba.__call__] Input_ids shape: (1, 5)
[Mamba.__call__] Input_ids sample values: [25521   752   310   634  1416]
[Mamba.__call__] Embedding output shape: (1, 5, 1024)
[Mamba.__call__] Embedding output sample values: [-0.03978607 -0.08408231  0.02325424 -0.03798054  0.02184616]
[Mamba.__call__] Processing layer 1/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.03978607 -0.08408231  0.02325424 -0.03798054  0.02184616]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.03978607 -0.08408231  0.02325424 -0.03798054  0.02184616]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.2615159  -2.666038    0.73733324 -1.2042671   0.69268656]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.2615159  -2.666038    0.73733324 -1.2042671   0.69268656]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.2615159  -2.666038    0.73733324 -1.2042671   0.69268656]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.09482127 -0.48400176  0.11212018  0.13971046  0.3264774 ]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.09482127 -0.48400176  0.11212018  0.13971046  0.3264774 ]
  [MambaBlock.__call__] res sample values: [ 0.01380378 -0.07988094  0.24600133  0.00255419  0.09714217]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.0223682  -0.04656967 -0.00336833 -0.0206619   0.05107806]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.01130918 -0.02274275 -0.00168133 -0.01022422  0.02619113]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.13586621 -0.11430129 -0.04658331 -0.05821872 -0.06136917]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.13586621 -0.11430129 -0.04658331 -0.05821872 -0.06136917]
  [MambaBlock.ssm] B sample values: [-0.06349304  0.01382145  0.00345095 -0.08669232 -0.05076551]
  [MambaBlock.ssm] C sample values: [ 0.0393684   0.12057419 -0.00066301  0.04282219 -0.09307379]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.68507123 0.7651325  0.61443716 0.6608986  0.6091953 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.5040543  0.25407076 0.12806547 0.06455195 0.03253769]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-4.9191824e-04  1.0708300e-04  2.6736516e-05 -6.7165674e-04
 -3.9331045e-04]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-4.9191824e-04  1.0708300e-04  2.6736516e-05 -6.7165674e-04
 -3.9331045e-04]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-1.3770793e-04  3.0929418e-04  1.8362100e-05  1.2010400e-04
 -2.8359785e-04]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00058952 -0.00010275 -0.00076142 -0.00021396  0.00092574]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.00015876 -0.00124302 -0.00098092  0.00047408 -0.00185601]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.0021135   0.00060001  0.00210404  0.01171949  0.00313385]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00389289 -0.01781634 -0.00879684 -0.00428136 -0.00661951]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00150006  0.00050214  0.00056022  0.00163081 -0.00010632]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.00082075  0.01345976  0.00464086 -0.00979462  0.00489501]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.00148359 -0.01041787  0.00028447 -0.02818502 -0.0110689 ]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.00546774  0.00660538  0.00269363  0.00501943 -0.00250549]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-1.3770793e-04  3.0929418e-04  1.8362100e-05  1.2010400e-04
 -2.8359785e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.01117147 -0.02243346 -0.00166297 -0.01010412  0.02590753]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.01117147 -0.02243346 -0.00166297 -0.01010412  0.02590753]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.01117147 -0.02243346 -0.00166297 -0.01010412  0.02590753]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 7.7636410e-05  8.6023507e-04 -2.2957921e-04 -1.2920417e-05
  1.3194284e-03]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00395255  0.0028364  -0.0036329   0.00577614  0.00160483]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04373862 -0.08124591  0.01962134 -0.0322044   0.02345099]
  [Mamba.__call__] After layer 1 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 1 sample values: [-0.04373862 -0.08124591  0.01962134 -0.0322044   0.02345099]
[Mamba.__call__] Processing layer 2/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04373862 -0.08124591  0.01962134 -0.0322044   0.02345099]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04373862 -0.08124591  0.01962134 -0.0322044   0.02345099]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.3491731 -2.5061328  0.605245  -0.9933854  0.7233753]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.3491731 -2.5061328  0.605245  -0.9933854  0.7233753]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.3491731 -2.5061328  0.605245  -0.9933854  0.7233753]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.00166409  0.0295524  -0.11823002 -0.28369525  0.36612123]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.00166409  0.0295524  -0.11823002 -0.28369525  0.36612123]
  [MambaBlock.__call__] res sample values: [ 0.09723388 -0.14522609  0.3847576   0.27047247 -0.03731527]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.00012357  0.00683978  0.10353835  0.08250213 -0.08296439]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-6.1783583e-05  3.4315838e-03  5.4446831e-02  4.2951755e-02
 -3.9762411e-02]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [0.07862964 0.04484733 0.04723507 0.02004743 0.04846166]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [0.07862964 0.04484733 0.04723507 0.02004743 0.04846166]
  [MambaBlock.ssm] B sample values: [-0.02902154 -0.07653773  0.07279028 -0.01009122 -0.21397851]
  [MambaBlock.ssm] C sample values: [-0.10269926  0.03546155 -0.00156749 -0.0591918   0.15205926]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.69280976 0.7413339  0.72070277 0.7181953  0.6768172 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.50016874 0.25016877 0.1251266  0.06258442 0.03130277]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 1.2422456e-06  3.2761416e-06 -3.1157347e-06  4.3194751e-07
  9.1591937e-06]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 1.2422456e-06  3.2761416e-06 -3.1157347e-06  4.3194751e-07
  9.1591937e-06]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 3.4151851e-06 -2.0297177e-04 -3.1308043e-03 -2.4612213e-03
  2.1471938e-03]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-3.6044967e-05 -5.9448579e-05 -7.6029566e-05  2.0721662e-04
  2.7934471e-04]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.00010684 -0.00017124 -0.00869722 -0.00857502  0.00579971]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-9.901178e-04 -8.253442e-05 -2.957394e-03 -8.611350e-04  9.541154e-05]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00126582  0.00225065 -0.01123101 -0.00427108  0.01848608]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00514631  0.00266825 -0.0047808   0.00250679  0.00020633]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 1.3146341e-04 -9.7650940e-05  1.3507414e-03  4.0619969e-04
 -1.3942887e-03]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.00735769  0.00994336 -0.01502719 -0.00774633 -0.010471  ]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [0.0054226  0.0028749  0.00788518 0.00621317 0.00064469]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 3.4151851e-06 -2.0297177e-04 -3.1308043e-03 -2.4612213e-03
  2.1471938e-03]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-5.8368398e-05  3.2286120e-03  5.1316027e-02  4.0490534e-02
 -3.7615217e-02]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-5.8368398e-05  3.2286120e-03  5.1316027e-02  4.0490534e-02
 -3.7615217e-02]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-5.8368398e-05  3.2286120e-03  5.1316027e-02  4.0490534e-02
 -3.7615217e-02]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-2.9755442e-06 -2.1744586e-04  1.1748213e-02  6.2118303e-03
  6.8871840e-04]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.00281493 -0.00328969 -0.00401421  0.00830248  0.00579955]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04092369 -0.0845356   0.01560713 -0.02390192  0.02925054]
  [Mamba.__call__] After layer 2 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 2 sample values: [-0.04092369 -0.0845356   0.01560713 -0.02390192  0.02925054]
[Mamba.__call__] Processing layer 3/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04092369 -0.0845356   0.01560713 -0.02390192  0.02925054]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04092369 -0.0845356   0.01560713 -0.02390192  0.02925054]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.2434554  -2.5685918   0.47421852 -0.7262535   0.8887698 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.2434554  -2.5685918   0.47421852 -0.7262535   0.8887698 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.2434554  -2.5685918   0.47421852 -0.7262535   0.8887698 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [0.19771563 0.12203491 0.35712326 0.16767952 0.1818518 ]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [0.19771563 0.12203491 0.35712326 0.16767952 0.1818518 ]
  [MambaBlock.__call__] res sample values: [-0.3458647   0.23218873 -0.14455016 -0.0091801  -0.13169652]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.08530029 -0.09176757 -0.01622201 -0.02164334 -0.06471651]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.04446808 -0.04377994 -0.00804522 -0.01070456 -0.03131156]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.04299183 -0.12736845 -0.01438215  0.08609438  0.05576938]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.04299183 -0.12736845 -0.01438215  0.08609438  0.05576938]
  [MambaBlock.ssm] B sample values: [-0.03585284  0.11124619  0.05308149 -0.085354   -0.00531178]
  [MambaBlock.ssm] C sample values: [-0.00817714 -0.13858579 -0.06182273  0.03916122 -0.10993523]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.7114593  0.60658777 0.7471973  0.6314997  0.70159465]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.49092728 0.2410096  0.11831817 0.05808562 0.02851582]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00113428  0.00351952  0.00167935 -0.00270036 -0.00016805]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00113428  0.00351952  0.00167935 -0.00270036 -0.00016805]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-2.0166775e-04  1.6928047e-04  3.8318743e-05  4.3090367e-05
  1.4003251e-04]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00483367  0.00111123 -0.00113041 -0.00364126  0.00378685]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.00059931  0.0015112  -0.00038408  0.00119778  0.00115817]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-2.3425680e-03  4.9071631e-04 -9.7622789e-05 -3.5642507e-04
  2.3463792e-04]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.0002368  -0.02520143 -0.00160404  0.00225752  0.00324555]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.01147125 -0.00847356 -0.00329895 -0.00460019  0.00048044]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [0.0122198  0.04333855 0.01968447 0.01843385 0.01840119]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 5.3555290e-03 -1.6390544e-03 -8.0523940e-05  8.6602857e-05
  1.2246610e-04]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-9.4413381e-06  1.3233865e-02  2.1011041e-02  1.4356416e-02
 -4.8970718e-02]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-2.0166775e-04  1.6928047e-04  3.8318743e-05  4.3090367e-05
  1.4003251e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.04426641 -0.04361066 -0.0080069  -0.01066147 -0.03117153]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.04426641 -0.04361066 -0.0080069  -0.01066147 -0.03117153]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.04426641 -0.04361066 -0.0080069  -0.01066147 -0.03117153]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-6.3443216e-03 -5.6481059e-03  5.3694652e-04  4.8712071e-05
  1.9176266e-03]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.00640465 -0.00456059  0.00257809 -0.00719549  0.00260378]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.03451904 -0.08909619  0.01818522 -0.03109741  0.03185432]
  [Mamba.__call__] After layer 3 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 3 sample values: [-0.03451904 -0.08909619  0.01818522 -0.03109741  0.03185432]
[Mamba.__call__] Processing layer 4/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.03451904 -0.08909619  0.01818522 -0.03109741  0.03185432]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.03451904 -0.08909619  0.01818522 -0.03109741  0.03185432]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.033504   -2.6675503   0.5444677  -0.9310602   0.95372206]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.033504   -2.6675503   0.5444677  -0.9310602   0.95372206]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.033504   -2.6675503   0.5444677  -0.9310602   0.95372206]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.21657547  0.5160088   0.45718756 -0.05151408  0.164511  ]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.21657547  0.5160088   0.45718756 -0.05151408  0.164511  ]
  [MambaBlock.__call__] res sample values: [-0.09236357  0.31526095  0.04577268 -0.19569325  0.562624  ]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.00860681  0.09301496 -0.03294222 -0.02581222 -0.04907152]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.00428489  0.04866887 -0.01619984 -0.01273955 -0.02393388]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.06510866  0.08102047  0.06645006 -0.03080671  0.00705722]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.06510866  0.08102047  0.06645006 -0.03080671  0.00705722]
  [MambaBlock.ssm] B sample values: [-0.10372958  0.03321644 -0.11728856 -0.05603494  0.06062675]
  [MambaBlock.ssm] C sample values: [ 0.09269827 -0.06981669 -0.0318528  -0.03900168 -0.2153579 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.70305336 0.6685946  0.7228935  0.57331854 0.684771  ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.49507135 0.24509566 0.12133986 0.06007188 0.02973986]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00031249 -0.00010006  0.00035333  0.00016881 -0.00018264]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00031249 -0.00010006  0.00035333  0.00016881 -0.00018264]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-1.2077484e-05  1.3045581e-04 -4.6949848e-05 -2.9281913e-05
 -6.5706394e-05]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 5.5865862e-04 -8.7421440e-06  4.4600127e-04  3.3161326e-05
 -6.7341106e-04]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.00028856 -0.00114221 -0.00312619  0.00052542 -0.00089679]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00580156  0.01012634  0.00046154 -0.00323334  0.00082038]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00225838  0.00111651 -0.00460425 -0.00228388  0.0049154 ]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00697714 -0.00365103  0.00580194  0.00508152  0.00816438]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.00189447 -0.0033893  -0.00666313  0.00357083  0.01046363]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.00943432 -0.02007262  0.03343267 -0.02295569 -0.01341286]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.01286595 -0.00352312  0.00291574 -0.00013924  0.00114221]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-1.2077484e-05  1.3045581e-04 -4.6949848e-05 -2.9281913e-05
 -6.5706394e-05]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.00429696  0.04879932 -0.01624679 -0.01276883 -0.02399959]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.00429696  0.04879932 -0.01624679 -0.01276883 -0.02399959]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.00429696  0.04879932 -0.01624679 -0.01276883 -0.02399959]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.00018928  0.00889485 -0.00038034  0.00112753 -0.00860205]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00515171  0.0017719   0.00154678 -0.00931019  0.00952754]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.03967074 -0.08732429  0.019732   -0.04040761  0.04138187]
  [Mamba.__call__] After layer 4 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 4 sample values: [-0.03967074 -0.08732429  0.019732   -0.04040761  0.04138187]
[Mamba.__call__] Processing layer 5/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.03967074 -0.08732429  0.019732   -0.04040761  0.04138187]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.03967074 -0.08732429  0.019732   -0.04040761  0.04138187]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.1704335 -2.5763893  0.582167  -1.1921737  1.220918 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.1704335 -2.5763893  0.582167  -1.1921737  1.220918 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.1704335 -2.5763893  0.582167  -1.1921737  1.220918 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.20533657 -0.10013819  0.17174383  0.49447718  0.06798875]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.20533657 -0.10013819  0.17174383  0.49447718  0.06798875]
  [MambaBlock.__call__] res sample values: [0.33581305 0.33811492 0.26768672 0.32640857 0.4860643 ]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.07904129  0.00368998 -0.09704024 -0.4543179  -0.0589507 ]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.03795957  0.0018484  -0.04616776 -0.1764274  -0.02860681]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.12683614 -0.02695709  0.00707346 -0.02488951  0.08304458]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.12683614 -0.02695709  0.00707346 -0.02488951  0.08304458]
  [MambaBlock.ssm] B sample values: [-0.11725625  0.12959193 -0.01668728 -0.18272558 -0.04372574]
  [MambaBlock.ssm] C sample values: [-0.100497   -0.07313721 -0.05505522 -0.14769867 -0.00577677]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.74742055 0.73703384 0.6447677  0.7060966  0.65713674]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.47358656 0.22428425 0.106218   0.05030342 0.02382302]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00332677 -0.00367675  0.00047345  0.00518425  0.00124058]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00332677 -0.00367675  0.00047345  0.00518425  0.00124058]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-1.9944792e-04  9.5769137e-06 -2.0925954e-04 -8.7573630e-04
 -1.3215032e-04]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00829433  0.00665713 -0.01516965 -0.01911891 -0.01507984]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.00557006  0.0004458  -0.00306582  0.00310445 -0.00226006]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00648237  0.01421557 -0.00849793 -0.00751765  0.00802951]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 1.4365659e-03  4.8933103e-04  6.1991764e-06  2.5187145e-04
 -4.3897647e-03]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.01832076 -0.01119458 -0.00113328  0.00203526 -0.02847378]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.0012     -0.00077023 -0.00134006  0.00949758  0.00043616]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.01068919  0.00407942  0.01001822  0.00893211  0.01187101]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.01558411  0.00492273 -0.02479639  0.03622001 -0.02384626]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-1.9944792e-04  9.5769137e-06 -2.0925954e-04 -8.7573630e-04
 -1.3215032e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.03815902  0.00185797 -0.04637702 -0.17730314 -0.02873896]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.03815902  0.00185797 -0.04637702 -0.17730314 -0.02873896]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.03815902  0.00185797 -0.04637702 -0.17730314 -0.02873896]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.00747295  0.00036671 -0.00703313 -0.03361772 -0.0086493 ]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.00231639  0.00718027  0.0023435   0.00540317 -0.00629859]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.03735435 -0.08014402  0.0220755  -0.03500443  0.03508328]
  [Mamba.__call__] After layer 5 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 5 sample values: [-0.03735435 -0.08014402  0.0220755  -0.03500443  0.03508328]
[Mamba.__call__] Processing layer 6/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.03735435 -0.08014402  0.0220755  -0.03500443  0.03508328]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.03735435 -0.08014402  0.0220755  -0.03500443  0.03508328]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.0795313  -2.3161418   0.63797647 -1.0116191   1.0138978 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.0795313  -2.3161418   0.63797647 -1.0116191   1.0138978 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.0795313  -2.3161418   0.63797647 -1.0116191   1.0138978 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [0.08682365 0.9294107  0.05524257 0.05093481 0.09056904]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [0.08682365 0.9294107  0.05524257 0.05093481 0.09056904]
  [MambaBlock.__call__] res sample values: [-0.416278    0.56522113 -0.13903628  0.0046026  -0.3598704 ]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.05700865  0.43593433 -0.01781835  0.01676961  0.01048809]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.02769205  0.2647385  -0.0088298   0.00845511  0.00527154]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.07034594  0.07025717 -0.15767007 -0.00654315  0.06293428]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.07034594  0.07025717 -0.15767007 -0.00654315  0.06293428]
  [MambaBlock.ssm] B sample values: [ 0.01351595  0.00503743 -0.03700179 -0.00097632 -0.05966477]
  [MambaBlock.ssm] C sample values: [-0.08838075  0.01183161  0.03500378  0.14417082  0.17257974]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.70080847 0.7505855  0.72532827 0.7335137  0.683248  ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.496184   0.24619855 0.12215979 0.06061373 0.03007556]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-2.6230162e-04 -9.7760421e-05  7.1808725e-04  1.8947205e-05
  1.1579037e-03]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-2.6230162e-04 -9.7760421e-05  7.1808725e-04  1.8947205e-05
  1.1579037e-03]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.00055563 -0.00568912  0.00018336 -0.00017756 -0.00010312]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00361219  0.00810672 -0.01557061  0.00552428  0.00318748]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.00658785 -0.00672349 -0.0027011  -0.00205089  0.00058104]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.02602679  0.00940425  0.01971941 -0.00313949 -0.00539516]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00455864 -0.00260033  0.00196015 -0.00057952 -0.00274652]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.03024718 -0.06076296 -0.05629735 -0.01082067  0.0277118 ]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.01279271 -0.01146385 -0.00243334  0.00705138 -0.00163079]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.00219599 -0.0267697  -0.01075749  0.0069835  -0.01306612]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.00314108 -0.00973621  0.00996157  0.00672514  0.00939381]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.00055563 -0.00568912  0.00018336 -0.00017756 -0.00010312]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.02713643  0.2590494  -0.00864644  0.00827754  0.00516842]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.02713643  0.2590494  -0.00864644  0.00827754  0.00516842]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.02713643  0.2590494  -0.00864644  0.00827754  0.00516842]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 4.4892360e-03  9.3366265e-02  5.5936544e-04  1.9092928e-05
 -7.6442788e-04]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.00502773  0.01311005  0.0003998  -0.00635375  0.00626586]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.03232663 -0.06703397  0.02247531 -0.04135818  0.04134914]
  [Mamba.__call__] After layer 6 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 6 sample values: [-0.03232663 -0.06703397  0.02247531 -0.04135818  0.04134914]
[Mamba.__call__] Processing layer 7/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.03232663 -0.06703397  0.02247531 -0.04135818  0.04134914]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.03232663 -0.06703397  0.02247531 -0.04135818  0.04134914]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.92556703 -1.919298    0.64350677 -1.1841561   1.183897  ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.92556703 -1.919298    0.64350677 -1.1841561   1.183897  ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.92556703 -1.919298    0.64350677 -1.1841561   1.183897  ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.17020704  0.24369407  0.15994963 -0.56138813 -0.23961446]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.17020704  0.24369407  0.15994963 -0.56138813 -0.23961446]
  [MambaBlock.__call__] res sample values: [-0.08666913 -0.23241284  0.19389999 -0.23465541 -0.19997863]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.04619349 -0.15343644  0.08926522  0.1737396   0.07254136]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.02363011 -0.07084405  0.04662336  0.09439723  0.03758567]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.01324305  0.14714363 -0.0522677   0.17563272 -0.00954874]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.01324305  0.14714363 -0.0522677   0.17563272 -0.00954874]
  [MambaBlock.ssm] B sample values: [-0.02960866 -0.09318082 -0.04013736  0.05650476 -0.12253953]
  [MambaBlock.ssm] C sample values: [ 0.10265148 -0.05980661  0.15007462 -0.0443895   0.0481122 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.72001565 0.745674   0.70064986 0.70337266 0.7370441 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.48674464 0.23692034 0.11531969 0.05613125 0.02732159]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00050376 -0.00158538 -0.0006829   0.00096137 -0.00208489]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00050376 -0.00158538 -0.0006829   0.00096137 -0.00208489]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-7.6087454e-05  2.3624235e-04 -1.4608642e-04 -2.9692729e-04
 -1.2388565e-04]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00262474  0.00233789  0.00551361 -0.00371447  0.00890028]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [0.00226697 0.00570505 0.00129979 0.00489836 0.00048657]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00565281  0.00217688  0.00518168  0.00026007 -0.00771544]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00368907 -0.00934384  0.00561393 -0.0023345   0.01134524]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00536273  0.00101967  0.01437229  0.01112054 -0.01560663]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [0.00433638 0.02654633 0.02233998 0.00200886 0.00952638]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.00682903  0.00012847  0.00550391 -0.00508903  0.02276119]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 7.2979362e-04  4.6662090e-04 -2.0667010e-03 -5.8394676e-04
  8.6897235e-05]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-7.6087454e-05  2.3624235e-04 -1.4608642e-04 -2.9692729e-04
 -1.2388565e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.02355402 -0.07060781  0.04647727  0.0941003   0.03746178]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.02355402 -0.07060781  0.04647727  0.0941003   0.03746178]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.02355402 -0.07060781  0.04647727  0.0941003   0.03746178]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.0009765   0.00725587  0.00494146 -0.00975112 -0.00337248]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00591635  0.00590731  0.00285994  0.00811273  0.00320349]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.03824297 -0.06112665  0.02533524 -0.03324545  0.04455263]
  [Mamba.__call__] After layer 7 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 7 sample values: [-0.03824297 -0.06112665  0.02533524 -0.03324545  0.04455263]
[Mamba.__call__] Processing layer 8/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.03824297 -0.06112665  0.02533524 -0.03324545  0.04455263]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.03824297 -0.06112665  0.02533524 -0.03324545  0.04455263]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.0846002 -1.7335991  0.718527  -0.9428666  1.263547 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.0846002 -1.7335991  0.718527  -0.9428666  1.263547 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.0846002 -1.7335991  0.718527  -0.9428666  1.263547 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.04379154 -0.12355824  0.16290739 -0.005418   -0.23142378]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.04379154 -0.12355824  0.16290739 -0.005418   -0.23142378]
  [MambaBlock.__call__] res sample values: [-0.4422012   0.15678532 -0.25027806 -0.6506639   0.19449325]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.02715447  0.03083782 -0.0072509   0.00066954  0.08624193]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.01339291  0.01565663 -0.0036123   0.00033488  0.04497923]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.00752626  0.02870088 -0.12406515 -0.07266307  0.15453617]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.00752626  0.02870088 -0.12406515 -0.07266307  0.15453617]
  [MambaBlock.ssm] B sample values: [-0.0254619  -0.02736342  0.0367227   0.05274818  0.02456343]
  [MambaBlock.ssm] C sample values: [0.16107246 0.12480117 0.10697103 0.0527439  0.04819416]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.668745   0.74282974 0.7210812  0.69294214 0.6468995 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.51235116 0.26250374 0.13449411 0.06890821 0.0353052 ]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00022805  0.00024508 -0.0003289  -0.00047244 -0.00022   ]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00022805  0.00024508 -0.0003289  -0.00047244 -0.00022   ]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-4.5964597e-07  5.9685033e-07 -1.3367584e-07  1.1909051e-08
  1.4932721e-06]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.01519678  0.00844029  0.00603676 -0.0107414   0.01640053]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-2.8634460e-03  7.1503653e-04  9.2580926e-04 -7.0873235e-04
 -1.6439410e-05]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.02328109 -0.01058121  0.06293017 -0.03822481 -0.0141273 ]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.02506646  0.00033318 -0.00508396 -0.01514638  0.00141548]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.02398571 -0.02403482 -0.01379278  0.03270324  0.06408075]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 1.9486814e-03  6.9796297e-05  1.5481593e-04  1.2617746e-03
 -1.2210148e-04]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.00465777 -0.00985221  0.00356419 -0.02405399 -0.00362198]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 9.9601355e-05 -7.9781062e-04  4.3276055e-03 -3.7633609e-03
 -4.3327309e-04]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-4.5964597e-07  5.9685033e-07 -1.3367584e-07  1.1909051e-08
  1.4932721e-06]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.01339337  0.01565723 -0.00361244  0.00033489  0.04498073]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.01339337  0.01565723 -0.00361244  0.00033489  0.04498073]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.01339337  0.01565723 -0.00361244  0.00033489  0.04498073]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 2.3170046e-03  1.3234355e-03  3.9578043e-04 -7.4706222e-05
  4.7982666e-03]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.0152053  -0.00515477 -0.01231934  0.00398217 -0.00123613]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.05344827 -0.06628143  0.01301591 -0.02926328  0.04331651]
  [Mamba.__call__] After layer 8 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 8 sample values: [-0.05344827 -0.06628143  0.01301591 -0.02926328  0.04331651]
[Mamba.__call__] Processing layer 9/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.05344827 -0.06628143  0.01301591 -0.02926328  0.04331651]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.05344827 -0.06628143  0.01301591 -0.02926328  0.04331651]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.4782045  -1.8331275   0.35997742 -0.8093266   1.1979928 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.4782045  -1.8331275   0.35997742 -0.8093266   1.1979928 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.4782045  -1.8331275   0.35997742 -0.8093266   1.1979928 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.10807968 -0.17166078  0.32517543  0.01263265 -0.04938221]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.10807968 -0.17166078  0.32517543  0.01263265 -0.04938221]
  [MambaBlock.__call__] res sample values: [ 0.19373268  0.35986334  0.17431536 -0.06908727  0.46912354]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.07304921 -0.01351106  0.165767    0.00610872  0.01760973]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.03519115 -0.00670989  0.08973749  0.00306369  0.00888239]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.00480901 -0.00607163  0.02088362  0.08406885 -0.0271595 ]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.00480901 -0.00607163  0.02088362  0.08406885 -0.0271595 ]
  [MambaBlock.ssm] B sample values: [0.0471184  0.10081267 0.03563314 0.25363037 0.05596528]
  [MambaBlock.ssm] C sample values: [ 0.04662988 -0.05511131  0.05479204  0.038596   -0.01489552]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.76288986 0.7458787  0.6974021  0.7089033  0.6856221 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.46631688 0.21745144 0.10140128 0.04728513 0.02204985]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00126499 -0.00270652 -0.00095664 -0.00680921 -0.0015025 ]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00126499 -0.00270652 -0.00095664 -0.00680921 -0.0015025 ]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-7.6344889e-04 -1.4232085e-04  1.7796801e-03  6.1761311e-05
  1.7318060e-04]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00289558 -0.0038153  -0.00321388 -0.00473972 -0.0007961 ]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.00130079 -0.0014968  -0.00416109  0.00246244 -0.00223674]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.01429102 -0.00522394  0.01532815 -0.00318587  0.00255466]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00376266  0.00430404  0.00185074  0.00605615 -0.00084727]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.01096251 -0.0017398   0.00988015 -0.01642798 -0.00662599]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00166927 -0.00152965 -0.0071995   0.00617519  0.00036459]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.00388804 -0.0012      0.00522009  0.01521352  0.0098116 ]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.0020961   0.00291507  0.00147413 -0.00076433  0.00255935]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-7.6344889e-04 -1.4232085e-04  1.7796801e-03  6.1761311e-05
  1.7318060e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.0359546  -0.00685221  0.09151717  0.00312545  0.00905557]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.0359546  -0.00685221  0.09151717  0.00312545  0.00905557]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.0359546  -0.00685221  0.09151717  0.00312545  0.00905557]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.0038191  -0.00145241  0.00866988 -0.00010424  0.00261338]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00356573 -0.01059911 -0.00183306 -0.00076791  0.00897291]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.057014   -0.07688054  0.01118285 -0.03003119  0.05228942]
  [Mamba.__call__] After layer 9 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 9 sample values: [-0.057014   -0.07688054  0.01118285 -0.03003119  0.05228942]
[Mamba.__call__] Processing layer 10/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.057014   -0.07688054  0.01118285 -0.03003119  0.05228942]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.057014   -0.07688054  0.01118285 -0.03003119  0.05228942]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.5611194  -2.1050918   0.30620125 -0.82229406  1.4317541 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.5611194  -2.1050918   0.30620125 -0.82229406  1.4317541 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.5611194  -2.1050918   0.30620125 -0.82229406  1.4317541 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.10243746 -0.6966463  -1.0300403  -0.12343882  0.0627531 ]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.10243746 -0.6966463  -1.0300403  -0.12343882  0.0627531 ]
  [MambaBlock.__call__] res sample values: [ 0.53142655  0.0628311  -0.02353944  0.20742963  0.19912131]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.0025874  -0.15011702  0.08262727 -0.0670189   0.02840547]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.00129203 -0.06943529  0.04301948 -0.03238699  0.01440444]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.06041938  0.02549949 -0.06705613  0.10463521 -0.01088727]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.06041938  0.02549949 -0.06705613  0.10463521 -0.01088727]
  [MambaBlock.ssm] B sample values: [ 0.05070117  0.08287409  0.03651378  0.11670175 -0.14650452]
  [MambaBlock.ssm] C sample values: [-0.03662506 -0.00430537  0.01620141 -0.02015522  0.07868937]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.6928142  0.69139683 0.6897214  0.6493773  0.6595    ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.50016654 0.25016657 0.12512493 0.0625833  0.03130208]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-4.5384368e-05 -7.4183459e-05 -3.2684744e-05 -1.0446377e-04
  1.3114125e-04]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-4.5384368e-05 -7.4183459e-05 -3.2684744e-05 -1.0446377e-04
  1.3114125e-04]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 4.4197604e-06  2.3703817e-04 -1.4650404e-04  1.0384318e-04
 -4.6905279e-05]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00033375  0.00010408 -0.00056168  0.00113743  0.00213873]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.00054644 -0.0180777  -0.00696065 -0.00613826 -0.00470472]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-1.0298047e-04  1.6150856e-04  5.0318849e-05  3.1405714e-04
  2.3229043e-04]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 1.1511564e-05 -1.9128373e-03  1.4168909e-03 -1.3886713e-03
  4.0189084e-03]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.02042931  0.00338742 -0.00255747 -0.02976724 -0.00268032]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.01944399 -0.04379865  0.00350576 -0.00516502 -0.00842483]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.00930206  0.00811438  0.0008543  -0.00520591  0.00014991]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.00469717 -0.00515558  0.00273442 -0.01358677 -0.00616199]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 4.4197604e-06  2.3703817e-04 -1.4650404e-04  1.0384318e-04
 -4.6905279e-05]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.00128761 -0.06919825  0.04287298 -0.03228315  0.01435753]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.00128761 -0.06919825  0.04287298 -0.03228315  0.01435753]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.00128761 -0.06919825  0.04287298 -0.03228315  0.01435753]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.00043096 -0.00224217 -0.00049866 -0.00369426  0.00157129]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.01326888 -0.00568453 -0.00640068  0.00505698 -0.01104361]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04374512 -0.08256508  0.00478217 -0.02497421  0.04124581]
  [Mamba.__call__] After layer 10 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 10 sample values: [-0.04374512 -0.08256508  0.00478217 -0.02497421  0.04124581]
[Mamba.__call__] Processing layer 11/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04374512 -0.08256508  0.00478217 -0.02497421  0.04124581]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04374512 -0.08256508  0.00478217 -0.02497421  0.04124581]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.170226   -2.2086987   0.12792787 -0.6680851   1.1033669 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.170226   -2.2086987   0.12792787 -0.6680851   1.1033669 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.170226   -2.2086987   0.12792787 -0.6680851   1.1033669 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.4231777   0.3997603   0.13515863 -0.4541407   0.24302694]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.4231777   0.3997603   0.13515863 -0.4541407   0.24302694]
  [MambaBlock.__call__] res sample values: [-0.36574882  0.1688019   0.36390996 -0.00417651  0.5011049 ]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.09912369  0.2124036  -0.00998269 -0.10106185 -0.10010736]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.05201621  0.11743841 -0.00496643 -0.04797972 -0.0475504 ]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.06680465 -0.0297321   0.02706416  0.0395608  -0.08892181]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.06680465 -0.0297321   0.02706416  0.0395608  -0.08892181]
  [MambaBlock.ssm] B sample values: [ 0.0558138   0.07933676 -0.04010054 -0.05134927  0.11569467]
  [MambaBlock.ssm] C sample values: [ 0.1123428   0.07193592  0.13878524 -0.11241485 -0.04147062]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.7140689  0.61455303 0.65980935 0.64803255 0.6882481 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.4896478  0.23975499 0.11739551 0.05748245 0.02814616]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.0020731   0.00294682 -0.00148946 -0.00190727  0.00429727]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.0020731   0.00294682 -0.00148946 -0.00190727  0.00429727]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 1.0514781e-03  2.0431057e-03 -9.2765018e-05 -8.8018901e-04
 -9.2644716e-04]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00175256 -0.00048524  0.00343729  0.00246591  0.00661852]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-2.9546773e-04  2.3145348e-04 -5.3349260e-05  3.4947388e-04
 -1.7992962e-04]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00810721  0.00115794 -0.0036492   0.00558668 -0.01001227]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00024264 -0.00063781  0.00022765 -0.00018176  0.00054388]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00160829  0.00404945 -0.00698293 -0.00043712 -0.00294865]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00126291 -0.00718034 -0.00147525 -0.0043964   0.00285446]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.01221148 -0.00838812 -0.01331952  0.00620298 -0.01347605]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.0122698   0.03078188 -0.01275671 -0.02324816 -0.00902267]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 1.0514781e-03  2.0431057e-03 -9.2765018e-05 -8.8018901e-04
 -9.2644716e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.05306769  0.11948151 -0.0050592  -0.04885991 -0.04847685]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.05306769  0.11948151 -0.0050592  -0.04885991 -0.04847685]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.05306769  0.11948151 -0.0050592  -0.04885991 -0.04847685]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.0079495   0.01093347 -0.00108622  0.00010182 -0.01512708]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00200063 -0.00391055 -0.00733987 -0.00257915 -0.00258315]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04574576 -0.08647563 -0.0025577  -0.02755336  0.03866266]
  [Mamba.__call__] After layer 11 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 11 sample values: [-0.04574576 -0.08647563 -0.0025577  -0.02755336  0.03866266]
[Mamba.__call__] Processing layer 12/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04574576 -0.08647563 -0.0025577  -0.02755336  0.03866266]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04574576 -0.08647563 -0.0025577  -0.02755336  0.03866266]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.2075664  -2.2827265  -0.06751647 -0.7273354   1.0205915 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.2075664  -2.2827265  -0.06751647 -0.7273354   1.0205915 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.2075664  -2.2827265  -0.06751647 -0.7273354   1.0205915 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.23481962 -0.22968408 -0.38083938  0.11796196  0.0269437 ]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.23481962 -0.22968408 -0.38083938  0.11796196  0.0269437 ]
  [MambaBlock.__call__] res sample values: [-0.51181835 -0.8384212  -0.20028731 -0.35293707 -0.23911542]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.09832548  0.02697901  0.00170765  0.02851642 -0.00610225]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.05157777  0.01367146  0.00085455  0.01446149 -0.00304181]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.00871789  0.19673535 -0.06828018 -0.05910097  0.03730059]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.00871789  0.19673535 -0.06828018 -0.05910097  0.03730059]
  [MambaBlock.ssm] B sample values: [-0.05202634 -0.00688522  0.03551039  0.01829488 -0.12109657]
  [MambaBlock.ssm] C sample values: [ 0.01081829 -0.12884128  0.10240667 -0.10172445  0.05570896]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.68645257 0.66261256 0.66113514 0.68473315 0.67221415]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.50335854 0.2533698  0.12753586 0.06419627 0.03231373]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00184203 -0.00024378  0.00125727  0.00064774 -0.00428751]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00184203 -0.00024378  0.00125727  0.00064774 -0.00428751]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 6.0129591e-04  1.5384718e-04  9.5950063e-06  1.6817036e-04
 -3.4726054e-05]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-6.4197427e-04 -3.0407534e-04 -3.5832243e-05 -1.2714354e-05
 -1.6479621e-04]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-4.6504781e-05  5.9226630e-05  9.6062507e-04 -4.0624445e-04
 -5.3493347e-04]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.0082017  -0.01003615 -0.00490647  0.00652157  0.02735323]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00085276 -0.00011025  0.00049219 -0.00027632 -0.00108058]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00199581 -0.02209281 -0.00281717  0.00296327  0.0147444 ]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.01146615 -0.00182859  0.00076878  0.01266842  0.0137211 ]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.00274221 -0.00864045 -0.00785135 -0.00390666 -0.00068087]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.01249811 -0.00893181  0.00639721 -0.01097429  0.01598271]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 6.0129591e-04  1.5384718e-04  9.5950063e-06  1.6817036e-04
 -3.4726054e-05]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.05217907  0.01382531  0.00086415  0.01462966 -0.00307654]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.05217907  0.01382531  0.00086415  0.01462966 -0.00307654]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.05217907  0.01382531  0.00086415  0.01462966 -0.00307654]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-1.0008614e-02 -3.4990746e-03 -7.7901648e-05 -2.1307617e-03
  3.2405628e-04]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.01032518  0.00424712  0.00797191 -0.00812848 -0.00366927]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.05607094 -0.0822285   0.00541421 -0.03568184  0.03499339]
  [Mamba.__call__] After layer 12 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 12 sample values: [-0.05607094 -0.0822285   0.00541421 -0.03568184  0.03499339]
[Mamba.__call__] Processing layer 13/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.05607094 -0.0822285   0.00541421 -0.03568184  0.03499339]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.05607094 -0.0822285   0.00541421 -0.03568184  0.03499339]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.4389347  -2.11021     0.13894345 -0.91569436  0.8980268 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.4389347  -2.11021     0.13894345 -0.91569436  0.8980268 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.4389347  -2.11021     0.13894345 -0.91569436  0.8980268 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.31792414  0.30456424  0.11801389 -0.16100357  0.07780342]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.31792414  0.30456424  0.11801389 -0.16100357  0.07780342]
  [MambaBlock.__call__] res sample values: [0.02293524 0.0642748  0.31053612 0.47691765 0.03588881]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.0179727   0.1226074   0.01411277  0.12590468 -0.02250071]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.0089056   0.06505714  0.00710617  0.06691011 -0.01112379]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.02165817  0.11578088  0.019368    0.04147079 -0.03113267]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.02165817  0.11578088  0.019368    0.04147079 -0.03113267]
  [MambaBlock.ssm] B sample values: [-0.02072384  0.00565862  0.02431749 -0.05691487  0.01931782]
  [MambaBlock.ssm] C sample values: [-0.01774063 -0.05857064 -0.11242229 -0.03934293 -0.1284593 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.6935167  0.70880306 0.59108245 0.73007536 0.6739207 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.4998153  0.24981533 0.12486152 0.06240769 0.03119232]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 1.27994164e-04 -3.49486691e-05 -1.50189240e-04  3.51516530e-04
 -1.19310374e-04]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 1.27994164e-04 -3.49486691e-05 -1.50189240e-04  3.51516530e-04
 -1.19310374e-04]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 4.3899410e-05 -3.2776254e-04 -2.9855384e-05 -3.4721475e-04
  5.3284439e-05]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00091026  0.01713272  0.00378542  0.00348421 -0.007486  ]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 5.0887046e-03  9.9141654e-03 -5.4559503e-05  9.4717089e-03
  3.7515993e-04]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00098836 -0.01197389  0.00184555  0.00978649  0.01623315]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00881524 -0.00215529 -0.00999735  0.00235325  0.006486  ]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00600703 -0.01595351 -0.00268692  0.0026786   0.00271356]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.01450709 -0.00636184  0.00628865 -0.02333639 -0.00065069]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.01074138  0.00175127 -0.00095283  0.01752955  0.00176169]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.00188973 -0.00145583  0.00538359  0.00890676  0.00821813]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 4.3899410e-05 -3.2776254e-04 -2.9855384e-05 -3.4721475e-04
  5.3284439e-05]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.0088617   0.06472937  0.00707632  0.0665629  -0.01107051]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.0088617   0.06472937  0.00707632  0.0665629  -0.01107051]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.0088617   0.06472937  0.00707632  0.0665629  -0.01107051]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.00010279  0.00214706  0.00126797  0.01958731 -0.00020222]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.00346237  0.00577142  0.0041006  -0.01074215 -0.00312422]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.05260857 -0.07645708  0.0095148  -0.046424    0.03186917]
  [Mamba.__call__] After layer 13 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 13 sample values: [-0.05260857 -0.07645708  0.0095148  -0.046424    0.03186917]
[Mamba.__call__] Processing layer 14/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.05260857 -0.07645708  0.0095148  -0.046424    0.03186917]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.05260857 -0.07645708  0.0095148  -0.046424    0.03186917]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.3379294  -1.9444393   0.24197835 -1.1806446   0.8104894 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.3379294  -1.9444393   0.24197835 -1.1806446   0.8104894 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.3379294  -1.9444393   0.24197835 -1.1806446   0.8104894 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.16080463 -0.23799662  0.22755827 -0.32321453  0.48767784]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.16080463 -0.23799662  0.22755827 -0.32321453  0.48767784]
  [MambaBlock.__call__] res sample values: [-0.3364393   0.15837061  0.33842802  0.56683254  0.01303285]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.13663928 -0.25243828 -0.02971341  0.12290276  0.38466787]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.07297996 -0.11037194 -0.014636    0.0652229   0.22887677]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.04562426 -0.05682843 -0.00386259 -0.06385363  0.06136521]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.04562426 -0.05682843 -0.00386259 -0.06385363  0.06136521]
  [MambaBlock.ssm] B sample values: [-0.02613129 -0.08346333 -0.1217664   0.02268762  0.01283429]
  [MambaBlock.ssm] C sample values: [-0.08691812  0.03774353  0.0701125  -0.11129554  0.07695531]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.6403414  0.7665718  0.6424209  0.69435966 0.7701128 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.5271124  0.27784753 0.14645688 0.07719924 0.04069269]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00122117 -0.00390042 -0.0056904   0.00106024  0.00059977]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00122117 -0.00390042 -0.0056904   0.00106024  0.00059977]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.00091398  0.00165474  0.00018389 -0.00088574 -0.00344727]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00462161 -0.00190204 -0.00436604  0.00514001  0.00180762]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.00197613  0.00013414  0.00108905 -0.0028064  -0.00288021]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00956942 -0.00740844  0.02509989  0.01513288  0.01050773]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-1.4311701e-04  5.5700936e-04  2.4743617e-04  1.1855322e-03
 -6.1460400e-05]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00773586  0.00195538  0.00806462  0.00892863 -0.00320425]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00115361  0.000808    0.00057872 -0.0005064  -0.00071809]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.120035   -0.03513504 -0.07548174 -0.05694496  0.00697152]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.06381301 -0.01068318 -0.00695348  0.01159308 -0.00444888]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.00091398  0.00165474  0.00018389 -0.00088574 -0.00344727]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.07206598 -0.1087172  -0.01445211  0.06433717  0.2254295 ]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.07206598 -0.1087172  -0.01445211  0.06433717  0.2254295 ]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.07206598 -0.1087172  -0.01445211  0.06433717  0.2254295 ]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.01010262 -0.00928907 -0.00285541  0.02326801  0.00147857]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00356519  0.0024532  -0.00975482  0.00961561 -0.00329826]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.05617376 -0.07400389 -0.00024001 -0.03680839  0.02857091]
  [Mamba.__call__] After layer 14 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 14 sample values: [-0.05617376 -0.07400389 -0.00024001 -0.03680839  0.02857091]
[Mamba.__call__] Processing layer 15/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.05617376 -0.07400389 -0.00024001 -0.03680839  0.02857091]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.05617376 -0.07400389 -0.00024001 -0.03680839  0.02857091]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.4123251  -1.8606116  -0.00603447 -0.92543936  0.71833205]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.4123251  -1.8606116  -0.00603447 -0.92543936  0.71833205]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.4123251  -1.8606116  -0.00603447 -0.92543936  0.71833205]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.00644187  0.66911364  0.1320438   0.44097033 -0.01943557]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.00644187  0.66911364  0.1320438   0.44097033 -0.01943557]
  [MambaBlock.__call__] res sample values: [-0.1965873   0.7518718  -0.29618844 -0.26051337 -0.7124487 ]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.00394367 -0.3075506   0.02637588  0.09852554  0.0042416 ]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.00196795 -0.1303131   0.01336185  0.05168763  0.0021253 ]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.0576722   0.04227985  0.11142374 -0.00747475  0.03767114]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.0576722   0.04227985  0.11142374 -0.00747475  0.03767114]
  [MambaBlock.ssm] B sample values: [ 0.06756856 -0.02399932 -0.03310709 -0.1470508   0.08541784]
  [MambaBlock.ssm] C sample values: [-0.03160492  0.01316512 -0.20357639  0.03469609 -0.0588181 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.7226711  0.6673319  0.7130348  0.63301647 0.7143019 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.48545384 0.23566543 0.11440468 0.05553819 0.02696123]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-9.6094584e-05  3.4131328e-05  4.7084206e-05  2.0913256e-04
 -1.2147946e-04]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-9.6094584e-05  3.4131328e-05  4.7084206e-05  2.0913256e-04
 -1.2147946e-04]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 4.0842468e-05  2.4973969e-03 -2.7361189e-04 -9.3963521e-04
 -4.3597269e-05]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.0040624  -0.00303783 -0.00351356 -0.00944779 -0.00042766]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 2.01947187e-04  1.33841299e-04  4.66651763e-05  1.18309756e-04
 -3.11112781e-05]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.0031293  -0.00290962 -0.00111407 -0.00216087 -0.00173973]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00014775 -0.00191061 -0.00042807 -0.00213959 -0.00076406]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00157216 -0.00346794  0.00259253  0.00204115 -0.00074082]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.00024669 -0.00815232 -0.00016426  0.00177157 -0.00486855]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.00506132 -0.00779838  0.00661178 -0.0009428   0.0034624 ]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.00323997  0.00926689 -0.00185582 -0.00307742  0.04259647]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 4.0842468e-05  2.4973969e-03 -2.7361189e-04 -9.3963521e-04
 -4.3597269e-05]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.00192711 -0.12781571  0.01308824  0.05074799  0.0020817 ]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.00192711 -0.12781571  0.01308824  0.05074799  0.0020817 ]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.00192711 -0.12781571  0.01308824  0.05074799  0.0020817 ]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.00017086 -0.06530896 -0.00165332 -0.00575407 -0.00048803]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00512248  0.00547784 -0.00161254 -0.01110234 -0.00262882]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.06129624 -0.06852604 -0.00185256 -0.04791073  0.02594209]
  [Mamba.__call__] After layer 15 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 15 sample values: [-0.06129624 -0.06852604 -0.00185256 -0.04791073  0.02594209]
[Mamba.__call__] Processing layer 16/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.06129624 -0.06852604 -0.00185256 -0.04791073  0.02594209]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.06129624 -0.06852604 -0.00185256 -0.04791073  0.02594209]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.5128206  -1.6912556  -0.04572202 -1.1824598   0.64026326]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.5128206  -1.6912556  -0.04572202 -1.1824598   0.64026326]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.5128206  -1.6912556  -0.04572202 -1.1824598   0.64026326]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.44764188  0.12622133  0.05304345  0.20617738  0.34284338]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.44764188  0.12622133  0.05304345  0.20617738  0.34284338]
  [MambaBlock.__call__] res sample values: [ 0.22741184  0.5150375  -0.24434589 -0.36385927 -0.19866721]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.07070157 -0.02070264  0.01688262  0.03299886 -0.14705469]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.03410163 -0.01024417  0.00851256  0.01677164 -0.0681308 ]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.04055984  0.00433984 -0.04438211  0.07349892 -0.01603585]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.04055984  0.00433984 -0.04438211  0.07349892 -0.01603585]
  [MambaBlock.ssm] B sample values: [ 0.04684082  0.10372899 -0.12770373  0.04765398 -0.19051209]
  [MambaBlock.ssm] C sample values: [-0.05415749 -0.1413957  -0.11195102 -0.13335082  0.08952383]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.6608266  0.77768993 0.7024509  0.6779707  0.73032385]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.5164243  0.26669404 0.13772728 0.0711257  0.03673104]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00105557 -0.00233756  0.00287784 -0.0010739   0.00429324]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00105557 -0.00233756  0.00287784 -0.0010739   0.00429324]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 2.5991455e-04  9.1886395e-05 -6.8967471e-05 -1.3114576e-04
  5.7388761e-04]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00835327 -0.01009479  0.00871944  0.00057237  0.00792534]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-3.8727201e-03  1.3424766e-03 -3.9848401e-05  3.7141799e-04
  7.6050468e-04]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 8.2295993e-04 -2.2611767e-03  4.4236802e-03 -2.6371330e-03
  2.2180335e-05]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00102133  0.0031103   0.00067196  0.00254001 -0.00938553]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.02587831 -0.01262755  0.01967215  0.00759779  0.00352188]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00188775 -0.00351673 -0.00072764  0.00135434  0.00852066]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.00960923 -0.00329888  0.00196452  0.00069164  0.00021474]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.00320695  0.00498401 -0.00170026  0.00268475 -0.01149203]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 2.5991455e-04  9.1886395e-05 -6.8967471e-05 -1.3114576e-04
  5.7388761e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.03384171 -0.01015229  0.0084436   0.01664049 -0.06755691]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.03384171 -0.01015229  0.0084436   0.01664049 -0.06755691]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.03384171 -0.01015229  0.0084436   0.01664049 -0.06755691]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.00428367 -0.00327316 -0.00090617 -0.00248262  0.00604626]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00464997 -0.00311453 -0.0041993   0.00451449 -0.0057312 ]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.06594621 -0.07164057 -0.00605186 -0.04339624  0.02021089]
  [Mamba.__call__] After layer 16 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 16 sample values: [-0.06594621 -0.07164057 -0.00605186 -0.04339624  0.02021089]
[Mamba.__call__] Processing layer 17/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.06594621 -0.07164057 -0.00605186 -0.04339624  0.02021089]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.06594621 -0.07164057 -0.00605186 -0.04339624  0.02021089]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.6175681  -1.757243   -0.14844367 -1.0644491   0.49574488]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.6175681  -1.757243   -0.14844367 -1.0644491   0.49574488]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.6175681  -1.757243   -0.14844367 -1.0644491   0.49574488]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.5227346   0.97812164 -0.3292787  -0.11003746 -0.34401113]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.5227346   0.97812164 -0.3292787  -0.11003746 -0.34401113]
  [MambaBlock.__call__] res sample values: [ 1.1167922   0.07301316 -0.27015537  0.10668045 -0.16801769]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.24825925  0.08877562  0.28729197 -0.03663283 -0.28075713]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.10880011  0.0463568   0.1641394  -0.01798096 -0.12080085]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.04288447 -0.04485431 -0.02705145  0.00236239 -0.01809597]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.04288447 -0.04485431 -0.02705145  0.00236239 -0.01809597]
  [MambaBlock.ssm] B sample values: [0.12406833 0.08831698 0.08793414 0.04067251 0.04465211]
  [MambaBlock.ssm] C sample values: [ 0.0687854  -0.00496803  0.06476603 -0.03303579  0.0773561 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.75753176 0.7239607  0.6375063  0.7874084  0.7321164 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.46882218 0.21979423 0.10304439 0.0483095  0.02264857]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.01022566 -0.00727904 -0.00724749 -0.00335221 -0.00368021]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.01022566 -0.00727904 -0.00724749 -0.00335221 -0.00368021]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 1.5096668e-04 -6.1472216e-05 -1.9166736e-04  2.5933636e-05
  1.6199466e-04]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.01929039 -0.01639746 -0.02625825  0.01913824  0.01118941]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-2.9015483e-04  1.2807315e-04  3.8090959e-04 -5.4192686e-05
 -3.3866134e-04]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.01016317  0.0045722  -0.00993288  0.00656849  0.00077945]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [0.0063141  0.00274109 0.01317213 0.00093097 0.01369061]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.0109853  -0.00695668 -0.02026776 -0.01225056  0.00327863]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.00037471  0.00167474 -0.0010799  -0.00022129  0.00100641]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.01194701 -0.03648868 -0.01039301  0.00073533  0.03947571]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.00791844 -0.01044824 -0.00248249  0.00349722 -0.01430906]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 1.5096668e-04 -6.1472216e-05 -1.9166736e-04  2.5933636e-05
  1.6199466e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.10864915  0.04629533  0.16394773 -0.01795503 -0.12063885]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.10864915  0.04629533  0.16394773 -0.01795503 -0.12063885]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.10864915  0.04629533  0.16394773 -0.01795503 -0.12063885]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.09141562  0.00175176 -0.01917236 -0.00100876  0.00928532]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.00981245  0.00114035 -0.01404961  0.0046779   0.01223395]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.05613375 -0.07050022 -0.02010147 -0.03871834  0.03244484]
  [Mamba.__call__] After layer 17 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 17 sample values: [-0.05613375 -0.07050022 -0.02010147 -0.03871834  0.03244484]
[Mamba.__call__] Processing layer 18/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.05613375 -0.07050022 -0.02010147 -0.03871834  0.03244484]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.05613375 -0.07050022 -0.02010147 -0.03871834  0.03244484]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.3567417  -1.7039763  -0.4858485  -0.9358145   0.78418535]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.3567417  -1.7039763  -0.4858485  -0.9358145   0.78418535]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.3567417  -1.7039763  -0.4858485  -0.9358145   0.78418535]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.04585707 -0.06889762  0.0234837   0.18647419 -0.34212652]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.04585707 -0.06889762  0.0234837   0.18647419 -0.34212652]
  [MambaBlock.__call__] res sample values: [-0.01008764 -0.06816748 -0.03807467 -0.25368088  0.23317786]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.02929245  0.01372978  0.00213766  0.08263978 -0.1912863 ]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.01486072  0.00691202  0.00106997  0.04302625 -0.08652333]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.10600261  0.05703798 -0.07024982  0.01004563 -0.1294704 ]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.10600261  0.05703798 -0.07024982  0.01004563 -0.1294704 ]
  [MambaBlock.ssm] B sample values: [-0.05029204 -0.05735239  0.05663411  0.03443901 -0.17851874]
  [MambaBlock.ssm] C sample values: [-0.04827313 -0.0994814  -0.02236481  0.08150301  0.09166688]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.62600964 0.6480082  0.6999865  0.68833816 0.7243198 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.53472126 0.28592685 0.15289117 0.08175416 0.04371569]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00046786 -0.00053355  0.00052686  0.00032038 -0.00166075]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00046786 -0.00053355  0.00052686  0.00032038 -0.00166075]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-1.3760389e-04 -6.6251399e-05 -1.1078266e-05 -4.3807167e-04
  9.2698657e-04]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00046783 -0.00100145  0.0025482   0.00012984 -0.00326821]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.00164659 -0.00195923  0.00011456 -0.00138901 -0.00440712]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.02241914  0.00634952  0.00400234 -0.00089158 -0.00406757]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00382199 -0.00937194  0.0004976  -0.00984376 -0.0013941 ]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.01077532  0.00959735 -0.00024987 -0.0049999   0.00369827]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00164029 -0.00377756  0.00028742 -0.00404709 -0.00041806]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-1.4174785e-02  1.6751215e-03 -4.1617321e-05  5.1832688e-04
  2.3140314e-04]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.00231601 -0.00480047 -0.00284036 -0.01660312  0.00204184]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-1.3760389e-04 -6.6251399e-05 -1.1078266e-05 -4.3807167e-04
  9.2698657e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.01472312  0.00684576  0.00105889  0.04258818 -0.08559635]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.01472312  0.00684576  0.00105889  0.04258818 -0.08559635]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.01472312  0.00684576  0.00105889  0.04258818 -0.08559635]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-7.3886222e-05 -2.2537958e-04 -1.9774794e-05 -4.7203749e-03
 -1.1137852e-02]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.00592019  0.00485163 -0.00488197 -0.00073258  0.01003618]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.05021356 -0.0656486  -0.02498344 -0.03945092  0.04248103]
  [Mamba.__call__] After layer 18 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 18 sample values: [-0.05021356 -0.0656486  -0.02498344 -0.03945092  0.04248103]
[Mamba.__call__] Processing layer 19/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.05021356 -0.0656486  -0.02498344 -0.03945092  0.04248103]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.05021356 -0.0656486  -0.02498344 -0.03945092  0.04248103]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.2009853  -1.5701535  -0.5975427  -0.94356924  1.016042  ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.2009853  -1.5701535  -0.5975427  -0.94356924  1.016042  ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.2009853  -1.5701535  -0.5975427  -0.94356924  1.016042  ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.03856844  0.47549903 -0.20050052  0.33045354 -0.43066037]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.03856844  0.47549903 -0.20050052  0.33045354 -0.43066037]
  [MambaBlock.__call__] res sample values: [ 0.01761338 -0.08734378  0.27912635 -0.26647392 -0.61773115]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.02870541  0.0802751  -0.14010918  0.02169913 -0.16489744]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.01414672  0.04174771 -0.06515495  0.01096727 -0.07566629]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.02724648  0.03284528 -0.06849994 -0.03818147  0.01949998]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.02724648  0.03284528 -0.06849994 -0.03818147  0.01949998]
  [MambaBlock.ssm] B sample values: [ 0.03891844  0.01655943 -0.03460442 -0.06204563 -0.02737356]
  [MambaBlock.ssm] C sample values: [-0.10065129 -0.09113012  0.05306102 -0.02137848  0.06372728]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.74164855 0.6367358  0.65751237 0.6413403  0.6284965 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.47632802 0.22688837 0.1080733  0.05147833 0.02452057]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00040833 -0.00017374  0.00036307  0.00065098  0.0002872 ]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00040833 -0.00017374  0.00036307  0.00065098  0.0002872 ]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-8.7772220e-05  2.2237962e-04 -3.5838888e-04  5.8842397e-05
 -3.9783999e-04]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.02313118 -0.01830408  0.01165422  0.009564    0.01364205]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.01358446  0.00084723  0.00658659 -0.00020751  0.00388211]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.01500048 -0.01005014 -0.03260507 -0.05666873  0.0270896 ]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.02926795  0.00374759  0.0044878  -0.00504696 -0.00258515]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.0689868  -0.09182791  0.10002282 -0.04208269  0.0198698 ]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.07973263 -0.00263719 -0.02050217  0.0070213  -0.003056  ]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.03930778  0.02124257 -0.02077861 -0.00207317  0.00239444]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.00691949  0.00092624 -0.00189097  0.00179531 -0.00235663]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-8.7772220e-05  2.2237962e-04 -3.5838888e-04  5.8842397e-05
 -3.9783999e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.01423449  0.04197009 -0.06551334  0.01102612 -0.07606413]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.01423449  0.04197009 -0.06551334  0.01102612 -0.07606413]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.01423449  0.04197009 -0.06551334  0.01102612 -0.07606413]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.00012646 -0.00175292 -0.01041109 -0.0012745   0.0164595 ]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.00025315  0.00215005  0.00348699 -0.00047993  0.00270378]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04996042 -0.06349855 -0.02149646 -0.03993085  0.04518481]
  [Mamba.__call__] After layer 19 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 19 sample values: [-0.04996042 -0.06349855 -0.02149646 -0.03993085  0.04518481]
[Mamba.__call__] Processing layer 20/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04996042 -0.06349855 -0.02149646 -0.03993085  0.04518481]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04996042 -0.06349855 -0.02149646 -0.03993085  0.04518481]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.182271  -1.5026393 -0.5086954 -0.9449296  1.0692602]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.182271  -1.5026393 -0.5086954 -0.9449296  1.0692602]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.182271  -1.5026393 -0.5086954 -0.9449296  1.0692602]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.22395629 -0.06376359  0.35635844 -0.48532557  0.02105564]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.22395629 -0.06376359  0.35635844 -0.48532557  0.02105564]
  [MambaBlock.__call__] res sample values: [-0.03544348  0.26486725  0.7884761   0.76967484  0.11549336]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.14717524 -0.01165439 -0.08736204  0.13841105 -0.00016107]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 7.8993008e-02 -5.7932413e-03 -4.1774198e-02  7.3987298e-02
 -8.0526886e-05]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.04531464  0.03935135 -0.04657737  0.04778738  0.0772132 ]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.04531464  0.03935135 -0.04657737  0.04778738  0.0772132 ]
  [MambaBlock.ssm] B sample values: [ 0.0273812   0.04715477 -0.03459243  0.1287278   0.02862889]
  [MambaBlock.ssm] C sample values: [ 0.06455892 -0.12387241  0.0452437  -0.0191274  -0.07851705]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.7576267 0.6810098 0.7216956 0.7168522 0.731614 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.46877766 0.21975249 0.10301507 0.04829115 0.02263781]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00163869  0.00282208 -0.00207026  0.007704    0.00171336]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00163869  0.00282208 -0.00207026  0.007704    0.00171336]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-1.0122545e-03  6.6729932e-05  5.0992682e-04 -8.9708279e-04
  9.9648014e-07]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.0001274  -0.01631378  0.00188126  0.00018581 -0.01341317]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.0062705   0.00032759  0.00920314 -0.01085667  0.00016124]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.0400532   0.0275168   0.00536753  0.01106782 -0.00233277]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00957176  0.00710599  0.01373725  0.00294975 -0.00035977]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.01700194  0.00319513 -0.00306297 -0.00238283  0.00375648]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00300637 -0.03026835  0.00690586 -0.00066026  0.00962994]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.01321849 -0.00485132 -0.01927017  0.00883637 -0.01132231]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.0108533  -0.09108556 -0.02689099 -0.00525462  0.00506952]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-1.0122545e-03  6.6729932e-05  5.0992682e-04 -8.9708279e-04
  9.9648014e-07]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 7.7980757e-02 -5.7265116e-03 -4.1264273e-02  7.3090218e-02
 -7.9530408e-05]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 7.7980757e-02 -5.7265116e-03 -4.1264273e-02  7.3090218e-02
 -7.9530408e-05]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 7.7980757e-02 -5.7265116e-03 -4.1264273e-02  7.3090218e-02
 -7.9530408e-05]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-1.3574667e-03 -8.5823500e-04 -2.2368560e-02  3.8447991e-02
 -4.8575312e-06]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [0.00567997 0.00392197 0.00307724 0.00545585 0.00425946]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04428045 -0.05957658 -0.01841922 -0.034475    0.04944427]
  [Mamba.__call__] After layer 20 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 20 sample values: [-0.04428045 -0.05957658 -0.01841922 -0.034475    0.04944427]
[Mamba.__call__] Processing layer 21/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04428045 -0.05957658 -0.01841922 -0.034475    0.04944427]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04428045 -0.05957658 -0.01841922 -0.034475    0.04944427]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.0388867  -1.3977572  -0.43214285 -0.80883586  1.1600378 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.0388867  -1.3977572  -0.43214285 -0.80883586  1.1600378 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.0388867  -1.3977572  -0.43214285 -0.80883586  1.1600378 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.06242295  0.04480495 -0.08593574 -0.19607083  0.17699406]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.06242295  0.04480495 -0.08593574 -0.19607083  0.17699406]
  [MambaBlock.__call__] res sample values: [ 0.4795081   0.3791461  -0.47420317  0.65272343 -0.01305152]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.00609038  0.03035131  0.03036056 -0.02698734  0.08578044]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.00305446  0.01540594  0.01541071 -0.0133116   0.04472867]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.08937328  0.01267875 -0.01385235  0.02655636 -0.0162259 ]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.08937328  0.01267875 -0.01385235  0.02655636 -0.0162259 ]
  [MambaBlock.ssm] B sample values: [ 0.07726978  0.05725734 -0.10362986 -0.07824733  0.03132652]
  [MambaBlock.ssm] C sample values: [-0.03479484  0.03891779  0.12608    -0.00922368 -0.01331626]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.671901   0.6895206  0.6633348  0.71937954 0.7130865 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.51073676 0.26085204 0.13322672 0.06804378 0.03475246]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 1.58580544e-04  1.17509066e-04 -2.12679268e-04 -1.60586773e-04
  6.42913219e-05]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 1.58580544e-04  1.17509066e-04 -2.12679268e-04 -1.60586773e-04
  6.42913219e-05]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-2.8845949e-05 -1.4930694e-04 -1.4368119e-04  1.3459625e-04
 -4.4830420e-04]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00234012 -0.00071845 -0.00061839  0.00027495 -0.00068651]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.00026379 -0.00074019  0.00090315  0.00151228  0.002801  ]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00106463 -0.00039349 -0.00082462  0.00024366 -0.000518  ]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.0002207  -0.00315158 -0.00088258 -0.00386024  0.00195173]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [1.2449154e-03 1.8528861e-04 5.7297650e-05 2.6131727e-05 7.1677769e-04]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00030013  0.00304375 -0.00258066  0.00077081 -0.00961887]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.00572175  0.00051761 -0.00370178  0.00539252  0.01158793]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.00376001 -0.00613669 -0.00436697  0.00812236 -0.01153242]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-2.8845949e-05 -1.4930694e-04 -1.4368119e-04  1.3459625e-04
 -4.4830420e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.00302562  0.01525663  0.01526703 -0.013177    0.04428036]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.00302562  0.01525663  0.01526703 -0.013177    0.04428036]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.00302562  0.01525663  0.01526703 -0.013177    0.04428036]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.00089607  0.00343406 -0.0027773  -0.00565618 -0.00028708]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00493449  0.00128365 -0.01044486  0.00320766 -0.00920105]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04921494 -0.05829293 -0.02886408 -0.03126734  0.04024322]
  [Mamba.__call__] After layer 21 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 21 sample values: [-0.04921494 -0.05829293 -0.02886408 -0.03126734  0.04024322]
[Mamba.__call__] Processing layer 22/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04921494 -0.05829293 -0.02886408 -0.03126734  0.04024322]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04921494 -0.05829293 -0.02886408 -0.03126734  0.04024322]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.1485188 -1.36037   -0.6735951 -0.7296794  0.9391477]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.1485188 -1.36037   -0.6735951 -0.7296794  0.9391477]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.1485188 -1.36037   -0.6735951 -0.7296794  0.9391477]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.21171223 -0.6788542  -0.23854426  0.26833558 -0.42798117]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.21171223 -0.6788542  -0.23854426  0.26833558 -0.42798117]
  [MambaBlock.__call__] res sample values: [ 0.34765345  0.22898087  0.01567814  0.00823862 -0.03992556]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.06460679  0.01339463 -0.12498789  0.13374105  0.00336103]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.03334654  0.00674217 -0.05859352  0.07133554  0.00168334]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.01287731 -0.11415185 -0.10473488  0.09514674  0.10250002]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.01287731 -0.11415185 -0.10473488  0.09514674  0.10250002]
  [MambaBlock.ssm] B sample values: [ 0.01202047 -0.06136461  0.02765082  0.10248133  0.08758555]
  [MambaBlock.ssm] C sample values: [ 0.17656946  0.0223902  -0.0620484  -0.12706614  0.03800193]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.72212934 0.7010663  0.7761009  0.68143594 0.7467779 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.4857169  0.2359209  0.11459076 0.05565867 0.02703436]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00028946 -0.00147769  0.00066585  0.0024678   0.00210911]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00028946 -0.00147769  0.00066585  0.0024678   0.00210911]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 1.7657341e-04  3.4659173e-05 -3.3344730e-04  3.5644326e-04
  9.2177015e-06]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 5.3170457e-04 -2.7975205e-03  6.0883343e-05 -2.2154676e-03
 -6.3559203e-04]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 1.8941885e-04 -4.9188884e-04 -3.6992459e-04  1.9766606e-04
 -3.7670437e-05]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00370677  0.0040403   0.0038982  -0.00336726  0.00406594]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00601729 -0.00349122  0.02599004 -0.00615468 -0.00174765]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00887412 -0.00925783 -0.00850181  0.00104564 -0.00047489]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.00261235  0.01288254  0.00478832  0.02265802 -0.00203736]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.0049451  -0.00343534 -0.0011373   0.00168229 -0.00120992]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [0.00057049 0.00234638 0.00656919 0.00075213 0.00080401]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 1.7657341e-04  3.4659173e-05 -3.3344730e-04  3.5644326e-04
  9.2177015e-06]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.03352312  0.00677683 -0.05892697  0.07169198  0.00169256]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.03352312  0.00677683 -0.05892697  0.07169198  0.00169256]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.03352312  0.00677683 -0.05892697  0.07169198  0.00169256]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 6.8300585e-03  8.6432707e-04 -4.6555360e-04  2.9653791e-04
 -3.3113738e-05]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.00205833 -0.00545204  0.01231703  0.00058858 -0.00368018]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04715661 -0.06374497 -0.01654705 -0.03067876  0.03656304]
  [Mamba.__call__] After layer 22 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 22 sample values: [-0.04715661 -0.06374497 -0.01654705 -0.03067876  0.03656304]
[Mamba.__call__] Processing layer 23/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04715661 -0.06374497 -0.01654705 -0.03067876  0.03656304]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04715661 -0.06374497 -0.01654705 -0.03067876  0.03656304]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.0856926  -1.4676086  -0.3809648  -0.70632106  0.84179556]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.0856926  -1.4676086  -0.3809648  -0.70632106  0.84179556]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.0856926  -1.4676086  -0.3809648  -0.70632106  0.84179556]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.2988794  -0.23268878 -0.42814463 -0.11784937 -0.396307  ]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.2988794  -0.23268878 -0.42814463 -0.11784937 -0.396307  ]
  [MambaBlock.__call__] res sample values: [-0.58025885  0.1408378   0.21874493 -0.2265279  -0.08320525]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.08682566  0.05424478 -0.03295405  0.0133959   0.01517367]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.04529632  0.02785783 -0.01620556  0.00674281  0.00764439]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.10066709 -0.02627838  0.07145266 -0.04156082 -0.00551191]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.10066709 -0.02627838  0.07145266 -0.04156082 -0.00551191]
  [MambaBlock.ssm] B sample values: [ 0.09820771  0.03898707  0.02759085 -0.01528084  0.08872032]
  [MambaBlock.ssm] C sample values: [ 0.06248147 -0.02284531 -0.00832481  0.03620198 -0.06310188]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.69247586 0.7183899  0.6183288  0.7004796  0.7085159 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.50033575 0.2503359  0.125252   0.06266806 0.03135507]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00308044  0.00122289  0.00086543 -0.00047931  0.00278286]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00308044  0.00122289  0.00086543 -0.00047931  0.00278286]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.00080902  0.00051618 -0.00025845  0.00012182  0.0001397 ]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00496078  0.00204163  0.00642288 -0.00855599  0.00776033]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 1.7283917e-03 -1.1959096e-03 -1.7687940e-03 -3.6970836e-05
  8.6298247e-04]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00848403 -0.00119901  0.01234458 -0.00769409  0.00505001]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00716788 -0.00543206  0.00594725 -0.00665951  0.00123604]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00965021  0.01489519  0.0019791   0.00141228 -0.00439455]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00292415 -0.00138465  0.00342022  0.00066339  0.00443769]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.00428199 -0.00151085 -0.01413724 -0.00142749  0.00117963]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.00088848  0.00248649 -0.00149841 -0.00400557  0.00053423]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.00080902  0.00051618 -0.00025845  0.00012182  0.0001397 ]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.04610534  0.02837401 -0.01646401  0.00686464  0.00778409]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.04610534  0.02837401 -0.01646401  0.00686464  0.00778409]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.04610534  0.02837401 -0.01646401  0.00686464  0.00778409]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.00960094  0.00213854 -0.00199688 -0.00068983 -0.00031037]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.00563874 -0.0008884   0.00239448 -0.00625454 -0.00014004]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04151787 -0.06463336 -0.01415256 -0.0369333   0.036423  ]
  [Mamba.__call__] After layer 23 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 23 sample values: [-0.04151787 -0.06463336 -0.01415256 -0.0369333   0.036423  ]
[Mamba.__call__] Processing layer 24/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04151787 -0.06463336 -0.01415256 -0.0369333   0.036423  ]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04151787 -0.06463336 -0.01415256 -0.0369333   0.036423  ]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.95423526 -1.4855154  -0.32527864 -0.84886485  0.83713615]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.95423526 -1.4855154  -0.32527864 -0.84886485  0.83713615]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.95423526 -1.4855154  -0.32527864 -0.84886485  0.83713615]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.19591425  0.00957288  0.6704953   0.22413214  0.08794791]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.19591425  0.00957288  0.6704953   0.22413214  0.08794791]
  [MambaBlock.__call__] res sample values: [-0.8570783  -0.46341223 -0.10466503 -0.10310943  0.09579261]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.03316354  0.00197123 -0.01401787  0.11433254 -0.01550432]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.0168567   0.00098658 -0.00695981  0.0604307  -0.00769207]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.03302734 -0.0031596   0.02299855  0.0809928  -0.05038394]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.03302734 -0.0031596   0.02299855  0.0809928  -0.05038394]
  [MambaBlock.ssm] B sample values: [ 0.09605959  0.0369918   0.04228892  0.03324918 -0.25679603]
  [MambaBlock.ssm] C sample values: [-0.05779868  0.03971148  0.22857961  0.05397392  0.00659451]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.66736794 0.58794516 0.7293245  0.8026201  0.67649376]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.51305723 0.2632277  0.13505086 0.06928882 0.03554913]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00108063  0.00041614  0.00047573  0.00037404 -0.00288886]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00108063  0.00041614  0.00047573  0.00037404 -0.00288886]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 8.4130843e-05  4.3379878e-06 -3.7960825e-05  3.6273123e-04
 -3.8915641e-05]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00243829 -0.00024259 -0.00128993  0.00372349  0.00036065]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-2.1614926e-04  5.1080951e-05  1.2353209e-03 -4.1473564e-04
  3.8776777e-04]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.01616977 -0.00054783  0.00071104  0.006623    0.00569213]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00093911  0.00030371 -0.00397877 -0.00036126 -0.00170084]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00734181 -0.0035978   0.0021398   0.00047874 -0.00253597]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [0.00243582 0.00074506 0.00032009 0.00809591 0.01920277]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.00419871 -0.01190176  0.00734347  0.01924297  0.00594988]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.00061868  0.00098672  0.00073711 -0.00306396  0.00342516]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 8.4130843e-05  4.3379878e-06 -3.7960825e-05  3.6273123e-04
 -3.8915641e-05]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.01694083  0.00099092 -0.00699777  0.06079343 -0.00773098]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.01694083  0.00099092 -0.00699777  0.06079343 -0.00773098]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.01694083  0.00099092 -0.00699777  0.06079343 -0.00773098]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.00432612 -0.00017733  0.00034706 -0.00297275 -0.00038801]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.0106591  -0.00111675  0.00550002 -0.01336837  0.00093494]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.03085877 -0.06575011 -0.00865255 -0.05030167  0.03735794]
  [Mamba.__call__] After layer 24 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 24 sample values: [-0.03085877 -0.06575011 -0.00865255 -0.05030167  0.03735794]
[Mamba.__call__] Processing layer 25/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.03085877 -0.06575011 -0.00865255 -0.05030167  0.03735794]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.03085877 -0.06575011 -0.00865255 -0.05030167  0.03735794]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.69680345 -1.4846637  -0.19537799 -1.1358318   0.8435572 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.69680345 -1.4846637  -0.19537799 -1.1358318   0.8435572 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.69680345 -1.4846637  -0.19537799 -1.1358318   0.8435572 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.49623215  0.18074727 -0.16982804 -0.76215696 -0.09903866]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.49623215  0.18074727 -0.16982804 -0.76215696 -0.09903866]
  [MambaBlock.__call__] res sample values: [ 0.30972844 -0.347479   -0.30283344 -0.08650301 -0.10675731]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.13765989  0.10702795 -0.01787001  0.332496   -0.01449365]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.06409985  0.05637499 -0.00885517  0.19363454 -0.00719431]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.04774947  0.05309046 -0.11956185 -0.07324887 -0.06793834]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.04774947  0.05309046 -0.11956185 -0.07324887 -0.06793834]
  [MambaBlock.ssm] B sample values: [-0.0309233   0.15351768  0.07149491  0.06550679 -0.02619839]
  [MambaBlock.ssm] C sample values: [ 0.07656299  0.07031154 -0.0093439   0.03120031  0.04749431]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.69550204 0.63743186 0.7035983  0.71570176 0.70627373]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.49882394 0.24882534 0.12412004 0.06191405 0.03088421]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00137861 -0.00684406 -0.00318736 -0.0029204   0.00116797]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00137861 -0.00684406 -0.00318736 -0.0029204   0.00116797]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-5.4455824e-05  4.3894343e-05 -7.6104525e-06  1.6927918e-04
 -6.2065651e-06]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [0.00238951 0.00050908 0.00140786 0.00087417 0.00058376]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-3.4695672e-04  1.7319386e-03  1.7524408e-05 -6.5603235e-04
 -7.3214248e-04]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 1.0087984e-03  7.8913792e-05  7.3227406e-05 -1.8312404e-04
 -4.0551226e-05]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-4.5161763e-05 -2.7053204e-04 -1.6532276e-03  1.3114216e-02
 -5.4908823e-03]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00206387 -0.0057229  -0.00495552  0.00253939  0.00367679]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.00454222 -0.02025863  0.00318189  0.011046    0.00346453]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.00153802 -0.00188497 -0.00039418  0.00026378  0.00070004]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.00030076  0.01244975 -0.00085398 -0.01095697  0.0187183 ]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-5.4455824e-05  4.3894343e-05 -7.6104525e-06  1.6927918e-04
 -6.2065651e-06]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.0641543   0.05641888 -0.00886278  0.19380382 -0.00720051]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.0641543   0.05641888 -0.00886278  0.19380382 -0.00720051]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.0641543   0.05641888 -0.00886278  0.19380382 -0.00720051]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.01146163 -0.00811609  0.00114031 -0.00801999  0.00036386]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00425988  0.0036072   0.00288878  0.00313774  0.00073013]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.03511865 -0.06214291 -0.00576377 -0.04716393  0.03808806]
  [Mamba.__call__] After layer 25 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 25 sample values: [-0.03511865 -0.06214291 -0.00576377 -0.04716393  0.03808806]
[Mamba.__call__] Processing layer 26/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.03511865 -0.06214291 -0.00576377 -0.04716393  0.03808806]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.03511865 -0.06214291 -0.00576377 -0.04716393  0.03808806]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.78295773 -1.3854537  -0.1285011  -1.051503    0.84915966]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.78295773 -1.3854537  -0.1285011  -1.051503    0.84915966]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.78295773 -1.3854537  -0.1285011  -1.051503    0.84915966]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.4397326   0.04802918 -0.10337374 -0.5228545  -0.02733539]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.4397326   0.04802918 -0.10337374 -0.5228545  -0.02733539]
  [MambaBlock.__call__] res sample values: [-0.4140232   0.30118263 -0.22863342  0.18022692  0.12408455]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.129035    0.02860467 -0.09707331 -0.0841106   0.00041993]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.06867424  0.01450688 -0.0461827  -0.04028769  0.00021001]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.03279065  0.07859485 -0.01608913 -0.01488688  0.20346795]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.03279065  0.07859485 -0.01608913 -0.01488688  0.20346795]
  [MambaBlock.ssm] B sample values: [ 0.01829067  0.062982   -0.00296425  0.0301563  -0.02818928]
  [MambaBlock.ssm] C sample values: [ 0.05049279  0.13311422  0.00630221  0.09143493 -0.0425135 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.6675825  0.7048937  0.66560155 0.6900045  0.67991555]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.51294714 0.26311475 0.13496396 0.06922937 0.03551101]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00083855  0.00288746 -0.0001359   0.00138254 -0.00129236]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00083855  0.00288746 -0.0001359   0.00138254 -0.00129236]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-1.8860097e-03 -4.2067107e-04  1.2645579e-03  1.1435876e-03
 -5.8740065e-06]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00134636  0.00305071  0.00012907 -0.0041526   0.00034711]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-6.0867966e-04 -1.7640777e-03 -1.0196465e-03 -4.8076917e-04
 -2.5623920e-05]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-5.3866473e-03 -5.4453325e-05  6.5518008e-03  2.2902284e-03
 -1.3770618e-02]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00445792 -0.00362501 -0.00169502 -0.00518029 -0.0005879 ]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00822502 -0.01343878  0.00460806  0.00919066  0.00066962]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.00653899 -0.00170507 -0.00432156 -0.00138291 -0.00234528]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.00520542 -0.00371177  0.00118702  0.00162903  0.00090357]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.0012291  -0.01080288 -0.0074753  -0.00252293  0.0010124 ]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-1.8860097e-03 -4.2067107e-04  1.2645579e-03  1.1435876e-03
 -5.8740065e-06]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.06678823  0.01408621 -0.04491814 -0.0391441   0.00020413]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.06678823  0.01408621 -0.04491814 -0.0391441   0.00020413]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.06678823  0.01408621 -0.04491814 -0.0391441   0.00020413]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-1.1004003e-02  2.4383110e-03  4.5504333e-03 -3.8444202e-03
  1.3449643e-05]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00473304  0.00477092 -0.0083358  -0.00412281  0.01141365]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.0398517  -0.05737199 -0.01409957 -0.05128675  0.04950171]
  [Mamba.__call__] After layer 26 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 26 sample values: [-0.0398517  -0.05737199 -0.01409957 -0.05128675  0.04950171]
[Mamba.__call__] Processing layer 27/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.0398517  -0.05737199 -0.01409957 -0.05128675  0.04950171]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.0398517  -0.05737199 -0.01409957 -0.05128675  0.04950171]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.87450826 -1.2589746  -0.3094018  -1.1254396   1.0862688 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.87450826 -1.2589746  -0.3094018  -1.1254396   1.0862688 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.87450826 -1.2589746  -0.3094018  -1.1254396   1.0862688 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.1039009  -0.27259582 -0.05915546 -0.19544776 -0.3754394 ]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.1039009  -0.27259582 -0.05915546 -0.19544776 -0.3754394 ]
  [MambaBlock.__call__] res sample values: [-0.18878886 -0.22211295 -0.23157845 -0.13235596 -0.37476715]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.03306168  0.07221674 -0.00120988 -0.18040495 -0.21781603]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.01680408  0.03741162 -0.00060457 -0.08208798 -0.09709374]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.03841068 -0.01281147  0.02874471 -0.12817468 -0.08017594]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.03841068 -0.01281147  0.02874471 -0.12817468 -0.08017594]
  [MambaBlock.ssm] B sample values: [ 0.0106647   0.09700052 -0.07444514 -0.0653078   0.14018258]
  [MambaBlock.ssm] C sample values: [-0.19024909  0.02200714  0.01720481 -0.0888548   0.02467842]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.66642934 0.7119716  0.7301955  0.71399826 0.6997623 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.51353896 0.26372227 0.13543166 0.06954944 0.03571635]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00011943  0.00108628 -0.00083369 -0.00073136  0.00156987]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00011943  0.00108628 -0.00083369 -0.00073136  0.00156987]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 7.6295284e-04  1.8146712e-03 -3.0075733e-05 -3.9930562e-03
 -4.6288217e-03]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00246428  0.00039104 -0.00322381 -0.0015883  -0.0020018 ]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-9.6402669e-05  3.0224040e-04 -6.9193875e-06  4.9282401e-04
 -2.4577542e-04]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00194983 -0.00233204  0.00042332  0.00222256  0.00621261]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00152655 -0.00672968 -0.0017663  -0.00049208  0.00315148]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.01297318 -0.01064419  0.01161186  0.00802948 -0.02921193]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.0059695   0.00594459  0.00019742  0.01939101 -0.00629027]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.02262109  0.00834139  0.0016791  -0.0167648   0.01553228]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.01538707 -0.00397869 -0.01595613 -0.02586589  0.01605974]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 7.6295284e-04  1.8146712e-03 -3.0075733e-05 -3.9930562e-03
 -4.6288217e-03]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.01756703  0.03922629 -0.00063465 -0.08608104 -0.10172256]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.01756703  0.03922629 -0.00063465 -0.08608104 -0.10172256]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.01756703  0.03922629 -0.00063465 -0.08608104 -0.10172256]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-1.5021657e-03 -3.8745138e-03  6.5014421e-05  5.3202244e-03
  1.5530618e-02]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00235184 -0.00047523 -0.0101043   0.00192517  0.00208993]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04220354 -0.05784722 -0.02420387 -0.04936158  0.05159165]
  [Mamba.__call__] After layer 27 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 27 sample values: [-0.04220354 -0.05784722 -0.02420387 -0.04936158  0.05159165]
[Mamba.__call__] Processing layer 28/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04220354 -0.05784722 -0.02420387 -0.04936158  0.05159165]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04220354 -0.05784722 -0.02420387 -0.04936158  0.05159165]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.9214437 -1.2629972 -0.5284509 -1.0777274  1.1264173]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.9214437 -1.2629972 -0.5284509 -1.0777274  1.1264173]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.9214437 -1.2629972 -0.5284509 -1.0777274  1.1264173]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.27254343 -0.2824576  -0.73784304 -0.08146697  0.14026934]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.27254343 -0.2824576  -0.73784304 -0.08146697  0.14026934]
  [MambaBlock.__call__] res sample values: [-0.11413142 -0.20126924 -0.56415236 -0.39982867 -0.07350883]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.02410702 -0.00381296  0.3135155   0.02294621 -0.00632224]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.01219879 -0.00190285  0.18113142  0.01160473 -0.00315113]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.07836948 -0.00799596  0.09875058 -0.06108192  0.21367066]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.07836948 -0.00799596  0.09875058 -0.06108192  0.21367066]
  [MambaBlock.ssm] B sample values: [-0.02413277  0.05993803  0.0465047  -0.08671698 -0.01328058]
  [MambaBlock.ssm] C sample values: [-0.00773525  0.06165988 -0.06801356  0.00136917  0.12549694]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.6772227 0.7252084 0.6796377 0.6457288 0.7361438]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.50802594 0.25809038 0.13111661 0.06661064 0.03383994]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00019937  0.00049517  0.00038419 -0.00071639 -0.00010971]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00019937  0.00049517  0.00038419 -0.00071639 -0.00010971]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-4.5011930e-05  7.5187577e-06 -6.7073439e-04 -4.0828603e-05
  1.2638867e-05]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00130559  0.01095029  0.01717527 -0.00799483  0.02476249]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-1.0854685e-03  5.6314655e-04 -1.8809888e-03 -1.4415142e-04
 -5.2570485e-05]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [0.00353248 0.00706117 0.0029804  0.00677049 0.00019702]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00053765  0.00011141 -0.00276984  0.00045426  0.00021357]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.01506614  0.00246804  0.01762504 -0.01481358  0.013269  ]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 2.9454620e-03  7.4571365e-04 -6.3634450e-03  8.1620696e-05
  8.5253542e-04]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.01317525  0.00265436 -0.00262646 -0.00400205  0.00537261]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.00239678 -0.00210645  0.00652359  0.00216199 -0.00144716]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-4.5011930e-05  7.5187577e-06 -6.7073439e-04 -4.0828603e-05
  1.2638867e-05]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.01215378 -0.00189533  0.18046069  0.0115639  -0.00313849]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.01215378 -0.00189533  0.18046069  0.0115639  -0.00313849]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.01215378 -0.00189533  0.18046069  0.0115639  -0.00313849]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.00065403  0.00017161 -0.03691404 -0.00185569  0.00011112]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00683042  0.01333874 -0.00342503  0.0030645   0.00093275]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04903396 -0.04450848 -0.0276289  -0.04629708  0.0525244 ]
  [Mamba.__call__] After layer 28 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 28 sample values: [-0.04903396 -0.04450848 -0.0276289  -0.04629708  0.0525244 ]
[Mamba.__call__] Processing layer 29/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04903396 -0.04450848 -0.0276289  -0.04629708  0.0525244 ]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04903396 -0.04450848 -0.0276289  -0.04629708  0.0525244 ]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.0664998  -0.96806955 -0.6009348  -1.006972    1.1424176 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.0664998  -0.96806955 -0.6009348  -1.006972    1.1424176 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.0664998  -0.96806955 -0.6009348  -1.006972    1.1424176 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.79986787 -0.17621754 -0.13360015  0.04477169  0.15157765]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.79986787 -0.17621754 -0.13360015  0.04477169  0.15157765]
  [MambaBlock.__call__] res sample values: [-0.3764015   0.49415064  0.28824484  0.3797792   0.15074591]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.17999001 -0.19817024 -0.02346046  0.03082767  0.00828385]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.08191769 -0.08929925 -0.01159264  0.0156514   0.00415908]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.00248118  0.0919385   0.06842683  0.07534499  0.09426962]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.00248118  0.0919385   0.06842683  0.07534499  0.09426962]
  [MambaBlock.ssm] B sample values: [ 0.03946044 -0.05054577  0.04549476 -0.11578845  0.06555402]
  [MambaBlock.ssm] C sample values: [ 0.10376026 -0.00155498  0.10560983 -0.02635063 -0.08704966]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.70106375 0.7034953  0.71430624 0.7083178  0.66148037]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.49605733 0.24607289 0.12206624 0.06055187 0.0300372 ]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00226619  0.00290282 -0.00261274  0.00664968 -0.00376474]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00226619  0.00290282 -0.00261274  0.00664968 -0.00376474]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-4.0409990e-04 -4.4204100e-04 -5.8266665e-05  7.8007251e-05
  1.9358329e-05]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00690948  0.00357795 -0.00432671 -0.0007229   0.00304746]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.00059896 -0.00122476 -0.00024558  0.00010549  0.00045365]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00443074 -0.00123845 -0.00153512  0.00229645 -0.00132353]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00135556  0.0025913   0.00079547 -0.00095615 -0.00156426]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00176359 -0.00030986 -0.00273665  0.00498462 -0.0014737 ]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [2.3847620e-04 2.8392641e-04 4.0269658e-04 1.8209510e-05 9.3747664e-04]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.00173209 -0.00554426 -0.00529952 -0.00350784  0.00054369]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.00262912 -0.00083154 -0.01200876 -0.00012061  0.0126504 ]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-4.0409990e-04 -4.4204100e-04 -5.8266665e-05  7.8007251e-05
  1.9358329e-05]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.08232179 -0.0897413  -0.0116509   0.01572941  0.00417844]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.08232179 -0.0897413  -0.0116509   0.01572941  0.00417844]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.08232179 -0.0897413  -0.0116509   0.01572941  0.00417844]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.01261117 -0.02754241 -0.0019195   0.0035473   0.00033863]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.00553006  0.00326761 -0.00727581 -0.00660857 -0.00601525]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.0435039  -0.04124087 -0.03490471 -0.05290565  0.04650915]
  [Mamba.__call__] After layer 29 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 29 sample values: [-0.0435039  -0.04124087 -0.03490471 -0.05290565  0.04650915]
[Mamba.__call__] Processing layer 30/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.0435039  -0.04124087 -0.03490471 -0.05290565  0.04650915]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.0435039  -0.04124087 -0.03490471 -0.05290565  0.04650915]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.9384535  -0.88963604 -0.7529542  -1.1412653   1.0032817 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.9384535  -0.88963604 -0.7529542  -1.1412653   1.0032817 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.9384535  -0.88963604 -0.7529542  -1.1412653   1.0032817 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.10135727 -0.3473038  -0.2501447   0.3238448   0.24177805]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.10135727 -0.3473038  -0.2501447   0.3238448   0.24177805]
  [MambaBlock.__call__] res sample values: [-0.4356664   0.19888599 -0.05730067  0.39492345  0.6451417 ]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.00723678  0.19302757  0.17731377 -0.01717027  0.13867825]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.00363148  0.10579987  0.0964964  -0.00851143  0.07413935]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.09900317 -0.17314734 -0.0049349   0.06125863 -0.05621398]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.09900317 -0.17314734 -0.0049349   0.06125863 -0.05621398]
  [MambaBlock.ssm] B sample values: [ 0.12149835  0.12047234  0.12706205 -0.05746462 -0.13480784]
  [MambaBlock.ssm] C sample values: [ 0.03126607 -0.11522569 -0.06858693  0.02452142 -0.03791668]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.6885209  0.68250215 0.7207543  0.7659821  0.72766006]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.5023185  0.25232387 0.12674695 0.06366733 0.03198128]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00030379  0.00030122  0.0003177  -0.00014368 -0.00033707]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00030379  0.00030122  0.0003177  -0.00014368 -0.00033707]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-3.6943682e-05 -1.0669106e-03 -1.0276312e-03  9.6329699e-05
 -7.9710601e-04]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00127536  0.00091968  0.00217763  0.0023888   0.00018237]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.00093858  0.00232083  0.00926645 -0.00025324 -0.00399658]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00109603  0.00103085 -0.00124577 -0.00117282  0.00071331]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00071221 -0.00274838  0.00059432  0.00457259  0.00684216]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00210048 -0.00304478 -0.00012201  0.00451299  0.00117043]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.00058853 -0.00248006 -0.00204415  0.0007766   0.00336521]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.00061579  0.00176324  0.00573094 -0.0020059   0.00542666]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.0047807   0.00289985  0.01398746 -0.00877    -0.02092465]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-3.6943682e-05 -1.0669106e-03 -1.0276312e-03  9.6329699e-05
 -7.9710601e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.00359454  0.10473296  0.09546877 -0.0084151   0.07334224]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.00359454  0.10473296  0.09546877 -0.0084151   0.07334224]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.00359454  0.10473296  0.09546877 -0.0084151   0.07334224]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.00061509  0.01144725 -0.00265687 -0.00198558  0.03103536]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.00481742 -0.01155564 -0.007626   -0.00994715 -0.00827655]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.03868648 -0.05279651 -0.0425307  -0.0628528   0.03823259]
  [Mamba.__call__] After layer 30 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 30 sample values: [-0.03868648 -0.05279651 -0.0425307  -0.0628528   0.03823259]
[Mamba.__call__] Processing layer 31/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.03868648 -0.05279651 -0.0425307  -0.0628528   0.03823259]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.03868648 -0.05279651 -0.0425307  -0.0628528   0.03823259]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.827964   -1.1299454  -0.9102378  -1.3451692   0.81825006]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.827964   -1.1299454  -0.9102378  -1.3451692   0.81825006]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.827964   -1.1299454  -0.9102378  -1.3451692   0.81825006]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.15664515  0.16284615 -0.16916198  0.08715886 -0.0420826 ]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.15664515  0.16284615 -0.16916198  0.08715886 -0.0420826 ]
  [MambaBlock.__call__] res sample values: [ 0.19304745  0.2520028   0.33531648 -0.36680204 -0.20724568]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.0899194  -0.04400082  0.09490462 -0.01182337  0.03069177]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.04697972 -0.02151647  0.04970234 -0.00587674  0.01558136]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.02667437 -0.07478254 -0.13642468  0.11256259 -0.01718482]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.02667437 -0.07478254 -0.13642468  0.11256259 -0.01718482]
  [MambaBlock.ssm] B sample values: [ 0.10624519  0.08827719 -0.05077373  0.06512416 -0.09828328]
  [MambaBlock.ssm] C sample values: [ 0.02558214  0.06719315 -0.06304787 -0.07782341 -0.00850615]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.70736    0.68359876 0.73280096 0.68555593 0.6147209 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.49294385 0.24299362 0.11978221 0.0590459  0.02910632]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.0035307   0.00293359 -0.00168729  0.00216418 -0.00326611]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.0035307   0.00293359 -0.00168729  0.00216418 -0.00326611]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 4.8130887e-04 -2.1303215e-04  5.2751607e-04 -5.8351510e-05
  1.3872546e-04]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00521565 -0.00478268 -0.00902137 -0.01781251 -0.00950255]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.0011049   0.00030769  0.00224651 -0.00022983 -0.0009141 ]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.01224205 -0.00579416 -0.01030552 -0.01045243 -0.01196445]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00487699 -0.00327025 -0.00261859 -0.00024626 -0.01044594]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.01599953 -0.00904215 -0.03204601  0.03995645 -0.0241165 ]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.01045946  0.00378112  0.00240369  0.00349391 -0.01071562]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.02455472 -0.0283022   0.00236263  0.02123633 -0.02057625]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.01844223 -0.00436155  0.06397986  0.01035564 -0.03080343]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 4.8130887e-04 -2.1303215e-04  5.2751607e-04 -5.8351510e-05
  1.3872546e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.04746103 -0.0217295   0.05022985 -0.00593509  0.01572009]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.04746103 -0.0217295   0.05022985 -0.00593509  0.01572009]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.04746103 -0.0217295   0.05022985 -0.00593509  0.01572009]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.00502193 -0.00308112  0.00982029  0.00089108 -0.00146076]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00420887 -0.00251925 -0.00486871 -0.00339588  0.01155927]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04289534 -0.05531575 -0.04739941 -0.06624869  0.04979187]
  [Mamba.__call__] After layer 31 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 31 sample values: [-0.04289534 -0.05531575 -0.04739941 -0.06624869  0.04979187]
[Mamba.__call__] Processing layer 32/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04289534 -0.05531575 -0.04739941 -0.06624869  0.04979187]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04289534 -0.05531575 -0.04739941 -0.06624869  0.04979187]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.9054788 -1.1676614 -1.0005553 -1.398445   1.0510576]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.9054788 -1.1676614 -1.0005553 -1.398445   1.0510576]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.9054788 -1.1676614 -1.0005553 -1.398445   1.0510576]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.04049349  0.17471129 -0.02791443 -0.11759622 -0.09073626]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.04049349  0.17471129 -0.02791443 -0.11759622 -0.09073626]
  [MambaBlock.__call__] res sample values: [-0.1603678  -0.00862008 -0.3275314  -0.17960492 -0.38725322]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.01368664  0.01099279 -0.02118658  0.12646396  0.02933196]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.00679649  0.00552661 -0.01048108  0.06722494  0.01488105]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.1207005   0.00552129 -0.00573084 -0.12302294  0.03271005]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.1207005   0.00552129 -0.00573084 -0.12302294  0.03271005]
  [MambaBlock.ssm] B sample values: [-0.1054089  -0.04498503  0.0516      0.02547457 -0.02421246]
  [MambaBlock.ssm] C sample values: [-0.09052575 -0.12679373 -0.02286654 -0.01481834  0.08156998]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.7192347 0.6052003 0.7379847 0.7162775 0.7208854]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.48712492 0.23729068 0.1155902  0.05630687 0.02742848]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00051527  0.0002199  -0.00025223 -0.00012453  0.00011836]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00051527  0.0002199  -0.00025223 -0.00012453  0.00011836]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.00019325  0.00013223 -0.00030579  0.00190365  0.00042411]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00640613 -0.00529594  0.00518552 -0.00698999 -0.00215937]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.00200976  0.00131023 -0.00506451 -0.0018234  -0.00011864]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.0094642  -0.00101609 -0.01535569  0.00790598  0.00496574]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.03172851 -0.0009083  -0.00048643 -0.0150805   0.01883901]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.01371785 -0.02898393 -0.01116365  0.02148101  0.00590393]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00958955  0.00128558  0.00176591  0.0098182  -0.00752342]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.01445184  0.02973818 -0.00023904 -0.00824212  0.00164188]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.00598847 -0.00022949  0.01646294  0.00222585  0.00014537]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.00019325  0.00013223 -0.00030579  0.00190365  0.00042411]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.00698975  0.00565884 -0.01078687  0.06912859  0.01530516]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.00698975  0.00565884 -0.01078687  0.06912859  0.01530516]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.00698975  0.00565884 -0.01078687  0.06912859  0.01530516]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 5.1562098e-04 -2.4284684e-05  1.4797827e-03 -5.6519248e-03
 -2.3967414e-03]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.0064196   0.00499073  0.0228954   0.0085711   0.00746742]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04931494 -0.05032502 -0.02450401 -0.05767758  0.05725929]
  [Mamba.__call__] After layer 32 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 32 sample values: [-0.04931494 -0.05032502 -0.02450401 -0.05767758  0.05725929]
[Mamba.__call__] Processing layer 33/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04931494 -0.05032502 -0.02450401 -0.05767758  0.05725929]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04931494 -0.05032502 -0.02450401 -0.05767758  0.05725929]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.0282221 -1.0492824 -0.5109114 -1.2025841  1.1938627]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.0282221 -1.0492824 -0.5109114 -1.2025841  1.1938627]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.0282221 -1.0492824 -0.5109114 -1.2025841  1.1938627]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.5331955  -0.26024985 -0.2937718  -0.32227346 -0.20549324]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.5331955  -0.26024985 -0.2937718  -0.32227346 -0.20549324]
  [MambaBlock.__call__] res sample values: [-0.31639114 -0.16975945 -0.10978083 -0.193365   -0.20297287]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.4573291   0.17728789  0.25770405 -0.1480472  -0.04849919]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.17726973  0.09648118  0.1453636  -0.0685541  -0.02366167]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.09180992  0.07668344 -0.07443339  0.12050415  0.08667658]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.09180992  0.07668344 -0.07443339  0.12050415  0.08667658]
  [MambaBlock.ssm] B sample values: [ 0.0416795  -0.10542855 -0.1393862   0.01523064 -0.00783523]
  [MambaBlock.ssm] C sample values: [ 0.03034835  0.10116455 -0.03796063  0.0484669  -0.06515363]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.73951447 0.6751253  0.71038014 0.6674088  0.68285096]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.47734562 0.22785884 0.10876741 0.05191965 0.02478362]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00546391  0.013821    0.01827263 -0.00199664  0.00102715]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00546391  0.013821    0.01827263 -0.00199664  0.00102715]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.00283096 -0.00140663 -0.00222997  0.00098805  0.00034892]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00300491  0.00524522  0.0028064  -0.00076965  0.00074232]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-1.8219512e-04  1.2028637e-04  1.2704205e-04 -6.9686277e-05
  9.8728502e-05]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 1.1828113e-03 -1.6609412e-03  2.5563349e-04 -5.0858824e-05
 -2.1879005e-03]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00054663  0.02183317 -0.01013779  0.0275166  -0.01432571]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 9.4681722e-04 -5.6564220e-04  1.6413207e-04 -1.9347448e-05
 -2.6575531e-04]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.00024602 -0.00566599 -0.01362223 -0.01313661  0.00085311]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.006146   -0.00191943  0.00622021  0.000386   -0.01312897]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.0122887  -0.00144696  0.01584001 -0.00941262  0.0004885 ]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.00283096 -0.00140663 -0.00222997  0.00098805  0.00034892]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.17443876  0.09507455  0.14313363 -0.06756604 -0.02331275]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.17443876  0.09507455  0.14313363 -0.06756604 -0.02331275]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.17443876  0.09507455  0.14313363 -0.06756604 -0.02331275]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.02326602 -0.00738657 -0.00742584  0.00590284  0.00212664]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [0.00137547 0.00190603 0.00187997 0.01075594 0.01069329]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04793947 -0.04841899 -0.02262404 -0.04692165  0.06795258]
  [Mamba.__call__] After layer 33 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 33 sample values: [-0.04793947 -0.04841899 -0.02262404 -0.04692165  0.06795258]
[Mamba.__call__] Processing layer 34/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04793947 -0.04841899 -0.02262404 -0.04692165  0.06795258]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04793947 -0.04841899 -0.02262404 -0.04692165  0.06795258]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.98912895 -0.9990228  -0.46679887 -0.9681283   1.4020569 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.98912895 -0.9990228  -0.46679887 -0.9681283   1.4020569 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.98912895 -0.9990228  -0.46679887 -0.9681283   1.4020569 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.20978285 -0.48633444  0.02255692 -0.23103656 -0.8115878 ]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.20978285 -0.48633444  0.02255692 -0.23103656 -0.8115878 ]
  [MambaBlock.__call__] res sample values: [ 0.14738938 -0.13660158  0.58900654  0.2551583  -0.18044844]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.19118549  0.09093563  0.0063396   0.10413476 -0.21383758]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.10470298  0.04753371  0.00317985  0.05477595 -0.09553052]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.00838467 -0.04500492 -0.08121627  0.06669389  0.1289047 ]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.00838467 -0.04500492 -0.08121627  0.06669389  0.1289047 ]
  [MambaBlock.ssm] B sample values: [-0.0179939  -0.09555326 -0.14210823  0.11355095  0.0016885 ]
  [MambaBlock.ssm] C sample values: [-0.04222718  0.0742555   0.00856703 -0.22936723  0.07056975]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.6234315  0.74990255 0.6220511  0.71938986 0.6165748 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.53610164 0.28740498 0.15407827 0.08260162 0.04428286]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00117455 -0.00623725 -0.00927613  0.00741205  0.00011022]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00117455 -0.00623725 -0.00927613  0.00741205  0.00011022]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-1.9478663e-03 -1.0636973e-03 -5.9026097e-05 -1.1758871e-03
  1.7576781e-03]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00406307 -0.00303576  0.00113168 -0.00041898  0.00475107]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.00247597  0.01034818  0.00061736 -0.00180937  0.00874009]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.01664525  0.00175633  0.00073697  0.00236105  0.01023805]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00508081  0.01632919  0.00144038 -0.00030184 -0.00208143]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.08867006  0.0883768  -0.02749555 -0.0185856   0.0160403 ]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.01000564 -0.0015065  -0.00016971  0.00017579 -0.00898463]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.03623798  0.01514507  0.00253608 -0.00399097  0.01471827]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [0.00277597 0.00236408 0.00077159 0.00108761 0.00300017]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-1.9478663e-03 -1.0636973e-03 -5.9026097e-05 -1.1758871e-03
  1.7576781e-03]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.10275511  0.04647002  0.00312082  0.05360006 -0.09377284]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.10275511  0.04647002  0.00312082  0.05360006 -0.09377284]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.10275511  0.04647002  0.00312082  0.05360006 -0.09377284]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.00812955 -0.00295749  0.00118221  0.00770597  0.0076993 ]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.00189805  0.00423161  0.01329127  0.00026102 -0.00571402]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04604142 -0.04418737 -0.00933277 -0.04666063  0.06223856]
  [Mamba.__call__] After layer 34 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 34 sample values: [-0.04604142 -0.04418737 -0.00933277 -0.04666063  0.06223856]
[Mamba.__call__] Processing layer 35/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04604142 -0.04418737 -0.00933277 -0.04666063  0.06223856]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04604142 -0.04418737 -0.00933277 -0.04666063  0.06223856]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.93779874 -0.9000344  -0.19009535 -0.9504111   1.2677115 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.93779874 -0.9000344  -0.19009535 -0.9504111   1.2677115 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.93779874 -0.9000344  -0.19009535 -0.9504111   1.2677115 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.1459752  -0.19095276  0.2761076  -0.6080187  -0.28702873]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.1459752  -0.19095276  0.2761076  -0.6080187  -0.28702873]
  [MambaBlock.__call__] res sample values: [-0.10533716  0.04291093 -0.25894776 -0.14802387  0.24853966]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.04272345 -0.00610028 -0.11017659  0.22271019  0.02703937]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.02090547 -0.00304084 -0.05205664  0.12370405  0.01370246]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.08030091 -0.01001666  0.05281096  0.00561876  0.16167206]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.08030091 -0.01001666  0.05281096  0.00561876  0.16167206]
  [MambaBlock.ssm] B sample values: [ 0.02856679  0.04688047  0.01065406  0.02399967 -0.10469808]
  [MambaBlock.ssm] C sample values: [-0.06267679  0.01090002 -0.06932996  0.0318213   0.1084212 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.7473396  0.6806929  0.6881919  0.69339144 0.6998791 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.4736249  0.22432055 0.10624381 0.05031971 0.02383267]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00044631 -0.00073244 -0.00016645 -0.00037496  0.00163575]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00044631 -0.00073244 -0.00016645 -0.00037496  0.00163575]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.0010741   0.0001423   0.00246294 -0.005897   -0.00065931]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00029835  0.00031043 -0.00043615 -0.00011847 -0.00030976]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-6.4722328e-05 -8.0090173e-04  2.6248212e-03  4.9261451e-03
 -2.6322103e-03]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [0.00017152 0.00265319 0.00166453 0.00913527 0.00239687]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-3.84254963e-04  2.55154118e-05 -1.01300175e-04  3.22781736e-03
  7.34709101e-06]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.01318865  0.0087703   0.022057   -0.011783    0.01739632]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.01378176  0.04418583 -0.00483186  0.05228982 -0.03541344]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.01491298  0.00091642  0.00745696  0.00255877  0.01039335]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.00473316 -0.02594635 -0.00781708  0.02002996  0.03979832]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.0010741   0.0001423   0.00246294 -0.005897   -0.00065931]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.01983137 -0.00289853 -0.0495937   0.11780705  0.01304314]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.01983137 -0.00289853 -0.0495937   0.11780705  0.01304314]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.01983137 -0.00289853 -0.0495937   0.11780705  0.01304314]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 9.8952884e-04 -6.3523483e-05  5.5943402e-03 -8.0749840e-03
  1.8212642e-03]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.00654715  0.00550357 -0.00696169  0.01123937  0.00906665]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.03949427 -0.03868381 -0.01629446 -0.03542126  0.0713052 ]
  [Mamba.__call__] After layer 35 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 35 sample values: [-0.03949427 -0.03868381 -0.01629446 -0.03542126  0.0713052 ]
[Mamba.__call__] Processing layer 36/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.03949427 -0.03868381 -0.01629446 -0.03542126  0.0713052 ]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.03949427 -0.03868381 -0.01629446 -0.03542126  0.0713052 ]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.7993477  -0.7829444  -0.32979324 -0.7169117   1.4431878 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.7993477  -0.7829444  -0.32979324 -0.7169117   1.4431878 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.7993477  -0.7829444  -0.32979324 -0.7169117   1.4431878 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.6472515  -0.40468574 -0.04963793 -0.34855986  0.26163968]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.6472515  -0.40468574 -0.04963793 -0.34855986  0.26163968]
  [MambaBlock.__call__] res sample values: [-0.42550284 -0.8414574  -0.557959   -0.38456652  0.20683956]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.19693647 -0.1858743   0.04131525  0.13880825 -0.0875374 ]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.08880346 -0.08432462  0.0210843   0.07421334 -0.04185422]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.16228338  0.01741141  0.02867307 -0.02668476 -0.03722709]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.16228338  0.01741141  0.02867307 -0.02668476 -0.03722709]
  [MambaBlock.ssm] B sample values: [-0.02324672 -0.07397843 -0.11673928  0.01565743 -0.00809555]
  [MambaBlock.ssm] C sample values: [ 0.02347586 -0.00877228  0.01748528  0.11271431 -0.00104503]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.6754254  0.6857304  0.7741663  0.65923554 0.70772964]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.50893986 0.2590198  0.1318255  0.06709125 0.03414541]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00139434  0.00443724  0.00700204 -0.00093913  0.00048557]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00139434  0.00443724  0.00700204 -0.00093913  0.00048557]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.0024033   0.0023169  -0.00065402 -0.0019603   0.00118688]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.01713843 -0.01802809  0.00215034  0.00342966 -0.00297506]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.00116454  0.00050038 -0.00025363 -0.00029864 -0.00116653]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.0346867   0.03307209  0.00401083  0.01260565  0.03353798]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.01596363  0.00407268  0.00191044 -0.00456976 -0.00709021]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.03307943  0.04017403  0.03099316 -0.07107103  0.02010534]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.08617258 -0.03642274 -0.00356125 -0.02185925 -0.04091157]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.03118558 -0.0009666   0.00497661 -0.0126865  -0.01683603]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.01043708  0.00894881  0.01355036  0.003857    0.00262564]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.0024033   0.0023169  -0.00065402 -0.0019603   0.00118688]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.08640017 -0.08200771  0.02043028  0.07225304 -0.04066734]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.08640017 -0.08200771  0.02043028  0.07225304 -0.04066734]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.08640017 -0.08200771  0.02043028  0.07225304 -0.04066734]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.01452897  0.02078653 -0.00414956 -0.01125409 -0.00463923]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-3.6946302e-03  7.6721432e-03 -2.6556884e-03 -2.8888695e-05
  6.2664323e-03]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.0431889  -0.03101167 -0.01895015 -0.03545015  0.07757163]
  [Mamba.__call__] After layer 36 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 36 sample values: [-0.0431889  -0.03101167 -0.01895015 -0.03545015  0.07757163]
[Mamba.__call__] Processing layer 37/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.0431889  -0.03101167 -0.01895015 -0.03545015  0.07757163]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.0431889  -0.03101167 -0.01895015 -0.03545015  0.07757163]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.87011325 -0.6247823  -0.3817828  -0.71420306  1.5628114 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.87011325 -0.6247823  -0.3817828  -0.71420306  1.5628114 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.87011325 -0.6247823  -0.3817828  -0.71420306  1.5628114 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.0403419   0.4757202  -0.19305263 -0.39817291  0.11026311]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.0403419   0.4757202  -0.19305263 -0.39817291  0.11026311]
  [MambaBlock.__call__] res sample values: [-0.38541967  0.1723286   0.09168632  0.10119499 -0.00809312]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.04014797  0.32563588 -0.10134061 -0.1991217  -0.10379165]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.02047689  0.18909582 -0.04810502 -0.0896811  -0.04920506]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.13246274 -0.01041417 -0.02600212 -0.00299624  0.09886195]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.13246274 -0.01041417 -0.02600212 -0.00299624  0.09886195]
  [MambaBlock.ssm] B sample values: [ 0.03001868 -0.09502883 -0.1802285  -0.07530508 -0.03435494]
  [MambaBlock.ssm] C sample values: [-0.08678862 -0.03496949 -0.07106441 -0.04616526  0.13138852]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.73701024 0.611083   0.6581579  0.6810529  0.6519911 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.4785425  0.22900292 0.10958764 0.05244234 0.02509589]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00045303 -0.00143414 -0.00271995 -0.00113648 -0.00051847]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00045303 -0.00143414 -0.00271995 -0.00113648 -0.00051847]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.00026173  0.002004   -0.00054908 -0.00105925 -0.00055637]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.01729378 -0.00150605  0.04811877  0.00488003 -0.00228872]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.01645634 -0.01946563 -0.00892405  0.00093599 -0.00132716]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00632786 -0.0294405   0.01944313  0.01917466  0.02494601]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00655094  0.01295808 -0.00484171  0.01498567 -0.00651587]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [0.01968982 0.03953052 0.0128104  0.00672837 0.01087664]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.01297081  0.00546069  0.01720073  0.02513071 -0.01478317]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.0085012   0.06637212  0.05332268 -0.004175   -0.02279243]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.00647086 -0.00037614 -0.00644319 -0.00689148  0.00564505]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.00026173  0.002004   -0.00054908 -0.00105925 -0.00055637]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.02073862  0.19109982 -0.0486541  -0.09074035 -0.04976144]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.02073862  0.19109982 -0.0486541  -0.09074035 -0.04976144]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.02073862  0.19109982 -0.0486541  -0.09074035 -0.04976144]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.00323576  0.01788126 -0.00233264 -0.00482334  0.00020055]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00336535  0.01060547  0.00519812 -0.00018141 -0.00532211]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04655425 -0.02040619 -0.01375203 -0.03563156  0.07224952]
  [Mamba.__call__] After layer 37 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 37 sample values: [-0.04655425 -0.02040619 -0.01375203 -0.03563156  0.07224952]
[Mamba.__call__] Processing layer 38/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04655425 -0.02040619 -0.01375203 -0.03563156  0.07224952]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04655425 -0.02040619 -0.01375203 -0.03563156  0.07224952]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.93831307 -0.4112922  -0.27717587 -0.71816343  1.4562081 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.93831307 -0.4112922  -0.27717587 -0.71816343  1.4562081 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.93831307 -0.4112922  -0.27717587 -0.71816343  1.4562081 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.13388854 -0.31287685  0.6988741  -0.7398947   0.60021776]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.13388854 -0.31287685  0.6988741  -0.7398947   0.60021776]
  [MambaBlock.__call__] res sample values: [ 0.03277636 -0.07112015 -0.18795282  0.16777599  0.3530547 ]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.03243207  0.07213628 -0.36816695  0.20325348 -0.10286611]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.0159531   0.03736849 -0.1505744   0.11191932 -0.04879003]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.0083638  -0.16518773 -0.05723254  0.01141129  0.02207888]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.0083638  -0.16518773 -0.05723254  0.01141129  0.02207888]
  [MambaBlock.ssm] B sample values: [ 0.05645436 -0.12413243  0.11523108 -0.08765969  0.05511301]
  [MambaBlock.ssm] C sample values: [ 0.00263838 -0.01449647 -0.1392391   0.04586583  0.09375831]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.6684998  0.7249768  0.66652554 0.78224444 0.6859645 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.5124768  0.2626325  0.13459307 0.06897582 0.0353485 ]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00060207  0.00132383 -0.0012289   0.00093486 -0.00058776]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00060207  0.00132383 -0.0012289   0.00093486 -0.00058776]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 4.7838690e-05 -1.2152418e-04  4.5019540e-04 -3.9271792e-04
  1.5012936e-04]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.0001992  -0.00125803  0.00177816  0.00189308 -0.00186483]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.00065606  0.00242545 -0.00936062 -0.00264543 -0.00040249]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.01778376 -0.00524086  0.00941566 -0.02871094  0.02476453]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.01825736 -0.00257615 -0.00727137  0.04968316  0.0101742 ]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.03135896 -0.03121911 -0.01598454  0.02324678  0.02839629]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00409232 -0.00094593 -0.00418361 -0.00257385 -0.00440271]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.01536442 -0.00771277 -0.00162871  0.00238563  0.00071144]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.00333872  0.01118333 -0.00498311  0.00569155 -0.00122158]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 4.7838690e-05 -1.2152418e-04  4.5019540e-04 -3.9271792e-04
  1.5012936e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.01590526  0.03724696 -0.1501242   0.1115266  -0.0486399 ]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.01590526  0.03724696 -0.1501242   0.1115266  -0.0486399 ]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.01590526  0.03724696 -0.1501242   0.1115266  -0.0486399 ]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.00026493 -0.00127743  0.01278619  0.01013874 -0.01008643]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.0019906   0.00255138  0.00109723 -0.01157127 -0.00679753]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04456365 -0.01785482 -0.01265481 -0.04720283  0.06545199]
  [Mamba.__call__] After layer 38 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 38 sample values: [-0.04456365 -0.01785482 -0.01265481 -0.04720283  0.06545199]
[Mamba.__call__] Processing layer 39/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04456365 -0.01785482 -0.01265481 -0.04720283  0.06545199]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04456365 -0.01785482 -0.01265481 -0.04720283  0.06545199]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.8945092  -0.35839292 -0.25401515 -0.9474844   1.313793  ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.8945092  -0.35839292 -0.25401515 -0.9474844   1.313793  ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.8945092  -0.35839292 -0.25401515 -0.9474844   1.313793  ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.32898608  0.25497806  0.32896826  0.21930861  0.14717117]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.32898608  0.25497806  0.32896826  0.21930861  0.14717117]
  [MambaBlock.__call__] res sample values: [ 0.44696224 -0.37116843  0.08485164  0.11621937  0.43284473]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.0538335   0.04119991 -0.06677286 -0.07099909 -0.00044847]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.02764109  0.02102425 -0.03227219 -0.03423986 -0.00022419]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.01275957 -0.08881846 -0.00967965  0.08027848  0.05007689]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.01275957 -0.08881846 -0.00967965  0.08027848  0.05007689]
  [MambaBlock.ssm] B sample values: [ 0.12721565  0.05419213  0.108647    0.06934224 -0.21200585]
  [MambaBlock.ssm] C sample values: [-0.05415873 -0.10510261  0.02754242  0.15496987 -0.01010339]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.7572652  0.7654899  0.72523594 0.67101485 0.6640312 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.46894714 0.21991143 0.10312682 0.04836104 0.02267877]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00266283  0.00113433  0.00227416  0.00145145 -0.00443763]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00266283  0.00113433  0.00227416  0.00145145 -0.00443763]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-1.54039953e-05 -1.18437802e-05  1.72241325e-05  1.69080322e-05
  1.09554115e-07]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00130585  0.00239451 -0.002758    0.00121386 -0.00048833]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.00164636  0.00300263 -0.00094963 -0.00061106 -0.001481  ]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00011767  0.00096801 -0.00153153 -0.00060109  0.00018187]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 9.8528508e-05 -3.3800027e-04 -9.5080853e-05 -1.0015790e-03
 -1.5115993e-04]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.01281126  0.00613644  0.01558514 -0.00186905 -0.0035906 ]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 4.33653440e-05 -1.21936435e-04 -2.55088580e-05  5.15914035e-05
 -3.90539535e-05]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.00605067 -0.01606714  0.03595913  0.0201856  -0.02330958]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.00090586 -0.00091054  0.0013561  -0.0015545   0.00062711]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-1.54039953e-05 -1.18437802e-05  1.72241325e-05  1.69080322e-05
  1.09554115e-07]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.02762569  0.02101241 -0.03225496 -0.03422295 -0.00022408]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.02762569  0.02101241 -0.03225496 -0.03422295 -0.00022408]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.02762569  0.02101241 -0.03225496 -0.03422295 -0.00022408]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 7.5310310e-03 -3.1840682e-03 -1.4264659e-03 -2.1041166e-03
 -5.8830050e-05]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.00073799 -0.00384778 -0.00028066 -0.01258643 -0.01370616]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04382566 -0.0217026  -0.01293547 -0.05978926  0.05174584]
  [Mamba.__call__] After layer 39 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 39 sample values: [-0.04382566 -0.0217026  -0.01293547 -0.05978926  0.05174584]
[Mamba.__call__] Processing layer 40/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04382566 -0.0217026  -0.01293547 -0.05978926  0.05174584]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04382566 -0.0217026  -0.01293547 -0.05978926  0.05174584]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.87120515 -0.43142343 -0.2571427  -1.1885436   1.0286493 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.87120515 -0.43142343 -0.2571427  -1.1885436   1.0286493 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.87120515 -0.43142343 -0.2571427  -1.1885436   1.0286493 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.25920135  0.27333033 -0.01855251 -0.16116722 -0.15247896]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.25920135  0.27333033 -0.01855251 -0.16116722 -0.15247896]
  [MambaBlock.__call__] res sample values: [-0.38321865  0.35784566  0.3102713  -0.5286589  -0.5741119 ]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.15740211  0.12585464  0.00378508  0.17488492 -0.15218416]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.08488216  0.06688195  0.00189612  0.09506921 -0.07031322]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.03631699  0.09744878  0.12390147  0.06479356 -0.04059953]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.03631699  0.09744878  0.12390147  0.06479356 -0.04059953]
  [MambaBlock.ssm] B sample values: [-0.11797079 -0.10523035  0.08453059  0.134595    0.14859   ]
  [MambaBlock.ssm] C sample values: [-0.03221335 -0.02756305  0.16076846  0.09889282  0.08511577]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.6893727  0.67037725 0.6961303  0.6420089  0.66573423]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.5018908  0.25189438 0.12642348 0.06345078 0.03184536]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00690311 -0.0061576   0.00494635  0.00787589  0.00869481]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00690311 -0.0061576   0.00494635  0.00787589  0.00869481]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 4.3406147e-03  3.3258982e-03  9.7912394e-05  4.5275339e-03
 -3.4723112e-03]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00459757  0.00300187  0.00328342  0.00776631  0.00696466]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.00565467  0.00175337  0.00301535  0.00512191 -0.00087453]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00552173  0.00229993 -0.0067085  -0.0015275  -0.01031794]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00721134 -0.00797768  0.01847576  0.00667472  0.02384363]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00954833  0.04926848 -0.00993585 -0.01707242 -0.0113244 ]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00507027 -0.00438912  0.01001791 -0.00687028  0.00675182]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.00391447  0.0152857  -0.02463515  0.01233402  0.00326805]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.00672421 -0.00922314  0.01052764  0.00225854  0.00213448]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 4.3406147e-03  3.3258982e-03  9.7912394e-05  4.5275339e-03
 -3.4723112e-03]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.08922277  0.07020785  0.00199404  0.09959675 -0.07378554]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.08922277  0.07020785  0.00199404  0.09959675 -0.07378554]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.08922277  0.07020785  0.00199404  0.09959675 -0.07378554]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.01385969  0.0147857   0.00035696 -0.01952519  0.01526224]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00168346 -0.00337785 -0.00236747  0.00160409 -0.00164798]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04550913 -0.02508045 -0.01530294 -0.05818517  0.05009785]
  [Mamba.__call__] After layer 40 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 40 sample values: [-0.04550913 -0.02508045 -0.01530294 -0.05818517  0.05009785]
[Mamba.__call__] Processing layer 41/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04550913 -0.02508045 -0.01530294 -0.05818517  0.05009785]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04550913 -0.02508045 -0.01530294 -0.05818517  0.05009785]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.90455544 -0.49850786 -0.30416664 -1.1565089   0.9957626 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.90455544 -0.49850786 -0.30416664 -1.1565089   0.9957626 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.90455544 -0.49850786 -0.30416664 -1.1565089   0.9957626 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.06962955  0.37037724 -0.20324539  0.5235449  -0.09748607]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.06962955  0.37037724 -0.20324539  0.5235449  -0.09748607]
  [MambaBlock.__call__] res sample values: [-0.24069473  0.05258161 -0.20090678  0.05493206 -0.18111357]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.02990323  0.34839642  0.01136114 -0.04620234 -0.04479955]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.01517515  0.20423996  0.00571284 -0.0225676  -0.02189811]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.0788461  -0.11848291  0.06687447 -0.02804792 -0.00088139]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.0788461  -0.11848291  0.06687447 -0.02804792 -0.00088139]
  [MambaBlock.ssm] B sample values: [-0.10893756  0.10766779  0.02015952  0.12994413  0.00651379]
  [MambaBlock.ssm] C sample values: [-0.07020325 -0.0518119   0.05398779  0.1241828   0.13028151]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.6612883 0.7080491 0.6976295 0.6283237 0.6480192]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.5161859  0.26644787 0.13753663 0.07099447 0.03664635]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-1.0932047e-03  1.0804624e-03  2.0230378e-04  1.3040088e-03
  6.5366854e-05]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-1.0932047e-03  1.0804624e-03  2.0230378e-04  1.3040088e-03
  6.5366854e-05]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.00066478  0.00957988  0.00026402 -0.00093934 -0.00094005]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00458812 -0.00075003  0.00331077 -0.00515983 -0.00173153]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.00082273 -0.00444167 -0.00059714  0.00016607  0.00073626]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00374037 -0.00024534  0.0002217  -0.00219918 -0.00246777]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 7.1510462e-05 -1.2923775e-02  1.5053387e-03  2.8770568e-03
 -7.4861287e-05]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 1.8959668e-03 -9.2470247e-05  5.9066646e-05 -1.5175948e-04
 -4.8662616e-05]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00012433  0.00067282 -0.00113386  0.0005034   0.00010951]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.00174141 -0.01138452  0.0047459   0.0129813  -0.00271006]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.01030369 -0.00044668 -0.02361907 -0.01617542 -0.00512652]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.00066478  0.00957988  0.00026402 -0.00093934 -0.00094005]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.01583993  0.21381985  0.00597686 -0.02350695 -0.02283815]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.01583993  0.21381985  0.00597686 -0.02350695 -0.02283815]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.01583993  0.21381985  0.00597686 -0.02350695 -0.02283815]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.00167798  0.00576925 -0.00054029 -0.00066337  0.00188138]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00507816  0.00573345 -0.00843065 -0.00358266  0.006712  ]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.05058729 -0.019347   -0.02373359 -0.06176782  0.05680985]
  [Mamba.__call__] After layer 41 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 41 sample values: [-0.05058729 -0.019347   -0.02373359 -0.06176782  0.05680985]
[Mamba.__call__] Processing layer 42/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.05058729 -0.019347   -0.02373359 -0.06176782  0.05680985]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.05058729 -0.019347   -0.02373359 -0.06176782  0.05680985]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.9869247 -0.3774472 -0.4630268 -1.2050496  1.1083229]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.9869247 -0.3774472 -0.4630268 -1.2050496  1.1083229]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.9869247 -0.3774472 -0.4630268 -1.2050496  1.1083229]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.6306951   0.3499838  -0.22747079  0.01698814  0.8532171 ]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.6306951   0.3499838  -0.22747079  0.01698814  0.8532171 ]
  [MambaBlock.__call__] res sample values: [ 0.06144834 -0.34553012  0.35473454 -0.34438875 -0.00830206]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.38544536 -0.24467802  0.08669784  0.00165702 -0.79790527]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.2294116  -0.1074464   0.04522688  0.0008292  -0.24772868]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.15455227  0.04506875 -0.08497606 -0.02226547 -0.02282324]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.15455227  0.04506875 -0.08497606 -0.02226547 -0.02282324]
  [MambaBlock.ssm] B sample values: [-0.09076506 -0.0770181  -0.02427951  0.09930438  0.04475799]
  [MambaBlock.ssm] C sample values: [-0.03271177  0.0748641   0.06968328  0.08076995  0.07035727]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.6981048  0.6948245  0.7101263  0.724401   0.71975917]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.49752733 0.24753344 0.12315466 0.0612728  0.03048489]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.01453633 -0.01233471 -0.00388844  0.01590393  0.00716814]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.01453633 -0.01233471 -0.00388844  0.01590393  0.00716814]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 6.7011127e-03 -3.1237623e-03  1.3438263e-03  2.5133239e-05
 -7.4606114e-03]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.0005446   0.00100572  0.00939063 -0.00877856  0.01335489]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.0029816   0.00344991 -0.00067486 -0.00032682 -0.00540658]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.0023022   0.01203973 -0.02893767  0.00099403 -0.02394044]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.01372062 -0.00492952  0.00344722  0.01128625  0.012527  ]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.01636985 -0.0147424   0.02523179 -0.00862135  0.00603283]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.02067191 -0.01998538  0.00386721 -0.01063041 -0.01366922]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.00615254 -0.02170943  0.03124311 -0.01051548 -0.01406887]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.00209929 -0.00676508 -0.00313628  0.0026512  -0.00398275]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 6.7011127e-03 -3.1237623e-03  1.3438263e-03  2.5133239e-05
 -7.4606114e-03]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.23611271 -0.11057016  0.0465707   0.00085433 -0.2551893 ]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.23611271 -0.11057016  0.0465707   0.00085433 -0.2551893 ]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.23611271 -0.11057016  0.0465707   0.00085433 -0.2551893 ]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.00747718  0.01583483  0.00971002 -0.00012203  0.0010549 ]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 1.07193377e-03 -2.59060785e-03  9.66754742e-05 -4.54032328e-04
  1.08471885e-02]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04951536 -0.0219376  -0.02363692 -0.06222185  0.06765704]
  [Mamba.__call__] After layer 42 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 42 sample values: [-0.04951536 -0.0219376  -0.02363692 -0.06222185  0.06765704]
[Mamba.__call__] Processing layer 43/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04951536 -0.0219376  -0.02363692 -0.06222185  0.06765704]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04951536 -0.0219376  -0.02363692 -0.06222185  0.06765704]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.9567036  -0.4238642  -0.45669723 -1.2022103   1.3072255 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.9567036  -0.4238642  -0.45669723 -1.2022103   1.3072255 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.9567036  -0.4238642  -0.45669723 -1.2022103   1.3072255 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.30253458 -0.04239291  0.43572924 -0.18393017  0.3687991 ]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.30253458 -0.04239291  0.43572924 -0.18393017  0.3687991 ]
  [MambaBlock.__call__] res sample values: [ 0.0309597   0.26791006 -0.14956418 -0.20133027  0.32258797]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.16314559  0.01270849  0.23574506 -0.08030473  0.19004801]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.07493339  0.00639462  0.13170247 -0.03854102  0.10402649]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.02432492 -0.11380816 -0.03344389 -0.02655293 -0.16117851]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.02432492 -0.11380816 -0.03344389 -0.02655293 -0.16117851]
  [MambaBlock.ssm] B sample values: [ 0.08858021 -0.00608135  0.03950667 -0.06309524  0.09893464]
  [MambaBlock.ssm] C sample values: [ 0.01632853 -0.10742038  0.00673261  0.10804898  0.03016156]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.64325184 0.6625308  0.7072856  0.6544112  0.6529566 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.5255805  0.2762349  0.1451837  0.07630572 0.0401048 ]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00426966  0.00029313 -0.00190426  0.00304126 -0.00476875]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00426966  0.00029313 -0.00190426  0.00304126 -0.00476875]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.0014533  -0.00012774 -0.00280858  0.00076045 -0.00204798]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00888829 -0.00517611  0.02021658 -0.00507648 -0.01347805]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.00294451 -0.00088573  0.0062164  -0.00307106  0.00045047]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00715955 -0.00279333 -0.00187755 -0.00783403  0.00259948]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00760307  0.02521051 -0.03430955  0.00692236  0.00931618]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.02939785  0.02371327 -0.00958927  0.02127668 -0.03099955]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.01252567 -0.02275153  0.00142721  0.00571618  0.00569757]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.01470507  0.00567915 -0.00161645  0.00086823 -0.00077952]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.00178229 -0.01810012  0.04796138  0.06344201 -0.00125901]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.0014533  -0.00012774 -0.00280858  0.00076045 -0.00204798]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.0734801   0.00626688  0.12889388 -0.03778057  0.10197851]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.0734801   0.00626688  0.12889388 -0.03778057  0.10197851]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.0734801   0.00626688  0.12889388 -0.03778057  0.10197851]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.00115507  0.00095127 -0.00891947  0.00342163  0.0190788 ]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.00048153  0.00929745 -0.00070966 -0.00832468 -0.01162825]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04903382 -0.01264015 -0.02434658 -0.07054654  0.05602879]
  [Mamba.__call__] After layer 43 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 43 sample values: [-0.04903382 -0.01264015 -0.02434658 -0.07054654  0.05602879]
[Mamba.__call__] Processing layer 44/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04903382 -0.01264015 -0.02434658 -0.07054654  0.05602879]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.04903382 -0.01264015 -0.02434658 -0.07054654  0.05602879]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.94098055 -0.24257006 -0.46722147 -1.353819    1.0752171 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-0.94098055 -0.24257006 -0.46722147 -1.353819    1.0752171 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-0.94098055 -0.24257006 -0.46722147 -1.353819    1.0752171 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.43186748  0.6893827  -0.42760515  0.06884042 -0.4568298 ]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.43186748  0.6893827  -0.42760515  0.06884042 -0.4568298 ]
  [MambaBlock.__call__] res sample values: [ 0.05690144 -0.42987126 -0.20676899  0.005775    0.17260441]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.1436624  -0.39947495 -0.31691507 -0.00559931 -0.2432448 ]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.06668033 -0.16036461 -0.1335568  -0.00279182 -0.10690289]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.00999878  0.13610223 -0.02136635 -0.07106262  0.05065256]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.00999878  0.13610223 -0.02136635 -0.07106262  0.05065256]
  [MambaBlock.ssm] B sample values: [-0.13181108  0.01126921 -0.02217622 -0.05303349  0.02226624]
  [MambaBlock.ssm] C sample values: [-0.02750031  0.03887086 -0.12225399 -0.09345312 -0.11452704]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.64679813 0.7327948  0.66197336 0.6342684  0.7147182 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.52371997 0.2742826  0.14364728 0.07523095 0.03939995]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00568484 -0.00048603  0.00095643  0.00228727 -0.00096031]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00568484 -0.00048603  0.00095643  0.00228727 -0.00096031]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-1.9419791e-04 -5.2913825e-04 -3.9809302e-04 -7.9733027e-06
 -3.4403495e-04]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00809211  0.00716365  0.00726809  0.00327712 -0.00225017]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 7.2162045e-04 -1.1456206e-04  4.1189676e-04  8.0052545e-05
 -7.8473393e-05]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.01157069 -0.00572334  0.00058422  0.01417807  0.00314711]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.01189695 -0.01817267 -0.01467211  0.00090111 -0.02795121]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.01775527  0.00115399 -0.00733452  0.00488601  0.00151347]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.00517345 -0.01851642 -0.01742374 -0.00069607 -0.00644838]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.00913037  0.00372028  0.00479093  0.00722684  0.01365759]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.00197126 -0.00154242  0.00387336  0.00635854 -0.00401   ]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-1.9419791e-04 -5.2913825e-04 -3.9809302e-04 -7.9733027e-06
 -3.4403495e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.06687453 -0.16089375 -0.1339549  -0.00279979 -0.10724693]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.06687453 -0.16089375 -0.1339549  -0.00279979 -0.10724693]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.06687453 -0.16089375 -0.1339549  -0.00279979 -0.10724693]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-1.9567453e-03  2.7261321e-02  1.2422182e-02 -8.1077360e-06
 -1.0052452e-02]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-4.419927e-03  8.460635e-05 -4.928682e-03  4.357120e-03  7.820508e-03]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.05345375 -0.01255555 -0.02927526 -0.06618942  0.0638493 ]
  [Mamba.__call__] After layer 44 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 44 sample values: [-0.05345375 -0.01255555 -0.02927526 -0.06618942  0.0638493 ]
[Mamba.__call__] Processing layer 45/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.05345375 -0.01255555 -0.02927526 -0.06618942  0.0638493 ]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.05345375 -0.01255555 -0.02927526 -0.06618942  0.0638493 ]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.0178677  -0.23908302 -0.55746025 -1.2603806   1.2158201 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.0178677  -0.23908302 -0.55746025 -1.2603806   1.2158201 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.0178677  -0.23908302 -0.55746025 -1.2603806   1.2158201 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.22721377  0.15365355  0.51938725  0.05498247  0.15105318]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [-0.22721377  0.15365355  0.51938725  0.05498247  0.15105318]
  [MambaBlock.__call__] res sample values: [ 0.19377947 -0.5044696  -0.04473845 -0.12731722  0.35484827]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.06252973 -0.08110309 -0.2676737  -0.00202838 -0.07491878]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.03028769 -0.03890802 -0.11603074 -0.00101316 -0.03605684]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.00763848 -0.07107121 -0.11305706 -0.06873381  0.05614575]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.00763848 -0.07107121 -0.11305706 -0.06873381  0.05614575]
  [MambaBlock.ssm] B sample values: [ 0.04152066 -0.0725574  -0.04112023  0.0214272   0.06489638]
  [MambaBlock.ssm] C sample values: [ 0.06603286  0.06582448  0.01993078  0.02669126 -0.02532237]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.7195435  0.68308675 0.60538507 0.7003686  0.63688385]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.4869745  0.23714417 0.11548316 0.05623735 0.02738616]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00090487  0.00158127  0.00089615 -0.00046697 -0.00141431]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00090487  0.00158127  0.00089615 -0.00046697 -0.00141431]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [3.27234913e-04 3.99072072e-04 1.05472980e-03 1.06546895e-05
 3.44813598e-04]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.0008572   0.00232525  0.00130668  0.00384187 -0.00073623]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.00071566 -0.00033905 -0.00135385 -0.0001048  -0.00288054]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.02625716  0.00824516 -0.00183431  0.00374824 -0.00761163]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.01316281  0.00680421 -0.00331477  0.00176168 -0.00051012]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.02627748 -0.00013175  0.00498734  0.00895342  0.01772685]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.02060807  0.03926216 -0.00645471 -0.00906897 -0.03642833]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [-0.01844923 -0.00779909 -0.00321002 -0.03454929  0.00563595]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.02301363 -0.02199109  0.00528053 -0.01786121 -0.00061269]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [3.27234913e-04 3.99072072e-04 1.05472980e-03 1.06546895e-05
 3.44813598e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.02996046 -0.03850894 -0.11497601 -0.0010025  -0.03571203]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.02996046 -0.03850894 -0.11497601 -0.0010025  -0.03571203]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.02996046 -0.03850894 -0.11497601 -0.0010025  -0.03571203]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-3.1832412e-03  7.3139342e-03  2.5144015e-03  5.9760947e-05
 -7.4487170e-03]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00282092 -0.00806525 -0.01113268  0.00183685 -0.01193313]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.05627467 -0.0206208  -0.04040794 -0.06435256  0.05191617]
  [Mamba.__call__] After layer 45 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 45 sample values: [-0.05627467 -0.0206208  -0.04040794 -0.06435256  0.05191617]
[Mamba.__call__] Processing layer 46/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.05627467 -0.0206208  -0.04040794 -0.06435256  0.05191617]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.05627467 -0.0206208  -0.04040794 -0.06435256  0.05191617]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.0658165  -0.39054847 -0.7653079  -1.2188082   0.98326844]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.0658165  -0.39054847 -0.7653079  -1.2188082   0.98326844]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.0658165  -0.39054847 -0.7653079  -1.2188082   0.98326844]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.3870418   0.21962571 -0.04663984  0.05761097 -0.08475763]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.3870418   0.21962571 -0.04663984  0.05761097 -0.08475763]
  [MambaBlock.__call__] res sample values: [-0.20734406 -0.43924493  0.19553997  0.52536035  0.76536536]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.02546723 -0.13269572  0.04707214 -0.00434594  0.03775861]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.01257148 -0.06195227  0.02408991 -0.00216825  0.01923569]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.04408187 -0.1039516   0.0840376  -0.07572225  0.11317864]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [-0.04408187 -0.1039516   0.0840376  -0.07572225  0.11317864]
  [MambaBlock.ssm] B sample values: [-0.04510643  0.08134398 -0.1324924  -0.1150676  -0.03403888]
  [MambaBlock.ssm] C sample values: [-0.00025875  0.08464012  0.01980321 -0.07850024  0.10507657]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.6830891 0.7145489 0.6942581 0.6569207 0.7207642]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.5050544  0.25507998 0.12882927 0.06506579 0.03286177]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00038735 -0.00069854  0.00113777  0.00098814  0.00029231]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00038735 -0.00069854  0.00113777  0.00098814  0.00029231]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 5.0072034e-04  2.5811943e-03 -9.7518665e-04  8.3052611e-05
 -8.0841151e-04]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.004657   -0.00363712  0.004815   -0.00597294 -0.00283419]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.00204539 -0.00447586  0.00056287  0.00037738 -0.00054024]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00186084 -0.00430427 -0.0143379  -0.00085063  0.00238125]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.0110474  -0.01048831  0.00395301 -0.00128294 -0.00829368]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00902754  0.00118333 -0.0017342  -0.00249076  0.00551274]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-1.0507117e-03  1.0016182e-03 -6.1456754e-05  7.5355108e-04
  9.1650197e-04]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 4.5097247e-03  6.0348550e-04 -3.8843445e-04  4.1119580e-05
  4.2776263e-04]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [ 0.00073209 -0.0038148   0.00445224 -0.00042954  0.00239299]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 5.0072034e-04  2.5811943e-03 -9.7518665e-04  8.3052611e-05
 -8.0841151e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.01207076 -0.05937108  0.02311473 -0.00208519  0.01842728]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.01207076 -0.05937108  0.02311473 -0.00208519  0.01842728]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.01207076 -0.05937108  0.02311473 -0.00208519  0.01842728]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.00112213  0.01022069  0.00248018 -0.0006884   0.00962595]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-1.00280764e-03  9.52749397e-05  6.08949503e-03 -1.45556545e-02
 -5.72624244e-03]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.05727747 -0.02052552 -0.03431845 -0.07890822  0.04618993]
  [Mamba.__call__] After layer 46 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 46 sample values: [-0.05727747 -0.02052552 -0.03431845 -0.07890822  0.04618993]
[Mamba.__call__] Processing layer 47/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.05727747 -0.02052552 -0.03431845 -0.07890822  0.04618993]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.05727747 -0.02052552 -0.03431845 -0.07890822  0.04618993]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.0772893  -0.38604924 -0.6454701  -1.4841259   0.8687519 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.0772893  -0.38604924 -0.6454701  -1.4841259   0.8687519 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.0772893  -0.38604924 -0.6454701  -1.4841259   0.8687519 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.15324675 -0.20876497  0.04846648 -0.28036338  0.3531273 ]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.15324675 -0.20876497  0.04846648 -0.28036338  0.3531273 ]
  [MambaBlock.__call__] res sample values: [ 0.38407794 -0.33039254 -0.1266176   0.11163174  0.20546773]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.07328221 -0.01534208  0.0212183   0.01683897 -0.05922417]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.03798308 -0.0076122   0.0107217   0.00849037 -0.02873546]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.02677025 -0.07085651 -0.04422054  0.00143856 -0.07383899]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.02677025 -0.07085651 -0.04422054  0.00143856 -0.07383899]
  [MambaBlock.ssm] B sample values: [ 0.03761881 -0.05008774 -0.15880208 -0.00492932 -0.00471512]
  [MambaBlock.ssm] C sample values: [-0.04223432 -0.00579872  0.10055156 -0.14315492  0.07306531]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.73784226 0.6434542  0.7737254  0.7669838  0.68174213]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.47814453 0.22862217 0.10931445 0.0522681  0.0249917 ]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00105429 -0.00140374 -0.00445051 -0.00013815 -0.00013214]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00105429 -0.00140374 -0.00445051 -0.00013815 -0.00013214]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-4.8370066e-04  8.4537714e-05 -1.4317708e-04 -1.1239211e-04
  3.3811259e-04]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00602081 -0.00870874  0.00402107  0.00898027 -0.009365  ]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.00461686  0.00355822 -0.00411907 -0.00197402 -0.00221639]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00312681  0.02688997 -0.0040801   0.00979647 -0.01747194]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 1.3008902e-03 -2.2135009e-05  1.2032518e-03 -3.0306241e-04
  2.3875122e-05]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.02848634 -0.00246534 -0.00798559  0.00225488 -0.023434  ]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.0013094   0.00065075  0.00064336 -0.0009948  -0.00064579]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.0159126  -0.00163853 -0.00141473  0.00167003 -0.0050984 ]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [0.00448976 0.00540164 0.00579794 0.01149006 0.00592491]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-4.8370066e-04  8.4537714e-05 -1.4317708e-04 -1.1239211e-04
  3.3811259e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.03749938 -0.00752766  0.01057852  0.00837798 -0.02839735]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.03749938 -0.00752766  0.01057852  0.00837798 -0.02839735]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.03749938 -0.00752766  0.01057852  0.00837798 -0.02839735]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.00856753  0.00103996 -0.00062737  0.0004937  -0.00321603]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.0043726   0.00098381 -0.00753237 -0.0059488   0.00298144]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.06165008 -0.01954171 -0.04185082 -0.08485702  0.04917137]
  [Mamba.__call__] After layer 47 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 47 sample values: [-0.06165008 -0.01954171 -0.04185082 -0.08485702  0.04917137]
[Mamba.__call__] Processing layer 48/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 5, 1024)
[ResidualBlock.__call__] Input sample values: [-0.06165008 -0.01954171 -0.04185082 -0.08485702  0.04917137]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.06165008 -0.01954171 -0.04185082 -0.08485702  0.04917137]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.1497519  -0.36444592 -0.7805028  -1.5825531   0.9170284 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.1497519  -0.36444592 -0.7805028  -1.5825531   0.9170284 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.        0.6931472 1.0986123 1.3862944 1.609438 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 5, 1024)
[MambaBlock.__call__] Input sample values: [-1.1497519  -0.36444592 -0.7805028  -1.5825531   0.9170284 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 5, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 5, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.14814681 -0.11738553  0.5773206   0.10544111  0.3305812 ]
  [MambaBlock.__call__] Split into x shape: (1, 5, 2048), res shape: (1, 5, 2048)
  [MambaBlock.__call__] x sample values: [ 0.14814681 -0.11738553  0.5773206   0.10544111  0.3305812 ]
  [MambaBlock.__call__] res sample values: [ 0.08776866  0.1525037   0.49663147 -0.47864074  0.39047614]
  [MambaBlock.__call__] After conv1d shape: (1, 5, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.0360928   0.02167748  0.41234052 -0.02820797  0.03656574]
  [MambaBlock.__call__] After SiLU activation shape: (1, 5, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.01837203  0.01095621  0.24808426 -0.01390508  0.0186171 ]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1. -2. -3. -4. -5.]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [1. 1. 1. 1. 1.]
  [MambaBlock.ssm] x_proj output shape: (1, 5, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.15623441  0.05191175 -0.08958276  0.04115549 -0.10931767]
  [MambaBlock.ssm] Split into delta shape: (1, 5, 64), B shape: (1, 5, 16), C shape: (1, 5, 16)
  [MambaBlock.ssm] delta sample values: [ 0.15623441  0.05191175 -0.08958276  0.04115549 -0.10931767]
  [MambaBlock.ssm] B sample values: [0.17715925 0.03027418 0.02205754 0.01247556 0.04904895]
  [MambaBlock.ssm] C sample values: [ 0.0274049   0.0371599   0.03968757 -0.25024658 -0.03097548]
  [MambaBlock.ssm] delta after softplus shape: (1, 5, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.6263845  0.7378953  0.69414765 0.7079018  0.7679058 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 5, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.53452086 0.28571257 0.15271933 0.08163167 0.04363383]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 5, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [0.00203874 0.00034839 0.00025384 0.00014357 0.00056445]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/5:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [0.00203874 0.00034839 0.00025384 0.00014357 0.00056445]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.00042892 -0.00030132 -0.00641846  0.00036688 -0.00053284]
  [MambaBlock.selective_scan] Step 2/5:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00373433  0.00046401 -0.00215215 -0.00245831 -0.00233809]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 7.5414457e-04 -8.3159852e-05  3.9787772e-03  2.9445317e-04
 -2.8952825e-04]
  [MambaBlock.selective_scan] Step 3/5:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00445949  0.00241564 -0.00094645 -0.00110825 -0.00188954]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00228808  0.00803915 -0.06443053 -0.01227852 -0.00674175]
  [MambaBlock.selective_scan] Step 4/5:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.03433834 -0.0330007  -0.01610226 -0.01797933 -0.00493996]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.0368118   0.0330434  -0.11108649 -0.00232221  0.0235968 ]
  [MambaBlock.selective_scan] Step 5/5:
    [Step 5] x shape: (1, 2048, 16)
    [Step 5] x sample values: [ 0.03715254 -0.00872678 -0.01763699  0.04305932 -0.01537137]
    [Step 5] y shape: (1, 2048)
    [Step 5] y sample values: [-0.01535622  0.00554152 -0.05042148 -0.00014186 -0.01060178]
  [MambaBlock.selective_scan] Stacked y shape: (1, 5, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.00042892 -0.00030132 -0.00641846  0.00036688 -0.00053284]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 5, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.01794311  0.01065489  0.24166581 -0.01353819  0.01808425]
  [MambaBlock.ssm] selective_scan output shape: (1, 5, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.01794311  0.01065489  0.24166581 -0.01353819  0.01808425]
  [MambaBlock.__call__] After SSM shape: (1, 5, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.01794311  0.01065489  0.24166581 -0.01353819  0.01808425]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 5, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [0.00082195 0.00087429 0.07461181 0.00247905 0.00421144]
  [MambaBlock.__call__] After out_proj shape: (1, 5, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00364993  0.00551476 -0.00285468  0.01728913 -0.00490956]
[ResidualBlock.__call__] Output shape: (1, 5, 1024)
[ResidualBlock.__call__] Output sample values: [-0.06530001 -0.01402695 -0.04470549 -0.06756789  0.0442618 ]
  [Mamba.__call__] After layer 48 shape: (1, 5, 1024)
  [Mamba.__call__] After layer 48 sample values: [-0.06530001 -0.01402695 -0.04470549 -0.06756789  0.0442618 ]
[RMSNorm.__call__] Input shape: (1, 5, 1024)
[RMSNorm.__call__] Input sample values: [-0.06530001 -0.01402695 -0.04470549 -0.06756789  0.0442618 ]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1. 1. 1. 1. 1.]
  [RMSNorm.__call__] After normalization shape: (1, 5, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.2115232  -0.26024464 -0.8294292  -1.2535995   0.8211974 ]
  [RMSNorm.__call__] Output shape: (1, 5, 1024)
  [RMSNorm.__call__] Output sample values: [-1.2115232  -0.26024464 -0.8294292  -1.2535995   0.8211974 ]
[Mamba.__call__] After final RMSNorm shape: (1, 5, 1024)
[Mamba.__call__] After final RMSNorm sample values: [-1.2115232  -0.26024464 -0.8294292  -1.2535995   0.8211974 ]
[Mamba.__call__] Logits shape: (1, 5, 50280)
[Mamba.__call__] Logits sample values: [-0.45853728  0.36005706  0.16582483  0.8056414  -1.5802741 ]
[convert_from_pytorch] Starting conversion from PyTorch to JAX
[convert_from_pytorch] Conversion completed successfully
[Mamba.from_pretrained] Pretrained weights loaded successfully
[Mamba] Initializing Mamba model.
  [Mamba] Initialized embedding with vocab_size=50280 and d_model=1024
  [Mamba] Initialized 48 ResidualBlocks.
  [Mamba] Initialized final RMSNorm with d_model=1024
[Mamba.__call__] Input_ids shape: (1, 4)
[Mamba.__call__] Input_ids sample values: [   46 31834   310   253]
[Mamba.__call__] Embedding output shape: (1, 4, 1024)
[Mamba.__call__] Embedding output sample values: [-0.25683153  0.07351491 -0.36818528  0.222499    0.11062989]
[Mamba.__call__] Processing layer 1/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-0.25683153  0.07351491 -0.36818528  0.222499    0.11062989]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-0.25683153  0.07351491 -0.36818528  0.222499    0.11062989]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.23679148 0.27415296 0.23131146 0.2524847  0.23810923]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.4227691   0.4072504  -2.0396354   1.2325773   0.61285615]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.33689958  0.1116489  -0.47179103  0.31120694  0.14592671]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [ 1.5923802  -0.52734095  2.8514473  -0.41663435  1.5227609 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [ 0.02908622  0.08374646 -0.055387    0.14781535 -0.02148016]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.33689958  0.1116489  -0.47179103  0.31120694  0.14592671]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.6587616 -0.5707411 -0.7354734  0.502662   1.3531914]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 0.6587616 -0.5707411 -0.7354734  0.502662   1.3531914]
  [MambaBlock.__call__] res sample values: [-0.22943062 -0.6511406   0.58655995  1.8791127  -0.10822596]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.16182682  0.08320747  0.00157368  0.18218094  0.16666818]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.07438068  0.04333361  0.00078746  0.09936507  0.09026264]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -4.9154344   -0.5901722  -17.31282     -0.65926194  -4.584866  ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [ 0.02908622  0.08374646 -0.055387    0.14781535 -0.02148016]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.1944876   0.5079476  -0.0149157   0.09348403 -0.18014874]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.1944876   0.5079476  -0.0149157   0.09348403 -0.18014874]
  [MambaBlock.ssm] B sample values: [-0.38976938  6.040635    0.29196647 -1.0335486   1.6670007 ]
  [MambaBlock.ssm] C sample values: [-0.22988053 -0.47285098  0.3546313  -0.65044266 -0.80882895]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [2.3973665e-01 2.0111239e-01 7.5457908e-02 9.3861108e-06 3.0795828e-01]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.3077678  0.8680674  0.01575626 0.85380775 0.33315068]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00695028 -0.10771524 -0.00520628  0.01843001 -0.02972558]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00695028 -0.10771524 -0.00520628  0.01843001 -0.02972558]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-2.7932864e-02  1.3651635e-02  9.3079449e-05  1.4609668e-06
  4.3543234e-02]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00315711 -0.09662321 -0.00069691  0.01633504 -0.01596365]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-3.5509720e-02  1.2610982e-01  2.6968023e-02  1.7645465e-05
 -1.0778664e-02]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00198832 -0.09993184 -0.00195308  0.016786   -0.01146659]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-1.4250996e-02  1.1183688e-02 -3.5494339e-04  3.8219769e-05
  1.1200845e-02]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-2.3936154e-06 -9.8769397e-02  3.2128138e-04  1.6775124e-02
 -9.6113617e-03]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00860088  0.00087197  0.00019478 -0.00013203  0.00966811]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-2.7932864e-02  1.3651635e-02  9.3079449e-05  1.4609668e-06
  4.3543234e-02]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-3.0096317e-02  1.7280672e-02  4.9464430e-05  1.4689144e-02
  4.1604377e-02]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-3.0096317e-02  1.7280672e-02  4.9464430e-05  1.4689144e-02
  4.1604377e-02]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-3.0096317e-02  1.7280672e-02  4.9464430e-05  1.4689144e-02
  4.1604377e-02]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 3.0581811e-03 -3.8564766e-03  1.8643590e-05  2.3945471e-02
 -2.1296293e-03]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.23183364 -0.07080565  0.05026776 -0.11108686 -0.08147586]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-0.02499789  0.00270925 -0.31791753  0.11141214  0.02915403]
  [Mamba.__call__] After layer 1 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 1 sample values: [-0.02499789  0.00270925 -0.31791753  0.11141214  0.02915403]
[Mamba.__call__] Processing layer 2/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-0.02499789  0.00270925 -0.31791753  0.11141214  0.02915403]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-0.02499789  0.00270925 -0.31791753  0.11141214  0.02915403]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.25442952 0.27610373 0.2688396  0.2814251  0.27623716]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.14520313  0.01573702 -1.8466606   0.6471502   0.16934451]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.03694396  0.00434505 -0.4964555   0.1821243   0.04677925]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [3.417809   0.49778837 4.028543   3.4720712  1.9710053 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [-0.0340507   0.00130601 -0.10321456 -0.02543259 -0.01574953]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.03694396  0.00434505 -0.4964555   0.1821243   0.04677925]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.28085786 -0.4530275  -0.5365766  -0.14764124 -0.79559666]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.28085786 -0.4530275  -0.5365766  -0.14764124 -0.79559666]
  [MambaBlock.__call__] res sample values: [ 0.6127318   0.5846112   0.1722252  -0.6566935  -0.67198783]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.01789258  0.00883843  0.00276493 -0.0081972  -0.02523815]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.00902633  0.00443874  0.00138438 -0.0040818  -0.01245984]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-30.502512   -1.6450789 -56.179     -32.203373   -7.177889 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [-0.0340507   0.00130601 -0.10321456 -0.02543259 -0.01574953]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.25100636 -0.68708473  0.64930063  0.40355623 -0.09240188]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.25100636 -0.68708473  0.64930063  0.40355623 -0.09240188]
  [MambaBlock.ssm] B sample values: [-0.13324574 -0.30336693  0.02775788 -0.2042622  -1.0082144 ]
  [MambaBlock.ssm] C sample values: [-0.11288986  0.47682172  0.36698955  0.02954976 -0.46506712]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.15016048 0.14632654 0.0588587  0.21697217 0.0160057 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [1.0252111e-02 7.8112054e-01 2.1694528e-04 7.9413354e-03 3.4033149e-01]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-1.8060092e-04 -4.1118276e-04  3.7622958e-05 -2.7685644e-04
 -1.3665311e-03]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-1.8060092e-04 -4.1118276e-04  3.7622958e-05 -2.7685644e-04
 -1.3665311e-03]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.00663417  0.00317909  0.00039883 -0.00433487 -0.00097613]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 7.8139041e-04  1.2961606e-04 -8.3892787e-04 -8.7306500e-05
  1.4641510e-03]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.01498785 -0.03047819 -0.00899317 -0.00963313 -0.01492387]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.0007041  -0.00070075  0.00095511 -0.00060281 -0.00049659]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00204553 -0.0048789  -0.00867742 -0.01182545 -0.00173144]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00127211 -0.00516854  0.00056842 -0.00156196 -0.01045149]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.02429168 -0.00794922  0.00017622 -0.05979262  0.02114918]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.00663417  0.00317909  0.00039883 -0.00433487 -0.00097613]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.00632682  0.00318489  0.00025594 -0.00423106 -0.00077989]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.00632682  0.00318489  0.00025594 -0.00423106 -0.00077989]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.00632682  0.00318489  0.00025594 -0.00423106 -0.00077989]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [2.5142503e-03 1.1955925e-03 2.3932820e-05 9.4881281e-04 1.7716571e-04]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.0334358  -0.10242403  0.01075624 -0.01265371  0.00951884]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.00843791 -0.09971478 -0.3071613   0.09875843  0.03867287]
  [Mamba.__call__] After layer 2 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 2 sample values: [ 0.00843791 -0.09971478 -0.3071613   0.09875843  0.03867287]
[Mamba.__call__] Processing layer 3/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.00843791 -0.09971478 -0.3071613   0.09875843  0.03867287]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.00843791 -0.09971478 -0.3071613   0.09875843  0.03867287]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.30368257 0.33868715 0.30555573 0.32650936 0.32484448]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.04096648 -0.48412064 -1.4912847   0.4794775   0.18775886]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.01244081 -0.16396543 -0.4556706   0.1565539   0.06099243]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [-1.1850427  2.7440524  1.543246   1.8178184  2.1145759]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [-0.07714437  0.27658814 -0.01964906 -0.05041154  0.095254  ]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.01244081 -0.16396543 -0.4556706   0.1565539   0.06099243]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.2602905   0.5314641  -0.40971133  1.1640064  -0.49107552]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 0.2602905   0.5314641  -0.40971133  1.1640064  -0.49107552]
  [MambaBlock.__call__] res sample values: [ 0.49229392  0.64455277 -0.21108893  0.2554997   0.05568814]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.00790063 -0.161823    0.00828486  0.01407559 -0.01008335]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.00396592 -0.07437909  0.00415959  0.00708733 -0.00501626]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -0.3057331 -15.549872   -4.679756   -6.1584086  -8.286071 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [-0.07714437  0.27658814 -0.01964906 -0.05041154  0.095254  ]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [0.11383499 0.04816429 0.00784015 0.31796643 0.26779488]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [0.11383499 0.04816429 0.00784015 0.31796643 0.26779488]
  [MambaBlock.ssm] B sample values: [-0.33833906 -0.09081009 -0.0427852  -0.41189465  0.48408136]
  [MambaBlock.ssm] C sample values: [ 0.26901332  0.5788984   0.31078357 -0.6506359  -0.01976226]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.12195416 0.01497919 0.10630799 0.10303554 0.12718694]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.96340114 0.1501123  0.5651208  0.47187388 0.36402935]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-1.6364131e-04 -4.3921271e-05 -2.0693518e-05 -1.9921725e-04
  2.3413113e-04]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-1.6364131e-04 -4.3921271e-05 -2.0693518e-05 -1.9921725e-04
  2.3413113e-04]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.00184071 -0.00424016  0.00168291  0.00277916 -0.0024281 ]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 2.9933278e-04  4.3350062e-04  5.0552604e-05  1.0773017e-03
 -1.3735134e-03]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.02409305 -0.03324566 -0.02494356 -0.09277448  0.01077961]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00222696 -0.00364541  0.00049044 -0.00803185  0.00630322]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.01402177 -0.01264604 -0.00034323 -0.00754824  0.00591454]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00399559 -0.00213571 -0.00078855 -0.00822385  0.00464869]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.02465957 -0.00896675 -0.00038085 -0.01167102 -0.02566358]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.00184071 -0.00424016  0.00168291  0.00277916 -0.0024281 ]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.00153476 -0.02481254  0.00160117  0.00242187 -0.00290591]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.00153476 -0.02481254  0.00160117  0.00242187 -0.00290591]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.00153476 -0.02481254  0.00160117  0.00242187 -0.00290591]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 4.6893067e-04 -1.0487913e-02 -1.5122455e-04  3.4870551e-04
 -8.3164850e-05]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.0056728   0.01268638  0.05140384  0.01602396 -0.0047226 ]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.00276511 -0.0870284  -0.25575745  0.11478239  0.03395026]
  [Mamba.__call__] After layer 3 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 3 sample values: [ 0.00276511 -0.0870284  -0.25575745  0.11478239  0.03395026]
[Mamba.__call__] Processing layer 4/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.00276511 -0.0870284  -0.25575745  0.11478239  0.03395026]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.00276511 -0.0870284  -0.25575745  0.11478239  0.03395026]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.4252295  0.4499609  0.43058494 0.4826891  0.44316494]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.01304478 -0.41056854 -1.2065712   0.5415018   0.16016506]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.00554702 -0.18473978 -0.51953137  0.26137704  0.07097954]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [3.011142  1.1033401 3.3086977 3.3686798 4.2508135]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [-0.01441001  0.04630347  0.17183046  0.01959118 -0.00654993]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.00554702 -0.18473978 -0.51953137  0.26137704  0.07097954]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 1.9475629  -0.4303217  -1.3707335   1.0676565   0.32945663]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 1.9475629  -0.4303217  -1.3707335   1.0676565   0.32945663]
  [MambaBlock.__call__] res sample values: [ 0.35633573 -1.4804724   0.3260417   0.33506715  0.6580639 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.03798148 -0.01720264 -0.06718794  0.01556269  0.00212312]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.01935135 -0.00852734 -0.03246584  0.00784189  0.00106269]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-20.310581   -3.0142171 -27.349485  -29.040161  -70.16247  ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [-0.01441001  0.04630347  0.17183046  0.01959118 -0.00654993]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.17559752  0.87325495 -0.765836   -0.40980282 -0.60959786]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [ 0.17559752  0.87325495 -0.765836   -0.40980282 -0.60959786]
  [MambaBlock.ssm] B sample values: [ 0.33320585 -0.48068953 -0.18375593  0.18273912  0.10781887]
  [MambaBlock.ssm] C sample values: [0.29059443 0.73739445 0.2398099  0.48098105 0.36063233]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.04074499 0.03054219 0.00013664 0.04780578 0.02175895]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.43711698 0.8844279  0.32812703 0.30628443 0.05733929]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 2.6272298e-04 -3.7900952e-04 -1.4488613e-04  1.4408441e-04
  8.5011998e-05]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 2.6272298e-04 -3.7900952e-04 -1.4488613e-04  1.4408441e-04
  8.5011998e-05]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 2.6463894e-03 -8.7414164e-04 -1.4889677e-05  1.2582574e-03
  7.7608885e-05]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00010037  0.00301913  0.00039514 -0.0024005  -0.00352927]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-8.688604e-02 -9.358822e-03  8.657660e-05 -3.511212e-02  7.154402e-04]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00192049  0.00424187 -0.00129786 -0.00240427 -0.00341559]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-1.4414991e-02  4.9613146e-03  7.6198630e-06  3.8495930e-03
 -3.7230509e-03]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-8.9202973e-04  4.2294543e-03  6.8289100e-04 -4.3613225e-04
  5.5887689e-05]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-2.9690969e-03  6.5671996e-04  8.3735584e-05  1.2193471e-03
 -2.4339820e-03]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 2.6463894e-03 -8.7414164e-04 -1.4889677e-05  1.2582574e-03
  7.7608885e-05]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 2.3675363e-03 -1.2689870e-03 -5.5935094e-03  1.4118893e-03
  7.0648355e-05]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 2.3675363e-03 -1.2689870e-03 -5.5935094e-03  1.4118893e-03
  7.0648355e-05]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 2.3675363e-03 -1.2689870e-03 -5.5935094e-03  1.4118893e-03
  7.0648355e-05]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 4.9618818e-04  3.4822852e-04 -1.0592076e-03  2.7580044e-04
  3.0629537e-05]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00507282 -0.02206459  0.01413861  0.00708055  0.01367979]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-0.00230771 -0.10909299 -0.24161884  0.12186294  0.04763005]
  [Mamba.__call__] After layer 4 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 4 sample values: [-0.00230771 -0.10909299 -0.24161884  0.12186294  0.04763005]
[Mamba.__call__] Processing layer 5/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-0.00230771 -0.10909299 -0.24161884  0.12186294  0.04763005]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-0.00230771 -0.10909299 -0.24161884  0.12186294  0.04763005]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.36004275 0.3917097  0.36839446 0.37299663 0.38801226]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.01044944 -0.49397928 -1.0940639   0.55180234  0.2156716 ]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.00376224 -0.19349647 -0.40304708  0.20582041  0.08368322]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [-0.11073657  1.3719835   2.4811847   1.7243557   2.7985172 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [-0.04605436 -0.0410049  -0.01335235 -0.02323283  0.02894529]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.00376224 -0.19349647 -0.40304708  0.20582041  0.08368322]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.04385793 -0.07663918 -0.7687406  -1.9229686   0.33628815]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.04385793 -0.07663918 -0.7687406  -1.9229686   0.33628815]
  [MambaBlock.__call__] res sample values: [ 0.722908   -0.20088531 -0.75651497 -0.82267416 -0.7758586 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.00294918 -0.00546395 -0.09484873 -0.01556947  0.04773479]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.00147242 -0.00272451 -0.04517698 -0.00772413  0.02443694]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -0.8951745  -3.9431643 -11.95542    -5.608906  -16.42028  ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [-0.04605436 -0.0410049  -0.01335235 -0.02323283  0.02894529]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.02375197  0.653965   -0.1297884  -1.10681     0.21243425]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.02375197  0.653965   -0.1297884  -1.10681     0.21243425]
  [MambaBlock.ssm] B sample values: [-1.4713609   0.41731292 -0.48138303  0.38858718 -0.11150043]
  [MambaBlock.ssm] C sample values: [ 0.5433415   0.16547215  0.29588658 -0.00197631 -0.3403051 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.1763891  0.17473885 0.23217458 0.14406066 0.0372214 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.853936   0.49880943 0.12138285 0.37181836 0.05522395]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 3.8213938e-04 -1.0838381e-04  1.2502399e-04 -1.0092320e-04
  2.8958704e-05]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 3.8213938e-04 -1.0838381e-04  1.2502399e-04 -1.0092320e-04
  2.8958704e-05]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.00037635 -0.00068986 -0.01519905 -0.00161243  0.00131803]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00018699  0.00016601 -0.00011137  0.00013906 -0.0002974 ]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.00296638  0.00124621 -0.00339849  0.0793051   0.01218612]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00247818 -0.00156138  0.00145122 -0.00411524  0.00252689]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00305184  0.00049501  0.00916822  0.00395798  0.00834165]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.0025456  -0.0011138   0.00040739 -0.00199652  0.0003808 ]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00130614 -0.01175741 -0.00557969 -0.00049771  0.02946423]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.00037635 -0.00068986 -0.01519905 -0.00161243  0.00131803]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.00030853 -0.00057814 -0.01459583 -0.00143297  0.00202536]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.00030853 -0.00057814 -0.01459583 -0.00143297  0.00202536]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.00030853 -0.00057814 -0.01459583 -0.00143297  0.00202536]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-1.5016249e-04  5.2257135e-05  3.5268406e-03  3.5978644e-04
 -4.9532391e-04]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.04007424 -0.02973644 -0.03325429  0.06587535 -0.02045658]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04238195 -0.13882942 -0.27487314  0.1877383   0.02717347]
  [Mamba.__call__] After layer 5 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 5 sample values: [-0.04238195 -0.13882942 -0.27487314  0.1877383   0.02717347]
[Mamba.__call__] Processing layer 6/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04238195 -0.13882942 -0.27487314  0.1877383   0.02717347]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-0.04238195 -0.13882942 -0.27487314  0.1877383   0.02717347]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.35310158 0.37804586 0.36261195 0.37519994 0.38733596]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.18603858 -0.6094016  -1.206575    0.82409054  0.11927987]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.06569052 -0.23038174 -0.43751854  0.30919874  0.04620138]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.25236997 1.8681424  2.5169868  2.060203   1.9028596 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [-0.05330887 -0.04873744 -0.03699538 -0.06825275  0.11088187]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.06569052 -0.23038174 -0.43751854  0.30919874  0.04620138]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.32556742  2.0214221  -1.3962525   1.1311839   0.30623943]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.32556742  2.0214221  -1.3962525   1.1311839   0.30623943]
  [MambaBlock.__call__] res sample values: [-0.6641868  -0.14596593  1.0925872   0.11037478  0.07395251]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.01111644  0.01445937  0.0305857  -0.01851974 -0.00909897]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.00552733  0.00728195  0.0155267  -0.00917413 -0.00452879]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -1.2870722  -6.4762545 -12.391204   -7.8475633  -6.7050405]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [-0.05330887 -0.04873744 -0.03699538 -0.06825275  0.11088187]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.5972644   0.78890353  0.02350856  0.18481259  0.63435084]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.5972644   0.78890353  0.02350856  0.18481259  0.63435084]
  [MambaBlock.ssm] B sample values: [ 0.8119569  -0.16939496 -0.47996378 -0.25245905  0.96153855]
  [MambaBlock.ssm] C sample values: [-0.53830385  0.12647858  0.19050148 -0.48975766 -0.33744422]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.08931895 0.0847621  0.11041638 0.09883653 0.05711873]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.8914018  0.5607656  0.33062539 0.49612066 0.5494227 ]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-4.0085908e-04  8.3629449e-05  2.3695573e-04  1.2463778e-04
 -4.7470682e-04]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-4.0085908e-04  8.3629449e-05  2.3695573e-04  1.2463778e-04
 -4.7470682e-04]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.00157385  0.00196767  0.00546533 -0.00289059 -0.00082464]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00113905 -0.00056047 -0.00065451 -0.00135685  0.00105832]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.02495679 -0.0837271  -0.04996815  0.07427498  0.04922463]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00080198  0.00016715  0.00030325  0.00145369 -0.00266752]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00513651 -0.00379624 -0.00427061  0.00042528  0.01769638]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00177041  0.00042275  0.00121387  0.00137715 -0.00208489]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.0053153   0.01184987  0.02737524 -0.02045582  0.01906354]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.00157385  0.00196767  0.00546533 -0.00289059 -0.00082464]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.00127919  0.00161277  0.00489091 -0.00226443 -0.0013268 ]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.00127919  0.00161277  0.00489091 -0.00226443 -0.0013268 ]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.00127919  0.00161277  0.00489091 -0.00226443 -0.0013268 ]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 2.8870121e-04 -1.0912951e-04  4.0017646e-03 -1.3185745e-04
 -5.0873292e-05]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.01741824  0.01258051 -0.03326777 -0.05319784  0.01687   ]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-0.0598002  -0.12624891 -0.3081409   0.13454047  0.04404347]
  [Mamba.__call__] After layer 6 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 6 sample values: [-0.0598002  -0.12624891 -0.3081409   0.13454047  0.04404347]
[Mamba.__call__] Processing layer 7/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-0.0598002  -0.12624891 -0.3081409   0.13454047  0.04404347]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-0.0598002  -0.12624891 -0.3081409   0.13454047  0.04404347]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.35832942 0.40931934 0.388359   0.39675122 0.40990236]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.2567085  -0.54195756 -1.3227781   0.57755136  0.18906848]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.09198621 -0.2218337  -0.5137128   0.22914422  0.07749962]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.8855748 2.4595287 0.5624005 2.355531  2.3158755]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [-0.06924782 -0.05570752 -0.06143199 -0.02553918  0.20880324]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.09198621 -0.2218337  -0.5137128   0.22914422  0.07749962]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.6423512  -0.07915303 -2.0838993   0.3268472  -0.47308326]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 0.6423512  -0.07915303 -2.0838993   0.3268472  -0.47308326]
  [MambaBlock.__call__] res sample values: [ 0.11537147 -0.60591114 -1.4964831  -0.6294065   0.293853  ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.0055362  -0.00230786  0.06363954  0.13373254  0.0436144 ]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.00276044 -0.0011526   0.03283193  0.07133071  0.02228268]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -2.4243774 -11.699296   -1.7548801 -10.543726  -10.133791 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [-0.06924782 -0.05570752 -0.06143199 -0.02553918  0.20880324]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.5836047  -1.898414   -0.66324425 -0.01558258 -0.45265752]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.5836047  -1.898414   -0.66324425 -0.01558258 -0.45265752]
  [MambaBlock.ssm] B sample values: [ 1.531178   -0.6117965  -1.2302716  -0.15560627 -0.8759674 ]
  [MambaBlock.ssm] C sample values: [-0.7615347   0.08851665 -0.310102    0.12011489  0.04039109]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.1422318  0.11747041 0.2699566  0.28854597 0.01992192]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.7083453  0.18937768 0.7791126  0.22320755 0.23660874]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-6.0117414e-04  2.4020477e-04  4.8303168e-04  6.1094441e-05
  3.4392407e-04]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-6.0117414e-04  2.4020477e-04  4.8303168e-04  6.1094441e-05
  3.4392407e-04]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-2.6409430e-04 -9.1073256e-05  5.9617637e-03  1.3844462e-02
  2.9859543e-04]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00122091 -0.00054577 -0.00219925  0.00076725 -0.0021544 ]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.02900296  0.00373708 -0.06701158  0.04656452  0.00354575]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00085338 -0.0026726  -0.00016597  0.00271485  0.00057324]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00642568  0.00151177 -0.02252146 -0.00430729  0.00593491]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00143806 -0.00237664 -0.00268432 -0.00055654 -0.00155741]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.01304326 -0.01435017  0.0310055   0.01408408  0.0074162 ]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-2.6409430e-04 -9.1073256e-05  5.9617637e-03  1.3844462e-02
  2.9859543e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-7.2940034e-05 -2.6864866e-05  3.9448328e-03  1.2022734e-02
  4.9512913e-03]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-7.2940034e-05 -2.6864866e-05  3.9448328e-03  1.2022734e-02
  4.9512913e-03]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-7.2940034e-05 -2.6864866e-05  3.9448328e-03  1.2022734e-02
  4.9512913e-03]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-4.4500489e-06  5.7459133e-06 -1.0800263e-03 -2.6306957e-03
  8.3359896e-04]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.0090281   0.020622    0.01190475 -0.0375631   0.00375232]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-0.0507721  -0.10562691 -0.29623616  0.09697737  0.04779579]
  [Mamba.__call__] After layer 7 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 7 sample values: [-0.0507721  -0.10562691 -0.29623616  0.09697737  0.04779579]
[Mamba.__call__] Processing layer 8/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-0.0507721  -0.10562691 -0.29623616  0.09697737  0.04779579]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-0.0507721  -0.10562691 -0.29623616  0.09697737  0.04779579]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.3572308  0.3915758  0.3756717  0.37576926 0.39951947]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.21276538 -0.44263977 -1.2414062   0.40639302  0.20029287]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.07600635 -0.17332703 -0.4663612   0.15271     0.0800209 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [5.202221  2.19885   5.424912  5.592906  2.9649444]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [ 0.26236254  0.14042301  0.13239215  0.11006151 -0.06457335]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.07600635 -0.17332703 -0.4663612   0.15271     0.0800209 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.90014684 -1.4308615  -0.00515568  0.17155156  0.2550205 ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 0.90014684 -1.4308615  -0.00515568  0.17155156  0.2550205 ]
  [MambaBlock.__call__] res sample values: [-0.62304246  0.562508   -1.0107076   0.3272257   0.13281453]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.02630524 -0.27804503 -0.00964528  0.02037995  0.00780433]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.0133256  -0.11981881 -0.00479938  0.01029381  0.00391739]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-181.6753     -9.01464  -226.99136  -268.5148    -19.393623]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [ 0.26236254  0.14042301  0.13239215  0.11006151 -0.06457335]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.29249516 -0.75496846  0.49701673  0.37785506  0.2547495 ]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.29249516 -0.75496846  0.49701673  0.37785506  0.2547495 ]
  [MambaBlock.ssm] B sample values: [-0.5417823   0.70229024  0.09425993 -0.45817184 -0.02482374]
  [MambaBlock.ssm] C sample values: [ 0.5887541  -0.05730402 -0.03262795 -0.6045547  -0.3469733 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.01712775 0.02965554 0.05188897 0.0776774  0.09119306]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.04452569 0.85692877 0.02048933 0.01006135 0.717366  ]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-1.2365509e-04  1.6028904e-04  2.1513661e-05 -1.0457204e-04
 -5.6657104e-06]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-1.2365509e-04  1.6028904e-04  2.1513661e-05 -1.0457204e-04
 -5.6657104e-06]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.00072753 -0.01132645 -0.00079382  0.00254879  0.00113873]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00111265 -0.00153803  0.00039591  0.001133    0.00280407]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.0171974  -0.03480283  0.02931154 -0.02711307 -0.00509088]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00143483 -0.0033986   0.00370841  0.00143796 -0.00017433]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00427867 -0.00402209  0.01286405 -0.00547615 -0.00915104]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00046446 -0.00207866  0.00056527 -0.00063713 -0.00011632]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.00282405 -0.0179838   0.02722382 -0.00715574  0.01843975]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.00072753 -0.01132645 -0.00079382  0.00254879  0.00113873]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.00422367 -0.02815177 -0.00142922  0.00368174  0.00088577]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.00422367 -0.02815177 -0.00142922  0.00368174  0.00088577]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.00422367 -0.02815177 -0.00142922  0.00368174  0.00088577]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-9.1863837e-04 -1.0087790e-02  3.8545940e-04  7.0006674e-04
  6.2722240e-05]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00173743 -0.02301063  0.01688643  0.01063748 -0.04355322]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-0.05250952 -0.12863754 -0.2793497   0.10761485  0.00424257]
  [Mamba.__call__] After layer 8 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 8 sample values: [-0.05250952 -0.12863754 -0.2793497   0.10761485  0.00424257]
[Mamba.__call__] Processing layer 9/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-0.05250952 -0.12863754 -0.2793497   0.10761485  0.00424257]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-0.05250952 -0.12863754 -0.2793497   0.10761485  0.00424257]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.40599737 0.43742874 0.43724048 0.43864763 0.46650627]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.20953567 -0.5133193  -1.114726    0.4294297   0.01692967]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.08507093 -0.22454062 -0.4874033   0.18836832  0.0078978 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [ 2.4034925 -1.1583222  1.5445421  1.5589154  3.2720718]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [ 0.15660967 -0.04287492 -0.11284009  0.04582906  0.16915217]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.08507093 -0.22454062 -0.4874033   0.18836832  0.0078978 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.48951423  0.5575353   0.80085397 -0.28984213  0.36365807]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.48951423  0.5575353   0.80085397 -0.28984213  0.36365807]
  [MambaBlock.__call__] res sample values: [ 1.3903117   0.05279714  0.6359636   0.09062954 -0.28716853]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.09731124 -0.02336307 -0.0216397  -0.04079252 -0.00071836]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.04629012 -0.01154508 -0.01070278 -0.01998031 -0.00035905]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-11.061742   -0.3140126  -4.6858253  -4.7536626 -26.36591  ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [ 0.15660967 -0.04287492 -0.11284009  0.04582906  0.16915217]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.0056029  -0.76654714 -0.308109   -0.10869811 -0.38113475]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [ 0.0056029  -0.76654714 -0.308109   -0.10869811 -0.38113475]
  [MambaBlock.ssm] B sample values: [-0.3693021  -0.45905584 -0.5687179  -0.7392438   0.9188845 ]
  [MambaBlock.ssm] C sample values: [ 0.19095457 -0.2664624  -0.7064227   0.5828906   0.75749195]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.01550555 0.12174641 0.19005333 0.12243003 0.00730417]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.84238476 0.9951429  0.9299204  0.92894274 0.66443515]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00026507  0.00032949  0.0004082   0.0005306  -0.00065953]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00026507  0.00032949  0.0004082   0.0005306  -0.00065953]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-1.0304608e-03 -2.0179444e-03 -2.9203054e-03 -3.5119336e-03
 -3.7651307e-06]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00023739 -0.00013557 -0.00027673 -0.0002886   0.00073125]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.01043374  0.00985871  0.00078795 -0.02323392 -0.01260663]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-4.4638524e-04 -6.2090156e-05  1.7056834e-04 -5.5078141e-05
 -3.5896155e-05]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-6.2991225e-05 -1.0624962e-03 -9.0677524e-03 -1.6085288e-02
 -1.3966436e-03]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 1.9047609e-04  1.8845845e-04  9.3711300e-05 -3.5094170e-04
 -6.6478772e-04]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00354568 -0.00839959  0.00287637 -0.01582538 -0.00933867]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-1.0304608e-03 -2.0179444e-03 -2.9203054e-03 -3.5119336e-03
 -3.7651307e-06]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-8.2799410e-03 -1.5229498e-03 -1.7126022e-03 -4.4276128e-03
 -6.4498978e-05]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-8.2799410e-03 -1.5229498e-03 -1.7126022e-03 -4.4276128e-03
 -6.4498978e-05]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-8.2799410e-03 -1.5229498e-03 -1.7126022e-03 -4.4276128e-03
 -6.4498978e-05]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-9.2167500e-03 -4.1264768e-05 -7.1213208e-04 -2.0972182e-04
  7.9403626e-06]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.03780526 -0.01476227 -0.03816293  0.08485898 -0.02854533]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-0.09031478 -0.1433998  -0.31751263  0.19247383 -0.02430276]
  [Mamba.__call__] After layer 9 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 9 sample values: [-0.09031478 -0.1433998  -0.31751263  0.19247383 -0.02430276]
[Mamba.__call__] Processing layer 10/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-0.09031478 -0.1433998  -0.31751263  0.19247383 -0.02430276]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-0.09031478 -0.1433998  -0.31751263  0.19247383 -0.02430276]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.40147337 0.41858763 0.4294926  0.43749398 0.44087183]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.33408293 -0.53044945 -1.1745093   0.7119789  -0.08989821]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.1341254  -0.22203958 -0.50444305  0.31148648 -0.03963359]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.40276977 1.9269782  1.2111399  1.1740407  2.4286573 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [-0.07256329 -0.01787526  0.15245908  0.06157661  0.03458144]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.1341254  -0.22203958 -0.50444305  0.31148648 -0.03963359]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 1.0693345  -0.9459246  -0.47370464  0.06805503  0.6869916 ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 1.0693345  -0.9459246  -0.47370464  0.06805503  0.6869916 ]
  [MambaBlock.__call__] res sample values: [ 1.2186017   1.2585685   0.16819316 -0.680848   -0.41904986]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.0007014   0.00533748  0.00895483 -0.02104645 -0.02995844]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.00035082  0.00267586  0.00449746 -0.01041249 -0.01475486]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -1.4959624  -6.868723   -3.3573096  -3.235038  -11.34364  ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [-0.07256329 -0.01787526  0.15245908  0.06157661  0.03458144]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.20225209  1.4765148   0.2685997   0.34246558  0.42623413]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.20225209  1.4765148   0.2685997   0.34246558  0.42623413]
  [MambaBlock.ssm] B sample values: [-1.9194945  -0.1572075  -0.46224275  0.7222225  -0.98609066]
  [MambaBlock.ssm] C sample values: [ 0.43583646  0.16750485 -0.03100264 -0.24516608  0.5513271 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.18888362 0.13130908 0.07122405 0.22879529 0.0743225 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.75384927 0.27324423 0.53039104 0.542783   0.11734609]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-1.27195002e-04 -1.04173305e-05 -3.06304428e-05  4.78579641e-05
 -6.53431416e-05]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-1.27195002e-04 -1.04173305e-05 -3.06304428e-05  4.78579641e-05
 -6.53431416e-05]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.00011281  0.00059818  0.00054534 -0.00405576 -0.00186692]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 4.230123e-03  8.541415e-05  5.187574e-03 -2.297778e-03  3.658713e-03]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.02231293  0.02981309  0.03690415 -0.0193108  -0.01275273]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00080007  0.00483091  0.00102687  0.00079599 -0.00167421]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00506927  0.01097498  0.00063825 -0.00494876 -0.00677445]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [0.00278661 0.00272344 0.00040441 0.0004476  0.00358316]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00834666 -0.01905681  0.00899529 -0.00526438  0.06231482]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.00011281  0.00059818  0.00054534 -0.00405576 -0.00186692]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 8.7354580e-05  5.5034371e-04  1.2310152e-03 -4.6969228e-03
 -2.3771634e-03]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 8.7354580e-05  5.5034371e-04  1.2310152e-03 -4.6969228e-03
 -2.3771634e-03]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 8.7354580e-05  5.5034371e-04  1.2310152e-03 -4.6969228e-03
 -2.3771634e-03]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [8.2160295e-05 5.3941796e-04 1.1220973e-04 1.0747217e-03 3.9521669e-04]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.00253749  0.05967432 -0.03820556  0.00063011  0.0222069 ]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-0.08777729 -0.08372549 -0.3557182   0.19310394 -0.00209586]
  [Mamba.__call__] After layer 10 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 10 sample values: [-0.08777729 -0.08372549 -0.3557182   0.19310394 -0.00209586]
[Mamba.__call__] Processing layer 11/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-0.08777729 -0.08372549 -0.3557182   0.19310394 -0.00209586]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-0.08777729 -0.08372549 -0.3557182   0.19310394 -0.00209586]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.39217156 0.4027796  0.41695896 0.4150494  0.4416233 ]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.32116988 -0.30634466 -1.3015435   0.7065514  -0.00766859]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.12595369 -0.12338938 -0.5426902   0.29325372 -0.00338663]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [ 2.686405   -2.0958529   0.3318764   1.9780325   0.70596015]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [ 0.14383444  0.2703921  -0.03732084  0.05589909 -0.10259885]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.12595369 -0.12338938 -0.5426902   0.29325372 -0.00338663]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.7526702  -1.0684022  -0.3139579   1.1871676   0.12406567]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.7526702  -1.0684022  -0.3139579   1.1871676   0.12406567]
  [MambaBlock.__call__] res sample values: [ 0.03288101 -0.43507165 -0.16727617  1.8765146   0.92575014]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.0766034  -0.2299853   0.02014736  0.09255627 -0.03381088]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.039768   -0.10182732  0.01017515  0.04841827 -0.01661967]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-14.67881     -0.12296533  -1.3935806   -7.2285066   -2.025791  ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [ 0.14383444  0.2703921  -0.03732084  0.05589909 -0.10259885]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.02512404  0.08362963  0.19152847  0.10776778  0.10212407]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.02512404  0.08362963  0.19152847  0.10776778  0.10212407]
  [MambaBlock.ssm] B sample values: [-0.5930263   0.01392041  0.66327715  0.3738625   0.22957957]
  [MambaBlock.ssm] C sample values: [ 0.34081087  0.19535482 -0.44053423 -0.35524315  0.2185567 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.06768656 0.03811699 0.22130196 0.12400895 0.16464745]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.37025693 0.99171144 0.9099854  0.6130721  0.87186664]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-1.5962840e-03  3.7470403e-05  1.7853824e-03  1.0063478e-03
  6.1797292e-04]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-1.5962840e-03  3.7470403e-05  1.7853824e-03  1.0063478e-03
  6.1797292e-04]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.00794335 -0.01145382  0.00664498  0.01771862 -0.00807504]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00246245 -0.00037225  0.00355991  0.00215645  0.00151698]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.01295637 -0.01735471  0.0194048   0.00824653 -0.01372398]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00203567  0.0018394   0.00436736  0.0017501   0.0008006 ]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.01004416 -0.00021739  0.00888292 -0.01015362 -0.00715839]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00192924  0.00150241  0.00445478  0.00144436  0.00189263]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.00953861 -0.00479242  0.00665786 -0.01739727 -0.00753691]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.00794335 -0.01145382  0.00664498  0.01771862 -0.00807504]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.01366336 -0.03898712  0.00626524  0.02042515 -0.00636989]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.01366336 -0.03898712  0.00626524  0.02042515 -0.00636989]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.01366336 -0.03898712  0.00626524  0.02042515 -0.00636989]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.00022833  0.00666472 -0.00048029  0.03323852 -0.00422345]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.06104735  0.0036076  -0.01707676  0.01032248  0.02562229]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-0.02672995 -0.08011789 -0.37279496  0.20342642  0.02352642]
  [Mamba.__call__] After layer 11 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 11 sample values: [-0.02672995 -0.08011789 -0.37279496  0.20342642  0.02352642]
[Mamba.__call__] Processing layer 12/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-0.02672995 -0.08011789 -0.37279496  0.20342642  0.02352642]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-0.02672995 -0.08011789 -0.37279496  0.20342642  0.02352642]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.36855662 0.3924479  0.38786355 0.40821466 0.40955997]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.09249786 -0.27724457 -1.2900412   0.70394856  0.0814122 ]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.0340907  -0.10880405 -0.50035995  0.28736213  0.03334318]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [-0.05273063 -1.3903627   0.2454022   4.9886928   5.074023  ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [ 0.11715242  0.0708852  -0.04888415 -0.01921925  0.38207832]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.0340907  -0.10880405 -0.50035995  0.28736213  0.03334318]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.20800993 -0.08744593  0.6570734   0.0644832  -1.0771376 ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.20800993 -0.08744593  0.6570734   0.0644832  -1.0771376 ]
  [MambaBlock.__call__] res sample values: [ 0.6917603  -0.31410074 -0.85881275 -0.8513583  -0.4074789 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.0392718  -0.00912314 -0.01268806  0.00222567  0.31694356]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.02002142 -0.00454076 -0.00630378  0.00111408  0.18337694]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [  -0.9486355    -0.24898498   -1.2781353  -146.74448    -159.81593   ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [ 0.11715242  0.0708852  -0.04888415 -0.01921925  0.38207832]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.29263455  0.45771605  0.2403427   1.1414657  -0.10160445]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [ 0.29263455  0.45771605  0.2403427   1.1414657  -0.10160445]
  [MambaBlock.ssm] B sample values: [-0.81265485 -0.02501378 -0.43458053 -0.01417032  0.01671941]
  [MambaBlock.ssm] C sample values: [ 0.3387819   0.6547724  -0.18614216  0.1058846   0.34884015]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.04635159 0.22654992 0.22149096 0.23690726 0.03594118]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [9.5698196e-01 9.8852551e-01 9.4247717e-01 1.1117284e-03 6.0655084e-04]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-7.5416360e-04 -2.3213403e-05 -4.0330138e-04 -1.3150403e-05
  1.5516018e-05]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-7.5416360e-04 -2.3213403e-05 -4.0330138e-04 -1.3150403e-05
  1.5516018e-05]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.0020401  -0.00226144 -0.00306937  0.00058021  0.01448867]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-9.2459115e-04  1.0885011e-04 -2.5870762e-04  5.2456991e-05
  8.0633195e-05]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.00351454 -0.0019672  -0.00903097  0.00505287  0.0128845 ]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00355423 -0.00554333 -0.00501678 -0.00154539 -0.00177155]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.0068294  -0.01271117  0.01074275 -0.03297298  0.00303721]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 3.2747618e-03 -5.5403779e-03 -5.0437027e-03 -2.0798057e-05
  8.7052322e-06]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00443603 -0.03737846 -0.00996131  0.0020964   0.0155709 ]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.0020401  -0.00226144 -0.00306937  0.00058021  0.01448867]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.00438566 -0.00258331 -0.00276121  0.0005588   0.08455303]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.00438566 -0.00258331 -0.00276121  0.0005588   0.08455303]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.00438566 -0.00258331 -0.00276121  0.0005588   0.08455303]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.00202161  0.00034251  0.00070569 -0.00014232 -0.01376478]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.09127143 -0.07164165 -0.00961308 -0.04580764  0.014191  ]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.06454148 -0.15175954 -0.38240805  0.15761879  0.03771743]
  [Mamba.__call__] After layer 12 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 12 sample values: [ 0.06454148 -0.15175954 -0.38240805  0.15761879  0.03771743]
[Mamba.__call__] Processing layer 13/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.06454148 -0.15175954 -0.38240805  0.15761879  0.03771743]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.06454148 -0.15175954 -0.38240805  0.15761879  0.03771743]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.43318668 0.4489577  0.477443   0.46275437 0.48010916]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.20304815 -0.47743705 -1.2030597   0.49587032  0.11865941]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.08795775 -0.21434905 -0.57439244  0.22946616  0.05696947]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [1.5122436 1.9397022 2.5101109 2.496285  4.529291 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [-0.01829424 -0.02413884 -0.01092172  0.18965748  0.15758662]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.08795775 -0.21434905 -0.57439244  0.22946616  0.05696947]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.9028244  0.8346869  1.1738067 -1.3215805 -0.8220821]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.9028244  0.8346869  1.1738067 -1.3215805 -0.8220821]
  [MambaBlock.__call__] res sample values: [-1.4180589  -1.4156749   2.0500839   0.28279456 -1.1936207 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.04776464 -0.1582792  -0.24560766  0.14899123 -0.15140162]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.02445257 -0.07288957 -0.1077984   0.08003496 -0.06998112]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -4.5368986  -6.9566784 -12.3062935 -12.13732   -92.69283  ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [-0.01829424 -0.02413884 -0.01092172  0.18965748  0.15758662]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.10679549  0.02566748  1.0498425  -0.04715704  0.13318725]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.10679549  0.02566748  1.0498425  -0.04715704  0.13318725]
  [MambaBlock.ssm] B sample values: [ 0.38533533  0.18274176 -0.11604108  0.39849114 -0.39755577]
  [MambaBlock.ssm] C sample values: [-0.16835909 -0.16795066  0.16312265 -0.18098336 -0.5047567 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.09833649 0.15807669 0.03763733 0.12910679 0.08461132]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [6.4009243e-01 5.0454646e-01 2.9815027e-01 3.0314580e-01 1.0999369e-04]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00092657  0.00043942 -0.00027903  0.0009582  -0.00095595]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00092657  0.00043942 -0.00027903  0.0009582  -0.00095595]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.00442384 -0.02119793 -0.00746434  0.01901031 -0.01089355]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00328944  0.00433982 -0.00101392  0.00684461 -0.00691938]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.05155706 -0.01440687 -0.01697997 -0.0461783  -0.02062456]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00581827  0.00169225 -0.00079409  0.00669308 -0.00688949]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.02849661  0.00636231 -0.01051518  0.00189453 -0.01278909]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 6.2553370e-03  6.6062727e-05  7.9832040e-04  7.0263920e-03
 -2.9497175e-03]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 2.7774131e-02 -5.8474643e-03 -2.4157833e-02  5.4722987e-05
  2.2831641e-03]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.00442384 -0.02119793 -0.00746434  0.01901031 -0.01089355]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.0039765  -0.01943846 -0.006287    0.03418954 -0.02192164]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.0039765  -0.01943846 -0.006287    0.03418954 -0.02192164]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.0039765  -0.01943846 -0.006287    0.03418954 -0.02192164]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.0010994   0.00537549 -0.01141897  0.00551335  0.00608655]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.02040965 -0.01528995  0.08051822 -0.01168582  0.01334456]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.08495113 -0.16704948 -0.30188984  0.14593297  0.05106199]
  [Mamba.__call__] After layer 13 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 13 sample values: [ 0.08495113 -0.16704948 -0.30188984  0.14593297  0.05106199]
[Mamba.__call__] Processing layer 14/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.08495113 -0.16704948 -0.30188984  0.14593297  0.05106199]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.08495113 -0.16704948 -0.30188984  0.14593297  0.05106199]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.414157   0.4214777  0.44845077 0.4449712  0.45435813]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.2582568  -0.50784093 -0.91776407  0.44364542  0.15523165]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.10695886 -0.21404363 -0.411572    0.19740944  0.07053076]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [ 2.4296339  -1.1361362   2.365358    0.8378961   0.14212628]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [0.22336933 0.32964593 0.17573956 0.01559146 0.29465812]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.10695886 -0.21404363 -0.411572    0.19740944  0.07053076]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.19772182  0.45030195  0.6260097  -0.09915446  0.4212234 ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.19772182  0.45030195  0.6260097  -0.09915446  0.4212234 ]
  [MambaBlock.__call__] res sample values: [-0.6018031  -0.6974186  -1.3351835  -0.89001995  0.16181865]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.06401582  0.06100997  0.06168052 -0.00259426 -1.1386995 ]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.03098375  0.03143525  0.03179108 -0.00129545 -0.27620208]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-11.354724    -0.32105714 -10.647851    -2.3114986   -1.1527222 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [0.22336933 0.32964593 0.17573956 0.01559146 0.29465812]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-1.6736461   0.37419614  0.7581458   0.6132138   0.7930434 ]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-1.6736461   0.37419614  0.7581458   0.6132138   0.7930434 ]
  [MambaBlock.ssm] B sample values: [ 0.41094792 -0.29534295  0.30332422 -0.6384199   0.41628218]
  [MambaBlock.ssm] C sample values: [-0.03284557 -0.3948718   0.6790214   0.15163557  1.7647283 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.03888406 0.06634577 0.03682993 0.17437041 0.0199386 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.6430597  0.9875936  0.66098005 0.91404045 0.95616716]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.0004951   0.00035582 -0.00036544  0.00076915 -0.00050153]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.0004951   0.00035582 -0.00036544  0.00076915 -0.00050153]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.00370536  0.00641438  0.00360106 -0.00069473 -0.01693738]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00153003 -0.00095513  0.00080719 -0.00105484 -0.0002609 ]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.02016445  0.03092147 -0.00624663  0.00287594 -0.04561664]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.0012638   0.00216622  0.00186744  0.00528387 -0.00335667]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00586671  0.01859142 -0.00418623  0.00968228 -0.03683576]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00181091  0.0065606   0.00491517  0.01544429 -0.00880243]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.05605     0.00793308 -0.0065522   0.03127938 -0.03850147]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.00370536  0.00641438  0.00360106 -0.00069473 -0.01693738]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.01062618  0.01677688  0.00918801 -0.00071493 -0.09832256]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.01062618  0.01677688  0.00918801 -0.00071493 -0.09832256]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.01062618  0.01677688  0.00918801 -0.00071493 -0.09832256]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.00226334 -0.00388907 -0.0025554   0.00018523 -0.00859746]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.08482799 -0.00491169 -0.01835087  0.0190629   0.04197344]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 1.2314320e-04 -1.7196117e-01 -3.2024071e-01  1.6499588e-01
  9.3035430e-02]
  [Mamba.__call__] After layer 14 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 14 sample values: [ 1.2314320e-04 -1.7196117e-01 -3.2024071e-01  1.6499588e-01
  9.3035430e-02]
[Mamba.__call__] Processing layer 15/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 1.2314320e-04 -1.7196117e-01 -3.2024071e-01  1.6499588e-01
  9.3035430e-02]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 1.2314320e-04 -1.7196117e-01 -3.2024071e-01  1.6499588e-01
  9.3035430e-02]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.40862855 0.4229514  0.45220223 0.43586957 0.46229798]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 3.6001462e-04 -5.0273615e-01 -9.3623793e-01  4.8237279e-01
  2.7199322e-01]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 1.4711225e-04 -2.1263295e-01 -4.2336887e-01  2.1025163e-01
  1.2574191e-01]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [-1.1833129   2.4601986   1.5252272   1.3796026   0.30299336]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [-0.10557265  0.29193106  0.05805935  0.08215625  0.22936048]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 1.4711225e-04 -2.1263295e-01 -4.2336887e-01  2.1025163e-01
  1.2574191e-01]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.5021427   0.23892155 -1.1307881   0.47848222  0.89092845]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 0.5021427   0.23892155 -1.1307881   0.47848222  0.89092845]
  [MambaBlock.__call__] res sample values: [-0.388735    0.48722297  4.9794383   0.7899349   2.038154  ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.00095077 -0.08089981  0.16708954 -0.03059329  0.19274747]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.00047516 -0.0388146   0.0905083  -0.01506268  0.10563299]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -0.30626243 -11.707136    -4.5961876   -3.9733222   -1.3539054 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [-0.10557265  0.29193106  0.05805935  0.08215625  0.22936048]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [0.37805408 0.19762845 0.42600083 0.54678804 0.26450017]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [0.37805408 0.19762845 0.42600083 0.54678804 0.26450017]
  [MambaBlock.ssm] B sample values: [-0.49948052  0.16853559 -0.01148467 -0.78302944  0.4533555 ]
  [MambaBlock.ssm] C sample values: [ 0.2497788   0.21830928 -0.30349076  0.14730123 -0.10330532]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [1.4335820e-01 4.6034556e-02 1.5340750e-01 1.3352244e-01 1.3713242e-04]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.95704466 0.18668848 0.5174196  0.56574696 0.8235809 ]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 3.4023633e-05 -1.1480314e-05  7.8231295e-07  5.3338430e-05
 -3.0881685e-05]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 3.4023633e-05 -1.1480314e-05  7.8231295e-07  5.3338430e-05
 -3.0881685e-05]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-2.2512513e-04 -5.9052864e-03  4.5887757e-02 -6.6468879e-03
  4.7874204e-05]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00073875 -0.00047098 -0.00013096  0.0006728  -0.00055671]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-7.0929574e-03 -1.0776103e-02  5.7093700e-04  1.8466550e-03
  3.7872120e-05]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00151243 -0.00321193 -0.0003515   0.00314829 -0.00207666]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-7.7089127e-03 -1.7818402e-02  1.0464920e-02  6.2856632e-03
  5.3345280e-05]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00206997 -0.00049617  0.00213858  0.0054102  -0.00092557]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-1.5650684e-02 -6.6465219e-03  1.6370423e-01 -2.8485356e-02
 -3.8147304e-05]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-2.2512513e-04 -5.9052864e-03  4.5887757e-02 -6.6468879e-03
  4.7874204e-05]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.00017496 -0.01723647  0.05114261 -0.00788438  0.02427591]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.00017496 -0.01723647  0.05114261 -0.00788438  0.02427591]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.00017496 -0.01723647  0.05114261 -0.00788438  0.02427591]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 2.7478965e-05 -5.2021621e-03  2.5292191e-01 -4.2838282e-03
  4.3775450e-02]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.06629656 -0.00481688  0.0134919   0.07432287  0.00810635]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.06641971 -0.17677805 -0.3067488   0.23931876  0.10114178]
  [Mamba.__call__] After layer 15 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 15 sample values: [ 0.06641971 -0.17677805 -0.3067488   0.23931876  0.10114178]
[Mamba.__call__] Processing layer 16/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.06641971 -0.17677805 -0.3067488   0.23931876  0.10114178]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.06641971 -0.17677805 -0.3067488   0.23931876  0.10114178]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.38957533 0.3980925  0.43321887 0.39905244 0.4336651 ]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.18660998 -0.49666807 -0.8618284   0.6723798   0.28416365]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.07269865 -0.19771984 -0.3733603   0.2683148   0.12323186]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [-0.6384903  1.4791211  4.7785773  1.0750815  1.3726223]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [-0.08135885  0.19782306 -0.07084923 -0.04618492  0.24750087]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.07269865 -0.19771984 -0.3733603   0.2683148   0.12323186]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [0.02123362 0.74682957 0.21291745 0.68746436 0.37098327]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [0.02123362 0.74682957 0.21291745 0.68746436 0.37098327]
  [MambaBlock.__call__] res sample values: [-0.40050998 -0.8087535  -0.751108   -0.21412118 -1.0170223 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.00187089 -0.15416992  0.02448041  0.01064341  0.02027638]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.00093457 -0.07115461  0.01239002  0.00535003  0.01024097]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [  -0.52808905   -4.3890862  -118.93503      -2.9302316    -3.9456837 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [-0.08135885  0.19782306 -0.07084923 -0.04618492  0.24750087]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.33790058 -0.8035666  -0.01430459 -0.09003595 -0.10726751]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [ 0.33790058 -0.8035666  -0.01430459 -0.09003595 -0.10726751]
  [MambaBlock.ssm] B sample values: [-0.67293054 -0.40780157 -0.30216116 -0.08955435  0.95066154]
  [MambaBlock.ssm] C sample values: [ 0.2490097   0.05566888 -0.03861779  0.2163374  -0.96473736]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.18747646 0.09313501 0.07799213 0.1865262  0.09611367]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [9.0573883e-01 4.3917805e-01 2.0716247e-10 5.7732528e-01 4.7724620e-01]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 1.1790414e-04  7.1450901e-05  5.2941650e-05  1.5690815e-05
 -1.6656538e-04]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 1.1790414e-04  7.1450901e-05  5.2941650e-05  1.5690815e-05
 -1.6656538e-04]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.00068103 -0.02575853  0.00375602  0.00387883  0.00382588]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 1.9406989e-04  1.1561134e-04  3.9541294e-05 -2.3968303e-05
 -3.0683752e-04]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.00143949 -0.00406997  0.00419958 -0.00874887 -0.08477792]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 2.6599620e-04  1.7101789e-04  5.4007967e-05 -3.1559954e-05
 -3.6269199e-04]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00103617  0.01071843  0.00292741 -0.01259495 -0.01595128]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00025361 -0.00045715 -0.00038316  0.00025468  0.00064526]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.00327411  0.00326044  0.1384629  -0.00614704  0.02452588]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.00068103 -0.02575853  0.00375602  0.00387883  0.00382588]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.00060499 -0.03983455  0.0028782   0.00363174  0.00636053]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.00060499 -0.03983455  0.0028782   0.00363174  0.00636053]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.00060499 -0.03983455  0.0028782   0.00363174  0.00636053]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 9.7210206e-05  9.9276612e-03 -6.9304125e-04 -3.4734764e-04
 -1.7181631e-03]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.11111209  0.03057032 -0.01637608 -0.08805373 -0.1540723 ]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-0.04469238 -0.14620772 -0.3231249   0.15126503 -0.05293052]
  [Mamba.__call__] After layer 16 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 16 sample values: [-0.04469238 -0.14620772 -0.3231249   0.15126503 -0.05293052]
[Mamba.__call__] Processing layer 17/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-0.04469238 -0.14620772 -0.3231249   0.15126503 -0.05293052]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-0.04469238 -0.14620772 -0.3231249   0.15126503 -0.05293052]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.40098956 0.41633815 0.45234784 0.41429552 0.4576999 ]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.09899013 -0.32383865 -0.71569633  0.33504018 -0.11723696]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.03969401 -0.13482638 -0.3237437   0.13880564 -0.05365934]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [-0.09650902 -1.4060103   1.7536957   0.49934658  1.2886624 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [0.20261939 0.0586982  0.40245745 0.39130363 0.34289336]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.03969401 -0.13482638 -0.3237437   0.13880564 -0.05365934]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.31087533 -0.01973882 -1.4254851   0.29456478 -1.1775312 ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 0.31087533 -0.01973882 -1.4254851   0.29456478 -1.1775312 ]
  [MambaBlock.__call__] res sample values: [-0.6492813  -0.6661077  -0.6165246   0.56448543  0.4601501 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.04223406 -0.02434394  0.4381729  -0.05112049 -0.3554742 ]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.02156289 -0.01202382  0.26633185 -0.02490706 -0.14647514]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-0.9080017  -0.24511929 -5.7759094  -1.6476443  -3.6279306 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [0.20261939 0.0586982  0.40245745 0.39130363 0.34289336]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.15380943  0.72518545 -0.22693296 -0.6004174   0.01462471]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.15380943  0.72518545 -0.22693296 -0.6004174   0.01462471]
  [MambaBlock.ssm] B sample values: [ 0.42038637 -0.16860962  0.35512418  0.20452023  0.6673707 ]
  [MambaBlock.ssm] C sample values: [-0.23264071 -0.33181566 -0.33887425  0.6017153   0.58961844]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.0870304  0.118586   0.02236309 0.06160861 0.02671753]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.92401797 0.9788931  0.6049075  0.8664116  0.7292489 ]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00078891 -0.00031642  0.00066644  0.00038381  0.00125241]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00078891 -0.00031642  0.00066644  0.00038381  0.00125241]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.00587034 -0.00446027  0.01863118 -0.00480009 -0.01224181]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 1.7785032e-03 -1.3069178e-03  1.5570329e-03 -5.0638366e-05
  2.2218057e-03]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.01394762 -0.0022514   0.03090511  0.02283554  0.01316511]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00152468  0.00598968  0.00119109  0.00112909 -0.00371085]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.01866371  0.0259963   0.03479768 -0.00049431 -0.00607272]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00036306  0.005845    0.00186845  0.00229817 -0.00126271]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00467832  0.11507234  0.03862793 -0.02936438  0.00418704]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.00587034 -0.00446027  0.01863118 -0.00480009 -0.01224181]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.0102394  -0.00516605  0.12581842 -0.01454632 -0.06246717]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.0102394  -0.00516605  0.12581842 -0.01454632 -0.06246717]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.0102394  -0.00516605  0.12581842 -0.01454632 -0.06246717]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.00228136  0.00116782 -0.02719394 -0.00523455 -0.01762167]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [0.07013804 0.096883   0.14608468 0.08404408 0.07546656]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.02544566 -0.04932472 -0.1770402   0.23530911  0.02253604]
  [Mamba.__call__] After layer 17 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 17 sample values: [ 0.02544566 -0.04932472 -0.1770402   0.23530911  0.02253604]
[Mamba.__call__] Processing layer 18/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.02544566 -0.04932472 -0.1770402   0.23530911  0.02253604]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.02544566 -0.04932472 -0.1770402   0.23530911  0.02253604]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.39619008 0.39835802 0.42578524 0.40087798 0.43663165]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.05288112 -0.10250653 -0.36792454  0.48901886  0.04683435]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.02095097 -0.0408343  -0.15665685  0.19603689  0.02044936]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.98767895 2.1892378  1.6279833  0.55709547 1.0578349 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [0.10466145 0.00180788 0.47517148 0.11749051 0.37087148]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.02095097 -0.0408343  -0.15665685  0.19603689  0.02044936]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.8916986  -0.7339784   0.81252164 -0.5339998   1.2390723 ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 0.8916986  -0.7339784   0.81252164 -0.5339998   1.2390723 ]
  [MambaBlock.__call__] res sample values: [-0.44159538 -0.4423831  -0.49264765  0.13735266  0.6415179 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.03408431  0.00555529 -0.22156781 -0.12343842  0.14901274]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.01733256  0.00278536 -0.0985608  -0.05791477  0.08004732]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-2.6849952 -8.928406  -5.093592  -1.745595  -2.8801284]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [0.10466145 0.00180788 0.47517148 0.11749051 0.37087148]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.49188465 -1.946333    0.6910133  -1.2281077   1.6287661 ]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [ 0.49188465 -1.946333    0.6910133  -1.2281077   1.6287661 ]
  [MambaBlock.ssm] B sample values: [ 0.14808223 -0.1757098  -0.12014904  0.23799624 -0.9984147 ]
  [MambaBlock.ssm] C sample values: [ 0.4078778  -0.23654592  0.09579989  0.48537204 -1.2044032 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.11278754 0.19051623 0.07361975 0.08755925 0.07185477]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.7387217  0.36530858 0.56298983 0.82128805 0.7226411 ]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00028949 -0.00034349 -0.00023488  0.00046526 -0.0019518 ]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00028949 -0.00034349 -0.00023488  0.00046526 -0.0019518 ]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.00465345  0.00126318 -0.01727227 -0.01207097  0.01369157]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00023656 -0.00035991 -0.00022648  0.00062616 -0.0021398 ]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.00505413 -0.00505024 -0.01673802 -0.01560254 -0.01804078]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00290677  0.00358956 -0.00123836 -0.00058542  0.00264958]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00544989 -0.00896943 -0.01519284 -0.01951077 -0.02496794]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00189207  0.00179737  0.0001586  -0.00022481  0.00400336]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00632733 -0.02446517  0.00300654 -0.03661638 -0.02637289]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.00465345  0.00126318 -0.01727227 -0.01207097  0.01369157]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.0064675   0.00126821 -0.06410555 -0.01887541  0.04337884]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.0064675   0.00126821 -0.06410555 -0.01887541  0.04337884]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.0064675   0.00126821 -0.06410555 -0.01887541  0.04337884]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.00111773 -0.00021946  0.0119779  -0.00138518  0.01823022]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.04089933  0.03662508 -0.03745418  0.03180731  0.02468426]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-0.01545367 -0.01269964 -0.21449438  0.26711643  0.0472203 ]
  [Mamba.__call__] After layer 18 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 18 sample values: [-0.01545367 -0.01269964 -0.21449438  0.26711643  0.0472203 ]
[Mamba.__call__] Processing layer 19/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-0.01545367 -0.01269964 -0.21449438  0.26711643  0.0472203 ]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-0.01545367 -0.01269964 -0.21449438  0.26711643  0.0472203 ]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.40449935 0.42660734 0.4643959  0.41572392 0.45532542]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.03100042 -0.02547578 -0.43028075  0.5358418   0.09472502]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.01253965 -0.01086815 -0.19982062  0.22276226  0.04313071]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [ 0.63455945 -0.02727804  2.6079872   0.9138326   2.6638064 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [ 0.2745379   0.49890783 -0.06057632  0.05402975  0.27243164]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.01253965 -0.01086815 -0.19982062  0.22276226  0.04313071]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.16038235 -1.0621219  -0.35792392  0.29853255 -0.3448382 ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 0.16038235 -1.0621219  -0.35792392  0.29853255 -0.3448382 ]
  [MambaBlock.__call__] res sample values: [-0.41075894  0.01492572  1.6903541  -0.01738918 -1.2822008 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.0776872  -0.1323293   0.01269472  0.06914283 -0.05394601]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.03733553 -0.06179326  0.00638765  0.03576612 -0.02624564]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -1.886191    -0.97309065 -13.571706    -2.4938622  -14.350811  ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [ 0.2745379   0.49890783 -0.06057632  0.05402975  0.27243164]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.20303218 -0.01148511 -0.57977235  0.28659526  1.3970524 ]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.20303218 -0.01148511 -0.57977235  0.28659526  1.3970524 ]
  [MambaBlock.ssm] B sample values: [ 0.3786211  -0.50448376 -0.49632627 -0.2241379   0.6940937 ]
  [MambaBlock.ssm] C sample values: [-0.1390222  -0.27304578 -0.13199767 -0.3749668  -0.46378738]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.06961057 0.08708233 0.07345101 0.05685581 0.06198976]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.8769557  0.9345058  0.38878292 0.8406338  0.36825925]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00098402  0.00131113  0.00128993  0.00058252 -0.00180391]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00098402  0.00131113  0.00128993  0.00058252 -0.00180391]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.00609855 -0.01262701  0.00110095  0.00477173 -0.00381774]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00347772  0.00494783  0.00149751  0.00315712 -0.00528378]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.03561811 -0.02736009 -0.00282885  0.02224204 -0.02786017]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00609936  0.00897663  0.00105175  0.01082102 -0.00532328]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.03419551  0.00770172 -0.00035438  0.09846946 -0.0217036 ]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00572816  0.00819761  0.0025723   0.01013269 -0.00277529]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.03699975  0.02569846  0.05878172  0.1589696  -0.01726969]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.00609855 -0.01262701  0.00110095  0.00477173 -0.00381774]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.01634857 -0.04345616  0.00071401  0.00670417 -0.01096788]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.01634857 -0.04345616  0.00071401  0.00670417 -0.01096788]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.01634857 -0.04345616  0.00071401  0.00670417 -0.01096788]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 2.6776020e-03 -3.2672740e-04  1.0189774e-03 -5.7783174e-05
  3.0541499e-03]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.04898984 -0.00377423 -0.0438803   0.01149738 -0.02514161]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.03353617 -0.01647387 -0.2583747   0.2786138   0.02207869]
  [Mamba.__call__] After layer 19 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 19 sample values: [ 0.03353617 -0.01647387 -0.2583747   0.2786138   0.02207869]
[Mamba.__call__] Processing layer 20/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.03353617 -0.01647387 -0.2583747   0.2786138   0.02207869]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.03353617 -0.01647387 -0.2583747   0.2786138   0.02207869]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.4091083  0.42689073 0.471323   0.40874353 0.46574795]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.05665936 -0.0278326  -0.43652403  0.47071803  0.03730195]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.02317982 -0.01188148 -0.20574382  0.19240294  0.0173733 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.9836826 2.4339266 0.9138453 3.1313317 1.6966245]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [ 0.03855137  0.3293422   0.0585006   0.3628982  -0.03627338]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.02317982 -0.01188148 -0.20574382  0.19240294  0.0173733 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.03160505  0.04590425 -0.12510534  0.51620364  0.17498565]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.03160505  0.04590425 -0.12510534  0.51620364  0.17498565]
  [MambaBlock.__call__] res sample values: [-0.9395829  -0.4406328   0.7616234   0.72453636 -0.30423597]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.00243494 -0.02142002  0.01020151 -0.15245518 -0.01867698]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.00121895 -0.01059531  0.00512677 -0.07042818 -0.00925128]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -2.6742864 -11.403571   -2.4938939 -22.90446    -5.4555016]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [ 0.03855137  0.3293422   0.0585006   0.3628982  -0.03627338]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.4146389   0.84326404 -3.041825   -0.5899745  -0.91336614]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [ 0.4146389   0.84326404 -3.041825   -0.5899745  -0.91336614]
  [MambaBlock.ssm] B sample values: [-0.33029133  0.22063464 -0.06071424 -0.14873326  0.01787252]
  [MambaBlock.ssm] C sample values: [ 0.6377791  -0.42012343  0.02892813  0.02878907  0.1282677 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.10839049 0.07153045 0.13234739 0.02208641 0.01608028]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.74836296 0.29053283 0.76313955 0.08352363 0.5535936 ]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-4.3639051e-05  2.9150890e-05 -8.0217424e-06 -1.9651070e-05
  2.3613693e-06]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-4.3639051e-05  2.9150890e-05 -8.0217424e-06 -1.9651070e-05
  2.3613693e-06]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.00030191 -0.00173184  0.00155047 -0.00355448 -0.00033994]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-1.6894718e-04  1.5493331e-04  8.3112995e-05 -3.1304509e-05
  2.8234310e-06]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.00078301 -0.00437094  0.00071941 -0.00770439 -0.0027072 ]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-2.0435227e-04  1.5775244e-04  1.1158489e-04  3.9439055e-06
 -1.2703895e-05]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00173325 -0.00357363  0.00739585 -0.01679314  0.017947  ]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00217015  0.00118712  0.00046728 -0.00361738  0.00047763]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.02205209  0.00985422 -0.1213578  -0.02282161  0.00243061]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.00030191 -0.00173184  0.00155047 -0.00355448 -0.00033994]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 3.4890548e-04 -5.2213254e-03  1.8503889e-03 -2.9112734e-02
 -4.3625478e-06]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 3.4890548e-04 -5.2213254e-03  1.8503889e-03 -2.9112734e-02
 -4.3625478e-06]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 3.4890548e-04 -5.2213254e-03  1.8503889e-03 -2.9112734e-02
 -4.3625478e-06]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-9.2113958e-05  9.0092659e-04  9.6072804e-04 -1.4208512e-02
  5.6344464e-07]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.02316858 -0.08042333  0.03730689 -0.0048257  -0.1111429 ]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.0103676  -0.0968972  -0.2210678   0.2737881  -0.08906421]
  [Mamba.__call__] After layer 20 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 20 sample values: [ 0.0103676  -0.0968972  -0.2210678   0.2737881  -0.08906421]
[Mamba.__call__] Processing layer 21/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.0103676  -0.0968972  -0.2210678   0.2737881  -0.08906421]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.0103676  -0.0968972  -0.2210678   0.2737881  -0.08906421]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.34450698 0.3695207  0.42344126 0.34482557 0.3946986 ]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.01610098 -0.15048227 -0.34332037  0.4251955  -0.13831756]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.0055469  -0.05560631 -0.14537601  0.14661828 -0.05459375]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [ 5.539114   -0.05663848  0.13101557 -0.6862431  -0.7931561 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [-0.02986661 -0.02311049  0.3997492   0.48135066  0.552833  ]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.0055469  -0.05560631 -0.14537601  0.14661828 -0.05459375]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.9613073  -0.23545903 -1.7043953  -0.03234754  0.28563246]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.9613073  -0.23545903 -1.7043953  -0.03234754  0.28563246]
  [MambaBlock.__call__] res sample values: [-0.25103477  0.44722074 -0.5544477   0.16554648  0.5493207 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.00898556  0.00233624  0.64137673 -0.05805488  0.01211641]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.00451297  0.00116949  0.4201432  -0.02818508  0.00609491]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-254.45245     -0.9449356   -1.1399856   -0.503464    -0.4524147]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [-0.02986661 -0.02311049  0.3997492   0.48135066  0.552833  ]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-1.5690767   1.1900668  -0.28157413  0.54098386  0.06771988]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-1.5690767   1.1900668  -0.28157413  0.54098386  0.06771988]
  [MambaBlock.ssm] B sample values: [-0.2247616   0.03548957  0.05672303 -0.04872297  0.00987292]
  [MambaBlock.ssm] C sample values: [-0.61800194  0.28409144  0.7115327   0.11686131 -0.32431132]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.02777548 0.0153126  0.00195261 0.05265012 0.02688236]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [8.5232913e-04 9.7409540e-01 9.6883237e-01 9.8611337e-01 9.8751259e-01]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-2.8173818e-05  4.4486101e-06  7.1102190e-06 -6.1074138e-06
  1.2375680e-06]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-2.8173818e-05  4.4486101e-06  7.1102190e-06 -6.1074138e-06
  1.2375680e-06]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 3.7782083e-04  5.3976724e-05  2.4727262e-03 -4.4728154e-03
  4.9385184e-04]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00022962 -0.00117687 -0.0011087  -0.00087512  0.0006998 ]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.01118005  0.00046477  0.0058306  -0.02433146  0.04200628]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00093369 -0.00403534 -0.00243202 -0.00116688 -0.00116336]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00888271 -0.06768043  0.00400554 -0.02881293 -0.00249759]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00069913 -0.00420171 -0.00288377 -0.00014252 -0.00194413]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00779164 -0.04396141  0.00232899 -0.03665536  0.00196733]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 3.7782083e-04  5.3976724e-05  2.4727262e-03 -4.4728154e-03
  4.9385184e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 2.4303385e-04  2.6949310e-05  1.7042463e-01 -1.8039726e-02
  3.8633170e-03]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 2.4303385e-04  2.6949310e-05  1.7042463e-01 -1.8039726e-02
  3.8633170e-03]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 2.4303385e-04  2.6949310e-05  1.7042463e-01 -1.8039726e-02
  3.8633170e-03]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-2.6696051e-05  7.3516353e-06 -3.4473643e-02 -1.6165226e-03
  1.3454282e-03]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.03785651  0.06459945  0.0701392   0.01430595 -0.06272267]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-0.02748891 -0.03229775 -0.1509286   0.28809404 -0.15178688]
  [Mamba.__call__] After layer 21 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 21 sample values: [-0.02748891 -0.03229775 -0.1509286   0.28809404 -0.15178688]
[Mamba.__call__] Processing layer 22/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-0.02748891 -0.03229775 -0.1509286   0.28809404 -0.15178688]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-0.02748891 -0.03229775 -0.1509286   0.28809404 -0.15178688]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.41443673 0.4149674  0.46786335 0.40977475 0.47322857]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.04094749 -0.04811073 -0.2248233   0.42914498 -0.22610179]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.01697014 -0.01996438 -0.10518658  0.17585278 -0.10699783]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.8059847  0.41501895 1.6272945  0.767321   0.8307843 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [0.3662106  0.35947514 0.43692613 0.1591317  0.533095  ]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.01697014 -0.01996438 -0.10518658  0.17585278 -0.10699783]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-2.3269622  0.4965322  1.3123524 -0.2633826 -1.043201 ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-2.3269622  0.4965322  1.3123524 -0.2633826 -1.043201 ]
  [MambaBlock.__call__] res sample values: [ 0.05207488  0.6040041  -0.6776354   0.21823545  0.5486618 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.32077694 -0.1108034   0.18907236  0.08007447  0.1818046 ]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.13488235 -0.05233549  0.10344674  0.04163937  0.09914283]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-2.2389    -1.5143994 -5.090085  -2.153988  -2.295118 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [0.3662106  0.35947514 0.43692613 0.1591317  0.533095  ]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-1.1540606   0.05375133  1.213169    0.5727029  -0.27563173]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-1.1540606   0.05375133  1.213169    0.5727029  -0.27563173]
  [MambaBlock.ssm] B sample values: [-0.51870626 -0.50413877  0.8127858   1.0022321   0.24315223]
  [MambaBlock.ssm] C sample values: [0.35607666 0.0104642  0.44389504 0.16065952 1.5075585 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.10537951 0.03659538 0.12925611 0.21071471 0.05470626]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.78983265 0.8524961  0.5848554  0.79693174 0.78516734]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00737281  0.00716575 -0.0115528  -0.01424556 -0.00345613]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00737281  0.00716575 -0.0115528  -0.01424556 -0.00345613]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.04655803 -0.00627344  0.04379768  0.0287397   0.01776567]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00783613  0.0074249  -0.00981601 -0.01493715 -0.00373314]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.04577618 -0.03195892 -0.01919158  0.03864442  0.01690965]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00457358  0.00333293 -0.00525181 -0.00835324 -0.00267137]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.03408945 -0.03437517 -0.00530866  0.06069332  0.02004839]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00200233  0.00066021  0.00132691 -0.00302178 -0.0032871 ]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.00062625 -0.03399578  0.01331458  0.06809399  0.02091599]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.04655803 -0.00627344  0.04379768  0.0287397   0.01776567]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.09595338 -0.02508675  0.08899626  0.03536585  0.07061822]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.09595338 -0.02508675  0.08899626  0.03536585  0.07061822]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.09595338 -0.02508675  0.08899626  0.03536585  0.07061822]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.00256342 -0.00979718 -0.02031075  0.00427847  0.02455788]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.04827493 -0.12113374  0.00083058  0.02370317  0.05205137]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.02078602 -0.15343148 -0.15009803  0.3117972  -0.09973551]
  [Mamba.__call__] After layer 22 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 22 sample values: [ 0.02078602 -0.15343148 -0.15009803  0.3117972  -0.09973551]
[Mamba.__call__] Processing layer 23/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.02078602 -0.15343148 -0.15009803  0.3117972  -0.09973551]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.02078602 -0.15343148 -0.15009803  0.3117972  -0.09973551]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.38252255 0.3862539  0.44333753 0.37556562 0.42468974]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.02903779 -0.21434174 -0.20968497  0.4355766  -0.1393292 ]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.01110761 -0.08279033 -0.09296121  0.16358759 -0.05917168]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [-0.68874395 -0.38000074  4.3677626   4.8680816   0.10440765]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [0.23194943 0.49383003 0.3850962  0.2677807  0.2860499 ]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.01110761 -0.08279033 -0.09296121  0.16358759 -0.05917168]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [0.16953242 0.15325466 0.82880914 0.2989335  0.9955032 ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [0.16953242 0.15325466 0.82880914 0.2989335  0.9955032 ]
  [MambaBlock.__call__] res sample values: [-0.13841543  0.2719675  -0.15695778  0.4124179  -0.04563412]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.04896589 -0.05226253  0.11292717 -0.1666113  -0.24630731]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.02388365 -0.02544858  0.05964833 -0.07638183 -0.10806306]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [  -0.50220644   -0.6838609   -78.866974   -130.07115      -1.1100528 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [0.23194943 0.49383003 0.3850962  0.2677807  0.2860499 ]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.1994212  -0.41065478 -0.5326124  -0.22299418  0.28225452]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [ 0.1994212  -0.41065478 -0.5326124  -0.22299418  0.28225452]
  [MambaBlock.ssm] B sample values: [-0.44722092  0.23306438 -0.11955226 -0.5814046  -0.16551915]
  [MambaBlock.ssm] C sample values: [ 0.3291674   0.06537552 -1.0886701  -0.2447036  -0.79622155]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.10690605 0.18676876 0.08237104 0.03321279 0.0427968 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [9.4772691e-01 9.2949963e-01 2.1792568e-04 9.1403894e-07 8.8809961e-01]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00114189 -0.00059508  0.00030525  0.0014845   0.00042262]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00114189 -0.00059508  0.00030525  0.0014845   0.00042262]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.00780422 -0.01452762  0.01501757 -0.00775394 -0.01413563]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00161697 -0.00076511  0.00018538  0.00058905  0.00087778]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.0121961  -0.01252897 -0.00371656 -0.0126395  -0.02055998]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 1.2708271e-03 -1.3324636e-04  8.7951354e-05 -7.5275433e-04
  6.4480386e-04]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.01091288 -0.02831584 -0.0133053   0.00330206 -0.01602822]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00338539  0.00584184 -0.00143842 -0.01153592 -0.00487168]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.06102016  0.01558587  0.05070719  0.02209112 -0.01562004]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.00780422 -0.01452762  0.01501757 -0.00775394 -0.01413563]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.01334402 -0.02709489  0.03798791 -0.02820751 -0.04504706]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.01334402 -0.02709489  0.03798791 -0.02820751 -0.04504706]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.01334402 -0.02709489  0.03798791 -0.02820751 -0.04504706]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.0008597  -0.00418243 -0.00274776 -0.00699937  0.00100439]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.06476054 -0.05824471  0.0842578  -0.03826246 -0.01045684]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.08554655 -0.21167618 -0.06584023  0.27353474 -0.11019235]
  [Mamba.__call__] After layer 23 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 23 sample values: [ 0.08554655 -0.21167618 -0.06584023  0.27353474 -0.11019235]
[Mamba.__call__] Processing layer 24/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.08554655 -0.21167618 -0.06584023  0.27353474 -0.11019235]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.08554655 -0.21167618 -0.06584023  0.27353474 -0.11019235]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.44621253 0.46593353 0.52614003 0.42490464 0.4875036 ]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.10964718 -0.27131072 -0.08438909  0.3505964  -0.14123632]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.04892594 -0.12641276 -0.04440048  0.14897004 -0.06885321]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [-1.2839794  -1.0760248   0.20480263 -0.61678374 -0.358314  ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [-0.11519222  0.02512332  0.48811096  0.04514555 -0.00941473]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.04892594 -0.12641276 -0.04440048  0.14897004 -0.06885321]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.7163109 -0.3106708 -0.3500815 -2.1460452  0.7900406]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.7163109 -0.3106708 -0.3500815 -2.1460452  0.7900406]
  [MambaBlock.__call__] res sample values: [-0.71567786  0.08403787 -0.41559517  1.6921761  -0.07462342]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.00352164 -0.0069012  -0.06563022 -0.03499857  0.02509538]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.00175772 -0.00343869 -0.03173866 -0.01719309  0.01270513]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-0.27693307 -0.3409482  -1.2272828  -0.5396774  -0.6988536 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [-0.11519222  0.02512332  0.48811096  0.04514555 -0.00941473]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.8445531  -0.33405545  1.7296765  -0.7328732   1.8971729 ]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [ 0.8445531  -0.33405545  1.7296765  -0.7328732   1.8971729 ]
  [MambaBlock.ssm] B sample values: [ 0.8717756   0.14408638 -1.246942    0.08393929  0.08481377]
  [MambaBlock.ssm] C sample values: [ 0.46086258  0.14430267 -0.00794407 -0.40470544 -0.0034938 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.06741179 0.09660822 0.03022841 0.10545215 0.06408879]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.9815046 0.9772782 0.9205966 0.9642732 0.9539815]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-1.0329744e-04 -1.7072918e-05  1.4775123e-04 -9.9460385e-06
 -1.0049656e-05]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-1.0329744e-04 -1.7072918e-05  1.4775123e-04 -9.9460385e-06
 -1.0049656e-05]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-8.6624314e-05 -2.4286348e-04 -7.0138893e-04 -1.3254526e-03
  5.9527264e-04]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00119821 -0.00153844 -0.00357246 -0.00051681  0.00028562]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.00621615 -0.00398552 -0.00562676 -0.03034717 -0.00255549]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.02554208  0.00319066 -0.04369858 -0.04954662 -0.01046882]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.14206523 -0.02770406 -0.01012118 -0.04655812 -0.02649439]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.0441354   0.00498536 -0.07862671 -0.03984366 -0.02764737]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.1895673  -0.01731837 -0.00472086 -0.06561152 -0.0388011 ]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-8.6624314e-05 -2.4286348e-04 -7.0138893e-04 -1.3254526e-03
  5.9527264e-04]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.00011585 -0.00032925 -0.01619338 -0.00210164  0.00047566]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.00011585 -0.00032925 -0.01619338 -0.00210164  0.00047566]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.00011585 -0.00032925 -0.01619338 -0.00210164  0.00047566]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-2.7223783e-05 -1.4415926e-05  2.6756108e-03 -3.0033749e-03
 -1.7085704e-05]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.0242753   0.17151321  0.00664773 -0.22830404 -0.02434925]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.10982185 -0.04016297 -0.05919249  0.0452307  -0.1345416 ]
  [Mamba.__call__] After layer 24 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 24 sample values: [ 0.10982185 -0.04016297 -0.05919249  0.0452307  -0.1345416 ]
[Mamba.__call__] Processing layer 25/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.10982185 -0.04016297 -0.05919249  0.0452307  -0.1345416 ]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.10982185 -0.04016297 -0.05919249  0.0452307  -0.1345416 ]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.40095472 0.41227537 0.46359676 0.38453287 0.45116252]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.13655578 -0.04993983 -0.07360172  0.05624121 -0.16729304]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.05475269 -0.02058896 -0.03412152  0.02162659 -0.07547635]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.7954116  0.98950636 2.9395733  1.4701813  3.4397974 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [ 0.12032098  0.49105638  0.02935308 -0.07778682  0.08888909]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.05475269 -0.02058896 -0.03412152  0.02162659 -0.07547635]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.05943349  0.07455057 -0.04252958  0.40447384 -0.38267222]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.05943349  0.07455057 -0.04252958  0.40447384 -0.38267222]
  [MambaBlock.__call__] res sample values: [ 0.00821984  0.99556017 -0.58097047 -0.69568425  0.712717  ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.0441275  -0.078837   -0.00456627 -0.02731087 -0.0048824 ]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.02255048 -0.03786549 -0.00227792 -0.01346898 -0.00243524]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -2.2153525  -2.6899064 -18.907776   -4.3500237 -31.180641 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [ 0.12032098  0.49105638  0.02935308 -0.07778682  0.08888909]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.98631144 -0.45884317  0.548386   -0.86711466 -0.22183932]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.98631144 -0.45884317  0.548386   -0.86711466 -0.22183932]
  [MambaBlock.ssm] B sample values: [ 0.43326974 -0.8732176  -0.00172423  1.4026563   0.4264746 ]
  [MambaBlock.ssm] C sample values: [-0.1708983  -0.39121127 -0.4483951  -0.03247899  0.4575243 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.15098041 0.05198685 0.11893012 0.16921872 0.11721209]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.71571386 0.6662281  0.05757286 0.5185243  0.00902582]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 1.4751452e-03 -2.9730273e-03 -5.8704627e-06  4.7755972e-03
  1.4520099e-03]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 1.4751452e-03 -2.9730273e-03 -5.8704627e-06  4.7755972e-03
  1.4520099e-03]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.0059153  -0.00342009 -0.00047069 -0.00395989 -0.00049592]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00241858 -0.00384978 -0.00021739  0.00529395  0.00168479]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.00810912 -0.00700681 -0.00101017  0.00775553 -0.00295931]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00348079 -0.00440191 -0.00200357  0.00488771  0.00274478]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.01325513 -0.02168955  0.00235422  0.00013206 -0.00276694]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00787731 -0.01489544 -0.00210159  0.01617047  0.00666233]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.03737343 -0.04005542 -0.01156165 -0.01003296  0.00095986]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.0059153  -0.00342009 -0.00047069 -0.00395989 -0.00049592]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.0086286  -0.02201418 -0.00053755 -0.00291219 -0.00071239]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.0086286  -0.02201418 -0.00053755 -0.00291219 -0.00071239]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.0086286  -0.02201418 -0.00053755 -0.00291219 -0.00071239]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 3.5608595e-05 -1.6003050e-02  1.1202513e-04  6.7417877e-04
 -3.4068935e-04]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.02240401 -0.02513313 -0.01954412 -0.02857332  0.01626449]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.13222586 -0.0652961  -0.07873662  0.01665738 -0.11827711]
  [Mamba.__call__] After layer 25 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 25 sample values: [ 0.13222586 -0.0652961  -0.07873662  0.01665738 -0.11827711]
[Mamba.__call__] Processing layer 26/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.13222586 -0.0652961  -0.07873662  0.01665738 -0.11827711]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.13222586 -0.0652961  -0.07873662  0.01665738 -0.11827711]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.46555212 0.49007273 0.54502    0.43025538 0.50288516]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.15850133 -0.07827152 -0.0943829   0.01996748 -0.14178073]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.07379063 -0.03835874 -0.05144057  0.00859112 -0.07129943]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [-0.48185706 -0.46086672 -0.3315322  -0.45892227 -0.46264422]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [-0.00756932  0.01820871 -0.09491296 -0.01554861  0.21211179]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.07379063 -0.03835874 -0.05144057  0.00859112 -0.07129943]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.27398768 -0.9060748   0.28626248  0.7595202  -0.42351204]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.27398768 -0.9060748   0.28626248  0.7595202  -0.42351204]
  [MambaBlock.__call__] res sample values: [-1.1057899  -0.35429728 -0.31480977 -0.020625   -0.03480481]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.02219044 -0.03575125 -0.00369053 -0.02958426  0.10504018]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.01097212 -0.01755612 -0.00184186 -0.01457334  0.05527592]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-0.61763537 -0.6307367  -0.717823   -0.6319644  -0.6296166 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [-0.00756932  0.01820871 -0.09491296 -0.01554861  0.21211179]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-1.3832425   0.20826098 -0.5037421   1.3349028  -0.05895538]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-1.3832425   0.20826098 -0.5037421   1.3349028  -0.05895538]
  [MambaBlock.ssm] B sample values: [-0.0665981  -0.509542   -0.00599552 -0.0453503  -0.04944998]
  [MambaBlock.ssm] C sample values: [-0.10876623 -0.6846129   0.03495482 -0.04601172 -0.18808937]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.03124384 0.00466307 0.02704205 0.01561467 0.00085927]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.9808877  0.9804863  0.97782207 0.98044866 0.9805206 ]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [2.2830580e-05 1.7467672e-04 2.0553316e-06 1.5546593e-05 1.6952008e-05]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [2.2830580e-05 1.7467672e-04 2.0553316e-06 1.5546593e-05 1.6952008e-05]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-6.269797e-04 -1.497264e-04 -9.109491e-05 -4.161888e-04  8.686867e-05]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 1.0209721e-05  1.3048865e-04 -5.9544805e-06 -4.1566273e-06
 -2.1931373e-07]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-3.1763734e-04  5.3780107e-04  3.1781217e-04 -8.3354709e-05
  1.5067802e-04]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 6.0102022e-05  6.6273096e-05  2.1281645e-05 -8.9372341e-05
 -8.8132016e-05]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-3.7417779e-04 -2.6812497e-05  1.3428923e-03 -5.4420093e-03
  1.8762471e-04]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 6.5068263e-05  1.0553544e-04  4.7592534e-05 -2.1642518e-05
 -5.8210178e-05]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00047605 -0.00044007  0.00101228  0.00490811  0.00015116]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-6.269797e-04 -1.497264e-04 -9.109491e-05 -4.161888e-04  8.686867e-05]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-5.4392818e-04 -4.6940075e-04  8.3721250e-05 -1.8959367e-04
  1.1811542e-02]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-5.4392818e-04 -4.6940075e-04  8.3721250e-05 -1.8959367e-04
  1.1811542e-02]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-5.4392818e-04 -4.6940075e-04  8.3721250e-05 -1.8959367e-04
  1.1811542e-02]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 1.4955956e-04  6.8575318e-05 -1.1120795e-05  1.9350221e-06
 -2.0197254e-04]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.00738874 -0.02726876  0.10854077  0.01440354 -0.04930353]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.12483712 -0.09256485  0.02980416  0.03106092 -0.16758063]
  [Mamba.__call__] After layer 26 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 26 sample values: [ 0.12483712 -0.09256485  0.02980416  0.03106092 -0.16758063]
[Mamba.__call__] Processing layer 27/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.12483712 -0.09256485  0.02980416  0.03106092 -0.16758063]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.12483712 -0.09256485  0.02980416  0.03106092 -0.16758063]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.3611152  0.39844495 0.434356   0.36272687 0.41756853]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.14267127 -0.1057886   0.03406196  0.03549827 -0.1915211 ]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.05152076 -0.04215093  0.01479502  0.01287617 -0.07997318]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [ 1.40167     3.186871    2.2899542   2.0336785  -0.10155091]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [0.5629369  0.04950762 0.5065273  0.4323933  0.21534859]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.05152076 -0.04215093  0.01479502  0.01287617 -0.07997318]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.43090352  0.6001239   0.78718925  0.02854659 -0.3779598 ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 0.43090352  0.6001239   0.78718925  0.02854659 -0.3779598 ]
  [MambaBlock.__call__] res sample values: [-0.52224624  0.37900737  0.04408732 -0.17835122  0.74427366]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.07976983  0.00346655  0.09512188 -0.00456167  0.05827221]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.04147488  0.00173628  0.04982128 -0.00227563  0.02998477]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -4.061978  -24.21255    -9.874485   -7.6421466  -0.9034352]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [0.5629369  0.04950762 0.5065273  0.4323933  0.21534859]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.87008125 -0.32070118 -0.10684592 -0.977735    0.9759724 ]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [ 0.87008125 -0.32070118 -0.10684592 -0.977735    0.9759724 ]
  [MambaBlock.ssm] B sample values: [ 0.35896626 -0.26967776  1.2261273  -0.5145229   0.7158779 ]
  [MambaBlock.ssm] C sample values: [ 0.02605589  0.22739018 -0.10073391  0.08849443  0.52626204]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.13902235 0.12749493 0.05252507 0.12504104 0.13457356]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.5685274  0.03452452 0.253403   0.3456152  0.88196963]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00206978 -0.00155494  0.00706977 -0.00296671  0.00412771]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00206978 -0.00155494  0.00706977 -0.00296671  0.00412771]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.01632451  0.00062673  0.00740887 -0.00080561  0.01142434]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00202743 -0.0005562   0.00440736 -0.00231139  0.00418153]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.01311293  0.00577723  0.00056994 -0.00856075 -0.0157505 ]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00540194 -0.00279619  0.0087816  -0.00972024  0.00905102]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.04194659  0.00850874  0.00163216 -0.0336685  -0.03974055]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 8.3277002e-05  1.9407440e-03 -6.2528905e-03  1.8235617e-03
  3.3301688e-03]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.01178353  0.05079443 -0.00742509 -0.02551737  0.05026909]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.01632451  0.00062673  0.00740887 -0.00080561  0.01142434]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.03967226  0.00071269  0.03264471 -0.00178958  0.01788152]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.03967226  0.00071269  0.03264471 -0.00178958  0.01788152]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.03967226  0.00071269  0.03264471 -0.00178958  0.01788152]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.00771413  0.00016035  0.00073547  0.00014539  0.00902239]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.04032037 -0.02944357 -0.01354402  0.16706988  0.0785889 ]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.1651575  -0.12200843  0.01626014  0.1981308  -0.08899173]
  [Mamba.__call__] After layer 27 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 27 sample values: [ 0.1651575  -0.12200843  0.01626014  0.1981308  -0.08899173]
[Mamba.__call__] Processing layer 28/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.1651575  -0.12200843  0.01626014  0.1981308  -0.08899173]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.1651575  -0.12200843  0.01626014  0.1981308  -0.08899173]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.43348756 0.44831097 0.5099718  0.40039894 0.47434554]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.18390866 -0.13586067  0.01810623  0.2206256  -0.09909541]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.07972211 -0.06090783  0.00923367  0.08833826 -0.04700547]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [1.376017  2.5373073 2.7932975 1.8990749 2.175236 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [ 0.5588031  -0.02234694 -0.01343939  0.03779431  0.05296663]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.07972211 -0.06090783  0.00923367  0.08833826 -0.04700547]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-1.0702122  -0.48223653 -0.23898356 -0.65349287 -1.653272  ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-1.0702122  -0.48223653 -0.23898356 -0.65349287 -1.653272  ]
  [MambaBlock.__call__] res sample values: [-0.45199278 -0.45082557  0.1755585   0.8666984   0.7785456 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.20953423  0.02510074 -0.00956757 -0.02239269 -1.4219551 ]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.11570327  0.01270787 -0.0047609  -0.01107099 -0.27636448]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -3.959101  -12.645574  -16.334795   -6.6797123  -8.804262 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [ 0.5588031  -0.02234694 -0.01343939  0.03779431  0.05296663]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.8602357 -1.3748817 -1.7264826 -0.5403154 -1.28597  ]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.8602357 -1.3748817 -1.7264826 -0.5403154 -1.28597  ]
  [MambaBlock.ssm] B sample values: [-0.3903593  -0.4691886   1.443587    0.29253608 -0.30030444]
  [MambaBlock.ssm] C sample values: [ 0.06555925 -1.0036937  -0.1766114  -0.11629454  0.13748384]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.08828429 0.24535045 0.13350044 0.20718062 0.08987517]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.70502186 0.32745472 0.23642936 0.55448604 0.45965546]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00398744 -0.00479266  0.01474592  0.00298819 -0.00306754]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00398744 -0.00479266  0.01474592  0.00298819 -0.00306754]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.00938418  0.00286436 -0.0005839  -0.00210719 -0.02281861]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00157804 -0.00062346  0.00087911  0.00092489 -0.00322291]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.00209687  0.00170075 -0.00267626 -0.01166309 -0.07585296]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00606515  0.00393597 -0.00968724 -0.00245462 -0.01274091]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.02853389 -0.00365908 -0.00861429 -0.0172517  -0.15526061]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00636103  0.00378667 -0.0086572  -0.00112813 -0.00819925]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.03296933  0.05758676 -0.0076668  -0.02354912 -0.14300442]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.00938418  0.00286436 -0.0005839  -0.00210719 -0.02281861]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.07403953  0.00258037 -0.00051992 -0.00252561 -0.03745671]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.07403953  0.00258037 -0.00051992 -0.00252561 -0.03745671]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.07403953  0.00258037 -0.00051992 -0.00252561 -0.03745671]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-1.3014235e-02 -4.5271462e-04 -4.9633742e-05 -1.5411412e-03
 -1.9986494e-02]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.03275339 -0.03926815  0.05139498 -0.00501497 -0.09781946]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.13240412 -0.16127658  0.06765512  0.19311583 -0.1868112 ]
  [Mamba.__call__] After layer 28 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 28 sample values: [ 0.13240412 -0.16127658  0.06765512  0.19311583 -0.1868112 ]
[Mamba.__call__] Processing layer 29/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.13240412 -0.16127658  0.06765512  0.19311583 -0.1868112 ]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.13240412 -0.16127658  0.06765512  0.19311583 -0.1868112 ]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.512374   0.5315387  0.5914167  0.4486224  0.53760505]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.13426252 -0.16354023  0.06860471  0.19582637 -0.18943325]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.06879262 -0.08692797  0.04057397  0.0878521  -0.10184027]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.21824619 1.2390425  1.6764059  1.8690491  1.8064919 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [ 0.20407586 -0.01267501  0.01252667  0.38349828 -0.01500826]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.06879262 -0.08692797  0.04057397  0.0878521  -0.10184027]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 1.6988932   0.61725     0.19523865 -1.5812514   0.9751004 ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 1.6988932   0.61725     0.19523865 -1.5812514   0.9751004 ]
  [MambaBlock.__call__] res sample values: [-0.56915355 -2.1041923  -0.46720335  1.521747   -1.4746758 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-1.0266373  -0.01692551  0.00650682 -0.2664417  -0.00250943]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.2707618  -0.00839114  0.00326399 -0.11557732 -0.00125314]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-1.2438933 -3.4523063 -5.3463063 -6.482129  -6.0890484]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [ 0.20407586 -0.01267501  0.01252667  0.38349828 -0.01500826]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.7672171  -0.51442754 -0.5546485  -0.01426989  0.14468682]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [ 0.7672171  -0.51442754 -0.5546485  -0.01426989  0.14468682]
  [MambaBlock.ssm] B sample values: [ 0.6341937   0.10134002  0.154253    0.03408431 -0.01132058]
  [MambaBlock.ssm] C sample values: [ 0.69284755  0.12211604 -0.0403017  -0.06933279 -0.11238417]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [2.9776056e-05 9.5192408e-03 8.5174805e-03 9.7280335e-06 1.3032916e-02]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.999963  0.9998972 0.9998408 0.999807  0.9998187]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-5.1130082e-06 -8.1702535e-07 -1.2436215e-06 -2.7479518e-07
  9.1268973e-08]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-5.1130082e-06 -8.1702535e-07 -1.2436215e-06 -2.7479518e-07
  9.1268973e-08]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-1.8318789e-05 -1.8149531e-04  6.3168816e-05 -2.5546997e-06
 -3.7109381e-05]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-1.0001299e-05 -1.4808670e-06 -3.1167287e-06 -1.1053565e-07
  1.0741834e-07]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-2.6438116e-05 -3.6242310e-04  2.3357100e-04 -2.9014113e-06
 -1.8589795e-04]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-8.3785917e-06 -4.6409662e-07 -3.0541964e-06 -1.0252252e-06
 -1.5971176e-07]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-3.3906195e-05  1.2618060e-03  5.7097926e-04 -5.2353298e-06
  1.7110618e-03]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-6.7250066e-06  1.7496378e-06 -4.5380316e-06 -7.1728539e-07
 -2.4952906e-06]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-2.5260922e-05 -2.8551961e-03 -5.8942372e-03 -6.4362862e-06
 -4.6563190e-03]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-1.8318789e-05 -1.8149531e-04  6.3168816e-05 -2.5546997e-06
 -3.7109381e-05]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-5.5274263e-02 -7.5137548e-05  1.0405580e-04 -4.4326257e-02
 -1.8301920e-05]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-5.5274263e-02 -7.5137548e-05  1.0405580e-04 -4.4326257e-02
 -1.8301920e-05]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-5.5274263e-02 -7.5137548e-05  1.0405580e-04 -4.4326257e-02
 -1.8301920e-05]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 1.1370490e-02  1.7184311e-05 -1.8730394e-05 -5.5365410e-02
  5.0263152e-06]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.08195388  0.11686835 -0.02140612 -0.05242939  0.0559765 ]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.05045024 -0.04440823  0.046249    0.14068644 -0.1308347 ]
  [Mamba.__call__] After layer 29 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 29 sample values: [ 0.05045024 -0.04440823  0.046249    0.14068644 -0.1308347 ]
[Mamba.__call__] Processing layer 30/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.05045024 -0.04440823  0.046249    0.14068644 -0.1308347 ]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.05045024 -0.04440823  0.046249    0.14068644 -0.1308347 ]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.42579097 0.43660644 0.48905534 0.4046982  0.4686969 ]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.05017244 -0.0441637   0.04599433  0.13991176 -0.13011427]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.02136297 -0.01928216  0.02249377  0.05662204 -0.06098415]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [-0.09291578  5.946377    2.4513571   1.3040168   1.2974346 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [0.7055258  0.40262747 0.46451834 0.42921317 0.1706289 ]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.02136297 -0.01928216  0.02249377  0.05662204 -0.06098415]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 1.1146004  -0.35009855  0.29409283 -0.29927972 -0.17739297]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 1.1146004  -0.35009855  0.29409283 -0.29927972 -0.17739297]
  [MambaBlock.__call__] res sample values: [-1.4360329   0.35188967 -0.34721905  0.53689396 -0.45788237]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 1.1714549   0.01852966 -0.0782269  -0.04679451 -0.01431194]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.8942979   0.00935067 -0.03758437 -0.02284992 -0.00710476]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [  -0.91127026 -382.36545     -11.604084     -3.6840653    -3.6598954 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [0.7055258  0.40262747 0.46451834 0.42921317 0.1706289 ]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.46732676 -1.5188929   1.1719613   0.37540787 -0.08930092]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.46732676 -1.5188929   1.1719613   0.37540787 -0.08930092]
  [MambaBlock.ssm] B sample values: [-0.39143765 -0.39260784  0.8560962  -0.81596786  0.37583786]
  [MambaBlock.ssm] C sample values: [-0.42551607  0.04394498 -0.54795885 -0.05330876  0.01383029]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.90550864 0.05778236 0.07454067 0.10077606 0.16981174]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [4.3816355e-01 0.0000000e+00 2.7328022e-05 3.5580661e-02 3.6367968e-02]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.31698406 -0.31793165  0.693262   -0.66076624  0.30435142]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.31698406 -0.31793165  0.693262   -0.66076624  0.30435142]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 2.6020732e+00  1.7361309e-03 -9.0021295e-03 -7.3992354e-03
 -3.8766977e-03]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.34266573 -0.17595786  0.20981643 -0.24813928  0.27862146]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 2.7658644e+00  7.7336691e-03 -1.1660961e-02 -4.0378253e-04
 -2.6280393e-03]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.35976577 -0.17595652  0.2426882  -0.09834498  0.32581264]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 4.0231714e+00  2.6534589e-03 -1.2068697e-02 -2.4632731e-02
  6.2219282e-03]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.38491946 -0.07321302  0.18496266 -0.2302674   0.26734787]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 3.8489792   0.01181129 -0.00413138 -0.02032625  0.04950018]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 2.6020732e+00  1.7361309e-03 -9.0021295e-03 -7.3992354e-03
 -3.8766977e-03]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 3.2330234   0.00550097 -0.02646076 -0.01720672 -0.00508898]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 3.2330234   0.00550097 -0.02646076 -0.01720672 -0.00508898]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 3.2330234   0.00550097 -0.02646076 -0.01720672 -0.00508898]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.8921486   0.00113642  0.00380422 -0.00583012  0.00090291]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.0171992  -0.0280015  -0.0472332  -0.02555216  0.08030225]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.03325103 -0.07240973 -0.0009842   0.11513428 -0.05053245]
  [Mamba.__call__] After layer 30 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 30 sample values: [ 0.03325103 -0.07240973 -0.0009842   0.11513428 -0.05053245]
[Mamba.__call__] Processing layer 31/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.03325103 -0.07240973 -0.0009842   0.11513428 -0.05053245]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.03325103 -0.07240973 -0.0009842   0.11513428 -0.05053245]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.6013085  0.6070399  0.6889148  0.55449736 0.64650184]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.03096893 -0.06744006 -0.00091665  0.10723231 -0.04706427]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.01862188 -0.04093881 -0.0006315   0.05946003 -0.03042714]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [-1.215606   -0.07116253  0.32476607  2.2186933   0.3955726 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [-0.04562747  0.58152807  0.3038031  -0.10543346 -0.07839505]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.01862188 -0.04093881 -0.0006315   0.05946003 -0.03042714]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.24659854 -0.589821   -0.20292729 -0.8688298  -0.12217617]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 0.24659854 -0.589821   -0.20292729 -0.8688298  -0.12217617]
  [MambaBlock.__call__] res sample values: [-0.9511973   0.02459121 -0.51879764 -0.3131795  -1.0031301 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.00660801 -0.12380627 -0.08503749  0.01581082 -0.01231829]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.00329309 -0.05807602 -0.04071199  0.0079679  -0.00612121]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-0.29653028 -0.93131053 -1.3837069  -9.195307   -1.4852344 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [-0.04562747  0.58152807  0.3038031  -0.10543346 -0.07839505]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.03244162  0.8298279   3.7341099  -1.0946746  -1.2929864 ]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [ 0.03244162  0.8298279   3.7341099  -1.0946746  -1.2929864 ]
  [MambaBlock.ssm] B sample values: [ 0.4537924   0.5537049   0.04274791  1.3236443  -0.5403697 ]
  [MambaBlock.ssm] C sample values: [0.209257   0.68707675 0.08108699 0.88282514 0.00641122]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.13683705 0.02802672 0.01318743 0.6309388  0.5301918 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.9602359  0.8803482  0.82750314 0.2841484  0.81608635]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-2.0448620e-04 -2.4950842e-04 -1.9262903e-05 -5.9645559e-04
  2.4349934e-04]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-2.0448620e-04 -2.4950842e-04 -1.9262903e-05 -5.9645559e-04
  2.4349934e-04]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.00055165 -0.00199263 -0.00065726  0.00615445 -0.00397309]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-1.0139842e-03 -1.5430673e-03  7.0286856e-05 -1.5906765e-03
  9.3989674e-04]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-1.4354540e-03 -2.3639728e-03 -1.7512174e-03  7.6198103e-06
  3.2279196e-03]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00291644 -0.00626846  0.00120877 -0.00597987  0.00454048]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00779445 -0.00158001 -0.00750316 -0.00278974 -0.00732783]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.01038844 -0.01886459  0.00422504 -0.01264077  0.01433545]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.01554205  0.00208997 -0.01266985 -0.00640718 -0.01585321]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.00055165 -0.00199263 -0.00065726  0.00615445 -0.00397309]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.0004014  -0.03576547 -0.01302569  0.00531436 -0.00349321]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.0004014  -0.03576547 -0.01302569  0.00531436 -0.00349321]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.0004014  -0.03576547 -0.01302569  0.00531436 -0.00349321]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.00010639 -0.00044516  0.00252152 -0.00070292  0.00094026]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.02255516  0.06301124 -0.00108207  0.06023784  0.03367341]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.01069587 -0.00939849 -0.00206627  0.17537212 -0.01685903]
  [Mamba.__call__] After layer 31 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 31 sample values: [ 0.01069587 -0.00939849 -0.00206627  0.17537212 -0.01685903]
[Mamba.__call__] Processing layer 32/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.01069587 -0.00939849 -0.00206627  0.17537212 -0.01685903]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.01069587 -0.00939849 -0.00206627  0.17537212 -0.01685903]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.5931017  0.5960764  0.65239674 0.54884154 0.5894998 ]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.00959732 -0.00843319 -0.00185405  0.15736003 -0.01512748]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.00569219 -0.00502683 -0.00120957  0.08636572 -0.00891764]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [2.2937984 2.061236  1.9581789 1.8495171 1.9377776]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [ 0.41950485 -0.07299303  0.58377266  0.05457169  0.01359105]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.00569219 -0.00502683 -0.00120957  0.08636572 -0.00891764]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.01822752 -0.2537624   0.79866743  2.2056384   0.5560475 ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.01822752 -0.2537624   0.79866743  2.2056384   0.5560475 ]
  [MambaBlock.__call__] res sample values: [-0.00232655  0.25696015 -1.3013029   0.7839107  -1.7388473 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.03774051 -0.02293686 -0.10790264 -1.1920244   0.00462216]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.01851421 -0.01133691 -0.05104339 -0.27761897  0.00231642]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-9.9125185 -7.855673  -7.08641   -6.356749  -6.943303 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [ 0.41950485 -0.07299303  0.58377266  0.05457169  0.01359105]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-2.7885115  0.4861042  2.6724336  0.0822823 -1.1038768]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-2.7885115  0.4861042  2.6724336  0.0822823 -1.1038768]
  [MambaBlock.ssm] B sample values: [0.01666199 0.08409093 0.04083608 0.0370188  0.03545408]
  [MambaBlock.ssm] C sample values: [ 0.14862539 -0.6216006  -0.6825951  -0.05548993 -0.47140917]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [3.8719887e-04 4.0888060e-02 4.4126202e-05 9.9014244e-07 9.4361948e-03]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.99616927 0.9969629  0.9972599  0.9975417  0.99731517]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-1.1944452e-07 -6.0282110e-07 -2.9274085e-07 -2.6537600e-07
 -2.5415903e-07]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-1.1944452e-07 -6.0282110e-07 -2.9274085e-07 -2.6537600e-07
 -2.5415903e-07]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 2.2190295e-06  1.4348776e-04  6.9720397e-07  8.5088445e-08
 -6.7661017e-06]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-4.0814820e-07 -2.5308527e-06  3.3114227e-07  9.2193017e-07
 -1.7719256e-06]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [5.7083057e-06 4.0055948e-04 5.5287182e-07 8.9593925e-08 2.0699015e-05]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-5.24826783e-06  9.03110958e-06  1.27166695e-05  1.41387977e-06
  4.44653915e-06]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-2.64950340e-05 -8.18534475e-03 -1.07152395e-07 -9.37186940e-07
 -5.02826006e-04]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-3.32137074e-06  2.28661847e-05  1.64647827e-05 -3.74559386e-06
  1.15363055e-05]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-5.3143143e-05 -1.1738494e-02 -1.4655453e-06 -6.7273545e-06
  5.3153103e-03]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 2.2190295e-06  1.4348776e-04  6.9720397e-07  8.5088445e-08
 -6.7661017e-06]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-7.7645821e-03  9.7100309e-04 -2.9797042e-02 -1.5150052e-02
  2.4716515e-05]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-7.7645821e-03  9.7100309e-04 -2.9797042e-02 -1.5150052e-02
  2.4716515e-05]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-7.7645821e-03  9.7100309e-04 -2.9797042e-02 -1.5150052e-02
  2.4716515e-05]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 9.0218300e-06  1.4069543e-04  8.2957437e-03 -8.1533361e-03
 -6.4235028e-06]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.00432355 -0.13538575  0.00078938  0.08231046  0.05769121]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.01501942 -0.14478424 -0.00127689  0.2576826   0.04083218]
  [Mamba.__call__] After layer 32 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 32 sample values: [ 0.01501942 -0.14478424 -0.00127689  0.2576826   0.04083218]
[Mamba.__call__] Processing layer 33/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.01501942 -0.14478424 -0.00127689  0.2576826   0.04083218]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.01501942 -0.14478424 -0.00127689  0.2576826   0.04083218]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.7480675  0.7312186  0.80494416 0.6831533  0.7804541 ]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.01300815 -0.12539598 -0.0011059   0.22317596  0.03536429]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.00973097 -0.09169187 -0.00089019  0.15246339  0.0276002 ]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [-0.6126094  -0.4817104  -0.49708164 -0.5813308  -0.43003622]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [-0.01752997  0.0492635   0.02258018  0.6486475  -0.02395518]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.00973097 -0.09169187 -0.00089019  0.15246339  0.0276002 ]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.61841345 -0.20813861 -0.07823086  0.00838107  1.0748218 ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.61841345 -0.20813861 -0.07823086  0.00838107  1.0748218 ]
  [MambaBlock.__call__] res sample values: [-1.3976102   0.11282095 -1.937764   -3.0134592  -2.0913224 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [0.00626763 0.01399035 0.3395803  0.21708725 0.07050979]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [0.00314363 0.00704411 0.19834498 0.1202793  0.03649729]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-0.5419349  -0.6177259  -0.6083033  -0.55915374 -0.6504855 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [-0.01752997  0.0492635   0.02258018  0.6486475  -0.02395518]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.66030943 -0.19992994  0.12484757 -0.64552027  0.7492131 ]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.66030943 -0.19992994  0.12484757 -0.64552027  0.7492131 ]
  [MambaBlock.ssm] B sample values: [ 1.1625811  -0.09303413  0.03073789 -0.08881259 -0.23422542]
  [MambaBlock.ssm] C sample values: [ 1.3782659   0.32311556 -0.13715363  0.17284024  0.24774751]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.00993711 0.01136867 0.03038858 0.0040053  0.00230449]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.9946292  0.9938804  0.99397343 0.99445903 0.9935569 ]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 3.6317455e-05 -2.9062601e-06  9.6020995e-07 -2.7743849e-06
 -7.3168844e-06]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 3.6317455e-05 -2.9062601e-06  9.6020995e-07 -2.7743849e-06
 -7.3168844e-06]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [2.0411915e-05 5.2327174e-05 3.9384337e-03 3.1478776e-04 5.4957582e-05]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-3.9393152e-04  1.7042938e-04  8.9059031e-05  5.4460150e-05
  8.9397145e-05]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-4.3995460e-04  1.2551526e-04  6.8977270e-03  1.4219999e-04
  5.8364520e-05]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-2.3362631e-04  8.7370339e-05  1.1887881e-04  2.9804101e-05
  5.7357123e-05]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00072297 -0.00384376  0.02025567  0.00075406  0.00028748]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-2.5456760e-04  1.0793850e-04  1.2431116e-04  2.8252962e-05
  6.6214801e-05]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.00133761 -0.0059198   0.02059559  0.00075224  0.00017375]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [2.0411915e-05 5.2327174e-05 3.9384337e-03 3.1478776e-04 5.4957582e-05]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-3.4695920e-05  3.9934460e-04  8.4170988e-03  7.8333654e-02
 -8.1934134e-04]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-3.4695920e-05  3.9934460e-04  8.4170988e-03  7.8333654e-02
 -8.1934134e-04]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-3.4695920e-05  3.9934460e-04  8.4170988e-03  7.8333654e-02
 -8.1934134e-04]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 9.6107779e-06  2.3796645e-05 -2.0533707e-03 -1.1052467e-02
  1.8838827e-04]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.06723851  0.16590235 -0.03565926 -0.01154354  0.00952299]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-0.05221909  0.0211181  -0.03693615  0.24613905  0.05035517]
  [Mamba.__call__] After layer 33 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 33 sample values: [-0.05221909  0.0211181  -0.03693615  0.24613905  0.05035517]
[Mamba.__call__] Processing layer 34/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-0.05221909  0.0211181  -0.03693615  0.24613905  0.05035517]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-0.05221909  0.0211181  -0.03693615  0.24613905  0.05035517]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.4724063  0.47237653 0.5011337  0.43621188 0.49480385]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.0449244   0.01816803 -0.03177639  0.21175492  0.04332086]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.02122257  0.00858215 -0.01592422  0.09237001  0.02143533]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [-1.3503864  -0.46325144  4.3732467   1.0285494   1.2718582 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [ 0.31437653  0.41813472 -0.01216846 -0.06442426  0.05147223]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.02122257  0.00858215 -0.01592422  0.09237001  0.02143533]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.4364967   0.18568659 -1.7371335   0.10798725 -0.7396095 ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 0.4364967   0.18568659 -1.7371335   0.10798725 -0.7396095 ]
  [MambaBlock.__call__] res sample values: [-0.46114504 -0.3023708   0.32001263  0.08745289  0.5667164 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.06954125  0.0574294  -1.4407015   0.00857603  0.06057315]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.03356212  0.02953901 -0.27580318  0.0043064   0.03120357]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -0.2591401   -0.62923443 -79.300674    -2.7970057   -3.5674756 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [ 0.31437653  0.41813472 -0.01216846 -0.06442426  0.05147223]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.43988404  0.05000605  0.5263183  -0.10122848  0.35696018]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.43988404  0.05000605  0.5263183  -0.10122848  0.35696018]
  [MambaBlock.ssm] B sample values: [ 0.28257754 -0.2456204   0.02483144  0.5763091  -0.9678761 ]
  [MambaBlock.ssm] C sample values: [ 0.06726855 -0.42333078  0.34255478  0.37512186  0.42542142]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.195525   0.16811538 0.00198223 0.1490426  0.24696532]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [9.5059389e-01 8.8423622e-01 1.8456480e-07 5.7875007e-01 4.9781305e-01]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00185434  0.00161182 -0.00016295 -0.00378187  0.00635143]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00185434  0.00161182 -0.00016295 -0.00378187  0.00635143]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.0213969   0.01619207 -0.0017826   0.00209278  0.02512693]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00287182  0.00233257 -0.00168968 -0.00423539  0.00481741]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.01624503  0.02615413 -0.002885    0.00192688  0.03650462]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00726433  0.00733903 -0.0050389  -0.01228533  0.01006391]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.05153572  0.02268378 -0.0055714   0.01796465  0.01237634]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00942663  0.00831612 -0.00211813 -0.01600998  0.01182379]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.07969569 -0.03096943 -0.00662212  0.04039992 -0.05581936]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.0213969   0.01619207 -0.0017826   0.00209278  0.02512693]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.03194804  0.02854335  0.0015735   0.00181535  0.02673305]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.03194804  0.02854335  0.0015735   0.00181535  0.02673305]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.03194804  0.02854335  0.0015735   0.00181535  0.02673305]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 5.6973365e-03 -3.6678480e-03  2.9171491e-04  8.2847364e-05
  9.6658124e-03]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.09843011  0.02168916 -0.04206465 -0.00573049 -0.00983239]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.04621102  0.04280727 -0.07900079  0.24040857  0.04052278]
  [Mamba.__call__] After layer 34 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 34 sample values: [ 0.04621102  0.04280727 -0.07900079  0.24040857  0.04052278]
[Mamba.__call__] Processing layer 35/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.04621102  0.04280727 -0.07900079  0.24040857  0.04052278]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.04621102  0.04280727 -0.07900079  0.24040857  0.04052278]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.7449763  0.67232215 0.72174984 0.62909174 0.69769406]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.03833225  0.03550882 -0.06553151  0.19942     0.03361383]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.02855662  0.02387337 -0.04729736  0.12545347  0.02345217]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [2.5662735 3.0830925 2.397658  2.4909008 2.3730032]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [ 0.44721767  0.03814311  0.3916319  -0.02535834  0.19675636]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.02855662  0.02387337 -0.04729736  0.12545347  0.02345217]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 1.4112890e-03 -2.6169934e+00 -5.0621235e-01 -3.2422882e-01
 -1.6633449e+00]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 1.4112890e-03 -2.6169934e+00 -5.0621235e-01 -3.2422882e-01
 -1.6633449e+00]
  [MambaBlock.__call__] res sample values: [ 0.08043998 -2.8279223   0.64629966 -1.1995798  -0.39159662]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.05514718  0.21810293 -0.06978375 -0.00107383 -1.017709  ]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.02681348  0.12089677 -0.03367493 -0.00053663 -0.2701752 ]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-13.017225 -21.825794 -10.997392 -12.072145 -10.729568]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [ 0.44721767  0.03814311  0.3916319  -0.02535834  0.19675636]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.10144689 -0.11381939  0.00194745 -0.61278605 -0.0485414 ]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [ 0.10144689 -0.11381939  0.00194745 -0.61278605 -0.0485414 ]
  [MambaBlock.ssm] B sample values: [ 0.04104297  0.00017283  0.0953632  -0.04483943 -0.12670366]
  [MambaBlock.ssm] C sample values: [-0.10605049 -0.03841851  0.10235734  0.04777774  0.0039385 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [5.3789263e-04 3.3479985e-03 2.9260633e-03 2.4931373e-03 2.6018456e-06]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.99302256 0.9883287  0.99410206 0.99352753 0.9942453 ]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-5.9195338e-07 -2.4927174e-09 -1.3754018e-06  6.4670894e-07
  1.8274181e-06]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-5.9195338e-07 -2.4927174e-09 -1.3754018e-06  6.4670894e-07
  1.8274181e-06]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-1.1478070e-06  3.2212178e-05 -7.8417052e-06 -1.0647260e-07
 -5.5943172e-08]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-3.1594842e-05 -4.7529076e-05  1.8304505e-05  4.5017146e-05
 -4.6247173e-06]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 6.3166772e-05  3.0978024e-04  2.7513161e-04 -6.4308470e-06
 -3.0124090e-07]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 2.1484808e-05 -1.7114717e-05  6.2130981e-05 -1.8933939e-04
 -7.2403527e-05]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 5.1226714e-05 -3.6248225e-03  6.0941314e-04 -8.7301385e-05
 -3.3689257e-06]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 1.9513896e-05 -1.9175186e-05  6.1222847e-05 -2.1450171e-04
 -6.7179033e-05]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-8.9782727e-05 -5.6610783e-03 -1.0149868e-04 -4.9978378e-05
 -1.9855509e-06]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-1.1478070e-06  3.2212178e-05 -7.8417052e-06 -1.0647260e-07
 -5.5943172e-08]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-1.19926091e-02  4.64359066e-03 -1.31960185e-02  1.35014698e-05
 -5.31587452e-02]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-1.19926091e-02  4.64359066e-03 -1.31960185e-02  1.35014698e-05
 -5.31587452e-02]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-1.19926091e-02  4.64359066e-03 -1.31960185e-02  1.35014698e-05
 -5.31587452e-02]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-5.0173199e-04 -7.3319388e-04 -5.5962517e-03 -3.7502045e-06
  8.3960965e-03]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.01708284  0.08525755 -0.05698619  0.1855919  -0.04175177]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.06329386  0.12806481 -0.13598698  0.42600048 -0.00122899]
  [Mamba.__call__] After layer 35 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 35 sample values: [ 0.06329386  0.12806481 -0.13598698  0.42600048 -0.00122899]
[Mamba.__call__] Processing layer 36/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.06329386  0.12806481 -0.13598698  0.42600048 -0.00122899]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.06329386  0.12806481 -0.13598698  0.42600048 -0.00122899]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.68043476 0.65566045 0.68326676 0.615205   0.70576626]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.04973431  0.10062928 -0.10685427  0.33473772 -0.0009657 ]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.03384095  0.06597864 -0.07300998  0.20593232 -0.00068156]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [2.1693773 3.1153207 2.04726   6.2659035 3.3316631]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [ 0.13137002  0.48162147  0.05265328 -0.12746784  0.6428306 ]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.03384095  0.06597864 -0.07300998  0.20593232 -0.00068156]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.46994564  0.07160249 -0.96084064  0.17516261  3.3422844 ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 0.46994564  0.07160249 -0.96084064  0.17516261  3.3422844 ]
  [MambaBlock.__call__] res sample values: [0.74170136 0.22829552 2.4026117  1.2357118  5.5043635 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.60140735 -0.03232404 -0.01082457 -0.00789818 -0.26218125]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.2129113  -0.01590083 -0.00538299 -0.0039335  -0.11400364]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [  -8.752832   -22.540657    -7.7466464 -526.3169     -27.984846 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [ 0.13137002  0.48162147  0.05265328 -0.12746784  0.6428306 ]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.07529005  0.1310814   0.24400717 -2.6315427   0.23847394]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.07529005  0.1310814   0.24400717 -2.6315427   0.23847394]
  [MambaBlock.ssm] B sample values: [ 0.51016796  0.12646788  0.5266148  -0.0058341   0.45878318]
  [MambaBlock.ssm] C sample values: [ 0.7327734   0.04455093  0.29715118  0.20809564 -0.40494582]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.03836052 0.03653308 0.04725445 0.07647192 0.00143362]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [7.1479237e-01 4.2118996e-01 7.4292111e-01 1.7048466e-09 3.4180555e-01]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-4.1667395e-03 -1.0329123e-03 -4.3010674e-03  4.7649319e-05
 -3.7470602e-03]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-4.1667395e-03 -1.0329123e-03 -4.3010674e-03  4.7649319e-05
 -3.7470602e-03]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.03067302 -0.00218162 -0.0009553  -0.00112968 -0.0006138 ]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00430273 -0.000948   -0.00451425 -0.00038827 -0.00275902]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-4.4122089e-02  2.8440240e-03  1.3499839e-02  1.0494156e-03
 -9.0705056e-05]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-1.6461306e-03 -2.7391117e-03 -1.4478362e-03  4.2820987e-03
 -4.0186569e-07]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-2.6279632e-02  4.0114839e-03  2.3905223e-02  3.6479463e-03
  5.7009431e-05]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [0.00271597 0.00121647 0.00858881 0.00429207 0.00133245]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.06908293  0.029193    0.00834659 -0.00278983 -0.00138037]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.03067302 -0.00218162 -0.0009553  -0.00112968 -0.0006138 ]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.05864318 -0.0098398  -0.00123873 -0.00062828 -0.07389883]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.05864318 -0.0098398  -0.00123873 -0.00062828 -0.07389883]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.05864318 -0.0098398  -0.00123873 -0.00062828 -0.07389883]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.0294626  -0.00125085 -0.00272925 -0.00060155 -0.4051176 ]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.04432594 -0.2886571   0.09394451  0.02756467  0.11055019]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.1076198  -0.16059229 -0.04204247  0.45356515  0.1093212 ]
  [Mamba.__call__] After layer 36 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 36 sample values: [ 0.1076198  -0.16059229 -0.04204247  0.45356515  0.1093212 ]
[Mamba.__call__] Processing layer 37/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.1076198  -0.16059229 -0.04204247  0.45356515  0.1093212 ]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.1076198  -0.16059229 -0.04204247  0.45356515  0.1093212 ]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.6544265  0.65509623 0.66084313 0.6319571  0.671453  ]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.08305205 -0.12393184 -0.0324449   0.35002404  0.08436505]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.05435147 -0.08118728 -0.02144099  0.22120018  0.05664717]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [1.1601748 3.8720012 4.5475926 2.9371586 3.3854215]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [0.65061283 0.60638845 0.24510412 0.67646223 0.01502487]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.05435147 -0.08118728 -0.02144099  0.22120018  0.05664717]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.6374866  -0.73855853 -0.6914221  -0.91561615 -0.50186515]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.6374866  -0.73855853 -0.6914221  -0.91561615 -0.50186515]
  [MambaBlock.__call__] res sample values: [ 1.3353664  -1.109475    0.15593213  0.33798686 -0.23954003]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.13107859 -0.10708994 -0.04075653 -0.10110311  0.29777974]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.06125003 -0.05068064 -0.01996305 -0.04799827  0.17089568]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -3.1904912 -48.03842   -94.40486   -18.862175  -29.530437 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [0.65061283 0.60638845 0.24510412 0.67646223 0.01502487]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.9960421  -1.5511085   1.6034241   0.38986003  0.3286262 ]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [ 0.9960421  -1.5511085   1.6034241   0.38986003  0.3286262 ]
  [MambaBlock.ssm] B sample values: [-0.35827458  0.065507    0.02119367  0.6381289   0.05826244]
  [MambaBlock.ssm] C sample values: [-0.8006452  -0.02780229 -0.26708683  0.10014243  0.0856113 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.04607134 0.0346318  0.07311887 0.05551829 0.13657548]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.86330247 0.10935081 0.0129151  0.41936836 0.25653076]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 1.0110046e-03 -1.8485230e-04 -5.9805796e-05 -1.8007173e-03
 -1.6440908e-04]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 1.0110046e-03 -1.8485230e-04 -5.9805796e-05 -1.8007173e-03
 -1.6440908e-04]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.00721697 -0.00448885 -0.00373314 -0.00681521  0.05969274]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.0020428   0.00121848  0.00170157  0.0033146   0.00014421]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.01877531  0.0047895  -0.00054261 -0.01675225  0.10711751]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-2.0417219e-03  1.9451363e-05 -2.2344447e-04  1.6154922e-03
 -1.7826296e-05]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.0146048  -0.00664859  0.07503076 -0.05282317  0.14269339]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.0045925  -0.00052773 -0.00340942  0.00448434  0.00191152]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.04958544  0.03526918  0.12971254 -0.04404025  0.17351885]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.00721697 -0.00448885 -0.00373314 -0.00681521  0.05969274]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.04706703 -0.035221   -0.00862616 -0.03928423  0.06226043]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.04706703 -0.035221   -0.00862616 -0.03928423  0.06226043]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.04706703 -0.035221   -0.00862616 -0.03928423  0.06226043]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.0497614   0.00968983 -0.00072488 -0.00775013 -0.00656806]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.27221718 -0.1937445  -0.00746826  0.25645    -0.13055725]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.37983698 -0.3543368  -0.04951073  0.7100152  -0.02123605]
  [Mamba.__call__] After layer 37 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 37 sample values: [ 0.37983698 -0.3543368  -0.04951073  0.7100152  -0.02123605]
[Mamba.__call__] Processing layer 38/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.37983698 -0.3543368  -0.04951073  0.7100152  -0.02123605]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.37983698 -0.3543368  -0.04951073  0.7100152  -0.02123605]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.50148803 0.5115306  0.5203413  0.510155   0.5270247 ]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.27420533 -0.25579667 -0.03574193  0.51256186 -0.01533036]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.13751069 -0.13084781 -0.018598    0.261486   -0.00807948]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [0.8399748 5.6849966 1.2202642 4.892681  4.9834294]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [ 0.01576955  0.06638715  0.6559303  -0.01757643  0.6265791 ]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.13751069 -0.13084781 -0.018598    0.261486   -0.00807948]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.86154366  0.8531014  -0.4851818   0.39026064 -0.2922005 ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 0.86154366  0.8531014  -0.4851818   0.39026064 -0.2922005 ]
  [MambaBlock.__call__] res sample values: [ 0.99890393  0.44238538 -0.17180549  0.12103969 -0.7871776 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.19771041 -0.40174842  0.13168563 -0.07152559  0.06416563]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.10859585 -0.16105786  0.07017184 -0.03448436  0.03311177]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [  -2.3163087 -294.41684     -3.3880827 -133.31052   -145.97414  ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [ 0.01576955  0.06638715  0.6559303  -0.01757643  0.6265791 ]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.30928096  1.4074365   0.10501741  0.10133874  0.42333302]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.30928096  1.4074365   0.10501741  0.10133874  0.42333302]
  [MambaBlock.ssm] B sample values: [-0.8899624  -0.04855799  0.36717895 -0.56189084  0.577759  ]
  [MambaBlock.ssm] C sample values: [-0.32065502 -0.21538588  0.04019275 -0.6356291   0.34383678]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.19547158 0.02324744 0.13069032 0.10347437 0.22795735]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [6.3586277e-01 1.0146079e-25 5.1567739e-01 4.8191754e-12 4.0544290e-13]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.01889159 -0.00103076  0.00779426 -0.01192748  0.01226432]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.01889159 -0.00103076  0.00779426 -0.01192748  0.01226432]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.1084642  -0.01913139  0.04685931 -0.01823243  0.03856786]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.02614497 -0.00418539  0.01269392 -0.01299136  0.00489078]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.16001394 -0.00788189  0.00051786 -0.03530273  0.08644565]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.04377145 -0.02479723  0.01875341 -0.00228478  0.02659645]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.33400348  0.01405261  0.0014544  -0.22172718  0.07781771]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.03628189 -0.00334974  0.01369613  0.00393707  0.00530561]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.18573327  0.03948297  0.03423849 -0.22188985  0.05186151]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.1084642  -0.01913139  0.04685931 -0.01823243  0.03856786]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.11017671 -0.02982356  0.09288715 -0.01762632  0.05931501]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.11017671 -0.02982356  0.09288715 -0.01762632  0.05931501]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.11017671 -0.02982356  0.09288715 -0.01762632  0.05931501]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.08043362 -0.00803257 -0.0072955  -0.00113122 -0.01460392]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.2976294   0.17473972 -0.0561624  -0.31354672 -0.26252392]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [ 0.08220759 -0.17959708 -0.10567313  0.39646846 -0.28375998]
  [Mamba.__call__] After layer 38 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 38 sample values: [ 0.08220759 -0.17959708 -0.10567313  0.39646846 -0.28375998]
[Mamba.__call__] Processing layer 39/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [ 0.08220759 -0.17959708 -0.10567313  0.39646846 -0.28375998]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [ 0.08220759 -0.17959708 -0.10567313  0.39646846 -0.28375998]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.58749235 0.58549577 0.60443616 0.569657   0.6055181 ]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [ 0.05696606 -0.12445246 -0.07322659  0.2747343  -0.19663253]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [ 0.03346712 -0.0728664  -0.0442608   0.15650432 -0.11906456]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [-1.4461476  1.0257019 -1.0982873 -1.4376163 -1.6201029]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [-0.09614581  0.26684     0.36422756 -0.03821044  0.26229945]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [ 0.03346712 -0.0728664  -0.0442608   0.15650432 -0.11906456]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.30134693 -0.05666184 -1.1785346  -0.13907748 -1.3496957 ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.30134693 -0.05666184 -1.1785346  -0.13907748 -1.3496957 ]
  [MambaBlock.__call__] res sample values: [-0.83209014  0.26491588 -0.5251365  -1.6292024   0.52829087]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.00341815  0.00562734  0.2252778  -0.00549304 -0.01266001]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.001712    0.00282159  0.12527303 -0.00273898 -0.00628994]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-0.2354757  -2.7890525  -0.33344167 -0.23749319 -0.19787833]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [-0.09614581  0.26684     0.36422756 -0.03821044  0.26229945]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 1.1682116   1.4290698  -0.06146522 -0.55123985 -0.8326689 ]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [ 1.1682116   1.4290698  -0.06146522 -0.55123985 -0.8326689 ]
  [MambaBlock.ssm] B sample values: [ 0.34814706 -0.41911688 -0.32895076 -0.3170957   0.1417422 ]
  [MambaBlock.ssm] C sample values: [ 0.5875628  -0.11460043  0.21964279 -0.09145032 -0.08573537]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.07449462 0.07668595 0.07376315 0.12692755 0.2531932 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.9826113  0.8123944  0.9754664  0.9824636  0.98536724]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 4.4400782e-05 -5.3451888e-05 -4.1952590e-05 -4.0440660e-05
  1.8077029e-05]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 4.4400782e-05 -5.3451888e-05 -4.1952590e-05 -4.0440660e-05
  1.8077029e-05]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.00045744  0.00077609  0.0331436  -0.00124694 -0.00571217]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.0005557  -0.00033748 -0.00015925 -0.00022694  0.00044654]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.00415731  0.01761143  0.01130039 -0.01216918 -0.02412   ]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 2.2379330e-03 -1.2779732e-03 -5.8614824e-05 -1.3977039e-03
  7.0687127e-04]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.01468855  0.0052015  -0.00799107  0.05044704 -0.12194672]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00278825 -0.00184242 -0.00068877 -0.0021853   0.00016682]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.0164768   0.02031499 -0.0646119   0.00131286 -0.22153912]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.00045744  0.00077609  0.0331436  -0.00124694 -0.00571217]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.00029283  0.001529    0.07877149 -0.00114229 -0.00736201]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.00029283  0.001529    0.07877149 -0.00114229 -0.00736201]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.00029283  0.001529    0.07877149 -0.00114229 -0.00736201]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-7.3880015e-05  2.2919918e-04 -1.5373672e-02  3.0509412e-04
 -2.4466887e-03]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.1996125   0.18207654 -0.1080817   0.10911188 -0.14249842]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-0.11740491  0.00247946 -0.21375483  0.5055803  -0.4262584 ]
  [Mamba.__call__] After layer 39 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 39 sample values: [-0.11740491  0.00247946 -0.21375483  0.5055803  -0.4262584 ]
[Mamba.__call__] Processing layer 40/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-0.11740491  0.00247946 -0.21375483  0.5055803  -0.4262584 ]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-0.11740491  0.00247946 -0.21375483  0.5055803  -0.4262584 ]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1.0249335  1.0574079  1.055376   0.94339186 1.020864  ]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.06897103  0.00145659 -0.12557304  0.29700968 -0.25041097]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.07069071  0.00154021 -0.13252679  0.28019652 -0.25563556]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [6.191254  4.838026  3.2366917 5.510392  5.729919 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [ 0.00580568  0.33984903  0.00422589 -0.00131762  0.4827045 ]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.07069071  0.00154021 -0.13252679  0.28019652 -0.25563556]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-2.3549602  -0.1110017  -0.67930216 -1.2082713   1.328655  ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-2.3549602  -0.1110017  -0.67930216 -1.2082713   1.328655  ]
  [MambaBlock.__call__] res sample values: [-0.59608686  0.122821    1.5980177   0.9076834   0.55186164]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.34873244  0.04711628  0.00815576 -0.01890355  0.28353015]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.14426707  0.02411303  0.00409451 -0.00936244  0.16172884]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-488.4583   -126.219955  -25.449389 -247.24808  -307.9443  ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [ 0.00580568  0.33984903  0.00422589 -0.00131762  0.4827045 ]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.01223052  0.07415918  1.7671208  -1.0595492  -0.04825262]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.01223052  0.07415918  1.7671208  -1.0595492  -0.04825262]
  [MambaBlock.ssm] B sample values: [ 2.6311674  -0.31023252 -0.7307097   0.6900552   0.75859416]
  [MambaBlock.ssm] C sample values: [ 0.52247834  0.50265425 -0.20147394 -0.23528221  0.5462105 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.00399663 0.00099428 0.01039806 0.015149   0.0002336 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.14196321 0.60383487 0.90328985 0.37226135 0.29207653]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00151708  0.00017887  0.00042131 -0.00039787 -0.00043739]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00151708  0.00017887  0.00042131 -0.00039787 -0.00043739]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.00844666  0.00035122  0.0006237  -0.00207777  0.00055346]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00425879 -0.0010885  -0.00023745  0.00098064  0.00059576]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.0236261   0.0005874  -0.00017961 -0.00081304  0.00115352]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [7.5915712e-04 4.8730470e-04 4.3492031e-04 1.7896178e-05 5.1906263e-04]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.00832969  0.00037929 -0.0013123   0.0036393   0.0024328 ]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 2.6523629e-03  1.3311143e-03  6.5660424e-04 -1.0072843e-03
  4.5918721e-05]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 3.1325404e-02 -4.3905140e-05 -8.9616864e-04  2.8933990e-03
  5.9350529e-03]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.00844666  0.00035122  0.0006237  -0.00207777  0.00055346]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.00928423  0.00854601  0.00064101 -0.00206543  0.07862069]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.00928423  0.00854601  0.00064101 -0.00206543  0.07862069]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.00928423  0.00854601  0.00064101 -0.00206543  0.07862069]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.00196597  0.000557    0.00085199 -0.00133581  0.02753245]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.12597634 -0.1694043   0.05318808  0.29406047 -0.20086603]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-0.24338125 -0.16692483 -0.16056675  0.7996408  -0.6271244 ]
  [Mamba.__call__] After layer 40 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 40 sample values: [-0.24338125 -0.16692483 -0.16056675  0.7996408  -0.6271244 ]
[Mamba.__call__] Processing layer 41/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-0.24338125 -0.16692483 -0.16056675  0.7996408  -0.6271244 ]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-0.24338125 -0.16692483 -0.16056675  0.7996408  -0.6271244 ]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.50048447 0.4962308  0.4965104  0.5155055  0.5010027 ]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.15129252 -0.1037651  -0.09981274  0.49707884 -0.38983792]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.07571956 -0.05149144 -0.04955806  0.25624686 -0.19530986]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [2.2389708  1.1715897  2.6289642  0.49206823 2.4480925 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [ 0.1750245   0.5295275   0.20840378 -0.04905228  0.30306923]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.07571956 -0.05149144 -0.04955806  0.25624686 -0.19530986]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.9636626  -0.67667264 -0.40314478  0.03913343  0.01824844]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.9636626  -0.67667264 -0.40314478  0.03913343  0.01824844]
  [MambaBlock.__call__] res sample values: [-1.5276     -0.37223262 -1.6422622   1.619821   -1.3711336 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.14356914 -0.0956071   0.06320661 -0.00932692 -0.01681243]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.06664038 -0.04552012  0.03260174 -0.00464171 -0.00833555]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -9.383668   -3.2271187 -13.859406   -1.6356957 -11.566262 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [ 0.1750245   0.5295275   0.20840378 -0.04905228  0.30306923]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.19157237  0.5079535  -0.58647025 -0.09727174  0.0846623 ]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.19157237  0.5079535  -0.58647025 -0.09727174  0.0846623 ]
  [MambaBlock.ssm] B sample values: [-0.01024386 -0.7400058   0.03084806 -0.60238886 -0.22054726]
  [MambaBlock.ssm] C sample values: [-0.2052882  -0.18247595 -0.2707383  -0.35856465 -0.00328763]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.28413522 0.20152818 0.298049   0.02340633 0.3457603 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.06951375 0.3997411  0.01948821 0.62828666 0.03738886]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00019397  0.01401192 -0.0005841   0.01140616  0.00417604]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00019397  0.01401192 -0.0005841   0.01140616  0.00417604]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.1397289  -0.06769597  0.07170544 -0.00080174 -0.02126832]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [0.00740447 0.01809807 0.00476051 0.01962008 0.00855406]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.12541726 -0.08058101  0.06457677 -0.00279563  0.1946596 ]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [0.02323485 0.02161705 0.02961768 0.0273976  0.00133264]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.16975011 -0.04343751 -0.06928501  0.03997637  0.2029646 ]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00407683  0.02591369 -0.02026272  0.03671633  0.00084482]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.24667875 -0.04993459  0.06164931  0.02516608  0.11914781]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.1397289  -0.06769597  0.07170544 -0.00080174 -0.02126832]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.15139261 -0.09180012  0.07849976 -0.00057406 -0.02379457]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.15139261 -0.09180012  0.07849976 -0.00057406 -0.02379457]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.15139261 -0.09180012  0.07849976 -0.00057406 -0.02379457]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.0412454   0.01394183 -0.02090489 -0.00077623  0.00660461]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-1.0576313   0.7053011  -0.03959503 -1.3184401  -0.19913012]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-1.3010125   0.5383763  -0.20016178 -0.5187993  -0.82625455]
  [Mamba.__call__] After layer 41 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 41 sample values: [-1.3010125   0.5383763  -0.20016178 -0.5187993  -0.82625455]
[Mamba.__call__] Processing layer 42/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-1.3010125   0.5383763  -0.20016178 -0.5187993  -0.82625455]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-1.3010125   0.5383763  -0.20016178 -0.5187993  -0.82625455]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.38568634 0.39310682 0.37949622 0.38060984 0.3885988 ]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.7323232   0.30304506 -0.11266849 -0.29202545 -0.46508804]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.28244707  0.11912908 -0.04275727 -0.11114776 -0.18073265]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [-1.4815505  1.2722621  2.5834713  3.2302687  1.2069336]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [0.08497319 0.12673959 0.2582316  0.17190656 0.15722927]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.28244707  0.11912908 -0.04275727 -0.11114776 -0.18073265]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.5651348   0.12831852 -0.31990516 -0.12811123  0.25324976]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 0.5651348   0.12831852 -0.31990516 -0.12811123  0.25324976]
  [MambaBlock.__call__] res sample values: [ 0.25460917  1.8988802  -0.5797483  -0.7759604  -0.16841063]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.08503261 -0.01900196  0.03608011 -0.008477   -0.02367092]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.04070976 -0.00941071  0.01836547 -0.00422054 -0.01169539]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -0.22728501  -3.5689168  -13.243029   -25.286451    -3.3432174 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [0.08497319 0.12673959 0.2582316  0.17190656 0.15722927]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.2656156 -1.0362494 -0.6145575  0.3322033 -1.0776877]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.2656156 -1.0362494 -0.6145575  0.3322033 -1.0776877]
  [MambaBlock.ssm] B sample values: [ 0.4728626   0.21185121  0.89418685 -0.3396387  -0.8055239 ]
  [MambaBlock.ssm] C sample values: [ 0.03782932 -0.17828166  0.20196134  0.7368645  -0.3219226 ]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.36691085 0.23630166 0.38957918 0.4141017  0.34449828]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [9.1998923e-01 2.6996195e-01 7.7581555e-03 9.3469716e-05 2.9326966e-01]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00706308 -0.00316439 -0.01335634  0.00507313  0.01203199]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00706308 -0.00316439 -0.01335634  0.00507313  0.01203199]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.1646471  -0.02451232  0.07886653 -0.01926503 -0.04441163]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00369508 -0.00054244  0.00244385  0.00172732  0.00324123]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.04903396  0.22276673 -0.23014736 -0.17512636 -0.19393913]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-1.9653626e-03 -1.3074928e-03  1.1407413e-03 -4.2056426e-04
 -6.0983468e-05]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.04357343  0.3452789  -0.39105144 -0.19396359 -0.36949277]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00581039  0.0050993   0.00307525  0.00383554 -0.00483784]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.23101434  0.39056706  0.3410423  -0.13531072 -0.10364722]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.1646471  -0.02451232  0.07886653 -0.01926503 -0.04441163]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.16810635 -0.02570503  0.08360907 -0.01999057 -0.04625048]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.16810635 -0.02570503  0.08360907 -0.01999057 -0.04625048]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.16810635 -0.02570503  0.08360907 -0.01999057 -0.04625048]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.02411049 -0.04245389 -0.01740107  0.00488921  0.00356737]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-1.0912313   0.8412569  -0.12459734 -0.55559856 -0.98201907]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-2.3922439   1.3796332  -0.32475913 -1.0743978  -1.8082736 ]
  [Mamba.__call__] After layer 42 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 42 sample values: [-2.3922439   1.3796332  -0.32475913 -1.0743978  -1.8082736 ]
[Mamba.__call__] Processing layer 43/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-2.3922439   1.3796332  -0.32475913 -1.0743978  -1.8082736 ]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-2.3922439   1.3796332  -0.32475913 -1.0743978  -1.8082736 ]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.4137344  0.4105133  0.40054366 0.41257864 0.40384334]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.1526542   0.66474825 -0.1564786  -0.5176768  -0.8712799 ]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.47689268  0.272888   -0.06267651 -0.21358238 -0.35186058]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [2.5089414 1.7358968 1.926647  1.6314837 3.226074 ]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [0.3250829  0.2500583  0.19560507 0.20039935 0.20568517]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.47689268  0.272888   -0.06267651 -0.21358238 -0.35186058]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.2407966  -0.74708134 -0.5625633  -1.0351744  -0.45990098]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.2407966  -0.74708134 -0.5625633  -1.0351744  -0.45990098]
  [MambaBlock.__call__] res sample values: [ 0.40129507 -0.58034956 -1.0107449   0.07698898 -0.06789673]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.0085466   0.10783716 -0.10178717 -0.14111735 -0.1604948 ]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.00429156  0.05682298 -0.04830567 -0.06558839 -0.07382154]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-12.291911  -5.674014  -6.866448  -5.111453 -25.180603]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [0.3250829  0.2500583  0.19560507 0.20039935 0.20568517]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.39446408  0.1235611   0.09487909  0.26553863 -0.14277625]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.39446408  0.1235611   0.09487909  0.26553863 -0.14277625]
  [MambaBlock.ssm] B sample values: [-0.32609457 -0.46645632 -0.5869178  -0.82421553  0.4277772 ]
  [MambaBlock.ssm] C sample values: [-0.0138372   0.18011184 -0.52494454 -0.83955324  0.29641595]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.20035416 0.1816577  0.34323874 0.28261238 0.2642751 ]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.08520157 0.32084012 0.25265723 0.3591192  0.00644121]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00028039 -0.00040107 -0.00050465 -0.00070869  0.00036782]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00028039 -0.00040107 -0.00050465 -0.00070869  0.00036782]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.00872067  0.10469214 -0.16816306 -0.18799852 -0.19786802]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 0.00089171 -0.00024511  0.01540549  0.01715824 -0.00932776]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.19191055 -0.03409234 -0.2340139  -0.24412899 -0.6051563 ]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00123438  0.00081237  0.00258066  0.00590851 -0.00080082]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-0.04801969 -0.09893418 -0.03642045 -0.1291992  -0.4353678 ]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00634616  0.00334    -0.00326873  0.01510532 -0.00030362]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-0.3038562  -0.09393308 -0.22808458 -0.16808362  0.00430263]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.00872067  0.10469214 -0.16816306 -0.18799852 -0.19786802]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.01011578  0.11890119 -0.17761189 -0.20114239 -0.21305202]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.01011578  0.11890119 -0.17761189 -0.20114239 -0.21305202]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.01011578  0.11890119 -0.17761189 -0.20114239 -0.21305202]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.00243158 -0.02476233  0.04790214 -0.00804078  0.00698732]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.10000882 -0.27741218 -0.26819283  0.02008378 -0.00347938]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-2.4922526   1.102221   -0.59295195 -1.054314   -1.8117529 ]
  [Mamba.__call__] After layer 43 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 43 sample values: [-2.4922526   1.102221   -0.59295195 -1.054314   -1.8117529 ]
[Mamba.__call__] Processing layer 44/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-2.4922526   1.102221   -0.59295195 -1.054314   -1.8117529 ]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-2.4922526   1.102221   -0.59295195 -1.054314   -1.8117529 ]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.35207003 0.35643855 0.3484054  0.3594015  0.3439318 ]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.1564938   0.5114697  -0.27515078 -0.4892392  -0.84071773]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.4071668   0.18230753 -0.09586401 -0.1758333  -0.28914955]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [-1.7338896   3.0818956   0.46272665  0.9369668   0.36063412]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [0.13937044 0.2764371  0.20184581 0.13103132 0.11352272]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.4071668   0.18230753 -0.09586401 -0.1758333  -0.28914955]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [0.15275294 0.3265049  0.27575344 0.32525256 0.37254035]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [0.15275294 0.3265049  0.27575344 0.32525256 0.37254035]
  [MambaBlock.__call__] res sample values: [-1.0730194   0.66094804 -0.6623165  -0.36365268  1.9862733 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [ 0.01356181 -0.06176976 -0.1635347   0.04130024 -0.06265799]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [ 0.00682689 -0.02993131 -0.07509632  0.02107649 -0.03034781]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -0.1765962 -21.799686   -1.588399   -2.5522282  -1.4342387]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [0.13937044 0.2764371  0.20184581 0.13103132 0.11352272]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [0.42904642 0.14796874 0.6488298  0.12290336 0.09190892]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [0.42904642 0.14796874 0.6488298  0.12290336 0.09190892]
  [MambaBlock.ssm] B sample values: [ 0.34160668 -0.6300416   0.5218642   0.41198143  1.9775527 ]
  [MambaBlock.ssm] C sample values: [ 0.14445584 -0.5111045  -0.13358429  0.5556791   0.37972823]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.2502215  0.13378225 0.43507525 0.33296865 0.24029996]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.95677394 0.00427595 0.67203045 0.52801937 0.69846004]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.00058354 -0.00107626  0.00089147  0.00070376  0.00337812]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.00058354 -0.00107626  0.00089147  0.00070376  0.00337812]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [ 0.0271892  -0.06373435 -0.5200347   0.11169939 -0.11607277]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00591104  0.02101145 -0.00692899  0.00572328 -0.02272856]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.22252126  0.03999691 -0.41346478 -0.3203547   0.24070579]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-5.1157405e-03 -5.2289106e-05 -5.2936776e-03  2.7682022e-03
 -1.4274542e-02]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.00385394  0.2531464  -0.52221596 -0.30936345 -0.5111768 ]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00189669 -0.00106326 -0.00350104  0.00072     0.00316579]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.27668092 -0.04676808 -0.5343156  -0.01188905  0.4230037 ]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [ 0.0271892  -0.06373435 -0.5200347   0.11169939 -0.11607277]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [ 0.02814067 -0.07200847 -0.53519255  0.11446107 -0.11951793]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [ 0.02814067 -0.07200847 -0.53519255  0.11446107 -0.11951793]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [ 0.02814067 -0.07200847 -0.53519255  0.11446107 -0.11951793]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [-0.00769469 -0.03138688  0.12059651 -0.01706902 -0.20875312]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.59371287 -0.44274637  0.06382996  0.38451976 -0.32695448]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-3.0859654   0.6594746  -0.529122   -0.66979426 -2.1387074 ]
  [Mamba.__call__] After layer 44 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 44 sample values: [-3.0859654   0.6594746  -0.529122   -0.66979426 -2.1387074 ]
[Mamba.__call__] Processing layer 45/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-3.0859654   0.6594746  -0.529122   -0.66979426 -2.1387074 ]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-3.0859654   0.6594746  -0.529122   -0.66979426 -2.1387074 ]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.31206328 0.305705   0.30647868 0.31787744 0.2972424 ]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.3240991   0.2829616  -0.22703104 -0.28738946 -0.91765785]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.4132027   0.08650278 -0.06958017 -0.09135462 -0.27276683]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [1.1483651  1.4052331  1.5991377  2.124964   0.68480134]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [-0.03224894  0.23656093  0.11088458  0.18170418  0.11601169]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.4132027   0.08650278 -0.06958017 -0.09135462 -0.27276683]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 1.0385792  -0.01818761  0.35322416 -0.01993889  0.3072915 ]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 1.0385792  -0.01818761  0.35322416 -0.01993889  0.3072915 ]
  [MambaBlock.__call__] res sample values: [-0.21923941 -1.0831156   0.38535643 -0.2616055  -1.126468  ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.13308746  0.00401401  0.05959616 -0.00779963  0.07061985]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.06212218  0.00201103  0.03068575 -0.0038846   0.0365562 ]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-3.153034  -4.076477  -4.948763  -8.372596  -1.9833778]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [-0.03224894  0.23656093  0.11088458  0.18170418  0.11601169]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.49592593 -0.2586515  -0.54727834 -0.02992533  0.15505074]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.49592593 -0.2586515  -0.54727834 -0.02992533  0.15505074]
  [MambaBlock.ssm] B sample values: [-0.45495978 -0.83461016 -0.31701863  1.2079309  -0.29903498]
  [MambaBlock.ssm] C sample values: [-0.14683348 -0.14310141 -0.10836555  0.08739404 -0.25744918]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.15163577 0.19833604 0.1408285  0.19692297 0.31917194]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.6199523  0.5389461  0.47217318 0.2809482  0.74026203]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [ 0.0042857   0.00786198  0.0029863  -0.01137864  0.00281689]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [ 0.0042857   0.00786198  0.0029863  -0.01137864  0.00281689]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.24424203  0.01034172  0.11204675 -0.01983422  0.30252254]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00313902 -0.00352264  0.00104225  0.01435345 -0.00308394]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.29581845 -0.16686615  0.22539796  0.2919446  -0.0235093 ]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00210257 -0.00206994  0.00095938  0.00421814 -0.002209  ]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.01740622 -0.7211381   0.2520213   0.11456375 -0.05896829]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.00237438 -0.00429948  0.00220967  0.00416531 -0.00316107]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.14712958 -0.27068332  0.12739334  0.6812393   0.04477461]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.24424203  0.01034172  0.11204675 -0.01983422  0.30252254]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.24223866  0.01081745  0.11544932 -0.02054007  0.3067635 ]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.24223866  0.01081745  0.11544932 -0.02054007  0.3067635 ]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.24223866  0.01081745  0.11544932 -0.02054007  0.3067635 ]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.02365488 -0.00296331  0.02647835  0.00233726 -0.08459758]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.09199286 -0.11427226  0.05845296 -0.16551258  0.11642751]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-3.1779583   0.5452024  -0.47066903 -0.8353068  -2.02228   ]
  [Mamba.__call__] After layer 45 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 45 sample values: [-3.1779583   0.5452024  -0.47066903 -0.8353068  -2.02228   ]
[Mamba.__call__] Processing layer 46/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-3.1779583   0.5452024  -0.47066903 -0.8353068  -2.02228   ]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-3.1779583   0.5452024  -0.47066903 -0.8353068  -2.02228   ]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.33802006 0.3301879  0.32714143 0.34388876 0.3157206 ]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.243791    0.21338159 -0.18421069 -0.3269228  -0.79148096]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.4204263   0.07045601 -0.06026295 -0.11242507 -0.24988684]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [-1.6185882   0.64170766  1.2986443   4.4494786   0.28863698]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [ 0.16108052 -0.06656054  0.17861699  0.06253728 -0.00319874]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.4204263   0.07045601 -0.06026295 -0.11242507 -0.24988684]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 0.76035714  1.1247088  -1.4182997  -0.8429493   0.34077018]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 0.76035714  1.1247088  -1.4182997  -0.8429493   0.34077018]
  [MambaBlock.__call__] res sample values: [-1.3964336   0.9899545   0.5374321   0.77388424 -0.49651337]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.10054158 -0.1726899  -0.12223856 -0.13936326 -0.0534151 ]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.04774576 -0.07890797 -0.05738837 -0.06483395 -0.02599443]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -0.19817829  -1.8997222   -3.6643257  -85.58231     -1.3346071 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [ 0.16108052 -0.06656054  0.17861699  0.06253728 -0.00319874]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.0712944  -1.0096486   0.35992643  0.13055652 -0.00760937]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [ 0.0712944  -1.0096486   0.35992643  0.13055652 -0.00760937]
  [MambaBlock.ssm] B sample values: [ 0.3398888  -0.9267819  -0.01172132  1.5208744  -0.20638074]
  [MambaBlock.ssm] C sample values: [ 0.306739    0.08613195 -0.37560427 -0.25760874  0.29278257]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.12063147 0.16864869 0.1743776  0.19181705 0.18993188]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [9.7637695e-01 7.9519629e-01 6.4272845e-01 3.2838128e-05 8.5129583e-01]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-1.9576380e-03  5.3379317e-03  6.7510613e-05 -8.7596923e-03
  1.1886791e-03]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-1.9576380e-03  5.3379317e-03  6.7510613e-05 -8.7596923e-03
  1.1886791e-03]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.19561975 -0.45198187 -0.33988482 -0.42238343 -0.16768545]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [ 1.2455668e-03 -2.8579526e-03  1.5592688e-03  1.2260850e-02
 -4.3599633e-05]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [ 0.23170774  0.39780158  0.53606886 -0.9308293   0.05891655]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00208389 -0.01103991  0.00021886  0.00959495 -0.00895881]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.40731564 -0.29624337  3.037342    0.15133774 -0.17989585]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00657268 -0.02480598  0.00214228  0.0180476  -0.01627746]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.69114196 -0.21220462  3.325648   -0.14554833 -0.37483728]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.19561975 -0.45198187 -0.33988482 -0.42238343 -0.16768545]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.20331065 -0.44672972 -0.35013536 -0.42643797 -0.1676023 ]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.20331065 -0.44672972 -0.35013536 -0.42643797 -0.1676023 ]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.20331065 -0.44672972 -0.35013536 -0.42643797 -0.1676023 ]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.05632278 -0.3224294  -0.1187782  -0.2258483   0.03148593]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [-0.7656817  -0.25138044 -0.34993422 -1.2168095  -0.14047214]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-3.94364     0.29382193 -0.82060325 -2.0521164  -2.1627522 ]
  [Mamba.__call__] After layer 46 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 46 sample values: [-3.94364     0.29382193 -0.82060325 -2.0521164  -2.1627522 ]
[Mamba.__call__] Processing layer 47/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-3.94364     0.29382193 -0.82060325 -2.0521164  -2.1627522 ]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-3.94364     0.29382193 -0.82060325 -2.0521164  -2.1627522 ]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.31774536 0.32020447 0.31943995 0.35066956 0.31373206]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-1.2656269   0.09429586 -0.26335505 -0.65858287 -0.69408906]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.40214708  0.03019395 -0.08412612 -0.23094496 -0.21775798]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [-1.2983547  -0.46613044  0.1502482   1.876432    0.69761956]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [-0.02475929  0.17518342 -0.18549797 -0.0410612   0.15625925]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.40214708  0.03019395 -0.08412612 -0.23094496 -0.21775798]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [-0.09171981  0.5153319  -0.88597834  0.23953766  0.21455985]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [-0.09171981  0.5153319  -0.88597834  0.23953766  0.21455985]
  [MambaBlock.__call__] res sample values: [-0.9086503  -0.5032818   0.8553021  -0.37188992  0.6838752 ]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.00632542 -0.06787152 -0.03800969  0.05131502  0.04439744]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.0031527  -0.03278457 -0.0186437   0.02631567  0.02269142]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [-0.27298054 -0.62742543 -1.1621226  -6.5301633  -2.0089648 ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [-0.02475929  0.17518342 -0.18549797 -0.0410612   0.15625925]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [ 0.81831235 -0.05151906 -0.1910733   0.07212231 -0.3072093 ]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [ 0.81831235 -0.05151906 -0.1910733   0.07212231 -0.3072093 ]
  [MambaBlock.ssm] B sample values: [ 0.45813066  0.8544016  -0.38550067 -1.4318652  -1.5965796 ]
  [MambaBlock.ssm] C sample values: [ 0.23318264  0.2346009  -0.10704131 -0.03105282  0.11993808]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.14205709 0.18815573 0.13903353 0.11972588 0.07413653]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [0.9619635  0.91472644 0.8478193  0.39547962 0.75172275]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00020518 -0.00038266  0.00017265  0.00064128  0.00071505]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00020518 -0.00038266  0.00017265  0.00064128  0.00071505]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-0.02524196 -0.3476672  -0.14609271  0.17757396  0.09481362]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.00045734 -0.00059613  0.00052077  0.00080027  0.00150091]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-0.03259287 -0.17152624 -2.0777826  -0.22302467 -0.30955   ]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [ 0.00032668  0.00450998 -0.00094987 -0.00692181 -0.01256058]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [ 0.5296594  -0.5564945  -2.4318333   0.09425069 -0.59737426]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [ 0.00051194  0.00441977 -0.00110717 -0.00292697 -0.00991204]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [ 0.05561303  0.00415323 -2.7044706  -0.18312243 -0.72894126]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-0.02524196 -0.3476672  -0.14609271  0.17757396  0.09481362]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-0.0251639  -0.3534105  -0.14263435  0.1764934   0.09835937]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-0.0251639  -0.3534105  -0.14263435  0.1764934   0.09835937]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-0.0251639  -0.3534105  -0.14263435  0.1764934   0.09835937]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.00656862  0.06701417 -0.08560155 -0.02678508  0.04470488]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 1.1435628  -0.99693274 -0.11632757 -0.19346039  0.30773678]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-2.8000772  -0.7031108  -0.93693084 -2.2455769  -1.8550154 ]
  [Mamba.__call__] After layer 47 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 47 sample values: [-2.8000772  -0.7031108  -0.93693084 -2.2455769  -1.8550154 ]
[Mamba.__call__] Processing layer 48/48
[ResidualBlock] Initializing ResidualBlock.
[ResidualBlock.__call__] Input shape: (1, 4, 1024)
[ResidualBlock.__call__] Input sample values: [-2.8000772  -0.7031108  -0.93693084 -2.2455769  -1.8550154 ]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-2.8000772  -0.7031108  -0.93693084 -2.2455769  -1.8550154 ]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [0.34748563 0.32442164 0.32341787 0.38163522 0.31534055]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.7152332  -0.17959797 -0.2393234  -0.5735953  -0.47383285]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.24853326 -0.05826547 -0.07740147 -0.21890417 -0.14941871]
[MambaBlock] Initializing MambaBlock.
  [MambaBlock] Initialized in_proj with input_dim=1024, output_dim=4096
  [MambaBlock] Initialized conv1d with features=2048, kernel_size=4
  [MambaBlock] Initialized x_proj with output_dim=96
  [MambaBlock] Initialized dt_proj with output_dim=2048
  [MambaBlock] Initialized A_log with shape: (2048, 16)
  [MambaBlock] A_log sample values: [4.486591  1.0215104 3.89516   1.4110713 4.7620087]
  [MambaBlock] Initialized D with shape: (2048,)
  [MambaBlock] D sample values: [0.14556068 0.03683821 0.04787075 0.08235173 0.04368893]
  [MambaBlock] Initialized out_proj with output_dim=1024
[MambaBlock.__call__] Input shape: (1, 4, 1024)
[MambaBlock.__call__] Input sample values: [-0.24853326 -0.05826547 -0.07740147 -0.21890417 -0.14941871]
  [MambaBlock.__call__] Batch size: 1, Sequence length: 4, d_model: 1024
  [MambaBlock.__call__] in_proj output shape: (1, 4, 4096)
  [MambaBlock.__call__] in_proj output sample values: [ 2.0671144e-02 -8.9279425e-01 -4.1607729e-01  8.7750381e-01
  4.5308471e-04]
  [MambaBlock.__call__] Split into x shape: (1, 4, 2048), res shape: (1, 4, 2048)
  [MambaBlock.__call__] x sample values: [ 2.0671144e-02 -8.9279425e-01 -4.1607729e-01  8.7750381e-01
  4.5308471e-04]
  [MambaBlock.__call__] res sample values: [-0.77824485 -0.16463542 -1.0303917  -0.27841404  0.76898384]
  [MambaBlock.__call__] After conv1d shape: (1, 4, 2048)
  [MambaBlock.__call__] After conv1d sample values: [-0.17284645 -0.12442415 -0.05308962 -0.16805267 -0.01430892]
  [MambaBlock.__call__] After SiLU activation shape: (1, 4, 2048)
  [MambaBlock.__call__] After SiLU activation sample values: [-0.07897279 -0.05834672 -0.02584035 -0.07698248 -0.00710328]
[MambaBlock.ssm] Starting SSM computation.
  [MambaBlock.ssm] d_in: 2048, n: 16
  [MambaBlock.ssm] A shape: (2048, 16)
  [MambaBlock.ssm] A sample values: [ -88.81813     -2.7773864  -49.163918    -4.1003456 -116.98067  ]
  [MambaBlock.ssm] D shape: (2048,)
  [MambaBlock.ssm] D sample values: [0.14556068 0.03683821 0.04787075 0.08235173 0.04368893]
  [MambaBlock.ssm] x_proj output shape: (1, 4, 96)
  [MambaBlock.ssm] x_proj output sample values: [-0.1240022  -1.4344034   1.0760274  -1.1790699  -0.17005934]
  [MambaBlock.ssm] Split into delta shape: (1, 4, 64), B shape: (1, 4, 16), C shape: (1, 4, 16)
  [MambaBlock.ssm] delta sample values: [-0.1240022  -1.4344034   1.0760274  -1.1790699  -0.17005934]
  [MambaBlock.ssm] B sample values: [ 0.33318454 -1.6683235   0.55848175  2.093308   -2.139761  ]
  [MambaBlock.ssm] C sample values: [ 0.30774093  0.10932346 -0.34884343  0.2683971   0.02852076]
  [MambaBlock.ssm] delta after softplus shape: (1, 4, 2048)
  [MambaBlock.ssm] delta after softplus sample values: [0.27109578 0.11033002 0.08850417 0.06436031 0.09682687]
[MambaBlock.selective_scan] Starting selective_scan computation.
  [MambaBlock.selective_scan] b: 1, l: 4, d_in: 2048, n: 16
[MambaBlock.selective_scan] Discretizing A and B.
  [MambaBlock.selective_scan] deltaA shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaA sample values: [3.4910956e-11 4.7098091e-01 1.6280449e-06 3.2903653e-01 1.6874631e-14]
  [MambaBlock.selective_scan] deltaB_u shape: (1, 4, 2048, 16)
  [MambaBlock.selective_scan] deltaB_u sample values: [-0.00713321  0.03571746 -0.01195664 -0.04481603  0.04581055]
[MambaBlock.selective_scan] Initializing state and preparing for scan.
  [MambaBlock.selective_scan] Initial x shape: (1, 2048, 16)
  [MambaBlock.selective_scan] Initial x sample values: [0. 0. 0. 0. 0.]
  [MambaBlock.selective_scan] Step 1/4:
    [Step 1] x shape: (1, 2048, 16)
    [Step 1] x sample values: [-0.00713321  0.03571746 -0.01195664 -0.04481603  0.04581055]
    [Step 1] y shape: (1, 2048)
    [Step 1] y sample values: [-2.5600028  -0.7697511  -0.27346528 -0.5924479  -0.0822422 ]
  [MambaBlock.selective_scan] Step 2/4:
    [Step 2] x shape: (1, 2048, 16)
    [Step 2] x sample values: [-0.0050669   0.02887265 -0.00668786 -0.0336326   0.03365402]
    [Step 2] y shape: (1, 2048)
    [Step 2] y sample values: [-1.2616632  -0.50088954 -0.24810372 -0.46987927 -0.8545588 ]
  [MambaBlock.selective_scan] Step 3/4:
    [Step 3] x shape: (1, 2048, 16)
    [Step 3] x sample values: [-0.00620425  0.1300467   0.01462177 -0.15699568  0.27494025]
    [Step 3] y shape: (1, 2048)
    [Step 3] y sample values: [-11.312058    -0.25788316   0.5069621    0.6359436   -0.04388649]
  [MambaBlock.selective_scan] Step 4/4:
    [Step 4] x shape: (1, 2048, 16)
    [Step 4] x sample values: [-0.01091452  0.04275679  0.00677611 -0.03788757  0.03223602]
    [Step 4] y shape: (1, 2048)
    [Step 4] y sample values: [-2.0180707   0.02662592  0.2774054   0.0782848  -0.8830602 ]
  [MambaBlock.selective_scan] Stacked y shape: (1, 4, 2048)
  [MambaBlock.selective_scan] Stacked y sample values: [-2.5600028  -0.7697511  -0.27346528 -0.5924479  -0.0822422 ]
  [MambaBlock.selective_scan] After adding D * u shape: (1, 4, 2048)
  [MambaBlock.selective_scan] After adding D * u sample values: [-2.5714982  -0.7719005  -0.27470228 -0.59878755 -0.08255253]
  [MambaBlock.ssm] selective_scan output shape: (1, 4, 2048)
  [MambaBlock.ssm] selective_scan output sample values: [-2.5714982  -0.7719005  -0.27470228 -0.59878755 -0.08255253]
  [MambaBlock.__call__] After SSM shape: (1, 4, 2048)
  [MambaBlock.__call__] After SSM sample values: [-2.5714982  -0.7719005  -0.27470228 -0.59878755 -0.08255253]
  [MambaBlock.__call__] After multiplying with SiLU(res) shape: (1, 4, 2048)
  [MambaBlock.__call__] After multiplying with SiLU(res) sample values: [ 0.62979156  0.05832231  0.07444471  0.07182615 -0.04337702]
  [MambaBlock.__call__] After out_proj shape: (1, 4, 1024)
  [MambaBlock.__call__] After out_proj sample values: [ 0.23993707  1.1095781   4.6457934  -4.2106433   1.4547    ]
[ResidualBlock.__call__] Output shape: (1, 4, 1024)
[ResidualBlock.__call__] Output sample values: [-2.5601401   0.40646732  3.7088625  -6.45622    -0.4003154 ]
  [Mamba.__call__] After layer 48 shape: (1, 4, 1024)
  [Mamba.__call__] After layer 48 sample values: [-2.5601401   0.40646732  3.7088625  -6.45622    -0.4003154 ]
[RMSNorm.__call__] Input shape: (1, 4, 1024)
[RMSNorm.__call__] Input sample values: [-2.5601401   0.40646732  3.7088625  -6.45622    -0.4003154 ]
  [RMSNorm.__call__] weight shape: (1024,)
  [RMSNorm.__call__] weight sample values: [1.1247505 1.2403923 1.1358297 1.1733838 1.1530503]
  [RMSNorm.__call__] After normalization shape: (1, 4, 1024)
  [RMSNorm.__call__] After normalization sample values: [-0.34284645  0.05443291  0.49668    -0.86459804 -0.05360906]
  [RMSNorm.__call__] Output shape: (1, 4, 1024)
  [RMSNorm.__call__] Output sample values: [-0.38561672  0.06751817  0.5641439  -1.0145054  -0.06181395]
[Mamba.__call__] After final RMSNorm shape: (1, 4, 1024)
[Mamba.__call__] After final RMSNorm sample values: [-0.38561672  0.06751817  0.5641439  -1.0145054  -0.06181395]
[Mamba.__call__] Logits shape: (1, 4, 50280)
[Mamba.__call__] Logits sample values: [13.265991   3.2762299 13.05636   14.650787  13.255491 ]
Mamba is the first
